(self.webpackChunkmgx=self.webpackChunkmgx||[]).push([[179],{766:(qs,xc,Hh)=>{"use strict";function _n(n){return"function"==typeof n}function B(n){const t=n(i=>{Error.call(i),i.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const xg=B(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function Xu(n,e){if(n){const t=n.indexOf(e);0<=t&&n.splice(t,1)}}class ns{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:i}=this;if(_n(i))try{i()}catch(s){e=s instanceof xg?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{zh(s)}catch(o){e=e??[],o instanceof xg?e=[...e,...o.errors]:e.push(o)}}if(e)throw new xg(e)}}add(e){var t;if(e&&e!==this)if(this.closed)zh(e);else{if(e instanceof ns){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Xu(t,e)}remove(e){const{_finalizers:t}=this;t&&Xu(t,e),e instanceof ns&&e._removeParent(this)}}ns.EMPTY=(()=>{const n=new ns;return n.closed=!0,n})();const is=ns.EMPTY;function N0(n){return n instanceof ns||n&&"closed"in n&&_n(n.remove)&&_n(n.add)&&_n(n.unsubscribe)}function zh(n){_n(n)?n():n.unsubscribe()}const pl={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},ml={setTimeout(n,e,...t){const{delegate:i}=ml;return i?.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){const{delegate:e}=ml;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Go(n){ml.setTimeout(()=>{const{onUnhandledError:e}=pl;if(!e)throw n;e(n)})}function Gh(){}const Sc=Br("C",void 0,void 0);function Br(n,e,t){return{kind:n,value:e,error:t}}let rs=null;function Yu(n){if(pl.useDeprecatedSynchronousErrorHandling){const e=!rs;if(e&&(rs={errorThrown:!1,error:null}),n(),e){const{errorThrown:t,error:i}=rs;if(rs=null,t)throw i}}else n()}class Ca extends ns{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,N0(e)&&e.add(this)):this.destination=XC}static create(e,t,i){return new jo(e,t,i)}next(e){this.isStopped?Sg(function Wh(n){return Br("N",n,void 0)}(e),this):this._next(e)}error(e){this.isStopped?Sg(function Ec(n){return Br("E",void 0,n)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Sg(Sc,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const yo=Function.prototype.bind;function Ma(n,e){return yo.call(n,e)}class Wo{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){Cc(i)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){Cc(i)}else Cc(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Cc(t)}}}class jo extends Ca{constructor(e,t,i){let r;if(super(),_n(e)||!e)r={next:e??void 0,error:t??void 0,complete:i??void 0};else{let s;this&&pl.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&Ma(e.next,s),error:e.error&&Ma(e.error,s),complete:e.complete&&Ma(e.complete,s)}):r=e}this.destination=new Wo(r)}}function Cc(n){pl.useDeprecatedSynchronousErrorHandling?function _o(n){pl.useDeprecatedSynchronousErrorHandling&&rs&&(rs.errorThrown=!0,rs.error=n)}(n):Go(n)}function Sg(n,e){const{onStoppedNotification:t}=pl;t&&ml.setTimeout(()=>t(n,e))}const XC={closed:!0,next:Gh,error:function qC(n){throw n},complete:Gh},Eg="function"==typeof Symbol&&Symbol.observable||"@@observable";function $o(n){return n}function O0(n){return 0===n.length?$o:1===n.length?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}let Tn=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){const i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){const s=function jh(n){return n&&n instanceof Ca||function KC(n){return n&&_n(n.next)&&_n(n.error)&&_n(n.complete)}(n)&&N0(n)}(t)?t:new jo(t,i,r);return Yu(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return new(i=qo(i))((r,s)=>{const o=new jo({next:a=>{try{t(a)}catch(l){s(l),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(t){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(t)}[Eg](){return this}pipe(...t){return O0(t)(this)}toPromise(t){return new(t=qo(t))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return n.create=e=>new n(e),n})();function qo(n){var e;return null!==(e=n??pl.Promise)&&void 0!==e?e:Promise}const vo=B(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let ss=(()=>{class n extends Tn{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const i=new L0(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new vo}next(t){Yu(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(t)}})}error(t){Yu(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){Yu(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:i,isStopped:r,observers:s}=this;return i||r?is:(this.currentObservers=null,s.push(t),new ns(()=>{this.currentObservers=null,Xu(s,t)}))}_checkFinalizedStatuses(t){const{hasError:i,thrownError:r,isStopped:s}=this;i?t.error(r):s&&t.complete()}asObservable(){const t=new Tn;return t.source=this,t}}return n.create=(e,t)=>new L0(e,t),n})();class L0 extends ss{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===i||i.call(t,e)}error(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===i||i.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,i;return null!==(i=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==i?i:is}}function F0(n){return _n(n?.lift)}function Wn(n){return e=>{if(F0(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function ei(n,e,t,i,r){return new ZC(n,e,t,i,r)}class ZC extends Ca{constructor(e,t,i,r,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(l){e.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function tn(n,e){return Wn((t,i)=>{let r=0;t.subscribe(ei(i,s=>{i.next(n.call(e,s,r++))}))})}function wo(n){return this instanceof wo?(this.v=n,this):new wo(n)}function Kh(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=n[Symbol.asyncIterator];return e?e.call(n):(n=function Cg(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(o){return new Promise(function(a,l){!function r(s,o,a,l){Promise.resolve(l).then(function(c){s({value:c,done:a})},o)}(a,l,(o=n[s](o)).done,o.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const V0=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function H0(n){return _n(n?.then)}function z0(n){return _n(n[Eg])}function Pg(n){return Symbol.asyncIterator&&_n(n?.[Symbol.asyncIterator])}function G0(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const W0=function sM(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function Zh(n){return _n(n?.[W0])}function j0(n){return function Yh(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=t.apply(n,e||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(p){i[p]&&(r[p]=function(m){return new Promise(function(g,v){s.push([p,m,g,v])>1||a(p,m)})})}function a(p,m){try{!function l(p){p.value instanceof wo?Promise.resolve(p.value.v).then(c,d):h(s[0][2],p)}(i[p](m))}catch(g){h(s[0][3],g)}}function c(p){a("next",p)}function d(p){a("throw",p)}function h(p,m){p(m),s.shift(),s.length&&a(s[0][0],s[0][1])}}(this,arguments,function*(){const t=n.getReader();try{for(;;){const{value:i,done:r}=yield wo(t.read());if(r)return yield wo(void 0);yield yield wo(i)}}finally{t.releaseLock()}})}function Jh(n){return _n(n?.getReader)}function os(n){if(n instanceof Tn)return n;if(null!=n){if(z0(n))return function oM(n){return new Tn(e=>{const t=n[Eg]();if(_n(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(V0(n))return function aM(n){return new Tn(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}(n);if(H0(n))return function lM(n){return new Tn(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Go)})}(n);if(Pg(n))return $0(n);if(Zh(n))return function cM(n){return new Tn(e=>{for(const t of n)if(e.next(t),e.closed)return;e.complete()})}(n);if(Jh(n))return function uM(n){return $0(j0(n))}(n)}throw G0(n)}function $0(n){return new Tn(e=>{(function dM(n,e){var t,i,r,s;return function Tc(n,e,t,i){return new(t||(t=Promise))(function(s,o){function a(d){try{c(i.next(d))}catch(h){o(h)}}function l(d){try{c(i.throw(d))}catch(h){o(h)}}function c(d){d.done?s(d.value):function r(s){return s instanceof t?s:new t(function(o){o(s)})}(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=Kh(n);!(i=yield t.next()).done;)if(e.next(i.value),e.closed)return}catch(o){r={error:o}}finally{try{i&&!i.done&&(s=t.return)&&(yield s.call(t))}finally{if(r)throw r.error}}e.complete()})})(n,e).catch(t=>e.error(t))})}function bo(n,e,t,i=0,r=!1){const s=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(s),!r)return s}function nr(n,e,t=1/0){return _n(e)?nr((i,r)=>tn((s,o)=>e(i,s,r,o))(os(n(i,r))),t):("number"==typeof e&&(t=e),Wn((i,r)=>function hM(n,e,t,i,r,s,o,a){const l=[];let c=0,d=0,h=!1;const p=()=>{h&&!l.length&&!c&&e.complete()},m=v=>c<i?g(v):l.push(v),g=v=>{s&&e.next(v),c++;let w=!1;os(t(v,d++)).subscribe(ei(e,y=>{r?.(y),s?m(y):e.next(y)},()=>{w=!0},void 0,()=>{if(w)try{for(c--;l.length&&c<i;){const y=l.shift();o?bo(e,o,()=>g(y)):g(y)}p()}catch(y){e.error(y)}}))};return n.subscribe(ei(e,m,()=>{h=!0,p()})),()=>{a?.()}}(i,r,n,t)))}function Ic(n=1/0){return nr($o,n)}const xo=new Tn(n=>n.complete());function Ng(n){return n[n.length-1]}function Zu(n){return _n(Ng(n))?n.pop():void 0}function Ju(n){return function Qh(n){return n&&_n(n.schedule)}(Ng(n))?n.pop():void 0}function q0(n,e=0){return Wn((t,i)=>{t.subscribe(ei(i,r=>bo(i,n,()=>i.next(r),e),()=>bo(i,n,()=>i.complete(),e),r=>bo(i,n,()=>i.error(r),e)))})}function Og(n,e=0){return Wn((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function K0(n,e){if(!n)throw new Error("Iterable cannot be null");return new Tn(t=>{bo(t,e,()=>{const i=n[Symbol.asyncIterator]();bo(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function vi(n,e){return e?function Z0(n,e){if(null!=n){if(z0(n))return function X0(n,e){return os(n).pipe(Og(e),q0(e))}(n,e);if(V0(n))return function mM(n,e){return new Tn(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}(n,e);if(H0(n))return function Y0(n,e){return os(n).pipe(Og(e),q0(e))}(n,e);if(Pg(n))return K0(n,e);if(Zh(n))return function gM(n,e){return new Tn(t=>{let i;return bo(t,e,()=>{i=n[W0](),bo(t,e,()=>{let r,s;try{({value:r,done:s}=i.next())}catch(o){return void t.error(o)}s?t.complete():t.next(r)},0,!0)}),()=>_n(i?.return)&&i.return()})}(n,e);if(Jh(n))return function _M(n,e){return K0(j0(n),e)}(n,e)}throw G0(n)}(n,e):os(n)}class Vr extends ss{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}}function wt(...n){return vi(n,Ju(n))}function Lg(n={}){const{connector:e=(()=>new ss),resetOnError:t=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=n;return s=>{let o,a,l,c=0,d=!1,h=!1;const p=()=>{a?.unsubscribe(),a=void 0},m=()=>{p(),o=l=void 0,d=h=!1},g=()=>{const v=o;m(),v?.unsubscribe()};return Wn((v,w)=>{c++,!h&&!d&&p();const y=l=l??e();w.add(()=>{c--,0===c&&!h&&!d&&(a=Rc(g,r))}),y.subscribe(w),!o&&c>0&&(o=new jo({next:b=>y.next(b),error:b=>{h=!0,p(),a=Rc(m,t,b),y.error(b)},complete:()=>{d=!0,p(),a=Rc(m,i),y.complete()}}),os(v).subscribe(o))})(s)}}function Rc(n,e,...t){if(!0===e)return void n();if(!1===e)return;const i=new jo({next:()=>{i.unsubscribe(),n()}});return os(e(...t)).subscribe(i)}function As(n,e){return Wn((t,i)=>{let r=null,s=0,o=!1;const a=()=>o&&!r&&i.complete();t.subscribe(ei(i,l=>{r?.unsubscribe();let c=0;const d=s++;os(n(l,d)).subscribe(r=ei(i,h=>i.next(e?e(l,h,d,c++):h),()=>{r=null,a()}))},()=>{o=!0,a()}))})}function Q0(n,e){return n===e}function mn(n){for(let e in n)if(n[e]===mn)return e;throw Error("Could not find renamed property on target object.")}function Pc(n,e){for(const t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function Pi(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(Pi).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function ef(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const Fg=mn({__forward_ref__:mn});function yn(n){return n.__forward_ref__=yn,n.toString=function(){return Pi(this())},n}function dt(n){return tf(n)?n():n}function tf(n){return"function"==typeof n&&n.hasOwnProperty(Fg)&&n.__forward_ref__===yn}function nf(n){return n&&!!n.\u0275providers}class ae extends Error{constructor(e,t){super(function Qu(n,e){return`NG0${Math.abs(n)}${e?": "+e:""}`}(e,t)),this.code=e}}function Tt(n){return"string"==typeof n?n:null==n?"":String(n)}function Ug(n,e){throw new ae(-201,!1)}function Ds(n,e){null==n&&function bt(n,e,t,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${t} ${i} ${e} <=Actual]`))}(e,n,null,"!=")}function Qe(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function wi(n){return{providers:n.providers||[],imports:n.imports||[]}}function Aa(n){return rf(n,td)||rf(n,Bg)}function rf(n,e){return n.hasOwnProperty(e)?n[e]:null}function ed(n){return n&&(n.hasOwnProperty(sf)||n.hasOwnProperty(iw))?n[sf]:null}const td=mn({\u0275prov:mn}),sf=mn({\u0275inj:mn}),Bg=mn({ngInjectableDef:mn}),iw=mn({ngInjectorDef:mn});var Xt=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(Xt||{});let Mr;function Un(n){const e=Mr;return Mr=n,e}function sw(n,e,t){const i=Aa(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&Xt.Optional?null:void 0!==e?e:void Ug(Pi(n))}const un=globalThis,id={},lf="__NG_DI_FLAG__",rd="ngTempTokenPath",$g=/\n/gm,lw="__source";let Da;function Ia(n){const e=Da;return Da=n,e}function cw(n,e=Xt.Default){if(void 0===Da)throw new ae(-203,!1);return null===Da?sw(n,void 0,e):Da.get(n,e&Xt.Optional?null:void 0,e)}function Le(n,e=Xt.Default){return(function rw(){return Mr}()||cw)(dt(n),e)}function ze(n,e=Xt.Default){return Le(n,sd(e))}function sd(n){return typeof n>"u"||"number"==typeof n?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function uf(n){const e=[];for(let t=0;t<n.length;t++){const i=dt(n[t]);if(Array.isArray(i)){if(0===i.length)throw new ae(900,!1);let r,s=Xt.Default;for(let o=0;o<i.length;o++){const a=i[o],l=CM(a);"number"==typeof l?-1===l?r=a.token:s|=l:r=a}e.push(Le(r,s))}else e.push(Le(i))}return e}function od(n,e){return n[lf]=e,n.prototype[lf]=e,n}function CM(n){return n[lf]}function Xo(n){return{toString:n}.toString()}var Yo=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(Yo||{}),Rs=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(Rs||{});const Eo={},an=[],ad=mn({\u0275cmp:mn}),Co=mn({\u0275dir:mn}),Nc=mn({\u0275pipe:mn}),uw=mn({\u0275mod:mn}),Ko=mn({\u0275fac:mn}),ld=mn({__NG_ELEMENT_ID__:mn}),vl=mn({__NG_ENV_ID__:mn});function Ps(n,e,t){let i=n.length;for(;;){const r=n.indexOf(e,t);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const s=e.length;if(r+s===i||n.charCodeAt(r+s)<=32)return r}t=r+1}}function df(n,e,t){let i=0;for(;i<t.length;){const r=t[i];if("number"==typeof r){if(0!==r)break;i++;const s=t[i++],o=t[i++],a=t[i++];n.setAttribute(e,o,a,s)}else{const s=r,o=t[++i];hw(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),i++}}return i}function dw(n){return 3===n||4===n||6===n}function hw(n){return 64===n.charCodeAt(0)}function cd(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?t=r:0===t||fw(n,t,r,null,-1===t||2===t?e[++i]:null)}}return n}function fw(n,e,t,i,r){let s=0,o=n.length;if(-1===e)o=-1;else for(;s<n.length;){const a=n[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<n.length;){const a=n[s];if("number"==typeof a)break;if(a===t){if(null===i)return void(null!==r&&(n[s+1]=r));if(i===n[s+1])return void(n[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),null!==i&&n.splice(s++,0,i),null!==r&&n.splice(s++,0,r)}const pw="ng-template";function hf(n,e,t){let i=0,r=!0;for(;i<n.length;){let s=n[i++];if("string"==typeof s&&r){const o=n[i++];if(t&&"class"===s&&-1!==Ps(o.toLowerCase(),e,0))return!0}else{if(1===s){for(;i<n.length&&"string"==typeof(s=n[i++]);)if(s.toLowerCase()===e)return!0;return!1}"number"==typeof s&&(r=!1)}}return!1}function Y(n){return 4===n.type&&n.value!==pw}function ue(n,e,t){return e===(4!==n.type||t?n.value:pw)}function re(n,e,t){let i=4;const r=n.attrs||[],s=function An(n){for(let e=0;e<n.length;e++)if(dw(n[e]))return e;return n.length}(r);let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&i){if(i=2|1&i,""!==l&&!ue(n,l,t)||""===l&&1===e.length){if(Ue(i))return!1;o=!0}}else{const c=8&i?l:e[++a];if(8&i&&null!==n.attrs){if(!hf(n.attrs,c,t)){if(Ue(i))return!1;o=!0}continue}const h=Pt(8&i?"class":l,r,Y(n),t);if(-1===h){if(Ue(i))return!1;o=!0;continue}if(""!==c){let p;p=h>s?"":r[h+1].toLowerCase();const m=8&i?p:null;if(m&&-1!==Ps(m,c,0)||2&i&&c!==p){if(Ue(i))return!1;o=!0}}}}else{if(!o&&!Ue(i)&&!Ue(l))return!1;if(o&&Ue(l))continue;o=!1,i=l|1&i}}return Ue(i)||o}function Ue(n){return 0==(1&n)}function Pt(n,e,t,i){if(null===e)return-1;let r=0;if(i||!t){let s=!1;for(;r<e.length;){const o=e[r];if(o===n)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function Xg(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const i=n[t];if("number"==typeof i)return-1;if(i===e)return t;t++}return-1}(e,n)}function fn(n,e,t=!1){for(let i=0;i<e.length;i++)if(re(n,e[i],t))return!0;return!1}function AM(n,e){e:for(let t=0;t<e.length;t++){const i=e[t];if(n.length===i.length){for(let r=0;r<n.length;r++)if(n[r]!==i[r])continue e;return!0}}return!1}function ls(n,e){return n?":not("+e.trim()+")":e}function ff(n){let e=n[0],t=1,i=2,r="",s=!1;for(;t<n.length;){let o=n[t];if("string"==typeof o)if(2&i){const a=n[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!Ue(o)&&(e+=ls(s,r),r=""),i=o,s=s||!Ue(i);t++}return""!==r&&(e+=ls(s,r)),e}function ir(n){return Xo(()=>{const e=Yg(n),t={...e,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===Yo.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Rs.Emulated,styles:n.styles||an,_:null,schemas:n.schemas||null,tView:null,id:""};Kg(t);const i=n.dependencies;return t.directiveDefs=bl(i,!1),t.pipeDefs=bl(i,!0),t.id=function ud(n){let e=0;const t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(const r of t)e=Math.imul(31,e)+r.charCodeAt(0)<<0;return e+=2147483648,"c"+e}(t),t})}function vn(n){return Zt(n)||jn(n)}function IM(n){return null!==n}function Oi(n){return Xo(()=>({type:n.type,bootstrap:n.bootstrap||an,declarations:n.declarations||an,imports:n.imports||an,exports:n.exports||an,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function mw(n,e){if(null==n)return Eo;const t={};for(const i in n)if(n.hasOwnProperty(i)){let r=n[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),t[r]=i,e&&(e[r]=s)}return t}function yt(n){return Xo(()=>{const e=Yg(n);return Kg(e),e})}function Hr(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:!0===n.standalone,onDestroy:n.type.prototype.ngOnDestroy||null}}function Zt(n){return n[ad]||null}function jn(n){return n[Co]||null}function Gi(n){return n[Nc]||null}function mr(n,e){const t=n[uw]||null;if(!t&&!0===e)throw new Error(`Type ${Pi(n)} does not have '\u0275mod' property.`);return t}function Yg(n){const e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||Eo,exportAs:n.exportAs||null,standalone:!0===n.standalone,signals:!0===n.signals,selectors:n.selectors||an,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:mw(n.inputs,e),outputs:mw(n.outputs)}}function Kg(n){n.features?.forEach(e=>e(n))}function bl(n,e){if(!n)return null;const t=e?Gi:vn;return()=>("function"==typeof n?n():n).map(i=>t(i)).filter(IM)}const En=0,Ve=1,Ft=2,$n=3,Ks=4,Ra=5,Li=6,Pa=7,pi=8,Zo=9,Lc=10,It=11,ti=12,rr=13,Fc=14,mi=15,kc=16,Uc=17,Ns=18,Jo=19,gf=20,cs=21,us=22,Qo=23,Na=24,Bt=25,Zg=1,_w=2,Mo=7,ea=9,Wi=11;function Fi(n){return Array.isArray(n)&&"object"==typeof n[Zg]}function ji(n){return Array.isArray(n)&&!0===n[Zg]}function zr(n){return 0!=(4&n.flags)}function Vt(n){return n.componentOffset>-1}function yf(n){return 1==(1&n.flags)}function Zs(n){return!!n.template}function Jg(n){return 0!=(512&n[Ft])}function Sl(n,e){return n.hasOwnProperty(Ko)?n[Ko]:null}let sr=null,dd=!1;function ds(n){const e=sr;return sr=n,e}const vw={version:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{}};function vf(n){if(!hd(n)||n.dirty){if(!n.producerMustRecompute(n)&&!Ao(n))return void(n.dirty=!1);n.producerRecomputeValue(n),n.dirty=!1}}function bw(n){n.dirty=!0,function Bc(n){if(void 0===n.liveConsumerNode)return;const e=dd;dd=!0;try{for(const t of n.liveConsumerNode)t.dirty||bw(t)}finally{dd=e}}(n),n.consumerMarkedDirty?.(n)}function wf(n){return n&&(n.nextProducerIndex=0),ds(n)}function Qg(n,e){if(ds(e),n&&void 0!==n.producerNode&&void 0!==n.producerIndexOfThis&&void 0!==n.producerLastReadVersion){if(hd(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)Tr(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function Ao(n){El(n);for(let e=0;e<n.producerNode.length;e++){const t=n.producerNode[e],i=n.producerLastReadVersion[e];if(i!==t.version||(vf(t),i!==t.version))return!0}return!1}function bf(n){if(El(n),hd(n))for(let e=0;e<n.producerNode.length;e++)Tr(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function Tr(n,e){if(function e_(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}(n),El(n),1===n.liveConsumerNode.length)for(let i=0;i<n.producerNode.length;i++)Tr(n.producerNode[i],n.producerIndexOfThis[i]);const t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){const i=n.liveConsumerIndexOfThis[e],r=n.liveConsumerNode[e];El(r),r.producerIndexOfThis[i]=e}}function hd(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function El(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}let t_=null;const Mf=()=>{},UM=(()=>({...vw,consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:n=>{n.schedule(n.ref)},hasRun:!1,cleanupFn:Mf}))();class Ew{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function $i(){return Cw}function Cw(n){return n.type.prototype.ngOnChanges&&(n.setInput=BM),fd}function fd(){const n=Af(this),e=n?.current;if(e){const t=n.previous;if(t===Eo)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function BM(n,e,t,i){const r=this.declaredInputs[t],s=Af(n)||function Tw(n,e){return n[Mw]=e}(n,{previous:Eo,current:null}),o=s.current||(s.current={}),a=s.previous,l=a[r];o[r]=new Ew(l&&l.currentValue,e,a===Eo),n[i]=e}$i.ngInherit=!0;const Mw="__ngSimpleChanges__";function Af(n){return n[Mw]||null}const Do=function(n,e,t){};function Pn(n){for(;Array.isArray(n);)n=n[En];return n}function md(n,e){return Pn(e[n])}function Dr(n,e){return Pn(e[n.index])}function gd(n,e){return n.data[e]}function Hc(n,e){return n[e]}function Gr(n,e){const t=e[n];return Fi(t)?t:t[En]}function Va(n,e){return null==e?null:n[e]}function If(n){n[Uc]=0}function Rw(n){1024&n[Ft]||(n[Ft]|=1024,Pw(n,1))}function Rf(n){1024&n[Ft]&&(n[Ft]&=-1025,Pw(n,-1))}function Pw(n,e){let t=n[$n];if(null===t)return;t[Ra]+=e;let i=t;for(t=t[$n];null!==t&&(1===e&&1===i[Ra]||-1===e&&0===i[Ra]);)t[Ra]+=e,i=t,t=t[$n]}const xt={lFrame:h_(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function hs(){return xt.bindingsEnabled}function zc(){return null!==xt.skipHydrationRootTNode}function ge(){return xt.lFrame.lView}function Qt(){return xt.lFrame.tView}function Ir(n){return xt.lFrame.contextLView=n,n[pi]}function or(n){return xt.lFrame.contextLView=null,n}function qi(){let n=Lf();for(;null!==n&&64===n.type;)n=n.parent;return n}function Lf(){return xt.lFrame.currentTNode}function Os(n,e){const t=xt.lFrame;t.currentTNode=n,t.isParent=e}function _d(){return xt.lFrame.isParent}function Io(){xt.lFrame.isParent=!1}function gr(){const n=xt.lFrame;let e=n.bindingRootIndex;return-1===e&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function Wc(){return xt.lFrame.bindingIndex++}function ia(n){const e=xt.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function jM(n,e){const t=xt.lFrame;t.bindingIndex=t.bindingRootIndex=n,Ff(e)}function Ff(n){xt.lFrame.currentDirectiveIndex=n}function Qs(){return xt.lFrame.currentQueryIndex}function u_(n){xt.lFrame.currentQueryIndex=n}function $M(n){const e=n[Ve];return 2===e.type?e.declTNode:1===e.type?n[Li]:null}function yd(n,e,t){if(t&Xt.SkipSelf){let r=e,s=n;for(;!(r=r.parent,null!==r||t&Xt.Host||(r=$M(s),null===r||(s=s[Fc],10&r.type))););if(null===r)return!1;e=r,n=s}const i=xt.lFrame=d_();return i.currentTNode=e,i.lView=n,!0}function Ha(n){const e=d_(),t=n[Ve];xt.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function d_(){const n=xt.lFrame,e=null===n?null:n.child;return null===e?h_(n):e}function h_(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function Vw(){const n=xt.lFrame;return xt.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const f_=Vw;function za(){const n=Vw();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function yr(){return xt.lFrame.selectedIndex}function Ga(n){xt.lFrame.selectedIndex=n}function Nn(){const n=xt.lFrame;return gd(n.tView,n.selectedIndex)}function kf(){xt.lFrame.currentNamespace="svg"}let m_=!0;function Tl(){return m_}function ra(n){m_=n}function Vf(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){const s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:d}=s;o&&(n.contentHooks??=[]).push(-t,o),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),l&&(n.viewHooks??=[]).push(-t,l),c&&((n.viewHooks??=[]).push(t,c),(n.viewCheckHooks??=[]).push(t,c)),null!=d&&(n.destroyHooks??=[]).push(t,d)}}function wd(n,e,t){__(n,e,3,t)}function Ls(n,e,t,i){(3&n[Ft])===t&&__(n,e,t,i)}function Hf(n,e){let t=n[Ft];(3&t)===e&&(t&=8191,t+=1,n[Ft]=t)}function __(n,e,t,i){const s=i??-1,o=e.length-1;let a=0;for(let l=void 0!==i?65535&n[Uc]:0;l<o;l++)if("number"==typeof e[l+1]){if(a=e[l],null!=i&&a>=i)break}else e[l]<0&&(n[Uc]+=65536),(a<s||-1==s)&&(Gw(n,t,e,l),n[Uc]=(4294901760&n[Uc])+l+2),l++}function zw(n,e){Do(4,n,e);const t=ds(null);try{e.call(n)}finally{ds(t),Do(5,n,e)}}function Gw(n,e,t,i){const r=t[i]<0,s=t[i+1],a=n[r?-t[i]:t[i]];r?n[Ft]>>13<n[Uc]>>16&&(3&n[Ft])===e&&(n[Ft]+=8192,zw(a,s)):zw(a,s)}const jc=-1;class bd{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function Sd(n){return n!==jc}function eo(n){return 32767&n}function Al(n,e){let t=function XM(n){return n>>16}(n),i=e;for(;t>0;)i=i[Fc],t--;return i}let Gf=!0;function Ui(n){const e=Gf;return Gf=n,e}const $w=255,v_=5;let YM=0;const to={};function Wf(n,e){const t=Ro(n,e);if(-1!==t)return t;const i=e[Ve];i.firstCreatePass&&(n.injectorIndex=e.length,w_(i.data,n),w_(e,null),w_(i.blueprint,null));const r=Xi(n,e),s=n.injectorIndex;if(Sd(r)){const o=eo(r),a=Al(r,e),l=a[Ve].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|l[o+c]}return e[s+8]=r,s}function w_(n,e){n.push(0,0,0,0,0,0,0,0,e)}function Ro(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function Xi(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;null!==r;){if(i=S_(r),null===i)return jc;if(t++,r=r[Fc],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return jc}function Ed(n,e,t){!function KM(n,e,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(ld)&&(i=t[ld]),null==i&&(i=t[ld]=YM++);const r=i&$w;e.data[n+(r>>v_)]|=1<<r}(n,e,t)}function jf(n,e,t){if(t&Xt.Optional||void 0!==n)return n;Ug()}function qw(n,e,t,i){if(t&Xt.Optional&&void 0===i&&(i=null),!(t&(Xt.Self|Xt.Host))){const r=n[Zo],s=Un(void 0);try{return r?r.get(e,i,t&Xt.Optional):sw(e,i,t&Xt.Optional)}finally{Un(s)}}return jf(i,0,t)}function Xw(n,e,t,i=Xt.Default,r){if(null!==n){if(2048&e[Ft]&&!(i&Xt.Self)){const o=function x_(n,e,t,i,r){let s=n,o=e;for(;null!==s&&null!==o&&2048&o[Ft]&&!(512&o[Ft]);){const a=qc(s,o,t,i|Xt.Self,to);if(a!==to)return a;let l=s.parent;if(!l){const c=o[gf];if(c){const d=c.get(t,to,i);if(d!==to)return d}l=S_(o),o=o[Fc]}s=l}return r}(n,e,t,i,to);if(o!==to)return o}const s=qc(n,e,t,i,to);if(s!==to)return s}return qw(e,t,i,r)}function qc(n,e,t,i,r){const s=function JM(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(ld)?n[ld]:void 0;return"number"==typeof e?e>=0?e&$w:b_:e}(t);if("function"==typeof s){if(!yd(e,n,i))return i&Xt.Host?jf(r,0,i):qw(e,t,i,r);try{let o;if(o=s(i),null!=o||i&Xt.Optional)return o;Ug()}finally{f_()}}else if("number"==typeof s){let o=null,a=Ro(n,e),l=jc,c=i&Xt.Host?e[mi][Li]:null;for((-1===a||i&Xt.SkipSelf)&&(l=-1===a?Xi(n,e):e[a+8],l!==jc&&Zw(i,!1)?(o=e[Ve],a=eo(l),e=Al(l,e)):a=-1);-1!==a;){const d=e[Ve];if(Kw(s,a,d.data)){const h=Yw(a,e,t,o,i,c);if(h!==to)return h}l=e[a+8],l!==jc&&Zw(i,e[Ve].data[a+8]===c)&&Kw(s,a,e)?(o=d,a=eo(l),e=Al(l,e)):a=-1}}return r}function Yw(n,e,t,i,r,s){const o=e[Ve],a=o.data[n+8],d=Cd(a,o,t,null==i?Vt(a)&&Gf:i!=o&&0!=(3&a.type),r&Xt.Host&&s===a);return null!==d?Dl(e,o,d,a):to}function Cd(n,e,t,i,r){const s=n.providerIndexes,o=e.data,a=1048575&s,l=n.directiveStart,d=s>>20,p=r?a+d:n.directiveEnd;for(let m=i?a:a+d;m<p;m++){const g=o[m];if(m<l&&t===g||m>=l&&g.type===t)return m}if(r){const m=o[l];if(m&&Zs(m)&&m.type===t)return l}return null}function Dl(n,e,t,i){let r=n[t];const s=e.data;if(function sa(n){return n instanceof bd}(r)){const o=r;o.resolving&&function vM(n,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new ae(-200,`Circular dependency in DI detected for ${n}${t}`)}(function gn(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():Tt(n)}(s[t]));const a=Ui(o.canSeeViewProviders);o.resolving=!0;const c=o.injectImpl?Un(o.injectImpl):null;yd(n,i,Xt.Default);try{r=n[t]=o.factory(void 0,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&function g_(n,e,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const o=Cw(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}r&&(t.preOrderHooks??=[]).push(0-n,r),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}(t,s[t],e)}finally{null!==c&&Un(c),Ui(a),o.resolving=!1,f_()}}return r}function Kw(n,e,t){return!!(t[e+(n>>v_)]&1<<n)}function Zw(n,e){return!(n&Xt.Self||n&Xt.Host&&e)}class Rr{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return Xw(this._tNode,this._lView,e,sd(i),t)}}function b_(){return new Rr(qi(),ge())}function bi(n){return Xo(()=>{const e=n.prototype.constructor,t=e[Ko]||Il(e),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const s=r[Ko]||Il(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function Il(n){return tf(n)?()=>{const e=Il(dt(n));return e&&e()}:Sl(n)}function S_(n){const e=n[Ve],t=e.type;return 2===t?e.declTNode:1===t?n[Li]:null}const Rl="__parameters__";function Pl(n,e,t){return Xo(()=>{const i=function E_(n){return function(...t){if(n){const i=n(...t);for(const r in i)this[r]=i[r]}}}(e);function r(...s){if(this instanceof r)return i.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(l,c,d){const h=l.hasOwnProperty(Rl)?l[Rl]:Object.defineProperty(l,Rl,{value:[]})[Rl];for(;h.length<=d;)h.push(null);return(h[d]=h[d]||[]).push(o),l}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}function Zc(n,e){n.forEach(t=>Array.isArray(t)?Zc(t,e):e(t))}function C_(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function $f(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function Td(n,e){const t=[];for(let i=0;i<n;i++)t.push(e);return t}function qn(n,e,t){let i=Jc(n,e);return i>=0?n[1|i]=t:(i=~i,function rT(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(1===r)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;)n[r]=n[r-2],r--;n[e]=t,n[e+1]=i}}(n,i,e,t)),i}function M_(n,e){const t=Jc(n,e);if(t>=0)return n[1|t]}function Jc(n,e){return function T_(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){const s=i+(r-i>>1),o=n[s<<t];if(e===o)return s<<t;o>e?r=s:i=s+1}return~(r<<t)}(n,e,1)}const Xf=od(Pl("Optional"),8),Yf=od(Pl("SkipSelf"),4);function tp(n){return 128==(128&n.flags)}var ja=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(ja||{});const ST=/^>|^->|<!--|-->|--!>|<!-$/g,ip=/(<|>)/g,ET="\u200b$1\u200b";const L_=new Map;let CT=0;const k_="__ngContext__";function ar(n,e){Fi(e)?(n[k_]=e[Jo],function TT(n){L_.set(n[Jo],n)}(e)):n[k_]=e}let V_;function H_(n,e){return V_(n,e)}function nu(n){const e=n[$n];return ji(e)?e[$n]:e}function _b(n){return vb(n[ti])}function yb(n){return vb(n[Ks])}function vb(n){for(;null!==n&&!ji(n);)n=n[Ks];return n}function iu(n,e,t,i,r){if(null!=i){let s,o=!1;ji(i)?s=i:Fi(i)&&(o=!0,i=i[En]);const a=Pn(i);0===n&&null!==t?null==r?xb(e,t,a):Ol(e,t,a,r||null,!0):1===n&&null!==t?Ol(e,t,a,r||null,!0):2===n?function hp(n,e,t){const i=ks(n,e);i&&function j_(n,e,t,i){n.removeChild(e,t,i)}(n,i,e,t)}(e,a,o):3===n&&e.destroyNode(a),null!=s&&function fp(n,e,t,i,r){const s=t[Mo];s!==Pn(t)&&iu(e,n,i,s,r);for(let a=Wi;a<t.length;a++){const l=t[a];Fl(l[Ve],l,n,e,i,s)}}(e,n,s,t,r)}}function G_(n,e){return n.createComment(function db(n){return n.replace(ST,e=>e.replace(ip,ET))}(e))}function lp(n,e,t){return n.createElement(e,t)}function Nt(n,e){const t=n[ea],i=t.indexOf(e);Rf(e),t.splice(i,1)}function cp(n,e){if(n.length<=Wi)return;const t=Wi+e,i=n[t];if(i){const r=i[kc];null!==r&&r!==n&&Nt(r,i),e>0&&(n[t-1][Ks]=i[Ks]);const s=$f(n,Wi+e);!function NT(n,e){Fl(n,e,e[It],2,null,null),e[En]=null,e[Li]=null}(i[Ve],i);const o=s[Ns];null!==o&&o.detachView(s[Ve]),i[$n]=null,i[Ks]=null,i[Ft]&=-129}return i}function vr(n,e){if(!(256&e[Ft])){const t=e[It];e[Qo]&&bf(e[Qo]),e[Na]&&bf(e[Na]),t.destroyNode&&Fl(n,e,t,3,null,null),function LT(n){let e=n[ti];if(!e)return ni(n[Ve],n);for(;e;){let t=null;if(Fi(e))t=e[ti];else{const i=e[Wi];i&&(t=i)}if(!t){for(;e&&!e[Ks]&&e!==n;)Fi(e)&&ni(e[Ve],e),e=e[$n];null===e&&(e=n),Fi(e)&&ni(e[Ve],e),t=e&&e[Ks]}e=t}}(e)}}function ni(n,e){if(!(256&e[Ft])){e[Ft]&=-129,e[Ft]|=256,function $a(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let i=0;i<t.length;i+=2){const r=e[t[i]];if(!(r instanceof bd)){const s=t[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],l=s[o+1];Do(4,a,l);try{l.call(a)}finally{Do(5,a,l)}}else{Do(4,r,s);try{s.call(r)}finally{Do(5,r,s)}}}}}(n,e),function kT(n,e){const t=n.cleanup,i=e[Pa];if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+3];o>=0?i[o]():i[-o].unsubscribe(),s+=2}else t[s].call(i[t[s+1]]);null!==i&&(e[Pa]=null);const r=e[cs];if(null!==r){e[cs]=null;for(let s=0;s<r.length;s++)(0,r[s])()}}(n,e),1===e[Ve].type&&e[It].destroy();const t=e[kc];if(null!==t&&ji(e[$n])){t!==e[$n]&&Nt(t,e);const i=e[Ns];null!==i&&i.detachView(n)}!function AT(n){L_.delete(n[Jo])}(e)}}function W_(n,e,t){return function bb(n,e,t){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return t[En];{const{componentOffset:r}=i;if(r>-1){const{encapsulation:s}=n.data[i.directiveStart+r];if(s===Rs.None||s===Rs.Emulated)return null}return Dr(i,t)}}(n,e.parent,t)}function Ol(n,e,t,i,r){n.insertBefore(e,t,i,r)}function xb(n,e,t){n.appendChild(e,t)}function Sb(n,e,t,i,r){null!==i?Ol(n,e,t,i,r):xb(n,e,t)}function ks(n,e){return n.parentNode(e)}function Id(n,e,t){return ii(n,e,t)}let up,jr,ii=function Xn(n,e,t){return 40&n.type?Dr(n,t):null};function dp(n,e,t,i){const r=W_(n,i,e),s=e[It],a=Id(i.parent||e[Li],i,e);if(null!=r)if(Array.isArray(t))for(let l=0;l<t.length;l++)Sb(s,r,t[l],a,!1);else Sb(s,r,t,a,!1);void 0!==up&&up(s,i,e,t,r)}function Rd(n,e){if(null!==e){const t=e.type;if(3&t)return Dr(e,n);if(4&t)return $_(-1,n[e.index]);if(8&t){const i=e.child;if(null!==i)return Rd(n,i);{const r=n[e.index];return ji(r)?$_(-1,r):Pn(r)}}if(32&t)return H_(e,n)()||Pn(n[e.index]);{const i=Mb(n,e);return null!==i?Array.isArray(i)?i[0]:Rd(nu(n[mi]),i):Rd(n,e.next)}}return null}function Mb(n,e){return null!==e?n[mi][Li].projection[e.projection]:null}function $_(n,e){const t=Wi+n+1;if(t<e.length){const i=e[t],r=i[Ve].firstChild;if(null!==r)return Rd(i,r)}return e[Mo]}function Ll(n,e,t,i,r,s,o){for(;null!=t;){const a=i[t.index],l=t.type;if(o&&0===e&&(a&&ar(Pn(a),i),t.flags|=2),32!=(32&t.flags))if(8&l)Ll(n,e,t.child,i,r,s,!1),iu(e,n,r,a,s);else if(32&l){const c=H_(t,i);let d;for(;d=c();)iu(e,n,r,d,s);iu(e,n,r,a,s)}else 16&l?X_(n,e,i,t,r,s):iu(e,n,r,a,s);t=o?t.projectionNext:t.next}}function Fl(n,e,t,i,r,s){Ll(t,i,n.firstChild,e,r,s,!1)}function X_(n,e,t,i,r,s){const o=t[mi],l=o[Li].projection[i.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++)iu(e,n,r,l[c],s);else{let c=l;const d=o[$n];tp(i)&&(c.flags|=128),Ll(n,e,c,d,r,s,!0)}}function Tb(n,e,t){""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function Ab(n,e,t){const{mergedAttrs:i,classes:r,styles:s}=t;null!==i&&df(n,e,i),null!==r&&Tb(n,e,r),null!==s&&function ru(n,e,t){n.setAttribute(e,"style",t)}(n,e,s)}class Nb{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}function qa(n){return n instanceof Nb?n.changingThisBreaksApplicationSecurity:n}class Ye{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=Qe({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const Fd=new Ye("ENVIRONMENT_INITIALIZER"),zb=new Ye("INJECTOR",-1),Gb=new Ye("INJECTOR_DEF_TYPES");class iy{get(e,t=id){if(t===id){const i=new Error(`NullInjectorError: No provider for ${Pi(e)}!`);throw i.name="NullInjectorError",i}return t}}function o1(...n){return{\u0275providers:Wb(0,n),\u0275fromNgModule:!0}}function Wb(n,...e){const t=[],i=new Set;let r;const s=o=>{t.push(o)};return Zc(e,o=>{const a=o;_p(a,s,[],i)&&(r||=[],r.push(a))}),void 0!==r&&jb(r,s),t}function jb(n,e){for(let t=0;t<n.length;t++){const{ngModule:i,providers:r}=n[t];sy(r,s=>{e(s,i)})}}function _p(n,e,t,i){if(!(n=dt(n)))return!1;let r=null,s=ed(n);const o=!s&&Zt(n);if(s||o){if(o&&!o.standalone)return!1;r=n}else{const l=n.ngModule;if(s=ed(l),!s)return!1;r=l}const a=i.has(r);if(o){if(a)return!1;if(i.add(r),o.dependencies){const l="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const c of l)_p(c,e,t,i)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let c;i.add(r);try{Zc(s.imports,d=>{_p(d,e,t,i)&&(c||=[],c.push(d))})}finally{}void 0!==c&&jb(c,e)}if(!a){const c=Sl(r)||(()=>new r);e({provide:r,useFactory:c,deps:an},r),e({provide:Gb,useValue:r,multi:!0},r),e({provide:Fd,useValue:()=>Le(r),multi:!0},r)}const l=s.providers;if(null!=l&&!a){const c=n;sy(l,d=>{e(d,c)})}}}return r!==n&&void 0!==n.providers}function sy(n,e){for(let t of n)nf(t)&&(t=t.\u0275providers),Array.isArray(t)?sy(t,e):e(t)}const a1=mn({provide:String,useValue:mn});function oy(n){return null!==n&&"object"==typeof n&&a1 in n}function Xa(n){return"function"==typeof n}const ay=new Ye("Set Injector scope."),vp={},l1={};let kd;function wp(){return void 0===kd&&(kd=new iy),kd}class ms{}class bp extends ms{get destroyed(){return this._destroyed}constructor(e,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Ud(e,o=>this.processProvider(o)),this.records.set(zb,lu(void 0,this)),r.has("environment")&&this.records.set(ms,lu(void 0,this));const s=this.records.get(ay);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(Gb.multi,an,Xt.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();const e=this._onDestroyHooks;this._onDestroyHooks=[];for(const t of e)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();const t=Ia(this),i=Un(void 0);try{return e()}finally{Ia(t),Un(i)}}get(e,t=id,i=Xt.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(vl))return e[vl](this);i=sd(i);const s=Ia(this),o=Un(void 0);try{if(!(i&Xt.SkipSelf)){let l=this.records.get(e);if(void 0===l){const c=function d1(n){return"function"==typeof n||"object"==typeof n&&n instanceof Ye}(e)&&Aa(e);l=c&&this.injectableDefInScope(c)?lu(br(e),vp):null,this.records.set(e,l)}if(null!=l)return this.hydrate(e,l)}return(i&Xt.Self?wp():this.parent).get(e,t=i&Xt.Optional&&t===id?null:t)}catch(a){if("NullInjectorError"===a.name){if((a[rd]=a[rd]||[]).unshift(Pi(e)),s)throw a;return function MM(n,e,t,i){const r=n[rd];throw e[lw]&&r.unshift(e[lw]),n.message=function TM(n,e,t,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let r=Pi(e);if(Array.isArray(e))r=e.map(Pi).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):Pi(a)))}r=`{${s.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${n.replace($g,"\n  ")}`}("\n"+n.message,r,t,i),n.ngTokenPath=r,n[rd]=null,n}(a,e,"R3InjectorError",this.source)}throw a}finally{Un(o),Ia(s)}}resolveInjectorInitializers(){const e=Ia(this),t=Un(void 0);try{const r=this.get(Fd.multi,an,Xt.Self);for(const s of r)s()}finally{Ia(e),Un(t)}}toString(){const e=[],t=this.records;for(const i of t.keys())e.push(Pi(i));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ae(205,!1)}processProvider(e){let t=Xa(e=dt(e))?e:dt(e&&e.provide);const i=function c1(n){return oy(n)?lu(void 0,n.useValue):lu(Xb(n),vp)}(e);if(Xa(e)||!0!==e.multi)this.records.get(t);else{let r=this.records.get(t);r||(r=lu(void 0,vp,!0),r.factory=()=>uf(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,i)}hydrate(e,t){return t.value===vp&&(t.value=l1,t.value=t.factory()),"object"==typeof t.value&&t.value&&function cy(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=dt(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){const t=this._onDestroyHooks.indexOf(e);-1!==t&&this._onDestroyHooks.splice(t,1)}}function br(n){const e=Aa(n),t=null!==e?e.factory:Sl(n);if(null!==t)return t;if(n instanceof Ye)throw new ae(204,!1);if(n instanceof Function)return function ly(n){const e=n.length;if(e>0)throw Td(e,"?"),new ae(204,!1);const t=function Is(n){return n&&(n[td]||n[Bg])||null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new ae(204,!1)}function Xb(n,e,t){let i;if(Xa(n)){const r=dt(n);return Sl(r)||br(r)}if(oy(n))i=()=>dt(n.useValue);else if(function yp(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...uf(n.deps||[]));else if(function $b(n){return!(!n||!n.useExisting)}(n))i=()=>Le(dt(n.useExisting));else{const r=dt(n&&(n.useClass||n.provide));if(!function u1(n){return!!n.deps}(n))return Sl(r)||br(r);i=()=>new r(...uf(n.deps))}return i}function lu(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function Ud(n,e){for(const t of n)Array.isArray(t)?Ud(t,e):t&&nf(t)?Ud(t.\u0275providers,e):e(t)}const xp=new Ye("AppId",{providedIn:"root",factory:()=>h1}),h1="ng",Yb=new Ye("Platform Initializer"),Ya=new Ye("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),Kb=new Ye("AnimationModuleType"),Zb=new Ye("CSP nonce",{providedIn:"root",factory:()=>function ou(){if(void 0!==jr)return jr;if(typeof document<"u")return document;throw new ae(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let ex=(n,e,t)=>null;function _y(n,e,t=!1){return ex(n,e,t)}class be{}class He{}class pt{resolveComponentFactory(e){throw function nt(n){const e=Error(`No component factory found for ${Pi(n)}.`);return e.ngComponent=n,e}(e)}}let Gt=(()=>{class n{static#e=this.NULL=new pt}return n})();function nn(){return Ki(qi(),ge())}function Ki(n,e){return new Cn(Dr(n,e))}let Cn=(()=>{class n{constructor(t){this.nativeElement=t}static#e=this.__NG_ELEMENT_ID__=nn}return n})();function gs(n){return n instanceof Cn?n.nativeElement:n}class Bn{}let Si=(()=>{class n{constructor(){this.destroyNode=null}static#e=this.__NG_ELEMENT_ID__=()=>function ca(){const n=ge(),t=Gr(qi().index,n);return(Fi(t)?t:n)[It]}()}return n})(),tx=(()=>{class n{static#e=this.\u0275prov=Qe({token:n,providedIn:"root",factory:()=>null})}return n})();class yy{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const PW=new yy("16.2.9"),v1={};function KO(n,e=null,t=null,i){const r=ZO(n,e,t,i);return r.resolveInjectorInitializers(),r}function ZO(n,e=null,t=null,i,r=new Set){const s=[t||an,o1(n)];return i=i||("object"==typeof n?void 0:Pi(n)),new bp(s,e||wp(),i||null,r)}let io=(()=>{class n{static#e=this.THROW_IF_NOT_FOUND=id;static#t=this.NULL=new iy;static create(t,i){if(Array.isArray(t))return KO({name:""},i,t,"");{const r=t.name??"";return KO({name:r},t.parent,t.providers,r)}}static#n=this.\u0275prov=Qe({token:n,providedIn:"any",factory:()=>Le(zb)});static#i=this.__NG_ELEMENT_ID__=-1}return n})();function b1(n){return n.ngOriginalError}class Ul{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&b1(e);for(;t&&b1(t);)t=b1(t);return t||null}}function S1(n){return e=>{setTimeout(n,void 0,e)}}const Yn=class BW extends ss{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,i){let r=e,s=t||(()=>null),o=i;if(e&&"object"==typeof e){const l=e;r=l.next?.bind(l),s=l.error?.bind(l),o=l.complete?.bind(l)}this.__isAsync&&(s=S1(s),r&&(r=S1(r)),o&&(o=S1(o)));const a=super.subscribe({next:r,error:s,complete:o});return e instanceof ns&&e.add(a),a}};function QO(...n){}class Dn{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Yn(!1),this.onMicrotaskEmpty=new Yn(!1),this.onStable=new Yn(!1),this.onError=new Yn(!1),typeof Zone>"u")throw new ae(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&t,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function VW(){const n="function"==typeof un.requestAnimationFrame;let e=un[n?"requestAnimationFrame":"setTimeout"],t=un[n?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&t){const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i);const r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function GW(n){const e=()=>{!function zW(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(un,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,C1(n),n.isCheckStableRunning=!0,E1(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),C1(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,r,s,o,a)=>{if(function jW(n){return!(!Array.isArray(n)||1!==n.length)&&!0===n[0].data?.__ignore_ng_zone__}(a))return t.invokeTask(r,s,o,a);try{return eL(n),t.invokeTask(r,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||n.shouldCoalesceRunChangeDetection)&&e(),tL(n)}},onInvoke:(t,i,r,s,o,a,l)=>{try{return eL(n),t.invoke(r,s,o,a,l)}finally{n.shouldCoalesceRunChangeDetection&&e(),tL(n)}},onHasTask:(t,i,r,s)=>{t.hasTask(r,s),i===r&&("microTask"==s.change?(n._hasPendingMicrotasks=s.microTask,C1(n),E1(n)):"macroTask"==s.change&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,i,r,s)=>(t.handleError(r,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Dn.isInAngularZone())throw new ae(909,!1)}static assertNotInAngularZone(){if(Dn.isInAngularZone())throw new ae(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,HW,QO,QO);try{return s.runTask(o,t,i)}finally{s.cancelTask(o)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const HW={};function E1(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function C1(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function eL(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function tL(n){n._nesting--,E1(n)}class WW{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Yn,this.onMicrotaskEmpty=new Yn,this.onStable=new Yn,this.onError=new Yn}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}}const nL=new Ye("",{providedIn:"root",factory:iL});function iL(){const n=ze(Dn);let e=!0;return function J0(...n){const e=Ju(n),t=function pM(n,e){return"number"==typeof Ng(n)?n.pop():e}(n,1/0),i=n;return i.length?1===i.length?os(i[0]):Ic(t)(vi(i,e)):xo}(new Tn(r=>{e=n.isStable&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks,n.runOutsideAngular(()=>{r.next(e),r.complete()})}),new Tn(r=>{let s;n.runOutsideAngular(()=>{s=n.onStable.subscribe(()=>{Dn.assertNotInAngularZone(),queueMicrotask(()=>{!e&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks&&(e=!0,r.next(!0))})})});const o=n.onUnstable.subscribe(()=>{Dn.assertInAngularZone(),e&&(e=!1,n.runOutsideAngular(()=>{r.next(!1)}))});return()=>{s.unsubscribe(),o.unsubscribe()}}).pipe(Lg()))}function Bl(n){return n instanceof Function?n():n}let M1=(()=>{class n{constructor(){this.renderDepth=0,this.handler=null}begin(){this.handler?.validateBegin(),this.renderDepth++}end(){this.renderDepth--,0===this.renderDepth&&this.handler?.execute()}ngOnDestroy(){this.handler?.destroy(),this.handler=null}static#e=this.\u0275prov=Qe({token:n,providedIn:"root",factory:()=>new n})}return n})();function vy(n){for(;n;){n[Ft]|=64;const e=nu(n);if(Jg(n)&&!e)return n;n=e}return null}const lL=new Ye("",{providedIn:"root",factory:()=>!1});let ix=null;function hL(n,e){return n[e]??mL()}function fL(n,e){const t=mL();t.producerNode?.length&&(n[e]=ix,t.lView=n,ix=pL())}const tj={...vw,consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{vy(n.lView)},lView:null};function pL(){return Object.create(tj)}function mL(){return ix??=pL(),ix}const Ht={};function mt(n){gL(Qt(),ge(),yr()+n,!1)}function gL(n,e,t,i){if(!i)if(3==(3&e[Ft])){const s=n.preOrderCheckHooks;null!==s&&wd(e,s,t)}else{const s=n.preOrderHooks;null!==s&&Ls(e,s,0,t)}Ga(t)}function ce(n,e=Xt.Default){const t=ge();return null===t?Le(n,e):Xw(qi(),t,dt(n),e)}function rx(n,e,t,i,r,s,o,a,l,c,d){const h=e.blueprint.slice();return h[En]=r,h[Ft]=140|i,(null!==c||n&&2048&n[Ft])&&(h[Ft]|=2048),If(h),h[$n]=h[Fc]=n,h[pi]=t,h[Lc]=o||n&&n[Lc],h[It]=a||n&&n[It],h[Zo]=l||n&&n[Zo]||null,h[Li]=s,h[Jo]=function MT(){return CT++}(),h[us]=d,h[gf]=c,h[mi]=2==e.type?n[mi]:h,h}function Ap(n,e,t,i,r){let s=n.data[e];if(null===s)s=function T1(n,e,t,i,r){const s=Lf(),o=_d(),l=n.data[e]=function cj(n,e,t,i,r,s){let o=e?e.injectorIndex:-1,a=0;return zc()&&(a|=128),{type:t,index:i,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,i,r);return null===n.firstChild&&(n.firstChild=l),null!==s&&(o?null==s.child&&null!==l.parent&&(s.child=l):null===s.next&&(s.next=l,l.prev=s)),l}(n,e,t,i,r),function Uw(){return xt.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=t,s.value=i,s.attrs=r;const o=function Gc(){const n=xt.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return Os(s,!0),s}function wy(n,e,t,i){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function yL(n,e,t,i,r){const s=hL(e,Qo),o=yr(),a=2&i;try{Ga(-1),a&&e.length>Bt&&gL(n,e,Bt,!1),Do(a?2:0,r);const c=a?s:null,d=wf(c);try{null!==c&&(c.dirty=!1),t(i,r)}finally{Qg(c,d)}}finally{a&&null===e[Qo]&&fL(e,Qo),Ga(o),Do(a?3:1,r)}}function A1(n,e,t){if(zr(e)){const i=ds(null);try{const s=e.directiveEnd;for(let o=e.directiveStart;o<s;o++){const a=n.data[o];a.contentQueries&&a.contentQueries(1,t[o],o)}}finally{ds(i)}}}function D1(n,e,t){hs()&&(function gj(n,e,t,i){const r=t.directiveStart,s=t.directiveEnd;Vt(t)&&function Sj(n,e,t){const i=Dr(e,n),r=vL(t);let o=16;t.signals?o=4096:t.onPush&&(o=64);const a=sx(n,rx(n,r,null,o,i,e,null,n[Lc].rendererFactory.createRenderer(i,t),null,null,null));n[e.index]=a}(e,t,n.data[r+t.componentOffset]),n.firstCreatePass||Wf(t,e),ar(i,e);const o=t.initialInputs;for(let a=r;a<s;a++){const l=n.data[a],c=Dl(e,n,a,t);ar(c,e),null!==o&&Ej(0,a-r,c,l,0,o),Zs(l)&&(Gr(t.index,e)[pi]=Dl(e,n,a,t))}}(n,e,t,Dr(t,e)),64==(64&t.flags)&&EL(n,e,t))}function I1(n,e,t=Dr){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?t(e,n):n[o];n[r++]=a}}}function vL(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=R1(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function R1(n,e,t,i,r,s,o,a,l,c,d){const h=Bt+i,p=h+r,m=function ij(n,e){const t=[];for(let i=0;i<e;i++)t.push(i<n?null:Ht);return t}(h,p),g="function"==typeof c?c():c;return m[Ve]={type:n,blueprint:m,template:t,queries:null,viewQuery:a,declTNode:e,data:m.slice().fill(null,h),bindingStartIndex:h,expandoStartIndex:p,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:g,incompleteFirstPass:!1,ssrId:d}}let wL=n=>null;function bL(n,e,t,i){for(let r in n)if(n.hasOwnProperty(r)){t=null===t?{}:t;const s=n[r];null===i?xL(t,e,r,s):i.hasOwnProperty(r)&&xL(t,e,i[r],s)}return t}function xL(n,e,t,i){n.hasOwnProperty(t)?n[t].push(e,i):n[t]=[e,i]}function P1(n,e,t,i){if(hs()){const r=null===i?null:{"":-1},s=function yj(n,e){const t=n.directiveRegistry;let i=null,r=null;if(t)for(let s=0;s<t.length;s++){const o=t[s];if(fn(e,o.selectors,!1))if(i||(i=[]),Zs(o))if(null!==o.findHostDirectiveDefs){const a=[];r=r||new Map,o.findHostDirectiveDefs(o,a,r),i.unshift(...a,o),N1(n,e,a.length)}else i.unshift(o),N1(n,e,0);else r=r||new Map,o.findHostDirectiveDefs?.(o,i,r),i.push(o)}return null===i?null:[i,r]}(n,t);let o,a;null===s?o=a=null:[o,a]=s,null!==o&&SL(n,e,t,o,r,a),r&&function vj(n,e,t){if(e){const i=n.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new ae(-301,!1);i.push(e[r],s)}}}(t,i,r)}t.mergedAttrs=cd(t.mergedAttrs,t.attrs)}function SL(n,e,t,i,r,s){for(let c=0;c<i.length;c++)Ed(Wf(t,e),n,i[c].type);!function bj(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}(t,n.data.length,i.length);for(let c=0;c<i.length;c++){const d=i[c];d.providersResolver&&d.providersResolver(d)}let o=!1,a=!1,l=wy(n,e,i.length,null);for(let c=0;c<i.length;c++){const d=i[c];t.mergedAttrs=cd(t.mergedAttrs,d.hostAttrs),xj(n,t,e,l,d),wj(l,d,r),null!==d.contentQueries&&(t.flags|=4),(null!==d.hostBindings||null!==d.hostAttrs||0!==d.hostVars)&&(t.flags|=64);const h=d.type.prototype;!o&&(h.ngOnChanges||h.ngOnInit||h.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),o=!0),!a&&(h.ngOnChanges||h.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),l++}!function uj(n,e,t){const r=e.directiveEnd,s=n.data,o=e.attrs,a=[];let l=null,c=null;for(let d=e.directiveStart;d<r;d++){const h=s[d],p=t?t.get(h):null,g=p?p.outputs:null;l=bL(h.inputs,d,l,p?p.inputs:null),c=bL(h.outputs,d,c,g);const v=null===l||null===o||Y(e)?null:Cj(l,d,o);a.push(v)}null!==l&&(l.hasOwnProperty("class")&&(e.flags|=8),l.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=l,e.outputs=c}(n,t,s)}function EL(n,e,t){const i=t.directiveStart,r=t.directiveEnd,s=t.index,o=function Bw(){return xt.lFrame.currentDirectiveIndex}();try{Ga(s);for(let a=i;a<r;a++){const l=n.data[a],c=e[a];Ff(a),(null!==l.hostBindings||0!==l.hostVars||null!==l.hostAttrs)&&_j(l,c)}}finally{Ga(-1),Ff(o)}}function _j(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function N1(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function wj(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;Zs(e)&&(t[""]=n)}}function xj(n,e,t,i,r){n.data[i]=r;const s=r.factory||(r.factory=Sl(r.type)),o=new bd(s,Zs(r),ce);n.blueprint[i]=o,t[i]=o,function pj(n,e,t,i,r){const s=r.hostBindings;if(s){let o=n.hostBindingOpCodes;null===o&&(o=n.hostBindingOpCodes=[]);const a=~e.index;(function mj(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(o)!=a&&o.push(a),o.push(t,i,s)}}(n,e,i,wy(n,t,r.hostVars,Ht),r)}function Ka(n,e,t,i,r,s){const o=Dr(n,e);!function O1(n,e,t,i,r,s,o){if(null==s)n.removeAttribute(e,r,t);else{const a=null==o?Tt(s):o(s,i||"",r);n.setAttribute(e,r,a,t)}}(e[It],o,s,n.value,t,i,r)}function Ej(n,e,t,i,r,s){const o=s[e];if(null!==o)for(let a=0;a<o.length;)CL(i,t,o[a++],o[a++],o[a++])}function CL(n,e,t,i,r){const s=ds(null);try{const o=n.inputTransforms;null!==o&&o.hasOwnProperty(i)&&(r=o[i].call(e,r)),null!==n.setInput?n.setInput(e,r,t,i):e[i]=r}finally{ds(s)}}function Cj(n,e,t){let i=null,r=0;for(;r<t.length;){const s=t[r];if(0!==s)if(5!==s){if("number"==typeof s)break;if(n.hasOwnProperty(s)){null===i&&(i=[]);const o=n[s];for(let a=0;a<o.length;a+=2)if(o[a]===e){i.push(s,o[a+1],t[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function ML(n,e,t,i){return[n,!0,!1,e,null,0,i,t,null,null,null]}function TL(n,e){const t=n.contentQueries;if(null!==t)for(let i=0;i<t.length;i+=2){const s=t[i+1];if(-1!==s){const o=n.data[s];u_(t[i]),o.contentQueries(2,e[s],s)}}}function sx(n,e){return n[ti]?n[rr][Ks]=e:n[ti]=e,n[rr]=e,e}function L1(n,e,t){u_(0);const i=ds(null);try{e(n,t)}finally{ds(i)}}function AL(n){return n[Pa]||(n[Pa]=[])}function DL(n){return n.cleanup||(n.cleanup=[])}function RL(n,e){const t=n[Zo],i=t?t.get(Ul,null):null;i&&i.handleError(e)}function F1(n,e,t,i,r){for(let s=0;s<t.length;){const o=t[s++],a=t[s++];CL(n.data[o],e[o],i,a,r)}}function Vl(n,e,t){const i=md(e,n);!function wb(n,e,t){n.setValue(e,t)}(n[It],i,t)}function Mj(n,e){const t=Gr(e,n),i=t[Ve];!function Tj(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}(i,t);const r=t[En];null!==r&&null===t[us]&&(t[us]=_y(r,t[Zo])),k1(i,t,t[pi])}function k1(n,e,t){Ha(e);try{const i=n.viewQuery;null!==i&&L1(1,i,t);const r=n.template;null!==r&&yL(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&TL(n,e),n.staticViewQueries&&L1(2,n.viewQuery,t);const s=n.components;null!==s&&function Aj(n,e){for(let t=0;t<e.length;t++)Mj(n,e[t])}(e,s)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[Ft]&=-5,za()}}let PL=(()=>{class n{constructor(){this.all=new Set,this.queue=new Map}create(t,i,r){const s=typeof Zone>"u"?null:Zone.current,o=function kM(n,e,t){const i=Object.create(UM);t&&(i.consumerAllowSignalWrites=!0),i.fn=n,i.schedule=e;const r=o=>{i.cleanupFn=o};return i.ref={notify:()=>bw(i),run:()=>{if(i.dirty=!1,i.hasRun&&!Ao(i))return;i.hasRun=!0;const o=wf(i);try{i.cleanupFn(),i.cleanupFn=Mf,i.fn(r)}finally{Qg(i,o)}},cleanup:()=>i.cleanupFn()},i.ref}(t,c=>{this.all.has(c)&&this.queue.set(c,s)},r);let a;this.all.add(o),o.notify();const l=()=>{o.cleanup(),a?.(),this.all.delete(o),this.queue.delete(o)};return a=i?.onDestroy(l),{destroy:l}}flush(){if(0!==this.queue.size)for(const[t,i]of this.queue)this.queue.delete(t),i?i.run(()=>t.run()):t.run()}get isQueueEmpty(){return 0===this.queue.size}static#e=this.\u0275prov=Qe({token:n,providedIn:"root",factory:()=>new n})}return n})();function ox(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?r=ef(r,a):2==s&&(i=ef(i,a+": "+e[++o]+";"))}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}function by(n,e,t,i,r=!1){for(;null!==t;){const s=e[t.index];null!==s&&i.push(Pn(s)),ji(s)&&NL(s,i);const o=t.type;if(8&o)by(n,e,t.child,i);else if(32&o){const a=H_(t,e);let l;for(;l=a();)i.push(l)}else if(16&o){const a=Mb(e,t);if(Array.isArray(a))i.push(...a);else{const l=nu(e[mi]);by(l[Ve],l,a,i,!0)}}t=r?t.projectionNext:t.next}return i}function NL(n,e){for(let t=Wi;t<n.length;t++){const i=n[t],r=i[Ve].firstChild;null!==r&&by(i[Ve],i,r,e)}n[Mo]!==n[En]&&e.push(n[Mo])}function ax(n,e,t,i=!0){const r=e[Lc],s=r.rendererFactory,o=r.afterRenderEventManager;s.begin?.(),o?.begin();try{OL(n,e,n.template,t)}catch(l){throw i&&RL(e,l),l}finally{s.end?.(),r.effectManager?.flush(),o?.end()}}function OL(n,e,t,i){const r=e[Ft];if(256!=(256&r)){e[Lc].effectManager?.flush(),Ha(e);try{If(e),function kw(n){return xt.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&yL(n,e,t,2,i);const o=3==(3&r);if(o){const c=n.preOrderCheckHooks;null!==c&&wd(e,c,null)}else{const c=n.preOrderHooks;null!==c&&Ls(e,c,0,null),Hf(e,0)}if(function Rj(n){for(let e=_b(n);null!==e;e=yb(e)){if(!e[_w])continue;const t=e[ea];for(let i=0;i<t.length;i++){Rw(t[i])}}}(e),LL(e,2),null!==n.contentQueries&&TL(n,e),o){const c=n.contentCheckHooks;null!==c&&wd(e,c)}else{const c=n.contentHooks;null!==c&&Ls(e,c,1),Hf(e,1)}!function nj(n,e){const t=n.hostBindingOpCodes;if(null===t)return;const i=hL(e,Na);try{for(let r=0;r<t.length;r++){const s=t[r];if(s<0)Ga(~s);else{const o=s,a=t[++r],l=t[++r];jM(a,o),i.dirty=!1;const c=wf(i);try{l(2,e[o])}finally{Qg(i,c)}}}}finally{null===e[Na]&&fL(e,Na),Ga(-1)}}(n,e);const a=n.components;null!==a&&kL(e,a,0);const l=n.viewQuery;if(null!==l&&L1(2,l,i),o){const c=n.viewCheckHooks;null!==c&&wd(e,c)}else{const c=n.viewHooks;null!==c&&Ls(e,c,2),Hf(e,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),e[Ft]&=-73,Rf(e)}finally{za()}}}function LL(n,e){for(let t=_b(n);null!==t;t=yb(t))for(let i=Wi;i<t.length;i++)FL(t[i],e)}function Pj(n,e,t){FL(Gr(e,n),t)}function FL(n,e){if(!function HM(n){return 128==(128&n[Ft])}(n))return;const t=n[Ve],i=n[Ft];if(80&i&&0===e||1024&i||2===e)OL(t,n,t.template,n[pi]);else if(n[Ra]>0){LL(n,1);const r=t.components;null!==r&&kL(n,r,1)}}function kL(n,e,t){for(let i=0;i<e.length;i++)Pj(n,e[i],t)}class xy{get rootNodes(){const e=this._lView,t=e[Ve];return by(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[pi]}set context(e){this._lView[pi]=e}get destroyed(){return 256==(256&this._lView[Ft])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[$n];if(ji(e)){const t=e[8],i=t?t.indexOf(this):-1;i>-1&&(cp(e,i),$f(t,i))}this._attachedToViewContainer=!1}vr(this._lView[Ve],this._lView)}onDestroy(e){!function Pf(n,e){if(256==(256&n[Ft]))throw new ae(911,!1);null===n[cs]&&(n[cs]=[]),n[cs].push(e)}(this._lView,e)}markForCheck(){vy(this._cdRefInjectingView||this._lView)}detach(){this._lView[Ft]&=-129}reattach(){this._lView[Ft]|=128}detectChanges(){ax(this._lView[Ve],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ae(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function no(n,e){Fl(n,e,e[It],2,null,null)}(this._lView[Ve],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new ae(902,!1);this._appRef=e}}class Nj extends xy{constructor(e){super(e),this._view=e}detectChanges(){const e=this._view;ax(e[Ve],e,e[pi],!1)}checkNoChanges(){}get context(){return null}}class UL extends Gt{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=Zt(e);return new Sy(t,this.ngModule)}}function BL(n){const e=[];for(let t in n)n.hasOwnProperty(t)&&e.push({propName:n[t],templateName:t});return e}class Lj{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){i=sd(i);const r=this.injector.get(e,v1,i);return r!==v1||t===v1?r:this.parentInjector.get(e,t,i)}}class Sy extends He{get inputs(){const e=this.componentDef,t=e.inputTransforms,i=BL(e.inputs);if(null!==t)for(const r of i)t.hasOwnProperty(r.propName)&&(r.transform=t[r.propName]);return i}get outputs(){return BL(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function DM(n){return n.map(ff).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,i,r){let s=(r=r||this.ngModule)instanceof ms?r:r?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const o=s?new Lj(e,s):e,a=o.get(Bn,null);if(null===a)throw new ae(407,!1);const h={rendererFactory:a,sanitizer:o.get(tx,null),effectManager:o.get(PL,null),afterRenderEventManager:o.get(M1,null)},p=a.createRenderer(null,this.componentDef),m=this.componentDef.selectors[0][0]||"div",g=i?function rj(n,e,t,i){const s=i.get(lL,!1)||t===Rs.ShadowDom,o=n.selectRootElement(e,s);return function sj(n){wL(n)}(o),o}(p,i,this.componentDef.encapsulation,o):lp(p,m,function Oj(n){const e=n.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(m)),y=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let b=null;null!==g&&(b=_y(g,o,!0));const x=R1(0,null,null,1,0,null,null,null,null,null,null),E=rx(null,x,null,y,null,null,h,p,o,null,b);let C,A;Ha(E);try{const D=this.componentDef;let L,M=null;D.findHostDirectiveDefs?(L=[],M=new Map,D.findHostDirectiveDefs(D,L,M),L.push(D)):L=[D];const R=function kj(n,e){const t=n[Ve],i=Bt;return n[i]=e,Ap(t,i,2,"#host",null)}(E,g),$=function Uj(n,e,t,i,r,s,o){const a=r[Ve];!function Bj(n,e,t,i){for(const r of n)e.mergedAttrs=cd(e.mergedAttrs,r.hostAttrs);null!==e.mergedAttrs&&(ox(e,e.mergedAttrs,!0),null!==t&&Ab(i,t,e))}(i,n,e,o);let l=null;null!==e&&(l=_y(e,r[Zo]));const c=s.rendererFactory.createRenderer(e,t);let d=16;t.signals?d=4096:t.onPush&&(d=64);const h=rx(r,vL(t),null,d,r[n.index],n,s,c,null,null,l);return a.firstCreatePass&&N1(a,n,i.length-1),sx(r,h),r[n.index]=h}(R,g,D,L,E,h,p);A=gd(x,Bt),g&&function Hj(n,e,t,i){if(i)df(n,t,["ng-version",PW.full]);else{const{attrs:r,classes:s}=function Oc(n){const e=[],t=[];let i=1,r=2;for(;i<n.length;){let s=n[i];if("string"==typeof s)2===r?""!==s&&e.push(s,n[++i]):8===r&&t.push(s);else{if(!Ue(r))break;r=s}i++}return{attrs:e,classes:t}}(e.selectors[0]);r&&df(n,t,r),s&&s.length>0&&Tb(n,t,s.join(" "))}}(p,D,g,i),void 0!==t&&function zj(n,e,t){const i=n.projection=[];for(let r=0;r<e.length;r++){const s=t[r];i.push(null!=s?Array.from(s):null)}}(A,this.ngContentSelectors,t),C=function Vj(n,e,t,i,r,s){const o=qi(),a=r[Ve],l=Dr(o,r);SL(a,r,o,t,null,i);for(let d=0;d<t.length;d++)ar(Dl(r,a,o.directiveStart+d,o),r);EL(a,r,o),l&&ar(l,r);const c=Dl(r,a,o.directiveStart+o.componentOffset,o);if(n[pi]=r[pi]=c,null!==s)for(const d of s)d(c,e);return A1(a,o,n),c}($,D,L,M,E,[Gj]),k1(x,E,null)}finally{za()}return new Fj(this.componentType,C,Ki(A,E),E,A)}}class Fj extends be{constructor(e,t,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new Nj(r),this.componentType=e}setInput(e,t){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;const s=this._rootLView;F1(s[Ve],s,r,e,t),this.previousInputValues.set(e,t),vy(Gr(this._tNode.index,s))}}get injector(){return new Rr(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function Gj(){const n=qi();Vf(ge()[Ve],n)}function wn(n){let e=function VL(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),t=!0;const i=[n];for(;e;){let r;if(Zs(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new ae(903,!1);r=e.\u0275dir}if(r){if(t){i.push(r);const o=n;o.inputs=lx(n.inputs),o.inputTransforms=lx(n.inputTransforms),o.declaredInputs=lx(n.declaredInputs),o.outputs=lx(n.outputs);const a=r.hostBindings;a&&qj(n,a);const l=r.viewQuery,c=r.contentQueries;if(l&&jj(n,l),c&&$j(n,c),Pc(n.inputs,r.inputs),Pc(n.declaredInputs,r.declaredInputs),Pc(n.outputs,r.outputs),null!==r.inputTransforms&&(null===o.inputTransforms&&(o.inputTransforms={}),Pc(o.inputTransforms,r.inputTransforms)),Zs(r)&&r.data.animation){const d=n.data;d.animation=(d.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(n),a===wn&&(t=!1)}}e=Object.getPrototypeOf(e)}!function Wj(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){const r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=cd(r.hostAttrs,t=cd(t,r.hostAttrs))}}(i)}function lx(n){return n===Eo?{}:n===an?[]:n}function jj(n,e){const t=n.viewQuery;n.viewQuery=t?(i,r)=>{e(i,r),t(i,r)}:e}function $j(n,e){const t=n.contentQueries;n.contentQueries=t?(i,r,s)=>{e(i,r,s),t(i,r,s)}:e}function qj(n,e){const t=n.hostBindings;n.hostBindings=t?(i,r)=>{e(i,r),t(i,r)}:e}function cx(n){return!!U1(n)&&(Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n)}function U1(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function Za(n,e,t){return n[e]=t}function $r(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function Hd(n,e,t,i){const r=$r(n,e,t);return $r(n,e+1,i)||r}function ui(n,e,t,i){const r=ge();return $r(r,Wc(),e)&&(Qt(),Ka(Nn(),r,n,e,t,i)),ui}function Rp(n,e,t,i,r,s){const a=Hd(n,function Js(){return xt.lFrame.bindingIndex}(),t,r);return ia(2),a?e+Tt(t)+i+Tt(r)+s:Ht}function en(n,e,t,i,r,s,o,a){const l=ge(),c=Qt(),d=n+Bt,h=c.firstCreatePass?function y8(n,e,t,i,r,s,o,a,l){const c=e.consts,d=Ap(e,n,4,o||null,Va(c,a));P1(e,t,d,Va(c,l)),Vf(e,d);const h=d.tView=R1(2,d,i,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c,null);return null!==e.queries&&(e.queries.template(e,d),h.queries=e.queries.embeddedTView(d)),d}(d,c,l,e,t,i,r,s,o):c.data[d];Os(h,!1);const p=r2(c,l,h,n);Tl()&&dp(c,l,p,h),ar(p,l),sx(l,l[d]=ML(p,l,p,h)),yf(h)&&D1(c,l,h),null!=o&&I1(l,h,a)}let r2=function s2(n,e,t,i){return ra(!0),e[It].createComment("")};function Ay(n){return Hc(function WM(){return xt.lFrame.contextLView}(),Bt+n)}function ut(n,e,t){const i=ge();return $r(i,Wc(),e)&&function ro(n,e,t,i,r,s,o,a){const l=Dr(e,t);let d,c=e.inputs;!a&&null!=c&&(d=c[i])?(F1(n,t,d,i,r),Vt(e)&&function hj(n,e){const t=Gr(e,n);16&t[Ft]||(t[Ft]|=64)}(t,e.index)):3&e.type&&(i=function dj(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=o?o(r,e.value||"",i):r,s.setProperty(l,i,r))}(Qt(),Nn(),i,n,e,i[It],t,!1),ut}function W1(n,e,t,i,r){const o=r?"class":"style";F1(n,t,e.inputs[o],o,i)}function St(n,e,t,i){const r=ge(),s=Qt(),o=Bt+n,a=r[It],l=s.firstCreatePass?function x8(n,e,t,i,r,s){const o=e.consts,l=Ap(e,n,2,i,Va(o,r));return P1(e,t,l,Va(o,s)),null!==l.attrs&&ox(l,l.attrs,!1),null!==l.mergedAttrs&&ox(l,l.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,l),l}(o,s,r,e,t,i):s.data[o],c=o2(s,r,l,a,e,n);r[o]=c;const d=yf(l);return Os(l,!0),Ab(a,c,l),32!=(32&l.flags)&&Tl()&&dp(s,r,c,l),0===function Ow(){return xt.lFrame.elementDepthCount}()&&ar(c,r),function zM(){xt.lFrame.elementDepthCount++}(),d&&(D1(s,r,l),A1(s,l,r)),null!==i&&I1(r,l),St}function vt(){let n=qi();_d()?Io():(n=n.parent,Os(n,!1));const e=n;(function Of(n){return xt.skipHydrationRootTNode===n})(e)&&function fs(){xt.skipHydrationRootTNode=null}(),function GM(){xt.lFrame.elementDepthCount--}();const t=Qt();return t.firstCreatePass&&(Vf(t,n),zr(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function zf(n){return 0!=(8&n.flags)}(e)&&W1(t,e,ge(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function $c(n){return 0!=(16&n.flags)}(e)&&W1(t,e,ge(),e.stylesWithoutHost,!1),vt}function Nr(n,e,t,i){return St(n,e,t,i),vt(),Nr}let o2=(n,e,t,i,r,s)=>(ra(!0),lp(i,r,function Hw(){return xt.lFrame.currentNamespace}()));function du(n,e,t){const i=ge(),r=Qt(),s=n+Bt,o=r.firstCreatePass?function C8(n,e,t,i,r){const s=e.consts,o=Va(s,i),a=Ap(e,n,8,"ng-container",o);return null!==o&&ox(a,o,!0),P1(e,t,a,Va(s,r)),null!==e.queries&&e.queries.elementStart(e,a),a}(s,r,i,e,t):r.data[s];Os(o,!0);const a=a2(r,i,o,n);return i[s]=a,Tl()&&dp(r,i,a,o),ar(a,i),yf(o)&&(D1(r,i,o),A1(r,o,i)),null!=t&&I1(i,o),du}function hu(){let n=qi();const e=Qt();return _d()?Io():(n=n.parent,Os(n,!1)),e.firstCreatePass&&(Vf(e,n),zr(n)&&e.queries.elementEnd(n)),hu}function Up(n,e,t){return du(n,e,t),hu(),Up}let a2=(n,e,t,i)=>(ra(!0),G_(e[It],""));function Hl(){return ge()}function Dy(n){return!!n&&"function"==typeof n.then}function l2(n){return!!n&&"function"==typeof n.subscribe}function pn(n,e,t,i){const r=ge(),s=Qt(),o=qi();return function u2(n,e,t,i,r,s,o){const a=yf(i),c=n.firstCreatePass&&DL(n),d=e[pi],h=AL(e);let p=!0;if(3&i.type||o){const v=Dr(i,e),w=o?o(v):v,y=h.length,b=o?E=>o(Pn(E[i.index])):i.index;let x=null;if(!o&&a&&(x=function A8(n,e,t,i){const r=n.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===t&&r[s+1]===i){const a=e[Pa],l=r[s+2];return a.length>l?a[l]:null}"string"==typeof o&&(s+=2)}return null}(n,e,r,i.index)),null!==x)(x.__ngLastListenerFn__||x).__ngNextListenerFn__=s,x.__ngLastListenerFn__=s,p=!1;else{s=h2(i,e,d,s,!1);const E=t.listen(w,r,s);h.push(s,E),c&&c.push(r,b,y,y+1)}}else s=h2(i,e,d,s,!1);const m=i.outputs;let g;if(p&&null!==m&&(g=m[r])){const v=g.length;if(v)for(let w=0;w<v;w+=2){const C=e[g[w]][g[w+1]].subscribe(s),A=h.length;h.push(s,C),c&&c.push(r,i.index,A,-(A+1))}}}(s,r,r[It],o,n,e,i),pn}function d2(n,e,t,i){try{return Do(6,e,t),!1!==t(i)}catch(r){return RL(n,r),!1}finally{Do(7,e,t)}}function h2(n,e,t,i,r){return function s(o){if(o===Function)return i;vy(n.componentOffset>-1?Gr(n.index,e):e);let l=d2(e,t,i,o),c=s.__ngNextListenerFn__;for(;c;)l=d2(e,t,c,o)&&l,c=c.__ngNextListenerFn__;return r&&!1===l&&o.preventDefault(),l}}function rn(n=1){return function vd(n){return(xt.lFrame.contextLView=function qM(n,e){for(;n>0;)e=e[Fc],n--;return e}(n,xt.lFrame.contextLView))[pi]}(n)}function D8(n,e){let t=null;const i=function Ni(n){const e=n.attrs;if(null!=e){const t=e.indexOf(5);if(!(1&t))return e[t+1]}return null}(n);for(let r=0;r<e.length;r++){const s=e[r];if("*"!==s){if(null===i?fn(n,s,!0):AM(i,s))return r}else t=r}return t}function j1(n){const e=ge()[mi][Li];if(!e.projection){const i=e.projection=Td(n?n.length:1,null),r=i.slice();let s=e.child;for(;null!==s;){const o=n?D8(s,n):0;null!==o&&(r[o]?r[o].projectionNext=s:i[o]=s,r[o]=s),s=s.next}}}function $1(n,e=0,t){const i=ge(),r=Qt(),s=Ap(r,Bt+n,16,null,t||null);null===s.projection&&(s.projection=e),Io(),(!i[us]||zc())&&32!=(32&s.flags)&&function UT(n,e,t){X_(e[It],0,e,t,W_(n,t,e),Id(t.parent||e[Li],t,e))}(r,i,s)}function px(n,e){return n<<17|e<<2}function fu(n){return n>>17&32767}function X1(n){return 2|n}function zd(n){return(131068&n)>>2}function Y1(n,e){return-131069&n|e<<2}function K1(n){return 1|n}function x2(n,e,t,i,r){const s=n[t+1],o=null===e;let a=i?fu(s):zd(s),l=!1;for(;0!==a&&(!1===l||o);){const d=n[a+1];L8(n[a],e)&&(l=!0,n[a+1]=i?K1(d):X1(d)),a=i?fu(d):zd(d)}l&&(n[t+1]=i?X1(s):K1(s))}function L8(n,e){return null===n||null==e||(Array.isArray(n)?n[1]:n)===e||!(!Array.isArray(n)||"string"!=typeof e)&&Jc(n,e)>=0}const lr={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function S2(n){return n.substring(lr.key,lr.keyEnd)}function E2(n,e){const t=lr.textEnd;return t===e?-1:(e=lr.keyEnd=function B8(n,e,t){for(;e<t&&n.charCodeAt(e)>32;)e++;return e}(n,lr.key=e,t),Bp(n,e,t))}function Bp(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function Iy(n,e){return function ua(n,e,t,i){const r=ge(),s=Qt(),o=ia(2);s.firstUpdatePass&&R2(s,n,o,i),e!==Ht&&$r(r,o,e)&&N2(s,s.data[yr()],r,r[It],n,r[o+1]=function K8(n,e){return null==n||""===n||("string"==typeof e?n+=e:"object"==typeof n&&(n=Pi(qa(n)))),n}(e,t),i,o)}(n,e,null,!0),Iy}function zl(n){!function da(n,e,t,i){const r=Qt(),s=ia(2);r.firstUpdatePass&&R2(r,null,s,i);const o=ge();if(t!==Ht&&$r(o,s,t)){const a=r.data[yr()];if(L2(a,i)&&!I2(r,s)){let l=i?a.classesWithoutHost:a.stylesWithoutHost;null!==l&&(t=ef(l,t||"")),W1(r,a,o,t,i)}else!function Y8(n,e,t,i,r,s,o,a){r===Ht&&(r=an);let l=0,c=0,d=0<r.length?r[0]:null,h=0<s.length?s[0]:null;for(;null!==d||null!==h;){const p=l<r.length?r[l+1]:void 0,m=c<s.length?s[c+1]:void 0;let v,g=null;d===h?(l+=2,c+=2,p!==m&&(g=h,v=m)):null===h||null!==d&&d<h?(l+=2,g=d):(c+=2,g=h,v=m),null!==g&&N2(n,e,t,i,g,v,o,a),d=l<r.length?r[l]:null,h=c<s.length?s[c]:null}}(r,a,o,o[It],o[s+1],o[s+1]=function q8(n,e,t){if(null==t||""===t)return an;const i=[],r=qa(t);if(Array.isArray(r))for(let s=0;s<r.length;s++)n(i,r[s],!0);else if("object"==typeof r)for(const s in r)r.hasOwnProperty(s)&&n(i,s,r[s]);else"string"==typeof r&&e(i,r);return i}(n,e,t),i,s)}}(X8,Qa,n,!0)}function Qa(n,e){for(let t=function k8(n){return function M2(n){lr.key=0,lr.keyEnd=0,lr.value=0,lr.valueEnd=0,lr.textEnd=n.length}(n),E2(n,Bp(n,0,lr.textEnd))}(e);t>=0;t=E2(e,t))qn(n,S2(e),!0)}function I2(n,e){return e>=n.expandoStartIndex}function R2(n,e,t,i){const r=n.data;if(null===r[t+1]){const s=r[yr()],o=I2(n,t);L2(s,i)&&null===e&&!o&&(e=!1),e=function G8(n,e,t,i){const r=function _r(n){const e=xt.lFrame.currentDirectiveIndex;return-1===e?null:n[e]}(n);let s=i?e.residualClasses:e.residualStyles;if(null===r)0===(i?e.classBindings:e.styleBindings)&&(t=Ry(t=Z1(null,n,e,t,i),e.attrs,i),s=null);else{const o=e.directiveStylingLast;if(-1===o||n[o]!==r)if(t=Z1(r,n,e,t,i),null===s){let l=function W8(n,e,t){const i=t?e.classBindings:e.styleBindings;if(0!==zd(i))return n[fu(i)]}(n,e,i);void 0!==l&&Array.isArray(l)&&(l=Z1(null,n,e,l[1],i),l=Ry(l,e.attrs,i),function j8(n,e,t,i){n[fu(t?e.classBindings:e.styleBindings)]=i}(n,e,i,l))}else s=function $8(n,e,t){let i;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)i=Ry(i,n[s].hostAttrs,t);return Ry(i,e.attrs,t)}(n,e,i)}return void 0!==s&&(i?e.residualClasses=s:e.residualStyles=s),t}(r,s,e,i),function N8(n,e,t,i,r,s){let o=s?e.classBindings:e.styleBindings,a=fu(o),l=zd(o);n[i]=t;let d,c=!1;if(Array.isArray(t)?(d=t[1],(null===d||Jc(t,d)>0)&&(c=!0)):d=t,r)if(0!==l){const p=fu(n[a+1]);n[i+1]=px(p,a),0!==p&&(n[p+1]=Y1(n[p+1],i)),n[a+1]=function R8(n,e){return 131071&n|e<<17}(n[a+1],i)}else n[i+1]=px(a,0),0!==a&&(n[a+1]=Y1(n[a+1],i)),a=i;else n[i+1]=px(l,0),0===a?a=i:n[l+1]=Y1(n[l+1],i),l=i;c&&(n[i+1]=X1(n[i+1])),x2(n,d,i,!0),x2(n,d,i,!1),function O8(n,e,t,i,r){const s=r?n.residualClasses:n.residualStyles;null!=s&&"string"==typeof e&&Jc(s,e)>=0&&(t[i+1]=K1(t[i+1]))}(e,d,n,i,s),o=px(a,l),s?e.classBindings=o:e.styleBindings=o}(r,s,e,t,o,i)}}function Z1(n,e,t,i,r){let s=null;const o=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<o&&(s=e[a],i=Ry(i,s.hostAttrs,r),s!==n);)a++;return null!==n&&(t.directiveStylingLast=a),i}function Ry(n,e,t){const i=t?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?r=o:r===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),qn(n,o,!!t||e[++s]))}return void 0===n?null:n}function X8(n,e,t){const i=String(e);""!==i&&!i.includes(" ")&&qn(n,i,t)}function N2(n,e,t,i,r,s,o,a){if(!(3&e.type))return;const l=n.data,c=l[a+1],d=function P8(n){return 1==(1&n)}(c)?O2(l,e,t,r,zd(c),o):void 0;mx(d)||(mx(s)||function I8(n){return 2==(2&n)}(c)&&(s=O2(l,null,t,r,a,o)),function ps(n,e,t,i,r){if(e)r?n.addClass(t,i):n.removeClass(t,i);else{let s=-1===i.indexOf("-")?void 0:ja.DashCase;null==r?n.removeStyle(t,i,s):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),s|=ja.Important),n.setStyle(t,i,r,s))}}(i,o,md(yr(),t),r,s))}function O2(n,e,t,i,r,s){const o=null===e;let a;for(;r>0;){const l=n[r],c=Array.isArray(l),d=c?l[1]:l,h=null===d;let p=t[r+1];p===Ht&&(p=h?an:void 0);let m=h?M_(p,i):d===i?p:void 0;if(c&&!mx(m)&&(m=M_(l,i)),mx(m)&&(a=m,o))return a;const g=n[r+1];r=o?fu(g):zd(g)}if(null!==e){let l=s?e.residualClasses:e.residualStyles;null!=l&&(a=M_(l,i))}return a}function mx(n){return void 0!==n}function L2(n,e){return 0!=(n.flags&(e?8:16))}function bn(n,e=""){const t=ge(),i=Qt(),r=n+Bt,s=i.firstCreatePass?Ap(i,r,1,e,null):i.data[r],o=F2(i,t,s,e,n);t[r]=o,Tl()&&dp(i,t,o,s),Os(s,!1)}let F2=(n,e,t,i,r)=>(ra(!0),function ap(n,e){return n.createText(e)}(e[It],i));function Gl(n){return Gd("",n,""),Gl}function Gd(n,e,t){const i=ge(),r=function Ip(n,e,t,i){return $r(n,Wc(),t)?e+Tt(t)+i:Ht}(i,n,e,t);return r!==Ht&&Vl(i,yr(),r),Gd}function J1(n,e,t,i,r){const s=ge(),o=Rp(s,n,e,t,i,r);return o!==Ht&&Vl(s,yr(),o),J1}const Hp="en-US";let iF=Hp;function tA(n,e,t,i,r){if(n=dt(n),Array.isArray(n))for(let s=0;s<n.length;s++)tA(n[s],e,t,i,r);else{const s=Qt(),o=ge(),a=qi();let l=Xa(n)?n:dt(n.provide);const c=Xb(n),d=1048575&a.providerIndexes,h=a.directiveStart,p=a.providerIndexes>>20;if(Xa(n)||!n.multi){const m=new bd(c,r,ce),g=iA(l,e,r?d:d+p,h);-1===g?(Ed(Wf(a,o),s,l),nA(s,n,e.length),e.push(l),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(m),o.push(m)):(t[g]=m,o[g]=m)}else{const m=iA(l,e,d+p,h),g=iA(l,e,d,d+p),w=g>=0&&t[g];if(r&&!w||!r&&!(m>=0&&t[m])){Ed(Wf(a,o),s,l);const y=function _$(n,e,t,i,r){const s=new bd(n,t,ce);return s.multi=[],s.index=e,s.componentProviders=0,AF(s,r,i&&!t),s}(r?g$:m$,t.length,r,i,c);!r&&w&&(t[g].providerFactory=y),nA(s,n,e.length,0),e.push(l),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(y),o.push(y)}else nA(s,n,m>-1?m:g,AF(t[r?g:m],c,!r&&i));!r&&i&&w&&t[g].componentProviders++}}}function nA(n,e,t,i){const r=Xa(e),s=function qb(n){return!!n.useClass}(e);if(r||s){const l=(s?dt(e.useClass):e).prototype.ngOnDestroy;if(l){const c=n.destroyHooks||(n.destroyHooks=[]);if(!r&&e.multi){const d=c.indexOf(t);-1===d?c.push(t,[i,l]):c[d+1].push(i,l)}else c.push(t,l)}}}function AF(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function iA(n,e,t,i){for(let r=t;r<i;r++)if(e[r]===n)return r;return-1}function m$(n,e,t,i){return rA(this.multi,[])}function g$(n,e,t,i){const r=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=Dl(t,t[Ve],this.providerFactory.index,i);s=a.slice(0,o),rA(r,s);for(let l=o;l<a.length;l++)s.push(a[l])}else s=[],rA(r,s);return s}function rA(n,e){for(let t=0;t<n.length;t++)e.push((0,n[t])());return e}function Vn(n,e=[]){return t=>{t.providersResolver=(i,r)=>function p$(n,e,t){const i=Qt();if(i.firstCreatePass){const r=Zs(n);tA(t,i.data,i.blueprint,r,!0),tA(e,i.data,i.blueprint,r,!1)}}(i,r?r(n):n,e)}}class jd{}class DF{}class sA extends jd{constructor(e,t,i){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new UL(this);const r=mr(e);this._bootstrapComponents=Bl(r.bootstrap),this._r3Injector=ZO(e,t,[{provide:jd,useValue:this},{provide:Gt,useValue:this.componentFactoryResolver},...i],Pi(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class oA extends DF{constructor(e){super(),this.moduleType=e}create(e){return new sA(this.moduleType,e,[])}}class IF extends jd{constructor(e){super(),this.componentFactoryResolver=new UL(this),this.instance=null;const t=new bp([...e.providers,{provide:jd,useValue:this},{provide:Gt,useValue:this.componentFactoryResolver}],e.parent||wp(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function aA(n,e,t=null){return new IF({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}let w$=(()=>{class n{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){const i=Wb(0,t.type),r=i.length>0?aA([i],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,r)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}static#e=this.\u0275prov=Qe({token:n,providedIn:"environment",factory:()=>new n(Le(ms))})}return n})();function ky(n){n.getStandaloneInjector=e=>e.get(w$).getOrCreateStandaloneInjector(n)}function Uy(n,e,t,i){return UF(ge(),gr(),n,e,t,i)}function kF(n,e,t,i,r){return function BF(n,e,t,i,r,s,o){const a=e+t;return Hd(n,a,r,s)?Za(n,a+2,o?i.call(o,r,s):i(r,s)):By(n,a+2)}(ge(),gr(),n,e,t,i,r)}function wx(n,e,t,i,r,s){return function VF(n,e,t,i,r,s,o,a){const l=e+t;return function ux(n,e,t,i,r){const s=Hd(n,e,t,i);return $r(n,e+2,r)||s}(n,l,r,s,o)?Za(n,l+3,a?i.call(a,r,s,o):i(r,s,o)):By(n,l+3)}(ge(),gr(),n,e,t,i,r,s)}function By(n,e){const t=n[e];return t===Ht?void 0:t}function UF(n,e,t,i,r,s){const o=e+t;return $r(n,o,r)?Za(n,o+1,s?i.call(s,r):i(r)):By(n,o+1)}function WF(n,e,t){const i=n+Bt,r=ge(),s=Hc(r,i);return function Vy(n,e){return n[Ve].data[e].pure}(r,i)?UF(r,gr(),e,s.transform,t,s):s.transform(t)}function H$(){return this._results[Symbol.iterator]()}class cA{static#e=Symbol.iterator;get changes(){return this._changes||(this._changes=new Yn)}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=cA.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=H$)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const i=this;i.dirty=!1;const r=function Fs(n){return n.flat(Number.POSITIVE_INFINITY)}(e);(this._changesDetected=!function nT(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],s=e[i];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}(i._results,r,t))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}function G$(n,e,t,i=!0){const r=e[Ve];if(function FT(n,e,t,i){const r=Wi+i,s=t.length;i>0&&(t[r-1][Ks]=e),i<s-Wi?(e[Ks]=t[r],C_(t,Wi+i,e)):(t.push(e),e[Ks]=null),e[$n]=t;const o=e[kc];null!==o&&t!==o&&function Nl(n,e){const t=n[ea];e[mi]!==e[$n][$n][mi]&&(n[_w]=!0),null===t?n[ea]=[e]:t.push(e)}(o,e);const a=e[Ns];null!==a&&a.insertView(n),e[Ft]|=128}(r,e,n,t),i){const s=$_(t,n),o=e[It],a=ks(o,n[Mo]);null!==a&&function OT(n,e,t,i,r,s){i[En]=r,i[Li]=e,Fl(n,i,t,1,r,s)}(r,n[Li],o,e,a,s)}}let el=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=$$}return n})();const W$=el,j$=class extends W${constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,i){const r=function z$(n,e,t,i){const r=e.tView,a=rx(n,r,t,4096&n[Ft]?4096:16,null,e,null,null,null,i?.injector??null,i?.hydrationInfo??null);a[kc]=n[e.index];const c=n[Ns];return null!==c&&(a[Ns]=c.createEmbeddedView(r)),k1(r,a,t),a}(this._declarationLView,this._declarationTContainer,e,{injector:t,hydrationInfo:i});return new xy(r)}};function $$(){return bx(qi(),ge())}function bx(n,e){return 4&n.type?new j$(e,n,Ki(n,e)):null}let ha=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=J$}return n})();function J$(){return ZF(qi(),ge())}const Q$=ha,YF=class extends Q${constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return Ki(this._hostTNode,this._hostLView)}get injector(){return new Rr(this._hostTNode,this._hostLView)}get parentInjector(){const e=Xi(this._hostTNode,this._hostLView);if(Sd(e)){const t=Al(e,this._hostLView),i=eo(e);return new Rr(t[Ve].data[i+8],t)}return new Rr(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=KF(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-Wi}createEmbeddedView(e,t,i){let r,s;"number"==typeof i?r=i:null!=i&&(r=i.index,s=i.injector);const a=e.createEmbeddedViewImpl(t||{},s,null);return this.insertImpl(a,r,false),a}createComponent(e,t,i,r,s){const o=e&&!function Kc(n){return"function"==typeof n}(e);let a;if(o)a=t;else{const v=t||{};a=v.index,i=v.injector,r=v.projectableNodes,s=v.environmentInjector||v.ngModuleRef}const l=o?e:new Sy(Zt(e)),c=i||this.parentInjector;if(!s&&null==l.ngModule){const w=(o?c:this.parentInjector).get(ms,null);w&&(s=w)}Zt(l.componentType??{});const m=l.create(c,r,null,s);return this.insertImpl(m.hostView,a,false),m}insert(e,t){return this.insertImpl(e,t,!1)}insertImpl(e,t,i){const r=e._lView;if(function Iw(n){return ji(n[$n])}(r)){const l=this.indexOf(e);if(-1!==l)this.detach(l);else{const c=r[$n],d=new YF(c,c[Li],c[$n]);d.detach(d.indexOf(e))}}const o=this._adjustIndex(t),a=this._lContainer;return G$(a,r,o,!i),e.attachToViewContainerRef(),C_(uA(a),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=KF(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=cp(this._lContainer,t);i&&($f(uA(this._lContainer),t),vr(i[Ve],i))}detach(e){const t=this._adjustIndex(e,-1),i=cp(this._lContainer,t);return i&&null!=$f(uA(this._lContainer),t)?new xy(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function KF(n){return n[8]}function uA(n){return n[8]||(n[8]=[])}function ZF(n,e){let t;const i=e[n.index];return ji(i)?t=i:(t=ML(i,e,null,n),e[n.index]=t,sx(e,t)),JF(t,e,n,i),new YF(t,n,e)}let JF=function QF(n,e,t,i){if(n[Mo])return;let r;r=8&t.type?Pn(i):function e9(n,e){const t=n[It],i=t.createComment(""),r=Dr(e,n);return Ol(t,ks(t,r),i,function Eb(n,e){return n.nextSibling(e)}(t,r),!1),i}(e,t),n[Mo]=r};class dA{constructor(e){this.queryList=e,this.matches=null}clone(){return new dA(this.queryList)}setDirty(){this.queryList.setDirty()}}class hA{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let s=0;s<i;s++){const o=t.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new hA(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==rk(e,t).matches&&this.queries[t].setDirty()}}class ek{constructor(e,t,i=null){this.predicate=e,this.flags=t,this.read=i}}class fA{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,s=this.getByIndex(i).embeddedTView(e,r);s&&(s.indexInDeclarationView=i,null!==t?t.push(s):t=[s])}return null!==t?new fA(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class pA{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new pA(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(e,t,i9(t,s)),this.matchTNodeWithReadOption(e,t,Cd(t,e,s,!1,!1))}else i===el?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Cd(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===Cn||r===ha||r===el&&4&t.type)this.addMatch(t.index,-2);else{const s=Cd(t,e,r,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function i9(n,e){const t=n.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1];return null}function s9(n,e,t,i){return-1===t?function r9(n,e){return 11&n.type?Ki(n,e):4&n.type?bx(n,e):null}(e,n):-2===t?function o9(n,e,t){return t===Cn?Ki(e,n):t===el?bx(e,n):t===ha?ZF(e,n):void 0}(n,e,i):Dl(n,n[Ve],t,e)}function tk(n,e,t,i){const r=e[Ns].queries[i];if(null===r.matches){const s=n.data,o=t.matches,a=[];for(let l=0;l<o.length;l+=2){const c=o[l];a.push(c<0?null:s9(e,s[c],o[l+1],t.metadata.read))}r.matches=a}return r.matches}function mA(n,e,t,i){const r=n.queries.getByIndex(t),s=r.matches;if(null!==s){const o=tk(n,e,r,t);for(let a=0;a<s.length;a+=2){const l=s[a];if(l>0)i.push(o[a/2]);else{const c=s[a+1],d=e[-l];for(let h=Wi;h<d.length;h++){const p=d[h];p[kc]===p[$n]&&mA(p[Ve],p,c,i)}if(null!==d[ea]){const h=d[ea];for(let p=0;p<h.length;p++){const m=h[p];mA(m[Ve],m,c,i)}}}}}return i}function zp(n){const e=ge(),t=Qt(),i=Qs();u_(i+1);const r=rk(t,i);if(n.dirty&&function Dw(n){return 4==(4&n[Ft])}(e)===(2==(2&r.metadata.flags))){if(null===r.matches)n.reset([]);else{const s=r.crossesNgTemplate?mA(t,e,i,[]):tk(t,e,r,i);n.reset(s,gs),n.notifyOnChanges()}return!0}return!1}function gA(n,e,t){const i=Qt();i.firstCreatePass&&(ik(i,new ek(n,e,t),-1),2==(2&e)&&(i.staticViewQueries=!0)),nk(i,ge(),e)}function Sx(n,e,t,i){const r=Qt();if(r.firstCreatePass){const s=qi();ik(r,new ek(e,t,i),s.index),function l9(n,e){const t=n.contentQueries||(n.contentQueries=[]);e!==(t.length?t[t.length-1]:-1)&&t.push(n.queries.length-1,e)}(r,n),2==(2&t)&&(r.staticContentQueries=!0)}nk(r,ge(),t)}function Gp(){return function a9(n,e){return n[Ns].queries[e].queryList}(ge(),Qs())}function nk(n,e,t){const i=new cA(4==(4&t));(function lj(n,e,t,i){const r=AL(e);r.push(t),n.firstCreatePass&&DL(n).push(i,r.length-1)})(n,e,i,i.destroy),null===e[Ns]&&(e[Ns]=new hA),e[Ns].queries.push(new dA(i))}function ik(n,e,t){null===n.queries&&(n.queries=new fA),n.queries.track(new pA(e,t))}function rk(n,e){return n.queries.getByIndex(e)}function sk(n,e){return bx(n,e)}const xA=new Ye("Application Initializer");let SA=(()=>{class n{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,i)=>{this.resolve=t,this.reject=i}),this.appInits=ze(xA,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const t=[];for(const r of this.appInits){const s=r();if(Dy(s))t.push(s);else if(l2(s)){const o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});t.push(o)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Qe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),xk=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Qe({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();const Wl=new Ye("LocaleId",{providedIn:"root",factory:()=>ze(Wl,Xt.Optional|Xt.SkipSelf)||function D9(){return typeof $localize<"u"&&$localize.locale||Hp}()});let Cx=(()=>{class n{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Vr(!1)}add(){this.hasPendingTasks.next(!0);const t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Qe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class P9{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let Sk=(()=>{class n{compileModuleSync(t){return new oA(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const i=this.compileModuleSync(t),s=Bl(mr(t).declarations).reduce((o,a)=>{const l=Zt(a);return l&&o.push(new Sy(l)),o},[]);return new P9(i,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Qe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const Tk=new Ye(""),Tx=new Ye("");let AA,MA=(()=>{class n{constructor(t,i,r){this._ngZone=t,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,AA||(function J9(n){AA=n}(r),r.addToWindow(i)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Dn.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,i,r){return[]}static#e=this.\u0275fac=function(i){return new(i||n)(Le(Dn),Le(TA),Le(Tx))};static#t=this.\u0275prov=Qe({token:n,factory:n.\u0275fac})}return n})(),TA=(()=>{class n{constructor(){this._applications=new Map}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return AA?.findTestabilityInTree(this,t,i)??null}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Qe({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})(),pu=null;const Ak=new Ye("AllowMultipleToken"),DA=new Ye("PlatformDestroyListeners"),IA=new Ye("appBootstrapListener");class Ik{constructor(e,t){this.name=e,this.token=t}}function Pk(n,e,t=[]){const i=`Platform: ${e}`,r=new Ye(i);return(s=[])=>{let o=RA();if(!o||o.injector.get(Ak,!1)){const a=[...t,...s,{provide:r,useValue:!0}];n?n(a):function t7(n){if(pu&&!pu.get(Ak,!1))throw new ae(400,!1);(function Dk(){!function n_(n){t_=n}(()=>{throw new ae(600,!1)})})(),pu=n;const e=n.get(Ok);(function Rk(n){n.get(Yb,null)?.forEach(t=>t())})(n)}(function Nk(n=[],e){return io.create({name:e,providers:[{provide:ay,useValue:"platform"},{provide:DA,useValue:new Set([()=>pu=null])},...n]})}(a,i))}return function i7(n){const e=RA();if(!e)throw new ae(401,!1);return e}()}}function RA(){return pu?.get(Ok)??null}let Ok=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,i){const r=function r7(n="zone.js",e){return"noop"===n?new WW:"zone.js"===n?new Dn(e):n}(i?.ngZone,function Lk(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return r.run(()=>{const s=function v$(n,e,t){return new sA(n,e,t)}(t.moduleType,this.injector,function Vk(n){return[{provide:Dn,useFactory:n},{provide:Fd,multi:!0,useFactory:()=>{const e=ze(o7,{optional:!0});return()=>e.initialize()}},{provide:Bk,useFactory:s7},{provide:nL,useFactory:iL}]}(()=>r)),o=s.injector.get(Ul,null);return r.runOutsideAngular(()=>{const a=r.onError.subscribe({next:l=>{o.handleError(l)}});s.onDestroy(()=>{Ax(this._modules,s),a.unsubscribe()})}),function Fk(n,e,t){try{const i=t();return Dy(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}(o,r,()=>{const a=s.injector.get(SA);return a.runInitializers(),a.donePromise.then(()=>(function rF(n){Ds(n,"Expected localeId to be defined"),"string"==typeof n&&(iF=n.toLowerCase().replace(/_/g,"-"))}(s.injector.get(Wl,Hp)||Hp),this._moduleDoBootstrap(s),s))})})}bootstrapModule(t,i=[]){const r=kk({},i);return function Q9(n,e,t){const i=new oA(t);return Promise.resolve(i)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(t){const i=t.injector.get($d);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new ae(-403,!1);t.instance.ngDoBootstrap(i)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new ae(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const t=this._injector.get(DA,null);t&&(t.forEach(i=>i()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static#e=this.\u0275fac=function(i){return new(i||n)(Le(io))};static#t=this.\u0275prov=Qe({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();function kk(n,e){return Array.isArray(e)?e.reduce(kk,n):{...n,...e}}let $d=(()=>{class n{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=ze(Bk),this.zoneIsStable=ze(nL),this.componentTypes=[],this.components=[],this.isStable=ze(Cx).hasPendingTasks.pipe(As(t=>t?wt(!1):this.zoneIsStable),function yM(n,e=$o){return n=n??Q0,Wn((t,i)=>{let r,s=!0;t.subscribe(ei(i,o=>{const a=e(o);(s||!n(r,a))&&(s=!1,r=a,i.next(o))}))})}(),Lg()),this._injector=ze(ms)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(t,i){const r=t instanceof He;if(!this._injector.get(SA).done)throw!r&&function wl(n){const e=Zt(n)||jn(n)||Gi(n);return null!==e&&e.standalone}(t),new ae(405,!1);let o;o=r?t:this._injector.get(Gt).resolveComponentFactory(t),this.componentTypes.push(o.componentType);const a=function e7(n){return n.isBoundToModule}(o)?void 0:this._injector.get(jd),c=o.create(io.NULL,[],i||o.selector,a),d=c.location.nativeElement,h=c.injector.get(Tk,null);return h?.registerApplication(d),c.onDestroy(()=>{this.detachView(c.hostView),Ax(this.components,c),h?.unregisterApplication(d)}),this._loadComponent(c),c}tick(){if(this._runningTick)throw new ae(101,!1);try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this.internalErrorHandler(t)}finally{this._runningTick=!1}}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;Ax(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);const i=this._injector.get(IA,[]);i.push(...this._bootstrapListeners),i.forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>Ax(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new ae(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Qe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Ax(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const Bk=new Ye("",{providedIn:"root",factory:()=>ze(Ul).handleError.bind(void 0)});function s7(){const n=ze(Dn),e=ze(Ul);return t=>n.runOutsideAngular(()=>e.handleError(t))}let o7=(()=>{class n{constructor(){this.zone=ze(Dn),this.applicationRef=ze($d)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Qe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();let Gy=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=l7}return n})();function l7(n){return function c7(n,e,t){if(Vt(n)&&!t){const i=Gr(n.index,e);return new xy(i,i)}return 47&n.type?new xy(e[mi],e):null}(qi(),ge(),16==(16&n))}class Wk{constructor(){}supports(e){return cx(e)}create(e){return new m7(e)}}const p7=(n,e)=>e;class m7{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||p7}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,s=null;for(;t||i;){const o=!i||t&&t.currentIndex<$k(i,r,s)?t:i,a=$k(o,r,s),l=o.currentIndex;if(o===i)r--,i=i._nextRemoved;else if(t=t._next,null==o.previousIndex)r++;else{s||(s=[]);const c=a-r,d=l-r;if(c!=d){for(let p=0;p<c;p++){const m=p<s.length?s[p]:s[p]=0,g=m+p;d<=g&&g<c&&(s[p]=m+1)}s[o.previousIndex]=d-c}}a!==l&&e(o,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!cx(e))throw new ae(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let r,s,o,t=this._itHead,i=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,o,a),i=!0),t=t._next}else r=0,function e8(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{const t=n[Symbol.iterator]();let i;for(;!(i=t.next()).done;)e(i.value)}}(e,a=>{o=this._trackByFn(r,a),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,a,o,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,o,r),i=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,r)):e=this._addAfter(new g7(t,i),s,r),e}_verifyReinsertion(e,t,i,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?e=this._reinsertAfter(s,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,s=e._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){const r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new jk),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,i=e._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new jk),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class g7{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class _7{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){const t=e._prevDup,i=e._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}class jk{constructor(){this.map=new Map}put(e){const t=e.trackById;let i=this.map.get(t);i||(i=new _7,this.map.set(t,i)),i.add(e)}get(e,t){const r=this.map.get(e);return r?r.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function $k(n,e,t){const i=n.previousIndex;if(null===i)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}class qk{constructor(){}supports(e){return e instanceof Map||U1(e)}create(){return new y7}}class y7{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||U1(e)))throw new ae(900,!1)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(i,r)=>{if(t&&t.key===r)this._maybeAddToChanges(t,i),this._appendAfter=t,t=t._next;else{const s=this._getOrCreateRecordForKey(r,i);t=this._insertBeforeOrAppend(t,s)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let i=t;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const i=e._prev;return t._next=e,t._prev=i,e._prev=t,i&&(i._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const r=this._records.get(e);this._maybeAddToChanges(r,t);const s=r._prev,o=r._next;return s&&(s._next=o),o&&(o._prev=s),r._next=null,r._prev=null,r}const i=new v7(e);return this._records.set(e,i),i.currentValue=t,this._addToAdditions(i),i}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(i=>t(e[i],i))}}class v7{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function Xk(){return new Rx([new Wk])}let Rx=(()=>{class n{static#e=this.\u0275prov=Qe({token:n,providedIn:"root",factory:Xk});constructor(t){this.factories=t}static create(t,i){if(null!=i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||Xk()),deps:[[n,new Yf,new Xf]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(null!=i)return i;throw new ae(901,!1)}}return n})();function Yk(){return new Wy([new qk])}let Wy=(()=>{class n{static#e=this.\u0275prov=Qe({token:n,providedIn:"root",factory:Yk});constructor(t){this.factories=t}static create(t,i){if(i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||Yk()),deps:[[n,new Yf,new Xf]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(i)return i;throw new ae(901,!1)}}return n})();const x7=Pk(null,"core",[]);let S7=(()=>{class n{constructor(t){}static#e=this.\u0275fac=function(i){return new(i||n)(Le($d))};static#t=this.\u0275mod=Oi({type:n});static#n=this.\u0275inj=wi({})}return n})();let kA=null;function mu(){return kA}class k7{}const qr=new Ye("DocumentToken");let UA=(()=>{class n{historyGo(t){throw new Error("Not implemented")}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Qe({token:n,factory:function(){return ze(B7)},providedIn:"platform"})}return n})();const U7=new Ye("Location Initialized");let B7=(()=>{class n extends UA{constructor(){super(),this._doc=ze(qr),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return mu().getBaseHref(this._doc)}onPopState(t){const i=mu().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=mu().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,r){this._history.pushState(t,i,r)}replaceState(t,i,r){this._history.replaceState(t,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Qe({token:n,factory:function(){return new n},providedIn:"platform"})}return n})();function BA(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function rU(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function jl(n){return n&&"?"!==n[0]?"?"+n:n}let Xd=(()=>{class n{historyGo(t){throw new Error("Not implemented")}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Qe({token:n,factory:function(){return ze(oU)},providedIn:"root"})}return n})();const sU=new Ye("appBaseHref");let oU=(()=>{class n extends Xd{constructor(t,i){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??ze(qr).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return BA(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+jl(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,s){const o=this.prepareExternalUrl(r+jl(s));this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){const o=this.prepareExternalUrl(r+jl(s));this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static#e=this.\u0275fac=function(i){return new(i||n)(Le(UA),Le(sU,8))};static#t=this.\u0275prov=Qe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),V7=(()=>{class n extends Xd{constructor(t,i){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(t){const i=BA(this._baseHref,t);return i.length>0?"#"+i:i}pushState(t,i,r,s){let o=this.prepareExternalUrl(r+jl(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){let o=this.prepareExternalUrl(r+jl(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static#e=this.\u0275fac=function(i){return new(i||n)(Le(UA),Le(sU,8))};static#t=this.\u0275prov=Qe({token:n,factory:n.\u0275fac})}return n})(),VA=(()=>{class n{constructor(t){this._subject=new Yn,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const i=this._locationStrategy.getBaseHref();this._basePath=function G7(n){if(new RegExp("^(https?:)?//").test(n)){const[,t]=n.split(/\/\/[^\/]+/);return t}return n}(rU(aU(i))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+jl(i))}normalize(t){return n.stripTrailingSlash(function z7(n,e){if(!n||!e.startsWith(n))return e;const t=e.substring(n.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,aU(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+jl(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+jl(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{const i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i,complete:r})}static#e=this.normalizeQueryParams=jl;static#t=this.joinWithSlash=BA;static#n=this.stripTrailingSlash=rU;static#i=this.\u0275fac=function(i){return new(i||n)(Le(Xd))};static#r=this.\u0275prov=Qe({token:n,factory:function(){return function H7(){return new VA(Le(Xd))}()},providedIn:"root"})}return n})();function aU(n){return n.replace(/\/index.html$/,"")}function gU(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,s]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}const KA=/\s+/,_U=[];let Gx=(()=>{class n{constructor(t,i,r,s){this._iterableDiffers=t,this._keyValueDiffers=i,this._ngEl=r,this._renderer=s,this.initialClasses=_U,this.stateMap=new Map}set klass(t){this.initialClasses=null!=t?t.trim().split(KA):_U}set ngClass(t){this.rawClass="string"==typeof t?t.trim().split(KA):t}ngDoCheck(){for(const i of this.initialClasses)this._updateState(i,!0);const t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(const i of t)this._updateState(i,!0);else if(null!=t)for(const i of Object.keys(t))this._updateState(i,!!t[i]);this._applyStateDiff()}_updateState(t,i){const r=this.stateMap.get(t);void 0!==r?(r.enabled!==i&&(r.changed=!0,r.enabled=i),r.touched=!0):this.stateMap.set(t,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(const t of this.stateMap){const i=t[0],r=t[1];r.changed?(this._toggleClass(i,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),r.touched=!1}}_toggleClass(t,i){(t=t.trim()).length>0&&t.split(KA).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}static#e=this.\u0275fac=function(i){return new(i||n)(ce(Rx),ce(Wy),ce(Cn),ce(Si))};static#t=this.\u0275dir=yt({type:n,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0})}return n})();class Aq{constructor(e,t,i,r){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let qy=(()=>{class n{set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const i=this._viewContainer;t.forEachOperation((r,s,o)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new Aq(r.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)i.remove(null===s?void 0:s);else if(null!==s){const a=i.get(s);i.move(a,o),vU(a,r)}});for(let r=0,s=i.length;r<s;r++){const a=i.get(r).context;a.index=r,a.count=s,a.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{vU(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(t,i){return!0}static#e=this.\u0275fac=function(i){return new(i||n)(ce(ha),ce(el),ce(Rx))};static#t=this.\u0275dir=yt({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}return n})();function vU(n,e){n.context.$implicit=e.item}let Xp=(()=>{class n{constructor(t,i){this._viewContainer=t,this._context=new Dq,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){wU("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){wU("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}static#e=this.\u0275fac=function(i){return new(i||n)(ce(ha),ce(el))};static#t=this.\u0275dir=yt({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}return n})();class Dq{constructor(){this.$implicit=null,this.ngIf=null}}function wU(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${Pi(e)}'.`)}let QA=(()=>{class n{constructor(t,i,r){this._ngEl=t,this._differs=i,this._renderer=r,this._ngStyle=null,this._differ=null}set ngStyle(t){this._ngStyle=t,!this._differ&&t&&(this._differ=this._differs.find(t).create())}ngDoCheck(){if(this._differ){const t=this._differ.diff(this._ngStyle);t&&this._applyChanges(t)}}_setStyle(t,i){const[r,s]=t.split("."),o=-1===r.indexOf("-")?void 0:ja.DashCase;null!=i?this._renderer.setStyle(this._ngEl.nativeElement,r,s?`${i}${s}`:i,o):this._renderer.removeStyle(this._ngEl.nativeElement,r,o)}_applyChanges(t){t.forEachRemovedItem(i=>this._setStyle(i.key,null)),t.forEachAddedItem(i=>this._setStyle(i.key,i.currentValue)),t.forEachChangedItem(i=>this._setStyle(i.key,i.currentValue))}static#e=this.\u0275fac=function(i){return new(i||n)(ce(Cn),ce(Wy),ce(Si))};static#t=this.\u0275dir=yt({type:n,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0})}return n})(),Wx=(()=>{class n{constructor(t){this._viewContainerRef=t,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(t){if(t.ngTemplateOutlet||t.ngTemplateOutletInjector){const i=this._viewContainerRef;if(this._viewRef&&i.remove(i.indexOf(this._viewRef)),this.ngTemplateOutlet){const{ngTemplateOutlet:r,ngTemplateOutletContext:s,ngTemplateOutletInjector:o}=this;this._viewRef=i.createEmbeddedView(r,s,o?{injector:o}:void 0)}else this._viewRef=null}else this._viewRef&&t.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}static#e=this.\u0275fac=function(i){return new(i||n)(ce(ha))};static#t=this.\u0275dir=yt({type:n,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[$i]})}return n})(),xU=(()=>{class n{transform(t){return JSON.stringify(t,null,2)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275pipe=Hr({name:"json",type:n,pure:!1,standalone:!0})}return n})(),Yp=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Oi({type:n});static#n=this.\u0275inj=wi({})}return n})();const EU="browser";function CU(n){return"server"===n}let rX=(()=>{class n{static#e=this.\u0275prov=Qe({token:n,providedIn:"root",factory:()=>new sX(Le(qr),window)})}return n})();class sX{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function oX(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&"function"==typeof n.body.attachShadow){const i=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const s=r.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}r=i.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.supportsScrolling()&&(this.window.history.scrollRestoration=e)}scrollToElement(e){const t=e.getBoundingClientRect(),i=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(i-s[0],r-s[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}class MU{}class DX extends k7{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class rD extends DX{static makeCurrent(){!function F7(n){kA||(kA=n)}(new rD)}onAndCancel(e,t,i){return e.addEventListener(t,i),()=>{e.removeEventListener(t,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function IX(){return Yy=Yy||document.querySelector("base"),Yy?Yy.getAttribute("href"):null}();return null==t?null:function RX(n){qx=qx||document.createElement("a"),qx.setAttribute("href",n);const e=qx.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){Yy=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return gU(document.cookie,e)}}let qx,Yy=null,NX=(()=>{class n{build(){return new XMLHttpRequest}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Qe({token:n,factory:n.\u0275fac})}return n})();const sD=new Ye("EventManagerPlugins");let RU=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>{r.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(s=>s.supports(t)),!i)throw new ae(5101,!1);return this._eventNameToPlugin.set(t,i),i}static#e=this.\u0275fac=function(i){return new(i||n)(Le(sD),Le(Dn))};static#t=this.\u0275prov=Qe({token:n,factory:n.\u0275fac})}return n})();class PU{constructor(e){this._doc=e}}const oD="ng-app-id";let NU=(()=>{class n{constructor(t,i,r,s={}){this.doc=t,this.appId=i,this.nonce=r,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=CU(s),this.resetHostNodes()}addStyles(t){for(const i of t)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(t){for(const i of t)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){const t=this.styleNodesInDOM;t&&(t.forEach(i=>i.remove()),t.clear());for(const i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const i of this.getAllStyles())this.addStyleToHost(t,i)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(const i of this.hostNodes)this.addStyleToHost(i,t)}onStyleRemoved(t){const i=this.styleRef;i.get(t)?.elements?.forEach(r=>r.remove()),i.delete(t)}collectServerRenderedStyles(){const t=this.doc.head?.querySelectorAll(`style[${oD}="${this.appId}"]`);if(t?.length){const i=new Map;return t.forEach(r=>{null!=r.textContent&&i.set(r.textContent,r)}),i}return null}changeUsageCount(t,i){const r=this.styleRef;if(r.has(t)){const s=r.get(t);return s.usage+=i,s.usage}return r.set(t,{usage:i,elements:[]}),i}getStyleElement(t,i){const r=this.styleNodesInDOM,s=r?.get(i);if(s?.parentNode===t)return r.delete(i),s.removeAttribute(oD),s;{const o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=i,this.platformIsServer&&o.setAttribute(oD,this.appId),o}}addStyleToHost(t,i){const r=this.getStyleElement(t,i);t.appendChild(r);const s=this.styleRef,o=s.get(i)?.elements;o?o.push(r):s.set(i,{elements:[r],usage:1})}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}static#e=this.\u0275fac=function(i){return new(i||n)(Le(qr),Le(xp),Le(Zb,8),Le(Ya))};static#t=this.\u0275prov=Qe({token:n,factory:n.\u0275fac})}return n})();const aD={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},lD=/%COMP%/g,kX=new Ye("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function LU(n,e){return e.map(t=>t.replace(lD,n))}let cD=(()=>{class n{constructor(t,i,r,s,o,a,l,c=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=a,this.ngZone=l,this.nonce=c,this.rendererByCompId=new Map,this.platformIsServer=CU(a),this.defaultRenderer=new uD(t,o,l,this.platformIsServer)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Rs.ShadowDom&&(i={...i,encapsulation:Rs.Emulated});const r=this.getOrCreateRenderer(t,i);return r instanceof kU?r.applyToHost(t):r instanceof dD&&r.applyStyles(),r}getOrCreateRenderer(t,i){const r=this.rendererByCompId;let s=r.get(i.id);if(!s){const o=this.doc,a=this.ngZone,l=this.eventManager,c=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,h=this.platformIsServer;switch(i.encapsulation){case Rs.Emulated:s=new kU(l,c,i,this.appId,d,o,a,h);break;case Rs.ShadowDom:return new HX(l,c,t,i,o,a,this.nonce,h);default:s=new dD(l,c,i,d,o,a,h)}r.set(i.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static#e=this.\u0275fac=function(i){return new(i||n)(Le(RU),Le(NU),Le(xp),Le(kX),Le(qr),Le(Ya),Le(Dn),Le(Zb))};static#t=this.\u0275prov=Qe({token:n,factory:n.\u0275fac})}return n})();class uD{constructor(e,t,i,r){this.eventManager=e,this.doc=t,this.ngZone=i,this.platformIsServer=r,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(aD[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(FU(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(FU(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?this.doc.querySelector(e):e;if(!i)throw new ae(-5104,!1);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const s=aD[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=aD[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(ja.DashCase|ja.Important)?e.style.setProperty(t,i,r&ja.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&ja.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e[t]=i}setValue(e,t){e.nodeValue=t}listen(e,t,i){if("string"==typeof e&&!(e=mu().getGlobalEventTarget(this.doc,e)))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(i))}decoratePreventDefault(e){return t=>{if("__ngUnwrap__"===t)return e;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))&&t.preventDefault()}}}function FU(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class HX extends uD{constructor(e,t,i,r,s,o,a,l){super(e,s,o,l),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const c=LU(r.id,r.styles);for(const d of c){const h=document.createElement("style");a&&h.setAttribute("nonce",a),h.textContent=d,this.shadowRoot.appendChild(h)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class dD extends uD{constructor(e,t,i,r,s,o,a,l){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r,this.styles=l?LU(l,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class kU extends dD{constructor(e,t,i,r,s,o,a,l){const c=r+"-"+i.id;super(e,t,i,s,o,a,l,c),this.contentAttr=function UX(n){return"_ngcontent-%COMP%".replace(lD,n)}(c),this.hostAttr=function BX(n){return"_nghost-%COMP%".replace(lD,n)}(c)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}let zX=(()=>{class n extends PU{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}static#e=this.\u0275fac=function(i){return new(i||n)(Le(qr))};static#t=this.\u0275prov=Qe({token:n,factory:n.\u0275fac})}return n})();const UU=["alt","control","meta","shift"],GX={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},WX={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let jX=(()=>{class n extends PU{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,r){const s=n.parseEventName(i),o=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>mu().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=n._normalizeKey(i.pop());let o="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),o="code."),UU.forEach(c=>{const d=i.indexOf(c);d>-1&&(i.splice(d,1),o+=c+".")}),o+=s,0!=i.length||0===s.length)return null;const l={};return l.domEventName=r,l.fullKey=o,l}static matchEventFullKeyCode(t,i){let r=GX[t.key]||t.key,s="";return i.indexOf("code.")>-1&&(r=t.code,s="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),UU.forEach(o=>{o!==r&&(0,WX[o])(t)&&(s+=o+".")}),s+=r,s===i)}static eventCallback(t,i,r){return s=>{n.matchEventFullKeyCode(s,t)&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}static#e=this.\u0275fac=function(i){return new(i||n)(Le(qr))};static#t=this.\u0275prov=Qe({token:n,factory:n.\u0275fac})}return n})();const VU=[{provide:Ya,useValue:EU},{provide:Yb,useValue:function $X(){rD.makeCurrent()},multi:!0},{provide:qr,useFactory:function XX(){return function Rb(n){jr=n}(document),document},deps:[]}],YX=Pk(x7,"browser",VU),KX=new Ye(""),HU=[{provide:Tx,useClass:class PX{addToWindow(e){un.getAngularTestability=(i,r=!0)=>{const s=e.findTestabilityInTree(i,r);if(null==s)throw new ae(5103,!1);return s},un.getAllAngularTestabilities=()=>e.getAllTestabilities(),un.getAllAngularRootElements=()=>e.getAllRootElements(),un.frameworkStabilizers||(un.frameworkStabilizers=[]),un.frameworkStabilizers.push(i=>{const r=un.getAllAngularTestabilities();let s=r.length,o=!1;const a=function(l){o=o||l,s--,0==s&&i(o)};r.forEach(l=>{l.whenStable(a)})})}findTestabilityInTree(e,t,i){return null==t?null:e.getTestability(t)??(i?mu().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:Tk,useClass:MA,deps:[Dn,TA,Tx]},{provide:MA,useClass:MA,deps:[Dn,TA,Tx]}],zU=[{provide:ay,useValue:"root"},{provide:Ul,useFactory:function qX(){return new Ul},deps:[]},{provide:sD,useClass:zX,multi:!0,deps:[qr,Dn,Ya]},{provide:sD,useClass:jX,multi:!0,deps:[qr]},cD,NU,RU,{provide:Bn,useExisting:cD},{provide:MU,useClass:NX,deps:[]},[]];let GU=(()=>{class n{constructor(t){}static withServerTransition(t){return{ngModule:n,providers:[{provide:xp,useValue:t.appId}]}}static#e=this.\u0275fac=function(i){return new(i||n)(Le(KX,12))};static#t=this.\u0275mod=Oi({type:n});static#n=this.\u0275inj=wi({providers:[...zU,...HU],imports:[Yp,S7]})}return n})(),hD=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static#e=this.\u0275fac=function(i){return new(i||n)(Le(qr))};static#t=this.\u0275prov=Qe({token:n,factory:function(i){let r=null;return r=i?new i:function JX(){return new hD(Le(qr))}(),r},providedIn:"root"})}return n})();typeof window<"u"&&window;class qU{}class iY{}const Xl="*";function XU(n,e=null){return{type:2,steps:n,options:e}}function YU(n){return{type:6,styles:n,offset:null}}class Ky{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class KU{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,i=0,r=0;const s=this.players.length;0==s?queueMicrotask(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++t==s&&this._onFinish()}),o.onDestroy(()=>{++i==s&&this._onDestroy()}),o.onStart(()=>{++r==s&&this._onStart()})}),this.totalTime=this.players.reduce((o,a)=>Math.max(o,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,t/i.totalTime):1;i.setPosition(r)})}getPosition(){const e=this.players.reduce((t,i)=>null===t||i.totalTime>t.totalTime?i:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}function ZU(n){return new ae(3e3,!1)}function _u(n){switch(n.length){case 0:return new Ky;case 1:return n[0];default:return new KU(n)}}function JU(n,e,t=new Map,i=new Map){const r=[],s=[];let o=-1,a=null;if(e.forEach(l=>{const c=l.get("offset"),d=c==o,h=d&&a||new Map;l.forEach((p,m)=>{let g=m,v=p;if("offset"!==m)switch(g=n.normalizePropertyName(g,r),v){case"!":v=t.get(m);break;case Xl:v=i.get(m);break;default:v=n.normalizeStyleValue(m,g,v,r)}h.set(g,v)}),d||s.push(h),a=h,o=c}),r.length)throw function MY(n){return new ae(3502,!1)}();return s}function mD(n,e,t,i){switch(e){case"start":n.onStart(()=>i(t&&gD(t,"start",n)));break;case"done":n.onDone(()=>i(t&&gD(t,"done",n)));break;case"destroy":n.onDestroy(()=>i(t&&gD(t,"destroy",n)))}}function gD(n,e,t){const s=_D(n.element,n.triggerName,n.fromState,n.toState,e||n.phaseName,t.totalTime??n.totalTime,!!t.disabled),o=n._data;return null!=o&&(s._data=o),s}function _D(n,e,t,i,r="",s=0,o){return{element:n,triggerName:e,fromState:t,toState:i,phaseName:r,totalTime:s,disabled:!!o}}function oo(n,e,t){let i=n.get(e);return i||n.set(e,i=t),i}function QU(n){const e=n.indexOf(":");return[n.substring(1,e),n.slice(e+1)]}const UY=(()=>typeof document>"u"?null:document.documentElement)();function yD(n){const e=n.parentNode||n.host||null;return e===UY?null:e}let Yd=null,e3=!1;function t3(n,e){for(;e;){if(e===n)return!0;e=yD(e)}return!1}function n3(n,e,t){if(t)return Array.from(n.querySelectorAll(e));const i=n.querySelector(e);return i?[i]:[]}let i3=(()=>{class n{validateStyleProperty(t){return function VY(n){Yd||(Yd=function HY(){return typeof document<"u"?document.body:null}()||{},e3=!!Yd.style&&"WebkitAppearance"in Yd.style);let e=!0;return Yd.style&&!function BY(n){return"ebkit"==n.substring(1,6)}(n)&&(e=n in Yd.style,!e&&e3&&(e="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in Yd.style)),e}(t)}matchesElement(t,i){return!1}containsElement(t,i){return t3(t,i)}getParentElement(t){return yD(t)}query(t,i,r){return n3(t,i,r)}computeStyle(t,i,r){return r||""}animate(t,i,r,s,o,a=[],l){return new Ky(r,s)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Qe({token:n,factory:n.\u0275fac})}return n})(),vD=(()=>{class n{static#e=this.NOOP=new i3}return n})();const zY=1e3,wD="ng-enter",Xx="ng-leave",Yx="ng-trigger",Kx=".ng-trigger",s3="ng-animating",bD=".ng-animating";function Yl(n){if("number"==typeof n)return n;const e=n.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:xD(parseFloat(e[1]),e[2])}function xD(n,e){return"s"===e?n*zY:n}function Zx(n,e,t){return n.hasOwnProperty("duration")?n:function WY(n,e,t){let r,s=0,o="";if("string"==typeof n){const a=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return e.push(ZU()),{duration:0,delay:0,easing:""};r=xD(parseFloat(a[1]),a[2]);const l=a[3];null!=l&&(s=xD(parseFloat(l),a[4]));const c=a[5];c&&(o=c)}else r=n;if(!t){let a=!1,l=e.length;r<0&&(e.push(function rY(){return new ae(3100,!1)}()),a=!0),s<0&&(e.push(function sY(){return new ae(3101,!1)}()),a=!0),a&&e.splice(l,0,ZU())}return{duration:r,delay:s,easing:o}}(n,e,t)}function Zy(n,e={}){return Object.keys(n).forEach(t=>{e[t]=n[t]}),e}function o3(n){const e=new Map;return Object.keys(n).forEach(t=>{e.set(t,n[t])}),e}function yu(n,e=new Map,t){if(t)for(let[i,r]of t)e.set(i,r);for(let[i,r]of n)e.set(i,r);return e}function tl(n,e,t){e.forEach((i,r)=>{const s=ED(r);t&&!t.has(r)&&t.set(r,n.style[s]),n.style[s]=i})}function Kd(n,e){e.forEach((t,i)=>{const r=ED(i);n.style[r]=""})}function Jy(n){return Array.isArray(n)?1==n.length?n[0]:XU(n):n}const SD=new RegExp("{{\\s*(.+?)\\s*}}","g");function l3(n){let e=[];if("string"==typeof n){let t;for(;t=SD.exec(n);)e.push(t[1]);SD.lastIndex=0}return e}function Qy(n,e,t){const i=n.toString(),r=i.replace(SD,(s,o)=>{let a=e[o];return null==a&&(t.push(function aY(n){return new ae(3003,!1)}()),a=""),a.toString()});return r==i?n:r}function Jx(n){const e=[];let t=n.next();for(;!t.done;)e.push(t.value),t=n.next();return e}const qY=/-+([a-z0-9])/g;function ED(n){return n.replace(qY,(...e)=>e[1].toUpperCase())}function ao(n,e,t){switch(e.type){case 7:return n.visitTrigger(e,t);case 0:return n.visitState(e,t);case 1:return n.visitTransition(e,t);case 2:return n.visitSequence(e,t);case 3:return n.visitGroup(e,t);case 4:return n.visitAnimate(e,t);case 5:return n.visitKeyframes(e,t);case 6:return n.visitStyle(e,t);case 8:return n.visitReference(e,t);case 9:return n.visitAnimateChild(e,t);case 10:return n.visitAnimateRef(e,t);case 11:return n.visitQuery(e,t);case 12:return n.visitStagger(e,t);default:throw function lY(n){return new ae(3004,!1)}()}}function c3(n,e){return window.getComputedStyle(n)[e]}const Qx="*";function KY(n,e){const t=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(i=>function ZY(n,e,t){if(":"==n[0]){const l=function JY(n,e){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,i)=>parseFloat(i)>parseFloat(t);case":decrement":return(t,i)=>parseFloat(i)<parseFloat(t);default:return e.push(function xY(n){return new ae(3016,!1)}()),"* => *"}}(n,t);if("function"==typeof l)return void e.push(l);n=l}const i=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return t.push(function bY(n){return new ae(3015,!1)}()),e;const r=i[1],s=i[2],o=i[3];e.push(u3(r,o));"<"==s[0]&&!(r==Qx&&o==Qx)&&e.push(u3(o,r))}(i,t,e)):t.push(n),t}const eS=new Set(["true","1"]),tS=new Set(["false","0"]);function u3(n,e){const t=eS.has(n)||tS.has(n),i=eS.has(e)||tS.has(e);return(r,s)=>{let o=n==Qx||n==r,a=e==Qx||e==s;return!o&&t&&"boolean"==typeof r&&(o=r?eS.has(n):tS.has(n)),!a&&i&&"boolean"==typeof s&&(a=s?eS.has(e):tS.has(e)),o&&a}}const QY=new RegExp("s*:selfs*,?","g");function CD(n,e,t,i){return new eK(n).build(e,t,i)}class eK{constructor(e){this._driver=e}build(e,t,i){const r=new iK(t);return this._resetContextStyleTimingState(r),ao(this,Jy(e),r)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles=new Map,e.collectedStyles.set("",new Map),e.currentTime=0}visitTrigger(e,t){let i=t.queryCount=0,r=t.depCount=0;const s=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push(function uY(){return new ae(3006,!1)}()),e.definitions.forEach(a=>{if(this._resetContextStyleTimingState(t),0==a.type){const l=a,c=l.name;c.toString().split(/\s*,\s*/).forEach(d=>{l.name=d,s.push(this.visitState(l,t))}),l.name=c}else if(1==a.type){const l=this.visitTransition(a,t);i+=l.queryCount,r+=l.depCount,o.push(l)}else t.errors.push(function dY(){return new ae(3007,!1)}())}),{type:7,name:e.name,states:s,transitions:o,queryCount:i,depCount:r,options:null}}visitState(e,t){const i=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(i.containsDynamicStyles){const s=new Set,o=r||{};i.styles.forEach(a=>{a instanceof Map&&a.forEach(l=>{l3(l).forEach(c=>{o.hasOwnProperty(c)||s.add(c)})})}),s.size&&(Jx(s.values()),t.errors.push(function hY(n,e){return new ae(3008,!1)}()))}return{type:0,name:e.name,style:i,options:r?{params:r}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const i=ao(this,Jy(e.animation),t);return{type:1,matchers:KY(e.expr,t.errors),animation:i,queryCount:t.queryCount,depCount:t.depCount,options:Zd(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(i=>ao(this,i,t)),options:Zd(e.options)}}visitGroup(e,t){const i=t.currentTime;let r=0;const s=e.steps.map(o=>{t.currentTime=i;const a=ao(this,o,t);return r=Math.max(r,t.currentTime),a});return t.currentTime=r,{type:3,steps:s,options:Zd(e.options)}}visitAnimate(e,t){const i=function sK(n,e){if(n.hasOwnProperty("duration"))return n;if("number"==typeof n)return MD(Zx(n,e).duration,0,"");const t=n;if(t.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=MD(0,0,"");return s.dynamic=!0,s.strValue=t,s}const r=Zx(t,e);return MD(r.duration,r.delay,r.easing)}(e.timings,t.errors);t.currentAnimateTimings=i;let r,s=e.styles?e.styles:YU({});if(5==s.type)r=this.visitKeyframes(s,t);else{let o=e.styles,a=!1;if(!o){a=!0;const c={};i.easing&&(c.easing=i.easing),o=YU(c)}t.currentTime+=i.duration+i.delay;const l=this.visitStyle(o,t);l.isEmptyStep=a,r=l}return t.currentAnimateTimings=null,{type:4,timings:i,style:r,options:null}}visitStyle(e,t){const i=this._makeStyleAst(e,t);return this._validateStyleAst(i,t),i}_makeStyleAst(e,t){const i=[],r=Array.isArray(e.styles)?e.styles:[e.styles];for(let a of r)"string"==typeof a?a===Xl?i.push(a):t.errors.push(new ae(3002,!1)):i.push(o3(a));let s=!1,o=null;return i.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(o=a.get("easing"),a.delete("easing")),!s))for(let l of a.values())if(l.toString().indexOf("{{")>=0){s=!0;break}}),{type:6,styles:i,easing:o,offset:e.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(e,t){const i=t.currentAnimateTimings;let r=t.currentTime,s=t.currentTime;i&&s>0&&(s-=i.duration+i.delay),e.styles.forEach(o=>{"string"!=typeof o&&o.forEach((a,l)=>{const c=t.collectedStyles.get(t.currentQuerySelector),d=c.get(l);let h=!0;d&&(s!=r&&s>=d.startTime&&r<=d.endTime&&(t.errors.push(function pY(n,e,t,i,r){return new ae(3010,!1)}()),h=!1),s=d.startTime),h&&c.set(l,{startTime:s,endTime:r}),t.options&&function $Y(n,e,t){const i=e.params||{},r=l3(n);r.length&&r.forEach(s=>{i.hasOwnProperty(s)||t.push(function oY(n){return new ae(3001,!1)}())})}(a,t.options,t.errors)})})}visitKeyframes(e,t){const i={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function mY(){return new ae(3011,!1)}()),i;let s=0;const o=[];let a=!1,l=!1,c=0;const d=e.steps.map(y=>{const b=this._makeStyleAst(y,t);let x=null!=b.offset?b.offset:function rK(n){if("string"==typeof n)return null;let e=null;if(Array.isArray(n))n.forEach(t=>{if(t instanceof Map&&t.has("offset")){const i=t;e=parseFloat(i.get("offset")),i.delete("offset")}});else if(n instanceof Map&&n.has("offset")){const t=n;e=parseFloat(t.get("offset")),t.delete("offset")}return e}(b.styles),E=0;return null!=x&&(s++,E=b.offset=x),l=l||E<0||E>1,a=a||E<c,c=E,o.push(E),b});l&&t.errors.push(function gY(){return new ae(3012,!1)}()),a&&t.errors.push(function _Y(){return new ae(3200,!1)}());const h=e.steps.length;let p=0;s>0&&s<h?t.errors.push(function yY(){return new ae(3202,!1)}()):0==s&&(p=1/(h-1));const m=h-1,g=t.currentTime,v=t.currentAnimateTimings,w=v.duration;return d.forEach((y,b)=>{const x=p>0?b==m?1:p*b:o[b],E=x*w;t.currentTime=g+v.delay+E,v.duration=E,this._validateStyleAst(y,t),y.offset=x,i.styles.push(y)}),i}visitReference(e,t){return{type:8,animation:ao(this,Jy(e.animation),t),options:Zd(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:Zd(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:Zd(e.options)}}visitQuery(e,t){const i=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;const[s,o]=function tK(n){const e=!!n.split(/\s*,\s*/).find(t=>":self"==t);return e&&(n=n.replace(QY,"")),n=n.replace(/@\*/g,Kx).replace(/@\w+/g,t=>Kx+"-"+t.slice(1)).replace(/:animating/g,bD),[n,e]}(e.selector);t.currentQuerySelector=i.length?i+" "+s:s,oo(t.collectedStyles,t.currentQuerySelector,new Map);const a=ao(this,Jy(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=i,{type:11,selector:s,limit:r.limit||0,optional:!!r.optional,includeSelf:o,animation:a,originalSelector:e.selector,options:Zd(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function vY(){return new ae(3013,!1)}());const i="full"===e.timings?{duration:0,delay:0,easing:"full"}:Zx(e.timings,t.errors,!0);return{type:12,animation:ao(this,Jy(e.animation),t),timings:i,options:null}}}class iK{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function Zd(n){return n?(n=Zy(n)).params&&(n.params=function nK(n){return n?Zy(n):null}(n.params)):n={},n}function MD(n,e,t){return{duration:n,delay:e,easing:t}}function TD(n,e,t,i,r,s,o=null,a=!1){return{type:1,element:n,keyframes:e,preStyleProps:t,postStyleProps:i,duration:r,delay:s,totalTime:r+s,easing:o,subTimeline:a}}class nS{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let i=this._map.get(e);i||this._map.set(e,i=[]),i.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const lK=new RegExp(":enter","g"),uK=new RegExp(":leave","g");function AD(n,e,t,i,r,s=new Map,o=new Map,a,l,c=[]){return(new dK).buildKeyframes(n,e,t,i,r,s,o,a,l,c)}class dK{buildKeyframes(e,t,i,r,s,o,a,l,c,d=[]){c=c||new nS;const h=new DD(e,t,c,r,s,d,[]);h.options=l;const p=l.delay?Yl(l.delay):0;h.currentTimeline.delayNextStep(p),h.currentTimeline.setStyles([o],null,h.errors,l),ao(this,i,h);const m=h.timelines.filter(g=>g.containsAnimation());if(m.length&&a.size){let g;for(let v=m.length-1;v>=0;v--){const w=m[v];if(w.element===t){g=w;break}}g&&!g.allowOnlyTimelineStyles()&&g.setStyles([a],null,h.errors,l)}return m.length?m.map(g=>g.buildKeyframes()):[TD(t,[],[],[],0,p,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const i=t.subInstructions.get(t.element);if(i){const r=t.createSubContext(e.options),s=t.currentTimeline.currentTime,o=this._visitSubInstructions(i,r,r.options);s!=o&&t.transformIntoNewTimeline(o)}t.previousNode=e}visitAnimateRef(e,t){const i=t.createSubContext(e.options);i.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],t,i),this.visitReference(e.animation,i),t.transformIntoNewTimeline(i.currentTimeline.currentTime),t.previousNode=e}_applyAnimationRefDelays(e,t,i){for(const r of e){const s=r?.delay;if(s){const o="number"==typeof s?s:Yl(Qy(s,r?.params??{},t.errors));i.delayNextStep(o)}}}_visitSubInstructions(e,t,i){let s=t.currentTimeline.currentTime;const o=null!=i.duration?Yl(i.duration):null,a=null!=i.delay?Yl(i.delay):null;return 0!==o&&e.forEach(l=>{const c=t.appendInstructionToTimeline(l,o,a);s=Math.max(s,c.duration+c.delay)}),s}visitReference(e,t){t.updateOptions(e.options,!0),ao(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const i=t.subContextCount;let r=t;const s=e.options;if(s&&(s.params||s.delay)&&(r=t.createSubContext(s),r.transformIntoNewTimeline(),null!=s.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=iS);const o=Yl(s.delay);r.delayNextStep(o)}e.steps.length&&(e.steps.forEach(o=>ao(this,o,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const i=[];let r=t.currentTimeline.currentTime;const s=e.options&&e.options.delay?Yl(e.options.delay):0;e.steps.forEach(o=>{const a=t.createSubContext(e.options);s&&a.delayNextStep(s),ao(this,o,a),r=Math.max(r,a.currentTimeline.currentTime),i.push(a.currentTimeline)}),i.forEach(o=>t.currentTimeline.mergeTimelineCollectedStyles(o)),t.transformIntoNewTimeline(r),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const i=e.strValue;return Zx(t.params?Qy(i,t.params,t.errors):i,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const i=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;i.delay&&(t.incrementTime(i.delay),r.snapshotCurrentStyles());const s=e.style;5==s.type?this.visitKeyframes(s,t):(t.incrementTime(i.duration),this.visitStyle(s,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const i=t.currentTimeline,r=t.currentAnimateTimings;!r&&i.hasCurrentStyleProperties()&&i.forwardFrame();const s=r&&r.easing||e.easing;e.isEmptyStep?i.applyEmptyStep(s):i.setStyles(e.styles,s,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const i=t.currentAnimateTimings,r=t.currentTimeline.duration,s=i.duration,a=t.createSubContext().currentTimeline;a.easing=i.easing,e.styles.forEach(l=>{a.forwardTime((l.offset||0)*s),a.setStyles(l.styles,l.easing,t.errors,t.options),a.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(r+s),t.previousNode=e}visitQuery(e,t){const i=t.currentTimeline.currentTime,r=e.options||{},s=r.delay?Yl(r.delay):0;s&&(6===t.previousNode.type||0==i&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=iS);let o=i;const a=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!r.optional,t.errors);t.currentQueryTotal=a.length;let l=null;a.forEach((c,d)=>{t.currentQueryIndex=d;const h=t.createSubContext(e.options,c);s&&h.delayNextStep(s),c===t.element&&(l=h.currentTimeline),ao(this,e.animation,h),h.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,h.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),l&&(t.currentTimeline.mergeTimelineCollectedStyles(l),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const i=t.parentContext,r=t.currentTimeline,s=e.timings,o=Math.abs(s.duration),a=o*(t.currentQueryTotal-1);let l=o*t.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":l=a-l;break;case"full":l=i.currentStaggerTime}const d=t.currentTimeline;l&&d.delayNextStep(l);const h=d.currentTime;ao(this,e.animation,t),t.previousNode=e,i.currentStaggerTime=r.currentTime-h+(r.startTime-i.currentTimeline.startTime)}}const iS={};class DD{constructor(e,t,i,r,s,o,a,l){this._driver=e,this.element=t,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=s,this.errors=o,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=iS,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=l||new rS(this._driver,t,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const i=e;let r=this.options;null!=i.duration&&(r.duration=Yl(i.duration)),null!=i.delay&&(r.delay=Yl(i.delay));const s=i.params;if(s){let o=r.params;o||(o=this.options.params={}),Object.keys(s).forEach(a=>{(!t||!o.hasOwnProperty(a))&&(o[a]=Qy(s[a],o,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const i=e.params={};Object.keys(t).forEach(r=>{i[r]=t[r]})}}return e}createSubContext(e=null,t,i){const r=t||this.element,s=new DD(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(e),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(e){return this.previousNode=iS,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,i){const r={duration:t??e.duration,delay:this.currentTimeline.currentTime+(i??0)+e.delay,easing:""},s=new hK(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(s),r}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,i,r,s,o){let a=[];if(r&&a.push(this.element),e.length>0){e=(e=e.replace(lK,"."+this._enterClassName)).replace(uK,"."+this._leaveClassName);let c=this._driver.query(this.element,e,1!=i);0!==i&&(c=i<0?c.slice(c.length+i,c.length):c.slice(0,i)),a.push(...c)}return!s&&0==a.length&&o.push(function wY(n){return new ae(3014,!1)}()),a}}class rS{constructor(e,t,i,r){this._driver=e,this.element=t,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new rS(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,i]of this._globalTimelineStyles)this._backFill.set(t,i||Xl),this._currentKeyframe.set(t,Xl);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,i,r){t&&this._previousKeyframe.set("easing",t);const s=r&&r.params||{},o=function fK(n,e){const t=new Map;let i;return n.forEach(r=>{if("*"===r){i=i||e.keys();for(let s of i)t.set(s,Xl)}else yu(r,t)}),t}(e,this._globalTimelineStyles);for(let[a,l]of o){const c=Qy(l,s,i);this._pendingStyles.set(a,c),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??Xl),this._updateStyle(a,c)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,i)=>{const r=this._styleSummary.get(i);(!r||t.time>r.time)&&this._updateStyle(i,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((a,l)=>{const c=yu(a,new Map,this._backFill);c.forEach((d,h)=>{"!"===d?e.add(h):d===Xl&&t.add(h)}),i||c.set("offset",l/this.duration),r.push(c)});const s=e.size?Jx(e.values()):[],o=t.size?Jx(t.values()):[];if(i){const a=r[0],l=new Map(a);a.set("offset",0),l.set("offset",1),r=[a,l]}return TD(this.element,r,s,o,this.duration,this.startTime,this.easing,!1)}}class hK extends rS{constructor(e,t,i,r,s,o,a=!1){super(e,t,o.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=s,this._stretchStartingKeyframe=a,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&t){const s=[],o=i+t,a=t/o,l=yu(e[0]);l.set("offset",0),s.push(l);const c=yu(e[0]);c.set("offset",f3(a)),s.push(c);const d=e.length-1;for(let h=1;h<=d;h++){let p=yu(e[h]);const m=p.get("offset");p.set("offset",f3((t+m*i)/o)),s.push(p)}i=o,t=0,r="",e=s}return TD(this.element,e,this.preStyleProps,this.postStyleProps,i,t,r,!0)}}function f3(n,e=3){const t=Math.pow(10,e-1);return Math.round(n*t)/t}class ID{}const pK=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class mK extends ID{normalizePropertyName(e,t){return ED(e)}normalizeStyleValue(e,t,i,r){let s="";const o=i.toString().trim();if(pK.has(t)&&0!==i&&"0"!==i)if("number"==typeof i)s="px";else{const a=i.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&r.push(function cY(n,e){return new ae(3005,!1)}())}return o+s}}function p3(n,e,t,i,r,s,o,a,l,c,d,h,p){return{type:0,element:n,triggerName:e,isRemovalTransition:r,fromState:t,fromStyles:s,toState:i,toStyles:o,timelines:a,queriedElements:l,preStyleProps:c,postStyleProps:d,totalTime:h,errors:p}}const RD={};class m3{constructor(e,t,i){this._triggerName=e,this.ast=t,this._stateStyles=i}match(e,t,i,r){return function gK(n,e,t,i,r){return n.some(s=>s(e,t,i,r))}(this.ast.matchers,e,t,i,r)}buildStyles(e,t,i){let r=this._stateStyles.get("*");return void 0!==e&&(r=this._stateStyles.get(e?.toString())||r),r?r.buildStyles(t,i):new Map}build(e,t,i,r,s,o,a,l,c,d){const h=[],p=this.ast.options&&this.ast.options.params||RD,g=this.buildStyles(i,a&&a.params||RD,h),v=l&&l.params||RD,w=this.buildStyles(r,v,h),y=new Set,b=new Map,x=new Map,E="void"===r,C={params:_K(v,p),delay:this.ast.options?.delay},A=d?[]:AD(e,t,this.ast.animation,s,o,g,w,C,c,h);let D=0;if(A.forEach(M=>{D=Math.max(M.duration+M.delay,D)}),h.length)return p3(t,this._triggerName,i,r,E,g,w,[],[],b,x,D,h);A.forEach(M=>{const R=M.element,$=oo(b,R,new Set);M.preStyleProps.forEach(se=>$.add(se));const ee=oo(x,R,new Set);M.postStyleProps.forEach(se=>ee.add(se)),R!==t&&y.add(R)});const L=Jx(y.values());return p3(t,this._triggerName,i,r,E,g,w,A,L,b,x,D)}}function _K(n,e){const t=Zy(e);for(const i in n)n.hasOwnProperty(i)&&null!=n[i]&&(t[i]=n[i]);return t}class yK{constructor(e,t,i){this.styles=e,this.defaultParams=t,this.normalizer=i}buildStyles(e,t){const i=new Map,r=Zy(this.defaultParams);return Object.keys(e).forEach(s=>{const o=e[s];null!==o&&(r[s]=o)}),this.styles.styles.forEach(s=>{"string"!=typeof s&&s.forEach((o,a)=>{o&&(o=Qy(o,r,t));const l=this.normalizer.normalizePropertyName(a,t);o=this.normalizer.normalizeStyleValue(a,l,o,t),i.set(a,o)})}),i}}class wK{constructor(e,t,i){this.name=e,this.ast=t,this._normalizer=i,this.transitionFactories=[],this.states=new Map,t.states.forEach(r=>{this.states.set(r.name,new yK(r.style,r.options&&r.options.params||{},i))}),g3(this.states,"true","1"),g3(this.states,"false","0"),t.transitions.forEach(r=>{this.transitionFactories.push(new m3(e,r,this.states))}),this.fallbackTransition=function bK(n,e,t){return new m3(n,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,a)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,i,r){return this.transitionFactories.find(o=>o.match(e,t,i,r))||null}matchStyles(e,t,i){return this.fallbackTransition.buildStyles(e,t,i)}}function g3(n,e,t){n.has(e)?n.has(t)||n.set(t,n.get(e)):n.has(t)&&n.set(e,n.get(t))}const xK=new nS;class SK{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,t){const i=[],s=CD(this._driver,t,i,[]);if(i.length)throw function TY(n){return new ae(3503,!1)}();this._animations.set(e,s)}_buildPlayer(e,t,i){const r=e.element,s=JU(this._normalizer,e.keyframes,t,i);return this._driver.animate(r,s,e.duration,e.delay,e.easing,[],!0)}create(e,t,i={}){const r=[],s=this._animations.get(e);let o;const a=new Map;if(s?(o=AD(this._driver,t,s,wD,Xx,new Map,new Map,i,xK,r),o.forEach(d=>{const h=oo(a,d.element,new Map);d.postStyleProps.forEach(p=>h.set(p,null))})):(r.push(function AY(){return new ae(3300,!1)}()),o=[]),r.length)throw function DY(n){return new ae(3504,!1)}();a.forEach((d,h)=>{d.forEach((p,m)=>{d.set(m,this._driver.computeStyle(h,m,Xl))})});const c=_u(o.map(d=>{const h=a.get(d.element);return this._buildPlayer(d,new Map,h)}));return this._playersById.set(e,c),c.onDestroy(()=>this.destroy(e)),this.players.push(c),c}destroy(e){const t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);const i=this.players.indexOf(t);i>=0&&this.players.splice(i,1)}_getPlayer(e){const t=this._playersById.get(e);if(!t)throw function IY(n){return new ae(3301,!1)}();return t}listen(e,t,i,r){const s=_D(t,"","","");return mD(this._getPlayer(e),i,s,r),()=>{}}command(e,t,i,r){if("register"==i)return void this.register(e,r[0]);if("create"==i)return void this.create(e,t,r[0]||{});const s=this._getPlayer(e);switch(i){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}}const _3="ng-animate-queued",PD="ng-animate-disabled",AK=[],y3={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},DK={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},ma="__ng_removed";class ND{get params(){return this.options.params}constructor(e,t=""){this.namespaceId=t;const i=e&&e.hasOwnProperty("value");if(this.value=function NK(n){return n??null}(i?e.value:e),i){const s=Zy(e);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){const t=e.params;if(t){const i=this.options.params;Object.keys(t).forEach(r=>{null==i[r]&&(i[r]=t[r])})}}}const ev="void",OD=new ND(ev);class IK{constructor(e,t,i){this.id=e,this.hostElement=t,this._engine=i,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,Lo(t,this._hostClassName)}listen(e,t,i,r){if(!this._triggers.has(t))throw function RY(n,e){return new ae(3302,!1)}();if(null==i||0==i.length)throw function PY(n){return new ae(3303,!1)}();if(!function OK(n){return"start"==n||"done"==n}(i))throw function NY(n,e){return new ae(3400,!1)}();const s=oo(this._elementListeners,e,[]),o={name:t,phase:i,callback:r};s.push(o);const a=oo(this._engine.statesByElement,e,new Map);return a.has(t)||(Lo(e,Yx),Lo(e,Yx+"-"+t),a.set(t,OD)),()=>{this._engine.afterFlush(()=>{const l=s.indexOf(o);l>=0&&s.splice(l,1),this._triggers.has(t)||a.delete(t)})}}register(e,t){return!this._triggers.has(e)&&(this._triggers.set(e,t),!0)}_getTrigger(e){const t=this._triggers.get(e);if(!t)throw function OY(n){return new ae(3401,!1)}();return t}trigger(e,t,i,r=!0){const s=this._getTrigger(t),o=new LD(this.id,t,e);let a=this._engine.statesByElement.get(e);a||(Lo(e,Yx),Lo(e,Yx+"-"+t),this._engine.statesByElement.set(e,a=new Map));let l=a.get(t);const c=new ND(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&l&&c.absorbOptions(l.options),a.set(t,c),l||(l=OD),c.value!==ev&&l.value===c.value){if(!function kK(n,e){const t=Object.keys(n),i=Object.keys(e);if(t.length!=i.length)return!1;for(let r=0;r<t.length;r++){const s=t[r];if(!e.hasOwnProperty(s)||n[s]!==e[s])return!1}return!0}(l.params,c.params)){const v=[],w=s.matchStyles(l.value,l.params,v),y=s.matchStyles(c.value,c.params,v);v.length?this._engine.reportError(v):this._engine.afterFlush(()=>{Kd(e,w),tl(e,y)})}return}const p=oo(this._engine.playersByElement,e,[]);p.forEach(v=>{v.namespaceId==this.id&&v.triggerName==t&&v.queued&&v.destroy()});let m=s.matchTransition(l.value,c.value,e,c.params),g=!1;if(!m){if(!r)return;m=s.fallbackTransition,g=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:m,fromState:l,toState:c,player:o,isFallbackTransition:g}),g||(Lo(e,_3),o.onStart(()=>{Kp(e,_3)})),o.onDone(()=>{let v=this.players.indexOf(o);v>=0&&this.players.splice(v,1);const w=this._engine.playersByElement.get(e);if(w){let y=w.indexOf(o);y>=0&&w.splice(y,1)}}),this.players.push(o),p.push(o),o}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,i)=>{this._elementListeners.set(i,t.filter(r=>r.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(i=>i.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const i=this._engine.driver.query(e,Kx,!0);i.forEach(r=>{if(r[ma])return;const s=this._engine.fetchNamespacesByElement(r);s.size?s.forEach(o=>o.triggerLeaveAnimation(r,t,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(e,t,i,r){const s=this._engine.statesByElement.get(e),o=new Map;if(s){const a=[];if(s.forEach((l,c)=>{if(o.set(c,l.value),this._triggers.has(c)){const d=this.trigger(e,c,ev,r);d&&a.push(d)}}),a.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,o),i&&_u(a).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),i=this._engine.statesByElement.get(e);if(t&&i){const r=new Set;t.forEach(s=>{const o=s.name;if(r.has(o))return;r.add(o);const l=this._triggers.get(o).fallbackTransition,c=i.get(o)||OD,d=new ND(ev),h=new LD(this.id,o,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:o,transition:l,fromState:c,toState:d,player:h,isFallbackTransition:!0})})}}removeNode(e,t){const i=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let r=!1;if(i.totalAnimations){const s=i.players.length?i.playersByQueriedElement.get(e):[];if(s&&s.length)r=!0;else{let o=e;for(;o=o.parentNode;)if(i.statesByElement.get(o)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(e),r)i.markElementAsRemoved(this.id,e,!1,t);else{const s=e[ma];(!s||s===y3)&&(i.afterFlush(()=>this.clearElementCache(e)),i.destroyInnerAnimations(e),i._onRemovalComplete(e,t))}}insertNode(e,t){Lo(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const s=i.element,o=this._elementListeners.get(s);o&&o.forEach(a=>{if(a.name==i.triggerName){const l=_D(s,i.triggerName,i.fromState.value,i.toState.value);l._data=e,mD(i.player,a.phase,l,a.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):t.push(i)}),this._queue=[],t.sort((i,r)=>{const s=i.transition.ast.depCount,o=r.transition.ast.depCount;return 0==s||0==o?s-o:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}}class RK{_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}constructor(e,t,i){this.bodyNode=e,this.driver=t,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,s)=>{}}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(i=>{i.queued&&e.push(i)})}),e}createNamespace(e,t){const i=new IK(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(i,t):(this.newHostElements.set(t,i),this.collectEnterElement(t)),this._namespaceLookup[e]=i}_balanceNamespaceList(e,t){const i=this._namespaceList,r=this.namespacesByHostElement;if(i.length-1>=0){let o=!1,a=this.driver.getParentElement(t);for(;a;){const l=r.get(a);if(l){const c=i.indexOf(l);i.splice(c+1,0,e),o=!0;break}a=this.driver.getParentElement(a)}o||i.unshift(e)}else i.push(e);return r.set(t,e),e}register(e,t){let i=this._namespaceLookup[e];return i||(i=this.createNamespace(e,t)),i}registerTrigger(e,t,i){let r=this._namespaceLookup[e];r&&r.register(t,i)&&this.totalAnimations++}destroy(e,t){e&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const i=this._fetchNamespace(e);this.namespacesByHostElement.delete(i.hostElement);const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1),i.destroy(t),delete this._namespaceLookup[e]}))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,i=this.statesByElement.get(e);if(i)for(let r of i.values())if(r.namespaceId){const s=this._fetchNamespace(r.namespaceId);s&&t.add(s)}return t}trigger(e,t,i,r){if(sS(t)){const s=this._fetchNamespace(e);if(s)return s.trigger(t,i,r),!0}return!1}insertNode(e,t,i,r){if(!sS(t))return;const s=t[ma];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const o=this.collectedLeaveElements.indexOf(t);o>=0&&this.collectedLeaveElements.splice(o,1)}if(e){const o=this._fetchNamespace(e);o&&o.insertNode(t,i)}r&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),Lo(e,PD)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),Kp(e,PD))}removeNode(e,t,i){if(sS(t)){const r=e?this._fetchNamespace(e):null;r?r.removeNode(t,i):this.markElementAsRemoved(e,t,!1,i);const s=this.namespacesByHostElement.get(t);s&&s.id!==e&&s.removeNode(t,i)}else this._onRemovalComplete(t,i)}markElementAsRemoved(e,t,i,r,s){this.collectedLeaveElements.push(t),t[ma]={namespaceId:e,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:s}}listen(e,t,i,r,s){return sS(t)?this._fetchNamespace(e).listen(t,i,r,s):()=>{}}_buildInstruction(e,t,i,r,s){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,i,r,e.fromState.options,e.toState.options,t,s)}destroyInnerAnimations(e){let t=this.driver.query(e,Kx,!0);t.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,bD,!0),t.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return _u(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e[ma];if(t&&t.setForRemoval){if(e[ma]=y3,t.namespaceId){this.destroyInnerAnimations(e);const i=this._fetchNamespace(t.namespaceId);i&&i.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(PD)&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)Lo(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{t=this._flushAnimations(i,e)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],t.length?_u(t).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(e){throw function LY(n){return new ae(3402,!1)}()}_flushAnimations(e,t){const i=new nS,r=[],s=new Map,o=[],a=new Map,l=new Map,c=new Map,d=new Set;this.disabledNodes.forEach(G=>{d.add(G);const X=this.driver.query(G,".ng-animate-queued",!0);for(let Q=0;Q<X.length;Q++)d.add(X[Q])});const h=this.bodyNode,p=Array.from(this.statesByElement.keys()),m=b3(p,this.collectedEnterElements),g=new Map;let v=0;m.forEach((G,X)=>{const Q=wD+v++;g.set(X,Q),G.forEach(Z=>Lo(Z,Q))});const w=[],y=new Set,b=new Set;for(let G=0;G<this.collectedLeaveElements.length;G++){const X=this.collectedLeaveElements[G],Q=X[ma];Q&&Q.setForRemoval&&(w.push(X),y.add(X),Q.hasAnimation?this.driver.query(X,".ng-star-inserted",!0).forEach(Z=>y.add(Z)):b.add(X))}const x=new Map,E=b3(p,Array.from(y));E.forEach((G,X)=>{const Q=Xx+v++;x.set(X,Q),G.forEach(Z=>Lo(Z,Q))}),e.push(()=>{m.forEach((G,X)=>{const Q=g.get(X);G.forEach(Z=>Kp(Z,Q))}),E.forEach((G,X)=>{const Q=x.get(X);G.forEach(Z=>Kp(Z,Q))}),w.forEach(G=>{this.processLeaveNode(G)})});const C=[],A=[];for(let G=this._namespaceList.length-1;G>=0;G--)this._namespaceList[G].drainQueuedTransitions(t).forEach(Q=>{const Z=Q.player,le=Q.element;if(C.push(Z),this.collectedEnterElements.length){const Be=le[ma];if(Be&&Be.setForMove){if(Be.previousTriggersValues&&Be.previousTriggersValues.has(Q.triggerName)){const Xe=Be.previousTriggersValues.get(Q.triggerName),gt=this.statesByElement.get(Q.element);if(gt&&gt.has(Q.triggerName)){const At=gt.get(Q.triggerName);At.value=Xe,gt.set(Q.triggerName,At)}}return void Z.destroy()}}const q=!h||!this.driver.containsElement(h,le),oe=x.get(le),Se=g.get(le),ve=this._buildInstruction(Q,i,Se,oe,q);if(ve.errors&&ve.errors.length)return void A.push(ve);if(q)return Z.onStart(()=>Kd(le,ve.fromStyles)),Z.onDestroy(()=>tl(le,ve.toStyles)),void r.push(Z);if(Q.isFallbackTransition)return Z.onStart(()=>Kd(le,ve.fromStyles)),Z.onDestroy(()=>tl(le,ve.toStyles)),void r.push(Z);const Ne=[];ve.timelines.forEach(Be=>{Be.stretchStartingKeyframe=!0,this.disabledNodes.has(Be.element)||Ne.push(Be)}),ve.timelines=Ne,i.append(le,ve.timelines),o.push({instruction:ve,player:Z,element:le}),ve.queriedElements.forEach(Be=>oo(a,Be,[]).push(Z)),ve.preStyleProps.forEach((Be,Xe)=>{if(Be.size){let gt=l.get(Xe);gt||l.set(Xe,gt=new Set),Be.forEach((At,it)=>gt.add(it))}}),ve.postStyleProps.forEach((Be,Xe)=>{let gt=c.get(Xe);gt||c.set(Xe,gt=new Set),Be.forEach((At,it)=>gt.add(it))})});if(A.length){const G=[];A.forEach(X=>{G.push(function FY(n,e){return new ae(3505,!1)}())}),C.forEach(X=>X.destroy()),this.reportError(G)}const D=new Map,L=new Map;o.forEach(G=>{const X=G.element;i.has(X)&&(L.set(X,X),this._beforeAnimationBuild(G.player.namespaceId,G.instruction,D))}),r.forEach(G=>{const X=G.element;this._getPreviousPlayers(X,!1,G.namespaceId,G.triggerName,null).forEach(Z=>{oo(D,X,[]).push(Z),Z.destroy()})});const M=w.filter(G=>S3(G,l,c)),R=new Map;w3(R,this.driver,b,c,Xl).forEach(G=>{S3(G,l,c)&&M.push(G)});const ee=new Map;m.forEach((G,X)=>{w3(ee,this.driver,new Set(G),l,"!")}),M.forEach(G=>{const X=R.get(G),Q=ee.get(G);R.set(G,new Map([...X?.entries()??[],...Q?.entries()??[]]))});const se=[],V=[],J={};o.forEach(G=>{const{element:X,player:Q,instruction:Z}=G;if(i.has(X)){if(d.has(X))return Q.onDestroy(()=>tl(X,Z.toStyles)),Q.disabled=!0,Q.overrideTotalTime(Z.totalTime),void r.push(Q);let le=J;if(L.size>1){let oe=X;const Se=[];for(;oe=oe.parentNode;){const ve=L.get(oe);if(ve){le=ve;break}Se.push(oe)}Se.forEach(ve=>L.set(ve,le))}const q=this._buildAnimation(Q.namespaceId,Z,D,s,ee,R);if(Q.setRealPlayer(q),le===J)se.push(Q);else{const oe=this.playersByElement.get(le);oe&&oe.length&&(Q.parentPlayer=_u(oe)),r.push(Q)}}else Kd(X,Z.fromStyles),Q.onDestroy(()=>tl(X,Z.toStyles)),V.push(Q),d.has(X)&&r.push(Q)}),V.forEach(G=>{const X=s.get(G.element);if(X&&X.length){const Q=_u(X);G.setRealPlayer(Q)}}),r.forEach(G=>{G.parentPlayer?G.syncPlayerEvents(G.parentPlayer):G.destroy()});for(let G=0;G<w.length;G++){const X=w[G],Q=X[ma];if(Kp(X,Xx),Q&&Q.hasAnimation)continue;let Z=[];if(a.size){let q=a.get(X);q&&q.length&&Z.push(...q);let oe=this.driver.query(X,bD,!0);for(let Se=0;Se<oe.length;Se++){let ve=a.get(oe[Se]);ve&&ve.length&&Z.push(...ve)}}const le=Z.filter(q=>!q.destroyed);le.length?LK(this,X,le):this.processLeaveNode(X)}return w.length=0,se.forEach(G=>{this.players.push(G),G.onDone(()=>{G.destroy();const X=this.players.indexOf(G);this.players.splice(X,1)}),G.play()}),se}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,i,r,s){let o=[];if(t){const a=this.playersByQueriedElement.get(e);a&&(o=a)}else{const a=this.playersByElement.get(e);if(a){const l=!s||s==ev;a.forEach(c=>{c.queued||!l&&c.triggerName!=r||o.push(c)})}}return(i||r)&&(o=o.filter(a=>!(i&&i!=a.namespaceId||r&&r!=a.triggerName))),o}_beforeAnimationBuild(e,t,i){const s=t.element,o=t.isRemovalTransition?void 0:e,a=t.isRemovalTransition?void 0:t.triggerName;for(const l of t.timelines){const c=l.element,d=c!==s,h=oo(i,c,[]);this._getPreviousPlayers(c,d,o,a,t.toState).forEach(m=>{const g=m.getRealPlayer();g.beforeDestroy&&g.beforeDestroy(),m.destroy(),h.push(m)})}Kd(s,t.fromStyles)}_buildAnimation(e,t,i,r,s,o){const a=t.triggerName,l=t.element,c=[],d=new Set,h=new Set,p=t.timelines.map(g=>{const v=g.element;d.add(v);const w=v[ma];if(w&&w.removedBeforeQueried)return new Ky(g.duration,g.delay);const y=v!==l,b=function FK(n){const e=[];return x3(n,e),e}((i.get(v)||AK).map(D=>D.getRealPlayer())).filter(D=>!!D.element&&D.element===v),x=s.get(v),E=o.get(v),C=JU(this._normalizer,g.keyframes,x,E),A=this._buildPlayer(g,C,b);if(g.subTimeline&&r&&h.add(v),y){const D=new LD(e,a,v);D.setRealPlayer(A),c.push(D)}return A});c.forEach(g=>{oo(this.playersByQueriedElement,g.element,[]).push(g),g.onDone(()=>function PK(n,e,t){let i=n.get(e);if(i){if(i.length){const r=i.indexOf(t);i.splice(r,1)}0==i.length&&n.delete(e)}return i}(this.playersByQueriedElement,g.element,g))}),d.forEach(g=>Lo(g,s3));const m=_u(p);return m.onDestroy(()=>{d.forEach(g=>Kp(g,s3)),tl(l,t.toStyles)}),h.forEach(g=>{oo(r,g,[]).push(m)}),m}_buildPlayer(e,t,i){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,i):new Ky(e.duration,e.delay)}}class LD{constructor(e,t,i){this.namespaceId=e,this.triggerName=t,this.element=i,this._player=new Ky,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,i)=>{t.forEach(r=>mD(e,i,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){oo(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function sS(n){return n&&1===n.nodeType}function v3(n,e){const t=n.style.display;return n.style.display=e??"none",t}function w3(n,e,t,i,r){const s=[];t.forEach(l=>s.push(v3(l)));const o=[];i.forEach((l,c)=>{const d=new Map;l.forEach(h=>{const p=e.computeStyle(c,h,r);d.set(h,p),(!p||0==p.length)&&(c[ma]=DK,o.push(c))}),n.set(c,d)});let a=0;return t.forEach(l=>v3(l,s[a++])),o}function b3(n,e){const t=new Map;if(n.forEach(a=>t.set(a,[])),0==e.length)return t;const r=new Set(e),s=new Map;function o(a){if(!a)return 1;let l=s.get(a);if(l)return l;const c=a.parentNode;return l=t.has(c)?c:r.has(c)?1:o(c),s.set(a,l),l}return e.forEach(a=>{const l=o(a);1!==l&&t.get(l).push(a)}),t}function Lo(n,e){n.classList?.add(e)}function Kp(n,e){n.classList?.remove(e)}function LK(n,e,t){_u(t).onDone(()=>n.processLeaveNode(e))}function x3(n,e){for(let t=0;t<n.length;t++){const i=n[t];i instanceof KU?x3(i.players,e):e.push(i)}}function S3(n,e,t){const i=t.get(n);if(!i)return!1;let r=e.get(n);return r?i.forEach(s=>r.add(s)):e.set(n,i),t.delete(n),!0}class oS{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(r,s)=>{},this._transitionEngine=new RK(e,t,i),this._timelineEngine=new SK(e,t,i),this._transitionEngine.onRemovalComplete=(r,s)=>this.onRemovalComplete(r,s)}registerTrigger(e,t,i,r,s){const o=e+"-"+r;let a=this._triggerCache[o];if(!a){const l=[],d=CD(this._driver,s,l,[]);if(l.length)throw function CY(n,e){return new ae(3404,!1)}();a=function vK(n,e,t){return new wK(n,e,t)}(r,d,this._normalizer),this._triggerCache[o]=a}this._transitionEngine.registerTrigger(t,r,a)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,i,r){this._transitionEngine.insertNode(e,t,i,r)}onRemove(e,t,i){this._transitionEngine.removeNode(e,t,i)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,i,r){if("@"==i.charAt(0)){const[s,o]=QU(i);this._timelineEngine.command(s,t,o,r)}else this._transitionEngine.trigger(e,t,i,r)}listen(e,t,i,r,s){if("@"==i.charAt(0)){const[o,a]=QU(i);return this._timelineEngine.listen(o,t,a,s)}return this._transitionEngine.listen(e,t,i,r,s)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(e){this._transitionEngine.afterFlushAnimationsDone(e)}}let BK=(()=>{class n{static#e=this.initialStylesByElement=new WeakMap;constructor(t,i,r){this._element=t,this._startStyles=i,this._endStyles=r,this._state=0;let s=n.initialStylesByElement.get(t);s||n.initialStylesByElement.set(t,s=new Map),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&tl(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(tl(this._element,this._initialStyles),this._endStyles&&(tl(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(Kd(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Kd(this._element,this._endStyles),this._endStyles=null),tl(this._element,this._initialStyles),this._state=3)}}return n})();function FD(n){let e=null;return n.forEach((t,i)=>{(function VK(n){return"display"===n||"position"===n})(i)&&(e=e||new Map,e.set(i,t))}),e}class E3{constructor(e,t,i,r){this.element=e,this.keyframes=t,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){const t=[];return e.forEach(i=>{t.push(Object.fromEntries(i))}),t}_triggerWebAnimation(e,t,i){return e.animate(this._convertKeyframesToObject(t),i)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((i,r)=>{"offset"!==r&&e.set(r,this._finished?i:c3(this.element,r))}),this.currentSnapshot=e}triggerCallback(e){const t="start"===e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class HK{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}matchesElement(e,t){return!1}containsElement(e,t){return t3(e,t)}getParentElement(e){return yD(e)}query(e,t,i){return n3(e,t,i)}computeStyle(e,t,i){return window.getComputedStyle(e)[t]}animate(e,t,i,r,s,o=[]){const l={duration:i,delay:r,fill:0==r?"both":"forwards"};s&&(l.easing=s);const c=new Map,d=o.filter(m=>m instanceof E3);(function XY(n,e){return 0===n||0===e})(i,r)&&d.forEach(m=>{m.currentSnapshot.forEach((g,v)=>c.set(v,g))});let h=function jY(n){return n.length?n[0]instanceof Map?n:n.map(e=>o3(e)):[]}(t).map(m=>yu(m));h=function YY(n,e,t){if(t.size&&e.length){let i=e[0],r=[];if(t.forEach((s,o)=>{i.has(o)||r.push(o),i.set(o,s)}),r.length)for(let s=1;s<e.length;s++){let o=e[s];r.forEach(a=>o.set(a,c3(n,a)))}}return e}(e,h,c);const p=function UK(n,e){let t=null,i=null;return Array.isArray(e)&&e.length?(t=FD(e[0]),e.length>1&&(i=FD(e[e.length-1]))):e instanceof Map&&(t=FD(e)),t||i?new BK(n,t,i):null}(e,h);return new E3(e,h,l,p)}}let zK=(()=>{class n extends qU{constructor(t,i){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(i.body,{id:"0",encapsulation:Rs.None,styles:[],data:{animation:[]}})}build(t){const i=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(t)?XU(t):t;return C3(this._renderer,null,i,"register",[r]),new GK(i,this._renderer)}static#e=this.\u0275fac=function(i){return new(i||n)(Le(Bn),Le(qr))};static#t=this.\u0275prov=Qe({token:n,factory:n.\u0275fac})}return n})();class GK extends iY{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new WK(this._id,e,t||{},this._renderer)}}class WK{constructor(e,t,i,r){this.id=e,this.element=t,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return C3(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function C3(n,e,t,i,r){return n.setProperty(e,`@@${t}:${i}`,r)}const M3="@.disabled";let jK=(()=>{class n{constructor(t,i,r){this.delegate=t,this.engine=i,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,i.onRemovalComplete=(s,o)=>{const a=o?.parentNode(s);a&&o.removeChild(a,s)}}createRenderer(t,i){const s=this.delegate.createRenderer(t,i);if(!(t&&i&&i.data&&i.data.animation)){let d=this._rendererCache.get(s);return d||(d=new T3("",s,this.engine,()=>this._rendererCache.delete(s)),this._rendererCache.set(s,d)),d}const o=i.id,a=i.id+"-"+this._currentId;this._currentId++,this.engine.register(a,t);const l=d=>{Array.isArray(d)?d.forEach(l):this.engine.registerTrigger(o,a,t,d.name,d)};return i.data.animation.forEach(l),new $K(this,a,s,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(t,i,r){t>=0&&t<this._microtaskId?this._zone.run(()=>i(r)):(0==this._animationCallbacksBuffer.length&&queueMicrotask(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(s=>{const[o,a]=s;o(a)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}static#e=this.\u0275fac=function(i){return new(i||n)(Le(Bn),Le(oS),Le(Dn))};static#t=this.\u0275prov=Qe({token:n,factory:n.\u0275fac})}return n})();class T3{constructor(e,t,i,r){this.namespaceId=e,this.delegate=t,this.engine=i,this._onDestroy=r}get data(){return this.delegate.data}destroyNode(e){this.delegate.destroyNode?.(e)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,i,r=!0){this.delegate.insertBefore(e,t,i),this.engine.onInsert(this.namespaceId,t,e,r)}removeChild(e,t,i){this.engine.onRemove(this.namespaceId,t,this.delegate)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,i,r){this.delegate.setAttribute(e,t,i,r)}removeAttribute(e,t,i){this.delegate.removeAttribute(e,t,i)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,i,r){this.delegate.setStyle(e,t,i,r)}removeStyle(e,t,i){this.delegate.removeStyle(e,t,i)}setProperty(e,t,i){"@"==t.charAt(0)&&t==M3?this.disableAnimations(e,!!i):this.delegate.setProperty(e,t,i)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,i){return this.delegate.listen(e,t,i)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class $K extends T3{constructor(e,t,i,r,s){super(t,i,r,s),this.factory=e,this.namespaceId=t}setProperty(e,t,i){"@"==t.charAt(0)?"."==t.charAt(1)&&t==M3?this.disableAnimations(e,i=void 0===i||!!i):this.engine.process(this.namespaceId,e,t.slice(1),i):this.delegate.setProperty(e,t,i)}listen(e,t,i){if("@"==t.charAt(0)){const r=function qK(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(e);let s=t.slice(1),o="";return"@"!=s.charAt(0)&&([s,o]=function XK(n){const e=n.indexOf(".");return[n.substring(0,e),n.slice(e+1)]}(s)),this.engine.listen(this.namespaceId,r,s,o,a=>{this.factory.scheduleListenerCallback(a._data||-1,i,a)})}return this.delegate.listen(e,t,i)}}let YK=(()=>{class n extends oS{constructor(t,i,r,s){super(t.body,i,r)}ngOnDestroy(){this.flush()}static#e=this.\u0275fac=function(i){return new(i||n)(Le(qr),Le(vD),Le(ID),Le($d))};static#t=this.\u0275prov=Qe({token:n,factory:n.\u0275fac})}return n})();const A3=[{provide:qU,useClass:zK},{provide:ID,useFactory:function KK(){return new mK}},{provide:oS,useClass:YK},{provide:Bn,useFactory:function ZK(n,e,t){return new jK(n,e,t)},deps:[cD,oS,Dn]}],kD=[{provide:vD,useFactory:()=>new HK},{provide:Kb,useValue:"BrowserAnimations"},...A3],D3=[{provide:vD,useClass:i3},{provide:Kb,useValue:"NoopAnimations"},...A3];let JK=(()=>{class n{static withConfig(t){return{ngModule:n,providers:t.disableAnimations?D3:kD}}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Oi({type:n});static#n=this.\u0275inj=wi({providers:kD,imports:[GU]})}return n})();const{isArray:QK}=Array,{getPrototypeOf:eZ,prototype:tZ,keys:nZ}=Object;function I3(n){if(1===n.length){const e=n[0];if(QK(e))return{args:e,keys:null};if(function iZ(n){return n&&"object"==typeof n&&eZ(n)===tZ}(e)){const t=nZ(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}const{isArray:rZ}=Array;function R3(n){return tn(e=>function sZ(n,e){return rZ(e)?n(...e):n(e)}(n,e))}function P3(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}let N3=(()=>{class n{constructor(t,i){this._renderer=t,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static#e=this.\u0275fac=function(i){return new(i||n)(ce(Si),ce(Cn))};static#t=this.\u0275dir=yt({type:n})}return n})(),Jd=(()=>{class n extends N3{static#e=this.\u0275fac=function(){let t;return function(r){return(t||(t=bi(n)))(r||n)}}();static#t=this.\u0275dir=yt({type:n,features:[wn]})}return n})();const ga=new Ye("NgValueAccessor"),lZ={provide:ga,useExisting:yn(()=>lS),multi:!0},uZ=new Ye("CompositionEventMode");let lS=(()=>{class n extends N3{constructor(t,i,r){super(t,i),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function cZ(){const n=mu()?mu().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(t){this.setProperty("value",t??"")}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static#e=this.\u0275fac=function(i){return new(i||n)(ce(Si),ce(Cn),ce(uZ,8))};static#t=this.\u0275dir=yt({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,r){1&i&&pn("input",function(o){return r._handleInput(o.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(o){return r._compositionEnd(o.target.value)})},features:[Vn([lZ]),wn]})}return n})();const Xr=new Ye("NgValidators"),wu=new Ye("NgAsyncValidators");function W3(n){return null!=n}function j3(n){return Dy(n)?vi(n):n}function $3(n){let e={};return n.forEach(t=>{e=null!=t?{...e,...t}:e}),0===Object.keys(e).length?null:e}function q3(n,e){return e.map(t=>t(n))}function X3(n){return n.map(e=>function hZ(n){return!n.validate}(e)?e:t=>e.validate(t))}function UD(n){return null!=n?function Y3(n){if(!n)return null;const e=n.filter(W3);return 0==e.length?null:function(t){return $3(q3(t,e))}}(X3(n)):null}function BD(n){return null!=n?function K3(n){if(!n)return null;const e=n.filter(W3);return 0==e.length?null:function(t){return function oZ(...n){const e=Zu(n),{args:t,keys:i}=I3(n),r=new Tn(s=>{const{length:o}=t;if(!o)return void s.complete();const a=new Array(o);let l=o,c=o;for(let d=0;d<o;d++){let h=!1;os(t[d]).subscribe(ei(s,p=>{h||(h=!0,c--),a[d]=p},()=>l--,void 0,()=>{(!l||!h)&&(c||s.next(i?P3(i,a):a),s.complete())}))}});return e?r.pipe(R3(e)):r}(q3(t,e).map(j3)).pipe(tn($3))}}(X3(n)):null}function Z3(n,e){return null===n?[e]:Array.isArray(n)?[...n,e]:[n,e]}function VD(n){return n?Array.isArray(n)?n:[n]:[]}function uS(n,e){return Array.isArray(n)?n.includes(e):n===e}function eB(n,e){const t=VD(e);return VD(n).forEach(r=>{uS(t,r)||t.push(r)}),t}function tB(n,e){return VD(e).filter(t=>!uS(n,t))}class nB{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=UD(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=BD(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class ws extends nB{get formDirective(){return null}get path(){return null}}class bu extends nB{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class iB{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let rB=(()=>{class n extends iB{constructor(t){super(t)}static#e=this.\u0275fac=function(i){return new(i||n)(ce(bu,2))};static#t=this.\u0275dir=yt({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,r){2&i&&Iy("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[wn]})}return n})();const tv="VALID",hS="INVALID",Zp="PENDING",nv="DISABLED";function fS(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}class lB{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===tv}get invalid(){return this.status===hS}get pending(){return this.status==Zp}get disabled(){return this.status===nv}get enabled(){return this.status!==nv}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(eB(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(eB(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(tB(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(tB(e,this._rawAsyncValidators))}hasValidator(e){return uS(this._rawValidators,e)}hasAsyncValidator(e){return uS(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=Zp,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=nv,this.errors=null,this._forEachChild(i=>{i.disable({...e,onlySelf:!0})}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=tv,this._forEachChild(i=>{i.enable({...e,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===tv||this.status===Zp)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?nv:tv}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=Zp,this._hasOwnPendingAsyncValidator=!0;const t=j3(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){let t=e;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((i,r)=>i&&i._find(r),this)}getError(e,t){const i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new Yn,this.statusChanges=new Yn}_calculateStatus(){return this._allControlsDisabled()?nv:this.errors?hS:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Zp)?Zp:this._anyControlsHaveStatus(hS)?hS:tv}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){fS(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=function _Z(n){return Array.isArray(n)?UD(n):n||null}(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=function yZ(n){return Array.isArray(n)?BD(n):n||null}(this._rawAsyncValidators)}}const Jp=new Ye("CallSetDisabledState",{providedIn:"root",factory:()=>pS}),pS="always";function iv(n,e,t=pS){(function $D(n,e){const t=function J3(n){return n._rawValidators}(n);null!==e.validator?n.setValidators(Z3(t,e.validator)):"function"==typeof t&&n.setValidators([t]);const i=function Q3(n){return n._rawAsyncValidators}(n);null!==e.asyncValidator?n.setAsyncValidators(Z3(i,e.asyncValidator)):"function"==typeof i&&n.setAsyncValidators([i]);const r=()=>n.updateValueAndValidity();_S(e._rawValidators,r),_S(e._rawAsyncValidators,r)})(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||"always"===t)&&e.valueAccessor.setDisabledState?.(n.disabled),function bZ(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&cB(n,e)})}(n,e),function SZ(n,e){const t=(i,r)=>{e.valueAccessor.writeValue(i),r&&e.viewToModelUpdate(i)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}(n,e),function xZ(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&cB(n,e),"submit"!==n.updateOn&&n.markAsTouched()})}(n,e),function wZ(n,e){if(e.valueAccessor.setDisabledState){const t=i=>{e.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}(n,e)}function _S(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function cB(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function hB(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}function fB(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}const pB=class extends lB{constructor(e=null,t,i){super(function GD(n){return(fS(n)?n.validators:n)||null}(t),function WD(n,e){return(fS(e)?e.asyncValidators:n)||null}(i,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),fS(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=fB(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){hB(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){hB(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){fB(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}},RZ={provide:bu,useExisting:yn(()=>ZD)},_B=(()=>Promise.resolve())();let ZD=(()=>{class n extends bu{constructor(t,i,r,s,o,a){super(),this._changeDetectorRef=o,this.callSetDisabledState=a,this.control=new pB,this._registered=!1,this.name="",this.update=new Yn,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=function YD(n,e){if(!e)return null;let t,i,r;return Array.isArray(e),e.forEach(s=>{s.constructor===lS?t=s:function MZ(n){return Object.getPrototypeOf(n.constructor)===Jd}(s)?i=s:r=s}),r||i||t||null}(0,s)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){const i=t.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),function XD(n,e){if(!n.hasOwnProperty("model"))return!1;const t=n.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){iv(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){_B.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){const i=t.isDisabled.currentValue,r=0!==i&&function $p(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}(i);_B.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?function mS(n,e){return[...e.path,n]}(t,this._parent):[t]}static#e=this.\u0275fac=function(i){return new(i||n)(ce(ws,9),ce(Xr,10),ce(wu,10),ce(ga,10),ce(Gy,8),ce(Jp,8))};static#t=this.\u0275dir=yt({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Vn([RZ]),wn,$i]})}return n})(),vB=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Oi({type:n});static#n=this.\u0275inj=wi({})}return n})(),nJ=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Oi({type:n});static#n=this.\u0275inj=wi({imports:[vB]})}return n})(),rJ=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:Jp,useValue:t.callSetDisabledState??pS}]}}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Oi({type:n});static#n=this.\u0275inj=wi({imports:[nJ]})}return n})();function rI(...n){const e=Ju(n),t=Zu(n),{args:i,keys:r}=I3(n);if(0===i.length)return vi([],e);const s=new Tn(function oJ(n,e,t=$o){return i=>{kB(e,()=>{const{length:r}=n,s=new Array(r);let o=r,a=r;for(let l=0;l<r;l++)kB(e,()=>{const c=vi(n[l],e);let d=!1;c.subscribe(ei(i,h=>{s[l]=h,d||(d=!0,a--),a||i.next(t(s.slice()))},()=>{--o||i.complete()}))},i)},i)}}(i,e,r?o=>P3(r,o):$o));return t?s.pipe(R3(t)):s}function kB(n,e,t){n?bo(t,n,e):e()}const vS=B(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function sI(...n){return function aJ(){return Ic(1)}()(vi(n,Ju(n)))}function UB(n){return new Tn(e=>{os(n()).subscribe(e)})}function sv(n,e){const t=_n(n)?n:()=>n,i=r=>r.error(t());return new Tn(e?r=>e.schedule(i,0,r):i)}function oI(){return Wn((n,e)=>{let t=null;n._refCount++;const i=ei(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const r=n._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});n.subscribe(i),i.closed||(t=n.connect())})}class BB extends Tn{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,F0(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new ns;const t=this.getSubject();e.add(this.source.subscribe(ei(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=ns.EMPTY)}return e}refCount(){return oI()(this)}}function Qp(n){return n<=0?()=>xo:Wn((e,t)=>{let i=0;e.subscribe(ei(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function Kl(n,e){return Wn((t,i)=>{let r=0;t.subscribe(ei(i,s=>n.call(e,s,r++)&&i.next(s)))})}function wS(n){return Wn((e,t)=>{let i=!1;e.subscribe(ei(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function VB(n=cJ){return Wn((e,t)=>{let i=!1;e.subscribe(ei(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function cJ(){return new vS}function eh(n,e){const t=arguments.length>=2;return i=>i.pipe(n?Kl((r,s)=>n(r,s,i)):$o,Qp(1),t?wS(e):VB(()=>new vS))}function em(n,e){return _n(e)?nr(n,e,1):nr(n,1)}function Yr(n,e,t){const i=_n(n)||e||t?{next:n,error:e,complete:t}:n;return i?Wn((r,s)=>{var o;null===(o=i.subscribe)||void 0===o||o.call(i);let a=!0;r.subscribe(ei(s,l=>{var c;null===(c=i.next)||void 0===c||c.call(i,l),s.next(l)},()=>{var l;a=!1,null===(l=i.complete)||void 0===l||l.call(i),s.complete()},l=>{var c;a=!1,null===(c=i.error)||void 0===c||c.call(i,l),s.error(l)},()=>{var l,c;a&&(null===(l=i.unsubscribe)||void 0===l||l.call(i)),null===(c=i.finalize)||void 0===c||c.call(i)}))}):$o}function th(n){return Wn((e,t)=>{let s,i=null,r=!1;i=e.subscribe(ei(t,void 0,void 0,o=>{s=os(n(o,th(n)(e))),i?(i.unsubscribe(),i=null,s.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,s.subscribe(t))})}function aI(n){return n<=0?()=>xo:Wn((e,t)=>{let i=[];e.subscribe(ei(t,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(const r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function ov(n){return Wn((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function HB(n){return Wn((e,t)=>{os(n).subscribe(ei(t,()=>t.complete(),Gh)),!t.closed&&e.subscribe(t)})}const Wt="primary",av=Symbol("RouteTitle");class pJ{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function tm(n){return new pJ(n)}function mJ(n,e,t){const i=t.path.split("/");if(i.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||i.length<n.length))return null;const r={};for(let s=0;s<i.length;s++){const o=i[s],a=n[s];if(o.startsWith(":"))r[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function nl(n,e){const t=n?Object.keys(n):void 0,i=e?Object.keys(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!zB(n[r],e[r]))return!1;return!0}function zB(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),i=[...e].sort();return t.every((r,s)=>i[s]===r)}return n===e}function GB(n){return n.length>0?n[n.length-1]:null}function xu(n){return function sJ(n){return!!n&&(n instanceof Tn||_n(n.lift)&&_n(n.subscribe))}(n)?n:Dy(n)?vi(Promise.resolve(n)):wt(n)}const _J={exact:function $B(n,e,t){if(!nh(n.segments,e.segments)||!bS(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const i in e.children)if(!n.children[i]||!$B(n.children[i],e.children[i],t))return!1;return!0},subset:qB},WB={exact:function yJ(n,e){return nl(n,e)},subset:function vJ(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>zB(n[t],e[t]))},ignored:()=>!0};function jB(n,e,t){return _J[t.paths](n.root,e.root,t.matrixParams)&&WB[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function qB(n,e,t){return XB(n,e,e.segments,t)}function XB(n,e,t,i){if(n.segments.length>t.length){const r=n.segments.slice(0,t.length);return!(!nh(r,t)||e.hasChildren()||!bS(r,t,i))}if(n.segments.length===t.length){if(!nh(n.segments,t)||!bS(n.segments,t,i))return!1;for(const r in e.children)if(!n.children[r]||!qB(n.children[r],e.children[r],i))return!1;return!0}{const r=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!!(nh(n.segments,r)&&bS(n.segments,r,i)&&n.children[Wt])&&XB(n.children[Wt],e,s,i)}}function bS(n,e,t){return e.every((i,r)=>WB[t](n[r].parameters,i.parameters))}class nm{constructor(e=new In([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=tm(this.queryParams)),this._queryParamMap}toString(){return xJ.serialize(this)}}class In{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return xS(this)}}class lv{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=tm(this.parameters)),this._parameterMap}toString(){return ZB(this)}}function nh(n,e){return n.length===e.length&&n.every((t,i)=>t.path===e[i].path)}let cv=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Qe({token:n,factory:function(){return new lI},providedIn:"root"})}return n})();class lI{parse(e){const t=new NJ(e);return new nm(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${uv(e.root,!0)}`,i=function CJ(n){const e=Object.keys(n).map(t=>{const i=n[t];return Array.isArray(i)?i.map(r=>`${SS(t)}=${SS(r)}`).join("&"):`${SS(t)}=${SS(i)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${i}${"string"==typeof e.fragment?`#${function SJ(n){return encodeURI(n)}(e.fragment)}`:""}`}}const xJ=new lI;function xS(n){return n.segments.map(e=>ZB(e)).join("/")}function uv(n,e){if(!n.hasChildren())return xS(n);if(e){const t=n.children[Wt]?uv(n.children[Wt],!1):"",i=[];return Object.entries(n.children).forEach(([r,s])=>{r!==Wt&&i.push(`${r}:${uv(s,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}{const t=function bJ(n,e){let t=[];return Object.entries(n.children).forEach(([i,r])=>{i===Wt&&(t=t.concat(e(r,i)))}),Object.entries(n.children).forEach(([i,r])=>{i!==Wt&&(t=t.concat(e(r,i)))}),t}(n,(i,r)=>r===Wt?[uv(n.children[Wt],!1)]:[`${r}:${uv(i,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[Wt]?`${xS(n)}/${t[0]}`:`${xS(n)}/(${t.join("//")})`}}function YB(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function SS(n){return YB(n).replace(/%3B/gi,";")}function cI(n){return YB(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function ES(n){return decodeURIComponent(n)}function KB(n){return ES(n.replace(/\+/g,"%20"))}function ZB(n){return`${cI(n.path)}${function EJ(n){return Object.keys(n).map(e=>`;${cI(e)}=${cI(n[e])}`).join("")}(n.parameters)}`}const MJ=/^[^\/()?;#]+/;function uI(n){const e=n.match(MJ);return e?e[0]:""}const TJ=/^[^\/()?;=#]+/,DJ=/^[^=?&#]+/,RJ=/^[^&#]+/;class NJ{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new In([],{}):new In([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[Wt]=new In(e,t)),i}parseSegment(){const e=uI(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new ae(4009,!1);return this.capture(e),new lv(ES(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=function AJ(n){const e=n.match(TJ);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const r=uI(this.remaining);r&&(i=r,this.capture(i))}e[ES(t)]=ES(i)}parseQueryParam(e){const t=function IJ(n){const e=n.match(DJ);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const o=function PJ(n){const e=n.match(RJ);return e?e[0]:""}(this.remaining);o&&(i=o,this.capture(i))}const r=KB(t),s=KB(i);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=uI(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new ae(4010,!1);let s;i.indexOf(":")>-1?(s=i.slice(0,i.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=Wt);const o=this.parseChildren();t[s]=1===Object.keys(o).length?o[Wt]:new In([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new ae(4011,!1)}}function JB(n){return n.segments.length>0?new In([],{[Wt]:n}):n}function QB(n){const e={};for(const i of Object.keys(n.children)){const s=QB(n.children[i]);if(i===Wt&&0===s.segments.length&&s.hasChildren())for(const[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[i]=s)}return function OJ(n){if(1===n.numberOfChildren&&n.children[Wt]){const e=n.children[Wt];return new In(n.segments.concat(e.segments),e.children)}return n}(new In(n.segments,e))}function ih(n){return n instanceof nm}function eV(n){let e;const r=JB(function t(s){const o={};for(const l of s.children){const c=t(l);o[l.outlet]=c}const a=new In(s.url,o);return s===n&&(e=a),a}(n.root));return e??r}function tV(n,e,t,i){let r=n;for(;r.parent;)r=r.parent;if(0===e.length)return dI(r,r,r,t,i);const s=function FJ(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new iV(!0,0,n);let e=0,t=!1;const i=n.reduce((r,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return Object.entries(s.outlets).forEach(([l,c])=>{a[l]="string"==typeof c?c.split("/"):c}),[...r,{outlets:a}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===o?(s.split("/").forEach((a,l)=>{0==l&&"."===a||(0==l&&""===a?t=!0:".."===a?e++:""!=a&&r.push(a))}),r):[...r,s]},[]);return new iV(t,e,i)}(e);if(s.toRoot())return dI(r,r,new In([],{}),t,i);const o=function kJ(n,e,t){if(n.isAbsolute)return new MS(e,!0,0);if(!t)return new MS(e,!1,NaN);if(null===t.parent)return new MS(t,!0,0);const i=CS(n.commands[0])?0:1;return function UJ(n,e,t){let i=n,r=e,s=t;for(;s>r;){if(s-=r,i=i.parent,!i)throw new ae(4005,!1);r=i.segments.length}return new MS(i,!1,r-s)}(t,t.segments.length-1+i,n.numberOfDoubleDots)}(s,r,n),a=o.processChildren?hv(o.segmentGroup,o.index,s.commands):rV(o.segmentGroup,o.index,s.commands);return dI(r,o.segmentGroup,a,t,i)}function CS(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function dv(n){return"object"==typeof n&&null!=n&&n.outlets}function dI(n,e,t,i,r){let o,s={};i&&Object.entries(i).forEach(([l,c])=>{s[l]=Array.isArray(c)?c.map(d=>`${d}`):`${c}`}),o=n===e?t:nV(n,e,t);const a=JB(QB(o));return new nm(a,s,r)}function nV(n,e,t){const i={};return Object.entries(n.children).forEach(([r,s])=>{i[r]=s===e?t:nV(s,e,t)}),new In(n.segments,i)}class iV{constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&CS(i[0]))throw new ae(4003,!1);const r=i.find(dv);if(r&&r!==GB(i))throw new ae(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class MS{constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}}function rV(n,e,t){if(n||(n=new In([],{})),0===n.segments.length&&n.hasChildren())return hv(n,e,t);const i=function VJ(n,e,t){let i=0,r=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return s;const o=n.segments[r],a=t[i];if(dv(a))break;const l=`${a}`,c=i<t.length-1?t[i+1]:null;if(r>0&&void 0===l)break;if(l&&c&&"object"==typeof c&&void 0===c.outlets){if(!oV(l,c,o))return s;i+=2}else{if(!oV(l,{},o))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){const s=new In(n.segments.slice(0,i.pathIndex),{});return s.children[Wt]=new In(n.segments.slice(i.pathIndex),n.children),hv(s,0,r)}return i.match&&0===r.length?new In(n.segments,{}):i.match&&!n.hasChildren()?hI(n,e,t):i.match?hv(n,0,r):hI(n,e,t)}function hv(n,e,t){if(0===t.length)return new In(n.segments,{});{const i=function BJ(n){return dv(n[0])?n[0].outlets:{[Wt]:n}}(t),r={};if(Object.keys(i).some(s=>s!==Wt)&&n.children[Wt]&&1===n.numberOfChildren&&0===n.children[Wt].segments.length){const s=hv(n.children[Wt],e,t);return new In(n.segments,s.children)}return Object.entries(i).forEach(([s,o])=>{"string"==typeof o&&(o=[o]),null!==o&&(r[s]=rV(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{void 0===i[s]&&(r[s]=o)}),new In(n.segments,r)}}function hI(n,e,t){const i=n.segments.slice(0,e);let r=0;for(;r<t.length;){const s=t[r];if(dv(s)){const l=HJ(s.outlets);return new In(i,l)}if(0===r&&CS(t[0])){i.push(new lv(n.segments[e].path,sV(t[0]))),r++;continue}const o=dv(s)?s.outlets[Wt]:`${s}`,a=r<t.length-1?t[r+1]:null;o&&a&&CS(a)?(i.push(new lv(o,sV(a))),r+=2):(i.push(new lv(o,{})),r++)}return new In(i,{})}function HJ(n){const e={};return Object.entries(n).forEach(([t,i])=>{"string"==typeof i&&(i=[i]),null!==i&&(e[t]=hI(new In([],{}),0,i))}),e}function sV(n){const e={};return Object.entries(n).forEach(([t,i])=>e[t]=`${i}`),e}function oV(n,e,t){return n==t.path&&nl(e,t.parameters)}const fv="imperative";class il{constructor(e,t){this.id=e,this.url=t}}class TS extends il{constructor(e,t,i="imperative",r=null){super(e,t),this.type=0,this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Su extends il{constructor(e,t,i){super(e,t),this.urlAfterRedirects=i,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class pv extends il{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class im extends il{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=16}}class AS extends il{constructor(e,t,i,r){super(e,t),this.error=i,this.target=r,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class aV extends il{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class zJ extends il{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class GJ extends il{constructor(e,t,i,r,s){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class WJ extends il{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class jJ extends il{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class $J{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class qJ{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class XJ{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class YJ{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class KJ{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ZJ{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class lV{constructor(e,t,i){this.routerEvent=e,this.position=t,this.anchor=i,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class fI{}class pI{constructor(e){this.url=e}}class JJ{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new mv,this.attachRef=null}}let mv=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(t,i){const r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){const i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new JJ,this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Qe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class cV{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=mI(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){const t=mI(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=gI(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return gI(e,this._root).map(t=>t.value)}}function mI(n,e){if(n===e.value)return e;for(const t of e.children){const i=mI(n,t);if(i)return i}return null}function gI(n,e){if(n===e.value)return[e];for(const t of e.children){const i=gI(n,t);if(i.length)return i.unshift(e),i}return[]}class Zl{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function rm(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class uV extends cV{constructor(e,t){super(e),this.snapshot=t,_I(this,e)}toString(){return this.snapshot.toString()}}function dV(n,e){const t=function QJ(n,e){const o=new DS([],{},{},"",{},Wt,e,null,{});return new fV("",new Zl(o,[]))}(0,e),i=new Vr([new lv("",{})]),r=new Vr({}),s=new Vr({}),o=new Vr({}),a=new Vr(""),l=new Jl(i,r,o,a,s,Wt,e,t.root);return l.snapshot=t.root,new uV(new Zl(l,[]),t)}class Jl{constructor(e,t,i,r,s,o,a,l){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(tn(c=>c[av]))??wt(void 0),this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(tn(e=>tm(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(tn(e=>tm(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function hV(n,e="emptyOnly"){const t=n.pathFromRoot;let i=0;if("always"!==e)for(i=t.length-1;i>=1;){const r=t[i],s=t[i-1];if(r.routeConfig&&""===r.routeConfig.path)i--;else{if(s.component)break;i--}}return function eQ(n){return n.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(i))}class DS{get title(){return this.data?.[av]}constructor(e,t,i,r,s,o,a,l,c){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.routeConfig=l,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=tm(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=tm(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class fV extends cV{constructor(e,t){super(t),this.url=e,_I(this,t)}toString(){return pV(this._root)}}function _I(n,e){e.value._routerState=n,e.children.forEach(t=>_I(n,t))}function pV(n){const e=n.children.length>0?` { ${n.children.map(pV).join(", ")} } `:"";return`${n.value}${e}`}function yI(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,nl(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),nl(e.params,t.params)||n.paramsSubject.next(t.params),function gJ(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!nl(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.urlSubject.next(t.url),nl(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function vI(n,e){const t=nl(n.params,e.params)&&function wJ(n,e){return nh(n,e)&&n.every((t,i)=>nl(t.parameters,e[i].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||vI(n.parent,e.parent))}let wI=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=Wt,this.activateEvents=new Yn,this.deactivateEvents=new Yn,this.attachEvents=new Yn,this.detachEvents=new Yn,this.parentContexts=ze(mv),this.location=ze(ha),this.changeDetector=ze(Gy),this.environmentInjector=ze(ms),this.inputBinder=ze(IS,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){const{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ae(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ae(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ae(4012,!1);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new ae(4013,!1);this._activatedRoute=t;const r=this.location,o=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,l=new tQ(t,a,r.injector);this.activated=r.createComponent(o,{index:r.length,injector:l,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275dir=yt({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[$i]})}return n})();class tQ{constructor(e,t,i){this.route=e,this.childContexts=t,this.parent=i}get(e,t){return e===Jl?this.route:e===mv?this.childContexts:this.parent.get(e,t)}}const IS=new Ye("");let mV=(()=>{class n{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){const{activatedRoute:i}=t,r=rI([i.queryParams,i.params,i.data]).pipe(As(([s,o,a],l)=>(a={...s,...o,...a},0===l?wt(a):Promise.resolve(a)))).subscribe(s=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==i||null===i.component)return void this.unsubscribeFromRouteData(t);const o=function L7(n){const e=Zt(n);if(!e)return null;const t=new Sy(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}(i.component);if(o)for(const{templateName:a}of o.inputs)t.activatedComponentRef.setInput(a,s[a]);else this.unsubscribeFromRouteData(t)});this.outletDataSubscriptions.set(t,r)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Qe({token:n,factory:n.\u0275fac})}return n})();function gv(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const i=t.value;i._futureSnapshot=e.value;const r=function iQ(n,e,t){return e.children.map(i=>{for(const r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return gv(n,i,r);return gv(n,i)})}(n,e,t);return new Zl(i,r)}{if(n.shouldAttach(e.value)){const s=n.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>gv(n,a)),o}}const i=function rQ(n){return new Jl(new Vr(n.url),new Vr(n.params),new Vr(n.queryParams),new Vr(n.fragment),new Vr(n.data),n.outlet,n.component,n)}(e.value),r=e.children.map(s=>gv(n,s));return new Zl(i,r)}}const bI="ngNavigationCancelingError";function gV(n,e){const{redirectTo:t,navigationBehaviorOptions:i}=ih(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=_V(!1,0,e);return r.url=t,r.navigationBehaviorOptions=i,r}function _V(n,e,t){const i=new Error("NavigationCancelingError: "+(n||""));return i[bI]=!0,i.cancellationCode=e,t&&(i.url=t),i}function yV(n){return n&&n[bI]}let vV=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=ir({type:n,selectors:[["ng-component"]],standalone:!0,features:[ky],decls:1,vars:0,template:function(i,r){1&i&&Nr(0,"router-outlet")},dependencies:[wI],encapsulation:2})}return n})();function xI(n){const e=n.children&&n.children.map(xI),t=e?{...n,children:e}:{...n};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Wt&&(t.component=vV),t}function _a(n){return n.outlet||Wt}function _v(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class hQ{constructor(e,t,i,r,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=s}activate(e){const t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),yI(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){const r=rm(t);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,r[o],i),delete r[o]}),Object.values(r).forEach(s=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(r===s)if(r.component){const o=i.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,i);else s&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=rm(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);if(i&&i.outlet){const o=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=rm(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(e,t,i){const r=rm(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new ZJ(s.value.snapshot))}),e.children.length&&this.forwardEvent(new YJ(e.value.snapshot))}activateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(yI(r),r===s)if(r.component){const o=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,i);else if(r.component){const o=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),yI(a.route.value),this.activateChildRoutes(e,null,o.children)}else{const a=_v(r.snapshot);o.attachRef=null,o.route=r,o.injector=a,o.outlet&&o.outlet.activateWith(r,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,i)}}class wV{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class RS{constructor(e,t){this.component=e,this.route=t}}function fQ(n,e,t){const i=n._root;return yv(i,e?e._root:null,t,[i.value])}function sm(n,e){const t=Symbol(),i=e.get(n,t);return i===t?"function"!=typeof n||function nw(n){return null!==Aa(n)}(n)?e.get(n):n:i}function yv(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=rm(e);return n.children.forEach(o=>{(function mQ(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const l=function gQ(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!nh(n.url,e.url);case"pathParamsOrQueryParamsChange":return!nh(n.url,e.url)||!nl(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!vI(n,e)||!nl(n.queryParams,e.queryParams);default:return!vI(n,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new wV(i)):(s.data=o.data,s._resolvedData=o._resolvedData),yv(n,e,s.component?a?a.children:null:t,i,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new RS(a.outlet.component,o))}else o&&vv(e,a,r),r.canActivateChecks.push(new wV(i)),yv(n,null,s.component?a?a.children:null:t,i,r)})(o,s[o.value.outlet],t,i.concat([o.value]),r),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>vv(a,t.getContext(o),r)),r}function vv(n,e,t){const i=rm(n),r=n.value;Object.entries(i).forEach(([s,o])=>{vv(o,r.component?e?e.children.getContext(s):null:e,t)}),t.canDeactivateChecks.push(new RS(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}function wv(n){return"function"==typeof n}function bV(n){return n instanceof vS||"EmptyError"===n?.name}const PS=Symbol("INITIAL_VALUE");function om(){return As(n=>rI(n.map(e=>e.pipe(Qp(1),function lJ(...n){const e=Ju(n);return Wn((t,i)=>{(e?sI(n,t,e):sI(n,t)).subscribe(i)})}(PS)))).pipe(tn(e=>{for(const t of e)if(!0!==t){if(t===PS)return PS;if(!1===t||t instanceof nm)return t}return!0}),Kl(e=>e!==PS),Qp(1)))}function xV(n){return function YC(...n){return O0(n)}(Yr(e=>{if(ih(e))throw gV(0,e)}),tn(e=>!0===e))}class NS{constructor(e){this.segmentGroup=e||null}}class SV{constructor(e){this.urlTree=e}}function am(n){return sv(new NS(n))}function EV(n){return sv(new SV(n))}class FQ{constructor(e,t){this.urlSerializer=e,this.urlTree=t}noMatchError(e){return new ae(4002,!1)}lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return wt(i);if(r.numberOfChildren>1||!r.children[Wt])return sv(new ae(4e3,!1));r=r.children[Wt]}}applyRedirectCommands(e,t,i){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,i)}applyRedirectCreateUrlTree(e,t,i,r){const s=this.createSegmentGroup(e,t.root,i,r);return new nm(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const i={};return Object.entries(e).forEach(([r,s])=>{if("string"==typeof s&&s.startsWith(":")){const a=s.substring(1);i[r]=t[a]}else i[r]=s}),i}createSegmentGroup(e,t,i,r){const s=this.createSegments(e,t.segments,i,r);let o={};return Object.entries(t.children).forEach(([a,l])=>{o[a]=this.createSegmentGroup(e,l,i,r)}),new In(s,o)}createSegments(e,t,i,r){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,r):this.findOrReturn(s,i))}findPosParam(e,t,i){const r=i[t.path.substring(1)];if(!r)throw new ae(4001,!1);return r}findOrReturn(e,t){let i=0;for(const r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}}const SI={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function kQ(n,e,t,i,r){const s=EI(n,e,t);return s.matched?(i=function oQ(n,e){return n.providers&&!n._injector&&(n._injector=aA(n.providers,e,`Route: ${n.path}`)),n._injector??e}(e,i),function NQ(n,e,t,i){const r=e.canMatch;return r&&0!==r.length?wt(r.map(o=>{const a=sm(o,n);return xu(function xQ(n){return n&&wv(n.canMatch)}(a)?a.canMatch(e,t):n.runInContext(()=>a(e,t)))})).pipe(om(),xV()):wt(!0)}(i,e,t).pipe(tn(o=>!0===o?s:{...SI}))):wt(s)}function EI(n,e,t){if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?{...SI}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const r=(e.matcher||mJ)(t,n,e);if(!r)return{...SI};const s={};Object.entries(r.posParams??{}).forEach(([a,l])=>{s[a]=l.path});const o=r.consumed.length>0?{...s,...r.consumed[r.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:o,positionalParamSegments:r.posParams??{}}}function CV(n,e,t,i){return t.length>0&&function VQ(n,e,t){return t.some(i=>OS(n,e,i)&&_a(i)!==Wt)}(n,t,i)?{segmentGroup:new In(e,BQ(i,new In(t,n.children))),slicedSegments:[]}:0===t.length&&function HQ(n,e,t){return t.some(i=>OS(n,e,i))}(n,t,i)?{segmentGroup:new In(n.segments,UQ(n,0,t,i,n.children)),slicedSegments:t}:{segmentGroup:new In(n.segments,n.children),slicedSegments:t}}function UQ(n,e,t,i,r){const s={};for(const o of i)if(OS(n,t,o)&&!r[_a(o)]){const a=new In([],{});s[_a(o)]=a}return{...r,...s}}function BQ(n,e){const t={};t[Wt]=e;for(const i of n)if(""===i.path&&_a(i)!==Wt){const r=new In([],{});t[_a(i)]=r}return t}function OS(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}class jQ{constructor(e,t,i,r,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=i,this.config=r,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.allowRedirects=!0,this.applyRedirects=new FQ(this.urlSerializer,this.urlTree)}noMatchError(e){return new ae(4002,!1)}recognize(){const e=CV(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,Wt).pipe(th(t=>{if(t instanceof SV)return this.allowRedirects=!1,this.urlTree=t.urlTree,this.match(t.urlTree);throw t instanceof NS?this.noMatchError(t):t}),tn(t=>{const i=new DS([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Wt,this.rootComponentType,null,{}),r=new Zl(i,t),s=new fV("",r),o=function LJ(n,e,t=null,i=null){return tV(eV(n),e,t,i)}(i,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e.root,Wt).pipe(th(i=>{throw i instanceof NS?this.noMatchError(i):i}))}inheritParamsAndData(e){const t=e.value,i=hV(t,this.paramsInheritanceStrategy);t.params=Object.freeze(i.params),t.data=Object.freeze(i.data),e.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(e,t,i,r){return 0===i.segments.length&&i.hasChildren()?this.processChildren(e,t,i):this.processSegment(e,t,i,i.segments,r,!0)}processChildren(e,t,i){const r=[];for(const s of Object.keys(i.children))"primary"===s?r.unshift(s):r.push(s);return vi(r).pipe(em(s=>{const o=i.children[s],a=function uQ(n,e){const t=n.filter(i=>_a(i)===e);return t.push(...n.filter(i=>_a(i)!==e)),t}(t,s);return this.processSegmentGroup(e,a,o,s)}),function dJ(n,e){return Wn(function uJ(n,e,t,i,r){return(s,o)=>{let a=t,l=e,c=0;s.subscribe(ei(o,d=>{const h=c++;l=a?n(l,d,h):(a=!0,d),i&&o.next(l)},r&&(()=>{a&&o.next(l),o.complete()})))}}(n,e,arguments.length>=2,!0))}((s,o)=>(s.push(...o),s)),wS(null),function hJ(n,e){const t=arguments.length>=2;return i=>i.pipe(n?Kl((r,s)=>n(r,s,i)):$o,aI(1),t?wS(e):VB(()=>new vS))}(),nr(s=>{if(null===s)return am(i);const o=MV(s);return function $Q(n){n.sort((e,t)=>e.value.outlet===Wt?-1:t.value.outlet===Wt?1:e.value.outlet.localeCompare(t.value.outlet))}(o),wt(o)}))}processSegment(e,t,i,r,s,o){return vi(t).pipe(em(a=>this.processSegmentAgainstRoute(a._injector??e,t,a,i,r,s,o).pipe(th(l=>{if(l instanceof NS)return wt(null);throw l}))),eh(a=>!!a),th(a=>{if(bV(a))return function GQ(n,e,t){return 0===e.length&&!n.children[t]}(i,r,s)?wt([]):am(i);throw a}))}processSegmentAgainstRoute(e,t,i,r,s,o,a){return function zQ(n,e,t,i){return!!(_a(n)===i||i!==Wt&&OS(e,t,n))&&("**"===n.path||EI(e,n,t).matched)}(i,r,s,o)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(e,r,i,s,o,a):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,r,t,i,s,o):am(r):am(r)}expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,i,r,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,i,r){const s=this.applyRedirects.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?EV(s):this.applyRedirects.lineralizeSegments(i,s).pipe(nr(o=>{const a=new In(o,{});return this.processSegment(e,t,a,o,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o){const{matched:a,consumedSegments:l,remainingSegments:c,positionalParamSegments:d}=EI(t,r,s);if(!a)return am(t);const h=this.applyRedirects.applyRedirectCommands(l,r.redirectTo,d);return r.redirectTo.startsWith("/")?EV(h):this.applyRedirects.lineralizeSegments(r,h).pipe(nr(p=>this.processSegment(e,i,t,p.concat(c),o,!1)))}matchSegmentAgainstRoute(e,t,i,r,s,o){let a;if("**"===i.path){const l=r.length>0?GB(r).parameters:{};a=wt({snapshot:new DS(r,l,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,TV(i),_a(i),i.component??i._loadedComponent??null,i,AV(i)),consumedSegments:[],remainingSegments:[]}),t.children={}}else a=kQ(t,i,r,e).pipe(tn(({matched:l,consumedSegments:c,remainingSegments:d,parameters:h})=>l?{snapshot:new DS(c,h,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,TV(i),_a(i),i.component??i._loadedComponent??null,i,AV(i)),consumedSegments:c,remainingSegments:d}:null));return a.pipe(As(l=>null===l?am(t):this.getChildConfig(e=i._injector??e,i,r).pipe(As(({routes:c})=>{const d=i._loadedInjector??e,{snapshot:h,consumedSegments:p,remainingSegments:m}=l,{segmentGroup:g,slicedSegments:v}=CV(t,p,m,c);if(0===v.length&&g.hasChildren())return this.processChildren(d,c,g).pipe(tn(y=>null===y?null:[new Zl(h,y)]));if(0===c.length&&0===v.length)return wt([new Zl(h,[])]);const w=_a(i)===s;return this.processSegment(d,c,g,v,w?Wt:s,!0).pipe(tn(y=>[new Zl(h,y)]))}))))}getChildConfig(e,t,i){return t.children?wt({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?wt({routes:t._loadedRoutes,injector:t._loadedInjector}):function PQ(n,e,t,i){const r=e.canLoad;return void 0===r||0===r.length?wt(!0):wt(r.map(o=>{const a=sm(o,n);return xu(function yQ(n){return n&&wv(n.canLoad)}(a)?a.canLoad(e,t):n.runInContext(()=>a(e,t)))})).pipe(om(),xV())}(e,t,i).pipe(nr(r=>r?this.configLoader.loadChildren(e,t).pipe(Yr(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):function LQ(n){return sv(_V(!1,3))}())):wt({routes:[],injector:e})}}function qQ(n){const e=n.value.routeConfig;return e&&""===e.path}function MV(n){const e=[],t=new Set;for(const i of n){if(!qQ(i)){e.push(i);continue}const r=e.find(s=>i.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...i.children),t.add(r)):e.push(i)}for(const i of t){const r=MV(i.children);e.push(new Zl(i.value,r))}return e.filter(i=>!t.has(i))}function TV(n){return n.data||{}}function AV(n){return n.resolve||{}}function DV(n){return"string"==typeof n.title||null===n.title}function CI(n){return As(e=>{const t=n(e);return t?vi(t).pipe(tn(()=>e)):wt(e)})}const lm=new Ye("ROUTES");let MI=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=ze(Sk)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return wt(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const i=xu(t.loadComponent()).pipe(tn(IV),Yr(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),ov(()=>{this.componentLoaders.delete(t)})),r=new BB(i,()=>new ss).pipe(oI());return this.componentLoaders.set(t,r),r}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return wt({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const s=function eee(n,e,t,i){return xu(n.loadChildren()).pipe(tn(IV),nr(r=>r instanceof DF||Array.isArray(r)?wt(r):vi(e.compileModuleAsync(r))),tn(r=>{i&&i(n);let s,o,a=!1;return Array.isArray(r)?(o=r,!0):(s=r.create(t).injector,o=s.get(lm,[],{optional:!0,self:!0}).flat()),{routes:o.map(xI),injector:s}}))}(i,this.compiler,t,this.onLoadEndListener).pipe(ov(()=>{this.childrenLoaders.delete(i)})),o=new BB(s,()=>new ss).pipe(oI());return this.childrenLoaders.set(i,o),o}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Qe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function IV(n){return function tee(n){return n&&"object"==typeof n&&"default"in n}(n)?n.default:n}let LS=(()=>{class n{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new ss,this.transitionAbortSubject=new ss,this.configLoader=ze(MI),this.environmentInjector=ze(ms),this.urlSerializer=ze(cv),this.rootContexts=ze(mv),this.inputBindingEnabled=null!==ze(IS,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>wt(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=r=>this.events.next(new qJ(r)),this.configLoader.onLoadStartListener=r=>this.events.next(new $J(r))}complete(){this.transitions?.complete()}handleNavigationRequest(t){const i=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:i})}setupNavigations(t,i,r){return this.transitions=new Vr({id:0,currentUrlTree:i,currentRawUrl:i,currentBrowserUrl:i,extractedUrl:t.urlHandlingStrategy.extract(i),urlAfterRedirects:t.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:fv,restoredState:null,currentSnapshot:r.snapshot,targetSnapshot:null,currentRouterState:r,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Kl(s=>0!==s.id),tn(s=>({...s,extractedUrl:t.urlHandlingStrategy.extract(s.rawUrl)})),As(s=>{this.currentTransition=s;let o=!1,a=!1;return wt(s).pipe(Yr(l=>{this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),As(l=>{const c=l.currentBrowserUrl.toString(),d=!t.navigated||l.extractedUrl.toString()!==c||c!==l.currentUrlTree.toString();if(!d&&"reload"!==(l.extras.onSameUrlNavigation??t.onSameUrlNavigation)){const p="";return this.events.next(new im(l.id,this.urlSerializer.serialize(l.rawUrl),p,0)),l.resolve(null),xo}if(t.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return wt(l).pipe(As(p=>{const m=this.transitions?.getValue();return this.events.next(new TS(p.id,this.urlSerializer.serialize(p.extractedUrl),p.source,p.restoredState)),m!==this.transitions?.getValue()?xo:Promise.resolve(p)}),function XQ(n,e,t,i,r,s){return nr(o=>function WQ(n,e,t,i,r,s,o="emptyOnly"){return new jQ(n,e,t,i,r,o,s).recognize()}(n,e,t,i,o.extractedUrl,r,s).pipe(tn(({state:a,tree:l})=>({...o,targetSnapshot:a,urlAfterRedirects:l}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,t.paramsInheritanceStrategy),Yr(p=>{s.targetSnapshot=p.targetSnapshot,s.urlAfterRedirects=p.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:p.urlAfterRedirects};const m=new aV(p.id,this.urlSerializer.serialize(p.extractedUrl),this.urlSerializer.serialize(p.urlAfterRedirects),p.targetSnapshot);this.events.next(m)}));if(d&&t.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){const{id:p,extractedUrl:m,source:g,restoredState:v,extras:w}=l,y=new TS(p,this.urlSerializer.serialize(m),g,v);this.events.next(y);const b=dV(0,this.rootComponentType).snapshot;return this.currentTransition=s={...l,targetSnapshot:b,urlAfterRedirects:m,extras:{...w,skipLocationChange:!1,replaceUrl:!1}},wt(s)}{const p="";return this.events.next(new im(l.id,this.urlSerializer.serialize(l.extractedUrl),p,1)),l.resolve(null),xo}}),Yr(l=>{const c=new zJ(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(c)}),tn(l=>(this.currentTransition=s={...l,guards:fQ(l.targetSnapshot,l.currentSnapshot,this.rootContexts)},s)),function EQ(n,e){return nr(t=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return 0===o.length&&0===s.length?wt({...t,guardsResult:!0}):function CQ(n,e,t,i){return vi(n).pipe(nr(r=>function RQ(n,e,t,i,r){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?wt(s.map(a=>{const l=_v(e)??r,c=sm(a,l);return xu(function bQ(n){return n&&wv(n.canDeactivate)}(c)?c.canDeactivate(n,e,t,i):l.runInContext(()=>c(n,e,t,i))).pipe(eh())})).pipe(om()):wt(!0)}(r.component,r.route,t,e,i)),eh(r=>!0!==r,!0))}(o,i,r,n).pipe(nr(a=>a&&function _Q(n){return"boolean"==typeof n}(a)?function MQ(n,e,t,i){return vi(e).pipe(em(r=>sI(function AQ(n,e){return null!==n&&e&&e(new XJ(n)),wt(!0)}(r.route.parent,i),function TQ(n,e){return null!==n&&e&&e(new KJ(n)),wt(!0)}(r.route,i),function IQ(n,e,t){const i=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function pQ(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(o)).filter(o=>null!==o).map(o=>UB(()=>wt(o.guards.map(l=>{const c=_v(o.node)??t,d=sm(l,c);return xu(function wQ(n){return n&&wv(n.canActivateChild)}(d)?d.canActivateChild(i,n):c.runInContext(()=>d(i,n))).pipe(eh())})).pipe(om())));return wt(s).pipe(om())}(n,r.path,t),function DQ(n,e,t){const i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||0===i.length)return wt(!0);const r=i.map(s=>UB(()=>{const o=_v(e)??t,a=sm(s,o);return xu(function vQ(n){return n&&wv(n.canActivate)}(a)?a.canActivate(e,n):o.runInContext(()=>a(e,n))).pipe(eh())}));return wt(r).pipe(om())}(n,r.route,t))),eh(r=>!0!==r,!0))}(i,s,n,e):wt(a)),tn(a=>({...t,guardsResult:a})))})}(this.environmentInjector,l=>this.events.next(l)),Yr(l=>{if(s.guardsResult=l.guardsResult,ih(l.guardsResult))throw gV(0,l.guardsResult);const c=new GJ(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(c)}),Kl(l=>!!l.guardsResult||(this.cancelNavigationTransition(l,"",3),!1)),CI(l=>{if(l.guards.canActivateChecks.length)return wt(l).pipe(Yr(c=>{const d=new WJ(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(d)}),As(c=>{let d=!1;return wt(c).pipe(function YQ(n,e){return nr(t=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return wt(t);let s=0;return vi(r).pipe(em(o=>function KQ(n,e,t,i){const r=n.routeConfig,s=n._resolve;return void 0!==r?.title&&!DV(r)&&(s[av]=r.title),function ZQ(n,e,t,i){const r=function JQ(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===r.length)return wt({});const s={};return vi(r).pipe(nr(o=>function QQ(n,e,t,i){const r=_v(e)??i,s=sm(n,r);return xu(s.resolve?s.resolve(e,t):r.runInContext(()=>s(e,t)))}(n[o],e,t,i).pipe(eh(),Yr(a=>{s[o]=a}))),aI(1),function fJ(n){return tn(()=>n)}(s),th(o=>bV(o)?xo:sv(o)))}(s,n,e,i).pipe(tn(o=>(n._resolvedData=o,n.data=hV(n,t).resolve,r&&DV(r)&&(n.data[av]=r.title),null)))}(o.route,i,n,e)),Yr(()=>s++),aI(1),nr(o=>s===r.length?wt(t):xo))})}(t.paramsInheritanceStrategy,this.environmentInjector),Yr({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(c,"",2)}}))}),Yr(c=>{const d=new jJ(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(d)}))}),CI(l=>{const c=d=>{const h=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&h.push(this.configLoader.loadComponent(d.routeConfig).pipe(Yr(p=>{d.component=p}),tn(()=>{})));for(const p of d.children)h.push(...c(p));return h};return rI(c(l.targetSnapshot.root)).pipe(wS(),Qp(1))}),CI(()=>this.afterPreactivation()),tn(l=>{const c=function nQ(n,e,t){const i=gv(n,e._root,t?t._root:void 0);return new uV(i,e)}(t.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=s={...l,targetRouterState:c},s}),Yr(()=>{this.events.next(new fI)}),((n,e,t,i)=>tn(r=>(new hQ(e,r.targetRouterState,r.currentRouterState,t,i).activate(n),r)))(this.rootContexts,t.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),Qp(1),Yr({next:l=>{o=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Su(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),t.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{o=!0}}),HB(this.transitionAbortSubject.pipe(Yr(l=>{throw l}))),ov(()=>{o||a||this.cancelNavigationTransition(s,"",1),this.currentNavigation?.id===s.id&&(this.currentNavigation=null)}),th(l=>{if(a=!0,yV(l))this.events.next(new pv(s.id,this.urlSerializer.serialize(s.extractedUrl),l.message,l.cancellationCode)),function sQ(n){return yV(n)&&ih(n.url)}(l)?this.events.next(new pI(l.url)):s.resolve(!1);else{this.events.next(new AS(s.id,this.urlSerializer.serialize(s.extractedUrl),l,s.targetSnapshot??void 0));try{s.resolve(t.errorHandler(l))}catch(c){s.reject(c)}}return xo}))}))}cancelNavigationTransition(t,i,r){const s=new pv(t.id,this.urlSerializer.serialize(t.extractedUrl),i,r);this.events.next(s),t.resolve(!1)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Qe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function RV(n){return n!==fv}let PV=(()=>{class n{buildTitle(t){let i,r=t.root;for(;void 0!==r;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(s=>s.outlet===Wt);return i}getResolvedTitleForRoute(t){return t.data[av]}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Qe({token:n,factory:function(){return ze(nee)},providedIn:"root"})}return n})(),nee=(()=>{class n extends PV{constructor(t){super(),this.title=t}updateTitle(t){const i=this.buildTitle(t);void 0!==i&&this.title.setTitle(i)}static#e=this.\u0275fac=function(i){return new(i||n)(Le(hD))};static#t=this.\u0275prov=Qe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),iee=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Qe({token:n,factory:function(){return ze(see)},providedIn:"root"})}return n})();class ree{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let see=(()=>{class n extends ree{static#e=this.\u0275fac=function(){let t;return function(r){return(t||(t=bi(n)))(r||n)}}();static#t=this.\u0275prov=Qe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const FS=new Ye("",{providedIn:"root",factory:()=>({})});let oee=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Qe({token:n,factory:function(){return ze(aee)},providedIn:"root"})}return n})(),aee=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Qe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var bv=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(bv||{});function NV(n,e){n.events.pipe(Kl(t=>t instanceof Su||t instanceof pv||t instanceof AS||t instanceof im),tn(t=>t instanceof Su||t instanceof im?bv.COMPLETE:t instanceof pv&&(0===t.code||1===t.code)?bv.REDIRECTING:bv.FAILED),Kl(t=>t!==bv.REDIRECTING),Qp(1)).subscribe(()=>{e()})}function lee(n){throw n}function cee(n,e,t){return e.parse("/")}const uee={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},dee={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Or=(()=>{class n{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.location.getState()?.\u0275routerPageId??this.currentPageId}get events(){return this._events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=ze(xk),this.isNgZoneEnabled=!1,this._events=new ss,this.options=ze(FS,{optional:!0})||{},this.pendingTasks=ze(Cx),this.errorHandler=this.options.errorHandler||lee,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||cee,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=ze(oee),this.routeReuseStrategy=ze(iee),this.titleStrategy=ze(PV),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=ze(lm,{optional:!0})?.flat()??[],this.navigationTransitions=ze(LS),this.urlSerializer=ze(cv),this.location=ze(VA),this.componentInputBindingEnabled=!!ze(IS,{optional:!0}),this.eventsSubscription=new ns,this.isNgZoneEnabled=ze(Dn)instanceof Dn&&Dn.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new nm,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=dV(0,null),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe(t=>{this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const t=this.navigationTransitions.events.subscribe(i=>{try{const{currentTransition:r}=this.navigationTransitions;if(null===r)return void(OV(i)&&this._events.next(i));if(i instanceof TS)RV(r.source)&&(this.browserUrlTree=r.extractedUrl);else if(i instanceof im)this.rawUrlTree=r.rawUrl;else if(i instanceof aV){if("eager"===this.urlUpdateStrategy){if(!r.extras.skipLocationChange){const s=this.urlHandlingStrategy.merge(r.urlAfterRedirects,r.rawUrl);this.setBrowserUrl(s,r)}this.browserUrlTree=r.urlAfterRedirects}}else if(i instanceof fI)this.currentUrlTree=r.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(r.urlAfterRedirects,r.rawUrl),this.routerState=r.targetRouterState,"deferred"===this.urlUpdateStrategy&&(r.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,r),this.browserUrlTree=r.urlAfterRedirects);else if(i instanceof pv)0!==i.code&&1!==i.code&&(this.navigated=!0),(3===i.code||2===i.code)&&this.restoreHistory(r);else if(i instanceof pI){const s=this.urlHandlingStrategy.merge(i.url,r.currentRawUrl),o={skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||RV(r.source)};this.scheduleNavigation(s,fv,null,o,{resolve:r.resolve,reject:r.reject,promise:r.promise})}i instanceof AS&&this.restoreHistory(r,!0),i instanceof Su&&(this.navigated=!0),OV(i)&&this._events.next(i)}catch(r){this.navigationTransitions.transitionAbortSubject.next(r)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const t=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),fv,t)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const i="popstate"===t.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{this.navigateToSyncWithBrowser(t.url,i,t.state)},0)}))}navigateToSyncWithBrowser(t,i,r){const s={replaceUrl:!0},o=r?.navigationId?r:null;if(r){const l={...r};delete l.navigationId,delete l.\u0275routerPageId,0!==Object.keys(l).length&&(s.state=l)}const a=this.parseUrl(t);this.scheduleNavigation(a,i,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(xI),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,i={}){const{relativeTo:r,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:l}=i,c=l?this.currentUrlTree.fragment:o;let h,d=null;switch(a){case"merge":d={...this.currentUrlTree.queryParams,...s};break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=s||null}null!==d&&(d=this.removeEmptyProps(d));try{h=eV(r?r.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof t[0]||!t[0].startsWith("/"))&&(t=[]),h=this.currentUrlTree.root}return tV(h,t,d,c??null)}navigateByUrl(t,i={skipLocationChange:!1}){const r=ih(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,fv,null,i)}navigate(t,i={skipLocationChange:!1}){return function hee(n){for(let e=0;e<n.length;e++)if(null==n[e])throw new ae(4008,!1)}(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let i;try{i=this.urlSerializer.parse(t)}catch(r){i=this.malformedUriErrorHandler(r,this.urlSerializer,t)}return i}isActive(t,i){let r;if(r=!0===i?{...uee}:!1===i?{...dee}:i,ih(t))return jB(this.currentUrlTree,t,r);const s=this.parseUrl(t);return jB(this.currentUrlTree,s,r)}removeEmptyProps(t){return Object.keys(t).reduce((i,r)=>{const s=t[r];return null!=s&&(i[r]=s),i},{})}scheduleNavigation(t,i,r,s,o){if(this.disposed)return Promise.resolve(!1);let a,l,c;o?(a=o.resolve,l=o.reject,c=o.promise):c=new Promise((h,p)=>{a=h,l=p});const d=this.pendingTasks.add();return NV(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,currentBrowserUrl:this.browserUrlTree,rawUrl:t,extras:s,resolve:a,reject:l,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(h=>Promise.reject(h))}setBrowserUrl(t,i){const r=this.urlSerializer.serialize(t);if(this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl){const o={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId)};this.location.replaceState(r,"",o)}else{const s={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId+1)};this.location.go(r,"",s)}}restoreHistory(t,i=!1){if("computed"===this.canceledNavigationResolution){const s=this.currentPageId-this.browserPageId;0!==s?this.location.historyGo(s):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===s&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Qe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function OV(n){return!(n instanceof fI||n instanceof pI)}class LV{}let mee=(()=>{class n{constructor(t,i,r,s,o){this.router=t,this.injector=r,this.preloadingStrategy=s,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(Kl(t=>t instanceof Su),em(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,i){const r=[];for(const s of i){s.providers&&!s._injector&&(s._injector=aA(s.providers,t,`Route: ${s.path}`));const o=s._injector??t,a=s._loadedInjector??o;(s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent)&&r.push(this.preloadConfig(o,s)),(s.children||s._loadedRoutes)&&r.push(this.processRoutes(a,s.children??s._loadedRoutes))}return vi(r).pipe(Ic())}preloadConfig(t,i){return this.preloadingStrategy.preload(i,()=>{let r;r=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(t,i):wt(null);const s=r.pipe(nr(o=>null===o?wt(void 0):(i._loadedRoutes=o.routes,i._loadedInjector=o.injector,this.processRoutes(o.injector??t,o.routes))));return i.loadComponent&&!i._loadedComponent?vi([s,this.loader.loadComponent(i)]).pipe(Ic()):s})}static#e=this.\u0275fac=function(i){return new(i||n)(Le(Or),Le(Sk),Le(ms),Le(LV),Le(MI))};static#t=this.\u0275prov=Qe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const AI=new Ye("");let FV=(()=>{class n{constructor(t,i,r,s,o={}){this.urlSerializer=t,this.transitions=i,this.viewportScroller=r,this.zone=s,this.options=o,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},o.scrollPositionRestoration=o.scrollPositionRestoration||"disabled",o.anchorScrolling=o.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof TS?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Su?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof im&&0===t.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof lV&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new lV(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static#e=this.\u0275fac=function(i){!function _L(){throw new Error("invalid")}()};static#t=this.\u0275prov=Qe({token:n,factory:n.\u0275fac})}return n})();function Ql(n,e){return{\u0275kind:n,\u0275providers:e}}function UV(){const n=ze(io);return e=>{const t=n.get($d);if(e!==t.components[0])return;const i=n.get(Or),r=n.get(BV);1===n.get(DI)&&i.initialNavigation(),n.get(VV,null,Xt.Optional)?.setUpPreloading(),n.get(AI,null,Xt.Optional)?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}const BV=new Ye("",{factory:()=>new ss}),DI=new Ye("",{providedIn:"root",factory:()=>1}),VV=new Ye("");function vee(n){return Ql(0,[{provide:VV,useExisting:mee},{provide:LV,useExisting:n}])}const HV=new Ye("ROUTER_FORROOT_GUARD"),bee=[VA,{provide:cv,useClass:lI},Or,mv,{provide:Jl,useFactory:function kV(n){return n.routerState.root},deps:[Or]},MI,[]];function xee(){return new Ik("Router",Or)}let zV=(()=>{class n{constructor(t){}static forRoot(t,i){return{ngModule:n,providers:[bee,[],{provide:lm,multi:!0,useValue:t},{provide:HV,useFactory:Mee,deps:[[Or,new Xf,new Yf]]},{provide:FS,useValue:i||{}},i?.useHash?{provide:Xd,useClass:V7}:{provide:Xd,useClass:oU},{provide:AI,useFactory:()=>{const n=ze(rX),e=ze(Dn),t=ze(FS),i=ze(LS),r=ze(cv);return t.scrollOffset&&n.setOffset(t.scrollOffset),new FV(r,i,n,e,t)}},i?.preloadingStrategy?vee(i.preloadingStrategy).\u0275providers:[],{provide:Ik,multi:!0,useFactory:xee},i?.initialNavigation?Tee(i):[],i?.bindToComponentInputs?Ql(8,[mV,{provide:IS,useExisting:mV}]).\u0275providers:[],[{provide:GV,useFactory:UV},{provide:IA,multi:!0,useExisting:GV}]]}}static forChild(t){return{ngModule:n,providers:[{provide:lm,multi:!0,useValue:t}]}}static#e=this.\u0275fac=function(i){return new(i||n)(Le(HV,8))};static#t=this.\u0275mod=Oi({type:n});static#n=this.\u0275inj=wi({})}return n})();function Mee(n){return"guarded"}function Tee(n){return["disabled"===n.initialNavigation?Ql(3,[{provide:xA,multi:!0,useFactory:()=>{const e=ze(Or);return()=>{e.setUpLocationChangeListener()}}},{provide:DI,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?Ql(2,[{provide:DI,useValue:0},{provide:xA,multi:!0,deps:[io],useFactory:e=>{const t=e.get(U7,Promise.resolve());return()=>t.then(()=>new Promise(i=>{const r=e.get(Or),s=e.get(BV);NV(r,()=>{i(!0)}),e.get(LS).afterPreactivation=()=>(i(!0),s.closed?wt(void 0):s),r.initialNavigation()}))}}]).\u0275providers:[]]}const GV=new Ye("");function WV(n,e,t,i,r,s,o){try{var a=n[s](o),l=a.value}catch(c){return void t(c)}a.done?e(l):Promise.resolve(l).then(i,r)}function On(n){return function(){var e=this,t=arguments;return new Promise(function(i,r){var s=n.apply(e,t);function o(l){WV(s,i,r,o,a,"next",l)}function a(l){WV(s,i,r,o,a,"throw",l)}o(void 0)})}}const $V=1,Ree=2,ec=3,kS=0,Zee=1,Jee=2,Cu=0,Qee=1,ete=2,tte=3,nte=4,ite=5,Mu=301,rh=302,xv=306,sh=1e3,Kr=1001,Vi=1003,gi=1006,nc=1008,Tu=1009,Au=1014,ic=1015,Cv=1016,oh=1020,Fo=1023,ah=1026,fm=1027,Mv=2300,pm=2301,lh=3001,_i="srgb",Lr="srgb-linear",GI="display-p3",zS="display-p3-linear",GS="linear",ri="srgb",WS="rec709",jS="p3",OH="300 es",rc=2e3;class uh{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const r=this._listeners[e];if(void 0!==r){const s=r.indexOf(t);-1!==s&&r.splice(s,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const i=this._listeners[e.type];if(void 0!==i){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const Zr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];const dh=Math.PI/180,_m=180/Math.PI;function lo(){const n=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(Zr[255&n]+Zr[n>>8&255]+Zr[n>>16&255]+Zr[n>>24&255]+"-"+Zr[255&e]+Zr[e>>8&255]+"-"+Zr[e>>16&15|64]+Zr[e>>24&255]+"-"+Zr[63&t|128]+Zr[t>>8&255]+"-"+Zr[t>>16&255]+Zr[t>>24&255]+Zr[255&i]+Zr[i>>8&255]+Zr[i>>16&255]+Zr[i>>24&255]).toLowerCase()}function Ci(n,e,t){return Math.max(e,Math.min(t,n))}function $I(n,e){return(n%e+e)%e}function Tv(n,e,t){return(1-t)*n+t*e}function qI(n){return 0==(n&n-1)&&0!==n}function FH(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function XS(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function Vs(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function qt(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(4294967295*n);case Uint16Array:return Math.round(65535*n);case Uint8Array:return Math.round(255*n);case Int32Array:return Math.round(2147483647*n);case Int16Array:return Math.round(32767*n);case Int8Array:return Math.round(127*n);default:throw new Error("Invalid component type.")}}const Du_DEG2RAD=dh,Du_degToRad=function Bte(n){return n*dh},Du_radToDeg=function Vte(n){return n*_m};class fe{constructor(e=0,t=0){fe.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(Ci(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Jt{constructor(e,t,i,r,s,o,a,l,c){Jt.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,i,r,s,o,a,l,c)}set(e,t,i,r,s,o,a,l,c){const d=this.elements;return d[0]=e,d[1]=r,d[2]=a,d[3]=t,d[4]=s,d[5]=l,d[6]=i,d[7]=o,d[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[3],l=i[6],c=i[1],d=i[4],h=i[7],p=i[2],m=i[5],g=i[8],v=r[0],w=r[3],y=r[6],b=r[1],x=r[4],E=r[7],C=r[2],A=r[5],D=r[8];return s[0]=o*v+a*b+l*C,s[3]=o*w+a*x+l*A,s[6]=o*y+a*E+l*D,s[1]=c*v+d*b+h*C,s[4]=c*w+d*x+h*A,s[7]=c*y+d*E+h*D,s[2]=p*v+m*b+g*C,s[5]=p*w+m*x+g*A,s[8]=p*y+m*E+g*D,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],d=e[8];return t*o*d-t*a*c-i*s*d+i*a*l+r*s*c-r*o*l}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],d=e[8],h=d*o-a*c,p=a*l-d*s,m=c*s-o*l,g=t*h+i*p+r*m;if(0===g)return this.set(0,0,0,0,0,0,0,0,0);const v=1/g;return e[0]=h*v,e[1]=(r*c-d*i)*v,e[2]=(a*i-r*o)*v,e[3]=p*v,e[4]=(d*t-r*l)*v,e[5]=(r*s-a*t)*v,e[6]=m*v,e[7]=(i*l-c*t)*v,e[8]=(o*t-i*s)*v,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(i*l,i*c,-i*(l*o+c*a)+o+e,-r*c,r*l,-r*(-c*o+l*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(XI.makeScale(e,t)),this}rotate(e){return this.premultiply(XI.makeRotation(-e)),this}translate(e,t){return this.premultiply(XI.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const XI=new Jt;function kH(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function Av(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function Gte(){const n=Av("canvas");return n.style.display="block",n}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const UH={};function Dv(n){n in UH||(UH[n]=!0,console.warn(n))}const BH=(new Jt).set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),VH=(new Jt).set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),YS={[Lr]:{transfer:GS,primaries:WS,toReference:n=>n,fromReference:n=>n},[_i]:{transfer:ri,primaries:WS,toReference:n=>n.convertSRGBToLinear(),fromReference:n=>n.convertLinearToSRGB()},[zS]:{transfer:GS,primaries:jS,toReference:n=>n.applyMatrix3(VH),fromReference:n=>n.applyMatrix3(BH)},[GI]:{transfer:ri,primaries:jS,toReference:n=>n.convertSRGBToLinear().applyMatrix3(VH),fromReference:n=>n.applyMatrix3(BH).convertLinearToSRGB()}},Wte=new Set([Lr,zS]),Mn={enabled:!0,_workingColorSpace:Lr,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(n){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!n},get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(n){if(!Wte.has(n))throw new Error(`Unsupported working color space, "${n}".`);this._workingColorSpace=n},convert:function(n,e,t){return!1!==this.enabled&&e!==t&&e&&t?(0,YS[t].fromReference)((0,YS[e].toReference)(n)):n},fromWorkingColorSpace:function(n,e){return this.convert(n,this._workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this._workingColorSpace)},getPrimaries:function(n){return YS[n].primaries},getTransfer:function(n){return""===n?GS:YS[n].transfer}};function vm(n){return n<.04045?.0773993808*n:Math.pow(.9478672986*n+.0521327014,2.4)}function YI(n){return n<.0031308?12.92*n:1.055*Math.pow(n,.41666)-.055}let wm;class HH{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===wm&&(wm=Av("canvas")),wm.width=e.width,wm.height=e.height;const i=wm.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=wm}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=Av("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=255*vm(s[o]/255);return i.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t[i]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*vm(t[i]/255)):vm(t[i]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let jte=0;class bm{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:jte++}),this.uuid=lo(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(null!==r){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)s.push(KI(r[o].isDataTexture?r[o].image:r[o]))}else s=KI(r);i.url=s}return t||(e.images[this.uuid]=i),i}}function KI(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?HH.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let $te=0,Uo=(()=>{class n extends uh{constructor(t=n.DEFAULT_IMAGE,i=n.DEFAULT_MAPPING,r=Kr,s=Kr,o=gi,a=nc,l=Fo,c=Tu,d=n.DEFAULT_ANISOTROPY,h=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:$te++}),this.uuid=lo(),this.name="",this.source=new bm(t),this.mipmaps=[],this.mapping=i,this.channel=0,this.wrapS=r,this.wrapT=s,this.magFilter=o,this.minFilter=a,this.anisotropy=d,this.format=l,this.internalFormat=null,this.type=c,this.offset=new fe(0,0),this.repeat=new fe(1,1),this.center=new fe(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Jt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,"string"==typeof h?this.colorSpace=h:(Dv("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=h===lh?_i:""),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const i=void 0===t||"string"==typeof t;if(!i&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),i||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case sh:t.x=t.x-Math.floor(t.x);break;case Kr:t.x=t.x<0?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case sh:t.y=t.y-Math.floor(t.y);break;case Kr:t.y=t.y<0?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return Dv("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===_i?lh:3e3}set encoding(t){Dv("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=t===lh?_i:""}}return n.DEFAULT_IMAGE=null,n.DEFAULT_MAPPING=300,n.DEFAULT_ANISOTROPY=1,n})();class Ln{constructor(e=0,t=0,i=0,r=1){Ln.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*i+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,s;const l=e.elements,c=l[0],d=l[4],h=l[8],p=l[1],m=l[5],g=l[9],v=l[2],w=l[6],y=l[10];if(Math.abs(d-p)<.01&&Math.abs(h-v)<.01&&Math.abs(g-w)<.01){if(Math.abs(d+p)<.1&&Math.abs(h+v)<.1&&Math.abs(g+w)<.1&&Math.abs(c+m+y-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const x=(c+1)/2,E=(m+1)/2,C=(y+1)/2,A=(d+p)/4,D=(h+v)/4,L=(g+w)/4;return x>E&&x>C?x<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(x),r=A/i,s=D/i):E>C?E<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(E),i=A/r,s=L/r):C<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(C),i=D/s,r=L/s),this.set(i,r,s,t),this}let b=Math.sqrt((w-g)*(w-g)+(h-v)*(h-v)+(p-d)*(p-d));return Math.abs(b)<.001&&(b=1),this.x=(w-g)/b,this.y=(h-v)/b,this.z=(p-d)/b,this.w=Math.acos((c+m+y-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class qte extends uh{constructor(e=1,t=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Ln(0,0,e,t),this.scissorTest=!1,this.viewport=new Ln(0,0,e,t);const r={width:e,height:t,depth:1};void 0!==i.encoding&&(Dv("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),i.colorSpace=i.encoding===lh?_i:""),i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:gi,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},i),this.texture=new Uo(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps,this.texture.internalFormat=i.internalFormat,this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.depthTexture=i.depthTexture,this.samples=i.samples}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new bm(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class hh extends qte{constructor(e=1,t=1,i={}){super(e,t,i),this.isWebGLRenderTarget=!0}}class ZI extends Uo{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=Vi,this.minFilter=Vi,this.wrapR=Kr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class zH extends Uo{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=Vi,this.minFilter=Vi,this.wrapR=Kr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class zn{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,s,o,a){let l=i[r+0],c=i[r+1],d=i[r+2],h=i[r+3];const p=s[o+0],m=s[o+1],g=s[o+2],v=s[o+3];if(0===a)return e[t+0]=l,e[t+1]=c,e[t+2]=d,void(e[t+3]=h);if(1===a)return e[t+0]=p,e[t+1]=m,e[t+2]=g,void(e[t+3]=v);if(h!==v||l!==p||c!==m||d!==g){let w=1-a;const y=l*p+c*m+d*g+h*v,b=y>=0?1:-1,x=1-y*y;if(x>Number.EPSILON){const C=Math.sqrt(x),A=Math.atan2(C,y*b);w=Math.sin(w*A)/C,a=Math.sin(a*A)/C}const E=a*b;if(l=l*w+p*E,c=c*w+m*E,d=d*w+g*E,h=h*w+v*E,w===1-a){const C=1/Math.sqrt(l*l+c*c+d*d+h*h);l*=C,c*=C,d*=C,h*=C}}e[t]=l,e[t+1]=c,e[t+2]=d,e[t+3]=h}static multiplyQuaternionsFlat(e,t,i,r,s,o){const a=i[r],l=i[r+1],c=i[r+2],d=i[r+3],h=s[o],p=s[o+1],m=s[o+2],g=s[o+3];return e[t]=a*g+d*h+l*m-c*p,e[t+1]=l*g+d*p+c*h-a*m,e[t+2]=c*g+d*m+a*p-l*h,e[t+3]=d*g-a*h-l*p-c*m,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,c=a(i/2),d=a(r/2),h=a(s/2),p=l(i/2),m=l(r/2),g=l(s/2);switch(o){case"XYZ":this._x=p*d*h+c*m*g,this._y=c*m*h-p*d*g,this._z=c*d*g+p*m*h,this._w=c*d*h-p*m*g;break;case"YXZ":this._x=p*d*h+c*m*g,this._y=c*m*h-p*d*g,this._z=c*d*g-p*m*h,this._w=c*d*h+p*m*g;break;case"ZXY":this._x=p*d*h-c*m*g,this._y=c*m*h+p*d*g,this._z=c*d*g+p*m*h,this._w=c*d*h-p*m*g;break;case"ZYX":this._x=p*d*h-c*m*g,this._y=c*m*h+p*d*g,this._z=c*d*g-p*m*h,this._w=c*d*h+p*m*g;break;case"YZX":this._x=p*d*h+c*m*g,this._y=c*m*h+p*d*g,this._z=c*d*g-p*m*h,this._w=c*d*h-p*m*g;break;case"XZY":this._x=p*d*h-c*m*g,this._y=c*m*h-p*d*g,this._z=c*d*g+p*m*h,this._w=c*d*h+p*m*g;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],s=t[8],o=t[1],a=t[5],l=t[9],c=t[2],d=t[6],h=t[10],p=i+a+h;if(p>0){const m=.5/Math.sqrt(p+1);this._w=.25/m,this._x=(d-l)*m,this._y=(s-c)*m,this._z=(o-r)*m}else if(i>a&&i>h){const m=2*Math.sqrt(1+i-a-h);this._w=(d-l)/m,this._x=.25*m,this._y=(r+o)/m,this._z=(s+c)/m}else if(a>h){const m=2*Math.sqrt(1+a-i-h);this._w=(s-c)/m,this._x=(r+o)/m,this._y=.25*m,this._z=(l+d)/m}else{const m=2*Math.sqrt(1+h-i-a);this._w=(o-r)/m,this._x=(s+c)/m,this._y=(l+d)/m,this._z=.25*m}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Ci(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(0===i)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,s=e._z,o=e._w,a=t._x,l=t._y,c=t._z,d=t._w;return this._x=i*d+o*a+r*c-s*l,this._y=r*d+o*l+s*a-i*c,this._z=s*d+o*c+i*l-r*a,this._w=o*d-i*a-r*l-s*c,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const i=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const m=1-t;return this._w=m*o+t*this._w,this._x=m*i+t*this._x,this._y=m*r+t*this._y,this._z=m*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const c=Math.sqrt(l),d=Math.atan2(c,a),h=Math.sin((1-t)*d)/c,p=Math.sin(t*d)/c;return this._w=o*h+this._w*p,this._x=i*h+this._x*p,this._y=r*h+this._y*p,this._z=s*h+this._z*p,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(r),i*Math.sin(s),i*Math.cos(s),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class N{constructor(e=0,t=0,i=0){N.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return void 0===i&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(GH.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(GH.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*r,this.y=s[1]*t+s[4]*i+s[7]*r,this.z=s[2]*t+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=l*t+o*r-a*i,d=l*i+a*t-s*r,h=l*r+s*i-o*t,p=-s*t-o*i-a*r;return this.x=c*l+p*-s+d*-a-h*-o,this.y=d*l+p*-o+h*-s-c*-a,this.z=h*l+p*-a+c*-o-d*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r,this.y=s[1]*t+s[5]*i+s[9]*r,this.z=s[2]*t+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=r*l-s*a,this.y=s*o-i*l,this.z=i*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return JI.copy(this).projectOnVector(e),this.sub(JI)}reflect(e){return this.sub(JI.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(Ci(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const JI=new N,GH=new zn;class rl{constructor(e=new N(1/0,1/0,1/0),t=new N(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(oc.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(oc.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=oc.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){if(e.updateWorldMatrix(!1,!1),void 0!==e.boundingBox)null===e.boundingBox&&e.computeBoundingBox(),xm.copy(e.boundingBox),xm.applyMatrix4(e.matrixWorld),this.union(xm);else{const r=e.geometry;if(void 0!==r)if(t&&void 0!==r.attributes&&void 0!==r.attributes.position){const s=r.attributes.position;for(let o=0,a=s.count;o<a;o++)oc.fromBufferAttribute(s,o).applyMatrix4(e.matrixWorld),this.expandByPoint(oc)}else null===r.boundingBox&&r.computeBoundingBox(),xm.copy(r.boundingBox),xm.applyMatrix4(e.matrixWorld),this.union(xm)}const i=e.children;for(let r=0,s=i.length;r<s;r++)this.expandByObject(i[r],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,oc),oc.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Iv),KS.subVectors(this.max,Iv),Sm.subVectors(e.a,Iv),Em.subVectors(e.b,Iv),Cm.subVectors(e.c,Iv),Iu.subVectors(Em,Sm),Ru.subVectors(Cm,Em),fh.subVectors(Sm,Cm);let t=[0,-Iu.z,Iu.y,0,-Ru.z,Ru.y,0,-fh.z,fh.y,Iu.z,0,-Iu.x,Ru.z,0,-Ru.x,fh.z,0,-fh.x,-Iu.y,Iu.x,0,-Ru.y,Ru.x,0,-fh.y,fh.x,0];return!(!QI(t,Sm,Em,Cm,KS)||(t=[1,0,0,0,1,0,0,0,1],!QI(t,Sm,Em,Cm,KS)))&&(ZS.crossVectors(Iu,Ru),t=[ZS.x,ZS.y,ZS.z],QI(t,Sm,Em,Cm,KS))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,oc).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(oc).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(sc[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),sc[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),sc[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),sc[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),sc[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),sc[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),sc[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),sc[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(sc)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const sc=[new N,new N,new N,new N,new N,new N,new N,new N],oc=new N,xm=new rl,Sm=new N,Em=new N,Cm=new N,Iu=new N,Ru=new N,fh=new N,Iv=new N,KS=new N,ZS=new N,ph=new N;function QI(n,e,t,i,r){for(let s=0,o=n.length-3;s<=o;s+=3){ph.fromArray(n,s);const a=r.x*Math.abs(ph.x)+r.y*Math.abs(ph.y)+r.z*Math.abs(ph.z),l=e.dot(ph),c=t.dot(ph),d=i.dot(ph);if(Math.max(-Math.max(l,c,d),Math.min(l,c,d))>a)return!1}return!0}const Xte=new rl,Rv=new N,eR=new N;class va{constructor(e=new N,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;void 0!==t?i.copy(t):Xte.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Rv.subVectors(e,this.center);const t=Rv.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=.5*(i-this.radius);this.center.addScaledVector(Rv,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(eR.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Rv.copy(e.center).add(eR)),this.expandByPoint(Rv.copy(e.center).sub(eR))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const ac=new N,tR=new N,JS=new N,Pu=new N,nR=new N,QS=new N,iR=new N;class Mm{constructor(e=new N,t=new N(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,ac)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=ac.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(ac.copy(this.origin).addScaledVector(this.direction,t),ac.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){tR.copy(e).add(t).multiplyScalar(.5),JS.copy(t).sub(e).normalize(),Pu.copy(this.origin).sub(tR);const s=.5*e.distanceTo(t),o=-this.direction.dot(JS),a=Pu.dot(this.direction),l=-Pu.dot(JS),c=Pu.lengthSq(),d=Math.abs(1-o*o);let h,p,m,g;if(d>0)if(h=o*l-a,p=o*a-l,g=s*d,h>=0)if(p>=-g)if(p<=g){const v=1/d;h*=v,p*=v,m=h*(h+o*p+2*a)+p*(o*h+p+2*l)+c}else p=s,h=Math.max(0,-(o*p+a)),m=-h*h+p*(p+2*l)+c;else p=-s,h=Math.max(0,-(o*p+a)),m=-h*h+p*(p+2*l)+c;else p<=-g?(h=Math.max(0,-(-o*s+a)),p=h>0?-s:Math.min(Math.max(-s,-l),s),m=-h*h+p*(p+2*l)+c):p<=g?(h=0,p=Math.min(Math.max(-s,-l),s),m=p*(p+2*l)+c):(h=Math.max(0,-(o*s+a)),p=h>0?s:Math.min(Math.max(-s,-l),s),m=-h*h+p*(p+2*l)+c);else p=o>0?-s:s,h=Math.max(0,-(o*p+a)),m=-h*h+p*(p+2*l)+c;return i&&i.copy(this.origin).addScaledVector(this.direction,h),r&&r.copy(tR).addScaledVector(JS,p),m}intersectSphere(e,t){ac.subVectors(e.center,this.origin);const i=ac.dot(this.direction),r=ac.dot(ac)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=i-o,l=i+o;return l<0?null:this.at(a<0?l:a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return null===i?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,s,o,a,l;const c=1/this.direction.x,d=1/this.direction.y,h=1/this.direction.z,p=this.origin;return c>=0?(i=(e.min.x-p.x)*c,r=(e.max.x-p.x)*c):(i=(e.max.x-p.x)*c,r=(e.min.x-p.x)*c),d>=0?(s=(e.min.y-p.y)*d,o=(e.max.y-p.y)*d):(s=(e.max.y-p.y)*d,o=(e.min.y-p.y)*d),i>o||s>r||((s>i||isNaN(i))&&(i=s),(o<r||isNaN(r))&&(r=o),h>=0?(a=(e.min.z-p.z)*h,l=(e.max.z-p.z)*h):(a=(e.max.z-p.z)*h,l=(e.min.z-p.z)*h),i>l||a>r)||((a>i||i!=i)&&(i=a),(l<r||r!=r)&&(r=l),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return null!==this.intersectBox(e,ac)}intersectTriangle(e,t,i,r,s){nR.subVectors(t,e),QS.subVectors(i,e),iR.crossVectors(nR,QS);let a,o=this.direction.dot(iR);if(o>0){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}Pu.subVectors(this.origin,e);const l=a*this.direction.dot(QS.crossVectors(Pu,QS));if(l<0)return null;const c=a*this.direction.dot(nR.cross(Pu));if(c<0||l+c>o)return null;const d=-a*Pu.dot(iR);return d<0?null:this.at(d/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Ct{constructor(e,t,i,r,s,o,a,l,c,d,h,p,m,g,v,w){Ct.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,i,r,s,o,a,l,c,d,h,p,m,g,v,w)}set(e,t,i,r,s,o,a,l,c,d,h,p,m,g,v,w){const y=this.elements;return y[0]=e,y[4]=t,y[8]=i,y[12]=r,y[1]=s,y[5]=o,y[9]=a,y[13]=l,y[2]=c,y[6]=d,y[10]=h,y[14]=p,y[3]=m,y[7]=g,y[11]=v,y[15]=w,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Ct).fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/Tm.setFromMatrixColumn(e,0).length(),s=1/Tm.setFromMatrixColumn(e,1).length(),o=1/Tm.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),l=Math.cos(r),c=Math.sin(r),d=Math.cos(s),h=Math.sin(s);if("XYZ"===e.order){const p=o*d,m=o*h,g=a*d,v=a*h;t[0]=l*d,t[4]=-l*h,t[8]=c,t[1]=m+g*c,t[5]=p-v*c,t[9]=-a*l,t[2]=v-p*c,t[6]=g+m*c,t[10]=o*l}else if("YXZ"===e.order){const p=l*d,m=l*h,g=c*d,v=c*h;t[0]=p+v*a,t[4]=g*a-m,t[8]=o*c,t[1]=o*h,t[5]=o*d,t[9]=-a,t[2]=m*a-g,t[6]=v+p*a,t[10]=o*l}else if("ZXY"===e.order){const p=l*d,m=l*h,g=c*d,v=c*h;t[0]=p-v*a,t[4]=-o*h,t[8]=g+m*a,t[1]=m+g*a,t[5]=o*d,t[9]=v-p*a,t[2]=-o*c,t[6]=a,t[10]=o*l}else if("ZYX"===e.order){const p=o*d,m=o*h,g=a*d,v=a*h;t[0]=l*d,t[4]=g*c-m,t[8]=p*c+v,t[1]=l*h,t[5]=v*c+p,t[9]=m*c-g,t[2]=-c,t[6]=a*l,t[10]=o*l}else if("YZX"===e.order){const p=o*l,m=o*c,g=a*l,v=a*c;t[0]=l*d,t[4]=v-p*h,t[8]=g*h+m,t[1]=h,t[5]=o*d,t[9]=-a*d,t[2]=-c*d,t[6]=m*h+g,t[10]=p-v*h}else if("XZY"===e.order){const p=o*l,m=o*c,g=a*l,v=a*c;t[0]=l*d,t[4]=-h,t[8]=c*d,t[1]=p*h+v,t[5]=o*d,t[9]=m*h-g,t[2]=g*h-m,t[6]=a*d,t[10]=v*h+p}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Yte,e,Kte)}lookAt(e,t,i){const r=this.elements;return co.subVectors(e,t),0===co.lengthSq()&&(co.z=1),co.normalize(),Nu.crossVectors(i,co),0===Nu.lengthSq()&&(1===Math.abs(i.z)?co.x+=1e-4:co.z+=1e-4,co.normalize(),Nu.crossVectors(i,co)),Nu.normalize(),eE.crossVectors(co,Nu),r[0]=Nu.x,r[4]=eE.x,r[8]=co.x,r[1]=Nu.y,r[5]=eE.y,r[9]=co.y,r[2]=Nu.z,r[6]=eE.z,r[10]=co.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[4],l=i[8],c=i[12],d=i[1],h=i[5],p=i[9],m=i[13],g=i[2],v=i[6],w=i[10],y=i[14],b=i[3],x=i[7],E=i[11],C=i[15],A=r[0],D=r[4],L=r[8],M=r[12],R=r[1],$=r[5],ee=r[9],se=r[13],V=r[2],J=r[6],G=r[10],X=r[14],Q=r[3],Z=r[7],le=r[11],q=r[15];return s[0]=o*A+a*R+l*V+c*Q,s[4]=o*D+a*$+l*J+c*Z,s[8]=o*L+a*ee+l*G+c*le,s[12]=o*M+a*se+l*X+c*q,s[1]=d*A+h*R+p*V+m*Q,s[5]=d*D+h*$+p*J+m*Z,s[9]=d*L+h*ee+p*G+m*le,s[13]=d*M+h*se+p*X+m*q,s[2]=g*A+v*R+w*V+y*Q,s[6]=g*D+v*$+w*J+y*Z,s[10]=g*L+v*ee+w*G+y*le,s[14]=g*M+v*se+w*X+y*q,s[3]=b*A+x*R+E*V+C*Q,s[7]=b*D+x*$+E*J+C*Z,s[11]=b*L+x*ee+E*G+C*le,s[15]=b*M+x*se+E*X+C*q,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],d=e[2],h=e[6],p=e[10],m=e[14];return e[3]*(+s*l*h-r*c*h-s*a*p+i*c*p+r*a*m-i*l*m)+e[7]*(+t*l*m-t*c*p+s*o*p-r*o*m+r*c*d-s*l*d)+e[11]*(+t*c*h-t*a*m-s*o*h+i*o*m+s*a*d-i*c*d)+e[15]*(-r*a*d-t*l*h+t*a*p+r*o*h-i*o*p+i*l*d)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],d=e[8],h=e[9],p=e[10],m=e[11],g=e[12],v=e[13],w=e[14],y=e[15],b=h*w*c-v*p*c+v*l*m-a*w*m-h*l*y+a*p*y,x=g*p*c-d*w*c-g*l*m+o*w*m+d*l*y-o*p*y,E=d*v*c-g*h*c+g*a*m-o*v*m-d*a*y+o*h*y,C=g*h*l-d*v*l-g*a*p+o*v*p+d*a*w-o*h*w,A=t*b+i*x+r*E+s*C;if(0===A)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const D=1/A;return e[0]=b*D,e[1]=(v*p*s-h*w*s-v*r*m+i*w*m+h*r*y-i*p*y)*D,e[2]=(a*w*s-v*l*s+v*r*c-i*w*c-a*r*y+i*l*y)*D,e[3]=(h*l*s-a*p*s-h*r*c+i*p*c+a*r*m-i*l*m)*D,e[4]=x*D,e[5]=(d*w*s-g*p*s+g*r*m-t*w*m-d*r*y+t*p*y)*D,e[6]=(g*l*s-o*w*s-g*r*c+t*w*c+o*r*y-t*l*y)*D,e[7]=(o*p*s-d*l*s+d*r*c-t*p*c-o*r*m+t*l*m)*D,e[8]=E*D,e[9]=(g*h*s-d*v*s-g*i*m+t*v*m+d*i*y-t*h*y)*D,e[10]=(o*v*s-g*a*s+g*i*c-t*v*c-o*i*y+t*a*y)*D,e[11]=(d*a*s-o*h*s-d*i*c+t*h*c+o*i*m-t*a*m)*D,e[12]=C*D,e[13]=(d*v*r-g*h*r+g*i*p-t*v*p-d*i*w+t*h*w)*D,e[14]=(g*a*r-o*v*r-g*i*l+t*v*l+o*i*w-t*a*w)*D,e[15]=(o*h*r-d*a*r+d*i*l-t*h*l-o*i*p+t*a*p)*D,this}scale(e){const t=this.elements,i=e.x,r=e.y,s=e.z;return t[0]*=i,t[4]*=r,t[8]*=s,t[1]*=i,t[5]*=r,t[9]*=s,t[2]*=i,t[6]*=r,t[10]*=s,t[3]*=i,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),s=1-i,o=e.x,a=e.y,l=e.z,c=s*o,d=s*a;return this.set(c*o+i,c*a-r*l,c*l+r*a,0,c*a+r*l,d*a+i,d*l-r*o,0,c*l-r*a,d*l+r*o,s*l*l+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,c=s+s,d=o+o,h=a+a,p=s*c,m=s*d,g=s*h,v=o*d,w=o*h,y=a*h,b=l*c,x=l*d,E=l*h,C=i.x,A=i.y,D=i.z;return r[0]=(1-(v+y))*C,r[1]=(m+E)*C,r[2]=(g-x)*C,r[3]=0,r[4]=(m-E)*A,r[5]=(1-(p+y))*A,r[6]=(w+b)*A,r[7]=0,r[8]=(g+x)*D,r[9]=(w-b)*D,r[10]=(1-(p+v))*D,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let s=Tm.set(r[0],r[1],r[2]).length();const o=Tm.set(r[4],r[5],r[6]).length(),a=Tm.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],wa.copy(this);const c=1/s,d=1/o,h=1/a;return wa.elements[0]*=c,wa.elements[1]*=c,wa.elements[2]*=c,wa.elements[4]*=d,wa.elements[5]*=d,wa.elements[6]*=d,wa.elements[8]*=h,wa.elements[9]*=h,wa.elements[10]*=h,t.setFromRotationMatrix(wa),i.x=s,i.y=o,i.z=a,this}makePerspective(e,t,i,r,s,o,a=rc){const l=this.elements,c=2*s/(t-e),d=2*s/(i-r),h=(t+e)/(t-e),p=(i+r)/(i-r);let m,g;if(a===rc)m=-(o+s)/(o-s),g=-2*o*s/(o-s);else{if(2001!==a)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);m=-o/(o-s),g=-o*s/(o-s)}return l[0]=c,l[4]=0,l[8]=h,l[12]=0,l[1]=0,l[5]=d,l[9]=p,l[13]=0,l[2]=0,l[6]=0,l[10]=m,l[14]=g,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,i,r,s,o,a=rc){const l=this.elements,c=1/(t-e),d=1/(i-r),h=1/(o-s),p=(t+e)*c,m=(i+r)*d;let g,v;if(a===rc)g=(o+s)*h,v=-2*h;else{if(2001!==a)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);g=s*h,v=-1*h}return l[0]=2*c,l[4]=0,l[8]=0,l[12]=-p,l[1]=0,l[5]=2*d,l[9]=0,l[13]=-m,l[2]=0,l[6]=0,l[10]=v,l[14]=-g,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const Tm=new N,wa=new Ct,Yte=new N(0,0,0),Kte=new N(1,1,1),Nu=new N,eE=new N,co=new N,WH=new Ct,jH=new zn;let $H=(()=>{class n{constructor(t=0,i=0,r=0,s=n.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=i,this._z=r,this._order=s}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,i,r,s=this._order){return this._x=t,this._y=i,this._z=r,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,i=this._order,r=!0){const s=t.elements,o=s[0],a=s[4],l=s[8],c=s[1],d=s[5],h=s[9],p=s[2],m=s[6],g=s[10];switch(i){case"XYZ":this._y=Math.asin(Ci(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-h,g),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(m,d),this._z=0);break;case"YXZ":this._x=Math.asin(-Ci(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(l,g),this._z=Math.atan2(c,d)):(this._y=Math.atan2(-p,o),this._z=0);break;case"ZXY":this._x=Math.asin(Ci(m,-1,1)),Math.abs(m)<.9999999?(this._y=Math.atan2(-p,g),this._z=Math.atan2(-a,d)):(this._y=0,this._z=Math.atan2(c,o));break;case"ZYX":this._y=Math.asin(-Ci(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(m,g),this._z=Math.atan2(c,o)):(this._x=0,this._z=Math.atan2(-a,d));break;case"YZX":this._z=Math.asin(Ci(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-h,d),this._y=Math.atan2(-p,o)):(this._x=0,this._y=Math.atan2(l,g));break;case"XZY":this._z=Math.asin(-Ci(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(m,d),this._y=Math.atan2(l,o)):(this._x=Math.atan2(-h,g),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,!0===r&&this._onChangeCallback(),this}setFromQuaternion(t,i,r){return WH.makeRotationFromQuaternion(t),this.setFromRotationMatrix(WH,i,r)}setFromVector3(t,i=this._order){return this.set(t.x,t.y,t.z,i)}reorder(t){return jH.setFromEuler(this),this.setFromQuaternion(jH,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],i=0){return t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return n.DEFAULT_ORDER="XYZ",n})();class rR{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let Zte=0;const qH=new N,Am=new zn,lc=new Ct,tE=new N,Pv=new N,Jte=new N,Qte=new zn,XH=new N(1,0,0),YH=new N(0,1,0),KH=new N(0,0,1),ene={type:"added"},tne={type:"removed"};let si=(()=>{class n extends uh{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Zte++}),this.uuid=lo(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=n.DEFAULT_UP.clone();const t=new N,i=new $H,r=new zn,s=new N(1,1,1);i._onChange(function o(){r.setFromEuler(i,!1)}),r._onChange(function a(){i.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new Ct},normalMatrix:{value:new Jt}}),this.matrix=new Ct,this.matrixWorld=new Ct,this.matrixAutoUpdate=n.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new rR,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,i){this.quaternion.setFromAxisAngle(t,i)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,i){return Am.setFromAxisAngle(t,i),this.quaternion.multiply(Am),this}rotateOnWorldAxis(t,i){return Am.setFromAxisAngle(t,i),this.quaternion.premultiply(Am),this}rotateX(t){return this.rotateOnAxis(XH,t)}rotateY(t){return this.rotateOnAxis(YH,t)}rotateZ(t){return this.rotateOnAxis(KH,t)}translateOnAxis(t,i){return qH.copy(t).applyQuaternion(this.quaternion),this.position.add(qH.multiplyScalar(i)),this}translateX(t){return this.translateOnAxis(XH,t)}translateY(t){return this.translateOnAxis(YH,t)}translateZ(t){return this.translateOnAxis(KH,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(lc.copy(this.matrixWorld).invert())}lookAt(t,i,r){t.isVector3?tE.copy(t):tE.set(t,i,r);const s=this.parent;this.updateWorldMatrix(!0,!1),Pv.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?lc.lookAt(Pv,tE,this.up):lc.lookAt(tE,Pv,this.up),this.quaternion.setFromRotationMatrix(lc),s&&(lc.extractRotation(s.matrixWorld),Am.setFromRotationMatrix(lc),this.quaternion.premultiply(Am.invert()))}add(t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(ene)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const i=this.children.indexOf(t);return-1!==i&&(t.parent=null,this.children.splice(i,1),t.dispatchEvent(tne)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),lc.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),lc.multiply(t.parent.matrixWorld)),t.applyMatrix4(lc),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,i){if(this[t]===i)return this;for(let r=0,s=this.children.length;r<s;r++){const a=this.children[r].getObjectByProperty(t,i);if(void 0!==a)return a}}getObjectsByProperty(t,i){let r=[];this[t]===i&&r.push(this);for(let s=0,o=this.children.length;s<o;s++){const a=this.children[s].getObjectsByProperty(t,i);a.length>0&&(r=r.concat(a))}return r}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Pv,t,Jte),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Pv,Qte,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return t.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(t){t(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].traverseVisible(t)}traverseAncestors(t){const i=this.parent;null!==i&&(t(i),i.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const i=this.children;for(let r=0,s=i.length;r<s;r++){const o=i[r];(!0===o.matrixWorldAutoUpdate||!0===t)&&o.updateMatrixWorld(t)}}updateWorldMatrix(t,i){const r=this.parent;if(!0===t&&null!==r&&!0===r.matrixWorldAutoUpdate&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===i){const s=this.children;for(let o=0,a=s.length;o<a;o++){const l=s[o];!0===l.matrixWorldAutoUpdate&&l.updateWorldMatrix(!1,!0)}}}toJSON(t){const i=void 0===t||"string"==typeof t,r={};i&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const s={};function o(l,c){return void 0===l[c.uuid]&&(l[c.uuid]=c.toJSON(t)),c.uuid}if(s.uuid=this.uuid,s.type=this.type,""!==this.name&&(s.name=this.name),!0===this.castShadow&&(s.castShadow=!0),!0===this.receiveShadow&&(s.receiveShadow=!0),!1===this.visible&&(s.visible=!1),!1===this.frustumCulled&&(s.frustumCulled=!1),0!==this.renderOrder&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(s.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(s.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=o(t.geometries,this.geometry);const l=this.geometry.parameters;if(void 0!==l&&void 0!==l.shapes){const c=l.shapes;if(Array.isArray(c))for(let d=0,h=c.length;d<h;d++)o(t.shapes,c[d]);else o(t.shapes,c)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(o(t.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const l=[];for(let c=0,d=this.material.length;c<d;c++)l.push(o(t.materials,this.material[c]));s.material=l}else s.material=o(t.materials,this.material);if(this.children.length>0){s.children=[];for(let l=0;l<this.children.length;l++)s.children.push(this.children[l].toJSON(t).object)}if(this.animations.length>0){s.animations=[];for(let l=0;l<this.animations.length;l++)s.animations.push(o(t.animations,this.animations[l]))}if(i){const l=a(t.geometries),c=a(t.materials),d=a(t.textures),h=a(t.images),p=a(t.shapes),m=a(t.skeletons),g=a(t.animations),v=a(t.nodes);l.length>0&&(r.geometries=l),c.length>0&&(r.materials=c),d.length>0&&(r.textures=d),h.length>0&&(r.images=h),p.length>0&&(r.shapes=p),m.length>0&&(r.skeletons=m),g.length>0&&(r.animations=g),v.length>0&&(r.nodes=v)}return r.object=s,r;function a(l){const c=[];for(const d in l){const h=l[d];delete h.metadata,c.push(h)}return c}}clone(t){return(new this.constructor).copy(this,t)}copy(t,i=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),!0===i)for(let r=0;r<t.children.length;r++)this.add(t.children[r].clone());return this}}return n.DEFAULT_UP=new N(0,1,0),n.DEFAULT_MATRIX_AUTO_UPDATE=!0,n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,n})();const ba=new N,cc=new N,sR=new N,uc=new N,Dm=new N,Im=new N,ZH=new N,oR=new N,aR=new N,lR=new N;let nE=!1;class uo{constructor(e=new N,t=new N,i=new N){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),ba.subVectors(e,t),r.cross(ba);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,i,r,s){ba.subVectors(r,t),cc.subVectors(i,t),sR.subVectors(e,t);const o=ba.dot(ba),a=ba.dot(cc),l=ba.dot(sR),c=cc.dot(cc),d=cc.dot(sR),h=o*c-a*a;if(0===h)return s.set(-2,-1,-1);const p=1/h,m=(c*l-a*d)*p,g=(o*d-a*l)*p;return s.set(1-m-g,g,m)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,uc),uc.x>=0&&uc.y>=0&&uc.x+uc.y<=1}static getUV(e,t,i,r,s,o,a,l){return!1===nE&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),nE=!0),this.getInterpolation(e,t,i,r,s,o,a,l)}static getInterpolation(e,t,i,r,s,o,a,l){return this.getBarycoord(e,t,i,r,uc),l.setScalar(0),l.addScaledVector(s,uc.x),l.addScaledVector(o,uc.y),l.addScaledVector(a,uc.z),l}static isFrontFacing(e,t,i,r){return ba.subVectors(i,t),cc.subVectors(e,t),ba.cross(cc).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return ba.subVectors(this.c,this.b),cc.subVectors(this.a,this.b),.5*ba.cross(cc).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return uo.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return uo.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,r,s){return!1===nE&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),nE=!0),uo.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}getInterpolation(e,t,i,r,s){return uo.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}containsPoint(e){return uo.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return uo.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,s=this.c;let o,a;Dm.subVectors(r,i),Im.subVectors(s,i),oR.subVectors(e,i);const l=Dm.dot(oR),c=Im.dot(oR);if(l<=0&&c<=0)return t.copy(i);aR.subVectors(e,r);const d=Dm.dot(aR),h=Im.dot(aR);if(d>=0&&h<=d)return t.copy(r);const p=l*h-d*c;if(p<=0&&l>=0&&d<=0)return o=l/(l-d),t.copy(i).addScaledVector(Dm,o);lR.subVectors(e,s);const m=Dm.dot(lR),g=Im.dot(lR);if(g>=0&&m<=g)return t.copy(s);const v=m*c-l*g;if(v<=0&&c>=0&&g<=0)return a=c/(c-g),t.copy(i).addScaledVector(Im,a);const w=d*g-m*h;if(w<=0&&h-d>=0&&m-g>=0)return ZH.subVectors(s,r),a=(h-d)/(h-d+(m-g)),t.copy(r).addScaledVector(ZH,a);const y=1/(w+v+p);return o=v*y,a=p*y,t.copy(i).addScaledVector(Dm,o).addScaledVector(Im,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let nne=0;class xs extends uh{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:nne++}),this.uuid=lo(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const i=e[t];if(void 0===i){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i:console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`)}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),void 0!==this.sheen&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(i.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(i.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(i.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(i.combine=this.combine)),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(i.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(i.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(i.size=this.size),null!==this.shadowSide&&(i.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(i.blending=this.blending),0!==this.side&&(i.side=this.side),!0===this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=!0),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.alphaHash&&(i.alphaHash=!0),!0===this.alphaToCoverage&&(i.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=!0),!0===this.forceSinglePass&&(i.forceSinglePass=!0),!0===this.wireframe&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(i.flatShading=!0),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),!1===this.fog&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData),t){const s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(null!==t){const r=t.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=t[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}const JH={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Ou={h:0,s:0,l:0},iE={h:0,s:0,l:0};function cR(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+6*(e-n)*t:t<.5?e:t<2/3?n+6*(e-n)*(2/3-t):n}class We{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(void 0===t&&void 0===i){const r=e;r&&r.isColor?this.copy(r):"number"==typeof r?this.setHex(r):"string"==typeof r&&this.setStyle(r)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=_i){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,Mn.toWorkingColorSpace(this,t),this}setRGB(e,t,i,r=Mn.workingColorSpace){return this.r=e,this.g=t,this.b=i,Mn.toWorkingColorSpace(this,r),this}setHSL(e,t,i,r=Mn.workingColorSpace){if(e=$I(e,1),t=Ci(t,0,1),i=Ci(i,0,1),0===t)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+t):i+t-i*t,o=2*i-s;this.r=cR(o,s,e+1/3),this.g=cR(o,s,e),this.b=cR(o,s,e-1/3)}return Mn.toWorkingColorSpace(this,r),this}setStyle(e,t=_i){function i(s){void 0!==s&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const a=r[2];switch(r[1]){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(3===o)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(6===o)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=_i){const i=JH[e.toLowerCase()];return void 0!==i?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=vm(e.r),this.g=vm(e.g),this.b=vm(e.b),this}copyLinearToSRGB(e){return this.r=YI(e.r),this.g=YI(e.g),this.b=YI(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=_i){return Mn.fromWorkingColorSpace(Jr.copy(this),e),65536*Math.round(Ci(255*Jr.r,0,255))+256*Math.round(Ci(255*Jr.g,0,255))+Math.round(Ci(255*Jr.b,0,255))}getHexString(e=_i){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Mn.workingColorSpace){Mn.fromWorkingColorSpace(Jr.copy(this),t);const i=Jr.r,r=Jr.g,s=Jr.b,o=Math.max(i,r,s),a=Math.min(i,r,s);let l,c;const d=(a+o)/2;if(a===o)l=0,c=0;else{const h=o-a;switch(c=d<=.5?h/(o+a):h/(2-o-a),o){case i:l=(r-s)/h+(r<s?6:0);break;case r:l=(s-i)/h+2;break;case s:l=(i-r)/h+4}l/=6}return e.h=l,e.s=c,e.l=d,e}getRGB(e,t=Mn.workingColorSpace){return Mn.fromWorkingColorSpace(Jr.copy(this),t),e.r=Jr.r,e.g=Jr.g,e.b=Jr.b,e}getStyle(e=_i){Mn.fromWorkingColorSpace(Jr.copy(this),e);const t=Jr.r,i=Jr.g,r=Jr.b;return e!==_i?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(255*t)},${Math.round(255*i)},${Math.round(255*r)})`}offsetHSL(e,t,i){return this.getHSL(Ou),this.setHSL(Ou.h+e,Ou.s+t,Ou.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(Ou),e.getHSL(iE);const i=Tv(Ou.h,iE.h,t),r=Tv(Ou.s,iE.s,t),s=Tv(Ou.l,iE.l,t);return this.setHSL(i,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,i=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*i+s[6]*r,this.g=s[1]*t+s[4]*i+s[7]*r,this.b=s[2]*t+s[5]*i+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Jr=new We;We.NAMES=JH;class Mi extends xs{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new We(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=kS,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Ji=new N,rE=new fe;class Jn{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=i,this.usage=35044,this.updateRange={offset:0,count:-1},this.gpuType=ic,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,i=this.count;t<i;t++)rE.fromBufferAttribute(this,t),rE.applyMatrix3(e),this.setXY(t,rE.x,rE.y);else if(3===this.itemSize)for(let t=0,i=this.count;t<i;t++)Ji.fromBufferAttribute(this,t),Ji.applyMatrix3(e),this.setXYZ(t,Ji.x,Ji.y,Ji.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)Ji.fromBufferAttribute(this,t),Ji.applyMatrix4(e),this.setXYZ(t,Ji.x,Ji.y,Ji.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Ji.fromBufferAttribute(this,t),Ji.applyNormalMatrix(e),this.setXYZ(t,Ji.x,Ji.y,Ji.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Ji.fromBufferAttribute(this,t),Ji.transformDirection(e),this.setXYZ(t,Ji.x,Ji.y,Ji.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=Vs(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=qt(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Vs(t,this.array)),t}setX(e,t){return this.normalized&&(t=qt(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Vs(t,this.array)),t}setY(e,t){return this.normalized&&(t=qt(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Vs(t,this.array)),t}setZ(e,t){return this.normalized&&(t=qt(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Vs(t,this.array)),t}setW(e,t){return this.normalized&&(t=qt(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=qt(t,this.array),i=qt(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=qt(t,this.array),i=qt(i,this.array),r=qt(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=qt(t,this.array),i=qt(i,this.array),r=qt(r,this.array),s=qt(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}}class QH extends Jn{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class ez extends Jn{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class Ke extends Jn{constructor(e,t,i){super(new Float32Array(e),t,i)}}let rne=0;const Bo=new Ct,uR=new si,Rm=new N,ho=new rl,Ov=new rl,xr=new N;class Ot extends uh{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:rne++}),this.uuid=lo(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(kH(e)?ez:QH)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(void 0!==i){const s=(new Jt).getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return Bo.makeRotationFromQuaternion(e),this.applyMatrix4(Bo),this}rotateX(e){return Bo.makeRotationX(e),this.applyMatrix4(Bo),this}rotateY(e){return Bo.makeRotationY(e),this.applyMatrix4(Bo),this}rotateZ(e){return Bo.makeRotationZ(e),this.applyMatrix4(Bo),this}translate(e,t,i){return Bo.makeTranslation(e,t,i),this.applyMatrix4(Bo),this}scale(e,t,i){return Bo.makeScale(e,t,i),this.applyMatrix4(Bo),this}lookAt(e){return uR.lookAt(e),uR.updateMatrix(),this.applyMatrix4(uR.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Rm).negate(),this.translate(Rm.x,Rm.y,Rm.z),this}setFromPoints(e){const t=[];for(let i=0,r=e.length;i<r;i++){const s=e[i];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new Ke(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new rl);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new N(-1/0,-1/0,-1/0),new N(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++)ho.setFromBufferAttribute(t[i]),this.morphTargetsRelative?(xr.addVectors(this.boundingBox.min,ho.min),this.boundingBox.expandByPoint(xr),xr.addVectors(this.boundingBox.max,ho.max),this.boundingBox.expandByPoint(xr)):(this.boundingBox.expandByPoint(ho.min),this.boundingBox.expandByPoint(ho.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new va);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new N,1/0);if(e){const i=this.boundingSphere.center;if(ho.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++)Ov.setFromBufferAttribute(t[s]),this.morphTargetsRelative?(xr.addVectors(ho.min,Ov.min),ho.expandByPoint(xr),xr.addVectors(ho.max,Ov.max),ho.expandByPoint(xr)):(ho.expandByPoint(Ov.min),ho.expandByPoint(Ov.max));ho.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)xr.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(xr));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let c=0,d=a.count;c<d;c++)xr.fromBufferAttribute(a,c),l&&(Rm.fromBufferAttribute(e,c),xr.add(Rm)),r=Math.max(r,i.distanceToSquared(xr))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const i=e.array,r=t.position.array,s=t.normal.array,o=t.uv.array,a=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new Jn(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,c=[],d=[];for(let R=0;R<a;R++)c[R]=new N,d[R]=new N;const h=new N,p=new N,m=new N,g=new fe,v=new fe,w=new fe,y=new N,b=new N;function x(R,$,ee){h.fromArray(r,3*R),p.fromArray(r,3*$),m.fromArray(r,3*ee),g.fromArray(o,2*R),v.fromArray(o,2*$),w.fromArray(o,2*ee),p.sub(h),m.sub(h),v.sub(g),w.sub(g);const se=1/(v.x*w.y-w.x*v.y);isFinite(se)&&(y.copy(p).multiplyScalar(w.y).addScaledVector(m,-v.y).multiplyScalar(se),b.copy(m).multiplyScalar(v.x).addScaledVector(p,-w.x).multiplyScalar(se),c[R].add(y),c[$].add(y),c[ee].add(y),d[R].add(b),d[$].add(b),d[ee].add(b))}let E=this.groups;0===E.length&&(E=[{start:0,count:i.length}]);for(let R=0,$=E.length;R<$;++R){const ee=E[R],se=ee.start;for(let J=se,G=se+ee.count;J<G;J+=3)x(i[J+0],i[J+1],i[J+2])}const C=new N,A=new N,D=new N,L=new N;function M(R){D.fromArray(s,3*R),L.copy(D);const $=c[R];C.copy($),C.sub(D.multiplyScalar(D.dot($))).normalize(),A.crossVectors(L,$);const se=A.dot(d[R])<0?-1:1;l[4*R]=C.x,l[4*R+1]=C.y,l[4*R+2]=C.z,l[4*R+3]=se}for(let R=0,$=E.length;R<$;++R){const ee=E[R],se=ee.start;for(let J=se,G=se+ee.count;J<G;J+=3)M(i[J+0]),M(i[J+1]),M(i[J+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let i=this.getAttribute("normal");if(void 0===i)i=new Jn(new Float32Array(3*t.count),3),this.setAttribute("normal",i);else for(let p=0,m=i.count;p<m;p++)i.setXYZ(p,0,0,0);const r=new N,s=new N,o=new N,a=new N,l=new N,c=new N,d=new N,h=new N;if(e)for(let p=0,m=e.count;p<m;p+=3){const g=e.getX(p+0),v=e.getX(p+1),w=e.getX(p+2);r.fromBufferAttribute(t,g),s.fromBufferAttribute(t,v),o.fromBufferAttribute(t,w),d.subVectors(o,s),h.subVectors(r,s),d.cross(h),a.fromBufferAttribute(i,g),l.fromBufferAttribute(i,v),c.fromBufferAttribute(i,w),a.add(d),l.add(d),c.add(d),i.setXYZ(g,a.x,a.y,a.z),i.setXYZ(v,l.x,l.y,l.z),i.setXYZ(w,c.x,c.y,c.z)}else for(let p=0,m=t.count;p<m;p+=3)r.fromBufferAttribute(t,p+0),s.fromBufferAttribute(t,p+1),o.fromBufferAttribute(t,p+2),d.subVectors(o,s),h.subVectors(r,s),d.cross(h),i.setXYZ(p+0,d.x,d.y,d.z),i.setXYZ(p+1,d.x,d.y,d.z),i.setXYZ(p+2,d.x,d.y,d.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)xr.fromBufferAttribute(e,t),xr.normalize(),e.setXYZ(t,xr.x,xr.y,xr.z)}toNonIndexed(){function e(a,l){const c=a.array,d=a.itemSize,h=a.normalized,p=new c.constructor(l.length*d);let m=0,g=0;for(let v=0,w=l.length;v<w;v++){m=a.isInterleavedBufferAttribute?l[v]*a.data.stride+a.offset:l[v]*d;for(let y=0;y<d;y++)p[g++]=c[m++]}return new Jn(p,d,h)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Ot,i=this.index.array,r=this.attributes;for(const a in r){const c=e(r[a],i);t.setAttribute(a,c)}const s=this.morphAttributes;for(const a in s){const l=[],c=s[a];for(let d=0,h=c.length;d<h;d++){const m=e(c[d],i);l.push(m)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const c=o[a];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const l=this.parameters;for(const c in l)void 0!==l[c]&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const l in i)e.data.attributes[l]=i[l].toJSON(e.data);const r={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],d=[];for(let h=0,p=c.length;h<p;h++)d.push(c[h].toJSON(e.data));d.length>0&&(r[l]=d,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return null!==a&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;null!==i&&this.setIndex(i.clone(t));const r=e.attributes;for(const c in r)this.setAttribute(c,r[c].clone(t));const s=e.morphAttributes;for(const c in s){const d=[],h=s[c];for(let p=0,m=h.length;p<m;p++)d.push(h[p].clone(t));this.morphAttributes[c]=d}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let c=0,d=o.length;c<d;c++){const h=o[c];this.addGroup(h.start,h.count,h.materialIndex)}const a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());const l=e.boundingSphere;return null!==l&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const tz=new Ct,mh=new Mm,sE=new va,nz=new N,Pm=new N,Nm=new N,Om=new N,dR=new N,oE=new N,aE=new fe,lE=new fe,cE=new fe,iz=new N,rz=new N,sz=new N,uE=new N,dE=new N;class Me extends si{constructor(e=new Ot,t=new Mi){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){const i=this.geometry,s=i.morphAttributes.position,o=i.morphTargetsRelative;t.fromBufferAttribute(i.attributes.position,e);const a=this.morphTargetInfluences;if(s&&a){oE.set(0,0,0);for(let l=0,c=s.length;l<c;l++){const d=a[l];0!==d&&(dR.fromBufferAttribute(s[l],e),oE.addScaledVector(o?dR:dR.sub(t),d))}t.add(oE)}return t}raycast(e,t){const i=this.geometry,s=this.matrixWorld;void 0!==this.material&&(null===i.boundingSphere&&i.computeBoundingSphere(),sE.copy(i.boundingSphere),sE.applyMatrix4(s),mh.copy(e.ray).recast(e.near),(!1!==sE.containsPoint(mh.origin)||!(null===mh.intersectSphere(sE,nz)||mh.origin.distanceToSquared(nz)>(e.far-e.near)**2))&&(tz.copy(s).invert(),mh.copy(e.ray).applyMatrix4(tz),(null===i.boundingBox||!1!==mh.intersectsBox(i.boundingBox))&&this._computeIntersections(e,t,mh)))}_computeIntersections(e,t,i){let r;const s=this.geometry,o=this.material,a=s.index,l=s.attributes.position,c=s.attributes.uv,d=s.attributes.uv1,h=s.attributes.normal,p=s.groups,m=s.drawRange;if(null!==a)if(Array.isArray(o))for(let g=0,v=p.length;g<v;g++){const w=p[g],y=o[w.materialIndex];for(let E=Math.max(w.start,m.start),C=Math.min(a.count,Math.min(w.start+w.count,m.start+m.count));E<C;E+=3)r=hE(this,y,e,i,c,d,h,a.getX(E),a.getX(E+1),a.getX(E+2)),r&&(r.faceIndex=Math.floor(E/3),r.face.materialIndex=w.materialIndex,t.push(r))}else for(let w=Math.max(0,m.start),y=Math.min(a.count,m.start+m.count);w<y;w+=3)r=hE(this,o,e,i,c,d,h,a.getX(w),a.getX(w+1),a.getX(w+2)),r&&(r.faceIndex=Math.floor(w/3),t.push(r));else if(void 0!==l)if(Array.isArray(o))for(let g=0,v=p.length;g<v;g++){const w=p[g],y=o[w.materialIndex];for(let E=Math.max(w.start,m.start),C=Math.min(l.count,Math.min(w.start+w.count,m.start+m.count));E<C;E+=3)r=hE(this,y,e,i,c,d,h,E,E+1,E+2),r&&(r.faceIndex=Math.floor(E/3),r.face.materialIndex=w.materialIndex,t.push(r))}else for(let w=Math.max(0,m.start),y=Math.min(l.count,m.start+m.count);w<y;w+=3)r=hE(this,o,e,i,c,d,h,w,w+1,w+2),r&&(r.faceIndex=Math.floor(w/3),t.push(r))}}function hE(n,e,t,i,r,s,o,a,l,c){n.getVertexPosition(a,Pm),n.getVertexPosition(l,Nm),n.getVertexPosition(c,Om);const d=function sne(n,e,t,i,r,s,o,a){let l;if(l=1===e.side?i.intersectTriangle(o,s,r,!0,a):i.intersectTriangle(r,s,o,0===e.side,a),null===l)return null;dE.copy(a),dE.applyMatrix4(n.matrixWorld);const c=t.ray.origin.distanceTo(dE);return c<t.near||c>t.far?null:{distance:c,point:dE.clone(),object:n}}(n,e,t,i,Pm,Nm,Om,uE);if(d){r&&(aE.fromBufferAttribute(r,a),lE.fromBufferAttribute(r,l),cE.fromBufferAttribute(r,c),d.uv=uo.getInterpolation(uE,Pm,Nm,Om,aE,lE,cE,new fe)),s&&(aE.fromBufferAttribute(s,a),lE.fromBufferAttribute(s,l),cE.fromBufferAttribute(s,c),d.uv1=uo.getInterpolation(uE,Pm,Nm,Om,aE,lE,cE,new fe),d.uv2=d.uv1),o&&(iz.fromBufferAttribute(o,a),rz.fromBufferAttribute(o,l),sz.fromBufferAttribute(o,c),d.normal=uo.getInterpolation(uE,Pm,Nm,Om,iz,rz,sz,new N),d.normal.dot(i.direction)>0&&d.normal.multiplyScalar(-1));const h={a,b:l,c,normal:new N,materialIndex:0};uo.getNormal(Pm,Nm,Om,h.normal),d.face=h}return d}class di extends Ot{constructor(e=1,t=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],c=[],d=[],h=[];let p=0,m=0;function g(v,w,y,b,x,E,C,A,D,L,M){const R=E/D,$=C/L,ee=E/2,se=C/2,V=A/2,J=D+1,G=L+1;let X=0,Q=0;const Z=new N;for(let le=0;le<G;le++){const q=le*$-se;for(let oe=0;oe<J;oe++)Z[v]=(oe*R-ee)*b,Z[w]=q*x,Z[y]=V,c.push(Z.x,Z.y,Z.z),Z[v]=0,Z[w]=0,Z[y]=A>0?1:-1,d.push(Z.x,Z.y,Z.z),h.push(oe/D),h.push(1-le/L),X+=1}for(let le=0;le<L;le++)for(let q=0;q<D;q++){const Se=p+q+J*(le+1),ve=p+(q+1)+J*(le+1),Ne=p+(q+1)+J*le;l.push(p+q+J*le,Se,Ne),l.push(Se,ve,Ne),Q+=6}a.addGroup(m,Q,M),m+=Q,p+=X}g("z","y","x",-1,-1,i,t,e,o,s,0),g("z","y","x",1,-1,i,t,-e,o,s,1),g("x","z","y",1,1,e,i,t,r,o,2),g("x","z","y",1,-1,e,i,-t,r,o,3),g("x","y","z",1,-1,e,t,i,r,s,4),g("x","y","z",-1,-1,e,t,-i,r,s,5),this.setIndex(l),this.setAttribute("position",new Ke(c,3)),this.setAttribute("normal",new Ke(d,3)),this.setAttribute("uv",new Ke(h,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new di(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Lm(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=r.clone():e[t][i]=Array.isArray(r)?r.slice():r}}return e}function Ss(n){const e={};for(let t=0;t<n.length;t++){const i=Lm(n[t]);for(const r in i)e[r]=i[r]}return e}function oz(n){return null===n.getRenderTarget()?n.outputColorSpace:Mn.workingColorSpace}const ane={clone:Lm,merge:Ss};class hc extends xs{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Lm(e.uniforms),this.uniformsGroups=function one(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;t.uniforms[r]=o&&o.isTexture?{type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?{type:"c",value:o.getHex()}:o&&o.isVector2?{type:"v2",value:o.toArray()}:o&&o.isVector3?{type:"v3",value:o.toArray()}:o&&o.isVector4?{type:"v4",value:o.toArray()}:o&&o.isMatrix3?{type:"m3",value:o.toArray()}:o&&o.isMatrix4?{type:"m4",value:o.toArray()}:{value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const i={};for(const r in this.extensions)!0===this.extensions[r]&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class hR extends si{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Ct,this.projectionMatrix=new Ct,this.projectionMatrixInverse=new Ct,this.coordinateSystem=rc}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class cr extends hR{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*_m*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*dh*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*_m*Math.atan(Math.tan(.5*dh*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,r,s,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*dh*this.fov)/this.zoom,i=2*t,r=this.aspect*i,s=-.5*r;const o=this.view;if(null!==this.view&&this.view.enabled){const l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*r/l,t-=o.offsetY*i/c,r*=o.width/l,i*=o.height/c}const a=this.filmOffset;0!==a&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class une extends si{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new cr(-90,1,e,t);r.layers=this.layers,this.add(r);const s=new cr(-90,1,e,t);s.layers=this.layers,this.add(s);const o=new cr(-90,1,e,t);o.layers=this.layers,this.add(o);const a=new cr(-90,1,e,t);a.layers=this.layers,this.add(a);const l=new cr(-90,1,e,t);l.layers=this.layers,this.add(l);const c=new cr(-90,1,e,t);c.layers=this.layers,this.add(c)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[i,r,s,o,a,l]=t;for(const c of t)this.remove(c);if(e===rc)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else{if(2001!==e)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1)}for(const c of t)this.add(c),c.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,o,a,l,c,d]=this.children,h=e.getRenderTarget(),p=e.getActiveCubeFace(),m=e.getActiveMipmapLevel(),g=e.xr.enabled;e.xr.enabled=!1;const v=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,r),e.render(t,s),e.setRenderTarget(i,1,r),e.render(t,o),e.setRenderTarget(i,2,r),e.render(t,a),e.setRenderTarget(i,3,r),e.render(t,l),e.setRenderTarget(i,4,r),e.render(t,c),i.texture.generateMipmaps=v,e.setRenderTarget(i,5,r),e.render(t,d),e.setRenderTarget(h,p,m),e.xr.enabled=g,i.texture.needsPMREMUpdate=!0}}class fE extends Uo{constructor(e,t,i,r,s,o,a,l,c,d){super(e=void 0!==e?e:[],t=void 0!==t?t:Mu,i,r,s,o,a,l,c,d),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class dne extends hh{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];void 0!==t.encoding&&(Dv("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),t.colorSpace=t.encoding===lh?_i:""),this.texture=new fE(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:gi}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i_uniforms={tEquirect:{value:null}},i_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",r=new di(5,5,5),s=new hc({name:"CubemapFromEquirect",uniforms:Lm(i_uniforms),vertexShader:i_vertexShader,fragmentShader:i_fragmentShader,side:1,blending:0});s.uniforms.tEquirect.value=t;const o=new Me(r,s),a=t.minFilter;return t.minFilter===nc&&(t.minFilter=gi),new une(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,i,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,i,r);e.setRenderTarget(s)}}const fR=new N,hne=new N,fne=new Jt;class fc{constructor(e=new N(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=fR.subVectors(i,t).cross(hne.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(fR),r=this.normal.dot(i);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(i,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||fne.getNormalMatrix(e),r=this.coplanarPoint(fR).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const gh=new va,pE=new N;class pR{constructor(e=new fc,t=new fc,i=new fc,r=new fc,s=new fc,o=new fc){this.planes=[e,t,i,r,s,o]}set(e,t,i,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=rc){const i=this.planes,r=e.elements,s=r[0],o=r[1],a=r[2],l=r[3],c=r[4],d=r[5],h=r[6],p=r[7],m=r[8],g=r[9],v=r[10],w=r[11],y=r[12],b=r[13],x=r[14],E=r[15];if(i[0].setComponents(l-s,p-c,w-m,E-y).normalize(),i[1].setComponents(l+s,p+c,w+m,E+y).normalize(),i[2].setComponents(l+o,p+d,w+g,E+b).normalize(),i[3].setComponents(l-o,p-d,w-g,E-b).normalize(),i[4].setComponents(l-a,p-h,w-v,E-x).normalize(),t===rc)i[5].setComponents(l+a,p+h,w+v,E+x).normalize();else{if(2001!==t)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);i[5].setComponents(a,h,v,x).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),gh.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),gh.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(gh)}intersectsSprite(e){return gh.center.set(0,0,0),gh.radius=.7071067811865476,gh.applyMatrix4(e.matrixWorld),this.intersectsSphere(gh)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(pE.x=r.normal.x>0?e.max.x:e.min.x,pE.y=r.normal.y>0?e.max.y:e.min.y,pE.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(pE)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function az(){let n=null,e=!1,t=null,i=null;function r(s,o){t(s,o),i=n.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==t&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function pne(n,e){const t=e.isWebGL2,i=new WeakMap;return{get:function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),i.get(c)},remove:function a(c){c.isInterleavedBufferAttribute&&(c=c.data);const d=i.get(c);d&&(n.deleteBuffer(d.buffer),i.delete(c))},update:function l(c,d){if(c.isGLBufferAttribute){const p=i.get(c);return void((!p||p.version<c.version)&&i.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version}))}c.isInterleavedBufferAttribute&&(c=c.data);const h=i.get(c);void 0===h?i.set(c,function r(c,d){const h=c.array,p=c.usage,m=n.createBuffer();let g;if(n.bindBuffer(d,m),n.bufferData(d,h,p),c.onUploadCallback(),h instanceof Float32Array)g=n.FLOAT;else if(h instanceof Uint16Array)if(c.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");g=n.HALF_FLOAT}else g=n.UNSIGNED_SHORT;else if(h instanceof Int16Array)g=n.SHORT;else if(h instanceof Uint32Array)g=n.UNSIGNED_INT;else if(h instanceof Int32Array)g=n.INT;else if(h instanceof Int8Array)g=n.BYTE;else if(h instanceof Uint8Array)g=n.UNSIGNED_BYTE;else{if(!(h instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+h);g=n.UNSIGNED_BYTE}return{buffer:m,type:g,bytesPerElement:h.BYTES_PER_ELEMENT,version:c.version}}(c,d)):h.version<c.version&&(function s(c,d,h){const p=d.array,m=d.updateRange;n.bindBuffer(h,c),-1===m.count?n.bufferSubData(h,0,p):(t?n.bufferSubData(h,m.offset*p.BYTES_PER_ELEMENT,p,m.offset,m.count):n.bufferSubData(h,m.offset*p.BYTES_PER_ELEMENT,p.subarray(m.offset,m.offset+m.count)),m.count=-1),d.onUploadCallback()}(h.buffer,c,d),h.version=c.version)}}}class Um extends Ot{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(i),l=Math.floor(r),c=a+1,d=l+1,h=e/a,p=t/l,m=[],g=[],v=[],w=[];for(let y=0;y<d;y++){const b=y*p-o;for(let x=0;x<c;x++)g.push(x*h-s,-b,0),v.push(0,0,1),w.push(x/a),w.push(1-y/l)}for(let y=0;y<l;y++)for(let b=0;b<a;b++){const E=b+c*(y+1),C=b+1+c*(y+1),A=b+1+c*y;m.push(b+c*y,E,A),m.push(E,C,A)}this.setIndex(m),this.setAttribute("position",new Ke(g,3)),this.setAttribute("normal",new Ke(v,3)),this.setAttribute("uv",new Ke(w,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Um(e.width,e.height,e.widthSegments,e.heightSegments)}}const Yt={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"\nconst mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(\n\tvec3( 0.8224621, 0.177538, 0.0 ),\n\tvec3( 0.0331941, 0.9668058, 0.0 ),\n\tvec3( 0.0170827, 0.0723974, 0.9105199 )\n);\nconst mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.2249401, - 0.2249404, 0.0 ),\n\tvec3( - 0.0420569, 1.0420571, 0.0 ),\n\tvec3( - 0.0196376, - 0.0786361, 1.0982735 )\n);\nvec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );\n}\nvec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );\n}\nvec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn sRGBTransferOETF( value );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tanisotropyV /= material.anisotropy;\n\tmaterial.anisotropy = saturate( material.anisotropy );\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x - tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x + tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal;\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},Ge={common:{diffuse:{value:new We(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Jt},alphaMap:{value:null},alphaMapTransform:{value:new Jt},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Jt}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Jt}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Jt}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Jt},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Jt},normalScale:{value:new fe(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Jt},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Jt}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Jt}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Jt}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new We(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new We(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Jt},alphaTest:{value:0},uvTransform:{value:new Jt}},sprite:{diffuse:{value:new We(16777215)},opacity:{value:1},center:{value:new fe(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Jt},alphaMap:{value:null},alphaMapTransform:{value:new Jt},alphaTest:{value:0}}},sl={basic:{uniforms:Ss([Ge.common,Ge.specularmap,Ge.envmap,Ge.aomap,Ge.lightmap,Ge.fog]),vertexShader:Yt.meshbasic_vert,fragmentShader:Yt.meshbasic_frag},lambert:{uniforms:Ss([Ge.common,Ge.specularmap,Ge.envmap,Ge.aomap,Ge.lightmap,Ge.emissivemap,Ge.bumpmap,Ge.normalmap,Ge.displacementmap,Ge.fog,Ge.lights,{emissive:{value:new We(0)}}]),vertexShader:Yt.meshlambert_vert,fragmentShader:Yt.meshlambert_frag},phong:{uniforms:Ss([Ge.common,Ge.specularmap,Ge.envmap,Ge.aomap,Ge.lightmap,Ge.emissivemap,Ge.bumpmap,Ge.normalmap,Ge.displacementmap,Ge.fog,Ge.lights,{emissive:{value:new We(0)},specular:{value:new We(1118481)},shininess:{value:30}}]),vertexShader:Yt.meshphong_vert,fragmentShader:Yt.meshphong_frag},standard:{uniforms:Ss([Ge.common,Ge.envmap,Ge.aomap,Ge.lightmap,Ge.emissivemap,Ge.bumpmap,Ge.normalmap,Ge.displacementmap,Ge.roughnessmap,Ge.metalnessmap,Ge.fog,Ge.lights,{emissive:{value:new We(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Yt.meshphysical_vert,fragmentShader:Yt.meshphysical_frag},toon:{uniforms:Ss([Ge.common,Ge.aomap,Ge.lightmap,Ge.emissivemap,Ge.bumpmap,Ge.normalmap,Ge.displacementmap,Ge.gradientmap,Ge.fog,Ge.lights,{emissive:{value:new We(0)}}]),vertexShader:Yt.meshtoon_vert,fragmentShader:Yt.meshtoon_frag},matcap:{uniforms:Ss([Ge.common,Ge.bumpmap,Ge.normalmap,Ge.displacementmap,Ge.fog,{matcap:{value:null}}]),vertexShader:Yt.meshmatcap_vert,fragmentShader:Yt.meshmatcap_frag},points:{uniforms:Ss([Ge.points,Ge.fog]),vertexShader:Yt.points_vert,fragmentShader:Yt.points_frag},dashed:{uniforms:Ss([Ge.common,Ge.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Yt.linedashed_vert,fragmentShader:Yt.linedashed_frag},depth:{uniforms:Ss([Ge.common,Ge.displacementmap]),vertexShader:Yt.depth_vert,fragmentShader:Yt.depth_frag},normal:{uniforms:Ss([Ge.common,Ge.bumpmap,Ge.normalmap,Ge.displacementmap,{opacity:{value:1}}]),vertexShader:Yt.meshnormal_vert,fragmentShader:Yt.meshnormal_frag},sprite:{uniforms:Ss([Ge.sprite,Ge.fog]),vertexShader:Yt.sprite_vert,fragmentShader:Yt.sprite_frag},background:{uniforms:{uvTransform:{value:new Jt},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Yt.background_vert,fragmentShader:Yt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Yt.backgroundCube_vert,fragmentShader:Yt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Yt.cube_vert,fragmentShader:Yt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Yt.equirect_vert,fragmentShader:Yt.equirect_frag},distanceRGBA:{uniforms:Ss([Ge.common,Ge.displacementmap,{referencePosition:{value:new N},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Yt.distanceRGBA_vert,fragmentShader:Yt.distanceRGBA_frag},shadow:{uniforms:Ss([Ge.lights,Ge.fog,{color:{value:new We(0)},opacity:{value:1}}]),vertexShader:Yt.shadow_vert,fragmentShader:Yt.shadow_frag}};sl.physical={uniforms:Ss([sl.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Jt},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Jt},clearcoatNormalScale:{value:new fe(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Jt},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Jt},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Jt},sheen:{value:0},sheenColor:{value:new We(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Jt},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Jt},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Jt},transmissionSamplerSize:{value:new fe},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Jt},attenuationDistance:{value:0},attenuationColor:{value:new We(0)},specularColor:{value:new We(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Jt},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Jt},anisotropyVector:{value:new fe},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Jt}}]),vertexShader:Yt.meshphysical_vert,fragmentShader:Yt.meshphysical_frag};const mE={r:0,b:0,g:0};function hre(n,e,t,i,r,s,o){const a=new We(0);let c,d,l=!0===s?0:1,h=null,p=0,m=null;function v(w,y){w.getRGB(mE,oz(n)),i.buffers.color.setClear(mE.r,mE.g,mE.b,y,o)}return{getClearColor:function(){return a},setClearColor:function(w,y=1){a.set(w),l=y,v(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(w){l=w,v(a,l)},render:function g(w,y){let b=!1,x=!0===y.isScene?y.background:null;x&&x.isTexture&&(x=(y.backgroundBlurriness>0?t:e).get(x)),null===x?v(a,l):x&&x.isColor&&(v(x,1),b=!0);const E=n.xr.getEnvironmentBlendMode();"additive"===E?i.buffers.color.setClear(0,0,0,1,o):"alpha-blend"===E&&i.buffers.color.setClear(0,0,0,0,o),(n.autoClear||b)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),x&&(x.isCubeTexture||x.mapping===xv)?(void 0===d&&(d=new Me(new di(1,1,1),new hc({name:"BackgroundCubeMaterial",uniforms:Lm(sl.backgroundCube.uniforms),vertexShader:sl.backgroundCube.vertexShader,fragmentShader:sl.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),d.geometry.deleteAttribute("normal"),d.geometry.deleteAttribute("uv"),d.onBeforeRender=function(C,A,D){this.matrixWorld.copyPosition(D.matrixWorld)},Object.defineProperty(d.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(d)),d.material.uniforms.envMap.value=x,d.material.uniforms.flipEnvMap.value=x.isCubeTexture&&!1===x.isRenderTargetTexture?-1:1,d.material.uniforms.backgroundBlurriness.value=y.backgroundBlurriness,d.material.uniforms.backgroundIntensity.value=y.backgroundIntensity,d.material.toneMapped=Mn.getTransfer(x.colorSpace)!==ri,(h!==x||p!==x.version||m!==n.toneMapping)&&(d.material.needsUpdate=!0,h=x,p=x.version,m=n.toneMapping),d.layers.enableAll(),w.unshift(d,d.geometry,d.material,0,0,null)):x&&x.isTexture&&(void 0===c&&(c=new Me(new Um(2,2),new hc({name:"BackgroundMaterial",uniforms:Lm(sl.background.uniforms),vertexShader:sl.background.vertexShader,fragmentShader:sl.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=x,c.material.uniforms.backgroundIntensity.value=y.backgroundIntensity,c.material.toneMapped=Mn.getTransfer(x.colorSpace)!==ri,!0===x.matrixAutoUpdate&&x.updateMatrix(),c.material.uniforms.uvTransform.value.copy(x.matrix),(h!==x||p!==x.version||m!==n.toneMapping)&&(c.material.needsUpdate=!0,h=x,p=x.version,m=n.toneMapping),c.layers.enableAll(),w.unshift(c,c.geometry,c.material,0,0,null))}}}function fre(n,e,t,i){const r=n.getParameter(n.MAX_VERTEX_ATTRIBS),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),o=i.isWebGL2||null!==s,a={},l=w(null);let c=l,d=!1;function m(V){return i.isWebGL2?n.bindVertexArray(V):s.bindVertexArrayOES(V)}function g(V){return i.isWebGL2?n.deleteVertexArray(V):s.deleteVertexArrayOES(V)}function w(V){const J=[],G=[],X=[];for(let Q=0;Q<r;Q++)J[Q]=0,G[Q]=0,X[Q]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:J,enabledAttributes:G,attributeDivisors:X,object:V,attributes:{},index:null}}function x(){const V=c.newAttributes;for(let J=0,G=V.length;J<G;J++)V[J]=0}function E(V){C(V,0)}function C(V,J){const X=c.enabledAttributes,Q=c.attributeDivisors;c.newAttributes[V]=1,0===X[V]&&(n.enableVertexAttribArray(V),X[V]=1),Q[V]!==J&&((i.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](V,J),Q[V]=J)}function A(){const V=c.newAttributes,J=c.enabledAttributes;for(let G=0,X=J.length;G<X;G++)J[G]!==V[G]&&(n.disableVertexAttribArray(G),J[G]=0)}function D(V,J,G,X,Q,Z,le){!0===le?n.vertexAttribIPointer(V,J,G,Q,Z):n.vertexAttribPointer(V,J,G,X,Q,Z)}function ee(){se(),d=!0,c!==l&&(c=l,m(c.object))}function se(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function h(V,J,G,X,Q){let Z=!1;if(o){const le=function v(V,J,G){const X=!0===G.wireframe;let Q=a[V.id];void 0===Q&&(Q={},a[V.id]=Q);let Z=Q[J.id];void 0===Z&&(Z={},Q[J.id]=Z);let le=Z[X];return void 0===le&&(le=w(function p(){return i.isWebGL2?n.createVertexArray():s.createVertexArrayOES()}()),Z[X]=le),le}(X,G,J);c!==le&&(c=le,m(c.object)),Z=function y(V,J,G,X){const Q=c.attributes,Z=J.attributes;let le=0;const q=G.getAttributes();for(const oe in q)if(q[oe].location>=0){const ve=Q[oe];let Ne=Z[oe];if(void 0===Ne&&("instanceMatrix"===oe&&V.instanceMatrix&&(Ne=V.instanceMatrix),"instanceColor"===oe&&V.instanceColor&&(Ne=V.instanceColor)),void 0===ve||ve.attribute!==Ne||Ne&&ve.data!==Ne.data)return!0;le++}return c.attributesNum!==le||c.index!==X}(V,X,G,Q),Z&&function b(V,J,G,X){const Q={},Z=J.attributes;let le=0;const q=G.getAttributes();for(const oe in q)if(q[oe].location>=0){let ve=Z[oe];void 0===ve&&("instanceMatrix"===oe&&V.instanceMatrix&&(ve=V.instanceMatrix),"instanceColor"===oe&&V.instanceColor&&(ve=V.instanceColor));const Ne={};Ne.attribute=ve,ve&&ve.data&&(Ne.data=ve.data),Q[oe]=Ne,le++}c.attributes=Q,c.attributesNum=le,c.index=X}(V,X,G,Q)}else{const le=!0===J.wireframe;(c.geometry!==X.id||c.program!==G.id||c.wireframe!==le)&&(c.geometry=X.id,c.program=G.id,c.wireframe=le,Z=!0)}null!==Q&&t.update(Q,n.ELEMENT_ARRAY_BUFFER),(Z||d)&&(d=!1,function L(V,J,G,X){if(!1===i.isWebGL2&&(V.isInstancedMesh||X.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;x();const Q=X.attributes,Z=G.getAttributes(),le=J.defaultAttributeValues;for(const q in Z){const oe=Z[q];if(oe.location>=0){let Se=Q[q];if(void 0===Se&&("instanceMatrix"===q&&V.instanceMatrix&&(Se=V.instanceMatrix),"instanceColor"===q&&V.instanceColor&&(Se=V.instanceColor)),void 0!==Se){const ve=Se.normalized,Ne=Se.itemSize,$e=t.get(Se);if(void 0===$e)continue;const Be=$e.buffer,Xe=$e.type,gt=$e.bytesPerElement,At=!0===i.isWebGL2&&(Xe===n.INT||Xe===n.UNSIGNED_INT||1013===Se.gpuType);if(Se.isInterleavedBufferAttribute){const it=Se.data,z=it.stride,Oe=Se.offset;if(it.isInstancedInterleavedBuffer){for(let ye=0;ye<oe.locationSize;ye++)C(oe.location+ye,it.meshPerAttribute);!0!==V.isInstancedMesh&&void 0===X._maxInstanceCount&&(X._maxInstanceCount=it.meshPerAttribute*it.count)}else for(let ye=0;ye<oe.locationSize;ye++)E(oe.location+ye);n.bindBuffer(n.ARRAY_BUFFER,Be);for(let ye=0;ye<oe.locationSize;ye++)D(oe.location+ye,Ne/oe.locationSize,Xe,ve,z*gt,(Oe+Ne/oe.locationSize*ye)*gt,At)}else{if(Se.isInstancedBufferAttribute){for(let it=0;it<oe.locationSize;it++)C(oe.location+it,Se.meshPerAttribute);!0!==V.isInstancedMesh&&void 0===X._maxInstanceCount&&(X._maxInstanceCount=Se.meshPerAttribute*Se.count)}else for(let it=0;it<oe.locationSize;it++)E(oe.location+it);n.bindBuffer(n.ARRAY_BUFFER,Be);for(let it=0;it<oe.locationSize;it++)D(oe.location+it,Ne/oe.locationSize,Xe,ve,Ne*gt,Ne/oe.locationSize*it*gt,At)}}else if(void 0!==le){const ve=le[q];if(void 0!==ve)switch(ve.length){case 2:n.vertexAttrib2fv(oe.location,ve);break;case 3:n.vertexAttrib3fv(oe.location,ve);break;case 4:n.vertexAttrib4fv(oe.location,ve);break;default:n.vertexAttrib1fv(oe.location,ve)}}}}A()}(V,J,G,X),null!==Q&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.get(Q).buffer))},reset:ee,resetDefaultState:se,dispose:function M(){ee();for(const V in a){const J=a[V];for(const G in J){const X=J[G];for(const Q in X)g(X[Q].object),delete X[Q];delete J[G]}delete a[V]}},releaseStatesOfGeometry:function R(V){if(void 0===a[V.id])return;const J=a[V.id];for(const G in J){const X=J[G];for(const Q in X)g(X[Q].object),delete X[Q];delete J[G]}delete a[V.id]},releaseStatesOfProgram:function $(V){for(const J in a){const G=a[J];if(void 0===G[V.id])continue;const X=G[V.id];for(const Q in X)g(X[Q].object),delete X[Q];delete G[V.id]}},initAttributes:x,enableAttribute:E,disableUnusedAttributes:A}}function pre(n,e,t,i){const r=i.isWebGL2;let s;this.setMode=function o(c){s=c},this.render=function a(c,d){n.drawArrays(s,c,d),t.update(d,s,1)},this.renderInstances=function l(c,d,h){if(0===h)return;let p,m;if(r)p=n,m="drawArraysInstanced";else if(p=e.get("ANGLE_instanced_arrays"),m="drawArraysInstancedANGLE",null===p)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");p[m](s,c,d,h),t.update(d,s,h)}}function mre(n,e,t){let i;function s(D){if("highp"===D){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";D="mediump"}return"mediump"===D&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&"WebGL2RenderingContext"===n.constructor.name;let a=void 0!==t.precision?t.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const c=o||e.has("WEBGL_draw_buffers"),d=!0===t.logarithmicDepthBuffer,h=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),p=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),m=n.getParameter(n.MAX_TEXTURE_SIZE),g=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),v=n.getParameter(n.MAX_VERTEX_ATTRIBS),w=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),y=n.getParameter(n.MAX_VARYING_VECTORS),b=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),x=p>0,E=o||e.has("OES_texture_float");return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:function r(){if(void 0!==i)return i;if(!0===e.has("EXT_texture_filter_anisotropic")){const D=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(D.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:s,precision:a,logarithmicDepthBuffer:d,maxTextures:h,maxVertexTextures:p,maxTextureSize:m,maxCubemapSize:g,maxAttributes:v,maxVertexUniforms:w,maxVaryings:y,maxFragmentUniforms:b,vertexTextures:x,floatFragmentTextures:E,floatVertexTextures:x&&E,maxSamples:o?n.getParameter(n.MAX_SAMPLES):0}}function gre(n){const e=this;let t=null,i=0,r=!1,s=!1;const o=new fc,a=new Jt,l={value:null,needsUpdate:!1};function d(h,p,m,g){const v=null!==h?h.length:0;let w=null;if(0!==v){if(w=l.value,!0!==g||null===w){const y=m+4*v,b=p.matrixWorldInverse;a.getNormalMatrix(b),(null===w||w.length<y)&&(w=new Float32Array(y));for(let x=0,E=m;x!==v;++x,E+=4)o.copy(h[x]).applyMatrix4(b,a),o.normal.toArray(w,E),w[E+3]=o.constant}l.value=w,l.needsUpdate=!0}return e.numPlanes=v,e.numIntersection=0,w}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(h,p){const m=0!==h.length||p||0!==i||r;return r=p,i=h.length,m},this.beginShadows=function(){s=!0,d(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(h,p){t=d(h,p,0)},this.setState=function(h,p,m){const g=h.clippingPlanes,v=h.clipIntersection,w=h.clipShadows,y=n.get(h);if(!r||null===g||0===g.length||s&&!w)s?d(null):function c(){l.value!==t&&(l.value=t,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}();else{const b=s?0:i,x=4*b;let E=y.clippingState||null;l.value=E,E=d(g,p,x,m);for(let C=0;C!==x;++C)E[C]=t[C];y.clippingState=E,this.numIntersection=v?this.numPlanes:0,this.numPlanes+=b}}}function _re(n){let e=new WeakMap;function t(o,a){return 303===a?o.mapping=Mu:304===a&&(o.mapping=rh),o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=e.get(a);void 0!==l&&(e.delete(a),l.dispose())}return{get:function i(o){if(o&&o.isTexture&&!1===o.isRenderTargetTexture){const a=o.mapping;if(303===a||304===a){if(e.has(o))return t(e.get(o).texture,o.mapping);{const l=o.image;if(l&&l.height>0){const c=new dne(l.height/2);return c.fromEquirectangularTexture(n,o),e.set(o,c),o.addEventListener("dispose",r),t(c.texture,o.mapping)}return null}}}return o},dispose:function s(){e=new WeakMap}}}class gE extends hR{constructor(e=-1,t=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,s,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,o=i+e,a=r+t,l=r-t;if(null!==this.view&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,d=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=d*this.view.offsetY,l=a-d*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const lz=[.125,.215,.35,.446,.526,.582],mR=new gE,cz=new We;let gR=null;const yh=(1+Math.sqrt(5))/2,Vm=1/yh,uz=[new N(1,1,1),new N(-1,1,1),new N(1,1,-1),new N(-1,1,-1),new N(0,yh,Vm),new N(0,yh,-Vm),new N(Vm,0,yh),new N(-Vm,0,yh),new N(yh,Vm,0),new N(-yh,Vm,0)];class _R{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){gR=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=fz(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=hz(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(gR),e.scissorTest=!1,_E(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(e.mapping===Mu||e.mapping===rh?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),gR=this._renderer.getRenderTarget();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:gi,minFilter:gi,generateMipmaps:!1,type:Cv,format:Fo,colorSpace:Lr,depthBuffer:!1},r=dz(e,t,i);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=dz(e,t,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function yre(n){const e=[],t=[],i=[];let r=n;const s=n-4+1+lz.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let l=1/a;o>n-4?l=lz[o-n+4-1]:0===o&&(l=0),i.push(l);const c=1/(a-2),d=-c,h=1+c,p=[d,d,h,d,h,h,d,d,h,h,d,h],m=6,g=6,v=3,w=2,y=1,b=new Float32Array(v*g*m),x=new Float32Array(w*g*m),E=new Float32Array(y*g*m);for(let A=0;A<m;A++){const D=A%3*2/3-1,L=A>2?0:-1;b.set([D,L,0,D+2/3,L,0,D+2/3,L+1,0,D,L,0,D+2/3,L+1,0,D,L+1,0],v*g*A),x.set(p,w*g*A),E.set([A,A,A,A,A,A],y*g*A)}const C=new Ot;C.setAttribute("position",new Jn(b,v)),C.setAttribute("uv",new Jn(x,w)),C.setAttribute("faceIndex",new Jn(E,y)),e.push(C),r>4&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}(s)),this._blurMaterial=function vre(n,e,t){const i=new Float32Array(20),r=new N(0,1,0);return new hc({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(s,e,t)}return r}_compileMaterial(e){const t=new Me(this._lodPlanes[0],e);this._renderer.compile(t,mR)}_sceneToCubeUV(e,t,i,r){const a=new cr(90,1,t,i),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],d=this._renderer,h=d.autoClear,p=d.toneMapping;d.getClearColor(cz),d.toneMapping=Cu,d.autoClear=!1;const m=new Mi({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),g=new Me(new di,m);let v=!1;const w=e.background;w?w.isColor&&(m.color.copy(w),e.background=null,v=!0):(m.color.copy(cz),v=!0);for(let y=0;y<6;y++){const b=y%3;0===b?(a.up.set(0,l[y],0),a.lookAt(c[y],0,0)):1===b?(a.up.set(0,0,l[y]),a.lookAt(0,c[y],0)):(a.up.set(0,l[y],0),a.lookAt(0,0,c[y]));const x=this._cubeSize;_E(r,b*x,y>2?x:0,x,x),d.setRenderTarget(r),v&&d.render(g,a),d.render(e,a)}g.geometry.dispose(),g.material.dispose(),d.toneMapping=p,d.autoClear=h,e.background=w}_textureToCubeUV(e,t){const i=this._renderer,r=e.mapping===Mu||e.mapping===rh;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=fz()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=hz());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new Me(this._lodPlanes[0],s);s.uniforms.envMap.value=e;const l=this._cubeSize;_E(t,0,0,3*l,2*l),i.setRenderTarget(t),i.render(o,mR)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]);this._blur(e,r-1,r,s,uz[(r-1)%uz.length])}t.autoClear=i}_blur(e,t,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,o,a){const l=this._renderer,c=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const h=new Me(this._lodPlanes[r],c),p=c.uniforms,m=this._sizeLods[i]-1,g=isFinite(s)?Math.PI/(2*m):2*Math.PI/39,v=s/g,w=isFinite(s)?1+Math.floor(3*v):20;w>20&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${w} samples when the maximum is set to 20`);const y=[];let b=0;for(let D=0;D<20;++D){const L=D/v,M=Math.exp(-L*L/2);y.push(M),0===D?b+=M:D<w&&(b+=2*M)}for(let D=0;D<y.length;D++)y[D]=y[D]/b;p.envMap.value=e.texture,p.samples.value=w,p.weights.value=y,p.latitudinal.value="latitudinal"===o,a&&(p.poleAxis.value=a);const{_lodMax:x}=this;p.dTheta.value=g,p.mipInt.value=x-i;const E=this._sizeLods[r];_E(t,3*E*(r>x-4?r-x+4:0),4*(this._cubeSize-E),3*E,2*E),l.setRenderTarget(t),l.render(h,mR)}}function dz(n,e,t){const i=new hh(n,e,t);return i.texture.mapping=xv,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function _E(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function hz(){return new hc({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function fz(){return new hc({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function wre(n){let e=new WeakMap,t=null;function s(a){const l=a.target;l.removeEventListener("dispose",s);const c=e.get(l);void 0!==c&&(e.delete(l),c.dispose())}return{get:function i(a){if(a&&a.isTexture){const l=a.mapping,c=303===l||304===l,d=l===Mu||l===rh;if(c||d){if(a.isRenderTargetTexture&&!0===a.needsPMREMUpdate){a.needsPMREMUpdate=!1;let h=e.get(a);return null===t&&(t=new _R(n)),h=c?t.fromEquirectangular(a,h):t.fromCubemap(a,h),e.set(a,h),h.texture}if(e.has(a))return e.get(a).texture;{const h=a.image;if(c&&h&&h.height>0||d&&h&&function r(a){let l=0;for(let d=0;d<6;d++)void 0!==a[d]&&l++;return 6===l}(h)){null===t&&(t=new _R(n));const p=c?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,p),a.addEventListener("dispose",s),p.texture}return null}}}return a},dispose:function o(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function bre(n){const e={};function t(i){if(void 0!==e[i])return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return null!==t(i)},init:function(i){i.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){const r=t(i);return null===r&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function xre(n,e,t,i){const r={},s=new WeakMap;function o(h){const p=h.target;null!==p.index&&e.remove(p.index);for(const g in p.attributes)e.remove(p.attributes[g]);for(const g in p.morphAttributes){const v=p.morphAttributes[g];for(let w=0,y=v.length;w<y;w++)e.remove(v[w])}p.removeEventListener("dispose",o),delete r[p.id];const m=s.get(p);m&&(e.remove(m),s.delete(p)),i.releaseStatesOfGeometry(p),!0===p.isInstancedBufferGeometry&&delete p._maxInstanceCount,t.memory.geometries--}function c(h){const p=[],m=h.index,g=h.attributes.position;let v=0;if(null!==m){const b=m.array;v=m.version;for(let x=0,E=b.length;x<E;x+=3){const C=b[x+0],A=b[x+1],D=b[x+2];p.push(C,A,A,D,D,C)}}else{if(void 0===g)return;v=g.version;for(let x=0,E=g.array.length/3-1;x<E;x+=3){const C=x+0,A=x+1,D=x+2;p.push(C,A,A,D,D,C)}}const w=new(kH(p)?ez:QH)(p,1);w.version=v;const y=s.get(h);y&&e.remove(y),s.set(h,w)}return{get:function a(h,p){return!0===r[p.id]||(p.addEventListener("dispose",o),r[p.id]=!0,t.memory.geometries++),p},update:function l(h){const p=h.attributes;for(const g in p)e.update(p[g],n.ARRAY_BUFFER);const m=h.morphAttributes;for(const g in m){const v=m[g];for(let w=0,y=v.length;w<y;w++)e.update(v[w],n.ARRAY_BUFFER)}},getWireframeAttribute:function d(h){const p=s.get(h);if(p){const m=h.index;null!==m&&p.version<m.version&&c(h)}else c(h);return s.get(h)}}}function Sre(n,e,t,i){const r=i.isWebGL2;let s,a,l;this.setMode=function o(p){s=p},this.setIndex=function c(p){a=p.type,l=p.bytesPerElement},this.render=function d(p,m){n.drawElements(s,m,a,p*l),t.update(m,s,1)},this.renderInstances=function h(p,m,g){if(0===g)return;let v,w;if(r)v=n,w="drawElementsInstanced";else if(v=e.get("ANGLE_instanced_arrays"),w="drawElementsInstancedANGLE",null===v)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");v[w](s,m,a,p*l,g),t.update(m,s,g)}}function Ere(n){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function i(s,o,a){switch(t.calls++,o){case n.TRIANGLES:t.triangles+=a*(s/3);break;case n.LINES:t.lines+=a*(s/2);break;case n.LINE_STRIP:t.lines+=a*(s-1);break;case n.LINE_LOOP:t.lines+=a*s;break;case n.POINTS:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o)}}}}function Cre(n,e){return n[0]-e[0]}function Mre(n,e){return Math.abs(e[1])-Math.abs(n[1])}function Tre(n,e,t){const i={},r=new Float32Array(8),s=new WeakMap,o=new Ln,a=[];for(let c=0;c<8;c++)a[c]=[c,0];return{update:function l(c,d,h){const p=c.morphTargetInfluences;if(!0===e.isWebGL2){const m=d.morphAttributes.position||d.morphAttributes.normal||d.morphAttributes.color,g=void 0!==m?m.length:0;let v=s.get(d);if(void 0===v||v.count!==g){let V=function(){ee.dispose(),s.delete(d),d.removeEventListener("dispose",V)};void 0!==v&&v.texture.dispose();const b=void 0!==d.morphAttributes.position,x=void 0!==d.morphAttributes.normal,E=void 0!==d.morphAttributes.color,C=d.morphAttributes.position||[],A=d.morphAttributes.normal||[],D=d.morphAttributes.color||[];let L=0;!0===b&&(L=1),!0===x&&(L=2),!0===E&&(L=3);let M=d.attributes.position.count*L,R=1;M>e.maxTextureSize&&(R=Math.ceil(M/e.maxTextureSize),M=e.maxTextureSize);const $=new Float32Array(M*R*4*g),ee=new ZI($,M,R,g);ee.type=ic,ee.needsUpdate=!0;const se=4*L;for(let J=0;J<g;J++){const G=C[J],X=A[J],Q=D[J],Z=M*R*4*J;for(let le=0;le<G.count;le++){const q=le*se;!0===b&&(o.fromBufferAttribute(G,le),$[Z+q+0]=o.x,$[Z+q+1]=o.y,$[Z+q+2]=o.z,$[Z+q+3]=0),!0===x&&(o.fromBufferAttribute(X,le),$[Z+q+4]=o.x,$[Z+q+5]=o.y,$[Z+q+6]=o.z,$[Z+q+7]=0),!0===E&&(o.fromBufferAttribute(Q,le),$[Z+q+8]=o.x,$[Z+q+9]=o.y,$[Z+q+10]=o.z,$[Z+q+11]=4===Q.itemSize?o.w:1)}}v={count:g,texture:ee,size:new fe(M,R)},s.set(d,v),d.addEventListener("dispose",V)}let w=0;for(let b=0;b<p.length;b++)w+=p[b];const y=d.morphTargetsRelative?1:1-w;h.getUniforms().setValue(n,"morphTargetBaseInfluence",y),h.getUniforms().setValue(n,"morphTargetInfluences",p),h.getUniforms().setValue(n,"morphTargetsTexture",v.texture,t),h.getUniforms().setValue(n,"morphTargetsTextureSize",v.size)}else{const m=void 0===p?0:p.length;let g=i[d.id];if(void 0===g||g.length!==m){g=[];for(let x=0;x<m;x++)g[x]=[x,0];i[d.id]=g}for(let x=0;x<m;x++){const E=g[x];E[0]=x,E[1]=p[x]}g.sort(Mre);for(let x=0;x<8;x++)x<m&&g[x][1]?(a[x][0]=g[x][0],a[x][1]=g[x][1]):(a[x][0]=Number.MAX_SAFE_INTEGER,a[x][1]=0);a.sort(Cre);const v=d.morphAttributes.position,w=d.morphAttributes.normal;let y=0;for(let x=0;x<8;x++){const E=a[x],C=E[0],A=E[1];C!==Number.MAX_SAFE_INTEGER&&A?(v&&d.getAttribute("morphTarget"+x)!==v[C]&&d.setAttribute("morphTarget"+x,v[C]),w&&d.getAttribute("morphNormal"+x)!==w[C]&&d.setAttribute("morphNormal"+x,w[C]),r[x]=A,y+=A):(v&&!0===d.hasAttribute("morphTarget"+x)&&d.deleteAttribute("morphTarget"+x),w&&!0===d.hasAttribute("morphNormal"+x)&&d.deleteAttribute("morphNormal"+x),r[x]=0)}const b=d.morphTargetsRelative?1:1-y;h.getUniforms().setValue(n,"morphTargetBaseInfluence",b),h.getUniforms().setValue(n,"morphTargetInfluences",r)}}}}function Are(n,e,t,i){let r=new WeakMap;function a(l){const c=l.target;c.removeEventListener("dispose",a),t.remove(c.instanceMatrix),null!==c.instanceColor&&t.remove(c.instanceColor)}return{update:function s(l){const c=i.render.frame,h=e.get(l,l.geometry);if(r.get(h)!==c&&(e.update(h),r.set(h,c)),l.isInstancedMesh&&(!1===l.hasEventListener("dispose",a)&&l.addEventListener("dispose",a),r.get(l)!==c&&(t.update(l.instanceMatrix,n.ARRAY_BUFFER),null!==l.instanceColor&&t.update(l.instanceColor,n.ARRAY_BUFFER),r.set(l,c))),l.isSkinnedMesh){const p=l.skeleton;r.get(p)!==c&&(p.update(),r.set(p,c))}return h},dispose:function o(){r=new WeakMap}}}const pz=new Uo,mz=new ZI,gz=new zH,_z=new fE,yz=[],vz=[],wz=new Float32Array(16),bz=new Float32Array(9),xz=new Float32Array(4);function Hm(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let s=yz[r];if(void 0===s&&(s=new Float32Array(r),yz[r]=s),0!==e){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function ur(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function dr(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function yE(n,e){let t=vz[e];void 0===t&&(t=new Int32Array(e),vz[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function Dre(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function Ire(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ur(t,e))return;n.uniform2fv(this.addr,e),dr(t,e)}}function Rre(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(ur(t,e))return;n.uniform3fv(this.addr,e),dr(t,e)}}function Pre(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ur(t,e))return;n.uniform4fv(this.addr,e),dr(t,e)}}function Nre(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(ur(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),dr(t,e)}else{if(ur(t,i))return;xz.set(i),n.uniformMatrix2fv(this.addr,!1,xz),dr(t,i)}}function Ore(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(ur(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),dr(t,e)}else{if(ur(t,i))return;bz.set(i),n.uniformMatrix3fv(this.addr,!1,bz),dr(t,i)}}function Lre(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(ur(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),dr(t,e)}else{if(ur(t,i))return;wz.set(i),n.uniformMatrix4fv(this.addr,!1,wz),dr(t,i)}}function Fre(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function kre(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ur(t,e))return;n.uniform2iv(this.addr,e),dr(t,e)}}function Ure(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(ur(t,e))return;n.uniform3iv(this.addr,e),dr(t,e)}}function Bre(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ur(t,e))return;n.uniform4iv(this.addr,e),dr(t,e)}}function Vre(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function Hre(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ur(t,e))return;n.uniform2uiv(this.addr,e),dr(t,e)}}function zre(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(ur(t,e))return;n.uniform3uiv(this.addr,e),dr(t,e)}}function Gre(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ur(t,e))return;n.uniform4uiv(this.addr,e),dr(t,e)}}function Wre(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2D(e||pz,r)}function jre(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||gz,r)}function $re(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||_z,r)}function qre(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||mz,r)}function Yre(n,e){n.uniform1fv(this.addr,e)}function Kre(n,e){const t=Hm(e,this.size,2);n.uniform2fv(this.addr,t)}function Zre(n,e){const t=Hm(e,this.size,3);n.uniform3fv(this.addr,t)}function Jre(n,e){const t=Hm(e,this.size,4);n.uniform4fv(this.addr,t)}function Qre(n,e){const t=Hm(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function ese(n,e){const t=Hm(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function tse(n,e){const t=Hm(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function nse(n,e){n.uniform1iv(this.addr,e)}function ise(n,e){n.uniform2iv(this.addr,e)}function rse(n,e){n.uniform3iv(this.addr,e)}function sse(n,e){n.uniform4iv(this.addr,e)}function ose(n,e){n.uniform1uiv(this.addr,e)}function ase(n,e){n.uniform2uiv(this.addr,e)}function lse(n,e){n.uniform3uiv(this.addr,e)}function cse(n,e){n.uniform4uiv(this.addr,e)}function use(n,e,t){const i=this.cache,r=e.length,s=yE(t,r);ur(i,s)||(n.uniform1iv(this.addr,s),dr(i,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||pz,s[o])}function dse(n,e,t){const i=this.cache,r=e.length,s=yE(t,r);ur(i,s)||(n.uniform1iv(this.addr,s),dr(i,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||gz,s[o])}function hse(n,e,t){const i=this.cache,r=e.length,s=yE(t,r);ur(i,s)||(n.uniform1iv(this.addr,s),dr(i,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||_z,s[o])}function fse(n,e,t){const i=this.cache,r=e.length,s=yE(t,r);ur(i,s)||(n.uniform1iv(this.addr,s),dr(i,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||mz,s[o])}class mse{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.setValue=function Xre(n){switch(n){case 5126:return Dre;case 35664:return Ire;case 35665:return Rre;case 35666:return Pre;case 35674:return Nre;case 35675:return Ore;case 35676:return Lre;case 5124:case 35670:return Fre;case 35667:case 35671:return kre;case 35668:case 35672:return Ure;case 35669:case 35673:return Bre;case 5125:return Vre;case 36294:return Hre;case 36295:return zre;case 36296:return Gre;case 35678:case 36198:case 36298:case 36306:case 35682:return Wre;case 35679:case 36299:case 36307:return jre;case 35680:case 36300:case 36308:case 36293:return $re;case 36289:case 36303:case 36311:case 36292:return qre}}(t.type)}}class gse{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.size=t.size,this.setValue=function pse(n){switch(n){case 5126:return Yre;case 35664:return Kre;case 35665:return Zre;case 35666:return Jre;case 35674:return Qre;case 35675:return ese;case 35676:return tse;case 5124:case 35670:return nse;case 35667:case 35671:return ise;case 35668:case 35672:return rse;case 35669:case 35673:return sse;case 5125:return ose;case 36294:return ase;case 36295:return lse;case 36296:return cse;case 35678:case 36198:case 36298:case 36306:case 35682:return use;case 35679:case 36299:case 36307:return dse;case 35680:case 36300:case 36308:case 36293:return hse;case 36289:case 36303:case 36311:case 36292:return fse}}(t.type)}}class _se{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,t[a.id],i)}}}const vR=/(\w+)(\])?(\[|\.)?/g;function Sz(n,e){n.seq.push(e),n.map[e.id]=e}function yse(n,e,t){const i=n.name,r=i.length;for(vR.lastIndex=0;;){const s=vR.exec(i);let a=s[1];const c=s[3];if("]"===s[2]&&(a|=0),void 0===c||"["===c&&vR.lastIndex+2===r){Sz(t,void 0===c?new mse(a,n,e):new gse(a,n,e));break}{let h=t.map[a];void 0===h&&(h=new _se(a),Sz(t,h)),t=h}}}class vE{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<i;++r){const s=e.getActiveUniform(t,r);yse(s,e.getUniformLocation(t,s.name),this)}}setValue(e,t,i,r){const s=this.map[t];void 0!==s&&s.setValue(e,i,r)}setOptional(e,t,i){const r=t[i];void 0!==r&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let s=0,o=t.length;s!==o;++s){const a=t[s],l=i[a.id];!1!==l.needsUpdate&&a.setValue(e,l.value,r)}}static seqWithValue(e,t){const i=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&i.push(o)}return i}}function Ez(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}let vse=0;function Cz(n,e,t){const i=n.getShaderParameter(e,n.COMPILE_STATUS),r=n.getShaderInfoLog(e).trim();if(i&&""===r)return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return t.toUpperCase()+"\n\n"+r+"\n\n"+function wse(n,e){const t=n.split("\n"),i=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const a=o+1;i.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return i.join("\n")}(n.getShaderSource(e),o)}return r}function xse(n,e){const t=function bse(n){const e=Mn.getPrimaries(Mn.workingColorSpace),t=Mn.getPrimaries(n);let i;switch(e===t?i="":e===jS&&t===WS?i="LinearDisplayP3ToLinearSRGB":e===WS&&t===jS&&(i="LinearSRGBToLinearDisplayP3"),n){case Lr:case zS:return[i,"LinearTransferOETF"];case _i:case GI:return[i,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",n),[i,"LinearTransferOETF"]}}(e);return`vec4 ${n}( vec4 value ) { return ${t[0]}( ${t[1]}( value ) ); }`}function Sse(n,e){let t;switch(e){case Qee:t="Linear";break;case ete:t="Reinhard";break;case tte:t="OptimizedCineon";break;case nte:t="ACESFilmic";break;case ite:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function Lv(n){return""!==n}function Mz(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Tz(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Tse=/^[ \t]*#include +<([\w\d./]+)>/gm;function wR(n){return n.replace(Tse,Dse)}const Ase=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function Dse(n,e){let t=Yt[e];if(void 0===t){const i=Ase.get(e);if(void 0===i)throw new Error("Can not resolve #include <"+e+">");t=Yt[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i)}return wR(t)}const Ise=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Az(n){return n.replace(Ise,Rse)}function Rse(n,e,t,i){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function Dz(n){let e="precision "+n.precision+" float;\nprecision "+n.precision+" int;";return"highp"===n.precision?e+="\n#define HIGH_PRECISION":"mediump"===n.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===n.precision&&(e+="\n#define LOW_PRECISION"),e}function kse(n,e,t,i){const r=n.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=function Pse(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===$V?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===Ree?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===ec&&(e="SHADOWMAP_TYPE_VSM"),e}(t),c=function Nse(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case Mu:case rh:e="ENVMAP_TYPE_CUBE";break;case xv:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),d=function Ose(n){let e="ENVMAP_MODE_REFLECTION";return n.envMap&&n.envMapMode===rh&&(e="ENVMAP_MODE_REFRACTION"),e}(t),h=function Lse(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case kS:e="ENVMAP_BLENDING_MULTIPLY";break;case Zee:e="ENVMAP_BLENDING_MIX";break;case Jee:e="ENVMAP_BLENDING_ADD"}return e}(t),p=function Fse(n){const e=n.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:i,maxMip:t}}(t),m=t.isWebGL2?"":function Ese(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.normalMapTangentSpace||n.clearcoatNormalMap||n.flatShading||"physical"===n.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Lv).join("\n")}(t),g=function Cse(n){const e=[];for(const t in n){const i=n[t];!1!==i&&e.push("#define "+t+" "+i)}return e.join("\n")}(s),v=r.createProgram();let w,y,b=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(w=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,g].filter(Lv).join("\n"),w.length>0&&(w+="\n"),y=[m,"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,g].filter(Lv).join("\n"),y.length>0&&(y+="\n")):(w=[Dz(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,g,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+d:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Lv).join("\n"),y=[m,Dz(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,g,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+d:"",t.envMap?"#define "+h:"",p?"#define CUBEUV_TEXEL_WIDTH "+p.texelWidth:"",p?"#define CUBEUV_TEXEL_HEIGHT "+p.texelHeight:"",p?"#define CUBEUV_MAX_MIP "+p.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Cu?"#define TONE_MAPPING":"",t.toneMapping!==Cu?Yt.tonemapping_pars_fragment:"",t.toneMapping!==Cu?Sse("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Yt.colorspace_pars_fragment,xse("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(Lv).join("\n")),o=wR(o),o=Mz(o,t),o=Tz(o,t),a=wR(a),a=Mz(a,t),a=Tz(a,t),o=Az(o),a=Az(a),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(b="#version 300 es\n",w=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+w,y=["#define varying in",t.glslVersion===OH?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===OH?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+y);const E=b+y+a,C=Ez(r,r.VERTEX_SHADER,b+w+o),A=Ez(r,r.FRAGMENT_SHADER,E);if(r.attachShader(v,C),r.attachShader(v,A),void 0!==t.index0AttributeName?r.bindAttribLocation(v,0,t.index0AttributeName):!0===t.morphTargets&&r.bindAttribLocation(v,0,"position"),r.linkProgram(v),n.debug.checkShaderErrors){const M=r.getProgramInfoLog(v).trim(),R=r.getShaderInfoLog(C).trim(),$=r.getShaderInfoLog(A).trim();let ee=!0,se=!0;if(!1===r.getProgramParameter(v,r.LINK_STATUS))if(ee=!1,"function"==typeof n.debug.onShaderError)n.debug.onShaderError(r,v,C,A);else{const V=Cz(r,C,"vertex"),J=Cz(r,A,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(v,r.VALIDATE_STATUS)+"\n\nProgram Info Log: "+M+"\n"+V+"\n"+J)}else""!==M?console.warn("THREE.WebGLProgram: Program Info Log:",M):(""===R||""===$)&&(se=!1);se&&(this.diagnostics={runnable:ee,programLog:M,vertexShader:{log:R,prefix:w},fragmentShader:{log:$,prefix:y}})}let D,L;return r.deleteShader(C),r.deleteShader(A),this.getUniforms=function(){return void 0===D&&(D=new vE(r,v)),D},this.getAttributes=function(){return void 0===L&&(L=function Mse(n,e){const t={},i=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const s=n.getActiveAttrib(e,r),o=s.name;let a=1;s.type===n.FLOAT_MAT2&&(a=2),s.type===n.FLOAT_MAT3&&(a=3),s.type===n.FLOAT_MAT4&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}(r,v)),L},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(v),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=vse++,this.cacheKey=e,this.usedTimes=1,this.program=v,this.vertexShader=C,this.fragmentShader=A,this}let Use=0;class Bse{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.fragmentShader,r=this._getShaderStage(e.vertexShader),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return!1===o.has(r)&&(o.add(r),r.usedTimes++),!1===o.has(s)&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,0===i.usedTimes&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return void 0===i&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return void 0===i&&(i=new Vse(e),t.set(e,i)),i}}class Vse{constructor(e){this.id=Use++,this.code=e,this.usedTimes=0}}function Hse(n,e,t,i,r,s,o){const a=new rR,l=new Bse,c=[],d=r.isWebGL2,h=r.logarithmicDepthBuffer,p=r.vertexTextures;let m=r.precision;const g={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function v(M){return 0===M?"uv":`uv${M}`}return{getParameters:function w(M,R,$,ee,se){const V=ee.fog,J=se.geometry,X=(M.isMeshStandardMaterial?t:e).get(M.envMap||(M.isMeshStandardMaterial?ee.environment:null)),Q=X&&X.mapping===xv?X.image.height:null,Z=g[M.type];null!==M.precision&&(m=r.getMaxPrecision(M.precision),m!==M.precision&&console.warn("THREE.WebGLProgram.getParameters:",M.precision,"not supported, using",m,"instead."));const le=J.morphAttributes.position||J.morphAttributes.normal||J.morphAttributes.color,q=void 0!==le?le.length:0;let Se,ve,Ne,$e,oe=0;if(void 0!==J.morphAttributes.position&&(oe=1),void 0!==J.morphAttributes.normal&&(oe=2),void 0!==J.morphAttributes.color&&(oe=3),Z){const ci=sl[Z];Se=ci.vertexShader,ve=ci.fragmentShader}else Se=M.vertexShader,ve=M.fragmentShader,l.update(M),Ne=l.getVertexShaderID(M),$e=l.getFragmentShaderID(M);const Be=n.getRenderTarget(),Xe=!0===se.isInstancedMesh,gt=!!M.map,it=!!X,z=!!M.aoMap,Oe=!!M.lightMap,ye=!!M.bumpMap,Ae=!!M.normalMap,xe=!!M.displacementMap,lt=!!M.emissiveMap,Ze=!!M.metalnessMap,et=!!M.roughnessMap,Mt=M.anisotropy>0,sn=M.clearcoat>0,fi=M.iridescence>0,k=M.sheen>0,P=M.transmission>0,ie=Mt&&!!M.anisotropyMap,Te=sn&&!!M.clearcoatMap,Ce=sn&&!!M.clearcoatNormalMap,De=sn&&!!M.clearcoatRoughnessMap,ot=fi&&!!M.iridescenceMap,Ie=fi&&!!M.iridescenceThicknessMap,qe=k&&!!M.sheenColorMap,W=k&&!!M.sheenRoughnessMap,Re=!!M.specularMap,we=!!M.specularColorMap,Dt=!!M.specularIntensityMap,ct=P&&!!M.transmissionMap,_t=P&&!!M.thicknessMap,H=!!M.alphaMap,je=!!M.extensions,ke=!!J.attributes.uv1,Ee=!!J.attributes.uv2,st=!!J.attributes.uv3;let Rt=Cu;return M.toneMapped&&(null===Be||!0===Be.isXRRenderTarget)&&(Rt=n.toneMapping),{isWebGL2:d,shaderID:Z,shaderType:M.type,shaderName:M.name,vertexShader:Se,fragmentShader:ve,defines:M.defines,customVertexShaderID:Ne,customFragmentShaderID:$e,isRawShaderMaterial:!0===M.isRawShaderMaterial,glslVersion:M.glslVersion,precision:m,instancing:Xe,instancingColor:Xe&&null!==se.instanceColor,supportsVertexTextures:p,outputColorSpace:null===Be?n.outputColorSpace:!0===Be.isXRRenderTarget?Be.texture.colorSpace:Lr,map:gt,matcap:!!M.matcap,envMap:it,envMapMode:it&&X.mapping,envMapCubeUVHeight:Q,aoMap:z,lightMap:Oe,bumpMap:ye,normalMap:Ae,displacementMap:p&&xe,emissiveMap:lt,normalMapObjectSpace:Ae&&1===M.normalMapType,normalMapTangentSpace:Ae&&0===M.normalMapType,metalnessMap:Ze,roughnessMap:et,anisotropy:Mt,anisotropyMap:ie,clearcoat:sn,clearcoatMap:Te,clearcoatNormalMap:Ce,clearcoatRoughnessMap:De,iridescence:fi,iridescenceMap:ot,iridescenceThicknessMap:Ie,sheen:k,sheenColorMap:qe,sheenRoughnessMap:W,specularMap:Re,specularColorMap:we,specularIntensityMap:Dt,transmission:P,transmissionMap:ct,thicknessMap:_t,gradientMap:!!M.gradientMap,opaque:!1===M.transparent&&1===M.blending,alphaMap:H,alphaTest:M.alphaTest>0,alphaHash:!!M.alphaHash,combine:M.combine,mapUv:gt&&v(M.map.channel),aoMapUv:z&&v(M.aoMap.channel),lightMapUv:Oe&&v(M.lightMap.channel),bumpMapUv:ye&&v(M.bumpMap.channel),normalMapUv:Ae&&v(M.normalMap.channel),displacementMapUv:xe&&v(M.displacementMap.channel),emissiveMapUv:lt&&v(M.emissiveMap.channel),metalnessMapUv:Ze&&v(M.metalnessMap.channel),roughnessMapUv:et&&v(M.roughnessMap.channel),anisotropyMapUv:ie&&v(M.anisotropyMap.channel),clearcoatMapUv:Te&&v(M.clearcoatMap.channel),clearcoatNormalMapUv:Ce&&v(M.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:De&&v(M.clearcoatRoughnessMap.channel),iridescenceMapUv:ot&&v(M.iridescenceMap.channel),iridescenceThicknessMapUv:Ie&&v(M.iridescenceThicknessMap.channel),sheenColorMapUv:qe&&v(M.sheenColorMap.channel),sheenRoughnessMapUv:W&&v(M.sheenRoughnessMap.channel),specularMapUv:Re&&v(M.specularMap.channel),specularColorMapUv:we&&v(M.specularColorMap.channel),specularIntensityMapUv:Dt&&v(M.specularIntensityMap.channel),transmissionMapUv:ct&&v(M.transmissionMap.channel),thicknessMapUv:_t&&v(M.thicknessMap.channel),alphaMapUv:H&&v(M.alphaMap.channel),vertexTangents:!!J.attributes.tangent&&(Ae||Mt),vertexColors:M.vertexColors,vertexAlphas:!0===M.vertexColors&&!!J.attributes.color&&4===J.attributes.color.itemSize,vertexUv1s:ke,vertexUv2s:Ee,vertexUv3s:st,pointsUvs:!0===se.isPoints&&!!J.attributes.uv&&(gt||H),fog:!!V,useFog:!0===M.fog,fogExp2:V&&V.isFogExp2,flatShading:!0===M.flatShading,sizeAttenuation:!0===M.sizeAttenuation,logarithmicDepthBuffer:h,skinning:!0===se.isSkinnedMesh,morphTargets:void 0!==J.morphAttributes.position,morphNormals:void 0!==J.morphAttributes.normal,morphColors:void 0!==J.morphAttributes.color,morphTargetsCount:q,morphTextureStride:oe,numDirLights:R.directional.length,numPointLights:R.point.length,numSpotLights:R.spot.length,numSpotLightMaps:R.spotLightMap.length,numRectAreaLights:R.rectArea.length,numHemiLights:R.hemi.length,numDirLightShadows:R.directionalShadowMap.length,numPointLightShadows:R.pointShadowMap.length,numSpotLightShadows:R.spotShadowMap.length,numSpotLightShadowsWithMaps:R.numSpotLightShadowsWithMaps,numLightProbes:R.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:M.dithering,shadowMapEnabled:n.shadowMap.enabled&&$.length>0,shadowMapType:n.shadowMap.type,toneMapping:Rt,useLegacyLights:n._useLegacyLights,decodeVideoTexture:gt&&!0===M.map.isVideoTexture&&Mn.getTransfer(M.map.colorSpace)===ri,premultipliedAlpha:M.premultipliedAlpha,doubleSided:2===M.side,flipSided:1===M.side,useDepthPacking:M.depthPacking>=0,depthPacking:M.depthPacking||0,index0AttributeName:M.index0AttributeName,extensionDerivatives:je&&!0===M.extensions.derivatives,extensionFragDepth:je&&!0===M.extensions.fragDepth,extensionDrawBuffers:je&&!0===M.extensions.drawBuffers,extensionShaderTextureLOD:je&&!0===M.extensions.shaderTextureLOD,rendererExtensionFragDepth:d||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:d||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:d||i.has("EXT_shader_texture_lod"),customProgramCacheKey:M.customProgramCacheKey()}},getProgramCacheKey:function y(M){const R=[];if(M.shaderID?R.push(M.shaderID):(R.push(M.customVertexShaderID),R.push(M.customFragmentShaderID)),void 0!==M.defines)for(const $ in M.defines)R.push($),R.push(M.defines[$]);return!1===M.isRawShaderMaterial&&(function b(M,R){M.push(R.precision),M.push(R.outputColorSpace),M.push(R.envMapMode),M.push(R.envMapCubeUVHeight),M.push(R.mapUv),M.push(R.alphaMapUv),M.push(R.lightMapUv),M.push(R.aoMapUv),M.push(R.bumpMapUv),M.push(R.normalMapUv),M.push(R.displacementMapUv),M.push(R.emissiveMapUv),M.push(R.metalnessMapUv),M.push(R.roughnessMapUv),M.push(R.anisotropyMapUv),M.push(R.clearcoatMapUv),M.push(R.clearcoatNormalMapUv),M.push(R.clearcoatRoughnessMapUv),M.push(R.iridescenceMapUv),M.push(R.iridescenceThicknessMapUv),M.push(R.sheenColorMapUv),M.push(R.sheenRoughnessMapUv),M.push(R.specularMapUv),M.push(R.specularColorMapUv),M.push(R.specularIntensityMapUv),M.push(R.transmissionMapUv),M.push(R.thicknessMapUv),M.push(R.combine),M.push(R.fogExp2),M.push(R.sizeAttenuation),M.push(R.morphTargetsCount),M.push(R.morphAttributeCount),M.push(R.numDirLights),M.push(R.numPointLights),M.push(R.numSpotLights),M.push(R.numSpotLightMaps),M.push(R.numHemiLights),M.push(R.numRectAreaLights),M.push(R.numDirLightShadows),M.push(R.numPointLightShadows),M.push(R.numSpotLightShadows),M.push(R.numSpotLightShadowsWithMaps),M.push(R.numLightProbes),M.push(R.shadowMapType),M.push(R.toneMapping),M.push(R.numClippingPlanes),M.push(R.numClipIntersection),M.push(R.depthPacking)}(R,M),function x(M,R){a.disableAll(),R.isWebGL2&&a.enable(0),R.supportsVertexTextures&&a.enable(1),R.instancing&&a.enable(2),R.instancingColor&&a.enable(3),R.matcap&&a.enable(4),R.envMap&&a.enable(5),R.normalMapObjectSpace&&a.enable(6),R.normalMapTangentSpace&&a.enable(7),R.clearcoat&&a.enable(8),R.iridescence&&a.enable(9),R.alphaTest&&a.enable(10),R.vertexColors&&a.enable(11),R.vertexAlphas&&a.enable(12),R.vertexUv1s&&a.enable(13),R.vertexUv2s&&a.enable(14),R.vertexUv3s&&a.enable(15),R.vertexTangents&&a.enable(16),R.anisotropy&&a.enable(17),M.push(a.mask),a.disableAll(),R.fog&&a.enable(0),R.useFog&&a.enable(1),R.flatShading&&a.enable(2),R.logarithmicDepthBuffer&&a.enable(3),R.skinning&&a.enable(4),R.morphTargets&&a.enable(5),R.morphNormals&&a.enable(6),R.morphColors&&a.enable(7),R.premultipliedAlpha&&a.enable(8),R.shadowMapEnabled&&a.enable(9),R.useLegacyLights&&a.enable(10),R.doubleSided&&a.enable(11),R.flipSided&&a.enable(12),R.useDepthPacking&&a.enable(13),R.dithering&&a.enable(14),R.transmission&&a.enable(15),R.sheen&&a.enable(16),R.opaque&&a.enable(17),R.pointsUvs&&a.enable(18),R.decodeVideoTexture&&a.enable(19),M.push(a.mask)}(R,M),R.push(n.outputColorSpace)),R.push(M.customProgramCacheKey),R.join()},getUniforms:function E(M){const R=g[M.type];let $;return $=R?ane.clone(sl[R].uniforms):M.uniforms,$},acquireProgram:function C(M,R){let $;for(let ee=0,se=c.length;ee<se;ee++){const V=c[ee];if(V.cacheKey===R){$=V,++$.usedTimes;break}}return void 0===$&&($=new kse(n,R,M,s),c.push($)),$},releaseProgram:function A(M){if(0==--M.usedTimes){const R=c.indexOf(M);c[R]=c[c.length-1],c.pop(),M.destroy()}},releaseShaderCache:function D(M){l.remove(M)},programs:c,dispose:function L(){l.dispose()}}}function zse(){let n=new WeakMap;return{get:function e(s){let o=n.get(s);return void 0===o&&(o={},n.set(s,o)),o},remove:function t(s){n.delete(s)},update:function i(s,o,a){n.get(s)[o]=a},dispose:function r(){n=new WeakMap}}}function Gse(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function Iz(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function Rz(){const n=[];let e=0;const t=[],i=[],r=[];function o(h,p,m,g,v,w){let y=n[e];return void 0===y?(y={id:h.id,object:h,geometry:p,material:m,groupOrder:g,renderOrder:h.renderOrder,z:v,group:w},n[e]=y):(y.id=h.id,y.object=h,y.geometry=p,y.material=m,y.groupOrder=g,y.renderOrder=h.renderOrder,y.z=v,y.group=w),e++,y}return{opaque:t,transmissive:i,transparent:r,init:function s(){e=0,t.length=0,i.length=0,r.length=0},push:function a(h,p,m,g,v,w){const y=o(h,p,m,g,v,w);m.transmission>0?i.push(y):!0===m.transparent?r.push(y):t.push(y)},unshift:function l(h,p,m,g,v,w){const y=o(h,p,m,g,v,w);m.transmission>0?i.unshift(y):!0===m.transparent?r.unshift(y):t.unshift(y)},finish:function d(){for(let h=e,p=n.length;h<p;h++){const m=n[h];if(null===m.id)break;m.id=null,m.object=null,m.geometry=null,m.material=null,m.group=null}},sort:function c(h,p){t.length>1&&t.sort(h||Gse),i.length>1&&i.sort(p||Iz),r.length>1&&r.sort(p||Iz)}}}function Wse(){let n=new WeakMap;return{get:function e(i,r){const s=n.get(i);let o;return void 0===s?(o=new Rz,n.set(i,[o])):r>=s.length?(o=new Rz,s.push(o)):o=s[r],o},dispose:function t(){n=new WeakMap}}}function jse(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new N,color:new We};break;case"SpotLight":t={position:new N,direction:new N,color:new We,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new N,color:new We,distance:0,decay:0};break;case"HemisphereLight":t={direction:new N,skyColor:new We,groundColor:new We};break;case"RectAreaLight":t={color:new We,position:new N,halfWidth:new N,halfHeight:new N}}return n[e.id]=t,t}}}let qse=0;function Xse(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function Yse(n,e){const t=new jse,i=function $se(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new fe};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new fe,shadowCameraNear:1,shadowCameraFar:1e3}}return n[e.id]=t,t}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let d=0;d<9;d++)r.probe.push(new N);const s=new N,o=new Ct,a=new Ct;return{setup:function l(d,h){let p=0,m=0,g=0;for(let ee=0;ee<9;ee++)r.probe[ee].set(0,0,0);let v=0,w=0,y=0,b=0,x=0,E=0,C=0,A=0,D=0,L=0,M=0;d.sort(Xse);const R=!0===h?Math.PI:1;for(let ee=0,se=d.length;ee<se;ee++){const V=d[ee],J=V.color,G=V.intensity,X=V.distance,Q=V.shadow&&V.shadow.map?V.shadow.map.texture:null;if(V.isAmbientLight)p+=J.r*G*R,m+=J.g*G*R,g+=J.b*G*R;else if(V.isLightProbe){for(let Z=0;Z<9;Z++)r.probe[Z].addScaledVector(V.sh.coefficients[Z],G);M++}else if(V.isDirectionalLight){const Z=t.get(V);if(Z.color.copy(V.color).multiplyScalar(V.intensity*R),V.castShadow){const le=V.shadow,q=i.get(V);q.shadowBias=le.bias,q.shadowNormalBias=le.normalBias,q.shadowRadius=le.radius,q.shadowMapSize=le.mapSize,r.directionalShadow[v]=q,r.directionalShadowMap[v]=Q,r.directionalShadowMatrix[v]=V.shadow.matrix,E++}r.directional[v]=Z,v++}else if(V.isSpotLight){const Z=t.get(V);Z.position.setFromMatrixPosition(V.matrixWorld),Z.color.copy(J).multiplyScalar(G*R),Z.distance=X,Z.coneCos=Math.cos(V.angle),Z.penumbraCos=Math.cos(V.angle*(1-V.penumbra)),Z.decay=V.decay,r.spot[y]=Z;const le=V.shadow;if(V.map&&(r.spotLightMap[D]=V.map,D++,le.updateMatrices(V),V.castShadow&&L++),r.spotLightMatrix[y]=le.matrix,V.castShadow){const q=i.get(V);q.shadowBias=le.bias,q.shadowNormalBias=le.normalBias,q.shadowRadius=le.radius,q.shadowMapSize=le.mapSize,r.spotShadow[y]=q,r.spotShadowMap[y]=Q,A++}y++}else if(V.isRectAreaLight){const Z=t.get(V);Z.color.copy(J).multiplyScalar(G),Z.halfWidth.set(.5*V.width,0,0),Z.halfHeight.set(0,.5*V.height,0),r.rectArea[b]=Z,b++}else if(V.isPointLight){const Z=t.get(V);if(Z.color.copy(V.color).multiplyScalar(V.intensity*R),Z.distance=V.distance,Z.decay=V.decay,V.castShadow){const le=V.shadow,q=i.get(V);q.shadowBias=le.bias,q.shadowNormalBias=le.normalBias,q.shadowRadius=le.radius,q.shadowMapSize=le.mapSize,q.shadowCameraNear=le.camera.near,q.shadowCameraFar=le.camera.far,r.pointShadow[w]=q,r.pointShadowMap[w]=Q,r.pointShadowMatrix[w]=V.shadow.matrix,C++}r.point[w]=Z,w++}else if(V.isHemisphereLight){const Z=t.get(V);Z.skyColor.copy(V.color).multiplyScalar(G*R),Z.groundColor.copy(V.groundColor).multiplyScalar(G*R),r.hemi[x]=Z,x++}}b>0&&(e.isWebGL2||!0===n.has("OES_texture_float_linear")?(r.rectAreaLTC1=Ge.LTC_FLOAT_1,r.rectAreaLTC2=Ge.LTC_FLOAT_2):!0===n.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=Ge.LTC_HALF_1,r.rectAreaLTC2=Ge.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=p,r.ambient[1]=m,r.ambient[2]=g;const $=r.hash;($.directionalLength!==v||$.pointLength!==w||$.spotLength!==y||$.rectAreaLength!==b||$.hemiLength!==x||$.numDirectionalShadows!==E||$.numPointShadows!==C||$.numSpotShadows!==A||$.numSpotMaps!==D||$.numLightProbes!==M)&&(r.directional.length=v,r.spot.length=y,r.rectArea.length=b,r.point.length=w,r.hemi.length=x,r.directionalShadow.length=E,r.directionalShadowMap.length=E,r.pointShadow.length=C,r.pointShadowMap.length=C,r.spotShadow.length=A,r.spotShadowMap.length=A,r.directionalShadowMatrix.length=E,r.pointShadowMatrix.length=C,r.spotLightMatrix.length=A+D-L,r.spotLightMap.length=D,r.numSpotLightShadowsWithMaps=L,r.numLightProbes=M,$.directionalLength=v,$.pointLength=w,$.spotLength=y,$.rectAreaLength=b,$.hemiLength=x,$.numDirectionalShadows=E,$.numPointShadows=C,$.numSpotShadows=A,$.numSpotMaps=D,$.numLightProbes=M,r.version=qse++)},setupView:function c(d,h){let p=0,m=0,g=0,v=0,w=0;const y=h.matrixWorldInverse;for(let b=0,x=d.length;b<x;b++){const E=d[b];if(E.isDirectionalLight){const C=r.directional[p];C.direction.setFromMatrixPosition(E.matrixWorld),s.setFromMatrixPosition(E.target.matrixWorld),C.direction.sub(s),C.direction.transformDirection(y),p++}else if(E.isSpotLight){const C=r.spot[g];C.position.setFromMatrixPosition(E.matrixWorld),C.position.applyMatrix4(y),C.direction.setFromMatrixPosition(E.matrixWorld),s.setFromMatrixPosition(E.target.matrixWorld),C.direction.sub(s),C.direction.transformDirection(y),g++}else if(E.isRectAreaLight){const C=r.rectArea[v];C.position.setFromMatrixPosition(E.matrixWorld),C.position.applyMatrix4(y),a.identity(),o.copy(E.matrixWorld),o.premultiply(y),a.extractRotation(o),C.halfWidth.set(.5*E.width,0,0),C.halfHeight.set(0,.5*E.height,0),C.halfWidth.applyMatrix4(a),C.halfHeight.applyMatrix4(a),v++}else if(E.isPointLight){const C=r.point[m];C.position.setFromMatrixPosition(E.matrixWorld),C.position.applyMatrix4(y),m++}else if(E.isHemisphereLight){const C=r.hemi[w];C.direction.setFromMatrixPosition(E.matrixWorld),C.direction.transformDirection(y),w++}}},state:r}}function Pz(n,e){const t=new Yse(n,e),i=[],r=[];return{init:function s(){i.length=0,r.length=0},state:{lightsArray:i,shadowsArray:r,lights:t},setupLights:function l(h){t.setup(i,h)},setupLightsView:function c(h){t.setupView(i,h)},pushLight:function o(h){i.push(h)},pushShadow:function a(h){r.push(h)}}}function Kse(n,e){let t=new WeakMap;return{get:function i(s,o=0){const a=t.get(s);let l;return void 0===a?(l=new Pz(n,e),t.set(s,[l])):o>=a.length?(l=new Pz(n,e),a.push(l)):l=a[o],l},dispose:function r(){t=new WeakMap}}}class Nz extends xs{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class Oz extends xs{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function Qse(n,e,t){let i=new pR;const r=new fe,s=new fe,o=new Ln,a=new Nz({depthPacking:3201}),l=new Oz,c={},d=t.maxTextureSize,h={0:1,1:0,2:2},p=new hc({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new fe},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),m=p.clone();m.defines.HORIZONTAL_PASS=1;const g=new Ot;g.setAttribute("position",new Jn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const v=new Me(g,p),w=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=$V;let y=this.type;function b(C,A){const D=e.update(v);p.defines.VSM_SAMPLES!==C.blurSamples&&(p.defines.VSM_SAMPLES=C.blurSamples,m.defines.VSM_SAMPLES=C.blurSamples,p.needsUpdate=!0,m.needsUpdate=!0),null===C.mapPass&&(C.mapPass=new hh(r.x,r.y)),p.uniforms.shadow_pass.value=C.map.texture,p.uniforms.resolution.value=C.mapSize,p.uniforms.radius.value=C.radius,n.setRenderTarget(C.mapPass),n.clear(),n.renderBufferDirect(A,null,D,p,v,null),m.uniforms.shadow_pass.value=C.mapPass.texture,m.uniforms.resolution.value=C.mapSize,m.uniforms.radius.value=C.radius,n.setRenderTarget(C.map),n.clear(),n.renderBufferDirect(A,null,D,m,v,null)}function x(C,A,D,L){let M=null;const R=!0===D.isPointLight?C.customDistanceMaterial:C.customDepthMaterial;if(void 0!==R)M=R;else if(M=!0===D.isPointLight?l:a,n.localClippingEnabled&&!0===A.clipShadows&&Array.isArray(A.clippingPlanes)&&0!==A.clippingPlanes.length||A.displacementMap&&0!==A.displacementScale||A.alphaMap&&A.alphaTest>0||A.map&&A.alphaTest>0){const $=M.uuid,ee=A.uuid;let se=c[$];void 0===se&&(se={},c[$]=se);let V=se[ee];void 0===V&&(V=M.clone(),se[ee]=V),M=V}return M.visible=A.visible,M.wireframe=A.wireframe,M.side=L===ec?null!==A.shadowSide?A.shadowSide:A.side:null!==A.shadowSide?A.shadowSide:h[A.side],M.alphaMap=A.alphaMap,M.alphaTest=A.alphaTest,M.map=A.map,M.clipShadows=A.clipShadows,M.clippingPlanes=A.clippingPlanes,M.clipIntersection=A.clipIntersection,M.displacementMap=A.displacementMap,M.displacementScale=A.displacementScale,M.displacementBias=A.displacementBias,M.wireframeLinewidth=A.wireframeLinewidth,M.linewidth=A.linewidth,!0===D.isPointLight&&!0===M.isMeshDistanceMaterial&&(n.properties.get(M).light=D),M}function E(C,A,D,L,M){if(!1===C.visible)return;if(C.layers.test(A.layers)&&(C.isMesh||C.isLine||C.isPoints)&&(C.castShadow||C.receiveShadow&&M===ec)&&(!C.frustumCulled||i.intersectsObject(C))){C.modelViewMatrix.multiplyMatrices(D.matrixWorldInverse,C.matrixWorld);const ee=e.update(C),se=C.material;if(Array.isArray(se)){const V=ee.groups;for(let J=0,G=V.length;J<G;J++){const X=V[J],Q=se[X.materialIndex];if(Q&&Q.visible){const Z=x(C,Q,L,M);n.renderBufferDirect(D,null,ee,Z,C,X)}}}else if(se.visible){const V=x(C,se,L,M);n.renderBufferDirect(D,null,ee,V,C,null)}}const $=C.children;for(let ee=0,se=$.length;ee<se;ee++)E($[ee],A,D,L,M)}this.render=function(C,A,D){if(!1===w.enabled||!1===w.autoUpdate&&!1===w.needsUpdate||0===C.length)return;const L=n.getRenderTarget(),M=n.getActiveCubeFace(),R=n.getActiveMipmapLevel(),$=n.state;$.setBlending(0),$.buffers.color.setClear(1,1,1,1),$.buffers.depth.setTest(!0),$.setScissorTest(!1);const ee=y!==ec&&this.type===ec,se=y===ec&&this.type!==ec;for(let V=0,J=C.length;V<J;V++){const G=C[V],X=G.shadow;if(void 0===X){console.warn("THREE.WebGLShadowMap:",G,"has no shadow.");continue}if(!1===X.autoUpdate&&!1===X.needsUpdate)continue;r.copy(X.mapSize);const Q=X.getFrameExtents();if(r.multiply(Q),s.copy(X.mapSize),(r.x>d||r.y>d)&&(r.x>d&&(s.x=Math.floor(d/Q.x),r.x=s.x*Q.x,X.mapSize.x=s.x),r.y>d&&(s.y=Math.floor(d/Q.y),r.y=s.y*Q.y,X.mapSize.y=s.y)),null===X.map||!0===ee||!0===se){const le=this.type!==ec?{minFilter:Vi,magFilter:Vi}:{};null!==X.map&&X.map.dispose(),X.map=new hh(r.x,r.y,le),X.map.texture.name=G.name+".shadowMap",X.camera.updateProjectionMatrix()}n.setRenderTarget(X.map),n.clear();const Z=X.getViewportCount();for(let le=0;le<Z;le++){const q=X.getViewport(le);o.set(s.x*q.x,s.y*q.y,s.x*q.z,s.y*q.w),$.viewport(o),X.updateMatrices(G,le),i=X.getFrustum(),E(A,D,X.camera,G,this.type)}!0!==X.isPointLightShadow&&this.type===ec&&b(X,D),X.needsUpdate=!1}y=this.type,w.needsUpdate=!1,n.setRenderTarget(L,M,R)}}function eoe(n,e,t){const i=t.isWebGL2,a=new function r(){let H=!1;const Fe=new Ln;let Pe=null;const je=new Ln(0,0,0,0);return{setMask:function(ke){Pe!==ke&&!H&&(n.colorMask(ke,ke,ke,ke),Pe=ke)},setLocked:function(ke){H=ke},setClear:function(ke,Ee,st,Rt,Qi){!0===Qi&&(ke*=Rt,Ee*=Rt,st*=Rt),Fe.set(ke,Ee,st,Rt),!1===je.equals(Fe)&&(n.clearColor(ke,Ee,st,Rt),je.copy(Fe))},reset:function(){H=!1,Pe=null,je.set(-1,0,0,0)}}},l=new function s(){let H=!1,Fe=null,Pe=null,je=null;return{setTest:function(ke){ke?Be(n.DEPTH_TEST):Xe(n.DEPTH_TEST)},setMask:function(ke){Fe!==ke&&!H&&(n.depthMask(ke),Fe=ke)},setFunc:function(ke){if(Pe!==ke){switch(ke){case 0:n.depthFunc(n.NEVER);break;case 1:n.depthFunc(n.ALWAYS);break;case 2:n.depthFunc(n.LESS);break;case 3:default:n.depthFunc(n.LEQUAL);break;case 4:n.depthFunc(n.EQUAL);break;case 5:n.depthFunc(n.GEQUAL);break;case 6:n.depthFunc(n.GREATER);break;case 7:n.depthFunc(n.NOTEQUAL)}Pe=ke}},setLocked:function(ke){H=ke},setClear:function(ke){je!==ke&&(n.clearDepth(ke),je=ke)},reset:function(){H=!1,Fe=null,Pe=null,je=null}}},c=new function o(){let H=!1,Fe=null,Pe=null,je=null,ke=null,Ee=null,st=null,Rt=null,Qi=null;return{setTest:function(ci){H||(ci?Be(n.STENCIL_TEST):Xe(n.STENCIL_TEST))},setMask:function(ci){Fe!==ci&&!H&&(n.stencilMask(ci),Fe=ci)},setFunc:function(ci,fl,Ms){(Pe!==ci||je!==fl||ke!==Ms)&&(n.stencilFunc(ci,fl,Ms),Pe=ci,je=fl,ke=Ms)},setOp:function(ci,fl,Ms){(Ee!==ci||st!==fl||Rt!==Ms)&&(n.stencilOp(ci,fl,Ms),Ee=ci,st=fl,Rt=Ms)},setLocked:function(ci){H=ci},setClear:function(ci){Qi!==ci&&(n.clearStencil(ci),Qi=ci)},reset:function(){H=!1,Fe=null,Pe=null,je=null,ke=null,Ee=null,st=null,Rt=null,Qi=null}}},d=new WeakMap,h=new WeakMap;let p={},m={},g=new WeakMap,v=[],w=null,y=!1,b=null,x=null,E=null,C=null,A=null,D=null,L=null,M=!1,R=null,$=null,ee=null,se=null,V=null;const J=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let G=!1,X=0;const Q=n.getParameter(n.VERSION);-1!==Q.indexOf("WebGL")?(X=parseFloat(/^WebGL (\d)/.exec(Q)[1]),G=X>=1):-1!==Q.indexOf("OpenGL ES")&&(X=parseFloat(/^OpenGL ES (\d)/.exec(Q)[1]),G=X>=2);let Z=null,le={};const q=n.getParameter(n.SCISSOR_BOX),oe=n.getParameter(n.VIEWPORT),Se=(new Ln).fromArray(q),ve=(new Ln).fromArray(oe);function Ne(H,Fe,Pe,je){const ke=new Uint8Array(4),Ee=n.createTexture();n.bindTexture(H,Ee),n.texParameteri(H,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(H,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let st=0;st<Pe;st++)!i||H!==n.TEXTURE_3D&&H!==n.TEXTURE_2D_ARRAY?n.texImage2D(Fe+st,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,ke):n.texImage3D(Fe,0,n.RGBA,1,1,je,0,n.RGBA,n.UNSIGNED_BYTE,ke);return Ee}const $e={};function Be(H){!0!==p[H]&&(n.enable(H),p[H]=!0)}function Xe(H){!1!==p[H]&&(n.disable(H),p[H]=!1)}$e[n.TEXTURE_2D]=Ne(n.TEXTURE_2D,n.TEXTURE_2D,1),$e[n.TEXTURE_CUBE_MAP]=Ne(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),i&&($e[n.TEXTURE_2D_ARRAY]=Ne(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),$e[n.TEXTURE_3D]=Ne(n.TEXTURE_3D,n.TEXTURE_3D,1,1)),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),Be(n.DEPTH_TEST),l.setFunc(3),xe(!1),lt(1),Be(n.CULL_FACE),ye(0);const z={100:n.FUNC_ADD,101:n.FUNC_SUBTRACT,102:n.FUNC_REVERSE_SUBTRACT};if(i)z[103]=n.MIN,z[104]=n.MAX;else{const H=e.get("EXT_blend_minmax");null!==H&&(z[103]=H.MIN_EXT,z[104]=H.MAX_EXT)}const Oe={200:n.ZERO,201:n.ONE,202:n.SRC_COLOR,204:n.SRC_ALPHA,210:n.SRC_ALPHA_SATURATE,208:n.DST_COLOR,206:n.DST_ALPHA,203:n.ONE_MINUS_SRC_COLOR,205:n.ONE_MINUS_SRC_ALPHA,209:n.ONE_MINUS_DST_COLOR,207:n.ONE_MINUS_DST_ALPHA};function ye(H,Fe,Pe,je,ke,Ee,st,Rt){if(0!==H){if(!1===y&&(Be(n.BLEND),y=!0),5===H)ke=ke||Fe,Ee=Ee||Pe,st=st||je,(Fe!==x||ke!==A)&&(n.blendEquationSeparate(z[Fe],z[ke]),x=Fe,A=ke),(Pe!==E||je!==C||Ee!==D||st!==L)&&(n.blendFuncSeparate(Oe[Pe],Oe[je],Oe[Ee],Oe[st]),E=Pe,C=je,D=Ee,L=st),b=H,M=!1;else if(H!==b||Rt!==M){if((100!==x||100!==A)&&(n.blendEquation(n.FUNC_ADD),x=100,A=100),Rt)switch(H){case 1:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case 2:n.blendFunc(n.ONE,n.ONE);break;case 3:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case 4:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",H)}else switch(H){case 1:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case 2:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case 3:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case 4:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",H)}E=null,C=null,D=null,L=null,b=H,M=Rt}}else!0===y&&(Xe(n.BLEND),y=!1)}function xe(H){R!==H&&(n.frontFace(H?n.CW:n.CCW),R=H)}function lt(H){0!==H?(Be(n.CULL_FACE),H!==$&&n.cullFace(1===H?n.BACK:2===H?n.FRONT:n.FRONT_AND_BACK)):Xe(n.CULL_FACE),$=H}function et(H,Fe,Pe){H?(Be(n.POLYGON_OFFSET_FILL),(se!==Fe||V!==Pe)&&(n.polygonOffset(Fe,Pe),se=Fe,V=Pe)):Xe(n.POLYGON_OFFSET_FILL)}return{buffers:{color:a,depth:l,stencil:c},enable:Be,disable:Xe,bindFramebuffer:function gt(H,Fe){return m[H]!==Fe&&(n.bindFramebuffer(H,Fe),m[H]=Fe,i&&(H===n.DRAW_FRAMEBUFFER&&(m[n.FRAMEBUFFER]=Fe),H===n.FRAMEBUFFER&&(m[n.DRAW_FRAMEBUFFER]=Fe)),!0)},drawBuffers:function At(H,Fe){let Pe=v,je=!1;if(H)if(Pe=g.get(Fe),void 0===Pe&&(Pe=[],g.set(Fe,Pe)),H.isWebGLMultipleRenderTargets){const ke=H.texture;if(Pe.length!==ke.length||Pe[0]!==n.COLOR_ATTACHMENT0){for(let Ee=0,st=ke.length;Ee<st;Ee++)Pe[Ee]=n.COLOR_ATTACHMENT0+Ee;Pe.length=ke.length,je=!0}}else Pe[0]!==n.COLOR_ATTACHMENT0&&(Pe[0]=n.COLOR_ATTACHMENT0,je=!0);else Pe[0]!==n.BACK&&(Pe[0]=n.BACK,je=!0);je&&(t.isWebGL2?n.drawBuffers(Pe):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Pe))},useProgram:function it(H){return w!==H&&(n.useProgram(H),w=H,!0)},setBlending:ye,setMaterial:function Ae(H,Fe){2===H.side?Xe(n.CULL_FACE):Be(n.CULL_FACE);let Pe=1===H.side;Fe&&(Pe=!Pe),xe(Pe),1===H.blending&&!1===H.transparent?ye(0):ye(H.blending,H.blendEquation,H.blendSrc,H.blendDst,H.blendEquationAlpha,H.blendSrcAlpha,H.blendDstAlpha,H.premultipliedAlpha),l.setFunc(H.depthFunc),l.setTest(H.depthTest),l.setMask(H.depthWrite),a.setMask(H.colorWrite);const je=H.stencilWrite;c.setTest(je),je&&(c.setMask(H.stencilWriteMask),c.setFunc(H.stencilFunc,H.stencilRef,H.stencilFuncMask),c.setOp(H.stencilFail,H.stencilZFail,H.stencilZPass)),et(H.polygonOffset,H.polygonOffsetFactor,H.polygonOffsetUnits),!0===H.alphaToCoverage?Be(n.SAMPLE_ALPHA_TO_COVERAGE):Xe(n.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:xe,setCullFace:lt,setLineWidth:function Ze(H){H!==ee&&(G&&n.lineWidth(H),ee=H)},setPolygonOffset:et,setScissorTest:function Mt(H){H?Be(n.SCISSOR_TEST):Xe(n.SCISSOR_TEST)},activeTexture:function sn(H){void 0===H&&(H=n.TEXTURE0+J-1),Z!==H&&(n.activeTexture(H),Z=H)},bindTexture:function fi(H,Fe,Pe){void 0===Pe&&(Pe=null===Z?n.TEXTURE0+J-1:Z);let je=le[Pe];void 0===je&&(je={type:void 0,texture:void 0},le[Pe]=je),(je.type!==H||je.texture!==Fe)&&(Z!==Pe&&(n.activeTexture(Pe),Z=Pe),n.bindTexture(H,Fe||$e[H]),je.type=H,je.texture=Fe)},unbindTexture:function k(){const H=le[Z];void 0!==H&&void 0!==H.type&&(n.bindTexture(H.type,null),H.type=void 0,H.texture=void 0)},compressedTexImage2D:function P(){try{n.compressedTexImage2D.apply(n,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},compressedTexImage3D:function ie(){try{n.compressedTexImage3D.apply(n,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},texImage2D:function W(){try{n.texImage2D.apply(n,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},texImage3D:function Re(){try{n.texImage3D.apply(n,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},updateUBOMapping:function ct(H,Fe){let Pe=h.get(Fe);void 0===Pe&&(Pe=new WeakMap,h.set(Fe,Pe));let je=Pe.get(H);void 0===je&&(je=n.getUniformBlockIndex(Fe,H.name),Pe.set(H,je))},uniformBlockBinding:function _t(H,Fe){const je=h.get(Fe).get(H);d.get(Fe)!==je&&(n.uniformBlockBinding(Fe,je,H.__bindingPointIndex),d.set(Fe,je))},texStorage2D:function Ie(){try{n.texStorage2D.apply(n,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},texStorage3D:function qe(){try{n.texStorage3D.apply(n,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},texSubImage2D:function Te(){try{n.texSubImage2D.apply(n,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},texSubImage3D:function Ce(){try{n.texSubImage3D.apply(n,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},compressedTexSubImage2D:function De(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},compressedTexSubImage3D:function ot(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},scissor:function we(H){!1===Se.equals(H)&&(n.scissor(H.x,H.y,H.z,H.w),Se.copy(H))},viewport:function Dt(H){!1===ve.equals(H)&&(n.viewport(H.x,H.y,H.z,H.w),ve.copy(H))},reset:function at(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),!0===i&&(n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),p={},Z=null,le={},m={},g=new WeakMap,v=[],w=null,y=!1,b=null,x=null,E=null,C=null,A=null,D=null,L=null,M=!1,R=null,$=null,ee=null,se=null,V=null,Se.set(0,0,n.canvas.width,n.canvas.height),ve.set(0,0,n.canvas.width,n.canvas.height),a.reset(),l.reset(),c.reset()}}}function toe(n,e,t,i,r,s,o){const a=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,d=r.maxTextureSize,h=r.maxSamples,p=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,m=!(typeof navigator>"u")&&/OculusBrowser/g.test(navigator.userAgent),g=new WeakMap;let v;const w=new WeakMap;let y=!1;try{y=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function b(k,P){return y?new OffscreenCanvas(k,P):Av("canvas")}function x(k,P,ie,Te){let Ce=1;if((k.width>Te||k.height>Te)&&(Ce=Te/Math.max(k.width,k.height)),Ce<1||!0===P){if(typeof HTMLImageElement<"u"&&k instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&k instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&k instanceof ImageBitmap){const De=P?XS:Math.floor,ot=De(Ce*k.width),Ie=De(Ce*k.height);void 0===v&&(v=b(ot,Ie));const qe=ie?b(ot,Ie):v;return qe.width=ot,qe.height=Ie,qe.getContext("2d").drawImage(k,0,0,ot,Ie),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+k.width+"x"+k.height+") to ("+ot+"x"+Ie+")."),qe}return"data"in k&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+k.width+"x"+k.height+")."),k}return k}function E(k){return qI(k.width)&&qI(k.height)}function A(k,P){return k.generateMipmaps&&P&&k.minFilter!==Vi&&k.minFilter!==gi}function D(k){n.generateMipmap(k)}function L(k,P,ie,Te,Ce=!1){if(!1===a)return P;if(null!==k){if(void 0!==n[k])return n[k];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+k+"'")}let De=P;if(P===n.RED&&(ie===n.FLOAT&&(De=n.R32F),ie===n.HALF_FLOAT&&(De=n.R16F),ie===n.UNSIGNED_BYTE&&(De=n.R8)),P===n.RED_INTEGER&&(ie===n.UNSIGNED_BYTE&&(De=n.R8UI),ie===n.UNSIGNED_SHORT&&(De=n.R16UI),ie===n.UNSIGNED_INT&&(De=n.R32UI),ie===n.BYTE&&(De=n.R8I),ie===n.SHORT&&(De=n.R16I),ie===n.INT&&(De=n.R32I)),P===n.RG&&(ie===n.FLOAT&&(De=n.RG32F),ie===n.HALF_FLOAT&&(De=n.RG16F),ie===n.UNSIGNED_BYTE&&(De=n.RG8)),P===n.RGBA){const ot=Ce?GS:Mn.getTransfer(Te);ie===n.FLOAT&&(De=n.RGBA32F),ie===n.HALF_FLOAT&&(De=n.RGBA16F),ie===n.UNSIGNED_BYTE&&(De=ot===ri?n.SRGB8_ALPHA8:n.RGBA8),ie===n.UNSIGNED_SHORT_4_4_4_4&&(De=n.RGBA4),ie===n.UNSIGNED_SHORT_5_5_5_1&&(De=n.RGB5_A1)}return(De===n.R16F||De===n.R32F||De===n.RG16F||De===n.RG32F||De===n.RGBA16F||De===n.RGBA32F)&&e.get("EXT_color_buffer_float"),De}function M(k,P,ie){return!0===A(k,ie)||k.isFramebufferTexture&&k.minFilter!==Vi&&k.minFilter!==gi?Math.log2(Math.max(P.width,P.height))+1:void 0!==k.mipmaps&&k.mipmaps.length>0?k.mipmaps.length:k.isCompressedTexture&&Array.isArray(k.image)?P.mipmaps.length:1}function R(k){return k===Vi||1004===k||1005===k?n.NEAREST:n.LINEAR}function $(k){const P=k.target;P.removeEventListener("dispose",$),function se(k){const P=i.get(k);if(void 0===P.__webglInit)return;const ie=k.source,Te=w.get(ie);if(Te){const Ce=Te[P.__cacheKey];Ce.usedTimes--,0===Ce.usedTimes&&V(k),0===Object.keys(Te).length&&w.delete(ie)}i.remove(k)}(P),P.isVideoTexture&&g.delete(P)}function ee(k){const P=k.target;P.removeEventListener("dispose",ee),function J(k){const P=k.texture,ie=i.get(k),Te=i.get(P);if(void 0!==Te.__webglTexture&&(n.deleteTexture(Te.__webglTexture),o.memory.textures--),k.depthTexture&&k.depthTexture.dispose(),k.isWebGLCubeRenderTarget)for(let Ce=0;Ce<6;Ce++){if(Array.isArray(ie.__webglFramebuffer[Ce]))for(let De=0;De<ie.__webglFramebuffer[Ce].length;De++)n.deleteFramebuffer(ie.__webglFramebuffer[Ce][De]);else n.deleteFramebuffer(ie.__webglFramebuffer[Ce]);ie.__webglDepthbuffer&&n.deleteRenderbuffer(ie.__webglDepthbuffer[Ce])}else{if(Array.isArray(ie.__webglFramebuffer))for(let Ce=0;Ce<ie.__webglFramebuffer.length;Ce++)n.deleteFramebuffer(ie.__webglFramebuffer[Ce]);else n.deleteFramebuffer(ie.__webglFramebuffer);if(ie.__webglDepthbuffer&&n.deleteRenderbuffer(ie.__webglDepthbuffer),ie.__webglMultisampledFramebuffer&&n.deleteFramebuffer(ie.__webglMultisampledFramebuffer),ie.__webglColorRenderbuffer)for(let Ce=0;Ce<ie.__webglColorRenderbuffer.length;Ce++)ie.__webglColorRenderbuffer[Ce]&&n.deleteRenderbuffer(ie.__webglColorRenderbuffer[Ce]);ie.__webglDepthRenderbuffer&&n.deleteRenderbuffer(ie.__webglDepthRenderbuffer)}if(k.isWebGLMultipleRenderTargets)for(let Ce=0,De=P.length;Ce<De;Ce++){const ot=i.get(P[Ce]);ot.__webglTexture&&(n.deleteTexture(ot.__webglTexture),o.memory.textures--),i.remove(P[Ce])}i.remove(P),i.remove(k)}(P)}function V(k){const P=i.get(k);n.deleteTexture(P.__webglTexture),delete w.get(k.source)[P.__cacheKey],o.memory.textures--}let G=0;function le(k,P){const ie=i.get(k);if(k.isVideoTexture&&function sn(k){const P=o.render.frame;g.get(k)!==P&&(g.set(k,P),k.update())}(k),!1===k.isRenderTargetTexture&&k.version>0&&ie.__version!==k.version){const Te=k.image;if(null===Te)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==Te.complete)return void gt(ie,k,P);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.bindTexture(n.TEXTURE_2D,ie.__webglTexture,n.TEXTURE0+P)}const ve={[sh]:n.REPEAT,[Kr]:n.CLAMP_TO_EDGE,1002:n.MIRRORED_REPEAT},Ne={[Vi]:n.NEAREST,1004:n.NEAREST_MIPMAP_NEAREST,1005:n.NEAREST_MIPMAP_LINEAR,[gi]:n.LINEAR,1007:n.LINEAR_MIPMAP_NEAREST,[nc]:n.LINEAR_MIPMAP_LINEAR},$e={512:n.NEVER,519:n.ALWAYS,513:n.LESS,515:n.LEQUAL,514:n.EQUAL,518:n.GEQUAL,516:n.GREATER,517:n.NOTEQUAL};function Be(k,P,ie){if(ie?(n.texParameteri(k,n.TEXTURE_WRAP_S,ve[P.wrapS]),n.texParameteri(k,n.TEXTURE_WRAP_T,ve[P.wrapT]),(k===n.TEXTURE_3D||k===n.TEXTURE_2D_ARRAY)&&n.texParameteri(k,n.TEXTURE_WRAP_R,ve[P.wrapR]),n.texParameteri(k,n.TEXTURE_MAG_FILTER,Ne[P.magFilter]),n.texParameteri(k,n.TEXTURE_MIN_FILTER,Ne[P.minFilter])):(n.texParameteri(k,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(k,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),(k===n.TEXTURE_3D||k===n.TEXTURE_2D_ARRAY)&&n.texParameteri(k,n.TEXTURE_WRAP_R,n.CLAMP_TO_EDGE),(P.wrapS!==Kr||P.wrapT!==Kr)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(k,n.TEXTURE_MAG_FILTER,R(P.magFilter)),n.texParameteri(k,n.TEXTURE_MIN_FILTER,R(P.minFilter)),P.minFilter!==Vi&&P.minFilter!==gi&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),P.compareFunction&&(n.texParameteri(k,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(k,n.TEXTURE_COMPARE_FUNC,$e[P.compareFunction])),!0===e.has("EXT_texture_filter_anisotropic")){const Te=e.get("EXT_texture_filter_anisotropic");if(P.magFilter===Vi||1005!==P.minFilter&&P.minFilter!==nc||P.type===ic&&!1===e.has("OES_texture_float_linear")||!1===a&&P.type===Cv&&!1===e.has("OES_texture_half_float_linear"))return;(P.anisotropy>1||i.get(P).__currentAnisotropy)&&(n.texParameterf(k,Te.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(P.anisotropy,r.getMaxAnisotropy())),i.get(P).__currentAnisotropy=P.anisotropy)}}function Xe(k,P){let ie=!1;void 0===k.__webglInit&&(k.__webglInit=!0,P.addEventListener("dispose",$));const Te=P.source;let Ce=w.get(Te);void 0===Ce&&(Ce={},w.set(Te,Ce));const De=function Z(k){const P=[];return P.push(k.wrapS),P.push(k.wrapT),P.push(k.wrapR||0),P.push(k.magFilter),P.push(k.minFilter),P.push(k.anisotropy),P.push(k.internalFormat),P.push(k.format),P.push(k.type),P.push(k.generateMipmaps),P.push(k.premultiplyAlpha),P.push(k.flipY),P.push(k.unpackAlignment),P.push(k.colorSpace),P.join()}(P);if(De!==k.__cacheKey){void 0===Ce[De]&&(Ce[De]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,ie=!0),Ce[De].usedTimes++;const ot=Ce[k.__cacheKey];void 0!==ot&&(Ce[k.__cacheKey].usedTimes--,0===ot.usedTimes&&V(P)),k.__cacheKey=De,k.__webglTexture=Ce[De].texture}return ie}function gt(k,P,ie){let Te=n.TEXTURE_2D;(P.isDataArrayTexture||P.isCompressedArrayTexture)&&(Te=n.TEXTURE_2D_ARRAY),P.isData3DTexture&&(Te=n.TEXTURE_3D);const Ce=Xe(k,P),De=P.source;t.bindTexture(Te,k.__webglTexture,n.TEXTURE0+ie);const ot=i.get(De);if(De.version!==ot.__version||!0===Ce){t.activeTexture(n.TEXTURE0+ie);const Ie=Mn.getPrimaries(Mn.workingColorSpace),qe=""===P.colorSpace?null:Mn.getPrimaries(P.colorSpace),W=""===P.colorSpace||Ie===qe?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,P.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,P.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,P.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,W);const Re=function C(k){return!a&&(k.wrapS!==Kr||k.wrapT!==Kr||k.minFilter!==Vi&&k.minFilter!==gi)}(P)&&!1===E(P.image);let we=x(P.image,Re,!1,d);we=fi(P,we);const Dt=E(we)||a,ct=s.convert(P.format,P.colorSpace);let H,_t=s.convert(P.type),at=L(P.internalFormat,ct,_t,P.colorSpace,P.isVideoTexture);Be(Te,P,Dt);const Fe=P.mipmaps,Pe=a&&!0!==P.isVideoTexture,je=void 0===ot.__version||!0===Ce,ke=M(P,we,Dt);if(P.isDepthTexture)at=n.DEPTH_COMPONENT,a?at=P.type===ic?n.DEPTH_COMPONENT32F:P.type===Au?n.DEPTH_COMPONENT24:P.type===oh?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT16:P.type===ic&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),P.format===ah&&at===n.DEPTH_COMPONENT&&1012!==P.type&&P.type!==Au&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),P.type=Au,_t=s.convert(P.type)),P.format===fm&&at===n.DEPTH_COMPONENT&&(at=n.DEPTH_STENCIL,P.type!==oh&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),P.type=oh,_t=s.convert(P.type))),je&&(Pe?t.texStorage2D(n.TEXTURE_2D,1,at,we.width,we.height):t.texImage2D(n.TEXTURE_2D,0,at,we.width,we.height,0,ct,_t,null));else if(P.isDataTexture)if(Fe.length>0&&Dt){Pe&&je&&t.texStorage2D(n.TEXTURE_2D,ke,at,Fe[0].width,Fe[0].height);for(let Ee=0,st=Fe.length;Ee<st;Ee++)H=Fe[Ee],Pe?t.texSubImage2D(n.TEXTURE_2D,Ee,0,0,H.width,H.height,ct,_t,H.data):t.texImage2D(n.TEXTURE_2D,Ee,at,H.width,H.height,0,ct,_t,H.data);P.generateMipmaps=!1}else Pe?(je&&t.texStorage2D(n.TEXTURE_2D,ke,at,we.width,we.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,we.width,we.height,ct,_t,we.data)):t.texImage2D(n.TEXTURE_2D,0,at,we.width,we.height,0,ct,_t,we.data);else if(P.isCompressedTexture)if(P.isCompressedArrayTexture){Pe&&je&&t.texStorage3D(n.TEXTURE_2D_ARRAY,ke,at,Fe[0].width,Fe[0].height,we.depth);for(let Ee=0,st=Fe.length;Ee<st;Ee++)H=Fe[Ee],P.format!==Fo?null!==ct?Pe?t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,Ee,0,0,0,H.width,H.height,we.depth,ct,H.data,0,0):t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,Ee,at,H.width,H.height,we.depth,0,H.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Pe?t.texSubImage3D(n.TEXTURE_2D_ARRAY,Ee,0,0,0,H.width,H.height,we.depth,ct,_t,H.data):t.texImage3D(n.TEXTURE_2D_ARRAY,Ee,at,H.width,H.height,we.depth,0,ct,_t,H.data)}else{Pe&&je&&t.texStorage2D(n.TEXTURE_2D,ke,at,Fe[0].width,Fe[0].height);for(let Ee=0,st=Fe.length;Ee<st;Ee++)H=Fe[Ee],P.format!==Fo?null!==ct?Pe?t.compressedTexSubImage2D(n.TEXTURE_2D,Ee,0,0,H.width,H.height,ct,H.data):t.compressedTexImage2D(n.TEXTURE_2D,Ee,at,H.width,H.height,0,H.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Pe?t.texSubImage2D(n.TEXTURE_2D,Ee,0,0,H.width,H.height,ct,_t,H.data):t.texImage2D(n.TEXTURE_2D,Ee,at,H.width,H.height,0,ct,_t,H.data)}else if(P.isDataArrayTexture)Pe?(je&&t.texStorage3D(n.TEXTURE_2D_ARRAY,ke,at,we.width,we.height,we.depth),t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,we.width,we.height,we.depth,ct,_t,we.data)):t.texImage3D(n.TEXTURE_2D_ARRAY,0,at,we.width,we.height,we.depth,0,ct,_t,we.data);else if(P.isData3DTexture)Pe?(je&&t.texStorage3D(n.TEXTURE_3D,ke,at,we.width,we.height,we.depth),t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,we.width,we.height,we.depth,ct,_t,we.data)):t.texImage3D(n.TEXTURE_3D,0,at,we.width,we.height,we.depth,0,ct,_t,we.data);else if(P.isFramebufferTexture){if(je)if(Pe)t.texStorage2D(n.TEXTURE_2D,ke,at,we.width,we.height);else{let Ee=we.width,st=we.height;for(let Rt=0;Rt<ke;Rt++)t.texImage2D(n.TEXTURE_2D,Rt,at,Ee,st,0,ct,_t,null),Ee>>=1,st>>=1}}else if(Fe.length>0&&Dt){Pe&&je&&t.texStorage2D(n.TEXTURE_2D,ke,at,Fe[0].width,Fe[0].height);for(let Ee=0,st=Fe.length;Ee<st;Ee++)H=Fe[Ee],Pe?t.texSubImage2D(n.TEXTURE_2D,Ee,0,0,ct,_t,H):t.texImage2D(n.TEXTURE_2D,Ee,at,ct,_t,H);P.generateMipmaps=!1}else Pe?(je&&t.texStorage2D(n.TEXTURE_2D,ke,at,we.width,we.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,ct,_t,we)):t.texImage2D(n.TEXTURE_2D,0,at,ct,_t,we);A(P,Dt)&&D(Te),ot.__version=De.version,P.onUpdate&&P.onUpdate(P)}k.__version=P.version}function it(k,P,ie,Te,Ce,De){const ot=s.convert(ie.format,ie.colorSpace),Ie=s.convert(ie.type),qe=L(ie.internalFormat,ot,Ie,ie.colorSpace);if(!i.get(P).__hasExternalTextures){const Re=Math.max(1,P.width>>De),we=Math.max(1,P.height>>De);Ce===n.TEXTURE_3D||Ce===n.TEXTURE_2D_ARRAY?t.texImage3D(Ce,De,qe,Re,we,P.depth,0,ot,Ie,null):t.texImage2D(Ce,De,qe,Re,we,0,ot,Ie,null)}t.bindFramebuffer(n.FRAMEBUFFER,k),Mt(P)?p.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,Te,Ce,i.get(ie).__webglTexture,0,et(P)):(Ce===n.TEXTURE_2D||Ce>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&Ce<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,Te,Ce,i.get(ie).__webglTexture,De),t.bindFramebuffer(n.FRAMEBUFFER,null)}function z(k,P,ie){if(n.bindRenderbuffer(n.RENDERBUFFER,k),P.depthBuffer&&!P.stencilBuffer){let Te=!0===a?n.DEPTH_COMPONENT24:n.DEPTH_COMPONENT16;if(ie||Mt(P)){const Ce=P.depthTexture;Ce&&Ce.isDepthTexture&&(Ce.type===ic?Te=n.DEPTH_COMPONENT32F:Ce.type===Au&&(Te=n.DEPTH_COMPONENT24));const De=et(P);Mt(P)?p.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,De,Te,P.width,P.height):n.renderbufferStorageMultisample(n.RENDERBUFFER,De,Te,P.width,P.height)}else n.renderbufferStorage(n.RENDERBUFFER,Te,P.width,P.height);n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,k)}else if(P.depthBuffer&&P.stencilBuffer){const Te=et(P);ie&&!1===Mt(P)?n.renderbufferStorageMultisample(n.RENDERBUFFER,Te,n.DEPTH24_STENCIL8,P.width,P.height):Mt(P)?p.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Te,n.DEPTH24_STENCIL8,P.width,P.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,P.width,P.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,k)}else{const Te=!0===P.isWebGLMultipleRenderTargets?P.texture:[P.texture];for(let Ce=0;Ce<Te.length;Ce++){const De=Te[Ce],ot=s.convert(De.format,De.colorSpace),Ie=s.convert(De.type),qe=L(De.internalFormat,ot,Ie,De.colorSpace),W=et(P);ie&&!1===Mt(P)?n.renderbufferStorageMultisample(n.RENDERBUFFER,W,qe,P.width,P.height):Mt(P)?p.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,W,qe,P.width,P.height):n.renderbufferStorage(n.RENDERBUFFER,qe,P.width,P.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function ye(k){const P=i.get(k),ie=!0===k.isWebGLCubeRenderTarget;if(k.depthTexture&&!P.__autoAllocateDepthBuffer){if(ie)throw new Error("target.depthTexture not supported in Cube render targets");!function Oe(k,P){if(P&&P.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,k),!P.depthTexture||!P.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(P.depthTexture).__webglTexture||P.depthTexture.image.width!==P.width||P.depthTexture.image.height!==P.height)&&(P.depthTexture.image.width=P.width,P.depthTexture.image.height=P.height,P.depthTexture.needsUpdate=!0),le(P.depthTexture,0);const Te=i.get(P.depthTexture).__webglTexture,Ce=et(P);if(P.depthTexture.format===ah)Mt(P)?p.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,Te,0,Ce):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,Te,0);else{if(P.depthTexture.format!==fm)throw new Error("Unknown depthTexture format");Mt(P)?p.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,Te,0,Ce):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,Te,0)}}(P.__webglFramebuffer,k)}else if(ie){P.__webglDepthbuffer=[];for(let Te=0;Te<6;Te++)t.bindFramebuffer(n.FRAMEBUFFER,P.__webglFramebuffer[Te]),P.__webglDepthbuffer[Te]=n.createRenderbuffer(),z(P.__webglDepthbuffer[Te],k,!1)}else t.bindFramebuffer(n.FRAMEBUFFER,P.__webglFramebuffer),P.__webglDepthbuffer=n.createRenderbuffer(),z(P.__webglDepthbuffer,k,!1);t.bindFramebuffer(n.FRAMEBUFFER,null)}function et(k){return Math.min(h,k.samples)}function Mt(k){const P=i.get(k);return a&&k.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==P.__useRenderToTexture}function fi(k,P){const ie=k.colorSpace,Te=k.format,Ce=k.type;return!0===k.isCompressedTexture||!0===k.isVideoTexture||1035===k.format||ie!==Lr&&""!==ie&&(Mn.getTransfer(ie)===ri?!1===a?!0===e.has("EXT_sRGB")&&Te===Fo?(k.format=1035,k.minFilter=gi,k.generateMipmaps=!1):P=HH.sRGBToLinear(P):(Te!==Fo||Ce!==Tu)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",ie)),P}this.allocateTextureUnit=function Q(){const k=G;return k>=l&&console.warn("THREE.WebGLTextures: Trying to use "+k+" texture units while this GPU supports only "+l),G+=1,k},this.resetTextureUnits=function X(){G=0},this.setTexture2D=le,this.setTexture2DArray=function q(k,P){const ie=i.get(k);k.version>0&&ie.__version!==k.version?gt(ie,k,P):t.bindTexture(n.TEXTURE_2D_ARRAY,ie.__webglTexture,n.TEXTURE0+P)},this.setTexture3D=function oe(k,P){const ie=i.get(k);k.version>0&&ie.__version!==k.version?gt(ie,k,P):t.bindTexture(n.TEXTURE_3D,ie.__webglTexture,n.TEXTURE0+P)},this.setTextureCube=function Se(k,P){const ie=i.get(k);k.version>0&&ie.__version!==k.version?function At(k,P,ie){if(6!==P.image.length)return;const Te=Xe(k,P),Ce=P.source;t.bindTexture(n.TEXTURE_CUBE_MAP,k.__webglTexture,n.TEXTURE0+ie);const De=i.get(Ce);if(Ce.version!==De.__version||!0===Te){t.activeTexture(n.TEXTURE0+ie);const ot=Mn.getPrimaries(Mn.workingColorSpace),Ie=""===P.colorSpace?null:Mn.getPrimaries(P.colorSpace),qe=""===P.colorSpace||ot===Ie?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,P.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,P.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,P.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,qe);const W=P.isCompressedTexture||P.image[0].isCompressedTexture,Re=P.image[0]&&P.image[0].isDataTexture,we=[];for(let Ee=0;Ee<6;Ee++)we[Ee]=W||Re?Re?P.image[Ee].image:P.image[Ee]:x(P.image[Ee],!1,!0,c),we[Ee]=fi(P,we[Ee]);const Dt=we[0],ct=E(Dt)||a,_t=s.convert(P.format,P.colorSpace),at=s.convert(P.type),H=L(P.internalFormat,_t,at,P.colorSpace),Fe=a&&!0!==P.isVideoTexture,Pe=void 0===De.__version||!0===Te;let ke,je=M(P,Dt,ct);if(Be(n.TEXTURE_CUBE_MAP,P,ct),W){Fe&&Pe&&t.texStorage2D(n.TEXTURE_CUBE_MAP,je,H,Dt.width,Dt.height);for(let Ee=0;Ee<6;Ee++){ke=we[Ee].mipmaps;for(let st=0;st<ke.length;st++){const Rt=ke[st];P.format!==Fo?null!==_t?Fe?t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ee,st,0,0,Rt.width,Rt.height,_t,Rt.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ee,st,H,Rt.width,Rt.height,0,Rt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Fe?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ee,st,0,0,Rt.width,Rt.height,_t,at,Rt.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ee,st,H,Rt.width,Rt.height,0,_t,at,Rt.data)}}}else{ke=P.mipmaps,Fe&&Pe&&(ke.length>0&&je++,t.texStorage2D(n.TEXTURE_CUBE_MAP,je,H,we[0].width,we[0].height));for(let Ee=0;Ee<6;Ee++)if(Re){Fe?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ee,0,0,0,we[Ee].width,we[Ee].height,_t,at,we[Ee].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ee,0,H,we[Ee].width,we[Ee].height,0,_t,at,we[Ee].data);for(let st=0;st<ke.length;st++){const Qi=ke[st].image[Ee].image;Fe?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ee,st+1,0,0,Qi.width,Qi.height,_t,at,Qi.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ee,st+1,H,Qi.width,Qi.height,0,_t,at,Qi.data)}}else{Fe?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ee,0,0,0,_t,at,we[Ee]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ee,0,H,_t,at,we[Ee]);for(let st=0;st<ke.length;st++){const Rt=ke[st];Fe?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ee,st+1,0,0,_t,at,Rt.image[Ee]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ee,st+1,H,_t,at,Rt.image[Ee])}}}A(P,ct)&&D(n.TEXTURE_CUBE_MAP),De.__version=Ce.version,P.onUpdate&&P.onUpdate(P)}k.__version=P.version}(ie,k,P):t.bindTexture(n.TEXTURE_CUBE_MAP,ie.__webglTexture,n.TEXTURE0+P)},this.rebindTextures=function Ae(k,P,ie){const Te=i.get(k);void 0!==P&&it(Te.__webglFramebuffer,k,k.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),void 0!==ie&&ye(k)},this.setupRenderTarget=function xe(k){const P=k.texture,ie=i.get(k),Te=i.get(P);k.addEventListener("dispose",ee),!0!==k.isWebGLMultipleRenderTargets&&(void 0===Te.__webglTexture&&(Te.__webglTexture=n.createTexture()),Te.__version=P.version,o.memory.textures++);const Ce=!0===k.isWebGLCubeRenderTarget,De=!0===k.isWebGLMultipleRenderTargets,ot=E(k)||a;if(Ce){ie.__webglFramebuffer=[];for(let Ie=0;Ie<6;Ie++)if(a&&P.mipmaps&&P.mipmaps.length>0){ie.__webglFramebuffer[Ie]=[];for(let qe=0;qe<P.mipmaps.length;qe++)ie.__webglFramebuffer[Ie][qe]=n.createFramebuffer()}else ie.__webglFramebuffer[Ie]=n.createFramebuffer()}else{if(a&&P.mipmaps&&P.mipmaps.length>0){ie.__webglFramebuffer=[];for(let Ie=0;Ie<P.mipmaps.length;Ie++)ie.__webglFramebuffer[Ie]=n.createFramebuffer()}else ie.__webglFramebuffer=n.createFramebuffer();if(De)if(r.drawBuffers){const Ie=k.texture;for(let qe=0,W=Ie.length;qe<W;qe++){const Re=i.get(Ie[qe]);void 0===Re.__webglTexture&&(Re.__webglTexture=n.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&k.samples>0&&!1===Mt(k)){const Ie=De?P:[P];ie.__webglMultisampledFramebuffer=n.createFramebuffer(),ie.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,ie.__webglMultisampledFramebuffer);for(let qe=0;qe<Ie.length;qe++){const W=Ie[qe];ie.__webglColorRenderbuffer[qe]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,ie.__webglColorRenderbuffer[qe]);const Re=s.convert(W.format,W.colorSpace),we=s.convert(W.type),Dt=L(W.internalFormat,Re,we,W.colorSpace,!0===k.isXRRenderTarget),ct=et(k);n.renderbufferStorageMultisample(n.RENDERBUFFER,ct,Dt,k.width,k.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+qe,n.RENDERBUFFER,ie.__webglColorRenderbuffer[qe])}n.bindRenderbuffer(n.RENDERBUFFER,null),k.depthBuffer&&(ie.__webglDepthRenderbuffer=n.createRenderbuffer(),z(ie.__webglDepthRenderbuffer,k,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(Ce){t.bindTexture(n.TEXTURE_CUBE_MAP,Te.__webglTexture),Be(n.TEXTURE_CUBE_MAP,P,ot);for(let Ie=0;Ie<6;Ie++)if(a&&P.mipmaps&&P.mipmaps.length>0)for(let qe=0;qe<P.mipmaps.length;qe++)it(ie.__webglFramebuffer[Ie][qe],k,P,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Ie,qe);else it(ie.__webglFramebuffer[Ie],k,P,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Ie,0);A(P,ot)&&D(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(De){const Ie=k.texture;for(let qe=0,W=Ie.length;qe<W;qe++){const Re=Ie[qe],we=i.get(Re);t.bindTexture(n.TEXTURE_2D,we.__webglTexture),Be(n.TEXTURE_2D,Re,ot),it(ie.__webglFramebuffer,k,Re,n.COLOR_ATTACHMENT0+qe,n.TEXTURE_2D,0),A(Re,ot)&&D(n.TEXTURE_2D)}t.unbindTexture()}else{let Ie=n.TEXTURE_2D;if((k.isWebGL3DRenderTarget||k.isWebGLArrayRenderTarget)&&(a?Ie=k.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(Ie,Te.__webglTexture),Be(Ie,P,ot),a&&P.mipmaps&&P.mipmaps.length>0)for(let qe=0;qe<P.mipmaps.length;qe++)it(ie.__webglFramebuffer[qe],k,P,n.COLOR_ATTACHMENT0,Ie,qe);else it(ie.__webglFramebuffer,k,P,n.COLOR_ATTACHMENT0,Ie,0);A(P,ot)&&D(Ie),t.unbindTexture()}k.depthBuffer&&ye(k)},this.updateRenderTargetMipmap=function lt(k){const P=E(k)||a,ie=!0===k.isWebGLMultipleRenderTargets?k.texture:[k.texture];for(let Te=0,Ce=ie.length;Te<Ce;Te++){const De=ie[Te];if(A(De,P)){const ot=k.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D,Ie=i.get(De).__webglTexture;t.bindTexture(ot,Ie),D(ot),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function Ze(k){if(a&&k.samples>0&&!1===Mt(k)){const P=k.isWebGLMultipleRenderTargets?k.texture:[k.texture],ie=k.width,Te=k.height;let Ce=n.COLOR_BUFFER_BIT;const De=[],ot=k.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Ie=i.get(k),qe=!0===k.isWebGLMultipleRenderTargets;if(qe)for(let W=0;W<P.length;W++)t.bindFramebuffer(n.FRAMEBUFFER,Ie.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+W,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,Ie.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+W,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,Ie.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Ie.__webglFramebuffer);for(let W=0;W<P.length;W++){De.push(n.COLOR_ATTACHMENT0+W),k.depthBuffer&&De.push(ot);const Re=void 0!==Ie.__ignoreDepthValues&&Ie.__ignoreDepthValues;if(!1===Re&&(k.depthBuffer&&(Ce|=n.DEPTH_BUFFER_BIT),k.stencilBuffer&&(Ce|=n.STENCIL_BUFFER_BIT)),qe&&n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,Ie.__webglColorRenderbuffer[W]),!0===Re&&(n.invalidateFramebuffer(n.READ_FRAMEBUFFER,[ot]),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[ot])),qe){const we=i.get(P[W]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,we,0)}n.blitFramebuffer(0,0,ie,Te,0,0,ie,Te,Ce,n.NEAREST),m&&n.invalidateFramebuffer(n.READ_FRAMEBUFFER,De)}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),qe)for(let W=0;W<P.length;W++){t.bindFramebuffer(n.FRAMEBUFFER,Ie.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+W,n.RENDERBUFFER,Ie.__webglColorRenderbuffer[W]);const Re=i.get(P[W]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,Ie.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+W,n.TEXTURE_2D,Re,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Ie.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=ye,this.setupFrameBufferTexture=it,this.useMultisampledRTT=Mt}function noe(n,e,t){const i=t.isWebGL2;return{convert:function r(s,o=""){let a;const l=Mn.getTransfer(o);if(s===Tu)return n.UNSIGNED_BYTE;if(1017===s)return n.UNSIGNED_SHORT_4_4_4_4;if(1018===s)return n.UNSIGNED_SHORT_5_5_5_1;if(1010===s)return n.BYTE;if(1011===s)return n.SHORT;if(1012===s)return n.UNSIGNED_SHORT;if(1013===s)return n.INT;if(s===Au)return n.UNSIGNED_INT;if(s===ic)return n.FLOAT;if(s===Cv)return i?n.HALF_FLOAT:(a=e.get("OES_texture_half_float"),null!==a?a.HALF_FLOAT_OES:null);if(1021===s)return n.ALPHA;if(s===Fo)return n.RGBA;if(1024===s)return n.LUMINANCE;if(1025===s)return n.LUMINANCE_ALPHA;if(s===ah)return n.DEPTH_COMPONENT;if(s===fm)return n.DEPTH_STENCIL;if(1035===s)return a=e.get("EXT_sRGB"),null!==a?a.SRGB_ALPHA_EXT:null;if(1028===s)return n.RED;if(1029===s)return n.RED_INTEGER;if(1030===s)return n.RG;if(1031===s)return n.RG_INTEGER;if(1033===s)return n.RGBA_INTEGER;if(33776===s||33777===s||33778===s||33779===s)if(l===ri){if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===a)return null;if(33776===s)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(a=e.get("WEBGL_compressed_texture_s3tc"),null===a)return null;if(33776===s)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===s)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===s)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===s)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===s||35841===s||35842===s||35843===s){if(a=e.get("WEBGL_compressed_texture_pvrtc"),null===a)return null;if(35840===s)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===s)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===s)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===s)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===s)return a=e.get("WEBGL_compressed_texture_etc1"),null!==a?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===s||37496===s){if(a=e.get("WEBGL_compressed_texture_etc"),null===a)return null;if(37492===s)return l===ri?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(37496===s)return l===ri?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}if(37808===s||37809===s||37810===s||37811===s||37812===s||37813===s||37814===s||37815===s||37816===s||37817===s||37818===s||37819===s||37820===s||37821===s){if(a=e.get("WEBGL_compressed_texture_astc"),null===a)return null;if(37808===s)return l===ri?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===s)return l===ri?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===s)return l===ri?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===s)return l===ri?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===s)return l===ri?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===s)return l===ri?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===s)return l===ri?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===s)return l===ri?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===s)return l===ri?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===s)return l===ri?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===s)return l===ri?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===s)return l===ri?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===s)return l===ri?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===s)return l===ri?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===s||36494===s||36495===s){if(a=e.get("EXT_texture_compression_bptc"),null===a)return null;if(36492===s)return l===ri?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(36494===s)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(36495===s)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(36283===s||36284===s||36285===s||36286===s){if(a=e.get("EXT_texture_compression_rgtc"),null===a)return null;if(36492===s)return a.COMPRESSED_RED_RGTC1_EXT;if(36284===s)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===s)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===s)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return s===oh?i?n.UNSIGNED_INT_24_8:(a=e.get("WEBGL_depth_texture"),null!==a?a.UNSIGNED_INT_24_8_WEBGL:null):void 0!==n[s]?n[s]:null}}}class ioe extends cr{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class xa extends si{constructor(){super(),this.isGroup=!0,this.type="Group"}}const roe={type:"move"};class bR{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new xa,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new xa,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new N,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new N),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new xa,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new N,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new N),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,i){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,c=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(c&&e.hand){o=!0;for(const v of e.hand.values()){const w=t.getJointPose(v,i),y=this._getHandJoint(c,v);null!==w&&(y.matrix.fromArray(w.transform.matrix),y.matrix.decompose(y.position,y.rotation,y.scale),y.matrixWorldNeedsUpdate=!0,y.jointRadius=w.radius),y.visible=null!==w}const p=c.joints["index-finger-tip"].position.distanceTo(c.joints["thumb-tip"].position),m=.02,g=.005;c.inputState.pinching&&p>m+g?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&p<=m-g&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==l&&e.gripSpace&&(s=t.getPose(e.gripSpace,i),null!==s&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));null!==a&&(r=t.getPose(e.targetRaySpace,i),null===r&&null!==s&&(r=s),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(roe)))}return null!==a&&(a.visible=null!==r),null!==l&&(l.visible=null!==s),null!==c&&(c.visible=null!==o),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const i=new xa;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}class soe extends Uo{constructor(e,t,i,r,s,o,a,l,c,d){if((d=void 0!==d?d:ah)!==ah&&d!==fm)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&d===ah&&(i=Au),void 0===i&&d===fm&&(i=oh),super(null,r,s,o,a,l,d,i,c),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==a?a:Vi,this.minFilter=void 0!==l?l:Vi,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}class ooe extends uh{constructor(e,t){super();const i=this;let r=null,s=1,o=null,a="local-floor",l=1,c=null,d=null,h=null,p=null,m=null,g=null;const v=t.getContextAttributes();let w=null,y=null;const b=[],x=[],E=new cr;E.layers.enable(1),E.viewport=new Ln;const C=new cr;C.layers.enable(2),C.viewport=new Ln;const A=[E,C],D=new ioe;D.layers.enable(1),D.layers.enable(2);let L=null,M=null;function R(q){const oe=x.indexOf(q.inputSource);if(-1===oe)return;const Se=b[oe];void 0!==Se&&(Se.update(q.inputSource,q.frame,c||o),Se.dispatchEvent({type:q.type,data:q.inputSource}))}function $(){r.removeEventListener("select",R),r.removeEventListener("selectstart",R),r.removeEventListener("selectend",R),r.removeEventListener("squeeze",R),r.removeEventListener("squeezestart",R),r.removeEventListener("squeezeend",R),r.removeEventListener("end",$),r.removeEventListener("inputsourceschange",ee);for(let q=0;q<b.length;q++){const oe=x[q];null!==oe&&(x[q]=null,b[q].disconnect(oe))}L=null,M=null,e.setRenderTarget(w),m=null,p=null,h=null,r=null,y=null,le.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}function ee(q){for(let oe=0;oe<q.removed.length;oe++){const Se=q.removed[oe],ve=x.indexOf(Se);ve>=0&&(x[ve]=null,b[ve].disconnect(Se))}for(let oe=0;oe<q.added.length;oe++){const Se=q.added[oe];let ve=x.indexOf(Se);if(-1===ve){for(let $e=0;$e<b.length;$e++){if($e>=x.length){x.push(Se),ve=$e;break}if(null===x[$e]){x[$e]=Se,ve=$e;break}}if(-1===ve)break}const Ne=b[ve];Ne&&Ne.connect(Se)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(q){let oe=b[q];return void 0===oe&&(oe=new bR,b[q]=oe),oe.getTargetRaySpace()},this.getControllerGrip=function(q){let oe=b[q];return void 0===oe&&(oe=new bR,b[q]=oe),oe.getGripSpace()},this.getHand=function(q){let oe=b[q];return void 0===oe&&(oe=new bR,b[q]=oe),oe.getHandSpace()},this.setFramebufferScaleFactor=function(q){s=q,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(q){a=q,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||o},this.setReferenceSpace=function(q){c=q},this.getBaseLayer=function(){return null!==p?p:m},this.getBinding=function(){return h},this.getFrame=function(){return g},this.getSession=function(){return r},this.setSession=function(){var q=On(function*(oe){if(r=oe,null!==r){if(w=e.getRenderTarget(),r.addEventListener("select",R),r.addEventListener("selectstart",R),r.addEventListener("selectend",R),r.addEventListener("squeeze",R),r.addEventListener("squeezestart",R),r.addEventListener("squeezeend",R),r.addEventListener("end",$),r.addEventListener("inputsourceschange",ee),!0!==v.xrCompatible&&(yield t.makeXRCompatible()),void 0===r.renderState.layers||!1===e.capabilities.isWebGL2)m=new XRWebGLLayer(r,t,{antialias:void 0!==r.renderState.layers||v.antialias,alpha:!0,depth:v.depth,stencil:v.stencil,framebufferScaleFactor:s}),r.updateRenderState({baseLayer:m}),y=new hh(m.framebufferWidth,m.framebufferHeight,{format:Fo,type:Tu,colorSpace:e.outputColorSpace,stencilBuffer:v.stencil});else{let Se=null,ve=null,Ne=null;v.depth&&(Ne=v.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,Se=v.stencil?fm:ah,ve=v.stencil?oh:Au);const $e={colorFormat:t.RGBA8,depthFormat:Ne,scaleFactor:s};h=new XRWebGLBinding(r,t),p=h.createProjectionLayer($e),r.updateRenderState({layers:[p]}),y=new hh(p.textureWidth,p.textureHeight,{format:Fo,type:Tu,depthTexture:new soe(p.textureWidth,p.textureHeight,ve,void 0,void 0,void 0,void 0,void 0,void 0,Se),stencilBuffer:v.stencil,colorSpace:e.outputColorSpace,samples:v.antialias?4:0}),e.properties.get(y).__ignoreDepthValues=p.ignoreDepthValues}y.isXRRenderTarget=!0,this.setFoveation(l),c=null,o=yield r.requestReferenceSpace(a),le.setContext(r),le.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}});return function(oe){return q.apply(this,arguments)}}(),this.getEnvironmentBlendMode=function(){if(null!==r)return r.environmentBlendMode};const se=new N,V=new N;function G(q,oe){null===oe?q.matrixWorld.copy(q.matrix):q.matrixWorld.multiplyMatrices(oe.matrixWorld,q.matrix),q.matrixWorldInverse.copy(q.matrixWorld).invert()}this.updateCamera=function(q){if(null===r)return;D.near=C.near=E.near=q.near,D.far=C.far=E.far=q.far,(L!==D.near||M!==D.far)&&(r.updateRenderState({depthNear:D.near,depthFar:D.far}),L=D.near,M=D.far);const oe=q.parent,Se=D.cameras;G(D,oe);for(let ve=0;ve<Se.length;ve++)G(Se[ve],oe);2===Se.length?function J(q,oe,Se){se.setFromMatrixPosition(oe.matrixWorld),V.setFromMatrixPosition(Se.matrixWorld);const ve=se.distanceTo(V),Ne=oe.projectionMatrix.elements,$e=Se.projectionMatrix.elements,Be=Ne[14]/(Ne[10]-1),Xe=Ne[14]/(Ne[10]+1),gt=(Ne[9]+1)/Ne[5],At=(Ne[9]-1)/Ne[5],it=(Ne[8]-1)/Ne[0],z=($e[8]+1)/$e[0],Oe=Be*it,ye=Be*z,Ae=ve/(-it+z),xe=Ae*-it;oe.matrixWorld.decompose(q.position,q.quaternion,q.scale),q.translateX(xe),q.translateZ(Ae),q.matrixWorld.compose(q.position,q.quaternion,q.scale),q.matrixWorldInverse.copy(q.matrixWorld).invert();const lt=Be+Ae,Ze=Xe+Ae;q.projectionMatrix.makePerspective(Oe-xe,ye+(ve-xe),gt*Xe/Ze*lt,At*Xe/Ze*lt,lt,Ze),q.projectionMatrixInverse.copy(q.projectionMatrix).invert()}(D,E,C):D.projectionMatrix.copy(E.projectionMatrix),function X(q,oe,Se){null===Se?q.matrix.copy(oe.matrixWorld):(q.matrix.copy(Se.matrixWorld),q.matrix.invert(),q.matrix.multiply(oe.matrixWorld)),q.matrix.decompose(q.position,q.quaternion,q.scale),q.updateMatrixWorld(!0),q.projectionMatrix.copy(oe.projectionMatrix),q.projectionMatrixInverse.copy(oe.projectionMatrixInverse),q.isPerspectiveCamera&&(q.fov=2*_m*Math.atan(1/q.projectionMatrix.elements[5]),q.zoom=1)}(q,D,oe)},this.getCamera=function(){return D},this.getFoveation=function(){if(null!==p||null!==m)return l},this.setFoveation=function(q){l=q,null!==p&&(p.fixedFoveation=q),null!==m&&void 0!==m.fixedFoveation&&(m.fixedFoveation=q)};let Q=null;const le=new az;le.setAnimationLoop(function Z(q,oe){if(d=oe.getViewerPose(c||o),g=oe,null!==d){const Se=d.views;null!==m&&(e.setRenderTargetFramebuffer(y,m.framebuffer),e.setRenderTarget(y));let ve=!1;Se.length!==D.cameras.length&&(D.cameras.length=0,ve=!0);for(let Ne=0;Ne<Se.length;Ne++){const $e=Se[Ne];let Be=null;if(null!==m)Be=m.getViewport($e);else{const gt=h.getViewSubImage(p,$e);Be=gt.viewport,0===Ne&&(e.setRenderTargetTextures(y,gt.colorTexture,p.ignoreDepthValues?void 0:gt.depthStencilTexture),e.setRenderTarget(y))}let Xe=A[Ne];void 0===Xe&&(Xe=new cr,Xe.layers.enable(Ne),Xe.viewport=new Ln,A[Ne]=Xe),Xe.matrix.fromArray($e.transform.matrix),Xe.matrix.decompose(Xe.position,Xe.quaternion,Xe.scale),Xe.projectionMatrix.fromArray($e.projectionMatrix),Xe.projectionMatrixInverse.copy(Xe.projectionMatrix).invert(),Xe.viewport.set(Be.x,Be.y,Be.width,Be.height),0===Ne&&(D.matrix.copy(Xe.matrix),D.matrix.decompose(D.position,D.quaternion,D.scale)),!0===ve&&D.cameras.push(Xe)}}for(let Se=0;Se<b.length;Se++){const ve=x[Se],Ne=b[Se];null!==ve&&void 0!==Ne&&Ne.update(ve,oe,c||o)}Q&&Q(q,oe),oe.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:oe}),g=null}),this.setAnimationLoop=function(q){Q=q},this.dispose=function(){}}}function aoe(n,e){function t(w,y){!0===w.matrixAutoUpdate&&w.updateMatrix(),y.value.copy(w.matrix)}function s(w,y){w.opacity.value=y.opacity,y.color&&w.diffuse.value.copy(y.color),y.emissive&&w.emissive.value.copy(y.emissive).multiplyScalar(y.emissiveIntensity),y.map&&(w.map.value=y.map,t(y.map,w.mapTransform)),y.alphaMap&&(w.alphaMap.value=y.alphaMap,t(y.alphaMap,w.alphaMapTransform)),y.bumpMap&&(w.bumpMap.value=y.bumpMap,t(y.bumpMap,w.bumpMapTransform),w.bumpScale.value=y.bumpScale,1===y.side&&(w.bumpScale.value*=-1)),y.normalMap&&(w.normalMap.value=y.normalMap,t(y.normalMap,w.normalMapTransform),w.normalScale.value.copy(y.normalScale),1===y.side&&w.normalScale.value.negate()),y.displacementMap&&(w.displacementMap.value=y.displacementMap,t(y.displacementMap,w.displacementMapTransform),w.displacementScale.value=y.displacementScale,w.displacementBias.value=y.displacementBias),y.emissiveMap&&(w.emissiveMap.value=y.emissiveMap,t(y.emissiveMap,w.emissiveMapTransform)),y.specularMap&&(w.specularMap.value=y.specularMap,t(y.specularMap,w.specularMapTransform)),y.alphaTest>0&&(w.alphaTest.value=y.alphaTest);const b=e.get(y).envMap;if(b&&(w.envMap.value=b,w.flipEnvMap.value=b.isCubeTexture&&!1===b.isRenderTargetTexture?-1:1,w.reflectivity.value=y.reflectivity,w.ior.value=y.ior,w.refractionRatio.value=y.refractionRatio),y.lightMap){w.lightMap.value=y.lightMap;const x=!0===n._useLegacyLights?Math.PI:1;w.lightMapIntensity.value=y.lightMapIntensity*x,t(y.lightMap,w.lightMapTransform)}y.aoMap&&(w.aoMap.value=y.aoMap,w.aoMapIntensity.value=y.aoMapIntensity,t(y.aoMap,w.aoMapTransform))}return{refreshFogUniforms:function i(w,y){y.color.getRGB(w.fogColor.value,oz(n)),y.isFog?(w.fogNear.value=y.near,w.fogFar.value=y.far):y.isFogExp2&&(w.fogDensity.value=y.density)},refreshMaterialUniforms:function r(w,y,b,x,E){y.isMeshBasicMaterial||y.isMeshLambertMaterial?s(w,y):y.isMeshToonMaterial?(s(w,y),function h(w,y){y.gradientMap&&(w.gradientMap.value=y.gradientMap)}(w,y)):y.isMeshPhongMaterial?(s(w,y),function d(w,y){w.specular.value.copy(y.specular),w.shininess.value=Math.max(y.shininess,1e-4)}(w,y)):y.isMeshStandardMaterial?(s(w,y),function p(w,y){w.metalness.value=y.metalness,y.metalnessMap&&(w.metalnessMap.value=y.metalnessMap,t(y.metalnessMap,w.metalnessMapTransform)),w.roughness.value=y.roughness,y.roughnessMap&&(w.roughnessMap.value=y.roughnessMap,t(y.roughnessMap,w.roughnessMapTransform)),e.get(y).envMap&&(w.envMapIntensity.value=y.envMapIntensity)}(w,y),y.isMeshPhysicalMaterial&&function m(w,y,b){w.ior.value=y.ior,y.sheen>0&&(w.sheenColor.value.copy(y.sheenColor).multiplyScalar(y.sheen),w.sheenRoughness.value=y.sheenRoughness,y.sheenColorMap&&(w.sheenColorMap.value=y.sheenColorMap,t(y.sheenColorMap,w.sheenColorMapTransform)),y.sheenRoughnessMap&&(w.sheenRoughnessMap.value=y.sheenRoughnessMap,t(y.sheenRoughnessMap,w.sheenRoughnessMapTransform))),y.clearcoat>0&&(w.clearcoat.value=y.clearcoat,w.clearcoatRoughness.value=y.clearcoatRoughness,y.clearcoatMap&&(w.clearcoatMap.value=y.clearcoatMap,t(y.clearcoatMap,w.clearcoatMapTransform)),y.clearcoatRoughnessMap&&(w.clearcoatRoughnessMap.value=y.clearcoatRoughnessMap,t(y.clearcoatRoughnessMap,w.clearcoatRoughnessMapTransform)),y.clearcoatNormalMap&&(w.clearcoatNormalMap.value=y.clearcoatNormalMap,t(y.clearcoatNormalMap,w.clearcoatNormalMapTransform),w.clearcoatNormalScale.value.copy(y.clearcoatNormalScale),1===y.side&&w.clearcoatNormalScale.value.negate())),y.iridescence>0&&(w.iridescence.value=y.iridescence,w.iridescenceIOR.value=y.iridescenceIOR,w.iridescenceThicknessMinimum.value=y.iridescenceThicknessRange[0],w.iridescenceThicknessMaximum.value=y.iridescenceThicknessRange[1],y.iridescenceMap&&(w.iridescenceMap.value=y.iridescenceMap,t(y.iridescenceMap,w.iridescenceMapTransform)),y.iridescenceThicknessMap&&(w.iridescenceThicknessMap.value=y.iridescenceThicknessMap,t(y.iridescenceThicknessMap,w.iridescenceThicknessMapTransform))),y.transmission>0&&(w.transmission.value=y.transmission,w.transmissionSamplerMap.value=b.texture,w.transmissionSamplerSize.value.set(b.width,b.height),y.transmissionMap&&(w.transmissionMap.value=y.transmissionMap,t(y.transmissionMap,w.transmissionMapTransform)),w.thickness.value=y.thickness,y.thicknessMap&&(w.thicknessMap.value=y.thicknessMap,t(y.thicknessMap,w.thicknessMapTransform)),w.attenuationDistance.value=y.attenuationDistance,w.attenuationColor.value.copy(y.attenuationColor)),y.anisotropy>0&&(w.anisotropyVector.value.set(y.anisotropy*Math.cos(y.anisotropyRotation),y.anisotropy*Math.sin(y.anisotropyRotation)),y.anisotropyMap&&(w.anisotropyMap.value=y.anisotropyMap,t(y.anisotropyMap,w.anisotropyMapTransform))),w.specularIntensity.value=y.specularIntensity,w.specularColor.value.copy(y.specularColor),y.specularColorMap&&(w.specularColorMap.value=y.specularColorMap,t(y.specularColorMap,w.specularColorMapTransform)),y.specularIntensityMap&&(w.specularIntensityMap.value=y.specularIntensityMap,t(y.specularIntensityMap,w.specularIntensityMapTransform))}(w,y,E)):y.isMeshMatcapMaterial?(s(w,y),function g(w,y){y.matcap&&(w.matcap.value=y.matcap)}(w,y)):y.isMeshDepthMaterial?s(w,y):y.isMeshDistanceMaterial?(s(w,y),function v(w,y){const b=e.get(y).light;w.referencePosition.value.setFromMatrixPosition(b.matrixWorld),w.nearDistance.value=b.shadow.camera.near,w.farDistance.value=b.shadow.camera.far}(w,y)):y.isMeshNormalMaterial?s(w,y):y.isLineBasicMaterial?(function o(w,y){w.diffuse.value.copy(y.color),w.opacity.value=y.opacity,y.map&&(w.map.value=y.map,t(y.map,w.mapTransform))}(w,y),y.isLineDashedMaterial&&function a(w,y){w.dashSize.value=y.dashSize,w.totalSize.value=y.dashSize+y.gapSize,w.scale.value=y.scale}(w,y)):y.isPointsMaterial?function l(w,y,b,x){w.diffuse.value.copy(y.color),w.opacity.value=y.opacity,w.size.value=y.size*b,w.scale.value=.5*x,y.map&&(w.map.value=y.map,t(y.map,w.uvTransform)),y.alphaMap&&(w.alphaMap.value=y.alphaMap,t(y.alphaMap,w.alphaMapTransform)),y.alphaTest>0&&(w.alphaTest.value=y.alphaTest)}(w,y,b,x):y.isSpriteMaterial?function c(w,y){w.diffuse.value.copy(y.color),w.opacity.value=y.opacity,w.rotation.value=y.rotation,y.map&&(w.map.value=y.map,t(y.map,w.mapTransform)),y.alphaMap&&(w.alphaMap.value=y.alphaMap,t(y.alphaMap,w.alphaMapTransform)),y.alphaTest>0&&(w.alphaTest.value=y.alphaTest)}(w,y):y.isShadowMaterial?(w.color.value.copy(y.color),w.opacity.value=y.opacity):y.isShaderMaterial&&(y.uniformsNeedUpdate=!1)}}}function loe(n,e,t,i){let r={},s={},o=[];const a=t.isWebGL2?n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS):0;function m(b,x,E){const C=b.value;if(void 0===E[x]){if("number"==typeof C)E[x]=C;else{const A=Array.isArray(C)?C:[C],D=[];for(let L=0;L<A.length;L++)D.push(A[L].clone());E[x]=D}return!0}if("number"==typeof C){if(E[x]!==C)return E[x]=C,!0}else{const A=Array.isArray(E[x])?E[x]:[E[x]],D=Array.isArray(C)?C:[C];for(let L=0;L<A.length;L++){const M=A[L];if(!1===M.equals(D[L]))return M.copy(D[L]),!0}}return!1}function v(b){const x={boundary:0,storage:0};return"number"==typeof b?(x.boundary=4,x.storage=4):b.isVector2?(x.boundary=8,x.storage=8):b.isVector3||b.isColor?(x.boundary=16,x.storage=12):b.isVector4?(x.boundary=16,x.storage=16):b.isMatrix3?(x.boundary=48,x.storage=48):b.isMatrix4?(x.boundary=64,x.storage=64):b.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",b),x}function w(b){const x=b.target;x.removeEventListener("dispose",w);const E=o.indexOf(x.__bindingPointIndex);o.splice(E,1),n.deleteBuffer(r[x.id]),delete r[x.id],delete s[x.id]}return{bind:function l(b,x){i.uniformBlockBinding(b,x.program)},update:function c(b,x){let E=r[b.id];void 0===E&&(function g(b){const x=b.uniforms;let E=0;let A=0;for(let D=0,L=x.length;D<L;D++){const M=x[D],R={boundary:0,storage:0},$=Array.isArray(M.value)?M.value:[M.value];for(let ee=0,se=$.length;ee<se;ee++){const J=v($[ee]);R.boundary+=J.boundary,R.storage+=J.storage}M.__data=new Float32Array(R.storage/Float32Array.BYTES_PER_ELEMENT),M.__offset=E,D>0&&(A=E%16,0!==A&&16-A-R.boundary<0&&(E+=16-A,M.__offset=E)),E+=R.storage}A=E%16,A>0&&(E+=16-A),b.__size=E,b.__cache={}}(b),E=function d(b){const x=function h(){for(let b=0;b<a;b++)if(-1===o.indexOf(b))return o.push(b),b;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();b.__bindingPointIndex=x;const E=n.createBuffer(),C=b.__size,A=b.usage;return n.bindBuffer(n.UNIFORM_BUFFER,E),n.bufferData(n.UNIFORM_BUFFER,C,A),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,x,E),E}(b),r[b.id]=E,b.addEventListener("dispose",w)),i.updateUBOMapping(b,x.program);const A=e.render.frame;s[b.id]!==A&&(function p(b){const E=b.uniforms,C=b.__cache;n.bindBuffer(n.UNIFORM_BUFFER,r[b.id]);for(let A=0,D=E.length;A<D;A++){const L=E[A];if(!0===m(L,A,C)){const M=L.__offset,R=Array.isArray(L.value)?L.value:[L.value];let $=0;for(let ee=0;ee<R.length;ee++){const se=R[ee],V=v(se);"number"==typeof se?(L.__data[0]=se,n.bufferSubData(n.UNIFORM_BUFFER,M+$,L.__data)):se.isMatrix3?(L.__data[0]=se.elements[0],L.__data[1]=se.elements[1],L.__data[2]=se.elements[2],L.__data[3]=se.elements[0],L.__data[4]=se.elements[3],L.__data[5]=se.elements[4],L.__data[6]=se.elements[5],L.__data[7]=se.elements[0],L.__data[8]=se.elements[6],L.__data[9]=se.elements[7],L.__data[10]=se.elements[8],L.__data[11]=se.elements[0]):(se.toArray(L.__data,$),$+=V.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,M,L.__data)}}n.bindBuffer(n.UNIFORM_BUFFER,null)}(b),s[b.id]=A)},dispose:function y(){for(const b in r)n.deleteBuffer(r[b]);o=[],r={},s={}}}}class xR{constructor(e={}){const{canvas:t=Gte(),context:i=null,depth:r=!0,stencil:s=!0,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:c=!1,powerPreference:d="default",failIfMajorPerformanceCaveat:h=!1}=e;let p;this.isWebGLRenderer=!0,p=null!==i?i.getContextAttributes().alpha:o;const m=new Uint32Array(4),g=new Int32Array(4);let v=null,w=null;const y=[],b=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=_i,this._useLegacyLights=!1,this.toneMapping=Cu,this.toneMappingExposure=1;const x=this;let E=!1,C=0,A=0,D=null,L=-1,M=null;const R=new Ln,$=new Ln;let ee=null;const se=new We(0);let V=0,J=t.width,G=t.height,X=1,Q=null,Z=null;const le=new Ln(0,0,J,G),q=new Ln(0,0,J,G);let oe=!1;const Se=new pR;let ve=!1,Ne=!1,$e=null;const Be=new Ct,Xe=new fe,gt=new N,At={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function it(){return null===D?X:1}let ye,Ae,xe,lt,Ze,et,Mt,sn,fi,k,P,ie,Te,Ce,De,ot,Ie,qe,W,Re,we,Dt,ct,_t,z=i;function Oe(F,te){for(let de=0;de<F.length;de++){const he=t.getContext(F[de],te);if(null!==he)return he}return null}try{const F={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:d,failIfMajorPerformanceCaveat:h};if("setAttribute"in t&&t.setAttribute("data-engine","three.js r157"),t.addEventListener("webglcontextlost",Fe,!1),t.addEventListener("webglcontextrestored",Pe,!1),t.addEventListener("webglcontextcreationerror",je,!1),null===z){const te=["webgl2","webgl","experimental-webgl"];if(!0===x.isWebGL1Renderer&&te.shift(),z=Oe(te,F),null===z)throw Oe(te)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&z instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),void 0===z.getShaderPrecisionFormat&&(z.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(F){throw console.error("THREE.WebGLRenderer: "+F.message),F}function at(){ye=new bre(z),Ae=new mre(z,ye,e),ye.init(Ae),Dt=new noe(z,ye,Ae),xe=new eoe(z,ye,Ae),lt=new Ere(z),Ze=new zse,et=new toe(z,ye,xe,Ze,Ae,Dt,lt),Mt=new _re(x),sn=new wre(x),fi=new pne(z,Ae),ct=new fre(z,ye,fi,Ae),k=new xre(z,fi,lt,ct),P=new Are(z,k,fi,lt),W=new Tre(z,Ae,et),ot=new gre(Ze),ie=new Hse(x,Mt,sn,ye,Ae,ct,ot),Te=new aoe(x,Ze),Ce=new Wse,De=new Kse(ye,Ae),qe=new hre(x,Mt,sn,xe,P,p,l),Ie=new Qse(x,P,Ae),_t=new loe(z,lt,Ae,xe),Re=new pre(z,ye,lt,Ae),we=new Sre(z,ye,lt,Ae),lt.programs=ie.programs,x.capabilities=Ae,x.extensions=ye,x.properties=Ze,x.renderLists=Ce,x.shadowMap=Ie,x.state=xe,x.info=lt}at();const H=new ooe(x,z);function Fe(F){F.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),E=!0}function Pe(){console.log("THREE.WebGLRenderer: Context Restored."),E=!1;const F=lt.autoReset,te=Ie.enabled,de=Ie.autoUpdate,ne=Ie.needsUpdate,he=Ie.type;at(),lt.autoReset=F,Ie.enabled=te,Ie.autoUpdate=de,Ie.needsUpdate=ne,Ie.type=he}function je(F){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",F.statusMessage)}function ke(F){const te=F.target;te.removeEventListener("dispose",ke),function Ee(F){(function st(F){const te=Ze.get(F).programs;void 0!==te&&(te.forEach(function(de){ie.releaseProgram(de)}),F.isShaderMaterial&&ie.releaseShaderCache(F))})(F),Ze.remove(F)}(te)}this.xr=H,this.getContext=function(){return z},this.getContextAttributes=function(){return z.getContextAttributes()},this.forceContextLoss=function(){const F=ye.get("WEBGL_lose_context");F&&F.loseContext()},this.forceContextRestore=function(){const F=ye.get("WEBGL_lose_context");F&&F.restoreContext()},this.getPixelRatio=function(){return X},this.setPixelRatio=function(F){void 0!==F&&(X=F,this.setSize(J,G,!1))},this.getSize=function(F){return F.set(J,G)},this.setSize=function(F,te,de=!0){H.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(J=F,G=te,t.width=Math.floor(F*X),t.height=Math.floor(te*X),!0===de&&(t.style.width=F+"px",t.style.height=te+"px"),this.setViewport(0,0,F,te))},this.getDrawingBufferSize=function(F){return F.set(J*X,G*X).floor()},this.setDrawingBufferSize=function(F,te,de){J=F,G=te,X=de,t.width=Math.floor(F*de),t.height=Math.floor(te*de),this.setViewport(0,0,F,te)},this.getCurrentViewport=function(F){return F.copy(R)},this.getViewport=function(F){return F.copy(le)},this.setViewport=function(F,te,de,ne){F.isVector4?le.set(F.x,F.y,F.z,F.w):le.set(F,te,de,ne),xe.viewport(R.copy(le).multiplyScalar(X).floor())},this.getScissor=function(F){return F.copy(q)},this.setScissor=function(F,te,de,ne){F.isVector4?q.set(F.x,F.y,F.z,F.w):q.set(F,te,de,ne),xe.scissor($.copy(q).multiplyScalar(X).floor())},this.getScissorTest=function(){return oe},this.setScissorTest=function(F){xe.setScissorTest(oe=F)},this.setOpaqueSort=function(F){Q=F},this.setTransparentSort=function(F){Z=F},this.getClearColor=function(F){return F.copy(qe.getClearColor())},this.setClearColor=function(){qe.setClearColor.apply(qe,arguments)},this.getClearAlpha=function(){return qe.getClearAlpha()},this.setClearAlpha=function(){qe.setClearAlpha.apply(qe,arguments)},this.clear=function(F=!0,te=!0,de=!0){let ne=0;if(F){let he=!1;if(null!==D){const tt=D.texture.format;he=1033===tt||1031===tt||1029===tt}if(he){const tt=D.texture.type,Et=tt===Tu||tt===Au||1012===tt||tt===oh||1017===tt||1018===tt,kt=qe.getClearColor(),Ut=qe.getClearAlpha(),on=kt.r,Lt=kt.g,Kt=kt.b;Et?(m[0]=on,m[1]=Lt,m[2]=Kt,m[3]=Ut,z.clearBufferuiv(z.COLOR,0,m)):(g[0]=on,g[1]=Lt,g[2]=Kt,g[3]=Ut,z.clearBufferiv(z.COLOR,0,g))}else ne|=z.COLOR_BUFFER_BIT}te&&(ne|=z.DEPTH_BUFFER_BIT),de&&(ne|=z.STENCIL_BUFFER_BIT),z.clear(ne)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Fe,!1),t.removeEventListener("webglcontextrestored",Pe,!1),t.removeEventListener("webglcontextcreationerror",je,!1),Ce.dispose(),De.dispose(),Ze.dispose(),Mt.dispose(),sn.dispose(),P.dispose(),ct.dispose(),_t.dispose(),ie.dispose(),H.dispose(),H.removeEventListener("sessionstart",ci),H.removeEventListener("sessionend",fl),$e&&($e.dispose(),$e=null),Ms.stop()},this.renderBufferDirect=function(F,te,de,ne,he,tt){null===te&&(te=At);const Et=he.isMesh&&he.matrixWorld.determinant()<0,kt=function Xfe(F,te,de,ne,he){!0!==te.isScene&&(te=At),et.resetTextureUnits();const tt=te.fog,kt=null===D?x.outputColorSpace:!0===D.isXRRenderTarget?D.texture.colorSpace:Lr,Ut=(ne.isMeshStandardMaterial?sn:Mt).get(ne.envMap||(ne.isMeshStandardMaterial?te.environment:null)),on=!0===ne.vertexColors&&!!de.attributes.color&&4===de.attributes.color.itemSize,Lt=!!de.attributes.tangent&&(!!ne.normalMap||ne.anisotropy>0),Kt=!!de.morphAttributes.position,Ri=!!de.morphAttributes.normal,zi=!!de.morphAttributes.color;let zo=Cu;ne.toneMapped&&(null===D||!0===D.isXRRenderTarget)&&(zo=x.toneMapping);const bc=de.morphAttributes.position||de.morphAttributes.normal||de.morphAttributes.color,er=void 0!==bc?bc.length:0,cn=Ze.get(ne),NN=w.state.lights;!0!==ve||!0!==Ne&&F===M||ot.setState(ne,F,F===M&&ne.id===L);let tr=!1;ne.version===cn.__version?(cn.needsLights&&cn.lightsStateVersion!==NN.state.version||cn.outputColorSpace!==kt||he.isInstancedMesh&&!1===cn.instancing||!he.isInstancedMesh&&!0===cn.instancing||he.isSkinnedMesh&&!1===cn.skinning||!he.isSkinnedMesh&&!0===cn.skinning||he.isInstancedMesh&&!0===cn.instancingColor&&null===he.instanceColor||he.isInstancedMesh&&!1===cn.instancingColor&&null!==he.instanceColor||cn.envMap!==Ut||!0===ne.fog&&cn.fog!==tt||void 0!==cn.numClippingPlanes&&(cn.numClippingPlanes!==ot.numPlanes||cn.numIntersection!==ot.numIntersection)||cn.vertexAlphas!==on||cn.vertexTangents!==Lt||cn.morphTargets!==Kt||cn.morphNormals!==Ri||cn.morphColors!==zi||cn.toneMapping!==zo||!0===Ae.isWebGL2&&cn.morphTargetsCount!==er)&&(tr=!0):(tr=!0,cn.__version=ne.version);let Bh=cn.currentProgram;!0===tr&&(Bh=$C(ne,te,he));let IW=!1,P0=!1,ON=!1;const Ts=Bh.getUniforms(),Vh=cn.uniforms;if(xe.useProgram(Bh.program)&&(IW=!0,P0=!0,ON=!0),ne.id!==L&&(L=ne.id,P0=!0),IW||M!==F){Ts.setValue(z,"projectionMatrix",F.projectionMatrix),Ts.setValue(z,"viewMatrix",F.matrixWorldInverse);const go=Ts.map.cameraPosition;void 0!==go&&go.setValue(z,gt.setFromMatrixPosition(F.matrixWorld)),Ae.logarithmicDepthBuffer&&Ts.setValue(z,"logDepthBufFC",2/(Math.log(F.far+1)/Math.LN2)),(ne.isMeshPhongMaterial||ne.isMeshToonMaterial||ne.isMeshLambertMaterial||ne.isMeshBasicMaterial||ne.isMeshStandardMaterial||ne.isShaderMaterial)&&Ts.setValue(z,"isOrthographic",!0===F.isOrthographicCamera),M!==F&&(M=F,P0=!0,ON=!0)}if(he.isSkinnedMesh){Ts.setOptional(z,he,"bindMatrix"),Ts.setOptional(z,he,"bindMatrixInverse");const go=he.skeleton;go&&(Ae.floatVertexTextures?(null===go.boneTexture&&go.computeBoneTexture(),Ts.setValue(z,"boneTexture",go.boneTexture,et),Ts.setValue(z,"boneTextureSize",go.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const LN=de.morphAttributes;if((void 0!==LN.position||void 0!==LN.normal||void 0!==LN.color&&!0===Ae.isWebGL2)&&W.update(he,de,Bh),(P0||cn.receiveShadow!==he.receiveShadow)&&(cn.receiveShadow=he.receiveShadow,Ts.setValue(z,"receiveShadow",he.receiveShadow)),ne.isMeshGouraudMaterial&&null!==ne.envMap&&(Vh.envMap.value=Ut,Vh.flipEnvMap.value=Ut.isCubeTexture&&!1===Ut.isRenderTargetTexture?-1:1),P0&&(Ts.setValue(z,"toneMappingExposure",x.toneMappingExposure),cn.needsLights&&function Yfe(F,te){F.ambientLightColor.needsUpdate=te,F.lightProbe.needsUpdate=te,F.directionalLights.needsUpdate=te,F.directionalLightShadows.needsUpdate=te,F.pointLights.needsUpdate=te,F.pointLightShadows.needsUpdate=te,F.spotLights.needsUpdate=te,F.spotLightShadows.needsUpdate=te,F.rectAreaLights.needsUpdate=te,F.hemisphereLights.needsUpdate=te}(Vh,ON),tt&&!0===ne.fog&&Te.refreshFogUniforms(Vh,tt),Te.refreshMaterialUniforms(Vh,ne,X,G,$e),vE.upload(z,cn.uniformsList,Vh,et)),ne.isShaderMaterial&&!0===ne.uniformsNeedUpdate&&(vE.upload(z,cn.uniformsList,Vh,et),ne.uniformsNeedUpdate=!1),ne.isSpriteMaterial&&Ts.setValue(z,"center",he.center),Ts.setValue(z,"modelViewMatrix",he.modelViewMatrix),Ts.setValue(z,"normalMatrix",he.normalMatrix),Ts.setValue(z,"modelMatrix",he.matrixWorld),ne.isShaderMaterial||ne.isRawShaderMaterial){const go=ne.uniformsGroups;for(let FN=0,Zfe=go.length;FN<Zfe;FN++)if(Ae.isWebGL2){const RW=go[FN];_t.update(RW,Bh),_t.bind(RW,Bh)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Bh}(F,te,de,ne,he);xe.setMaterial(ne,Et);let Ut=de.index,on=1;if(!0===ne.wireframe){if(Ut=k.getWireframeAttribute(de),void 0===Ut)return;on=2}const Lt=de.drawRange,Kt=de.attributes.position;let Ri=Lt.start*on,zi=(Lt.start+Lt.count)*on;null!==tt&&(Ri=Math.max(Ri,tt.start*on),zi=Math.min(zi,(tt.start+tt.count)*on)),null!==Ut?(Ri=Math.max(Ri,0),zi=Math.min(zi,Ut.count)):null!=Kt&&(Ri=Math.max(Ri,0),zi=Math.min(zi,Kt.count));const zo=zi-Ri;if(zo<0||zo===1/0)return;ct.setup(he,ne,kt,de,Ut);let bc,er=Re;if(null!==Ut&&(bc=fi.get(Ut),er=we,er.setIndex(bc)),he.isMesh)!0===ne.wireframe?(xe.setLineWidth(ne.wireframeLinewidth*it()),er.setMode(z.LINES)):er.setMode(z.TRIANGLES);else if(he.isLine){let cn=ne.linewidth;void 0===cn&&(cn=1),xe.setLineWidth(cn*it()),er.setMode(he.isLineSegments?z.LINES:he.isLineLoop?z.LINE_LOOP:z.LINE_STRIP)}else he.isPoints?er.setMode(z.POINTS):he.isSprite&&er.setMode(z.TRIANGLES);if(he.isInstancedMesh)er.renderInstances(Ri,zo,he.count);else if(de.isInstancedBufferGeometry){const NN=Math.min(de.instanceCount,void 0!==de._maxInstanceCount?de._maxInstanceCount:1/0);er.renderInstances(Ri,zo,NN)}else er.render(Ri,zo)},this.compile=function(F,te){function de(ne,he,tt){!0===ne.transparent&&2===ne.side&&!1===ne.forceSinglePass?(ne.side=1,ne.needsUpdate=!0,$C(ne,he,tt),ne.side=0,ne.needsUpdate=!0,$C(ne,he,tt),ne.side=2):$C(ne,he,tt)}w=De.get(F),w.init(),b.push(w),F.traverseVisible(function(ne){ne.isLight&&ne.layers.test(te.layers)&&(w.pushLight(ne),ne.castShadow&&w.pushShadow(ne))}),w.setupLights(x._useLegacyLights),F.traverse(function(ne){const he=ne.material;if(he)if(Array.isArray(he))for(let tt=0;tt<he.length;tt++)de(he[tt],F,ne);else de(he,F,ne)}),b.pop(),w=null};let Rt=null;function ci(){Ms.stop()}function fl(){Ms.start()}const Ms=new az;function MW(F,te,de,ne){if(!1===F.visible)return;if(F.layers.test(te.layers))if(F.isGroup)de=F.renderOrder;else if(F.isLOD)!0===F.autoUpdate&&F.update(te);else if(F.isLight)w.pushLight(F),F.castShadow&&w.pushShadow(F);else if(F.isSprite){if(!F.frustumCulled||Se.intersectsSprite(F)){ne&&gt.setFromMatrixPosition(F.matrixWorld).applyMatrix4(Be);const Et=P.update(F),kt=F.material;kt.visible&&v.push(F,Et,kt,de,gt.z,null)}}else if((F.isMesh||F.isLine||F.isPoints)&&(!F.frustumCulled||Se.intersectsObject(F))){const Et=P.update(F),kt=F.material;if(ne&&(void 0!==F.boundingSphere?(null===F.boundingSphere&&F.computeBoundingSphere(),gt.copy(F.boundingSphere.center)):(null===Et.boundingSphere&&Et.computeBoundingSphere(),gt.copy(Et.boundingSphere.center)),gt.applyMatrix4(F.matrixWorld).applyMatrix4(Be)),Array.isArray(kt)){const Ut=Et.groups;for(let on=0,Lt=Ut.length;on<Lt;on++){const Kt=Ut[on],Ri=kt[Kt.materialIndex];Ri&&Ri.visible&&v.push(F,Et,Ri,de,gt.z,Kt)}}else kt.visible&&v.push(F,Et,kt,de,gt.z,null)}const tt=F.children;for(let Et=0,kt=tt.length;Et<kt;Et++)MW(tt[Et],te,de,ne)}function TW(F,te,de,ne){const he=F.opaque,tt=F.transmissive,Et=F.transparent;w.setupLightsView(de),!0===ve&&ot.setGlobalState(x.clippingPlanes,de),tt.length>0&&function qfe(F,te,de,ne){const he=Ae.isWebGL2;null===$e&&($e=new hh(1,1,{generateMipmaps:!0,type:ye.has("EXT_color_buffer_half_float")?Cv:Tu,minFilter:nc,samples:he?4:0})),x.getDrawingBufferSize(Xe),he?$e.setSize(Xe.x,Xe.y):$e.setSize(XS(Xe.x),XS(Xe.y));const tt=x.getRenderTarget();x.setRenderTarget($e),x.getClearColor(se),V=x.getClearAlpha(),V<1&&x.setClearColor(16777215,.5),x.clear();const Et=x.toneMapping;x.toneMapping=Cu,jC(F,de,ne),et.updateMultisampleRenderTarget($e),et.updateRenderTargetMipmap($e);let kt=!1;for(let Ut=0,on=te.length;Ut<on;Ut++){const Lt=te[Ut],Kt=Lt.object,Ri=Lt.geometry,zi=Lt.material,zo=Lt.group;if(2===zi.side&&Kt.layers.test(ne.layers)){const bc=zi.side;zi.side=1,zi.needsUpdate=!0,AW(Kt,de,ne,Ri,zi,zo),zi.side=bc,zi.needsUpdate=!0,kt=!0}}!0===kt&&(et.updateMultisampleRenderTarget($e),et.updateRenderTargetMipmap($e)),x.setRenderTarget(tt),x.setClearColor(se,V),x.toneMapping=Et}(he,tt,te,de),ne&&xe.viewport(R.copy(ne)),he.length>0&&jC(he,te,de),tt.length>0&&jC(tt,te,de),Et.length>0&&jC(Et,te,de),xe.buffers.depth.setTest(!0),xe.buffers.depth.setMask(!0),xe.buffers.color.setMask(!0),xe.setPolygonOffset(!1)}function jC(F,te,de){const ne=!0===te.isScene?te.overrideMaterial:null;for(let he=0,tt=F.length;he<tt;he++){const Et=F[he],kt=Et.object,Ut=Et.geometry,on=null===ne?Et.material:ne,Lt=Et.group;kt.layers.test(de.layers)&&AW(kt,te,de,Ut,on,Lt)}}function AW(F,te,de,ne,he,tt){F.onBeforeRender(x,te,de,ne,he,tt),F.modelViewMatrix.multiplyMatrices(de.matrixWorldInverse,F.matrixWorld),F.normalMatrix.getNormalMatrix(F.modelViewMatrix),he.onBeforeRender(x,te,de,ne,F,tt),!0===he.transparent&&2===he.side&&!1===he.forceSinglePass?(he.side=1,he.needsUpdate=!0,x.renderBufferDirect(de,te,ne,he,F,tt),he.side=0,he.needsUpdate=!0,x.renderBufferDirect(de,te,ne,he,F,tt),he.side=2):x.renderBufferDirect(de,te,ne,he,F,tt),F.onAfterRender(x,te,de,ne,he,tt)}function $C(F,te,de){!0!==te.isScene&&(te=At);const ne=Ze.get(F),he=w.state.lights,Et=he.state.version,kt=ie.getParameters(F,he.state,w.state.shadowsArray,te,de),Ut=ie.getProgramCacheKey(kt);let on=ne.programs;ne.environment=F.isMeshStandardMaterial?te.environment:null,ne.fog=te.fog,ne.envMap=(F.isMeshStandardMaterial?sn:Mt).get(F.envMap||ne.environment),void 0===on&&(F.addEventListener("dispose",ke),on=new Map,ne.programs=on);let Lt=on.get(Ut);if(void 0!==Lt){if(ne.currentProgram===Lt&&ne.lightsStateVersion===Et)return DW(F,kt),Lt}else kt.uniforms=ie.getUniforms(F),F.onBuild(de,kt,x),F.onBeforeCompile(kt,x),Lt=ie.acquireProgram(kt,Ut),on.set(Ut,Lt),ne.uniforms=kt.uniforms;const Kt=ne.uniforms;(!F.isShaderMaterial&&!F.isRawShaderMaterial||!0===F.clipping)&&(Kt.clippingPlanes=ot.uniform),DW(F,kt),ne.needsLights=function Kfe(F){return F.isMeshLambertMaterial||F.isMeshToonMaterial||F.isMeshPhongMaterial||F.isMeshStandardMaterial||F.isShadowMaterial||F.isShaderMaterial&&!0===F.lights}(F),ne.lightsStateVersion=Et,ne.needsLights&&(Kt.ambientLightColor.value=he.state.ambient,Kt.lightProbe.value=he.state.probe,Kt.directionalLights.value=he.state.directional,Kt.directionalLightShadows.value=he.state.directionalShadow,Kt.spotLights.value=he.state.spot,Kt.spotLightShadows.value=he.state.spotShadow,Kt.rectAreaLights.value=he.state.rectArea,Kt.ltc_1.value=he.state.rectAreaLTC1,Kt.ltc_2.value=he.state.rectAreaLTC2,Kt.pointLights.value=he.state.point,Kt.pointLightShadows.value=he.state.pointShadow,Kt.hemisphereLights.value=he.state.hemi,Kt.directionalShadowMap.value=he.state.directionalShadowMap,Kt.directionalShadowMatrix.value=he.state.directionalShadowMatrix,Kt.spotShadowMap.value=he.state.spotShadowMap,Kt.spotLightMatrix.value=he.state.spotLightMatrix,Kt.spotLightMap.value=he.state.spotLightMap,Kt.pointShadowMap.value=he.state.pointShadowMap,Kt.pointShadowMatrix.value=he.state.pointShadowMatrix);const Ri=Lt.getUniforms(),zi=vE.seqWithValue(Ri.seq,Kt);return ne.currentProgram=Lt,ne.uniformsList=zi,Lt}function DW(F,te){const de=Ze.get(F);de.outputColorSpace=te.outputColorSpace,de.instancing=te.instancing,de.instancingColor=te.instancingColor,de.skinning=te.skinning,de.morphTargets=te.morphTargets,de.morphNormals=te.morphNormals,de.morphColors=te.morphColors,de.morphTargetsCount=te.morphTargetsCount,de.numClippingPlanes=te.numClippingPlanes,de.numIntersection=te.numClipIntersection,de.vertexAlphas=te.vertexAlphas,de.vertexTangents=te.vertexTangents,de.toneMapping=te.toneMapping}Ms.setAnimationLoop(function Qi(F){Rt&&Rt(F)}),typeof self<"u"&&Ms.setContext(self),this.setAnimationLoop=function(F){Rt=F,H.setAnimationLoop(F),null===F?Ms.stop():Ms.start()},H.addEventListener("sessionstart",ci),H.addEventListener("sessionend",fl),this.render=function(F,te){if(void 0===te||!0===te.isCamera){if(!0!==E){if(!0===F.matrixWorldAutoUpdate&&F.updateMatrixWorld(),null===te.parent&&!0===te.matrixWorldAutoUpdate&&te.updateMatrixWorld(),!0===H.enabled&&!0===H.isPresenting&&(!0===H.cameraAutoUpdate&&H.updateCamera(te),te=H.getCamera()),!0===F.isScene&&F.onBeforeRender(x,F,te,D),w=De.get(F,b.length),w.init(),b.push(w),Be.multiplyMatrices(te.projectionMatrix,te.matrixWorldInverse),Se.setFromProjectionMatrix(Be),Ne=this.localClippingEnabled,ve=ot.init(this.clippingPlanes,Ne),v=Ce.get(F,y.length),v.init(),y.push(v),MW(F,te,0,x.sortObjects),v.finish(),!0===x.sortObjects&&v.sort(Q,Z),this.info.render.frame++,!0===ve&&ot.beginShadows(),Ie.render(w.state.shadowsArray,F,te),!0===ve&&ot.endShadows(),!0===this.info.autoReset&&this.info.reset(),qe.render(v,F),w.setupLights(x._useLegacyLights),te.isArrayCamera){const ne=te.cameras;for(let he=0,tt=ne.length;he<tt;he++){const Et=ne[he];TW(v,F,Et,Et.viewport)}}else TW(v,F,te);null!==D&&(et.updateMultisampleRenderTarget(D),et.updateRenderTargetMipmap(D)),!0===F.isScene&&F.onAfterRender(x,F,te),ct.resetDefaultState(),L=-1,M=null,b.pop(),w=b.length>0?b[b.length-1]:null,y.pop(),v=y.length>0?y[y.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return C},this.getActiveMipmapLevel=function(){return A},this.getRenderTarget=function(){return D},this.setRenderTargetTextures=function(F,te,de){Ze.get(F.texture).__webglTexture=te,Ze.get(F.depthTexture).__webglTexture=de;const ne=Ze.get(F);ne.__hasExternalTextures=!0,ne.__hasExternalTextures&&(ne.__autoAllocateDepthBuffer=void 0===de,ne.__autoAllocateDepthBuffer||!0===ye.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),ne.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(F,te){const de=Ze.get(F);de.__webglFramebuffer=te,de.__useDefaultFramebuffer=void 0===te},this.setRenderTarget=function(F,te=0,de=0){D=F,C=te,A=de;let ne=!0,he=null,tt=!1,Et=!1;if(F){const Ut=Ze.get(F);void 0!==Ut.__useDefaultFramebuffer?(xe.bindFramebuffer(z.FRAMEBUFFER,null),ne=!1):void 0===Ut.__webglFramebuffer?et.setupRenderTarget(F):Ut.__hasExternalTextures&&et.rebindTextures(F,Ze.get(F.texture).__webglTexture,Ze.get(F.depthTexture).__webglTexture);const on=F.texture;(on.isData3DTexture||on.isDataArrayTexture||on.isCompressedArrayTexture)&&(Et=!0);const Lt=Ze.get(F).__webglFramebuffer;F.isWebGLCubeRenderTarget?(he=Array.isArray(Lt[te])?Lt[te][de]:Lt[te],tt=!0):he=Ae.isWebGL2&&F.samples>0&&!1===et.useMultisampledRTT(F)?Ze.get(F).__webglMultisampledFramebuffer:Array.isArray(Lt)?Lt[de]:Lt,R.copy(F.viewport),$.copy(F.scissor),ee=F.scissorTest}else R.copy(le).multiplyScalar(X).floor(),$.copy(q).multiplyScalar(X).floor(),ee=oe;if(xe.bindFramebuffer(z.FRAMEBUFFER,he)&&Ae.drawBuffers&&ne&&xe.drawBuffers(F,he),xe.viewport(R),xe.scissor($),xe.setScissorTest(ee),tt){const Ut=Ze.get(F.texture);z.framebufferTexture2D(z.FRAMEBUFFER,z.COLOR_ATTACHMENT0,z.TEXTURE_CUBE_MAP_POSITIVE_X+te,Ut.__webglTexture,de)}else if(Et){const Ut=Ze.get(F.texture);z.framebufferTextureLayer(z.FRAMEBUFFER,z.COLOR_ATTACHMENT0,Ut.__webglTexture,de||0,te||0)}L=-1},this.readRenderTargetPixels=function(F,te,de,ne,he,tt,Et){if(!F||!F.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let kt=Ze.get(F).__webglFramebuffer;if(F.isWebGLCubeRenderTarget&&void 0!==Et&&(kt=kt[Et]),kt){xe.bindFramebuffer(z.FRAMEBUFFER,kt);try{const Ut=F.texture,on=Ut.format,Lt=Ut.type;if(on!==Fo&&Dt.convert(on)!==z.getParameter(z.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const Kt=Lt===Cv&&(ye.has("EXT_color_buffer_half_float")||Ae.isWebGL2&&ye.has("EXT_color_buffer_float"));if(!(Lt===Tu||Dt.convert(Lt)===z.getParameter(z.IMPLEMENTATION_COLOR_READ_TYPE)||Lt===ic&&(Ae.isWebGL2||ye.has("OES_texture_float")||ye.has("WEBGL_color_buffer_float"))||Kt))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");te>=0&&te<=F.width-ne&&de>=0&&de<=F.height-he&&z.readPixels(te,de,ne,he,Dt.convert(on),Dt.convert(Lt),tt)}finally{const Ut=null!==D?Ze.get(D).__webglFramebuffer:null;xe.bindFramebuffer(z.FRAMEBUFFER,Ut)}}},this.copyFramebufferToTexture=function(F,te,de=0){const ne=Math.pow(2,-de),he=Math.floor(te.image.width*ne),tt=Math.floor(te.image.height*ne);et.setTexture2D(te,0),z.copyTexSubImage2D(z.TEXTURE_2D,de,0,0,F.x,F.y,he,tt),xe.unbindTexture()},this.copyTextureToTexture=function(F,te,de,ne=0){const he=te.image.width,tt=te.image.height,Et=Dt.convert(de.format),kt=Dt.convert(de.type);et.setTexture2D(de,0),z.pixelStorei(z.UNPACK_FLIP_Y_WEBGL,de.flipY),z.pixelStorei(z.UNPACK_PREMULTIPLY_ALPHA_WEBGL,de.premultiplyAlpha),z.pixelStorei(z.UNPACK_ALIGNMENT,de.unpackAlignment),te.isDataTexture?z.texSubImage2D(z.TEXTURE_2D,ne,F.x,F.y,he,tt,Et,kt,te.image.data):te.isCompressedTexture?z.compressedTexSubImage2D(z.TEXTURE_2D,ne,F.x,F.y,te.mipmaps[0].width,te.mipmaps[0].height,Et,te.mipmaps[0].data):z.texSubImage2D(z.TEXTURE_2D,ne,F.x,F.y,Et,kt,te.image),0===ne&&de.generateMipmaps&&z.generateMipmap(z.TEXTURE_2D),xe.unbindTexture()},this.copyTextureToTexture3D=function(F,te,de,ne,he=0){if(x.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const tt=F.max.x-F.min.x+1,Et=F.max.y-F.min.y+1,kt=F.max.z-F.min.z+1,Ut=Dt.convert(ne.format),on=Dt.convert(ne.type);let Lt;if(ne.isData3DTexture)et.setTexture3D(ne,0),Lt=z.TEXTURE_3D;else{if(!ne.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");et.setTexture2DArray(ne,0),Lt=z.TEXTURE_2D_ARRAY}z.pixelStorei(z.UNPACK_FLIP_Y_WEBGL,ne.flipY),z.pixelStorei(z.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ne.premultiplyAlpha),z.pixelStorei(z.UNPACK_ALIGNMENT,ne.unpackAlignment);const Kt=z.getParameter(z.UNPACK_ROW_LENGTH),Ri=z.getParameter(z.UNPACK_IMAGE_HEIGHT),zi=z.getParameter(z.UNPACK_SKIP_PIXELS),zo=z.getParameter(z.UNPACK_SKIP_ROWS),bc=z.getParameter(z.UNPACK_SKIP_IMAGES),er=de.isCompressedTexture?de.mipmaps[0]:de.image;z.pixelStorei(z.UNPACK_ROW_LENGTH,er.width),z.pixelStorei(z.UNPACK_IMAGE_HEIGHT,er.height),z.pixelStorei(z.UNPACK_SKIP_PIXELS,F.min.x),z.pixelStorei(z.UNPACK_SKIP_ROWS,F.min.y),z.pixelStorei(z.UNPACK_SKIP_IMAGES,F.min.z),de.isDataTexture||de.isData3DTexture?z.texSubImage3D(Lt,he,te.x,te.y,te.z,tt,Et,kt,Ut,on,er.data):de.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),z.compressedTexSubImage3D(Lt,he,te.x,te.y,te.z,tt,Et,kt,Ut,er.data)):z.texSubImage3D(Lt,he,te.x,te.y,te.z,tt,Et,kt,Ut,on,er),z.pixelStorei(z.UNPACK_ROW_LENGTH,Kt),z.pixelStorei(z.UNPACK_IMAGE_HEIGHT,Ri),z.pixelStorei(z.UNPACK_SKIP_PIXELS,zi),z.pixelStorei(z.UNPACK_SKIP_ROWS,zo),z.pixelStorei(z.UNPACK_SKIP_IMAGES,bc),0===he&&ne.generateMipmaps&&z.generateMipmap(Lt),xe.unbindTexture()},this.initTexture=function(F){F.isCubeTexture?et.setTextureCube(F,0):F.isData3DTexture?et.setTexture3D(F,0):F.isDataArrayTexture||F.isCompressedArrayTexture?et.setTexture2DArray(F,0):et.setTexture2D(F,0),xe.unbindTexture()},this.resetState=function(){C=0,A=0,D=null,xe.reset(),ct.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return rc}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=e===GI?"display-p3":"srgb",t.unpackColorSpace=Mn.workingColorSpace===zS?"display-p3":"srgb"}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(e){console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!e}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===_i?lh:3e3}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===lh?_i:Lr}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}(class coe extends xR{}).prototype.isWebGL1Renderer=!0;class wE extends si{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t}}class CR{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=lo()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=lo()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=lo()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Es=new N;class vh{constructor(e,t,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)Es.fromBufferAttribute(this,t),Es.applyMatrix4(e),this.setXYZ(t,Es.x,Es.y,Es.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Es.fromBufferAttribute(this,t),Es.applyNormalMatrix(e),this.setXYZ(t,Es.x,Es.y,Es.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Es.fromBufferAttribute(this,t),Es.transformDirection(e),this.setXYZ(t,Es.x,Es.y,Es.z);return this}setX(e,t){return this.normalized&&(t=qt(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=qt(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=qt(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=qt(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Vs(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Vs(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Vs(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Vs(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=qt(t,this.array),i=qt(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=qt(t,this.array),i=qt(i,this.array),r=qt(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=qt(t,this.array),i=qt(i,this.array),r=qt(r,this.array),s=qt(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new Jn(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new vh(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}const Vz=new N,Hz=new Ln,zz=new Ln,hoe=new N,Gz=new Ct,$m=new N,TR=new va,Wz=new Ct,AR=new Mm;class jz extends Me{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Ct,this.bindMatrixInverse=new Ct,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;null===this.boundingBox&&(this.boundingBox=new rl),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)$m.fromBufferAttribute(t,i),this.applyBoneTransform(i,$m),this.boundingBox.expandByPoint($m)}computeBoundingSphere(){const e=this.geometry;null===this.boundingSphere&&(this.boundingSphere=new va),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)$m.fromBufferAttribute(t,i),this.applyBoneTransform(i,$m),this.boundingSphere.expandByPoint($m)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const r=this.matrixWorld;void 0!==this.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),TR.copy(this.boundingSphere),TR.applyMatrix4(r),!1!==e.ray.intersectsSphere(TR)&&(Wz.copy(r).invert(),AR.copy(e.ray).applyMatrix4(Wz),(null===this.boundingBox||!1!==AR.intersectsBox(this.boundingBox))&&this._computeIntersections(e,t,AR)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Ln,t=this.geometry.attributes.skinWeight;for(let i=0,r=t.count;i<r;i++){e.fromBufferAttribute(t,i);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const i=this.skeleton,r=this.geometry;Hz.fromBufferAttribute(r.attributes.skinIndex,e),zz.fromBufferAttribute(r.attributes.skinWeight,e),Vz.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=zz.getComponent(s);if(0!==o){const a=Hz.getComponent(s);Gz.multiplyMatrices(i.bones[a].matrixWorld,i.boneInverses[a]),t.addScaledVector(hoe.copy(Vz).applyMatrix4(Gz),o)}}return t.applyMatrix4(this.bindMatrixInverse)}boneTransform(e,t){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,t)}}class DR extends si{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Bv extends Uo{constructor(e=null,t=1,i=1,r,s,o,a,l,c=Vi,d=Vi,h,p){super(null,o,a,l,c,d,r,s,h,p),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const $z=new Ct,foe=new Ct;class CE{constructor(e=[],t=[]){this.uuid=lo(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new Ct)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const i=new Ct;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,t=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++)$z.multiplyMatrices(e[s]?e[s].matrixWorld:foe,t[s]),$z.toArray(i,16*s);null!==r&&(r.needsUpdate=!0)}clone(){return new CE(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=FH(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const i=new Bv(t,e,e,Fo,ic);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const s=e.bones[i];let o=t[s];void 0===o&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new DR),this.bones.push(o),this.boneInverses.push((new Ct).fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,i=this.boneInverses;for(let r=0,s=t.length;r<s;r++)e.bones.push(t[r].uuid),e.boneInverses.push(i[r].toArray());return e}}class Vv extends Jn{constructor(e,t,i,r=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const qm=new Ct,qz=new Ct,ME=[],Xz=new rl,poe=new Ct,Hv=new Me,zv=new va;class Yz extends Me{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Vv(new Float32Array(16*i),16),this.instanceColor=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<i;r++)this.setMatrixAt(r,poe)}computeBoundingBox(){const e=this.geometry,t=this.count;null===this.boundingBox&&(this.boundingBox=new rl),null===e.boundingBox&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,qm),Xz.copy(e.boundingBox).applyMatrix4(qm),this.boundingBox.union(Xz)}computeBoundingSphere(){const e=this.geometry,t=this.count;null===this.boundingSphere&&(this.boundingSphere=new va),null===e.boundingSphere&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,qm),zv.copy(e.boundingSphere).applyMatrix4(qm),this.boundingSphere.union(zv)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const i=this.matrixWorld,r=this.count;if(Hv.geometry=this.geometry,Hv.material=this.material,void 0!==Hv.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),zv.copy(this.boundingSphere),zv.applyMatrix4(i),!1!==e.ray.intersectsSphere(zv)))for(let s=0;s<r;s++){this.getMatrixAt(s,qm),qz.multiplyMatrices(i,qm),Hv.matrixWorld=qz,Hv.raycast(e,ME);for(let o=0,a=ME.length;o<a;o++){const l=ME[o];l.instanceId=s,l.object=this,t.push(l)}ME.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new Vv(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class Sr extends xs{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new We(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const Kz=new N,Zz=new N,Jz=new Ct,IR=new Mm,TE=new va;class Qr extends si{constructor(e=new Ot,t=new Sr){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,i=[0];for(let r=1,s=t.count;r<s;r++)Kz.fromBufferAttribute(t,r-1),Zz.fromBufferAttribute(t,r),i[r]=i[r-1],i[r]+=Kz.distanceTo(Zz);e.setAttribute("lineDistance",new Ke(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),TE.copy(i.boundingSphere),TE.applyMatrix4(r),TE.radius+=s,!1===e.ray.intersectsSphere(TE))return;Jz.copy(r).invert(),IR.copy(e.ray).applyMatrix4(Jz);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=new N,d=new N,h=new N,p=new N,m=this.isLineSegments?2:1,g=i.index,w=i.attributes.position;if(null!==g)for(let x=Math.max(0,o.start),E=Math.min(g.count,o.start+o.count)-1;x<E;x+=m){const C=g.getX(x),A=g.getX(x+1);if(c.fromBufferAttribute(w,C),d.fromBufferAttribute(w,A),IR.distanceSqToSegment(c,d,p,h)>l)continue;p.applyMatrix4(this.matrixWorld);const L=e.ray.origin.distanceTo(p);L<e.near||L>e.far||t.push({distance:L,point:h.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}else for(let x=Math.max(0,o.start),E=Math.min(w.count,o.start+o.count)-1;x<E;x+=m){if(c.fromBufferAttribute(w,x),d.fromBufferAttribute(w,x+1),IR.distanceSqToSegment(c,d,p,h)>l)continue;p.applyMatrix4(this.matrixWorld);const A=e.ray.origin.distanceTo(p);A<e.near||A>e.far||t.push({distance:A,point:h.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}const Qz=new N,e4=new N;class Xm extends Qr{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,i=[];for(let r=0,s=t.count;r<s;r+=2)Qz.fromBufferAttribute(t,r),e4.fromBufferAttribute(t,r+1),i[r]=0===r?0:i[r-1],i[r+1]=i[r]+Qz.distanceTo(e4);e.setAttribute("lineDistance",new Ke(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class t4 extends Qr{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class wh extends xs{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new We(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const n4=new Ct,RR=new Mm,AE=new va,DE=new N;class Gv extends si{constructor(e=new Ot,t=new wh){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),AE.copy(i.boundingSphere),AE.applyMatrix4(r),AE.radius+=s,!1===e.ray.intersectsSphere(AE))return;n4.copy(r).invert(),RR.copy(e.ray).applyMatrix4(n4);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=i.index,h=i.attributes.position;if(null!==c)for(let g=Math.max(0,o.start),v=Math.min(c.count,o.start+o.count);g<v;g++){const w=c.getX(g);DE.fromBufferAttribute(h,w),i4(DE,w,l,r,e,t,this)}else for(let g=Math.max(0,o.start),v=Math.min(h.count,o.start+o.count);g<v;g++)DE.fromBufferAttribute(h,g),i4(DE,g,l,r,e,t,this)}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function i4(n,e,t,i,r,s,o){const a=RR.distanceSqToPoint(n);if(a<t){const l=new N;RR.closestPointToPoint(n,l),l.applyMatrix4(i);const c=r.ray.origin.distanceTo(l);if(c<r.near||c>r.far)return;s.push({distance:c,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,object:o})}}class goe extends Uo{constructor(e,t,i,r,s,o,a,l,c){super(e,t,i,r,s,o,a,l,c),this.isCanvasTexture=!0,this.needsUpdate=!0}}class ol{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const i=this.getUtoTmapping(e);return this.getPoint(i,t)}getPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return t}getSpacedPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let i,r=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)i=this.getPoint(o/e),s+=i.distanceTo(r),t.push(s),r=i;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const i=this.getLengths();let r=0;const s=i.length;let o;o=t||e*i[s-1];let c,a=0,l=s-1;for(;a<=l;)if(r=Math.floor(a+(l-a)/2),c=i[r]-o,c<0)a=r+1;else{if(!(c>0)){l=r;break}l=r-1}if(r=l,i[r]===o)return r/(s-1);const d=i[r];return(r+(o-d)/(i[r+1]-d))/(s-1)}getTangent(e,t){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const o=this.getPoint(r),a=this.getPoint(s),l=t||(o.isVector2?new fe:new N);return l.copy(a).sub(o).normalize(),l}getTangentAt(e,t){const i=this.getUtoTmapping(e);return this.getTangent(i,t)}computeFrenetFrames(e,t){const i=new N,r=[],s=[],o=[],a=new N,l=new Ct;for(let m=0;m<=e;m++)r[m]=this.getTangentAt(m/e,new N);s[0]=new N,o[0]=new N;let c=Number.MAX_VALUE;const d=Math.abs(r[0].x),h=Math.abs(r[0].y),p=Math.abs(r[0].z);d<=c&&(c=d,i.set(1,0,0)),h<=c&&(c=h,i.set(0,1,0)),p<=c&&i.set(0,0,1),a.crossVectors(r[0],i).normalize(),s[0].crossVectors(r[0],a),o[0].crossVectors(r[0],s[0]);for(let m=1;m<=e;m++){if(s[m]=s[m-1].clone(),o[m]=o[m-1].clone(),a.crossVectors(r[m-1],r[m]),a.length()>Number.EPSILON){a.normalize();const g=Math.acos(Ci(r[m-1].dot(r[m]),-1,1));s[m].applyMatrix4(l.makeRotationAxis(a,g))}o[m].crossVectors(r[m],s[m])}if(!0===t){let m=Math.acos(Ci(s[0].dot(s[e]),-1,1));m/=e,r[0].dot(a.crossVectors(s[0],s[e]))>0&&(m=-m);for(let g=1;g<=e;g++)s[g].applyMatrix4(l.makeRotationAxis(r[g],m*g)),o[g].crossVectors(r[g],s[g])}return{tangents:r,normals:s,binormals:o}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class PR extends ol{constructor(e=0,t=0,i=1,r=1,s=0,o=2*Math.PI,a=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(e,t){const i=t||new fe,r=2*Math.PI;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(s=o?0:r),!0===this.aClockwise&&!o&&(s===r?s=-r:s-=r);const a=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(a),c=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){const d=Math.cos(this.aRotation),h=Math.sin(this.aRotation),p=l-this.aX,m=c-this.aY;l=p*d-m*h+this.aX,c=p*h+m*d+this.aY}return i.set(l,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}function NR(){let n=0,e=0,t=0,i=0;function r(s,o,a,l){n=s,e=a,t=-3*s+3*o-2*a-l,i=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,c){r(o,a,c*(a-s),c*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,c,d,h){let p=(o-s)/c-(a-s)/(c+d)+(a-o)/d,m=(a-o)/d-(l-o)/(d+h)+(l-a)/h;p*=d,m*=d,r(o,a,p,m)},calc:function(s){const o=s*s;return n+e*s+t*o+i*(o*s)}}}const IE=new N,OR=new NR,LR=new NR,FR=new NR;function r4(n,e,t,i,r){const s=.5*(i-e),o=.5*(r-t),a=n*n;return(2*t-2*i+s+o)*(n*a)+(-3*t+3*i-2*s-o)*a+s*n+t}function Wv(n,e,t,i){return function voe(n,e){const t=1-n;return t*t*e}(n,e)+function woe(n,e){return 2*(1-n)*n*e}(n,t)+function boe(n,e){return n*n*e}(n,i)}function jv(n,e,t,i,r){return function xoe(n,e){const t=1-n;return t*t*t*e}(n,e)+function Soe(n,e){const t=1-n;return 3*t*t*n*e}(n,t)+function Eoe(n,e){return 3*(1-n)*n*n*e}(n,i)+function Coe(n,e){return n*n*n*e}(n,r)}class s4 extends ol{constructor(e=new fe,t=new fe,i=new fe,r=new fe){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new fe){const i=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(jv(e,r.x,s.x,o.x,a.x),jv(e,r.y,s.y,o.y,a.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class o4 extends ol{constructor(e=new fe,t=new fe){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new fe){const i=t;return 1===e?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new fe){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class a4 extends ol{constructor(e=new fe,t=new fe,i=new fe){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new fe){const i=t,r=this.v0,s=this.v1,o=this.v2;return i.set(Wv(e,r.x,s.x,o.x),Wv(e,r.y,s.y,o.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class c4 extends ol{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new fe){const i=t,r=this.points,s=(r.length-1)*e,o=Math.floor(s),a=s-o,l=r[0===o?o:o-1],c=r[o],d=r[o>r.length-2?r.length-1:o+1],h=r[o>r.length-3?r.length-1:o+2];return i.set(r4(a,l.x,c.x,d.x,h.x),r4(a,l.y,c.y,d.y,h.y)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++)this.points.push(e.points[t].clone());return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++)e.points.push(this.points[t].toArray());return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push((new fe).fromArray(r))}return this}}var RE=Object.freeze({__proto__:null,ArcCurve:class _oe extends PR{constructor(e,t,i,r,s,o){super(e,t,i,i,r,s,o),this.isArcCurve=!0,this.type="ArcCurve"}},CatmullRomCurve3:class yoe extends ol{constructor(e=[],t=!1,i="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=i,this.tension=r}getPoint(e,t=new N){const i=t,r=this.points,s=r.length,o=(s-(this.closed?0:1))*e;let c,d,a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:0===l&&a===s-1&&(a=s-2,l=1),this.closed||a>0?c=r[(a-1)%s]:(IE.subVectors(r[0],r[1]).add(r[0]),c=IE);const h=r[a%s],p=r[(a+1)%s];if(this.closed||a+2<s?d=r[(a+2)%s]:(IE.subVectors(r[s-1],r[s-2]).add(r[s-1]),d=IE),"centripetal"===this.curveType||"chordal"===this.curveType){const m="chordal"===this.curveType?.5:.25;let g=Math.pow(c.distanceToSquared(h),m),v=Math.pow(h.distanceToSquared(p),m),w=Math.pow(p.distanceToSquared(d),m);v<1e-4&&(v=1),g<1e-4&&(g=v),w<1e-4&&(w=v),OR.initNonuniformCatmullRom(c.x,h.x,p.x,d.x,g,v,w),LR.initNonuniformCatmullRom(c.y,h.y,p.y,d.y,g,v,w),FR.initNonuniformCatmullRom(c.z,h.z,p.z,d.z,g,v,w)}else"catmullrom"===this.curveType&&(OR.initCatmullRom(c.x,h.x,p.x,d.x,this.tension),LR.initCatmullRom(c.y,h.y,p.y,d.y,this.tension),FR.initCatmullRom(c.z,h.z,p.z,d.z,this.tension));return i.set(OR.calc(l),LR.calc(l),FR.calc(l)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++)this.points.push(e.points[t].clone());return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++)e.points.push(this.points[t].toArray());return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push((new N).fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}},CubicBezierCurve:s4,CubicBezierCurve3:class Moe extends ol{constructor(e=new N,t=new N,i=new N,r=new N){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new N){const i=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(jv(e,r.x,s.x,o.x,a.x),jv(e,r.y,s.y,o.y,a.y),jv(e,r.z,s.z,o.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},EllipseCurve:PR,LineCurve:o4,LineCurve3:class Toe extends ol{constructor(e=new N,t=new N){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new N){const i=t;return 1===e?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new N){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},QuadraticBezierCurve:a4,QuadraticBezierCurve3:class l4 extends ol{constructor(e=new N,t=new N,i=new N){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new N){const i=t,r=this.v0,s=this.v1,o=this.v2;return i.set(Wv(e,r.x,s.x,o.x),Wv(e,r.y,s.y,o.y),Wv(e,r.z,s.z,o.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},SplineCurve:c4});class Aoe extends ol{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);return e.equals(t)||this.curves.push(new RE[!0===e.isVector2?"LineCurve":"LineCurve3"](t,e)),this}getPoint(e,t){const i=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=i){const o=r[s]-i,a=this.curves[s],l=a.getLength();return a.getPointAt(0===l?0:1-o/l,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let i=0,r=this.curves.length;i<r;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let i;for(let r=0,s=this.curves;r<s.length;r++){const o=s[r],l=o.getPoints(o.isEllipseCurve?2*e:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e);for(let c=0;c<l.length;c++){const d=l[c];i&&i.equals(d)||(t.push(d),i=d)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,i=e.curves.length;t<i;t++)this.curves.push(e.curves[t].clone());return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,i=this.curves.length;t<i;t++)e.curves.push(this.curves[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const r=e.curves[t];this.curves.push((new RE[r.type]).fromJSON(r))}return this}}class PE extends Aoe{constructor(e){super(),this.type="Path",this.currentPoint=new fe,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const i=new o4(this.currentPoint.clone(),new fe(e,t));return this.curves.push(i),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,i,r){const s=new a4(this.currentPoint.clone(),new fe(e,t),new fe(i,r));return this.curves.push(s),this.currentPoint.set(i,r),this}bezierCurveTo(e,t,i,r,s,o){const a=new s4(this.currentPoint.clone(),new fe(e,t),new fe(i,r),new fe(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),i=new c4(t);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,i,r,s,o){return this.absarc(e+this.currentPoint.x,t+this.currentPoint.y,i,r,s,o),this}absarc(e,t,i,r,s,o){return this.absellipse(e,t,i,i,r,s,o),this}ellipse(e,t,i,r,s,o,a,l){return this.absellipse(e+this.currentPoint.x,t+this.currentPoint.y,i,r,s,o,a,l),this}absellipse(e,t,i,r,s,o,a,l){const c=new PR(e,t,i,r,s,o,a,l);if(this.curves.length>0){const h=c.getPoint(0);h.equals(this.currentPoint)||this.lineTo(h.x,h.y)}this.curves.push(c);const d=c.getPoint(1);return this.currentPoint.copy(d),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class hr extends Ot{constructor(e=1,t=1,i=1,r=32,s=1,o=!1,a=0,l=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l};const c=this;r=Math.floor(r),s=Math.floor(s);const d=[],h=[],p=[],m=[];let g=0;const v=[],w=i/2;let y=0;function x(E){const C=g,A=new fe,D=new N;let L=0;const M=!0===E?e:t,R=!0===E?1:-1;for(let ee=1;ee<=r;ee++)h.push(0,w*R,0),p.push(0,R,0),m.push(.5,.5),g++;const $=g;for(let ee=0;ee<=r;ee++){const V=ee/r*l+a,J=Math.cos(V),G=Math.sin(V);D.x=M*G,D.y=w*R,D.z=M*J,h.push(D.x,D.y,D.z),p.push(0,R,0),A.x=.5*J+.5,A.y=.5*G*R+.5,m.push(A.x,A.y),g++}for(let ee=0;ee<r;ee++){const se=C+ee,V=$+ee;!0===E?d.push(V,V+1,se):d.push(V+1,V,se),L+=3}c.addGroup(y,L,!0===E?1:2),y+=L}(function b(){const E=new N,C=new N;let A=0;const D=(t-e)/i;for(let L=0;L<=s;L++){const M=[],R=L/s,$=R*(t-e)+e;for(let ee=0;ee<=r;ee++){const se=ee/r,V=se*l+a,J=Math.sin(V),G=Math.cos(V);C.x=$*J,C.y=-R*i+w,C.z=$*G,h.push(C.x,C.y,C.z),E.set(J,D,G).normalize(),p.push(E.x,E.y,E.z),m.push(se,1-R),M.push(g++)}v.push(M)}for(let L=0;L<r;L++)for(let M=0;M<s;M++){const $=v[M+1][L],ee=v[M+1][L+1],se=v[M][L+1];d.push(v[M][L],$,se),d.push($,ee,se),A+=6}c.addGroup(y,A,0),y+=A})(),!1===o&&(e>0&&x(!0),t>0&&x(!1)),this.setIndex(d),this.setAttribute("position",new Ke(h,3)),this.setAttribute("normal",new Ke(p,3)),this.setAttribute("uv",new Ke(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new hr(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class bh extends Ot{constructor(e=[],t=[],i=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:r};const s=[],o=[];function l(b,x,E,C){const A=C+1,D=[];for(let L=0;L<=A;L++){D[L]=[];const M=b.clone().lerp(E,L/A),R=x.clone().lerp(E,L/A),$=A-L;for(let ee=0;ee<=$;ee++)D[L][ee]=0===ee&&L===A?M:M.clone().lerp(R,ee/$)}for(let L=0;L<A;L++)for(let M=0;M<2*(A-L)-1;M++){const R=Math.floor(M/2);M%2==0?(p(D[L][R+1]),p(D[L+1][R]),p(D[L][R])):(p(D[L][R+1]),p(D[L+1][R+1]),p(D[L+1][R]))}}function p(b){s.push(b.x,b.y,b.z)}function m(b,x){const E=3*b;x.x=e[E+0],x.y=e[E+1],x.z=e[E+2]}function v(b,x,E,C){C<0&&1===b.x&&(o[x]=b.x-1),0===E.x&&0===E.z&&(o[x]=C/2/Math.PI+.5)}function w(b){return Math.atan2(b.z,-b.x)}function y(b){return Math.atan2(-b.y,Math.sqrt(b.x*b.x+b.z*b.z))}(function a(b){const x=new N,E=new N,C=new N;for(let A=0;A<t.length;A+=3)m(t[A+0],x),m(t[A+1],E),m(t[A+2],C),l(x,E,C,b)})(r),function c(b){const x=new N;for(let E=0;E<s.length;E+=3)x.x=s[E+0],x.y=s[E+1],x.z=s[E+2],x.normalize().multiplyScalar(b),s[E+0]=x.x,s[E+1]=x.y,s[E+2]=x.z}(i),function d(){const b=new N;for(let x=0;x<s.length;x+=3){b.x=s[x+0],b.y=s[x+1],b.z=s[x+2];const E=w(b)/2/Math.PI+.5,C=y(b)/Math.PI+.5;o.push(E,1-C)}(function g(){const b=new N,x=new N,E=new N,C=new N,A=new fe,D=new fe,L=new fe;for(let M=0,R=0;M<s.length;M+=9,R+=6){b.set(s[M+0],s[M+1],s[M+2]),x.set(s[M+3],s[M+4],s[M+5]),E.set(s[M+6],s[M+7],s[M+8]),A.set(o[R+0],o[R+1]),D.set(o[R+2],o[R+3]),L.set(o[R+4],o[R+5]),C.copy(b).add(x).add(E).divideScalar(3);const $=w(C);v(A,R+0,b,$),v(D,R+2,x,$),v(L,R+4,E,$)}})(),function h(){for(let b=0;b<o.length;b+=6){const x=o[b+0],E=o[b+2],C=o[b+4],A=Math.max(x,E,C),D=Math.min(x,E,C);A>.9&&D<.1&&(x<.2&&(o[b+0]+=1),E<.2&&(o[b+2]+=1),C<.2&&(o[b+4]+=1))}}()}(),this.setAttribute("position",new Ke(s,3)),this.setAttribute("normal",new Ke(s.slice(),3)),this.setAttribute("uv",new Ke(o,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new bh(e.vertices,e.indices,e.radius,e.details)}}class Ym extends PE{constructor(e){super(e),this.uuid=lo(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let i=0,r=this.holes.length;i<r;i++)t[i]=this.holes[i].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,i=e.holes.length;t<i;t++)this.holes.push(e.holes[t].clone());return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,i=this.holes.length;t<i;t++)e.holes.push(this.holes[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const r=e.holes[t];this.holes.push((new PE).fromJSON(r))}return this}}function u4(n,e,t,i,r){let s,o;if(r===function $oe(n,e,t,i){let r=0;for(let s=e,o=t-i;s<t;s+=i)r+=(n[o]-n[s])*(n[s+1]+n[o+1]),o=s;return r}(n,e,t,i)>0)for(s=e;s<t;s+=i)o=f4(s,n[s],n[s+1],o);else for(s=t-i;s>=e;s-=i)o=f4(s,n[s],n[s+1],o);return o&&kE(o,o.next)&&(Xv(o),o=o.next),o}function xh(n,e){if(!n)return n;e||(e=n);let i,t=n;do{if(i=!1,t.steiner||!kE(t,t.next)&&0!==yi(t.prev,t,t.next))t=t.next;else{if(Xv(t),t=e=t.prev,t===t.next)break;i=!0}}while(i||t!==e);return e}function $v(n,e,t,i,r,s,o){if(!n)return;!o&&s&&function Voe(n,e,t,i){let r=n;do{0===r.z&&(r.z=zR(r.x,r.y,e,t,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==n);r.prevZ.nextZ=null,r.prevZ=null,function Hoe(n){let e,t,i,r,s,o,a,l,c=1;do{for(t=n,n=null,s=null,o=0;t;){for(o++,i=t,a=0,e=0;e<c&&(a++,i=i.nextZ,i);e++);for(l=c;a>0||l>0&&i;)0!==a&&(0===l||!i||t.z<=i.z)?(r=t,t=t.nextZ,a--):(r=i,i=i.nextZ,l--),s?s.nextZ=r:n=r,r.prevZ=s,s=r;t=i}s.nextZ=null,c*=2}while(o>1)}(r)}(n,i,r,s);let l,c,a=n;for(;n.prev!==n.next;)if(l=n.prev,c=n.next,s?Poe(n,i,r,s):Roe(n))e.push(l.i/t|0),e.push(n.i/t|0),e.push(c.i/t|0),Xv(n),n=c.next,a=c.next;else if((n=c)===a){o?1===o?$v(n=Noe(xh(n),e,t),e,t,i,r,s,2):2===o&&Ooe(n,e,t,i,r,s):$v(xh(n),e,t,i,r,s,1);break}}function Roe(n){const e=n.prev,t=n,i=n.next;if(yi(e,t,i)>=0)return!1;const r=e.x,s=t.x,o=i.x,a=e.y,l=t.y,c=i.y,d=r<s?r<o?r:o:s<o?s:o,h=a<l?a<c?a:c:l<c?l:c,p=r>s?r>o?r:o:s>o?s:o,m=a>l?a>c?a:c:l>c?l:c;let g=i.next;for(;g!==e;){if(g.x>=d&&g.x<=p&&g.y>=h&&g.y<=m&&Km(r,a,s,l,o,c,g.x,g.y)&&yi(g.prev,g,g.next)>=0)return!1;g=g.next}return!0}function Poe(n,e,t,i){const r=n.prev,s=n,o=n.next;if(yi(r,s,o)>=0)return!1;const a=r.x,l=s.x,c=o.x,d=r.y,h=s.y,p=o.y,m=a<l?a<c?a:c:l<c?l:c,g=d<h?d<p?d:p:h<p?h:p,v=a>l?a>c?a:c:l>c?l:c,w=d>h?d>p?d:p:h>p?h:p,y=zR(m,g,e,t,i),b=zR(v,w,e,t,i);let x=n.prevZ,E=n.nextZ;for(;x&&x.z>=y&&E&&E.z<=b;){if(x.x>=m&&x.x<=v&&x.y>=g&&x.y<=w&&x!==r&&x!==o&&Km(a,d,l,h,c,p,x.x,x.y)&&yi(x.prev,x,x.next)>=0||(x=x.prevZ,E.x>=m&&E.x<=v&&E.y>=g&&E.y<=w&&E!==r&&E!==o&&Km(a,d,l,h,c,p,E.x,E.y)&&yi(E.prev,E,E.next)>=0))return!1;E=E.nextZ}for(;x&&x.z>=y;){if(x.x>=m&&x.x<=v&&x.y>=g&&x.y<=w&&x!==r&&x!==o&&Km(a,d,l,h,c,p,x.x,x.y)&&yi(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;E&&E.z<=b;){if(E.x>=m&&E.x<=v&&E.y>=g&&E.y<=w&&E!==r&&E!==o&&Km(a,d,l,h,c,p,E.x,E.y)&&yi(E.prev,E,E.next)>=0)return!1;E=E.nextZ}return!0}function Noe(n,e,t){let i=n;do{const r=i.prev,s=i.next.next;!kE(r,s)&&d4(r,i,i.next,s)&&qv(r,s)&&qv(s,r)&&(e.push(r.i/t|0),e.push(i.i/t|0),e.push(s.i/t|0),Xv(i),Xv(i.next),i=n=s),i=i.next}while(i!==n);return xh(i)}function Ooe(n,e,t,i,r,s){let o=n;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&Goe(o,a)){let l=h4(o,a);return o=xh(o,o.next),l=xh(l,l.next),$v(o,e,t,i,r,s,0),void $v(l,e,t,i,r,s,0)}a=a.next}o=o.next}while(o!==n)}function Foe(n,e){return n.x-e.x}function koe(n,e){const t=function Uoe(n,e){let r,t=e,i=-1/0;const s=n.x,o=n.y;do{if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){const p=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(p<=s&&p>i&&(i=p,r=t.x<t.next.x?t:t.next,p===s))return r}t=t.next}while(t!==e);if(!r)return null;const a=r,l=r.x,c=r.y;let h,d=1/0;t=r;do{s>=t.x&&t.x>=l&&s!==t.x&&Km(o<c?s:i,o,l,c,o<c?i:s,o,t.x,t.y)&&(h=Math.abs(o-t.y)/(s-t.x),qv(t,n)&&(h<d||h===d&&(t.x>r.x||t.x===r.x&&Boe(r,t)))&&(r=t,d=h)),t=t.next}while(t!==a);return r}(n,e);if(!t)return e;const i=h4(t,n);return xh(i,i.next),xh(t,t.next)}function Boe(n,e){return yi(n.prev,n,e.prev)<0&&yi(e.next,n,n.next)<0}function zR(n,e,t,i,r){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-t)*r|0)|n<<8))|n<<4))|n<<2))|n<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-i)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function zoe(n){let e=n,t=n;do{(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next}while(e!==n);return t}function Km(n,e,t,i,r,s,o,a){return(r-o)*(e-a)>=(n-o)*(s-a)&&(n-o)*(i-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(r-o)*(i-a)}function Goe(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!function Woe(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&d4(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}(n,e)&&(qv(n,e)&&qv(e,n)&&function joe(n,e){let t=n,i=!1;const r=(n.x+e.x)/2,s=(n.y+e.y)/2;do{t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next}while(t!==n);return i}(n,e)&&(yi(n.prev,n,e.prev)||yi(n,e.prev,e))||kE(n,e)&&yi(n.prev,n,n.next)>0&&yi(e.prev,e,e.next)>0)}function yi(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function kE(n,e){return n.x===e.x&&n.y===e.y}function d4(n,e,t,i){const r=BE(yi(n,e,t)),s=BE(yi(n,e,i)),o=BE(yi(t,i,n)),a=BE(yi(t,i,e));return!!(r!==s&&o!==a||0===r&&UE(n,t,e)||0===s&&UE(n,i,e)||0===o&&UE(t,n,i)||0===a&&UE(t,e,i))}function UE(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function BE(n){return n>0?1:n<0?-1:0}function qv(n,e){return yi(n.prev,n,n.next)<0?yi(n,e,n.next)>=0&&yi(n,n.prev,e)>=0:yi(n,e,n.prev)<0||yi(n,n.next,e)<0}function h4(n,e){const t=new GR(n.i,n.x,n.y),i=new GR(e.i,e.x,e.y),r=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=r,r.prev=t,i.next=t,t.prev=i,s.next=i,i.prev=s,i}function f4(n,e,t,i){const r=new GR(n,e,t);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Xv(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function GR(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}class pc{static area(e){const t=e.length;let i=0;for(let r=t-1,s=0;s<t;r=s++)i+=e[r].x*e[s].y-e[s].x*e[r].y;return.5*i}static isClockWise(e){return pc.area(e)<0}static triangulateShape(e,t){const i=[],r=[],s=[];p4(e),m4(i,e);let o=e.length;t.forEach(p4);for(let l=0;l<t.length;l++)r.push(o),o+=t[l].length,m4(i,t[l]);const a=function(n,e,t=2){const i=e&&e.length,r=i?e[0]*t:n.length;let s=u4(n,0,r,t,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,c,d,h,p,m;if(i&&(s=function Loe(n,e,t,i){const r=[];let s,o,a,l,c;for(s=0,o=e.length;s<o;s++)a=e[s]*i,l=s<o-1?e[s+1]*i:n.length,c=u4(n,a,l,i,!1),c===c.next&&(c.steiner=!0),r.push(zoe(c));for(r.sort(Foe),s=0;s<r.length;s++)t=koe(r[s],t);return t}(n,e,s,t)),n.length>80*t){a=c=n[0],l=d=n[1];for(let g=t;g<r;g+=t)h=n[g],p=n[g+1],h<a&&(a=h),p<l&&(l=p),h>c&&(c=h),p>d&&(d=p);m=Math.max(c-a,d-l),m=0!==m?32767/m:0}return $v(s,o,t,a,l,m,0),o}(i,r);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}}function p4(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function m4(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class VE extends Ot{constructor(e=new Ym([new fe(.5,.5),new fe(-.5,.5),new fe(-.5,-.5),new fe(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const i=this,r=[],s=[];for(let a=0,l=e.length;a<l;a++)o(e[a]);function o(a){const l=[],c=void 0!==t.curveSegments?t.curveSegments:12,d=void 0!==t.steps?t.steps:1,h=void 0!==t.depth?t.depth:1;let p=void 0===t.bevelEnabled||t.bevelEnabled,m=void 0!==t.bevelThickness?t.bevelThickness:.2,g=void 0!==t.bevelSize?t.bevelSize:m-.1,v=void 0!==t.bevelOffset?t.bevelOffset:0,w=void 0!==t.bevelSegments?t.bevelSegments:3;const y=t.extrudePath,b=void 0!==t.UVGenerator?t.UVGenerator:qoe;let x,C,A,D,L,E=!1;y&&(x=y.getSpacedPoints(d),E=!0,p=!1,C=y.computeFrenetFrames(d,!1),A=new N,D=new N,L=new N),p||(w=0,m=0,g=0,v=0);const M=a.extractPoints(c);let R=M.shape;const $=M.holes;if(!pc.isClockWise(R)){R=R.reverse();for(let z=0,Oe=$.length;z<Oe;z++){const ye=$[z];pc.isClockWise(ye)&&($[z]=ye.reverse())}}const se=pc.triangulateShape(R,$),V=R;for(let z=0,Oe=$.length;z<Oe;z++)R=R.concat($[z]);function J(z,Oe,ye){return Oe||console.error("THREE.ExtrudeGeometry: vec does not exist"),z.clone().addScaledVector(Oe,ye)}const G=R.length,X=se.length;function Q(z,Oe,ye){let Ae,xe,lt;const Ze=z.x-Oe.x,et=z.y-Oe.y,Mt=ye.x-z.x,sn=ye.y-z.y,fi=Ze*Ze+et*et;if(Math.abs(Ze*sn-et*Mt)>Number.EPSILON){const P=Math.sqrt(fi),ie=Math.sqrt(Mt*Mt+sn*sn),Te=Oe.x-et/P,Ce=Oe.y+Ze/P,Ie=((ye.x-sn/ie-Te)*sn-(ye.y+Mt/ie-Ce)*Mt)/(Ze*sn-et*Mt);Ae=Te+Ze*Ie-z.x,xe=Ce+et*Ie-z.y;const qe=Ae*Ae+xe*xe;if(qe<=2)return new fe(Ae,xe);lt=Math.sqrt(qe/2)}else{let P=!1;Ze>Number.EPSILON?Mt>Number.EPSILON&&(P=!0):Ze<-Number.EPSILON?Mt<-Number.EPSILON&&(P=!0):Math.sign(et)===Math.sign(sn)&&(P=!0),P?(Ae=-et,xe=Ze,lt=Math.sqrt(fi)):(Ae=Ze,xe=et,lt=Math.sqrt(fi/2))}return new fe(Ae/lt,xe/lt)}const Z=[];for(let z=0,Oe=V.length,ye=Oe-1,Ae=z+1;z<Oe;z++,ye++,Ae++)ye===Oe&&(ye=0),Ae===Oe&&(Ae=0),Z[z]=Q(V[z],V[ye],V[Ae]);const le=[];let q,oe=Z.concat();for(let z=0,Oe=$.length;z<Oe;z++){const ye=$[z];q=[];for(let Ae=0,xe=ye.length,lt=xe-1,Ze=Ae+1;Ae<xe;Ae++,lt++,Ze++)lt===xe&&(lt=0),Ze===xe&&(Ze=0),q[Ae]=Q(ye[Ae],ye[lt],ye[Ze]);le.push(q),oe=oe.concat(q)}for(let z=0;z<w;z++){const Oe=z/w,ye=m*Math.cos(Oe*Math.PI/2),Ae=g*Math.sin(Oe*Math.PI/2)+v;for(let xe=0,lt=V.length;xe<lt;xe++){const Ze=J(V[xe],Z[xe],Ae);Be(Ze.x,Ze.y,-ye)}for(let xe=0,lt=$.length;xe<lt;xe++){const Ze=$[xe];q=le[xe];for(let et=0,Mt=Ze.length;et<Mt;et++){const sn=J(Ze[et],q[et],Ae);Be(sn.x,sn.y,-ye)}}}const Se=g+v;for(let z=0;z<G;z++){const Oe=p?J(R[z],oe[z],Se):R[z];E?(D.copy(C.normals[0]).multiplyScalar(Oe.x),A.copy(C.binormals[0]).multiplyScalar(Oe.y),L.copy(x[0]).add(D).add(A),Be(L.x,L.y,L.z)):Be(Oe.x,Oe.y,0)}for(let z=1;z<=d;z++)for(let Oe=0;Oe<G;Oe++){const ye=p?J(R[Oe],oe[Oe],Se):R[Oe];E?(D.copy(C.normals[z]).multiplyScalar(ye.x),A.copy(C.binormals[z]).multiplyScalar(ye.y),L.copy(x[z]).add(D).add(A),Be(L.x,L.y,L.z)):Be(ye.x,ye.y,h/d*z)}for(let z=w-1;z>=0;z--){const Oe=z/w,ye=m*Math.cos(Oe*Math.PI/2),Ae=g*Math.sin(Oe*Math.PI/2)+v;for(let xe=0,lt=V.length;xe<lt;xe++){const Ze=J(V[xe],Z[xe],Ae);Be(Ze.x,Ze.y,h+ye)}for(let xe=0,lt=$.length;xe<lt;xe++){const Ze=$[xe];q=le[xe];for(let et=0,Mt=Ze.length;et<Mt;et++){const sn=J(Ze[et],q[et],Ae);E?Be(sn.x,sn.y+x[d-1].y,x[d-1].x+ye):Be(sn.x,sn.y,h+ye)}}}function $e(z,Oe){let ye=z.length;for(;--ye>=0;){const Ae=ye;let xe=ye-1;xe<0&&(xe=z.length-1);for(let lt=0,Ze=d+2*w;lt<Ze;lt++){const et=G*lt,Mt=G*(lt+1);gt(Oe+Ae+et,Oe+xe+et,Oe+xe+Mt,Oe+Ae+Mt)}}}function Be(z,Oe,ye){l.push(z),l.push(Oe),l.push(ye)}function Xe(z,Oe,ye){At(z),At(Oe),At(ye);const Ae=r.length/3,xe=b.generateTopUV(i,r,Ae-3,Ae-2,Ae-1);it(xe[0]),it(xe[1]),it(xe[2])}function gt(z,Oe,ye,Ae){At(z),At(Oe),At(Ae),At(Oe),At(ye),At(Ae);const xe=r.length/3,lt=b.generateSideWallUV(i,r,xe-6,xe-3,xe-2,xe-1);it(lt[0]),it(lt[1]),it(lt[3]),it(lt[1]),it(lt[2]),it(lt[3])}function At(z){r.push(l[3*z+0]),r.push(l[3*z+1]),r.push(l[3*z+2])}function it(z){s.push(z.x),s.push(z.y)}(function ve(){const z=r.length/3;if(p){let Oe=0,ye=G*Oe;for(let Ae=0;Ae<X;Ae++){const xe=se[Ae];Xe(xe[2]+ye,xe[1]+ye,xe[0]+ye)}Oe=d+2*w,ye=G*Oe;for(let Ae=0;Ae<X;Ae++){const xe=se[Ae];Xe(xe[0]+ye,xe[1]+ye,xe[2]+ye)}}else{for(let Oe=0;Oe<X;Oe++){const ye=se[Oe];Xe(ye[2],ye[1],ye[0])}for(let Oe=0;Oe<X;Oe++){const ye=se[Oe];Xe(ye[0]+G*d,ye[1]+G*d,ye[2]+G*d)}}i.addGroup(z,r.length/3-z,0)})(),function Ne(){const z=r.length/3;let Oe=0;$e(V,Oe),Oe+=V.length;for(let ye=0,Ae=$.length;ye<Ae;ye++){const xe=$[ye];$e(xe,Oe),Oe+=xe.length}i.addGroup(z,r.length/3-z,1)}()}this.setAttribute("position",new Ke(r,3)),this.setAttribute("uv",new Ke(s,2)),this.computeVertexNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return function Xoe(n,e,t){if(t.shapes=[],Array.isArray(n))for(let i=0,r=n.length;i<r;i++)t.shapes.push(n[i].uuid);else t.shapes.push(n.uuid);return t.options=Object.assign({},e),void 0!==e.extrudePath&&(t.options.extrudePath=e.extrudePath.toJSON()),t}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){const i=[];for(let s=0,o=e.shapes.length;s<o;s++)i.push(t[e.shapes[s]]);const r=e.options.extrudePath;return void 0!==r&&(e.options.extrudePath=(new RE[r.type]).fromJSON(r)),new VE(i,e.options)}}const qoe={generateTopUV:function(n,e,t,i,r){const a=e[3*i],l=e[3*i+1],c=e[3*r],d=e[3*r+1];return[new fe(e[3*t],e[3*t+1]),new fe(a,l),new fe(c,d)]},generateSideWallUV:function(n,e,t,i,r,s){const o=e[3*t],a=e[3*t+1],l=e[3*t+2],c=e[3*i],d=e[3*i+1],h=e[3*i+2],p=e[3*r],m=e[3*r+1],g=e[3*r+2],v=e[3*s],w=e[3*s+1],y=e[3*s+2];return Math.abs(a-d)<Math.abs(o-c)?[new fe(o,1-l),new fe(c,1-h),new fe(p,1-g),new fe(v,1-y)]:[new fe(a,1-l),new fe(d,1-h),new fe(m,1-g),new fe(w,1-y)]}};class Lu extends bh{constructor(e=1,t=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Lu(e.radius,e.detail)}}class Zm extends Ot{constructor(e=1,t=32,i=16,r=0,s=2*Math.PI,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));const l=Math.min(o+a,Math.PI);let c=0;const d=[],h=new N,p=new N,m=[],g=[],v=[],w=[];for(let y=0;y<=i;y++){const b=[],x=y/i;let E=0;0===y&&0===o?E=.5/t:y===i&&l===Math.PI&&(E=-.5/t);for(let C=0;C<=t;C++){const A=C/t;h.x=-e*Math.cos(r+A*s)*Math.sin(o+x*a),h.y=e*Math.cos(o+x*a),h.z=e*Math.sin(r+A*s)*Math.sin(o+x*a),g.push(h.x,h.y,h.z),p.copy(h).normalize(),v.push(p.x,p.y,p.z),w.push(A+E,1-x),b.push(c++)}d.push(b)}for(let y=0;y<i;y++)for(let b=0;b<t;b++){const E=d[y][b],C=d[y+1][b],A=d[y+1][b+1];(0!==y||o>0)&&m.push(d[y][b+1],E,A),(y!==i-1||l<Math.PI)&&m.push(E,C,A)}this.setIndex(m),this.setAttribute("position",new Ke(g,3)),this.setAttribute("normal",new Ke(v,3)),this.setAttribute("uv",new Ke(w,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Zm(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Fu extends Ot{constructor(e=1,t=.4,i=12,r=48,s=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:r,arc:s},i=Math.floor(i),r=Math.floor(r);const o=[],a=[],l=[],c=[],d=new N,h=new N,p=new N;for(let m=0;m<=i;m++)for(let g=0;g<=r;g++){const v=g/r*s,w=m/i*Math.PI*2;h.x=(e+t*Math.cos(w))*Math.cos(v),h.y=(e+t*Math.cos(w))*Math.sin(v),h.z=t*Math.sin(w),a.push(h.x,h.y,h.z),d.x=e*Math.cos(v),d.y=e*Math.sin(v),p.subVectors(h,d).normalize(),l.push(p.x,p.y,p.z),c.push(g/r),c.push(m/i)}for(let m=1;m<=i;m++)for(let g=1;g<=r;g++){const w=(r+1)*(m-1)+g-1,y=(r+1)*(m-1)+g,b=(r+1)*m+g;o.push((r+1)*m+g-1,w,b),o.push(w,y,b)}this.setIndex(o),this.setAttribute("position",new Ke(a,3)),this.setAttribute("normal",new Ke(l,3)),this.setAttribute("uv",new Ke(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Fu(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class Jm extends xs{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new We(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new We(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new fe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class mc extends Jm{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new fe(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Ci(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new We(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new We(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new We(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class KR extends xs{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new We(16777215),this.specular=new We(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new We(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new fe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=kS,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class y4 extends xs{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new fe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}function Sh(n,e,t){return!n||!t&&n.constructor===e?n:"number"==typeof e.BYTES_PER_ELEMENT?new e(n):Array.prototype.slice.call(n)}function w4(n){const t=n.length,i=new Array(t);for(let r=0;r!==t;++r)i[r]=r;return i.sort(function e(r,s){return n[r]-n[s]}),i}function ZR(n,e,t){const i=n.length,r=new n.constructor(i);for(let s=0,o=0;o!==i;++s){const a=t[s]*e;for(let l=0;l!==e;++l)r[o++]=n[a+l]}return r}function JR(n,e,t,i){let r=1,s=n[0];for(;void 0!==s&&void 0===s[i];)s=n[r++];if(void 0===s)return;let o=s[i];if(void 0!==o)if(Array.isArray(o))do{o=s[i],void 0!==o&&(e.push(s.time),t.push.apply(t,o)),s=n[r++]}while(void 0!==s);else if(void 0!==o.toArray)do{o=s[i],void 0!==o&&(e.push(s.time),o.toArray(t,t.length)),s=n[r++]}while(void 0!==s);else do{o=s[i],void 0!==o&&(e.push(s.time),t.push(o)),s=n[r++]}while(void 0!==s)}class Yv{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,r=t[i],s=t[i-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=i+2;;){if(void 0===r){if(e<s)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(s=r,r=t[++i],e<r)break t}o=t.length;break n}if(e>=s)break e;{const a=t[1];e<a&&(i=2,s=a);for(let l=i-2;;){if(void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(i===l)break;if(r=s,s=t[--i-1],e>=s)break t}o=i,i=0}}for(;i<o;){const a=i+o>>>1;e<t[a]?o=a:i=a+1}if(r=t[i],s=t[i-1],void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=i[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class sae extends Yv{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(e,t,i){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],l=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case 2401:s=e,a=2*t-i;break;case 2402:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=i}if(void 0===l)switch(this.getSettings_().endingEnd){case 2401:o=e,l=2*i-t;break;case 2402:o=1,l=i+r[1]-r[0];break;default:o=e-1,l=t}const c=.5*(i-t),d=this.valueSize;this._weightPrev=c/(t-a),this._weightNext=c/(l-i),this._offsetPrev=s*d,this._offsetNext=o*d}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,d=this._offsetPrev,h=this._offsetNext,p=this._weightPrev,m=this._weightNext,g=(i-t)/(r-t),v=g*g,w=v*g,y=-p*w+2*p*v-p*g,b=(1+p)*w+(-1.5-2*p)*v+(-.5+p)*g+1,x=(-1-m)*w+(1.5+m)*v+.5*g,E=m*w-m*v;for(let C=0;C!==a;++C)s[C]=y*o[d+C]+b*o[c+C]+x*o[l+C]+E*o[h+C];return s}}class b4 extends Yv{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,d=(i-t)/(r-t),h=1-d;for(let p=0;p!==a;++p)s[p]=o[c+p]*h+o[l+p]*d;return s}}class oae extends Yv{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class al{constructor(e,t,i,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Sh(t,this.TimeBufferType),this.values=Sh(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:Sh(e.times,Array),values:Sh(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new oae(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new b4(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new sae(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Mv:t=this.InterpolantFactoryMethodDiscrete;break;case pm:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Mv;case this.InterpolantFactoryMethodLinear:return pm;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){const i=this.times,r=i.length;let s=0,o=r-1;for(;s!==r&&i[s]<e;)++s;for(;-1!==o&&i[o]>t;)--o;if(++o,0!==s||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=i.slice(s,o),this.values=this.values.slice(s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;0===s&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=i[a];if("number"==typeof l&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(null!==o&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(void 0!==r&&function v4(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}(r))for(let a=0,l=r.length;a!==l;++a){const c=r[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),i=this.getValueSize(),r=2302===this.getInterpolation(),s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const c=e[a];if(c!==e[a+1]&&(1!==a||c!==e[0]))if(r)l=!0;else{const h=a*i,p=h-i,m=h+i;for(let g=0;g!==i;++g){const v=t[h+g];if(v!==t[p+g]||v!==t[m+g]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const h=a*i,p=o*i;for(let m=0;m!==i;++m)t[p+m]=t[h+m]}++o}}if(s>0){e[o]=e[s];for(let a=s*i,l=o*i,c=0;c!==i;++c)t[l+c]=t[a+c];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*i)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}al.prototype.TimeBufferType=Float32Array,al.prototype.ValueBufferType=Float32Array,al.prototype.DefaultInterpolation=pm;class Qm extends al{}Qm.prototype.ValueTypeName="bool",Qm.prototype.ValueBufferType=Array,Qm.prototype.DefaultInterpolation=Mv,Qm.prototype.InterpolantFactoryMethodLinear=void 0,Qm.prototype.InterpolantFactoryMethodSmooth=void 0;class x4 extends al{}x4.prototype.ValueTypeName="color";class eg extends al{}eg.prototype.ValueTypeName="number";class aae extends Yv{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(i-t)/(r-t);let c=e*a;for(let d=c+a;c!==d;c+=4)zn.slerpFlat(s,0,o,c-a,o,c,l);return s}}class Eh extends al{InterpolantFactoryMethodLinear(e){return new aae(this.times,this.values,this.getValueSize(),e)}}Eh.prototype.ValueTypeName="quaternion",Eh.prototype.DefaultInterpolation=pm,Eh.prototype.InterpolantFactoryMethodSmooth=void 0;class tg extends al{}tg.prototype.ValueTypeName="string",tg.prototype.ValueBufferType=Array,tg.prototype.DefaultInterpolation=Mv,tg.prototype.InterpolantFactoryMethodLinear=void 0,tg.prototype.InterpolantFactoryMethodSmooth=void 0;class ng extends al{}ng.prototype.ValueTypeName="vector";class Kv{constructor(e,t=-1,i,r=2500){this.name=e,this.tracks=i,this.duration=t,this.blendMode=r,this.uuid=lo(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,r=1/(e.fps||1);for(let o=0,a=i.length;o!==a;++o)t.push(cae(i[o]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=i.length;s!==o;++s)t.push(al.toJSON(i[s]));return r}static CreateFromMorphTargetSequence(e,t,i,r){const s=t.length,o=[];for(let a=0;a<s;a++){let l=[],c=[];l.push((a+s-1)%s,a,(a+1)%s),c.push(0,1,0);const d=w4(l);l=ZR(l,1,d),c=ZR(c,1,d),!r&&0===l[0]&&(l.push(s),c.push(c[0])),o.push(new eg(".morphTargetInfluences["+t[a].name+"]",l,c).scale(1/i))}return new this(e,-1,o)}static findByName(e,t){let i=e;Array.isArray(e)||(i=e.geometry&&e.geometry.animations||e.animations);for(let r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const c=e[a],d=c.name.match(s);if(d&&d.length>1){const h=d[1];let p=r[h];p||(r[h]=p=[]),p.push(c)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],t,i));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(h,p,m,g,v){if(0!==m.length){const w=[],y=[];JR(m,w,y,g),0!==w.length&&v.push(new h(p,w,y))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let l=e.length||-1;const c=e.hierarchy||[];for(let h=0;h<c.length;h++){const p=c[h].keys;if(p&&0!==p.length)if(p[0].morphTargets){const m={};let g;for(g=0;g<p.length;g++)if(p[g].morphTargets)for(let v=0;v<p[g].morphTargets.length;v++)m[p[g].morphTargets[v]]=-1;for(const v in m){const w=[],y=[];for(let b=0;b!==p[g].morphTargets.length;++b){const x=p[g];w.push(x.time),y.push(x.morphTarget===v?1:0)}r.push(new eg(".morphTargetInfluence["+v+"]",w,y))}l=m.length*o}else{const m=".bones["+t[h].name+"]";i(ng,m+".position",p,"pos",r),i(Eh,m+".quaternion",p,"rot",r),i(ng,m+".scale",p,"scl",r)}}return 0===r.length?null:new this(s,l,r,a)}resetDuration(){let t=0;for(let i=0,r=this.tracks.length;i!==r;++i){const s=this.tracks[i];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function cae(n){if(void 0===n.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function lae(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return eg;case"vector":case"vector2":case"vector3":case"vector4":return ng;case"color":return x4;case"quaternion":return Eh;case"bool":case"boolean":return Qm;case"string":return tg}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}(n.type);if(void 0===n.times){const t=[],i=[];JR(n.keys,t,i,"value"),n.times=t,n.values=i}return void 0!==e.parse?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const ig={enabled:!1,files:{},add:function(n,e){!1!==this.enabled&&(this.files[n]=e)},get:function(n){if(!1!==this.enabled)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class S4{constructor(e,t,i){const r=this;let l,s=!1,o=0,a=0;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(d){a++,!1===s&&void 0!==r.onStart&&r.onStart(d,o,a),s=!0},this.itemEnd=function(d){o++,void 0!==r.onProgress&&r.onProgress(d,o,a),o===a&&(s=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(d){void 0!==r.onError&&r.onError(d)},this.resolveURL=function(d){return l?l(d):d},this.setURLModifier=function(d){return l=d,this},this.addHandler=function(d,h){return c.push(d,h),this},this.removeHandler=function(d){const h=c.indexOf(d);return-1!==h&&c.splice(h,2),this},this.getHandler=function(d){for(let h=0,p=c.length;h<p;h+=2){const m=c[h],g=c[h+1];if(m.global&&(m.lastIndex=0),m.test(d))return g}return null}}}const uae=new S4;let ll=(()=>{class n{constructor(t){this.manager=void 0!==t?t:uae,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,i){const r=this;return new Promise(function(s,o){r.load(t,s,i,o)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}return n.DEFAULT_MATERIAL_NAME="__DEFAULT",n})();const gc={};class dae extends Error{constructor(e,t){super(e),this.response=t}}class zs extends ll{constructor(e){super(e)}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=ig.get(e);if(void 0!==s)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(void 0!==gc[e])return void gc[e].push({onLoad:t,onProgress:i,onError:r});gc[e]=[],gc[e].push({onLoad:t,onProgress:i,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(c=>{if(200===c.status||0===c.status){if(0===c.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||void 0===c.body||void 0===c.body.getReader)return c;const d=gc[e],h=c.body.getReader(),p=c.headers.get("Content-Length")||c.headers.get("X-File-Size"),m=p?parseInt(p):0,g=0!==m;let v=0;const w=new ReadableStream({start(y){!function b(){h.read().then(({done:x,value:E})=>{if(x)y.close();else{v+=E.byteLength;const C=new ProgressEvent("progress",{lengthComputable:g,loaded:v,total:m});for(let A=0,D=d.length;A<D;A++){const L=d[A];L.onProgress&&L.onProgress(C)}y.enqueue(E),b()}})}()}});return new Response(w)}throw new dae(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`,c)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(d=>(new DOMParser).parseFromString(d,a));case"json":return c.json();default:if(void 0===a)return c.text();{const h=/charset="?([^;"\s]*)"?/i.exec(a),p=h&&h[1]?h[1].toLowerCase():void 0,m=new TextDecoder(p);return c.arrayBuffer().then(g=>m.decode(g))}}}).then(c=>{ig.add(e,c);const d=gc[e];delete gc[e];for(let h=0,p=d.length;h<p;h++){const m=d[h];m.onLoad&&m.onLoad(c)}}).catch(c=>{const d=gc[e];if(void 0===d)throw this.manager.itemError(e),c;delete gc[e];for(let h=0,p=d.length;h<p;h++){const m=d[h];m.onError&&m.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class HE extends ll{constructor(e){super(e)}load(e,t,i,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=ig.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=Av("img");function l(){d(),ig.add(e,this),t&&t(this),s.manager.itemEnd(e)}function c(h){d(),r&&r(h),s.manager.itemError(e),s.manager.itemEnd(e)}function d(){a.removeEventListener("load",l,!1),a.removeEventListener("error",c,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",c,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class E4 extends ll{constructor(e){super(e)}load(e,t,i,r){const s=new fE;s.colorSpace=_i;const o=new HE(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function l(c){o.load(e[c],function(d){s.images[c]=d,a++,6===a&&(s.needsUpdate=!0,t&&t(s))},void 0,r)}for(let c=0;c<e.length;++c)l(c);return s}}class QR extends ll{constructor(e){super(e)}load(e,t,i,r){const s=new Uo,o=new HE(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,void 0!==t&&t(s)},i,r),s}}class eP extends si{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new We(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}const tP=new Ct,C4=new N,M4=new N;class nP{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new fe(512,512),this.map=null,this.mapPass=null,this.matrix=new Ct,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new pR,this._frameExtents=new fe(1,1),this._viewportCount=1,this._viewports=[new Ln(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;C4.setFromMatrixPosition(e.matrixWorld),t.position.copy(C4),M4.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(M4),t.updateMatrixWorld(),tP.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(tP),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(tP)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class fae extends nP{constructor(){super(new cr(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,i=2*_m*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(i!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=i,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class T4 extends eP{constructor(e,t,i=0,r=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(si.DEFAULT_UP),this.updateMatrix(),this.target=new si,this.distance=i,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new fae}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const A4=new Ct,Zv=new N,iP=new N;class pae extends nP{constructor(){super(new cr(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new fe(4,2),this._viewportCount=6,this._viewports=[new Ln(2,1,1,1),new Ln(0,1,1,1),new Ln(3,1,1,1),new Ln(1,1,1,1),new Ln(3,0,1,1),new Ln(1,0,1,1)],this._cubeDirections=[new N(1,0,0),new N(-1,0,0),new N(0,0,1),new N(0,0,-1),new N(0,1,0),new N(0,-1,0)],this._cubeUps=[new N(0,1,0),new N(0,1,0),new N(0,1,0),new N(0,1,0),new N(0,0,1),new N(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),Zv.setFromMatrixPosition(e.matrixWorld),i.position.copy(Zv),iP.copy(i.position),iP.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(iP),i.updateMatrixWorld(),r.makeTranslation(-Zv.x,-Zv.y,-Zv.z),A4.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(A4)}}class rP extends eP{constructor(e,t,i=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new pae}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class mae extends nP{constructor(){super(new gE(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class D4 extends eP{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(si.DEFAULT_UP),this.updateMatrix(),this.target=new si,this.shadow=new mae}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class Jv{static decodeText(e){if(typeof TextDecoder<"u")return(new TextDecoder).decode(e);let t="";for(let i=0,r=e.length;i<r;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class Sae extends ll{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=ig.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a={};a.credentials="anonymous"===this.crossOrigin?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(l){ig.add(e,l),t&&t(l),s.manager.itemEnd(e)}).catch(function(l){r&&r(l),s.manager.itemError(e),s.manager.itemEnd(e)}),s.manager.itemStart(e)}}let zE;class P4{static getContext(){return void 0===zE&&(zE=new(window.AudioContext||window.webkitAudioContext)),zE}static setContext(e){zE=e}}class Eae extends ll{constructor(e){super(e)}load(e,t,i,r){const s=this,o=new zs(this.manager);function a(l){r?r(l):console.error(l),s.manager.itemError(e)}o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(l){try{const c=l.slice(0);P4.getContext().decodeAudioData(c,function(h){t(h)},a)}catch(c){a(c)}},i,r)}}class Cae{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=L4(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=L4();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function L4(){return(typeof performance>"u"?Date:performance).now()}const Mh=new N,F4=new zn,Mae=new N,Th=new N;class Tae extends si{constructor(){super(),this.type="AudioListener",this.context=P4.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Cae}getInput(){return this.gain}removeFilter(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,i=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Mh,F4,Mae),Th.set(0,0,-1).applyQuaternion(F4),t.positionX){const r=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Mh.x,r),t.positionY.linearRampToValueAtTime(Mh.y,r),t.positionZ.linearRampToValueAtTime(Mh.z,r),t.forwardX.linearRampToValueAtTime(Th.x,r),t.forwardY.linearRampToValueAtTime(Th.y,r),t.forwardZ.linearRampToValueAtTime(Th.z,r),t.upX.linearRampToValueAtTime(i.x,r),t.upY.linearRampToValueAtTime(i.y,r),t.upZ.linearRampToValueAtTime(i.z,r)}else t.setPosition(Mh.x,Mh.y,Mh.z),t.setOrientation(Th.x,Th.y,Th.z,i.x,i.y,i.z)}}class Aae extends si{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,null!==this.source&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(!1!==this._connected){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const Ah=new N,k4=new zn,Dae=new N,Dh=new N;class Iae extends Aae{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,i){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=i,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(Ah,k4,Dae),Dh.set(0,0,1).applyQuaternion(k4);const t=this.panner;if(t.positionX){const i=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Ah.x,i),t.positionY.linearRampToValueAtTime(Ah.y,i),t.positionZ.linearRampToValueAtTime(Ah.z,i),t.orientationX.linearRampToValueAtTime(Dh.x,i),t.orientationY.linearRampToValueAtTime(Dh.y,i),t.orientationZ.linearRampToValueAtTime(Dh.z,i)}else t.setPosition(Ah.x,Ah.y,Ah.z),t.setOrientation(Dh.x,Dh.y,Dh.z)}}const oP="\\[\\]\\.:\\/",Pae=new RegExp("["+oP+"]","g"),aP="[^"+oP+"]",Nae="[^"+oP.replace("\\.","")+"]",Uae=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",aP)+/(WCOD+)?/.source.replace("WCOD",Nae)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",aP)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",aP)+"$"),Bae=["material","materials","bones","map"];class Vae{constructor(e,t,i){const r=i||Qn.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}let Qn=(()=>{class n{constructor(t,i,r){this.path=i,this.parsedPath=r||n.parseTrackName(i),this.node=n.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,i,r){return t&&t.isAnimationObjectGroup?new n.Composite(t,i,r):new n(t,i,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(Pae,"")}static parseTrackName(t){const i=Uae.exec(t);if(null===i)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},s=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==s&&-1!==s){const o=r.nodeName.substring(s+1);-1!==Bae.indexOf(o)&&(r.nodeName=r.nodeName.substring(0,s),r.objectName=o)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,i){if(void 0===i||""===i||"."===i||-1===i||i===t.name||i===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(i);if(void 0!==r)return r}if(t.children){const r=function(o){for(let a=0;a<o.length;a++){const l=o[a];if(l.name===i||l.uuid===i)return l;const c=r(l.children);if(c)return c}return null},s=r(t.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,i){t[i]=this.targetObject[this.propertyName]}_getValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)t[i++]=r[s]}_getValue_arrayElement(t,i){t[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,i){this.resolvedProperty.toArray(t,i)}_setValue_direct(t,i){this.targetObject[this.propertyName]=t[i]}_setValue_direct_setNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++]}_setValue_array_setNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,i){this.resolvedProperty[this.propertyIndex]=t[i]}_setValue_arrayElement_setNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,i){this.resolvedProperty.fromArray(t,i)}_setValue_fromArray_setNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,i){this.bind(),this.getValue(t,i)}_setValue_unbound(t,i){this.bind(),this.setValue(t,i)}bind(){let t=this.node;const i=this.parsedPath,r=i.objectName,s=i.propertyName;let o=i.propertyIndex;if(t||(t=n.findNode(this.rootNode,i.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(r){let d=i.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let h=0;h<t.length;h++)if(t[h].name===d){d=h;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==d){if(void 0===t[d])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[d]}}const a=t[s];if(void 0===a)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+i.nodeName+"."+s+" but it wasn't found.",t);let l=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?l=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(void 0!==o){if("morphTargetInfluences"===s){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[o]&&(o=t.morphTargetDictionary[o])}c=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=o}else void 0!==a.fromArray&&void 0!==a.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(c=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=s;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return n.Composite=Vae,n})();Qn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Qn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Qn.prototype.GetterByBindingType=[Qn.prototype._getValue_direct,Qn.prototype._getValue_array,Qn.prototype._getValue_arrayElement,Qn.prototype._getValue_toArray],Qn.prototype.SetterByBindingTypeAndVersioning=[[Qn.prototype._setValue_direct,Qn.prototype._setValue_direct_setNeedsUpdate,Qn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Qn.prototype._setValue_array,Qn.prototype._setValue_array_setNeedsUpdate,Qn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Qn.prototype._setValue_arrayElement,Qn.prototype._setValue_arrayElement_setNeedsUpdate,Qn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Qn.prototype._setValue_fromArray,Qn.prototype._setValue_fromArray_setNeedsUpdate,Qn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],new Float32Array(1);class lP{constructor(e,t,i=0,r=1/0){this.ray=new Mm(e,t),this.near=i,this.far=r,this.camera=null,this.layers=new rR,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,i=[]){return cP(e,this,i,t),i.sort(B4),i}intersectObjects(e,t=!0,i=[]){for(let r=0,s=e.length;r<s;r++)cP(e[r],this,i,t);return i.sort(B4),i}}function B4(n,e){return n.distance-e.distance}function cP(n,e,t,i){if(n.layers.test(e.layers)&&n.raycast(e,t),!0===i){const r=n.children;for(let s=0,o=r.length;s<o;s++)cP(r[s],e,t,!0)}}class V4{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(Ci(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}class jae extends Xm{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=new Ot;r.setAttribute("position",new Ke(t,3)),r.setAttribute("color",new Ke([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),super(r,new Sr({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,t,i){const r=new We,s=this.geometry.attributes.color.array;return r.set(e),r.toArray(s,0),r.toArray(s,3),r.set(t),r.toArray(s,6),r.toArray(s,9),r.set(i),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class $ae{constructor(){this.type="ShapePath",this.color=new We,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new PE,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,i,r){return this.currentPath.quadraticCurveTo(e,t,i,r),this}bezierCurveTo(e,t,i,r,s,o){return this.currentPath.bezierCurveTo(e,t,i,r,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function i(y,b){const x=b.length;let E=!1;for(let C=x-1,A=0;A<x;C=A++){let D=b[C],L=b[A],M=L.x-D.x,R=L.y-D.y;if(Math.abs(R)>Number.EPSILON){if(R<0&&(D=b[A],M=-M,L=b[C],R=-R),y.y<D.y||y.y>L.y)continue;if(y.y===D.y){if(y.x===D.x)return!0}else{const $=R*(y.x-D.x)-M*(y.y-D.y);if(0===$)return!0;if($<0)continue;E=!E}}else{if(y.y!==D.y)continue;if(L.x<=y.x&&y.x<=D.x||D.x<=y.x&&y.x<=L.x)return!0}}return E}const r=pc.isClockWise,s=this.subPaths;if(0===s.length)return[];let o,a,l;const c=[];if(1===s.length)return a=s[0],l=new Ym,l.curves=a.curves,c.push(l),c;let d=!r(s[0].getPoints());d=e?!d:d;const h=[],p=[];let v,w,m=[],g=0;p[g]=void 0,m[g]=[];for(let y=0,b=s.length;y<b;y++)a=s[y],v=a.getPoints(),o=r(v),o=e?!o:o,o?(!d&&p[g]&&g++,p[g]={s:new Ym,p:v},p[g].s.curves=a.curves,d&&g++,m[g]=[]):m[g].push({h:a,p:v[0]});if(!p[0])return function t(y){const b=[];for(let x=0,E=y.length;x<E;x++){const C=y[x],A=new Ym;A.curves=C.curves,b.push(A)}return b}(s);if(p.length>1){let y=!1,b=0;for(let x=0,E=p.length;x<E;x++)h[x]=[];for(let x=0,E=p.length;x<E;x++){const C=m[x];for(let A=0;A<C.length;A++){const D=C[A];let L=!0;for(let M=0;M<p.length;M++)i(D.p,p[M].p)&&(x!==M&&b++,L?(L=!1,h[M].push(D)):y=!0);L&&h[x].push(D)}}b>0&&!1===y&&(m=h)}for(let y=0,b=p.length;y<b;y++){l=p[y].s,c.push(l),w=m[y];for(let x=0,E=w.length;x<E;x++)l.holes.push(w[x].h)}return c}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"157"}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="157");const K4={type:"change"},hP={type:"start"},Z4={type:"end"},YE=new Mm,J4=new fc,qae=Math.cos(70*Du_DEG2RAD);class Q4 extends uh{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new N,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:0,MIDDLE:1,RIGHT:2},this.touches={ONE:0,TWO:2},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return a.phi},this.getAzimuthalAngle=function(){return a.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(W){W.addEventListener("keydown",P),this._domElementKeyEvents=W},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",P),this._domElementKeyEvents=null},this.saveState=function(){i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=function(){i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(K4),i.update(),s=r.NONE},this.update=function(){const W=new N,Re=(new zn).setFromUnitVectors(e.up,new N(0,1,0)),we=Re.clone().invert(),Dt=new N,ct=new zn,_t=new N,at=2*Math.PI;return function(Fe=null){const Pe=i.object.position;W.copy(Pe).sub(i.target),W.applyQuaternion(Re),a.setFromVector3(W),i.autoRotate&&s===r.NONE&&$(function M(W){return null!==W?2*Math.PI/60*i.autoRotateSpeed*W:2*Math.PI/60/60*i.autoRotateSpeed}(Fe)),i.enableDamping?(a.theta+=l.theta*i.dampingFactor,a.phi+=l.phi*i.dampingFactor):(a.theta+=l.theta,a.phi+=l.phi);let je=i.minAzimuthAngle,ke=i.maxAzimuthAngle;isFinite(je)&&isFinite(ke)&&(je<-Math.PI?je+=at:je>Math.PI&&(je-=at),ke<-Math.PI?ke+=at:ke>Math.PI&&(ke-=at),a.theta=je<=ke?Math.max(je,Math.min(ke,a.theta)):a.theta>(je+ke)/2?Math.max(je,a.theta):Math.min(ke,a.theta)),a.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,a.phi)),a.makeSafe(),!0===i.enableDamping?i.target.addScaledVector(d,i.dampingFactor):i.target.add(d),a.radius=Z(i.zoomToCursor&&A||i.object.isOrthographicCamera?a.radius:a.radius*c),W.setFromSpherical(a),W.applyQuaternion(we),Pe.copy(i.target).add(W),i.object.lookAt(i.target),!0===i.enableDamping?(l.theta*=1-i.dampingFactor,l.phi*=1-i.dampingFactor,d.multiplyScalar(1-i.dampingFactor)):(l.set(0,0,0),d.set(0,0,0));let Ee=!1;if(i.zoomToCursor&&A){let st=null;if(i.object.isPerspectiveCamera){const Rt=W.length();st=Z(Rt*c),i.object.position.addScaledVector(E,Rt-st),i.object.updateMatrixWorld()}else if(i.object.isOrthographicCamera){const Rt=new N(C.x,C.y,0);Rt.unproject(i.object),i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/c)),i.object.updateProjectionMatrix(),Ee=!0;const Qi=new N(C.x,C.y,0);Qi.unproject(i.object),i.object.position.sub(Qi).add(Rt),i.object.updateMatrixWorld(),st=W.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),i.zoomToCursor=!1;null!==st&&(this.screenSpacePanning?i.target.set(0,0,-1).transformDirection(i.object.matrix).multiplyScalar(st).add(i.object.position):(YE.origin.copy(i.object.position),YE.direction.set(0,0,-1).transformDirection(i.object.matrix),Math.abs(i.object.up.dot(YE.direction))<qae?e.lookAt(i.target):(J4.setFromNormalAndCoplanarPoint(i.object.up,i.target),YE.intersectPlane(J4,i.target))))}else i.object.isOrthographicCamera&&(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/c)),i.object.updateProjectionMatrix(),Ee=!0);return c=1,A=!1,!!(Ee||Dt.distanceToSquared(i.object.position)>o||8*(1-ct.dot(i.object.quaternion))>o||_t.distanceToSquared(i.target)>0)&&(i.dispatchEvent(K4),Dt.copy(i.object.position),ct.copy(i.object.quaternion),_t.copy(i.target),Ee=!1,!0)}}(),this.dispose=function(){i.domElement.removeEventListener("contextmenu",Ce),i.domElement.removeEventListener("pointerdown",Ze),i.domElement.removeEventListener("pointercancel",Mt),i.domElement.removeEventListener("wheel",k),i.domElement.removeEventListener("pointermove",et),i.domElement.removeEventListener("pointerup",Mt),null!==i._domElementKeyEvents&&(i._domElementKeyEvents.removeEventListener("keydown",P),i._domElementKeyEvents=null)};const i=this,r={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let s=r.NONE;const o=1e-6,a=new V4,l=new V4;let c=1;const d=new N,h=new fe,p=new fe,m=new fe,g=new fe,v=new fe,w=new fe,y=new fe,b=new fe,x=new fe,E=new N,C=new fe;let A=!1;const D=[],L={};function R(){return Math.pow(.95,i.zoomSpeed)}function $(W){l.theta-=W}function ee(W){l.phi-=W}const se=function(){const W=new N;return function(we,Dt){W.setFromMatrixColumn(Dt,0),W.multiplyScalar(-we),d.add(W)}}(),V=function(){const W=new N;return function(we,Dt){!0===i.screenSpacePanning?W.setFromMatrixColumn(Dt,1):(W.setFromMatrixColumn(Dt,0),W.crossVectors(i.object.up,W)),W.multiplyScalar(we),d.add(W)}}(),J=function(){const W=new N;return function(we,Dt){const ct=i.domElement;if(i.object.isPerspectiveCamera){W.copy(i.object.position).sub(i.target);let at=W.length();at*=Math.tan(i.object.fov/2*Math.PI/180),se(2*we*at/ct.clientHeight,i.object.matrix),V(2*Dt*at/ct.clientHeight,i.object.matrix)}else i.object.isOrthographicCamera?(se(we*(i.object.right-i.object.left)/i.object.zoom/ct.clientWidth,i.object.matrix),V(Dt*(i.object.top-i.object.bottom)/i.object.zoom/ct.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}}();function G(W){i.object.isPerspectiveCamera||i.object.isOrthographicCamera?c/=W:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function X(W){i.object.isPerspectiveCamera||i.object.isOrthographicCamera?c*=W:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function Q(W){if(!i.zoomToCursor)return;A=!0;const Re=i.domElement.getBoundingClientRect(),Dt=W.clientY-Re.top,_t=Re.height;C.x=(W.clientX-Re.left)/Re.width*2-1,C.y=-Dt/_t*2+1,E.set(C.x,C.y,1).unproject(i.object).sub(i.object.position).normalize()}function Z(W){return Math.max(i.minDistance,Math.min(i.maxDistance,W))}function le(W){h.set(W.clientX,W.clientY)}function oe(W){g.set(W.clientX,W.clientY)}function Xe(){1===D.length?h.set(D[0].pageX,D[0].pageY):h.set(.5*(D[0].pageX+D[1].pageX),.5*(D[0].pageY+D[1].pageY))}function gt(){1===D.length?g.set(D[0].pageX,D[0].pageY):g.set(.5*(D[0].pageX+D[1].pageX),.5*(D[0].pageY+D[1].pageY))}function At(){const W=D[0].pageX-D[1].pageX,Re=D[0].pageY-D[1].pageY,we=Math.sqrt(W*W+Re*Re);y.set(0,we)}function Oe(W){if(1==D.length)p.set(W.pageX,W.pageY);else{const we=qe(W);p.set(.5*(W.pageX+we.x),.5*(W.pageY+we.y))}m.subVectors(p,h).multiplyScalar(i.rotateSpeed);const Re=i.domElement;$(2*Math.PI*m.x/Re.clientHeight),ee(2*Math.PI*m.y/Re.clientHeight),h.copy(p)}function ye(W){if(1===D.length)v.set(W.pageX,W.pageY);else{const Re=qe(W);v.set(.5*(W.pageX+Re.x),.5*(W.pageY+Re.y))}w.subVectors(v,g).multiplyScalar(i.panSpeed),J(w.x,w.y),g.copy(v)}function Ae(W){const Re=qe(W),we=W.pageX-Re.x,Dt=W.pageY-Re.y,ct=Math.sqrt(we*we+Dt*Dt);b.set(0,ct),x.set(0,Math.pow(b.y/y.y,i.zoomSpeed)),G(x.y),y.copy(b)}function Ze(W){!1!==i.enabled&&(0===D.length&&(i.domElement.setPointerCapture(W.pointerId),i.domElement.addEventListener("pointermove",et),i.domElement.addEventListener("pointerup",Mt)),function De(W){D.push(W)}(W),"touch"===W.pointerType?function ie(W){switch(Ie(W),D.length){case 1:switch(i.touches.ONE){case 0:if(!1===i.enableRotate)return;Xe(),s=r.TOUCH_ROTATE;break;case 1:if(!1===i.enablePan)return;gt(),s=r.TOUCH_PAN;break;default:s=r.NONE}break;case 2:switch(i.touches.TWO){case 2:if(!1===i.enableZoom&&!1===i.enablePan)return;(function it(){i.enableZoom&&At(),i.enablePan&&gt()})(),s=r.TOUCH_DOLLY_PAN;break;case 3:if(!1===i.enableZoom&&!1===i.enableRotate)return;(function z(){i.enableZoom&&At(),i.enableRotate&&Xe()})(),s=r.TOUCH_DOLLY_ROTATE;break;default:s=r.NONE}break;default:s=r.NONE}s!==r.NONE&&i.dispatchEvent(hP)}(W):function sn(W){let Re;switch(W.button){case 0:Re=i.mouseButtons.LEFT;break;case 1:Re=i.mouseButtons.MIDDLE;break;case 2:Re=i.mouseButtons.RIGHT;break;default:Re=-1}switch(Re){case 1:if(!1===i.enableZoom)return;(function q(W){Q(W),y.set(W.clientX,W.clientY)})(W),s=r.DOLLY;break;case 0:if(W.ctrlKey||W.metaKey||W.shiftKey){if(!1===i.enablePan)return;oe(W),s=r.PAN}else{if(!1===i.enableRotate)return;le(W),s=r.ROTATE}break;case 2:if(W.ctrlKey||W.metaKey||W.shiftKey){if(!1===i.enableRotate)return;le(W),s=r.ROTATE}else{if(!1===i.enablePan)return;oe(W),s=r.PAN}break;default:s=r.NONE}s!==r.NONE&&i.dispatchEvent(hP)}(W))}function et(W){!1!==i.enabled&&("touch"===W.pointerType?function Te(W){switch(Ie(W),s){case r.TOUCH_ROTATE:if(!1===i.enableRotate)return;Oe(W),i.update();break;case r.TOUCH_PAN:if(!1===i.enablePan)return;ye(W),i.update();break;case r.TOUCH_DOLLY_PAN:if(!1===i.enableZoom&&!1===i.enablePan)return;(function xe(W){i.enableZoom&&Ae(W),i.enablePan&&ye(W)})(W),i.update();break;case r.TOUCH_DOLLY_ROTATE:if(!1===i.enableZoom&&!1===i.enableRotate)return;(function lt(W){i.enableZoom&&Ae(W),i.enableRotate&&Oe(W)})(W),i.update();break;default:s=r.NONE}}(W):function fi(W){switch(s){case r.ROTATE:if(!1===i.enableRotate)return;!function Se(W){p.set(W.clientX,W.clientY),m.subVectors(p,h).multiplyScalar(i.rotateSpeed);const Re=i.domElement;$(2*Math.PI*m.x/Re.clientHeight),ee(2*Math.PI*m.y/Re.clientHeight),h.copy(p),i.update()}(W);break;case r.DOLLY:if(!1===i.enableZoom)return;!function ve(W){b.set(W.clientX,W.clientY),x.subVectors(b,y),x.y>0?G(R()):x.y<0&&X(R()),y.copy(b),i.update()}(W);break;case r.PAN:if(!1===i.enablePan)return;!function Ne(W){v.set(W.clientX,W.clientY),w.subVectors(v,g).multiplyScalar(i.panSpeed),J(w.x,w.y),g.copy(v),i.update()}(W)}}(W))}function Mt(W){(function ot(W){delete L[W.pointerId];for(let Re=0;Re<D.length;Re++)if(D[Re].pointerId==W.pointerId)return void D.splice(Re,1)})(W),0===D.length&&(i.domElement.releasePointerCapture(W.pointerId),i.domElement.removeEventListener("pointermove",et),i.domElement.removeEventListener("pointerup",Mt)),i.dispatchEvent(Z4),s=r.NONE}function k(W){!1===i.enabled||!1===i.enableZoom||s!==r.NONE||(W.preventDefault(),i.dispatchEvent(hP),function $e(W){Q(W),W.deltaY<0?X(R()):W.deltaY>0&&G(R()),i.update()}(W),i.dispatchEvent(Z4))}function P(W){!1===i.enabled||!1===i.enablePan||function Be(W){let Re=!1;switch(W.code){case i.keys.UP:W.ctrlKey||W.metaKey||W.shiftKey?ee(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):J(0,i.keyPanSpeed),Re=!0;break;case i.keys.BOTTOM:W.ctrlKey||W.metaKey||W.shiftKey?ee(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):J(0,-i.keyPanSpeed),Re=!0;break;case i.keys.LEFT:W.ctrlKey||W.metaKey||W.shiftKey?$(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):J(i.keyPanSpeed,0),Re=!0;break;case i.keys.RIGHT:W.ctrlKey||W.metaKey||W.shiftKey?$(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):J(-i.keyPanSpeed,0),Re=!0}Re&&(W.preventDefault(),i.update())}(W)}function Ce(W){!1!==i.enabled&&W.preventDefault()}function Ie(W){let Re=L[W.pointerId];void 0===Re&&(Re=new fe,L[W.pointerId]=Re),Re.set(W.pageX,W.pageY)}function qe(W){return L[(W.pointerId===D[0].pointerId?D[1]:D[0]).pointerId]}i.domElement.addEventListener("contextmenu",Ce),i.domElement.addEventListener("pointerdown",Ze),i.domElement.addEventListener("pointercancel",Mt),i.domElement.addEventListener("wheel",k,{passive:!1}),this.update()}}function eG(n,e){if(0===e)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),n;if(2===e||1===e){let t=n.getIndex();if(null===t){const o=[],a=n.getAttribute("position");if(void 0===a)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n;for(let l=0;l<a.count;l++)o.push(l);n.setIndex(o),t=n.getIndex()}const i=t.count-2,r=[];if(2===e)for(let o=1;o<=i;o++)r.push(t.getX(0)),r.push(t.getX(o)),r.push(t.getX(o+1));else for(let o=0;o<i;o++)o%2==0?(r.push(t.getX(o)),r.push(t.getX(o+1)),r.push(t.getX(o+2))):(r.push(t.getX(o+2)),r.push(t.getX(o+1)),r.push(t.getX(o)));r.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=n.clone();return s.setIndex(r),s.clearGroups(),s}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),n}class tG extends ll{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new Qae(t)}),this.register(function(t){return new ale(t)}),this.register(function(t){return new lle(t)}),this.register(function(t){return new cle(t)}),this.register(function(t){return new tle(t)}),this.register(function(t){return new nle(t)}),this.register(function(t){return new ile(t)}),this.register(function(t){return new rle(t)}),this.register(function(t){return new Jae(t)}),this.register(function(t){return new sle(t)}),this.register(function(t){return new ele(t)}),this.register(function(t){return new ole(t)}),this.register(function(t){return new Kae(t)}),this.register(function(t){return new ule(t)}),this.register(function(t){return new dle(t)})}load(e,t,i,r){const s=this;let o;o=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:Jv.extractUrlBase(e),this.manager.itemStart(e);const a=function(c){r?r(c):console.error(c),s.manager.itemError(e),s.manager.itemEnd(e)},l=new zs(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(c){try{s.parse(c,o,function(d){t(d),s.manager.itemEnd(e)},a)}catch(d){a(d)}},i,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,r){let s;const o={},a={},l=new TextDecoder;if("string"==typeof e)s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(l.decode(new Uint8Array(e,0,4))===nG){try{o[hn.KHR_BINARY_GLTF]=new hle(e)}catch(h){return void(r&&r(h))}s=JSON.parse(o[hn.KHR_BINARY_GLTF].content)}else s=JSON.parse(l.decode(e));else s=e;if(void 0===s.asset||s.asset.version[0]<2)return void(r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const c=new Cle(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});c.fileLoader.setRequestHeader(this.requestHeader);for(let d=0;d<this.pluginCallbacks.length;d++){const h=this.pluginCallbacks[d](c);a[h.name]=h,o[h.name]=!0}if(s.extensionsUsed)for(let d=0;d<s.extensionsUsed.length;++d){const h=s.extensionsUsed[d],p=s.extensionsRequired||[];switch(h){case hn.KHR_MATERIALS_UNLIT:o[h]=new Zae;break;case hn.KHR_DRACO_MESH_COMPRESSION:o[h]=new fle(s,this.dracoLoader);break;case hn.KHR_TEXTURE_TRANSFORM:o[h]=new ple;break;case hn.KHR_MESH_QUANTIZATION:o[h]=new mle;break;default:p.indexOf(h)>=0&&void 0===a[h]&&console.warn('THREE.GLTFLoader: Unknown extension "'+h+'".')}}c.setExtensions(o),c.setPlugins(a),c.parse(i,r)}parseAsync(e,t){const i=this;return new Promise(function(r,s){i.parse(e,t,r,s)})}}function Yae(){let n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}const hn={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class Kae{constructor(e){this.parser=e,this.name=hn.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let i=0,r=t.length;i<r;i++){const s=t[i];s.extensions&&s.extensions[this.name]&&void 0!==s.extensions[this.name].light&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,i="light:"+e;let r=t.cache.get(i);if(r)return r;const s=t.json,l=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let c;const d=new We(16777215);void 0!==l.color&&d.setRGB(l.color[0],l.color[1],l.color[2],Lr);const h=void 0!==l.range?l.range:0;switch(l.type){case"directional":c=new D4(d),c.target.position.set(0,0,-1),c.add(c.target);break;case"point":c=new rP(d),c.distance=h;break;case"spot":c=new T4(d),c.distance=h,l.spot=l.spot||{},l.spot.innerConeAngle=void 0!==l.spot.innerConeAngle?l.spot.innerConeAngle:0,l.spot.outerConeAngle=void 0!==l.spot.outerConeAngle?l.spot.outerConeAngle:Math.PI/4,c.angle=l.spot.outerConeAngle,c.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,c.target.position.set(0,0,-1),c.add(c.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return c.position.set(0,0,0),c.decay=2,Bu(c,l),void 0!==l.intensity&&(c.intensity=l.intensity),c.name=t.createUniqueName(l.name||"light_"+e),r=Promise.resolve(c),t.cache.add(i,r),r}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){const t=this,i=this.parser,s=i.json.nodes[e],a=(s.extensions&&s.extensions[this.name]||{}).light;return void 0===a?null:this._loadLight(a).then(function(l){return i._getNodeRef(t.cache,a,l)})}}class Zae{constructor(){this.name=hn.KHR_MATERIALS_UNLIT}getMaterialType(){return Mi}extendParams(e,t,i){const r=[];e.color=new We(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.setRGB(o[0],o[1],o[2],Lr),e.opacity=o[3]}void 0!==s.baseColorTexture&&r.push(i.assignTexture(e,"map",s.baseColorTexture,_i))}return Promise.all(r)}}class Jae{constructor(e){this.parser=e,this.name=hn.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name].emissiveStrength;return void 0!==s&&(t.emissiveIntensity=s),Promise.resolve()}}class Qae{constructor(e){this.parser=e,this.name=hn.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?mc:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];if(void 0!==o.clearcoatFactor&&(t.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&s.push(i.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&s.push(i.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(s.push(i.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){const a=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new fe(a,a)}return Promise.all(s)}}class ele{constructor(e){this.parser=e,this.name=hn.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?mc:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.iridescenceFactor&&(t.iridescence=o.iridescenceFactor),void 0!==o.iridescenceTexture&&s.push(i.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),void 0!==o.iridescenceIor&&(t.iridescenceIOR=o.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==o.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),void 0!==o.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),void 0!==o.iridescenceThicknessTexture&&s.push(i.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}}class tle{constructor(e){this.parser=e,this.name=hn.KHR_MATERIALS_SHEEN}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?mc:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new We(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=r.extensions[this.name];if(void 0!==o.sheenColorFactor){const a=o.sheenColorFactor;t.sheenColor.setRGB(a[0],a[1],a[2],Lr)}return void 0!==o.sheenRoughnessFactor&&(t.sheenRoughness=o.sheenRoughnessFactor),void 0!==o.sheenColorTexture&&s.push(i.assignTexture(t,"sheenColorMap",o.sheenColorTexture,_i)),void 0!==o.sheenRoughnessTexture&&s.push(i.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class nle{constructor(e){this.parser=e,this.name=hn.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?mc:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.transmissionFactor&&(t.transmission=o.transmissionFactor),void 0!==o.transmissionTexture&&s.push(i.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class ile{constructor(e){this.parser=e,this.name=hn.KHR_MATERIALS_VOLUME}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?mc:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.thickness=void 0!==o.thicknessFactor?o.thicknessFactor:0,void 0!==o.thicknessTexture&&s.push(i.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;const a=o.attenuationColor||[1,1,1];return t.attenuationColor=(new We).setRGB(a[0],a[1],a[2],Lr),Promise.all(s)}}class rle{constructor(e){this.parser=e,this.name=hn.KHR_MATERIALS_IOR}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?mc:null}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return t.ior=void 0!==s.ior?s.ior:1.5,Promise.resolve()}}class sle{constructor(e){this.parser=e,this.name=hn.KHR_MATERIALS_SPECULAR}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?mc:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.specularIntensity=void 0!==o.specularFactor?o.specularFactor:1,void 0!==o.specularTexture&&s.push(i.assignTexture(t,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return t.specularColor=(new We).setRGB(a[0],a[1],a[2],Lr),void 0!==o.specularColorTexture&&s.push(i.assignTexture(t,"specularColorMap",o.specularColorTexture,_i)),Promise.all(s)}}class ole{constructor(e){this.parser=e,this.name=hn.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?mc:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.anisotropyStrength&&(t.anisotropy=o.anisotropyStrength),void 0!==o.anisotropyRotation&&(t.anisotropyRotation=o.anisotropyRotation),void 0!==o.anisotropyTexture&&s.push(i.assignTexture(t,"anisotropyMap",o.anisotropyTexture)),Promise.all(s)}}class ale{constructor(e){this.parser=e,this.name=hn.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,i=t.json,r=i.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,o)}}class lle{constructor(e){this.parser=e,this.name=hn.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let l=i.textureLoader;if(a.uri){const c=i.options.manager.getHandler(a.uri);null!==c&&(l=c)}return this.detectSupport().then(function(c){if(c)return i.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class cle{constructor(e){this.parser=e,this.name=hn.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let l=i.textureLoader;if(a.uri){const c=i.options.manager.getHandler(a.uri);null!==c&&(l=c)}return this.detectSupport().then(function(c){if(c)return i.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class ule{constructor(e){this.name=hn.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){const r=i.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(a){const d=r.count,h=r.byteStride,p=new Uint8Array(a,r.byteOffset||0,r.byteLength||0);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(d,h,p,r.mode,r.filter).then(function(m){return m.buffer}):o.ready.then(function(){const m=new ArrayBuffer(d*h);return o.decodeGltfBuffer(new Uint8Array(m),d,h,p,r.mode,r.filter),m})})}return null}}class dle{constructor(e){this.name=hn.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,i=t.nodes[e];if(!i.extensions||!i.extensions[this.name]||void 0===i.mesh)return null;const r=t.meshes[i.mesh];for(const c of r.primitives)if(c.mode!==Vo.TRIANGLES&&c.mode!==Vo.TRIANGLE_STRIP&&c.mode!==Vo.TRIANGLE_FAN&&void 0!==c.mode)return null;const o=i.extensions[this.name].attributes,a=[],l={};for(const c in o)a.push(this.parser.getDependency("accessor",o[c]).then(d=>(l[c]=d,l[c])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(c=>{const d=c.pop(),h=d.isGroup?d.children:[d],p=c[0].count,m=[];for(const g of h){const v=new Ct,w=new N,y=new zn,b=new N(1,1,1),x=new Yz(g.geometry,g.material,p);for(let E=0;E<p;E++)l.TRANSLATION&&w.fromBufferAttribute(l.TRANSLATION,E),l.ROTATION&&y.fromBufferAttribute(l.ROTATION,E),l.SCALE&&b.fromBufferAttribute(l.SCALE,E),x.setMatrixAt(E,v.compose(w,y,b));for(const E in l)"TRANSLATION"!==E&&"ROTATION"!==E&&"SCALE"!==E&&g.geometry.setAttribute(E,l[E]);si.prototype.copy.call(x,g),this.parser.assignFinalMaterial(x),m.push(x)}return d.isGroup?(d.clear(),d.add(...m),d):m[0]}))}}const nG="glTF";class hle{constructor(e){this.name=hn.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12),i=new TextDecoder;if(this.header={magic:i.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==nG)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-12,s=new DataView(e,12);let o=0;for(;o<r;){const a=s.getUint32(o,!0);o+=4;const l=s.getUint32(o,!0);if(o+=4,1313821514===l){const c=new Uint8Array(e,12+o,a);this.content=i.decode(c)}else if(5130562===l){const c=12+o;this.body=e.slice(c,c+a)}o+=a}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class fle{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=hn.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const i=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},l={},c={};for(const d in o){const h=gP[d]||d.toLowerCase();a[h]=o[d]}for(const d in e.attributes){const h=gP[d]||d.toLowerCase();if(void 0!==o[d]){const p=i.accessors[e.attributes[d]];c[h]=rg[p.componentType].name,l[h]=!0===p.normalized}}return t.getDependency("bufferView",s).then(function(d){return new Promise(function(h){r.decodeDracoFile(d,function(p){for(const m in p.attributes){const v=l[m];void 0!==v&&(p.attributes[m].normalized=v)}h(p)},a,c)})})}}class ple{constructor(){this.name=hn.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(void 0===t.texCoord||t.texCoord===e.channel)&&void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.texCoord&&(e.channel=t.texCoord),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class mle{constructor(){this.name=hn.KHR_MESH_QUANTIZATION}}class rG extends Yv{constructor(e,t,i,r){super(e,t,i,r)}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let o=0;o!==r;o++)t[o]=i[s+o];return t}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=2*a,c=3*a,d=r-t,h=(i-t)/d,p=h*h,m=p*h,g=e*c,v=g-c,w=-2*m+3*p,y=m-p,b=1-w,x=y-p+h;for(let E=0;E!==a;E++)s[E]=b*o[v+E+a]+x*(o[v+E+l]*d)+w*o[g+E+a]+y*(o[g+E]*d);return s}}const gle=new zn;class _le extends rG{interpolate_(e,t,i,r){const s=super.interpolate_(e,t,i,r);return gle.fromArray(s).normalize().toArray(s),s}}const Vo={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},rg={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},sG={9728:Vi,9729:gi,9984:1004,9985:1007,9986:1005,9987:nc},oG={33071:Kr,33648:1002,10497:sh},mP={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},gP={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Uu={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},yle={CUBICSPLINE:void 0,LINEAR:pm,STEP:Mv};function Ih(n,e,t){for(const i in t.extensions)void 0===n[i]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=t.extensions[i])}function Bu(n,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(n.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function ble(n,e){if(n.updateMorphTargets(),void 0!==e.weights)for(let t=0,i=e.weights.length;t<i;t++)n.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(n.morphTargetInfluences.length===t.length){n.morphTargetDictionary={};for(let i=0,r=t.length;i<r;i++)n.morphTargetDictionary[t[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function xle(n){let e;const t=n.extensions&&n.extensions[hn.KHR_DRACO_MESH_COMPRESSION];if(e=t?"draco:"+t.bufferView+":"+t.indices+":"+yP(t.attributes):n.indices+":"+yP(n.attributes)+":"+n.mode,void 0!==n.targets)for(let i=0,r=n.targets.length;i<r;i++)e+=":"+yP(n.targets[i]);return e}function yP(n){let e="";const t=Object.keys(n).sort();for(let i=0,r=t.length;i<r;i++)e+=t[i]+":"+n[t[i]]+";";return e}function vP(n){switch(n){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const Ele=new Ct;class Cle{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new Yae,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,r=!1,s=-1;typeof navigator<"u"&&(i=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),r=navigator.userAgent.indexOf("Firefox")>-1,s=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),this.textureLoader=typeof createImageBitmap>"u"||i||r&&s<98?new QR(this.options.manager):new Sae(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new zs(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const i=this,r=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(o){const a={scene:o[0][r.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:r.asset,parser:i,userData:{}};return Ih(s,a,r),Bu(a,r),Promise.all(i._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){e(a)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){const o=t[r].joints;for(let a=0,l=o.length;a<l;a++)e[o[a]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const o=e[r];void 0!==o.mesh&&(this._addNodeRef(this.meshCache,o.mesh),void 0!==o.skin&&(i[o.mesh].isSkinnedMesh=!0)),void 0!==o.camera&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;const r=i.clone(),s=(o,a)=>{const l=this.associations.get(o);null!=l&&this.associations.set(a,l);for(const[c,d]of o.children.entries())s(d,a.children[c])};return s(i,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){const r=e(t[i]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const i=[];for(let r=0;r<t.length;r++){const s=e(t[r]);s&&i.push(s)}return i}getDependency(e,t){const i=e+":"+t;let r=this.cache.get(i);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!r)throw new Error("Unknown type: "+e)}this.cache.add(i,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const i=this;t=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map(function(s,o){return i.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],i=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[hn.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,o){i.load(Jv.resolveURL(t.uri,r.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(i){const s=t.byteOffset||0;return i.slice(s,s+(t.byteLength||0))})}loadAccessor(e){const t=this,i=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse){const o=mP[r.type],l=!0===r.normalized,c=new(0,rg[r.componentType])(r.count*o);return Promise.resolve(new Jn(c,o,l))}const s=[];return s.push(void 0!==r.bufferView?this.getDependency("bufferView",r.bufferView):null),void 0!==r.sparse&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(o){const a=o[0],l=mP[r.type],c=rg[r.componentType],d=c.BYTES_PER_ELEMENT,p=r.byteOffset||0,m=void 0!==r.bufferView?i.bufferViews[r.bufferView].byteStride:void 0,g=!0===r.normalized;let v,w;if(m&&m!==d*l){const y=Math.floor(p/m),b="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+y+":"+r.count;let x=t.cache.get(b);x||(v=new c(a,y*m,r.count*m/d),x=new CR(v,m/d),t.cache.add(b,x)),w=new vh(x,l,p%m/d,g)}else v=null===a?new c(r.count*l):new c(a,p,r.count*l),w=new Jn(v,l,g);if(void 0!==r.sparse){const E=r.sparse.values.byteOffset||0,C=new(0,rg[r.sparse.indices.componentType])(o[1],r.sparse.indices.byteOffset||0,r.sparse.count*mP.SCALAR),A=new c(o[2],E,r.sparse.count*l);null!==a&&(w=new Jn(w.array.slice(),w.itemSize,w.normalized));for(let D=0,L=C.length;D<L;D++){const M=C[D];if(w.setX(M,A[D*l]),l>=2&&w.setY(M,A[D*l+1]),l>=3&&w.setZ(M,A[D*l+2]),l>=4&&w.setW(M,A[D*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return w})}loadTexture(e){const t=this.json,s=t.textures[e].source,o=t.images[s];let a=this.textureLoader;if(o.uri){const l=this.options.manager.getHandler(o.uri);null!==l&&(a=l)}return this.loadTextureImage(e,s,a)}loadTextureImage(e,t,i){const r=this,s=this.json,o=s.textures[e],a=s.images[t],l=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[l])return this.textureCache[l];const c=this.loadImageSource(t,i).then(function(d){d.flipY=!1,d.name=o.name||a.name||"",""===d.name&&"string"==typeof a.uri&&!1===a.uri.startsWith("data:image/")&&(d.name=a.uri);const p=(s.samplers||{})[o.sampler]||{};return d.magFilter=sG[p.magFilter]||gi,d.minFilter=sG[p.minFilter]||nc,d.wrapS=oG[p.wrapS]||sh,d.wrapT=oG[p.wrapT]||sh,r.associations.set(d,{textures:e}),d}).catch(function(){return null});return this.textureCache[l]=c,c}loadImageSource(e,t){const r=this.json,s=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(h=>h.clone());const o=r.images[e],a=self.URL||self.webkitURL;let l=o.uri||"",c=!1;if(void 0!==o.bufferView)l=this.getDependency("bufferView",o.bufferView).then(function(h){c=!0;const p=new Blob([h],{type:o.mimeType});return l=a.createObjectURL(p),l});else if(void 0===o.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const d=Promise.resolve(l).then(function(h){return new Promise(function(p,m){let g=p;!0===t.isImageBitmapLoader&&(g=function(v){const w=new Uo(v);w.needsUpdate=!0,p(w)}),t.load(Jv.resolveURL(h,s.path),g,void 0,m)})}).then(function(h){return!0===c&&a.revokeObjectURL(l),h.userData.mimeType=o.mimeType||function Sle(n){return n.search(/\.jpe?g($|\?)/i)>0||0===n.search(/^data\:image\/jpeg/)?"image/jpeg":n.search(/\.webp($|\?)/i)>0||0===n.search(/^data\:image\/webp/)?"image/webp":"image/png"}(o.uri),h}).catch(function(h){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),h});return this.sourceCache[e]=d,d}assignTexture(e,t,i,r){const s=this;return this.getDependency("texture",i.index).then(function(o){if(!o)return null;if(void 0!==i.texCoord&&i.texCoord>0&&((o=o.clone()).channel=i.texCoord),s.extensions[hn.KHR_TEXTURE_TRANSFORM]){const a=void 0!==i.extensions?i.extensions[hn.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const l=s.associations.get(o);o=s.extensions[hn.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),s.associations.set(o,l)}}return void 0!==r&&(o.colorSpace=r),e[t]=o,o})}assignFinalMaterial(e){const t=e.geometry;let i=e.material;const r=void 0===t.attributes.tangent,s=void 0!==t.attributes.color,o=void 0===t.attributes.normal;if(e.isPoints){const a="PointsMaterial:"+i.uuid;let l=this.cache.get(a);l||(l=new wh,xs.prototype.copy.call(l,i),l.color.copy(i.color),l.map=i.map,l.sizeAttenuation=!1,this.cache.add(a,l)),i=l}else if(e.isLine){const a="LineBasicMaterial:"+i.uuid;let l=this.cache.get(a);l||(l=new Sr,xs.prototype.copy.call(l,i),l.color.copy(i.color),l.map=i.map,this.cache.add(a,l)),i=l}if(r||s||o){let a="ClonedMaterial:"+i.uuid+":";r&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=i.clone(),s&&(l.vertexColors=!0),o&&(l.flatShading=!0),r&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(i))),i=l}e.material=i}getMaterialType(){return Jm}loadMaterial(e){const t=this,r=this.extensions,s=this.json.materials[e];let o;const a={},c=[];if((s.extensions||{})[hn.KHR_MATERIALS_UNLIT]){const h=r[hn.KHR_MATERIALS_UNLIT];o=h.getMaterialType(),c.push(h.extendParams(a,s,t))}else{const h=s.pbrMetallicRoughness||{};if(a.color=new We(1,1,1),a.opacity=1,Array.isArray(h.baseColorFactor)){const p=h.baseColorFactor;a.color.setRGB(p[0],p[1],p[2],Lr),a.opacity=p[3]}void 0!==h.baseColorTexture&&c.push(t.assignTexture(a,"map",h.baseColorTexture,_i)),a.metalness=void 0!==h.metallicFactor?h.metallicFactor:1,a.roughness=void 0!==h.roughnessFactor?h.roughnessFactor:1,void 0!==h.metallicRoughnessTexture&&(c.push(t.assignTexture(a,"metalnessMap",h.metallicRoughnessTexture)),c.push(t.assignTexture(a,"roughnessMap",h.metallicRoughnessTexture))),o=this._invokeOne(function(p){return p.getMaterialType&&p.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(p){return p.extendMaterialParams&&p.extendMaterialParams(e,a)})))}!0===s.doubleSided&&(a.side=2);const d=s.alphaMode||"OPAQUE";if("BLEND"===d?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,"MASK"===d&&(a.alphaTest=void 0!==s.alphaCutoff?s.alphaCutoff:.5)),void 0!==s.normalTexture&&o!==Mi&&(c.push(t.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new fe(1,1),void 0!==s.normalTexture.scale)){const h=s.normalTexture.scale;a.normalScale.set(h,h)}if(void 0!==s.occlusionTexture&&o!==Mi&&(c.push(t.assignTexture(a,"aoMap",s.occlusionTexture)),void 0!==s.occlusionTexture.strength&&(a.aoMapIntensity=s.occlusionTexture.strength)),void 0!==s.emissiveFactor&&o!==Mi){const h=s.emissiveFactor;a.emissive=(new We).setRGB(h[0],h[1],h[2],Lr)}return void 0!==s.emissiveTexture&&o!==Mi&&c.push(t.assignTexture(a,"emissiveMap",s.emissiveTexture,_i)),Promise.all(c).then(function(){const h=new o(a);return s.name&&(h.name=s.name),Bu(h,s),t.associations.set(h,{materials:e}),s.extensions&&Ih(r,h,s),h})}createUniqueName(e){const t=Qn.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,i=this.extensions,r=this.primitiveCache;function s(a){return i[hn.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(l){return aG(l,a,t)})}const o=[];for(let a=0,l=e.length;a<l;a++){const c=e[a],d=xle(c),h=r[d];if(h)o.push(h.promise);else{let p;p=c.extensions&&c.extensions[hn.KHR_DRACO_MESH_COMPRESSION]?s(c):aG(new Ot,c,t),r[d]={primitive:c,promise:p},o.push(p)}}return Promise.all(o)}loadMesh(e){const t=this,r=this.extensions,s=this.json.meshes[e],o=s.primitives,a=[];for(let l=0,c=o.length;l<c;l++){const d=void 0===o[l].material?(void 0===(n=this.cache).DefaultMaterial&&(n.DefaultMaterial=new Jm({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:0})),n.DefaultMaterial):this.getDependency("material",o[l].material);a.push(d)}var n;return a.push(t.loadGeometries(o)),Promise.all(a).then(function(l){const c=l.slice(0,l.length-1),d=l[l.length-1],h=[];for(let m=0,g=d.length;m<g;m++){const v=d[m],w=o[m];let y;const b=c[m];if(w.mode===Vo.TRIANGLES||w.mode===Vo.TRIANGLE_STRIP||w.mode===Vo.TRIANGLE_FAN||void 0===w.mode)y=!0===s.isSkinnedMesh?new jz(v,b):new Me(v,b),!0===y.isSkinnedMesh&&y.normalizeSkinWeights(),w.mode===Vo.TRIANGLE_STRIP?y.geometry=eG(y.geometry,1):w.mode===Vo.TRIANGLE_FAN&&(y.geometry=eG(y.geometry,2));else if(w.mode===Vo.LINES)y=new Xm(v,b);else if(w.mode===Vo.LINE_STRIP)y=new Qr(v,b);else if(w.mode===Vo.LINE_LOOP)y=new t4(v,b);else{if(w.mode!==Vo.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+w.mode);y=new Gv(v,b)}Object.keys(y.geometry.morphAttributes).length>0&&ble(y,s),y.name=t.createUniqueName(s.name||"mesh_"+e),Bu(y,s),w.extensions&&Ih(r,y,w),t.assignFinalMaterial(y),h.push(y)}for(let m=0,g=h.length;m<g;m++)t.associations.set(h[m],{meshes:e,primitives:m});if(1===h.length)return s.extensions&&Ih(r,h[0],s),h[0];const p=new xa;s.extensions&&Ih(r,p,s),t.associations.set(p,{meshes:e});for(let m=0,g=h.length;m<g;m++)p.add(h[m]);return p})}loadCamera(e){let t;const i=this.json.cameras[e],r=i[i.type];if(r)return"perspective"===i.type?t=new cr(Du_radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===i.type&&(t=new gE(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),Bu(t,i),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],i=[];for(let r=0,s=t.joints.length;r<s;r++)i.push(this._loadNodeShallow(t.joints[r]));return i.push(void 0!==t.inverseBindMatrices?this.getDependency("accessor",t.inverseBindMatrices):null),Promise.all(i).then(function(r){const s=r.pop(),o=r,a=[],l=[];for(let c=0,d=o.length;c<d;c++){const h=o[c];if(h){a.push(h);const p=new Ct;null!==s&&p.fromArray(s.array,16*c),l.push(p)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[c])}return new CE(a,l)})}loadAnimation(e){const i=this,r=this.json.animations[e],s=r.name?r.name:"animation_"+e,o=[],a=[],l=[],c=[],d=[];for(let h=0,p=r.channels.length;h<p;h++){const m=r.channels[h],g=r.samplers[m.sampler],v=m.target,y=void 0!==r.parameters?r.parameters[g.input]:g.input,b=void 0!==r.parameters?r.parameters[g.output]:g.output;void 0!==v.node&&(o.push(this.getDependency("node",v.node)),a.push(this.getDependency("accessor",y)),l.push(this.getDependency("accessor",b)),c.push(g),d.push(v))}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l),Promise.all(c),Promise.all(d)]).then(function(h){const p=h[0],m=h[1],g=h[2],v=h[3],w=h[4],y=[];for(let b=0,x=p.length;b<x;b++){const E=p[b],C=m[b],A=g[b],D=v[b],L=w[b];if(void 0===E)continue;E.updateMatrix&&E.updateMatrix();const M=i._createAnimationTracks(E,C,A,D,L);if(M)for(let R=0;R<M.length;R++)y.push(M[R])}return new Kv(s,void 0,y)})}createNodeMesh(e){const i=this,r=this.json.nodes[e];return void 0===r.mesh?null:i.getDependency("mesh",r.mesh).then(function(s){const o=i._getNodeRef(i.meshCache,r.mesh,s);return void 0!==r.weights&&o.traverse(function(a){if(a.isMesh)for(let l=0,c=r.weights.length;l<c;l++)a.morphTargetInfluences[l]=r.weights[l]}),o})}loadNode(e){const i=this,r=this.json.nodes[e],s=i._loadNodeShallow(e),o=[],a=r.children||[];for(let c=0,d=a.length;c<d;c++)o.push(i.getDependency("node",a[c]));const l=void 0===r.skin?Promise.resolve(null):i.getDependency("skin",r.skin);return Promise.all([s,Promise.all(o),l]).then(function(c){const d=c[0],h=c[1],p=c[2];null!==p&&d.traverse(function(m){m.isSkinnedMesh&&m.bind(p,Ele)});for(let m=0,g=h.length;m<g;m++)d.add(h[m]);return d})}_loadNodeShallow(e){const i=this.extensions,r=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];const s=this.json.nodes[e],o=s.name?r.createUniqueName(s.name):"",a=[],l=r._invokeOne(function(c){return c.createNodeMesh&&c.createNodeMesh(e)});return l&&a.push(l),void 0!==s.camera&&a.push(r.getDependency("camera",s.camera).then(function(c){return r._getNodeRef(r.cameraCache,s.camera,c)})),r._invokeAll(function(c){return c.createNodeAttachment&&c.createNodeAttachment(e)}).forEach(function(c){a.push(c)}),this.nodeCache[e]=Promise.all(a).then(function(c){let d;if(d=!0===s.isBone?new DR:c.length>1?new xa:1===c.length?c[0]:new si,d!==c[0])for(let h=0,p=c.length;h<p;h++)d.add(c[h]);if(s.name&&(d.userData.name=s.name,d.name=o),Bu(d,s),s.extensions&&Ih(i,d,s),void 0!==s.matrix){const h=new Ct;h.fromArray(s.matrix),d.applyMatrix4(h)}else void 0!==s.translation&&d.position.fromArray(s.translation),void 0!==s.rotation&&d.quaternion.fromArray(s.rotation),void 0!==s.scale&&d.scale.fromArray(s.scale);return r.associations.has(d)||r.associations.set(d,{}),r.associations.get(d).nodes=e,d}),this.nodeCache[e]}loadScene(e){const t=this.extensions,i=this.json.scenes[e],r=this,s=new xa;i.name&&(s.name=r.createUniqueName(i.name)),Bu(s,i),i.extensions&&Ih(t,s,i);const o=i.nodes||[],a=[];for(let l=0,c=o.length;l<c;l++)a.push(r.getDependency("node",o[l]));return Promise.all(a).then(function(l){for(let d=0,h=l.length;d<h;d++)s.add(l[d]);return r.associations=(d=>{const h=new Map;for(const[p,m]of r.associations)(p instanceof xs||p instanceof Uo)&&h.set(p,m);return d.traverse(p=>{const m=r.associations.get(p);null!=m&&h.set(p,m)}),h})(s),s})}_createAnimationTracks(e,t,i,r,s){const o=[],a=e.name?e.name:e.uuid,l=[];let c;switch(Uu[s.path]===Uu.weights?e.traverse(function(p){p.morphTargetInfluences&&l.push(p.name?p.name:p.uuid)}):l.push(a),Uu[s.path]){case Uu.weights:c=eg;break;case Uu.rotation:c=Eh;break;case Uu.position:case Uu.scale:c=ng;break;default:c=1===i.itemSize?eg:ng}const d=void 0!==r.interpolation?yle[r.interpolation]:pm,h=this._getArrayFromAccessor(i);for(let p=0,m=l.length;p<m;p++){const g=new c(l[p]+"."+Uu[s.path],t.array,h,d);"CUBICSPLINE"===r.interpolation&&this._createCubicSplineTrackInterpolant(g),o.push(g)}return o}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const i=vP(t.constructor),r=new Float32Array(t.length);for(let s=0,o=t.length;s<o;s++)r[s]=t[s]*i;t=r}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(i){return new(this instanceof Eh?_le:rG)(this.times,this.values,this.getValueSize()/3,i)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function aG(n,e,t){const i=e.attributes,r=[];function s(o,a){return t.getDependency("accessor",o).then(function(l){n.setAttribute(a,l)})}for(const o in i){const a=gP[o]||o.toLowerCase();a in n.attributes||r.push(s(i[o],a))}if(void 0!==e.indices&&!n.index){const o=t.getDependency("accessor",e.indices).then(function(a){n.setIndex(a)});r.push(o)}return Mn.workingColorSpace!==Lr&&"COLOR_0"in i&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${Mn.workingColorSpace}" not supported.`),Bu(n,e),function Mle(n,e,t){const i=e.attributes,r=new rl;if(void 0===i.POSITION)return;{const a=t.json.accessors[i.POSITION],l=a.min,c=a.max;if(void 0===l||void 0===c)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(r.set(new N(l[0],l[1],l[2]),new N(c[0],c[1],c[2])),a.normalized){const d=vP(rg[a.componentType]);r.min.multiplyScalar(d),r.max.multiplyScalar(d)}}const s=e.targets;if(void 0!==s){const a=new N,l=new N;for(let c=0,d=s.length;c<d;c++){const h=s[c];if(void 0!==h.POSITION){const p=t.json.accessors[h.POSITION],m=p.min,g=p.max;if(void 0!==m&&void 0!==g){if(l.setX(Math.max(Math.abs(m[0]),Math.abs(g[0]))),l.setY(Math.max(Math.abs(m[1]),Math.abs(g[1]))),l.setZ(Math.max(Math.abs(m[2]),Math.abs(g[2]))),p.normalized){const v=vP(rg[p.componentType]);l.multiplyScalar(v)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(a)}n.boundingBox=r;const o=new va;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,n.boundingSphere=o}(n,e,t),Promise.all(r).then(function(){return void 0!==e.targets?function wle(n,e,t){let i=!1,r=!1,s=!1;for(let c=0,d=e.length;c<d;c++){const h=e[c];if(void 0!==h.POSITION&&(i=!0),void 0!==h.NORMAL&&(r=!0),void 0!==h.COLOR_0&&(s=!0),i&&r&&s)break}if(!i&&!r&&!s)return Promise.resolve(n);const o=[],a=[],l=[];for(let c=0,d=e.length;c<d;c++){const h=e[c];if(i){const p=void 0!==h.POSITION?t.getDependency("accessor",h.POSITION):n.attributes.position;o.push(p)}if(r){const p=void 0!==h.NORMAL?t.getDependency("accessor",h.NORMAL):n.attributes.normal;a.push(p)}if(s){const p=void 0!==h.COLOR_0?t.getDependency("accessor",h.COLOR_0):n.attributes.color;l.push(p)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(c){const h=c[1],p=c[2];return i&&(n.morphAttributes.position=c[0]),r&&(n.morphAttributes.normal=h),s&&(n.morphAttributes.color=p),n.morphTargetsRelative=!0,n})}(n,e.targets,t):n})}var sg=Hh(990);class e0{constructor(e,t,i){this.x=e,this.y=t,this.z=i}static FromJson(e){return new e0(e.x,e.y,e.z)}}var n,og=Object.freeze({Linear:Object.freeze({None:function(n){return n},In:function(n){return this.None(n)},Out:function(n){return this.None(n)},InOut:function(n){return this.None(n)}}),Quadratic:Object.freeze({In:function(n){return n*n},Out:function(n){return n*(2-n)},InOut:function(n){return(n*=2)<1?.5*n*n:-.5*(--n*(n-2)-1)}}),Cubic:Object.freeze({In:function(n){return n*n*n},Out:function(n){return--n*n*n+1},InOut:function(n){return(n*=2)<1?.5*n*n*n:.5*((n-=2)*n*n+2)}}),Quartic:Object.freeze({In:function(n){return n*n*n*n},Out:function(n){return 1- --n*n*n*n},InOut:function(n){return(n*=2)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2)}}),Quintic:Object.freeze({In:function(n){return n*n*n*n*n},Out:function(n){return--n*n*n*n*n+1},InOut:function(n){return(n*=2)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2)}}),Sinusoidal:Object.freeze({In:function(n){return 1-Math.sin((1-n)*Math.PI/2)},Out:function(n){return Math.sin(n*Math.PI/2)},InOut:function(n){return.5*(1-Math.sin(Math.PI*(.5-n)))}}),Exponential:Object.freeze({In:function(n){return 0===n?0:Math.pow(1024,n-1)},Out:function(n){return 1===n?1:1-Math.pow(2,-10*n)},InOut:function(n){return 0===n?0:1===n?1:(n*=2)<1?.5*Math.pow(1024,n-1):.5*(2-Math.pow(2,-10*(n-1)))}}),Circular:Object.freeze({In:function(n){return 1-Math.sqrt(1-n*n)},Out:function(n){return Math.sqrt(1- --n*n)},InOut:function(n){return(n*=2)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1)}}),Elastic:Object.freeze({In:function(n){return 0===n?0:1===n?1:-Math.pow(2,10*(n-1))*Math.sin(5*(n-1.1)*Math.PI)},Out:function(n){return 0===n?0:1===n?1:Math.pow(2,-10*n)*Math.sin(5*(n-.1)*Math.PI)+1},InOut:function(n){return 0===n?0:1===n?1:(n*=2)<1?-.5*Math.pow(2,10*(n-1))*Math.sin(5*(n-1.1)*Math.PI):.5*Math.pow(2,-10*(n-1))*Math.sin(5*(n-1.1)*Math.PI)+1}}),Back:Object.freeze({In:function(n){var e=1.70158;return 1===n?1:n*n*((e+1)*n-e)},Out:function(n){var e=1.70158;return 0===n?0:--n*n*((e+1)*n+e)+1},InOut:function(n){var e=2.5949095;return(n*=2)<1?n*n*((e+1)*n-e)*.5:.5*((n-=2)*n*((e+1)*n+e)+2)}}),Bounce:Object.freeze({In:function(n){return 1-og.Bounce.Out(1-n)},Out:function(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},InOut:function(n){return n<.5?.5*og.Bounce.In(2*n):.5*og.Bounce.Out(2*n-1)+.5}}),generatePow:function(n){return void 0===n&&(n=4),n=(n=n<Number.EPSILON?Number.EPSILON:n)>1e4?1e4:n,{In:function(e){return Math.pow(e,n)},Out:function(e){return 1-Math.pow(1-e,n)},InOut:function(e){return e<.5?Math.pow(2*e,n)/2:(1-Math.pow(2-2*e,n))/2+.5}}}}),ag=function(){return performance.now()},lG=function(){function n(){this._tweens={},this._tweensAddedDuringUpdate={}}return n.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map(function(t){return e._tweens[t]})},n.prototype.removeAll=function(){this._tweens={}},n.prototype.add=function(e){this._tweens[e.getId()]=e,this._tweensAddedDuringUpdate[e.getId()]=e},n.prototype.remove=function(e){delete this._tweens[e.getId()],delete this._tweensAddedDuringUpdate[e.getId()]},n.prototype.update=function(e,t){void 0===e&&(e=ag()),void 0===t&&(t=!1);var i=Object.keys(this._tweens);if(0===i.length)return!1;for(;i.length>0;){this._tweensAddedDuringUpdate={};for(var r=0;r<i.length;r++){var s=this._tweens[i[r]];s&&!1===s.update(e,!t)&&!t&&delete this._tweens[i[r]]}i=Object.keys(this._tweensAddedDuringUpdate)}return!0},n}(),Rh={Linear:function(n,e){var t=n.length-1,i=t*e,r=Math.floor(i),s=Rh.Utils.Linear;return e<0?s(n[0],n[1],i):e>1?s(n[t],n[t-1],t-i):s(n[r],n[r+1>t?t:r+1],i-r)},Bezier:function(n,e){for(var t=0,i=n.length-1,r=Math.pow,s=Rh.Utils.Bernstein,o=0;o<=i;o++)t+=r(1-e,i-o)*r(e,o)*n[o]*s(i,o);return t},CatmullRom:function(n,e){var t=n.length-1,i=t*e,r=Math.floor(i),s=Rh.Utils.CatmullRom;return n[0]===n[t]?(e<0&&(r=Math.floor(i=t*(1+e))),s(n[(r-1+t)%t],n[r],n[(r+1)%t],n[(r+2)%t],i-r)):e<0?n[0]-(s(n[0],n[0],n[1],n[1],-i)-n[0]):e>1?n[t]-(s(n[t],n[t],n[t-1],n[t-1],i-t)-n[t]):s(n[r?r-1:0],n[r],n[t<r+1?t:r+1],n[t<r+2?t:r+2],i-r)},Utils:{Linear:function(n,e,t){return(e-n)*t+n},Bernstein:function(n,e){var t=Rh.Utils.Factorial;return t(n)/t(e)/t(n-e)},Factorial:(n=[1],function(e){var t=1;if(n[e])return n[e];for(var i=e;i>1;i--)t*=i;return n[e]=t,t}),CatmullRom:function(n,e,t,i,r){var s=.5*(t-n),o=.5*(i-e),a=r*r;return(2*e-2*t+s+o)*(r*a)+(-3*e+3*t-2*s-o)*a+s*r+e}}},wP=function(){function n(){}return n.nextId=function(){return n._nextId++},n._nextId=0,n}(),bP=new lG,KE=function(){function n(e,t){void 0===t&&(t=bP),this._object=e,this._group=t,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=og.Linear.None,this._interpolationFunction=Rh.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=wP.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1}return n.prototype.getId=function(){return this._id},n.prototype.isPlaying=function(){return this._isPlaying},n.prototype.isPaused=function(){return this._isPaused},n.prototype.to=function(e,t){if(void 0===t&&(t=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=t,this},n.prototype.duration=function(e){return void 0===e&&(e=1e3),this._duration=e,this},n.prototype.dynamic=function(e){return void 0===e&&(e=!1),this._isDynamic=e,this},n.prototype.start=function(e,t){if(void 0===e&&(e=ag()),void 0===t&&(t=!1),this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed)for(var i in this._reversed=!1,this._valuesStartRepeat)this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i];if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||t){if(this._propertiesAreSetUp=!0,!this._isDynamic){var r={};for(var s in this._valuesEnd)r[s]=this._valuesEnd[s];this._valuesEnd=r}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,t)}return this},n.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},n.prototype._setupProperties=function(e,t,i,r,s){for(var o in i){var a=e[o],l=Array.isArray(a),c=l?"array":typeof a,d=!l&&Array.isArray(i[o]);if("undefined"!==c&&"function"!==c){if(d){if(0===(h=i[o]).length)continue;for(var p=[a],m=0,g=h.length;m<g;m+=1){var v=this._handleRelativeValue(a,h[m]);if(isNaN(v)){d=!1,console.warn("Found invalid interpolation list. Skipping.");break}p.push(v)}d&&(i[o]=p)}if("object"!==c&&!l||!a||d)(typeof t[o]>"u"||s)&&(t[o]=a),l||(t[o]*=1),r[o]=d?i[o].slice().reverse():t[o]||0;else{t[o]=l?[]:{};var w=a;for(var y in w)t[o][y]=w[y];r[o]=l?[]:{};var h=i[o];if(!this._isDynamic){var b={};for(var y in h)b[y]=h[y];i[o]=h=b}this._setupProperties(w,t[o],h,r[o],s)}}}},n.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},n.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},n.prototype.pause=function(e){return void 0===e&&(e=ag()),this._isPaused||!this._isPlaying||(this._isPaused=!0,this._pauseStart=e,this._group&&this._group.remove(this)),this},n.prototype.resume=function(e){return void 0===e&&(e=ag()),this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this):this},n.prototype.stopChainedTweens=function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop();return this},n.prototype.group=function(e){return void 0===e&&(e=bP),this._group=e,this},n.prototype.delay=function(e){return void 0===e&&(e=0),this._delayTime=e,this},n.prototype.repeat=function(e){return void 0===e&&(e=0),this._initialRepeat=e,this._repeat=e,this},n.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},n.prototype.yoyo=function(e){return void 0===e&&(e=!1),this._yoyo=e,this},n.prototype.easing=function(e){return void 0===e&&(e=og.Linear.None),this._easingFunction=e,this},n.prototype.interpolation=function(e){return void 0===e&&(e=Rh.Linear),this._interpolationFunction=e,this},n.prototype.chain=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._chainedTweens=e,this},n.prototype.onStart=function(e){return this._onStartCallback=e,this},n.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},n.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},n.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},n.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},n.prototype.onStop=function(e){return this._onStopCallback=e,this},n.prototype.update=function(e,t){if(void 0===e&&(e=ag()),void 0===t&&(t=!0),this._isPaused)return!0;var i,r;if(!this._goToEnd&&!this._isPlaying){if(e>this._startTime+this._duration)return!1;t&&this.start(e,!0)}if(this._goToEnd=!1,e<this._startTime)return!0;!1===this._onStartCallbackFired&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),!1===this._onEveryStartCallbackFired&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0),r=(e-this._startTime)/this._duration;var o=this._easingFunction(r=0===this._duration||r>1?1:r);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,o),this._onUpdateCallback&&this._onUpdateCallback(this._object,r),1===r){if(this._repeat>0){for(i in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat)!this._yoyo&&"string"==typeof this._valuesEnd[i]&&(this._valuesStartRepeat[i]=this._valuesStartRepeat[i]+parseFloat(this._valuesEnd[i])),this._yoyo&&this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i];return this._yoyo&&(this._reversed=!this._reversed),this._startTime=void 0!==this._repeatDelayTime?e+this._repeatDelayTime:e+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var a=0,l=this._chainedTweens.length;a<l;a++)this._chainedTweens[a].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},n.prototype._updateProperties=function(e,t,i,r){for(var s in i)if(void 0!==t[s]){var o=t[s]||0,a=i[s],l=Array.isArray(e[s]),c=Array.isArray(a);!l&&c?e[s]=this._interpolationFunction(a,r):"object"==typeof a&&a?this._updateProperties(e[s],o,a,r):"number"==typeof(a=this._handleRelativeValue(o,a))&&(e[s]=o+(a-o)*r)}},n.prototype._handleRelativeValue=function(e,t){return"string"!=typeof t?t:"+"===t.charAt(0)||"-"===t.charAt(0)?e+parseFloat(t):parseFloat(t)},n.prototype._swapEndStartRepeatValues=function(e){var t=this._valuesStartRepeat[e],i=this._valuesEnd[e];this._valuesStartRepeat[e]="string"==typeof i?this._valuesStartRepeat[e]+parseFloat(i):this._valuesEnd[e],this._valuesEnd[e]=t},n}(),cl=bP,cG=(cl.getAll.bind(cl),cl.removeAll.bind(cl),cl.add.bind(cl),cl.remove.bind(cl),cl.update.bind(cl));const Ai={Handedness:Object.freeze({NONE:"none",LEFT:"left",RIGHT:"right"}),ComponentState:Object.freeze({DEFAULT:"default",TOUCHED:"touched",PRESSED:"pressed"}),ComponentProperty:Object.freeze({BUTTON:"button",X_AXIS:"xAxis",Y_AXIS:"yAxis",STATE:"state"}),ComponentType:Object.freeze({TRIGGER:"trigger",SQUEEZE:"squeeze",TOUCHPAD:"touchpad",THUMBSTICK:"thumbstick",BUTTON:"button"}),ButtonTouchThreshold:.05,AxisTouchThreshold:.1,VisualResponseProperty:Object.freeze({TRANSFORM:"transform",VISIBILITY:"visibility"})};function uG(n){return xP.apply(this,arguments)}function xP(){return xP=On(function*(n){const e=yield fetch(n);if(e.ok)return e.json();throw new Error(e.statusText)}),xP.apply(this,arguments)}function SP(){return SP=On(function*(n){if(!n)throw new Error("No basePath supplied");return yield uG(`${n}/profilesList.json`)}),SP.apply(this,arguments)}function EP(){return EP=On(function*(n,e,t=null,i=!0){if(!n)throw new Error("No xrInputSource supplied");if(!e)throw new Error("No basePath supplied");const r=yield function Nle(n){return SP.apply(this,arguments)}(e);let s;if(n.profiles.some(l=>{const c=r[l];return c&&(s={profileId:l,profilePath:`${e}/${c.path}`,deprecated:!!c.deprecated}),!!s}),!s){if(!t)throw new Error("No matching profile name found");const l=r[t];if(!l)throw new Error(`No matching profile name found and default profile "${t}" missing.`);s={profileId:t,profilePath:`${e}/${l.path}`,deprecated:!!l.deprecated}}const o=yield uG(s.profilePath);let a;if(i){let l;if(l="any"===n.handedness?o.layouts[Object.keys(o.layouts)[0]]:o.layouts[n.handedness],!l)throw new Error(`No matching handedness, ${n.handedness}, in profile ${s.profileId}`);l.assetPath&&(a=s.profilePath.replace("profile.json",l.assetPath))}return{profile:o,assetPath:a}}),EP.apply(this,arguments)}const Lle={xAxis:0,yAxis:0,button:0,state:Ai.ComponentState.DEFAULT};class kle{constructor(e){this.componentProperty=e.componentProperty,this.states=e.states,this.valueNodeName=e.valueNodeName,this.valueNodeProperty=e.valueNodeProperty,this.valueNodeProperty===Ai.VisualResponseProperty.TRANSFORM&&(this.minNodeName=e.minNodeName,this.maxNodeName=e.maxNodeName),this.value=0,this.updateFromComponent(Lle)}updateFromComponent({xAxis:e,yAxis:t,button:i,state:r}){const{normalizedXAxis:s,normalizedYAxis:o}=function Fle(n=0,e=0){let t=n,i=e;if(Math.sqrt(n*n+e*e)>1){const o=Math.atan2(e,n);t=Math.cos(o),i=Math.sin(o)}return{normalizedXAxis:.5*t+.5,normalizedYAxis:.5*i+.5}}(e,t);switch(this.componentProperty){case Ai.ComponentProperty.X_AXIS:this.value=this.states.includes(r)?s:.5;break;case Ai.ComponentProperty.Y_AXIS:this.value=this.states.includes(r)?o:.5;break;case Ai.ComponentProperty.BUTTON:this.value=this.states.includes(r)?i:0;break;case Ai.ComponentProperty.STATE:this.value=this.valueNodeProperty===Ai.VisualResponseProperty.VISIBILITY?this.states.includes(r):this.states.includes(r)?1:0;break;default:throw new Error(`Unexpected visualResponse componentProperty ${this.componentProperty}`)}}}class Ule{constructor(e,t){if(!(e&&t&&t.visualResponses&&t.gamepadIndices&&0!==Object.keys(t.gamepadIndices).length))throw new Error("Invalid arguments supplied");this.id=e,this.type=t.type,this.rootNodeName=t.rootNodeName,this.touchPointNodeName=t.touchPointNodeName,this.visualResponses={},Object.keys(t.visualResponses).forEach(i=>{const r=new kle(t.visualResponses[i]);this.visualResponses[i]=r}),this.gamepadIndices=Object.assign({},t.gamepadIndices),this.values={state:Ai.ComponentState.DEFAULT,button:void 0!==this.gamepadIndices.button?0:void 0,xAxis:void 0!==this.gamepadIndices.xAxis?0:void 0,yAxis:void 0!==this.gamepadIndices.yAxis?0:void 0}}get data(){return{id:this.id,...this.values}}updateFromGamepad(e){if(this.values.state=Ai.ComponentState.DEFAULT,void 0!==this.gamepadIndices.button&&e.buttons.length>this.gamepadIndices.button){const t=e.buttons[this.gamepadIndices.button];this.values.button=t.value,this.values.button=this.values.button<0?0:this.values.button,this.values.button=this.values.button>1?1:this.values.button,t.pressed||1===this.values.button?this.values.state=Ai.ComponentState.PRESSED:(t.touched||this.values.button>Ai.ButtonTouchThreshold)&&(this.values.state=Ai.ComponentState.TOUCHED)}void 0!==this.gamepadIndices.xAxis&&e.axes.length>this.gamepadIndices.xAxis&&(this.values.xAxis=e.axes[this.gamepadIndices.xAxis],this.values.xAxis=this.values.xAxis<-1?-1:this.values.xAxis,this.values.xAxis=this.values.xAxis>1?1:this.values.xAxis,this.values.state===Ai.ComponentState.DEFAULT&&Math.abs(this.values.xAxis)>Ai.AxisTouchThreshold&&(this.values.state=Ai.ComponentState.TOUCHED)),void 0!==this.gamepadIndices.yAxis&&e.axes.length>this.gamepadIndices.yAxis&&(this.values.yAxis=e.axes[this.gamepadIndices.yAxis],this.values.yAxis=this.values.yAxis<-1?-1:this.values.yAxis,this.values.yAxis=this.values.yAxis>1?1:this.values.yAxis,this.values.state===Ai.ComponentState.DEFAULT&&Math.abs(this.values.yAxis)>Ai.AxisTouchThreshold&&(this.values.state=Ai.ComponentState.TOUCHED)),Object.values(this.visualResponses).forEach(t=>{t.updateFromComponent(this.values)})}}class Ble{constructor(e,t,i){if(!e)throw new Error("No xrInputSource supplied");if(!t)throw new Error("No profile supplied");this.xrInputSource=e,this.assetUrl=i,this.id=t.profileId,this.layoutDescription=t.layouts[e.handedness],this.components={},Object.keys(this.layoutDescription.components).forEach(r=>{this.components[r]=new Ule(r,this.layoutDescription.components[r])}),this.updateFromGamepad()}get gripSpace(){return this.xrInputSource.gripSpace}get targetRaySpace(){return this.xrInputSource.targetRaySpace}get data(){const e=[];return Object.values(this.components).forEach(t=>{e.push(t.data)}),e}updateFromGamepad(){Object.values(this.components).forEach(e=>{e.updateFromGamepad(this.xrInputSource.gamepad)})}}class zle extends si{constructor(){super(),this.motionController=null,this.envMap=null}setEnvironmentMap(e){return this.envMap==e||(this.envMap=e,this.traverse(t=>{t.isMesh&&(t.material.envMap=this.envMap,t.material.needsUpdate=!0)})),this}updateMatrixWorld(e){super.updateMatrixWorld(e),this.motionController&&(this.motionController.updateFromGamepad(),Object.values(this.motionController.components).forEach(t=>{Object.values(t.visualResponses).forEach(i=>{const{valueNode:r,minNode:s,maxNode:o,value:a,valueNodeProperty:l}=i;r&&(l===Ai.VisualResponseProperty.VISIBILITY?r.visible=a:l===Ai.VisualResponseProperty.TRANSFORM&&(r.quaternion.slerpQuaternions(s.quaternion,o.quaternion,a),r.position.lerpVectors(s.position,o.position,a)))})}))}}function dG(n,e){(function Gle(n,e){Object.values(n.components).forEach(t=>{const{type:i,touchPointNodeName:r,visualResponses:s}=t;if(i===Ai.ComponentType.TOUCHPAD)if(t.touchPointNode=e.getObjectByName(r),t.touchPointNode){const o=new Zm(.001),a=new Mi({color:255}),l=new Me(o,a);t.touchPointNode.add(l)}else console.warn(`Could not find touch dot, ${t.touchPointNodeName}, in touchpad component ${t.id}`);Object.values(s).forEach(o=>{const{valueNodeName:a,minNodeName:l,maxNodeName:c,valueNodeProperty:d}=o;if(d===Ai.VisualResponseProperty.TRANSFORM){if(o.minNode=e.getObjectByName(l),o.maxNode=e.getObjectByName(c),!o.minNode)return void console.warn(`Could not find ${l} in the model`);if(!o.maxNode)return void console.warn(`Could not find ${c} in the model`)}o.valueNode=e.getObjectByName(a),o.valueNode||console.warn(`Could not find ${a} in the model`)})})})(n.motionController,e),n.envMap&&e.traverse(t=>{t.isMesh&&(t.material.envMap=n.envMap,t.material.needsUpdate=!0)}),n.add(e)}class Wle{constructor(e=null){this.gltfLoader=e,this.path="https://cdn.jsdelivr.net/npm/@webxr-input-profiles/assets@1.0/dist/profiles",this._assetCache={},this.gltfLoader||(this.gltfLoader=new tG)}createControllerModel(e){const t=new zle;let i=null;return e.addEventListener("connected",r=>{const s=r.data;"tracked-pointer"!==s.targetRayMode||!s.gamepad||function Ole(n,e){return EP.apply(this,arguments)}(s,this.path,"generic-trigger").then(({profile:o,assetPath:a})=>{t.motionController=new Ble(s,o,a);const l=this._assetCache[t.motionController.assetUrl];if(l)i=l.scene.clone(),dG(t,i);else{if(!this.gltfLoader)throw new Error("GLTFLoader not set.");this.gltfLoader.setPath(""),this.gltfLoader.load(t.motionController.assetUrl,c=>{this._assetCache[t.motionController.assetUrl]=c,i=c.scene.clone(),dG(t,i)},null,()=>{throw new Error(`Asset ${t.motionController.assetUrl} missing or malformed.`)})}}).catch(o=>{console.warn(o)})}),e.addEventListener("disconnected",()=>{t.motionController=null,t.remove(i),i=null}),t}}let ZE=(()=>{class n{constructor(){this.destroy$=new ss,this.takeUntilDestroy=t=>t.pipe(HB(this.destroy$))}ngOnDestroy(){console.log("UnsubscriberService","ngOnDestroy"),this.destroy$.next(),this.destroy$.complete()}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Qe({token:n,factory:n.\u0275fac})}return n})();class jle extends wE{constructor(e=null){super();const t=new di;t.deleteAttribute("uv");const i=new Jm({side:1}),r=new Jm;let s=5;null!==e&&!1===e._useLegacyLights&&(s=900);const o=new rP(16777215,s,28,2);o.position.set(.418,16.199,.3),this.add(o);const a=new Me(t,i);a.position.set(-.757,13.219,.717),a.scale.set(31.713,28.305,28.591),this.add(a);const l=new Me(t,r);l.position.set(-10.906,2.009,1.846),l.rotation.set(0,-.195,0),l.scale.set(2.328,7.905,4.651),this.add(l);const c=new Me(t,r);c.position.set(-5.607,-.754,-.758),c.rotation.set(0,.994,0),c.scale.set(1.97,1.534,3.955),this.add(c);const d=new Me(t,r);d.position.set(6.167,.857,7.803),d.rotation.set(0,.561,0),d.scale.set(3.927,6.285,3.687),this.add(d);const h=new Me(t,r);h.position.set(-2.017,.018,6.124),h.rotation.set(0,.333,0),h.scale.set(2.002,4.566,2.064),this.add(h);const p=new Me(t,r);p.position.set(2.291,-.756,-2.621),p.rotation.set(0,-.286,0),p.scale.set(1.546,1.552,1.496),this.add(p);const m=new Me(t,r);m.position.set(-2.193,-.369,-5.547),m.rotation.set(0,.516,0),m.scale.set(3.875,3.487,2.986),this.add(m);const g=new Me(t,lg(50));g.position.set(-16.116,14.37,8.208),g.scale.set(.1,2.428,2.739),this.add(g);const v=new Me(t,lg(50));v.position.set(-16.109,18.021,-8.207),v.scale.set(.1,2.425,2.751),this.add(v);const w=new Me(t,lg(17));w.position.set(14.904,12.198,-1.832),w.scale.set(.15,4.265,6.331),this.add(w);const y=new Me(t,lg(43));y.position.set(-.462,8.89,14.52),y.scale.set(4.38,5.441,.088),this.add(y);const b=new Me(t,lg(20));b.position.set(3.235,11.486,-12.541),b.scale.set(2.5,2,.1),this.add(b);const x=new Me(t,lg(100));x.position.set(0,20,0),x.scale.set(1,.1,1),this.add(x)}dispose(){const e=new Set;this.traverse(t=>{t.isMesh&&(e.add(t.geometry),e.add(t.material))});for(const t of e)t.dispose()}}function lg(n){const e=new Mi;return e.color.setScalar(n),e}class $le extends ll{constructor(e){super(e)}load(e,t,i,r){const s=this,o=new zs(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{t(s.parse(a))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}parse(e){function i(c,d,h){for(let p=0,m=c.length;p<m;p++)if(c[p]!==d.getUint8(h+p))return!1;return!0}const l=function a(c){if("string"==typeof c){const d=new Uint8Array(c.length);for(let h=0;h<c.length;h++)d[h]=255&c.charCodeAt(h);return d.buffer||d}return c}(e);return function t(c){const d=new DataView(c);if(84+50*d.getUint32(80,!0)===d.byteLength)return!0;const g=[115,111,108,105,100];for(let v=0;v<5;v++)if(i(g,d,v))return!1;return!0}(l)?function r(c){const d=new DataView(c),h=d.getUint32(80,!0);let p,m,g,w,y,b,x,E,v=!1;for(let $=0;$<70;$++)1129270351==d.getUint32($,!1)&&82==d.getUint8($+4)&&61==d.getUint8($+5)&&(v=!0,w=new Float32Array(3*h*3),y=d.getUint8($+6)/255,b=d.getUint8($+7)/255,x=d.getUint8($+8)/255,E=d.getUint8($+9)/255);const D=new Ot,L=new Float32Array(3*h*3),M=new Float32Array(3*h*3),R=new We;for(let $=0;$<h;$++){const ee=84+50*$,se=d.getFloat32(ee,!0),V=d.getFloat32(ee+4,!0),J=d.getFloat32(ee+8,!0);if(v){const G=d.getUint16(ee+48,!0);32768&G?(p=y,m=b,g=x):(p=(31&G)/31,m=(G>>5&31)/31,g=(G>>10&31)/31)}for(let G=1;G<=3;G++){const X=ee+12*G,Q=3*$*3+3*(G-1);L[Q]=d.getFloat32(X,!0),L[Q+1]=d.getFloat32(X+4,!0),L[Q+2]=d.getFloat32(X+8,!0),M[Q]=se,M[Q+1]=V,M[Q+2]=J,v&&(R.set(p,m,g).convertSRGBToLinear(),w[Q]=R.r,w[Q+1]=R.g,w[Q+2]=R.b)}}return D.setAttribute("position",new Jn(L,3)),D.setAttribute("normal",new Jn(M,3)),v&&(D.setAttribute("color",new Jn(w,3)),D.hasColors=!0,D.alpha=E),D}(l):function s(c){const d=new Ot,h=/solid([\s\S]*?)endsolid/g,p=/facet([\s\S]*?)endfacet/g,m=/solid\s(.+)/;let g=0;const v=/[\s]+([+-]?(?:\d*)(?:\.\d*)?(?:[eE][+-]?\d+)?)/.source,w=new RegExp("vertex"+v+v+v,"g"),y=new RegExp("normal"+v+v+v,"g"),b=[],x=[],E=[],C=new N;let A,D=0,L=0,M=0;for(;null!==(A=h.exec(c));){L=M;const R=A[0],$=null!==(A=m.exec(R))?A[1]:"";for(E.push($);null!==(A=p.exec(R));){let V=0,J=0;const G=A[0];for(;null!==(A=y.exec(G));)C.x=parseFloat(A[1]),C.y=parseFloat(A[2]),C.z=parseFloat(A[3]),J++;for(;null!==(A=w.exec(G));)b.push(parseFloat(A[1]),parseFloat(A[2]),parseFloat(A[3])),x.push(C.x,C.y,C.z),V++,M++;1!==J&&console.error("THREE.STLLoader: Something isn't right with the normal of face number "+g),3!==V&&console.error("THREE.STLLoader: Something isn't right with the vertices of face number "+g),g++}const ee=L,se=M-L;d.userData.groupNames=E,d.addGroup(ee,se,D),D++}return d.setAttribute("position",new Ke(b,3)),d.setAttribute("normal",new Ke(x,3)),d}(function o(c){return"string"!=typeof c?(new TextDecoder).decode(c):c}(e))}}const qle=/^[og]\s*(.+)?/,Xle=/^mtllib /,Yle=/^usemtl /,Kle=/^usemap /,hG=/\s+/,fG=new N,CP=new N,pG=new N,mG=new N,Ho=new N,JE=new We;function Zle(){const n={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(e,t){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=e,void(this.object.fromDeclaration=!1!==t);const i=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:!1!==t,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(r,s){const o=this._finalize(!1);o&&(o.inherited||o.groupCount<=0)&&this.materials.splice(o.index,1);const a={index:this.materials.length,name:r||"",mtllib:Array.isArray(s)&&s.length>0?s[s.length-1]:"",smooth:void 0!==o?o.smooth:this.smooth,groupStart:void 0!==o?o.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(l){const c={index:"number"==typeof l?l:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return c.clone=this.clone.bind(c),c}};return this.materials.push(a),a},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(r){const s=this.currentMaterial();if(s&&-1===s.groupEnd&&(s.groupEnd=this.geometry.vertices.length/3,s.groupCount=s.groupEnd-s.groupStart,s.inherited=!1),r&&this.materials.length>1)for(let o=this.materials.length-1;o>=0;o--)this.materials[o].groupCount<=0&&this.materials.splice(o,1);return r&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),s}},i&&i.name&&"function"==typeof i.clone){const r=i.clone(0);r.inherited=!0,this.object.materials.push(r)}this.objects.push(this.object)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(e,t){const i=parseInt(e,10);return 3*(i>=0?i-1:i+t/3)},parseNormalIndex:function(e,t){const i=parseInt(e,10);return 3*(i>=0?i-1:i+t/3)},parseUVIndex:function(e,t){const i=parseInt(e,10);return 2*(i>=0?i-1:i+t/2)},addVertex:function(e,t,i){const r=this.vertices,s=this.object.geometry.vertices;s.push(r[e+0],r[e+1],r[e+2]),s.push(r[t+0],r[t+1],r[t+2]),s.push(r[i+0],r[i+1],r[i+2])},addVertexPoint:function(e){const t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){const t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,i){const r=this.normals,s=this.object.geometry.normals;s.push(r[e+0],r[e+1],r[e+2]),s.push(r[t+0],r[t+1],r[t+2]),s.push(r[i+0],r[i+1],r[i+2])},addFaceNormal:function(e,t,i){const r=this.vertices,s=this.object.geometry.normals;fG.fromArray(r,e),CP.fromArray(r,t),pG.fromArray(r,i),Ho.subVectors(pG,CP),mG.subVectors(fG,CP),Ho.cross(mG),Ho.normalize(),s.push(Ho.x,Ho.y,Ho.z),s.push(Ho.x,Ho.y,Ho.z),s.push(Ho.x,Ho.y,Ho.z)},addColor:function(e,t,i){const r=this.colors,s=this.object.geometry.colors;void 0!==r[e]&&s.push(r[e+0],r[e+1],r[e+2]),void 0!==r[t]&&s.push(r[t+0],r[t+1],r[t+2]),void 0!==r[i]&&s.push(r[i+0],r[i+1],r[i+2])},addUV:function(e,t,i){const r=this.uvs,s=this.object.geometry.uvs;s.push(r[e+0],r[e+1]),s.push(r[t+0],r[t+1]),s.push(r[i+0],r[i+1])},addDefaultUV:function(){const e=this.object.geometry.uvs;e.push(0,0),e.push(0,0),e.push(0,0)},addUVLine:function(e){const t=this.uvs;this.object.geometry.uvs.push(t[e+0],t[e+1])},addFace:function(e,t,i,r,s,o,a,l,c){const d=this.vertices.length;let h=this.parseVertexIndex(e,d),p=this.parseVertexIndex(t,d),m=this.parseVertexIndex(i,d);if(this.addVertex(h,p,m),this.addColor(h,p,m),void 0!==a&&""!==a){const g=this.normals.length;h=this.parseNormalIndex(a,g),p=this.parseNormalIndex(l,g),m=this.parseNormalIndex(c,g),this.addNormal(h,p,m)}else this.addFaceNormal(h,p,m);if(void 0!==r&&""!==r){const g=this.uvs.length;h=this.parseUVIndex(r,g),p=this.parseUVIndex(s,g),m=this.parseUVIndex(o,g),this.addUV(h,p,m),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(e){this.object.geometry.type="Points";const t=this.vertices.length;for(let i=0,r=e.length;i<r;i++){const s=this.parseVertexIndex(e[i],t);this.addVertexPoint(s),this.addColor(s)}},addLineGeometry:function(e,t){this.object.geometry.type="Line";const i=this.vertices.length,r=this.uvs.length;for(let s=0,o=e.length;s<o;s++)this.addVertexLine(this.parseVertexIndex(e[s],i));for(let s=0,o=t.length;s<o;s++)this.addUVLine(this.parseUVIndex(t[s],r))}};return n.startObject("",!1),n}class Jle extends ll{constructor(e){super(e),this.materials=null}load(e,t,i,r){const s=this,o=new zs(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{t(s.parse(a))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}setMaterials(e){return this.materials=e,this}parse(e){const t=new Zle;-1!==e.indexOf("\r\n")&&(e=e.replace(/\r\n/g,"\n")),-1!==e.indexOf("\\\n")&&(e=e.replace(/\\\n/g,""));const i=e.split("\n");let r=[];for(let a=0,l=i.length;a<l;a++){const c=i[a].trimStart();if(0===c.length)continue;const d=c.charAt(0);if("#"!==d)if("v"===d){const h=c.split(hG);switch(h[0]){case"v":t.vertices.push(parseFloat(h[1]),parseFloat(h[2]),parseFloat(h[3])),h.length>=7?(JE.setRGB(parseFloat(h[4]),parseFloat(h[5]),parseFloat(h[6])).convertSRGBToLinear(),t.colors.push(JE.r,JE.g,JE.b)):t.colors.push(void 0,void 0,void 0);break;case"vn":t.normals.push(parseFloat(h[1]),parseFloat(h[2]),parseFloat(h[3]));break;case"vt":t.uvs.push(parseFloat(h[1]),parseFloat(h[2]))}}else if("f"===d){const p=c.slice(1).trim().split(hG),m=[];for(let v=0,w=p.length;v<w;v++){const y=p[v];if(y.length>0){const b=y.split("/");m.push(b)}}const g=m[0];for(let v=1,w=m.length-1;v<w;v++){const y=m[v],b=m[v+1];t.addFace(g[0],y[0],b[0],g[1],y[1],b[1],g[2],y[2],b[2])}}else if("l"===d){const h=c.substring(1).trim().split(" ");let p=[];const m=[];if(-1===c.indexOf("/"))p=h;else for(let g=0,v=h.length;g<v;g++){const w=h[g].split("/");""!==w[0]&&p.push(w[0]),""!==w[1]&&m.push(w[1])}t.addLineGeometry(p,m)}else if("p"===d){const p=c.slice(1).trim().split(" ");t.addPointGeometry(p)}else if(null!==(r=qle.exec(c))){const h=(" "+r[0].slice(1).trim()).slice(1);t.startObject(h)}else if(Yle.test(c))t.object.startMaterial(c.substring(7).trim(),t.materialLibraries);else if(Xle.test(c))t.materialLibraries.push(c.substring(7).trim());else if(Kle.test(c))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if("s"===d){if(r=c.split(" "),r.length>1){const p=r[1].trim().toLowerCase();t.object.smooth="0"!==p&&"off"!==p}else t.object.smooth=!0;const h=t.object.currentMaterial();h&&(h.smooth=t.object.smooth)}else{if("\0"===c)continue;console.warn('THREE.OBJLoader: Unexpected line: "'+c+'"')}}t.finalize();const s=new xa;if(s.materialLibraries=[].concat(t.materialLibraries),1==!(1===t.objects.length&&0===t.objects[0].geometry.vertices.length))for(let a=0,l=t.objects.length;a<l;a++){const c=t.objects[a],d=c.geometry,h=c.materials,p="Line"===d.type,m="Points"===d.type;let g=!1;if(0===d.vertices.length)continue;const v=new Ot;v.setAttribute("position",new Ke(d.vertices,3)),d.normals.length>0&&v.setAttribute("normal",new Ke(d.normals,3)),d.colors.length>0&&(g=!0,v.setAttribute("color",new Ke(d.colors,3))),!0===d.hasUVIndices&&v.setAttribute("uv",new Ke(d.uvs,2));const w=[];for(let b=0,x=h.length;b<x;b++){const E=h[b],C=E.name+"_"+E.smooth+"_"+g;let A=t.materials[C];if(null!==this.materials)if(A=this.materials.create(E.name),!p||!A||A instanceof Sr){if(m&&A&&!(A instanceof wh)){const D=new wh({size:10,sizeAttenuation:!1});xs.prototype.copy.call(D,A),D.color.copy(A.color),D.map=A.map,A=D}}else{const D=new Sr;xs.prototype.copy.call(D,A),D.color.copy(A.color),A=D}void 0===A&&(A=p?new Sr:m?new wh({size:1,sizeAttenuation:!1}):new KR,A.name=E.name,A.flatShading=!E.smooth,A.vertexColors=g,t.materials[C]=A),w.push(A)}let y;if(w.length>1){for(let b=0,x=h.length;b<x;b++){const E=h[b];v.addGroup(E.groupStart,E.groupCount,b)}y=p?new Xm(v,w):m?new Gv(v,w):new Me(v,w)}else y=p?new Xm(v,w[0]):m?new Gv(v,w[0]):new Me(v,w[0]);y.name=c.name,s.add(y)}else if(t.vertices.length>0){const a=new wh({size:1,sizeAttenuation:!1}),l=new Ot;l.setAttribute("position",new Ke(t.vertices,3)),t.colors.length>0&&void 0!==t.colors[0]&&(l.setAttribute("color",new Ke(t.colors,3)),a.vertexColors=!0);const c=new Gv(l,a);s.add(c)}return s}}class Qle extends ll{constructor(e){super(e)}load(e,t,i,r){const s=this,o=new zs(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){const l=s.parse(JSON.parse(a));t&&t(l)},i,r)}parse(e){return new ece(e)}}class ece{constructor(e){this.isFont=!0,this.type="Font",this.data=e}generateShapes(e,t=100){const i=[],r=function tce(n,e,t){const i=Array.from(n),r=e/t.resolution,s=(t.boundingBox.yMax-t.boundingBox.yMin+t.underlineThickness)*r,o=[];let a=0,l=0;for(let c=0;c<i.length;c++){const d=i[c];if("\n"===d)a=0,l-=s;else{const h=nce(d,r,a,l,t);a+=h.offsetX,o.push(h.path)}}return o}(e,t,this.data);for(let s=0,o=r.length;s<o;s++)i.push(...r[s].toShapes());return i}}function nce(n,e,t,i,r){const s=r.glyphs[n]||r.glyphs["?"];if(!s)return void console.error('THREE.Font: character "'+n+'" does not exists in font family '+r.familyName+".");const o=new $ae;let a,l,c,d,h,p,m,g;if(s.o){const v=s._cachedOutline||(s._cachedOutline=s.o.split(" "));for(let w=0,y=v.length;w<y;)switch(v[w++]){case"m":a=v[w++]*e+t,l=v[w++]*e+i,o.moveTo(a,l);break;case"l":a=v[w++]*e+t,l=v[w++]*e+i,o.lineTo(a,l);break;case"q":c=v[w++]*e+t,d=v[w++]*e+i,h=v[w++]*e+t,p=v[w++]*e+i,o.quadraticCurveTo(h,p,c,d);break;case"b":c=v[w++]*e+t,d=v[w++]*e+i,h=v[w++]*e+t,p=v[w++]*e+i,m=v[w++]*e+t,g=v[w++]*e+i,o.bezierCurveTo(h,p,m,g,c,d)}}return{offsetX:s.ha*e,path:o}}class ice extends VE{constructor(e,t={}){const i=t.font;if(void 0===i)super();else{const r=i.generateShapes(e,t.size);t.depth=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),super(r,t)}this.type="TextGeometry"}}var Fr={d:(n,e)=>{for(var t in e)Fr.o(e,t)&&!Fr.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})},o:(n,e)=>Object.prototype.hasOwnProperty.call(n,e),r:n=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})}},fo={};Fr.d(fo,{g1:()=>eC,gO:()=>o0,km:()=>QE,zV:()=>r0,ol:()=>jP,uM:()=>tC,N1:()=>zG,xv:()=>WP,PH:()=>iC,UH:()=>nC,ZP:()=>Rce,Vx:()=>GG});var QE={};Fr.r(QE),Fr.d(QE,{COLUMN:()=>rC,COLUMN_REVERSE:()=>_G,ROW:()=>t0,ROW_REVERSE:()=>gG,contentDirection:()=>yG});var eC={};Fr.r(eC),Fr.d(eC,{CENTER:()=>TP,END:()=>AP,START:()=>MP,STRETCH:()=>vG,alignItems:()=>wG,warnAboutDeprecatedAlignItems:()=>bG});var tC={};Fr.r(tC),Fr.d(tC,{CENTER:()=>IP,END:()=>RP,SPACE_AROUND:()=>PP,SPACE_BETWEEN:()=>NP,SPACE_EVENLY:()=>OP,START:()=>DP,justifyContent:()=>xG});var nC={};Fr.r(nC),Fr.d(nC,{NORMAL:()=>n0,NOWRAP:()=>cg,PRE:()=>sC,PRE_LINE:()=>ug,PRE_WRAP:()=>oC,WHITE_CHARS:()=>FP,collapseWhitespaceOnInlines:()=>MG,collapseWhitespaceOnString:()=>SG,newlineBreakability:()=>EG,shouldBreak:()=>CG});var iC={};Fr.r(iC),Fr.d(iC,{CENTER:()=>kP,JUSTIFY:()=>UP,JUSTIFY_CENTER:()=>NG,JUSTIFY_LEFT:()=>PG,JUSTIFY_RIGHT:()=>aC,LEFT:()=>IG,RIGHT:()=>RG,textAlign:()=>OG});const ln=(n=>{var e={};return Fr.d(e,n),e})({BufferAttribute:()=>Jn,BufferGeometry:()=>Ot,CanvasTexture:()=>goe,Color:()=>We,FileLoader:()=>zs,LinearFilter:()=>gi,Mesh:()=>Me,Object3D:()=>si,Plane:()=>fc,PlaneGeometry:()=>Um,ShaderMaterial:()=>hc,TextureLoader:()=>QR,Vector2:()=>fe,Vector3:()=>N}),t0="row",gG="row-reverse",rC="column",_G="column-reverse";function yG(n,e,t,i){let r=t,s="getWidth",o="x",a="y";0===e.indexOf(rC)&&(s="getHeight",o="y",a="x");for(let l=0;l<n.childrenBoxes.length;l++){const c=n.childrenBoxes[l],d=c.id,h=c[s](),p=c.margin||0;r+=p*i,n.childrenPos[d]={[o]:r+h/2*i,[a]:0},r+=i*(h+p)}}const MP="start",TP="center",AP="end",vG="stretch";function wG(n,e){const t=n.getAlignItems();-1===sce.indexOf(t)&&console.warn(`alignItems === '${t}' is not supported`);let i="getWidth",r="x";0===e.indexOf(t0)&&(i="getHeight",r="y");const s=n[i]()/2-(n.padding||0);n.childrenBoxes.forEach(o=>{let a;switch(t){case AP:case"right":case"bottom":a=0===e.indexOf(t0)?-s+o[i]()/2+(o.margin||0):s-o[i]()/2-(o.margin||0);break;case MP:case"left":case"top":a=0===e.indexOf(t0)?s-o[i]()/2-(o.margin||0):-s+o[i]()/2+(o.margin||0)}n.childrenPos[o.id][r]=a||0})}function bG(n){-1!==oce.indexOf(n)&&console.warn(`alignItems === '${n}' is deprecated and will be remove in 7.x.x. Fallback are 'start'|'end'`)}const sce=[MP,TP,AP,vG,"top","right","bottom","left"],oce=["top","right","bottom","left"],DP="start",IP="center",RP="end",PP="space-around",NP="space-between",OP="space-evenly";function xG(n,e,t,i){const r=n.getJustifyContent();-1===ace.indexOf(r)&&console.warn(`justifyContent === '${r}' is not supported`);const s=0===e.indexOf("row")?"width":"height",o=n.getChildrenSideSum(s),l=("width"===s?n.getInnerWidth():n.getInnerHeight())-o,d=function lce(n,e){switch(n){case RP:return e;case IP:return e/2}return 0}(r,2*t-o*Math.sign(t)),h=function cce(n,e,t,i){const r=Array(n.length).fill(0);if(e>0)switch(t){case NP:if(n.length>1){const s=e/(n.length-1)*i;r[0]=0;for(let o=1;o<n.length;o++)r[o]=s*o}break;case OP:if(n.length>1){const s=e/(n.length+1)*i;for(let o=0;o<n.length;o++)r[o]=s*(o+1)}break;case PP:if(n.length>1){const s=e/n.length*i,o=s/2;r[0]=o;for(let a=1;a<n.length;a++)r[a]=o+s*a}}return r}(n.childrenBoxes,l,r,i),p=0===e.indexOf("row")?"x":"y";n.childrenBoxes.forEach((m,g)=>{n.childrenPos[m.id][p]-=d-h[g]})}const ace=[DP,IP,RP,PP,NP,OP];function LP(n){return class extends n{constructor(t){super(t),this.isBoxComponent=!0,this.childrenPos={}}getInnerWidth(){const t=this.getContentDirection();switch(t){case"row":case"row-reverse":return this.width-(2*this.padding||0)||this.getChildrenSideSum("width");case"column":case"column-reverse":return this.getHighestChildSizeOn("width");default:console.error(`Invalid contentDirection : ${t}`)}}getInnerHeight(){const t=this.getContentDirection();switch(t){case"row":case"row-reverse":return this.getHighestChildSizeOn("height");case"column":case"column-reverse":return this.height-(2*this.padding||0)||this.getChildrenSideSum("height");default:console.error(`Invalid contentDirection : ${t}`)}}getChildrenSideSum(t){return this.childrenBoxes.reduce((i,r)=>{const s=2*r.margin||0;return i+("width"===t?r.getWidth()+s:r.getHeight()+s)},0)}setPosFromParentRecords(){this.parentUI&&this.parentUI.childrenPos[this.id]&&(this.position.x=this.parentUI.childrenPos[this.id].x,this.position.y=this.parentUI.childrenPos[this.id].y)}computeChildrenPosition(){if(this.children.length>0){const t=this.getContentDirection();let i;switch(t){case t0:i=-this.getInnerWidth()/2;break;case gG:i=this.getInnerWidth()/2;break;case rC:i=this.getInnerHeight()/2;break;case _G:i=-this.getInnerHeight()/2}const r=-Math.sign(i);yG(this,t,i,r),xG(this,t,i,r),wG(this,t)}}getHighestChildSizeOn(t){return this.childrenBoxes.reduce((i,r)=>{const s=r.margin||0,o="width"===t?r.getWidth()+2*s:r.getHeight()+2*s;return Math.max(i,o)},0)}getWidth(){return this.parentUI&&"stretch"===this.parentUI.getAlignItems()&&-1!==this.parentUI.getContentDirection().indexOf("column")?this.parentUI.getWidth()-(2*this.parentUI.padding||0):this.width||this.getInnerWidth()+(2*this.padding||0)}getHeight(){return this.parentUI&&"stretch"===this.parentUI.getAlignItems()&&-1!==this.parentUI.getContentDirection().indexOf("row")?this.parentUI.getHeight()-(2*this.parentUI.padding||0):this.height||this.getInnerHeight()+(2*this.padding||0)}}}const FP={"\t":"\t","\n":"\n","\r":"\r"," ":" "},n0="normal",cg="nowrap",sC="pre",ug="pre-line",oC="pre-wrap",SG=function(n,e){switch(e){case cg:case n0:n=n.replace(/\n/g," ");case ug:n=n.replace(/[ ]{2,}/g," ")}return n},EG=function(n){switch(n){case sC:case oC:case ug:return"mandatory"}},CG=function(n,e,t,i){const r=n[e];switch(i.WHITESPACE){case n0:case ug:case oC:if("mandatory"===r.lineBreak)return!0;if(t+(r.xadvance?r.xadvance:r.width)+(r.xoffset?r.xoffset:0)+(r.kerning?r.kerning:0)>i.INNER_WIDTH)return!0;const l=DG(n,e,i);return function uce(n,e,t,i){return!(!n||!n.glyph||e+t<i.INNER_WIDTH)&&i.BREAKON.indexOf(n.glyph)>-1}(n[e-1],t,l,i);case sC:return"mandatory"===r.lineBreak;default:return!1}},MG=function(n,e){const t=n[0],i=n[n.length-1];switch(e){case oC:t.glyph&&"\n"===t.glyph&&n.length>1&&AG([t],n[1]),i.glyph&&"\n"===i.glyph&&n.length>1&&TG([i],n[n.length-2]);break;case ug:case cg:case n0:let s,r=[];for(let o=0;o<n.length;o++){const a=n[o];if(!(a.glyph&&FP[a.glyph]&&n.length>o))break;r.push(a),s=n[o+1]}AG(r,s),r=[],s=null;for(let o=n.length-1;o>0;o--){const a=n[o];if(!(a.glyph&&FP[a.glyph]&&o>0))break;r.push(a),s=n[o-1]}TG(r,s);break;case sC:break;default:return console.warn(`whiteSpace: '${e}' is not valid`),0}return t.offsetX};function TG(n,e){if(e)for(let t=0;t<n.length;t++){const i=n[t];i.width=0,i.height=0,i.offsetX=e.offsetX+e.width}}function AG(n,e){if(e)for(let t=0;t<n.length;t++){const i=n[t];i.width=0,i.height=0,i.offsetX=e.offsetX}}function DG(n,e,t,i){if(i=i||0,!n[e])return i;const r=n[e],a=r.xadvance?r.xadvance:r.width;return r.lineBreak?i+a:DG(n,e+1,t,i+a+t.LETTERSPACING+(r.xoffset?r.xoffset:0)+(r.kerning?r.kerning:0))}const IG="left",RG="right",kP="center",UP="justify",PG="justify-left",aC="justify-right",NG="justify-center";function OG(n,e,t){for(let i=0;i<n.length;i++){const r=n[i],s=dce(r,e,t,i===n.length-1);for(let o=0;o<r.length;o++)r[o].offsetX+=s;r.x=s}if(0===e.indexOf(UP))for(let i=0;i<n.length;i++){const r=n[i];if(-1!==e.indexOf("-")&&i===n.length-1)return;const s=t-r.width;if(s<=0)return;let o=0;for(let d=1;d<r.length-1;d++)o+=" "===r[d].glyph?1:0;const a=s/o;let l=1;e===aC&&(r.reverse(),l=-1);let c=0;for(let d=1;d<=r.length-1;d++){const h=r[d];h.offsetX+=c*l,c+=" "===h.glyph?a:0}e===aC&&r.reverse()}}const dce=(n,e,t,i)=>{switch(e){case PG:case UP:case IG:return-t/2;case aC:case RG:return t/2-n.width;case kP:return-n.width/2;case NG:return i?-n.width/2:-t/2;default:console.warn(`textAlign: '${e}' is not valid`)}};function LG(n){return class extends n{computeInlinesPosition(){const t=this.getWidth()-(2*this.padding||0),i=this.getHeight()-(2*this.padding||0),r=this.getJustifyContent(),s=this.getTextAlign(),o=this.getInterLine(),a=this.computeLines();a.interLine=o;const l=Math.abs(a.height),c=(()=>{switch(r){case"start":return i/2;case"end":return l-i/2;case"center":return l/2;default:console.warn(`justifyContent: '${r}' is not valid`)}})();a.forEach(d=>{d.y+=c,d.forEach(h=>{h.offsetY+=c})}),OG(a,s,t),this.lines=a}calculateBestFit(t){if(0!==this.childrenInlines.length)switch(t){case"grow":this.calculateGrowFit();break;case"shrink":this.calculateShrinkFit();break;case"auto":this.calculateAutoFit()}}calculateGrowFit(){const t=this.getHeight()-(2*this.padding||0);let i=1;const s=this.childrenInlines.find(d=>d.isText);let c,o=1,a=2,l=s._fitFontSize?s._fitFontSize/s.getFontSize():1;do{if(c=this.calculateHeight(l),c>t){if(l<=o){this.childrenInlines.forEach(d=>{d.isInlineBlock||(d._fitFontSize=d.getFontSize())});break}a=l,l-=(a-o)/2}else{if(Math.abs(t-c)<.075)break;Math.abs(l-a)<5e-10&&(a*=2),o=l,l+=(a-o)/2}}while(++i<=10)}calculateShrinkFit(){const t=this.getHeight()-(2*this.padding||0);let i=1;const s=this.childrenInlines.find(d=>d.isText);let c,o=0,a=1,l=s._fitFontSize?s._fitFontSize/s.getFontSize():1;do{if(c=this.calculateHeight(l),c>t)a=l,l-=(a-o)/2;else{if(l>=a){this.childrenInlines.forEach(d=>{d.isInlineBlock||(d._fitFontSize=d.getFontSize())});break}if(Math.abs(t-c)<.075)break;o=l,l+=(a-o)/2}}while(++i<=10)}calculateAutoFit(){const t=this.getHeight()-(2*this.padding||0);let i=1;const s=this.childrenInlines.find(d=>d.isText);let c,o=0,a=2,l=s._fitFontSize?s._fitFontSize/s.getFontSize():1;do{if(c=this.calculateHeight(l),c>t)a=l,l-=(a-o)/2;else{if(Math.abs(t-c)<.075)break;Math.abs(l-a)<5e-10&&(a*=2),o=l,l+=(a-o)/2}}while(++i<=10)}computeLines(){const t=this.getWidth()-(2*this.padding||0),i=[[]];i.height=0;const r=this.getInterLine();this.childrenInlines.reduce((l,c)=>{if(!c.inlines)return;const d=c._fitFontSize||c.getFontSize(),h=c.isText?c.getLetterSpacing()*d:0,p=c.getWhiteSpace(),m=c.getBreakOn(),g={WHITESPACE:p,LETTERSPACING:h,BREAKON:m,INNER_WIDTH:t};return c.inlines.reduce((w,y,b,x)=>{const E=y.kerning?y.kerning:0,C=y.xoffset?y.xoffset:0,A=y.xadvance?y.xadvance:y.width;return CG(x,b,w,g)?(i.push([y]),y.offsetX=C,0===y.width?0:A+h):(i[i.length-1].push(y),y.offsetX=w+C+E,w+A+E+h)},l)},0);let s=0,o=0,a=-r/2;return i.forEach(l=>{if(l.lineHeight=l.reduce((d,h)=>Math.max(d,void 0!==h.lineHeight?h.lineHeight:h.height),0),l.lineBase=l.reduce((d,h)=>Math.max(d,void 0!==h.lineBase?h.lineBase:h.height),0),l.width=0,l.height=l.lineHeight,l[0]){const d=this.getWhiteSpace(),h=MG(l,d);l.forEach(p=>{p.offsetX-=h}),l.width=this.computeLineWidth(l),l.width>s&&(s=l.width),l.forEach(p=>{p.offsetY=a-p.height-p.anchor,p.lineHeight<l.lineHeight&&(p.offsetY-=l.lineBase-p.lineBase)}),l.y=a,o+=l.lineHeight+r,a-=l.lineHeight+r}}),i.height=o,i.width=s,i}calculateHeight(t){this.childrenInlines.forEach(r=>{r.isInlineBlock||(r._fitFontSize=r.getFontSize()*t,r.calculateInlines(r._fitFontSize))});const i=this.computeLines();return Math.abs(i.height)}computeLineWidth(t){const r=t[t.length-1];return r.offsetX+r.width+t[0].offsetX}}}const hce=new ln.FileLoader,BP=[],lC={},fce=new ln.TextureLoader,VP=[],cC={},es={};function HP(n){if(n._kernings)return;const e={};for(let t=0;t<n.kernings.length;t++){const i=n.kernings[t];0!==i.amount&&(e[String.fromCharCode(i.first,i.second)]=i.amount)}n._kernings=e}const r0={setFontFamily:function pce(n,e){"string"==typeof e?function gce(n,e){-1===BP.indexOf(e)&&(BP.push(e),hce.load(e,t=>{const i=JSON.parse(t);HP(i),lC[e]=i;for(const r of Object.keys(es))e===es[r].jsonURL&&es[r].component._updateFontFamily(i)})),es[n.id]||(es[n.id]={component:n}),es[n.id].jsonURL=e,lC[e]&&n._updateFontFamily(lC[e])}(n,e):(es[n.id]||(es[n.id]={component:n}),HP(e),es[n.id].json=e,n._updateFontFamily(e))},setFontTexture:function mce(n,e){-1===VP.indexOf(e)&&(VP.push(e),fce.load(e,t=>{t.generateMipmaps=!1,t.minFilter=ln.LinearFilter,t.magFilter=ln.LinearFilter,cC[e]=t;for(const i of Object.keys(es))e===es[i].textureURL&&es[i].component._updateFontTexture(t)})),es[n.id]||(es[n.id]={component:n}),es[n.id].textureURL=e,cC[e]&&n._updateFontTexture(cC[e])},getFontOf:function FG(n){const e=es[n.id];return!e&&n.parentUI?FG(n.parentUI):e},addFont:function _ce(n,e,t){t.generateMipmaps=!1,t.minFilter=ln.LinearFilter,t.magFilter=ln.LinearFilter,BP.push(n),lC[n]=e,HP(e),t&&(VP.push(n),cC[n]=t)}};let s0=(()=>{class n{static requestUpdate(t,i,r,s){t.traverse(o=>{o.isUI&&(this.requestedUpdates[o.id]?(i&&(this.requestedUpdates[o.id].updateParsing=!0),r&&(this.requestedUpdates[o.id].updateLayout=!0),s&&(this.requestedUpdates[o.id].updateInner=!0)):this.requestedUpdates[o.id]={updateParsing:i,updateLayout:r,updateInner:s,needCallback:i||r||s})})}static register(t){this.components.includes(t)||this.components.push(t)}static disposeOf(t){const i=this.components.indexOf(t);i>-1&&this.components.splice(i,1)}static update(){if(Object.keys(this.requestedUpdates).length>0){const t=this.components.filter(i=>!i.parentUI);t.forEach(i=>this.traverseParsing(i)),t.forEach(i=>this.traverseUpdates(i))}}static traverseParsing(t){const i=this.requestedUpdates[t.id];i&&i.updateParsing&&(t.parseParams(),i.updateParsing=!1),t.childrenUIs.forEach(r=>this.traverseParsing(r))}static traverseUpdates(t){const i=this.requestedUpdates[t.id];delete this.requestedUpdates[t.id],i&&i.updateLayout&&(i.updateLayout=!1,t.updateLayout()),i&&i.updateInner&&(i.updateInner=!1,t.updateInner()),t.childrenUIs.forEach(r=>{this.traverseUpdates(r)}),i&&i.needCallback&&t.onAfterUpdate()}}return n.components=[],n.requestedUpdates={},n})();const kr={container:null,fontFamily:null,fontSize:.05,fontKerning:"normal",bestFit:"none",offset:.01,interLine:.01,breakOn:"- ,.:?!\n",whiteSpace:ug,contentDirection:rC,alignItems:TP,justifyContent:DP,textAlign:kP,textType:"MSDF",fontColor:new ln.Color(16777215),fontOpacity:1,fontPXRange:4,fontSupersampling:!0,borderRadius:.01,borderWidth:0,borderColor:new ln.Color("black"),borderOpacity:1,backgroundSize:"cover",backgroundColor:new ln.Color(2236962),backgroundWhiteColor:new ln.Color(16777215),backgroundOpacity:.8,backgroundOpaqueOpacity:1,getDefaultTexture:function yce(){if(!uC){const n=document.createElement("canvas").getContext("2d");n.canvas.width=1,n.canvas.height=1,n.fillStyle="#ffffff",n.fillRect(0,0,1,1),uC=new ln.CanvasTexture(n.canvas),uC.isDefault=!0}return uC},hiddenOverflow:!1,letterSpacing:0};let uC;function dC(n){return class extends n{constructor(t){super(t),this.states={},this.currentState=void 0,this.isUI=!0,this.autoLayout=!0,this.childrenUIs=[],this.childrenBoxes=[],this.childrenTexts=[],this.childrenInlines=[],this.parentUI=null,this.addEventListener("added",this._rebuildParentUI),this.addEventListener("removed",this._rebuildParentUI)}getClippingPlanes(){const t=[];if(this.parentUI){if(this.isBlock&&this.parentUI.getHiddenOverflow()){const i=this.parentUI.getHeight()/2-(this.parentUI.padding||0),r=this.parentUI.getWidth()/2-(this.parentUI.padding||0),s=[new ln.Plane(new ln.Vector3(0,1,0),i),new ln.Plane(new ln.Vector3(0,-1,0),i),new ln.Plane(new ln.Vector3(1,0,0),r),new ln.Plane(new ln.Vector3(-1,0,0),r)];s.forEach(o=>{o.applyMatrix4(this.parent.matrixWorld)}),t.push(...s)}this.parentUI.parentUI&&t.push(...this.parentUI.getClippingPlanes())}return t}getHighestParent(){return this.parentUI?this.parent.getHighestParent():this}_getProperty(t){return void 0===this[t]&&this.parentUI?this.parent._getProperty(t):void 0!==this[t]?this[t]:kr[t]}getFontSize(){return this._getProperty("fontSize")}getFontKerning(){return this._getProperty("fontKerning")}getLetterSpacing(){return this._getProperty("letterSpacing")}getFontTexture(){return void 0===this.fontTexture&&this.parentUI?this.parent._getProperty("fontTexture"):void 0!==this.fontTexture?this.fontTexture:kr.getDefaultTexture()}getFontFamily(){return this._getProperty("fontFamily")}getBreakOn(){return this._getProperty("breakOn")}getWhiteSpace(){return this._getProperty("whiteSpace")}getTextAlign(){return this._getProperty("textAlign")}getTextType(){return this._getProperty("textType")}getFontColor(){return this._getProperty("fontColor")}getFontSupersampling(){return this._getProperty("fontSupersampling")}getFontOpacity(){return this._getProperty("fontOpacity")}getFontPXRange(){return this._getProperty("fontPXRange")}getBorderRadius(){return this._getProperty("borderRadius")}getBorderWidth(){return this._getProperty("borderWidth")}getBorderColor(){return this._getProperty("borderColor")}getBorderOpacity(){return this._getProperty("borderOpacity")}getContainer(){return!this.threeOBJ&&this.parent?this.parent.getContainer():this.threeOBJ?this:kr.container}getParentsNumber(t){return t=t||0,this.parentUI?this.parentUI.getParentsNumber(t+1):t}getBackgroundOpacity(){return this.backgroundOpacity||0===this.backgroundOpacity?this.backgroundOpacity:kr.backgroundOpacity}getBackgroundColor(){return this.backgroundColor||kr.backgroundColor}getBackgroundTexture(){return this.backgroundTexture||kr.getDefaultTexture()}getAlignContent(){return this.alignContent||kr.alignContent}getAlignItems(){return this.alignItems||kr.alignItems}getContentDirection(){return this.contentDirection||kr.contentDirection}getJustifyContent(){return this.justifyContent||kr.justifyContent}getInterLine(){return void 0===this.interLine?kr.interLine:this.interLine}getOffset(){return void 0===this.offset?kr.offset:this.offset}getBackgroundSize(){return void 0===this.backgroundSize?kr.backgroundSize:this.backgroundSize}getHiddenOverflow(){return void 0===this.hiddenOverflow?kr.hiddenOverflow:this.hiddenOverflow}getBestFit(){return void 0===this.bestFit?kr.bestFit:this.bestFit}_rebuildChildrenLists(){this.childrenUIs=this.children.filter(t=>t.isUI),this.childrenBoxes=this.children.filter(t=>t.isBoxComponent),this.childrenInlines=this.children.filter(t=>t.isInline),this.childrenTexts=this.children.filter(t=>t.isText)}_rebuildParentUI=()=>{this.parentUI=this.parent&&this.parent.isUI?this.parent:null};add(){for(const i of Object.keys(arguments))arguments[i].isInline&&this.update(null,!0);const t=super.add(...arguments);return this._rebuildChildrenLists(),t}remove(){for(const i of Object.keys(arguments))arguments[i].isInline&&this.update(null,!0);const t=super.remove(...arguments);return this._rebuildChildrenLists(),t}update(t,i,r){s0.requestUpdate(this,t,i,r)}onAfterUpdate(){}_updateFontFamily(t){this.fontFamily=t,this.traverse(i=>{i.isUI&&i.update(!0,!0,!1)}),this.getHighestParent().update(!1,!0,!1)}_updateFontTexture(t){this.fontTexture=t,this.getHighestParent().update(!1,!0,!1)}set(t){let i,r,s;if(s0.register(this),t&&JSON.stringify(t)!==JSON.stringify({})){t.alignContent&&(t.alignItems=t.alignContent,t.textAlign||(t.textAlign=t.alignContent),console.warn("`alignContent` property has been deprecated, please rely on `alignItems` and `textAlign` instead."),delete t.alignContent),t.alignItems&&bG(t.alignItems);for(const o of Object.keys(t))if(this[o]!=t[o])switch(o){case"content":case"fontSize":case"fontKerning":case"breakOn":case"whiteSpace":this.isText&&(i=!0),r=!0,this[o]=t[o];break;case"bestFit":this.isBlock&&(i=!0,r=!0),this[o]=t[o];break;case"width":case"height":case"padding":(this.isInlineBlock||this.isBlock&&"none"!=this.getBestFit())&&(i=!0),r=!0,this[o]=t[o];break;case"letterSpacing":case"interLine":this.isBlock&&"none"!=this.getBestFit()&&(i=!0),r=!0,this[o]=t[o];break;case"margin":case"contentDirection":case"justifyContent":case"alignContent":case"alignItems":case"textAlign":case"textType":r=!0,this[o]=t[o];break;case"fontColor":case"fontOpacity":case"fontSupersampling":case"offset":case"backgroundColor":case"backgroundOpacity":case"backgroundTexture":case"backgroundSize":case"borderRadius":case"borderWidth":case"borderColor":case"borderOpacity":s=!0,this[o]=t[o];break;case"hiddenOverflow":this[o]=t[o]}t.fontFamily&&r0.setFontFamily(this,t.fontFamily),t.fontTexture&&r0.setFontTexture(this,t.fontTexture),this.parentUI&&"none"!=this.parentUI.getBestFit()&&this.parentUI.update(!0,!0,!1),this.update(i,r,s),r&&this.getHighestParent().update(!1,!0,!1)}}setupState(t){this.states[t.state]={attributes:t.attributes,onSet:t.onSet}}setState(t){const i=this.states[t];i?t!==this.currentState&&(this.currentState=t,i.onSet&&i.onSet(),i.attributes&&this.set(i.attributes)):console.warn(`state "${t}" does not exist within this component:`,this.name)}clear(){this.traverse(t=>{s0.disposeOf(t),t.material&&t.material.dispose(),t.geometry&&t.geometry.dispose()})}}}function zP(n){return class extends n{constructor(t){super(t),this.textUniforms={u_texture:{value:this.getFontTexture()},u_color:{value:this.getFontColor()},u_opacity:{value:this.getFontOpacity()},u_pxRange:{value:this.getFontPXRange()},u_useRGSS:{value:this.getFontSupersampling()}},this.backgroundUniforms={u_texture:{value:this.getBackgroundTexture()},u_color:{value:this.getBackgroundColor()},u_opacity:{value:this.getBackgroundOpacity()},u_backgroundMapping:{value:this.getBackgroundSize()},u_borderWidth:{value:this.getBorderWidth()},u_borderColor:{value:this.getBorderColor()},u_borderRadiusTopLeft:{value:this.getBorderRadius()},u_borderRadiusTopRight:{value:this.getBorderRadius()},u_borderRadiusBottomRight:{value:this.getBorderRadius()},u_borderRadiusBottomLeft:{value:this.getBorderRadius()},u_borderOpacity:{value:this.getBorderOpacity()},u_size:{value:new ln.Vector2(1,1)},u_tSize:{value:new ln.Vector2(1,1)}}}updateBackgroundMaterial(){this.backgroundUniforms.u_texture.value=this.getBackgroundTexture(),this.backgroundUniforms.u_tSize.value.set(this.backgroundUniforms.u_texture.value.image.width,this.backgroundUniforms.u_texture.value.image.height),this.size&&this.backgroundUniforms.u_size.value.copy(this.size),this.backgroundUniforms.u_texture.value.isDefault?(this.backgroundUniforms.u_color.value=this.getBackgroundColor(),this.backgroundUniforms.u_opacity.value=this.getBackgroundOpacity()):(this.backgroundUniforms.u_color.value=this.backgroundColor||kr.backgroundWhiteColor,this.backgroundUniforms.u_opacity.value=this.backgroundOpacity||0===this.backgroundOpacity?this.backgroundOpacity:kr.backgroundOpaqueOpacity),this.backgroundUniforms.u_backgroundMapping.value=(()=>{switch(this.getBackgroundSize()){case"stretch":return 0;case"contain":return 1;case"cover":return 2}})();const t=this.getBorderRadius();this.backgroundUniforms.u_borderWidth.value=this.getBorderWidth(),this.backgroundUniforms.u_borderColor.value=this.getBorderColor(),this.backgroundUniforms.u_borderOpacity.value=this.getBorderOpacity(),Array.isArray(t)?(this.backgroundUniforms.u_borderRadiusTopLeft.value=t[0],this.backgroundUniforms.u_borderRadiusTopRight.value=t[1],this.backgroundUniforms.u_borderRadiusBottomRight.value=t[2],this.backgroundUniforms.u_borderRadiusBottomLeft.value=t[3]):(this.backgroundUniforms.u_borderRadiusTopLeft.value=t,this.backgroundUniforms.u_borderRadiusTopRight.value=t,this.backgroundUniforms.u_borderRadiusBottomRight.value=t,this.backgroundUniforms.u_borderRadiusBottomLeft.value=t)}updateTextMaterial(){this.textUniforms.u_texture.value=this.getFontTexture(),this.textUniforms.u_color.value=this.getFontColor(),this.textUniforms.u_opacity.value=this.getFontOpacity(),this.textUniforms.u_pxRange.value=this.getFontPXRange(),this.textUniforms.u_useRGSS.value=this.getFontSupersampling()}getBackgroundMaterial(){return(!this.backgroundMaterial||!this.backgroundUniforms)&&(this.backgroundMaterial=this._makeBackgroundMaterial()),this.backgroundMaterial}getFontMaterial(){return(!this.fontMaterial||!this.textUniforms)&&(this.fontMaterial=this._makeTextMaterial()),this.fontMaterial}_makeTextMaterial(){return new ln.ShaderMaterial({uniforms:this.textUniforms,transparent:!0,clipping:!0,vertexShader:vce,fragmentShader:wce,extensions:{derivatives:!0}})}_makeBackgroundMaterial(){return new ln.ShaderMaterial({uniforms:this.backgroundUniforms,transparent:!0,clipping:!0,vertexShader:bce,fragmentShader:xce,extensions:{derivatives:!0}})}updateClippingPlanes(t){const i=void 0!==t?t:this.getClippingPlanes();JSON.stringify(i)!==JSON.stringify(this.clippingPlanes)&&(this.clippingPlanes=i,this.fontMaterial&&(this.fontMaterial.clippingPlanes=this.clippingPlanes),this.backgroundMaterial&&(this.backgroundMaterial.clippingPlanes=this.clippingPlanes))}}}const vce="\nvarying vec2 vUv;\n\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\tvUv = uv;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\tgl_Position.z -= 0.00001;\n\n\t#include <clipping_planes_vertex>\n\n}\n",wce="\n\nuniform sampler2D u_texture;\nuniform vec3 u_color;\nuniform float u_opacity;\nuniform float u_pxRange;\nuniform bool u_useRGSS;\n\nvarying vec2 vUv;\n\n#include <clipping_planes_pars_fragment>\n\n// functions from the original msdf repo:\n// https://github.com/Chlumsky/msdfgen#using-a-multi-channel-distance-field\n\nfloat median(float r, float g, float b) {\n\treturn max(min(r, g), min(max(r, g), b));\n}\n\nfloat screenPxRange() {\n\tvec2 unitRange = vec2(u_pxRange)/vec2(textureSize(u_texture, 0));\n\tvec2 screenTexSize = vec2(1.0)/fwidth(vUv);\n\treturn max(0.5*dot(unitRange, screenTexSize), 1.0);\n}\n\nfloat tap(vec2 offsetUV) {\n\tvec3 msd = texture( u_texture, offsetUV ).rgb;\n\tfloat sd = median(msd.r, msd.g, msd.b);\n\tfloat screenPxDistance = screenPxRange() * (sd - 0.5);\n\tfloat alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\n\treturn alpha;\n}\n\nvoid main() {\n\n\tfloat alpha;\n\n\tif ( u_useRGSS ) {\n\n\t\t// shader-based supersampling based on https://bgolus.medium.com/sharper-mipmapping-using-shader-based-supersampling-ed7aadb47bec\n\t\t// per pixel partial derivatives\n\t\tvec2 dx = dFdx(vUv);\n\t\tvec2 dy = dFdy(vUv);\n\n\t\t// rotated grid uv offsets\n\t\tvec2 uvOffsets = vec2(0.125, 0.375);\n\t\tvec2 offsetUV = vec2(0.0, 0.0);\n\n\t\t// supersampled using 2x2 rotated grid\n\t\talpha = 0.0;\n\t\toffsetUV.xy = vUv + uvOffsets.x * dx + uvOffsets.y * dy;\n\t\talpha += tap(offsetUV);\n\t\toffsetUV.xy = vUv - uvOffsets.x * dx - uvOffsets.y * dy;\n\t\talpha += tap(offsetUV);\n\t\toffsetUV.xy = vUv + uvOffsets.y * dx - uvOffsets.x * dy;\n\t\talpha += tap(offsetUV);\n\t\toffsetUV.xy = vUv - uvOffsets.y * dx + uvOffsets.x * dy;\n\t\talpha += tap(offsetUV);\n\t\talpha *= 0.25;\n\n\t} else {\n\n\t\talpha = tap( vUv );\n\n\t}\n\n\n\t// apply the opacity\n\talpha *= u_opacity;\n\n\t// this is useful to avoid z-fighting when quads overlap because of kerning\n\tif ( alpha < 0.02) discard;\n\n\n\tgl_FragColor = vec4( u_color, alpha );\n\n\t#include <clipping_planes_fragment>\n\n}\n",bce="\nvarying vec2 vUv;\n\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\tvUv = uv;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\n\t#include <clipping_planes_vertex>\n\n}\n",xce="\n\nuniform sampler2D u_texture;\nuniform vec3 u_color;\nuniform float u_opacity;\n\nuniform float u_borderRadiusTopLeft;\nuniform float u_borderRadiusTopRight;\nuniform float u_borderRadiusBottomLeft;\nuniform float u_borderRadiusBottomRight;\nuniform float u_borderWidth;\nuniform vec3 u_borderColor;\nuniform float u_borderOpacity;\nuniform vec2 u_size;\nuniform vec2 u_tSize;\nuniform int u_backgroundMapping;\n\nvarying vec2 vUv;\n\n#include <clipping_planes_pars_fragment>\n\nfloat getEdgeDist() {\n\tvec2 ndc = vec2( vUv.x * 2.0 - 1.0, vUv.y * 2.0 - 1.0 );\n\tvec2 planeSpaceCoord = vec2( u_size.x * 0.5 * ndc.x, u_size.y * 0.5 * ndc.y );\n\tvec2 corner = u_size * 0.5;\n\tvec2 offsetCorner = corner - abs( planeSpaceCoord );\n\tfloat innerRadDist = min( offsetCorner.x, offsetCorner.y ) * -1.0;\n\tif (vUv.x < 0.5 && vUv.y >= 0.5) {\n\t\tfloat roundedDist = length( max( abs( planeSpaceCoord ) - u_size * 0.5 + u_borderRadiusTopLeft, 0.0 ) ) - u_borderRadiusTopLeft;\n\t\tfloat s = step( innerRadDist * -1.0, u_borderRadiusTopLeft );\n\t\treturn mix( innerRadDist, roundedDist, s );\n\t}\n\tif (vUv.x >= 0.5 && vUv.y >= 0.5) {\n\t\tfloat roundedDist = length( max( abs( planeSpaceCoord ) - u_size * 0.5 + u_borderRadiusTopRight, 0.0 ) ) - u_borderRadiusTopRight;\n\t\tfloat s = step( innerRadDist * -1.0, u_borderRadiusTopRight );\n\t\treturn mix( innerRadDist, roundedDist, s );\n\t}\n\tif (vUv.x >= 0.5 && vUv.y < 0.5) {\n\t\tfloat roundedDist = length( max( abs( planeSpaceCoord ) - u_size * 0.5 + u_borderRadiusBottomRight, 0.0 ) ) - u_borderRadiusBottomRight;\n\t\tfloat s = step( innerRadDist * -1.0, u_borderRadiusBottomRight );\n\t\treturn mix( innerRadDist, roundedDist, s );\n\t}\n\tif (vUv.x < 0.5 && vUv.y < 0.5) {\n\t\tfloat roundedDist = length( max( abs( planeSpaceCoord ) - u_size * 0.5 + u_borderRadiusBottomLeft, 0.0 ) ) - u_borderRadiusBottomLeft;\n\t\tfloat s = step( innerRadDist * -1.0, u_borderRadiusBottomLeft );\n\t\treturn mix( innerRadDist, roundedDist, s );\n\t}\n}\n\nvec4 sampleTexture() {\n\tfloat textureRatio = u_tSize.x / u_tSize.y;\n\tfloat panelRatio = u_size.x / u_size.y;\n\tvec2 uv = vUv;\n\tif ( u_backgroundMapping == 1 ) { // contain\n\t\tif ( textureRatio < panelRatio ) { // repeat on X\n\t\t\tfloat newX = uv.x * ( panelRatio / textureRatio );\n\t\t\tnewX += 0.5 - 0.5 * ( panelRatio / textureRatio );\n\t\t\tuv.x = newX;\n\t\t} else { // repeat on Y\n\t\t\tfloat newY = uv.y * ( textureRatio / panelRatio );\n\t\t\tnewY += 0.5 - 0.5 * ( textureRatio / panelRatio );\n\t\t\tuv.y = newY;\n\t\t}\n\t} else if ( u_backgroundMapping == 2 ) { // cover\n\t\tif ( textureRatio < panelRatio ) { // stretch on Y\n\t\t\tfloat newY = uv.y * ( textureRatio / panelRatio );\n\t\t\tnewY += 0.5 - 0.5 * ( textureRatio / panelRatio );\n\t\t\tuv.y = newY;\n\t\t} else { // stretch on X\n\t\t\tfloat newX = uv.x * ( panelRatio / textureRatio );\n\t\t\tnewX += 0.5 - 0.5 * ( panelRatio / textureRatio );\n\t\t\tuv.x = newX;\n\t\t}\n\t}\n\treturn texture2D( u_texture, uv ).rgba;\n}\n\nvoid main() {\n\n\tfloat edgeDist = getEdgeDist();\n\tfloat change = fwidth( edgeDist );\n\n\tvec4 textureSample = sampleTexture();\n\tvec3 blendedColor = textureSample.rgb * u_color;\n\n\tfloat alpha = smoothstep( change, 0.0, edgeDist );\n\tfloat blendedOpacity = u_opacity * textureSample.a * alpha;\n\n\tvec4 frameColor = vec4( blendedColor, blendedOpacity );\n\n\tif ( u_borderWidth <= 0.0 ) {\n\t\tgl_FragColor = frameColor;\n\t} else {\n\t\tvec4 borderColor = vec4( u_borderColor, u_borderOpacity * alpha );\n\t\tfloat stp = smoothstep( edgeDist + change, edgeDist, u_borderWidth * -1.0 );\n\t\tgl_FragColor = mix( frameColor, borderColor, stp );\n\t}\n\n\t#include <clipping_planes_fragment>\n}\n";class kG extends ln.Mesh{constructor(e){super(new ln.PlaneGeometry,e),this.castShadow=!0,this.receiveShadow=!0,this.name="MeshUI-Frame"}}let hC=null;function dg(...n){if(!hC)throw new Error("Cannot use mixins with Base null");let e=hC;hC=null;let i,t=n.length;for(;--t>=0;)i=n[t],e=i(e);return e}dg.withBase=n=>(hC=n,dg);class o0 extends(dg.withBase(ln.Object3D)(LP,LG,zP,dC)){constructor(e){super(e),this.isBlock=!0,this.size=new ln.Vector2(1,1),this.frame=new kG(this.getBackgroundMaterial()),this.frame.onBeforeRender=()=>{this.updateClippingPlanes&&this.updateClippingPlanes()},this.add(this.frame),this.set(e)}parseParams(){const e=this.getBestFit();"none"!=e&&this.childrenTexts.length?this.calculateBestFit(e):this.childrenTexts.forEach(t=>{t._fitFontSize=void 0})}updateLayout(){const e=this.getWidth(),t=this.getHeight();e&&t?(this.size.set(e,t),this.frame.scale.set(e,t,1),this.frame&&this.updateBackgroundMaterial(),this.frame.renderOrder=this.getParentsNumber(),this.autoLayout&&this.setPosFromParentRecords(),this.childrenInlines.length&&this.computeInlinesPosition(),this.computeChildrenPosition(),this.parentUI&&(this.position.z=this.getOffset())):console.warn("Block got no dimension from its parameters or from children parameters")}updateInner(){this.parentUI&&(this.position.z=this.getOffset()),this.frame&&this.updateBackgroundMaterial()}}function UG(n){return class extends n{constructor(t){super(t),this.isInline=!0}}}function BG(n){let e,t,i,r=0;for(let a=0;a<n.length;++a){const l=n[a];if(l.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(void 0===e&&(e=l.array.constructor),e!==l.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(void 0===t&&(t=l.itemSize),t!==l.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(void 0===i&&(i=l.normalized),i!==l.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;r+=l.array.length}const s=new e(r);let o=0;for(let a=0;a<n.length;++a)s.set(n[a].array,o),o+=n[a].array.length;return new ln.BufferAttribute(s,t,i)}class Ece extends ln.PlaneGeometry{constructor(e,t){const i=e.glyph,r=e.fontSize;super(e.width,e.height),null===i.match(/\s/g)?(-1===t.info.charset.indexOf(i)&&console.error(`The character '${i}' is not included in the font characters set.`),this.mapUVs(t,i),this.transformGeometry(e)):(this.nullifyUVs(),this.scale(0,0,1),this.translate(0,r/2,0))}mapUVs(e,t){const i=e.chars.find(d=>d.char===t),r=e.common,s=i.x/r.scaleW,o=(i.x+i.width)/r.scaleW,a=1-(i.y+i.height)/r.scaleH,l=1-i.y/r.scaleH,c=this.attributes.uv;for(let d=0;d<c.count;d++){let h=c.getX(d),p=c.getY(d);[h,p]=(()=>{switch(d){case 0:return[s,l];case 1:return[o,l];case 2:return[s,a];case 3:return[o,a]}})(),c.setXY(d,h,p)}}nullifyUVs(){const e=this.attributes.uv;for(let t=0;t<e.count;t++)e.setXY(t,0,0)}transformGeometry(e){this.translate(e.width/2,e.height/2,0)}}const GP={getGlyphDimensions:function Cce(n){const e=n.font,t=n.fontSize,i=n.glyph,r=t/e.info.size,s=e.chars.find(h=>h.char===i);let o=s?s.width*r:t/3,a=s?s.height*r:0;return 0===o&&(o=s?s.xadvance*r:t),0===a&&(a=.7*t),"\n"===i&&(o=0),{width:o,height:a,anchor:s?s.yoffset*r:0,xadvance:s?s.xadvance*r:o,xoffset:s?s.xoffset*r:0}},getGlyphPairKerning:function Mce(n,e){const t=n._kernings;return t[e]?t[e]:0},buildText:function Tce(){const n=[];this.inlines.forEach((i,r)=>{n[r]=new Ece(i,this.getFontFamily()),n[r].translate(i.offsetX,i.offsetY,0)});const e=function Sce(n,e=!1){const t=null!==n[0].index,i=new Set(Object.keys(n[0].attributes)),r=new Set(Object.keys(n[0].morphAttributes)),s={},o={},a=n[0].morphTargetsRelative,l=new ln.BufferGeometry;let c=0;for(let d=0;d<n.length;++d){const h=n[d];let p=0;if(t!==(null!==h.index))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const m in h.attributes){if(!i.has(m))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+'. All geometries must have compatible attributes; make sure "'+m+'" attribute exists among all geometries, or in none of them.'),null;void 0===s[m]&&(s[m]=[]),s[m].push(h.attributes[m]),p++}if(p!==i.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+". Make sure all geometries have the same number of attributes."),null;if(a!==h.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const m in h.morphAttributes){if(!r.has(m))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+".  .morphAttributes must be consistent throughout all geometries."),null;void 0===o[m]&&(o[m]=[]),o[m].push(h.morphAttributes[m])}if(l.userData.mergedUserData=l.userData.mergedUserData||[],l.userData.mergedUserData.push(h.userData),e){let m;if(t)m=h.index.count;else{if(void 0===h.attributes.position)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+". The geometry must have either an index or a position attribute"),null;m=h.attributes.position.count}l.addGroup(c,m,d),c+=m}}if(t){let d=0;const h=[];for(let p=0;p<n.length;++p){const m=n[p].index;for(let g=0;g<m.count;++g)h.push(m.getX(g)+d);d+=n[p].attributes.position.count}l.setIndex(h)}for(const d in s){const h=BG(s[d]);if(!h)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+d+" attribute."),null;l.setAttribute(d,h)}for(const d in o){const h=o[d][0].length;if(0===h)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[d]=[];for(let p=0;p<h;++p){const m=[];for(let v=0;v<o[d].length;++v)m.push(o[d][v][p]);const g=BG(m);if(!g)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+d+" morphAttribute."),null;l.morphAttributes[d].push(g)}}return l}(n);return new ln.Mesh(e,this.getFontMaterial())}};function Ace(n){return class extends n{createText(){const t=this,i=(()=>{if("MSDF"===this.getTextType())return GP.buildText.call(this);console.warn(`'${this.getTextType()}' is not a supported text type.\nSee https://github.com/felixmariotto/three-mesh-ui/wiki/Using-a-custom-text-type`)})();return i.renderOrder=1/0,i.onBeforeRender=function(){t.updateClippingPlanes&&t.updateClippingPlanes()},i}getGlyphDimensions(t){if("MSDF"===t.textType)return GP.getGlyphDimensions(t);console.warn(`'${t.textType}' is not a supported text type.\nSee https://github.com/felixmariotto/three-mesh-ui/wiki/Using-a-custom-text-type`)}getGlyphPairKerning(t,i,r){if("MSDF"===t)return GP.getGlyphPairKerning(i,r);console.warn(`'${t}' is not a supported text type.\nSee https://github.com/felixmariotto/three-mesh-ui/wiki/Using-a-custom-text-type`)}}}const Dce=function HG(n){n.children.forEach(e=>{e.children.length>0&&HG(e),n.remove(e),s0.disposeOf(e),e.material&&e.material.dispose(),e.geometry&&e.geometry.dispose()}),n.children=[]};class WP extends(dg.withBase(ln.Object3D)(UG,Ace,zP,dC)){constructor(e){super(e),this.isText=!0,this.set(e)}parseParams(){this.calculateInlines(this._fitFontSize||this.getFontSize())}updateLayout(){Dce(this),this.inlines&&(this.textContent=this.createText(),this.updateTextMaterial(),this.add(this.textContent)),this.position.z=this.getOffset()}updateInner(){this.position.z=this.getOffset(),this.textContent&&this.updateTextMaterial()}calculateInlines(e){const t=this.content,i=this.getFontFamily(),r=this.getBreakOn(),s=this.getTextType(),o=this.getWhiteSpace();if(!i||"string"==typeof i)return void(r0.getFontOf(this)||console.warn("no font was found"));if(!this.content)return void(this.inlines=null);if(!s)return void console.error("You must provide a 'textType' attribute so three-mesh-ui knows how to render your text.\n See https://github.com/felixmariotto/three-mesh-ui/wiki/Using-a-custom-text-type");const a=SG(t,o),l=Array.from?Array.from(a):String(a).split(""),c=e/i.info.size,d=i.common.lineHeight*c,h=i.common.base*c,p=l.map(m=>{const g=this.getGlyphDimensions({textType:s,glyph:m,font:i,fontSize:e});let v=null;return o!==cg&&(r.includes(m)||m.match(/\s/g))&&(v="possible"),m.match(/\n/g)&&(v=EG(o)),{height:g.height,width:g.width,anchor:g.anchor,xadvance:g.xadvance,xoffset:g.xoffset,lineBreak:v,glyph:m,fontSize:e,lineHeight:d,lineBase:h}});if("none"!==this.getFontKerning())for(let m=1;m<p.length;m++){const g=p[m],w=this.getGlyphPairKerning(s,i,p[m-1].glyph+p[m].glyph);g.kerning=w*(e/i.info.size)}this.inlines=p}}class jP extends(dg.withBase(ln.Object3D)(UG,LP,LG,zP,dC)){constructor(e){super(e),this.isInlineBlock=!0,this.size=new ln.Vector2(1,1),this.frame=new kG(this.getBackgroundMaterial()),this.frame.onBeforeRender=()=>{this.updateClippingPlanes&&this.updateClippingPlanes()},this.add(this.frame),this.set(e)}parseParams(){this.width||console.warn("inlineBlock has no width. Set to 0.3 by default"),this.height||console.warn("inlineBlock has no height. Set to 0.3 by default"),this.inlines=[{height:this.height||.3,width:this.width||.3,anchor:0,lineBreak:"possible"}]}updateLayout(){const e=this.getWidth(),t=this.getHeight();if(this.inlines){const i=this.inlines[0];this.position.set(i.width/2,i.height/2,0),this.position.x+=i.offsetX,this.position.y+=i.offsetY}this.size.set(e,t),this.frame.scale.set(e,t,1),this.frame&&this.updateBackgroundMaterial(),this.frame.renderOrder=this.getParentsNumber(),this.childrenInlines.length&&this.computeInlinesPosition(),this.computeChildrenPosition(),this.position.z=this.getOffset()}updateInner(){this.position.z=this.getOffset(),this.frame&&this.updateBackgroundMaterial()}}const Vu_fr=[[[{width:.1,chars:[{lowerCase:"a",upperCase:"A"}]},{width:.1,chars:[{lowerCase:"z",upperCase:"Z"}]},{width:.1,chars:[{lowerCase:"e",upperCase:"E"}]},{width:.1,chars:[{lowerCase:"r",upperCase:"R"}]},{width:.1,chars:[{lowerCase:"t",upperCase:"T"}]},{width:.1,chars:[{lowerCase:"y",upperCase:"Y"}]},{width:.1,chars:[{lowerCase:"u",upperCase:"U"}]},{width:.1,chars:[{lowerCase:"i",upperCase:"I"}]},{width:.1,chars:[{lowerCase:"o",upperCase:"O"}]},{width:.1,chars:[{lowerCase:"p",upperCase:"P"}]}],[{width:.1,chars:[{lowerCase:"q",upperCase:"Q"}]},{width:.1,chars:[{lowerCase:"s",upperCase:"S"}]},{width:.1,chars:[{lowerCase:"d",upperCase:"D"}]},{width:.1,chars:[{lowerCase:"f",upperCase:"F"}]},{width:.1,chars:[{lowerCase:"g",upperCase:"G"}]},{width:.1,chars:[{lowerCase:"h",upperCase:"H"}]},{width:.1,chars:[{lowerCase:"j",upperCase:"J"}]},{width:.1,chars:[{lowerCase:"k",upperCase:"K"}]},{width:.1,chars:[{lowerCase:"l",upperCase:"L"}]},{width:.1,chars:[{lowerCase:"m",upperCase:"M"}]}],[{width:.2,command:"shift",chars:[{icon:"shift"}]},{width:.1,chars:[{lowerCase:"w",upperCase:"W"}]},{width:.1,chars:[{lowerCase:"x",upperCase:"X"}]},{width:.1,chars:[{lowerCase:"c",upperCase:"C"}]},{width:.1,chars:[{lowerCase:"v",upperCase:"V"}]},{width:.1,chars:[{lowerCase:"b",upperCase:"B"}]},{width:.1,chars:[{lowerCase:"n",upperCase:"N"}]},{width:.2,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]],[[{width:.1,chars:[{lowerCase:"1"}]},{width:.1,chars:[{lowerCase:"2"}]},{width:.1,chars:[{lowerCase:"3"}]},{width:.1,chars:[{lowerCase:"4"}]},{width:.1,chars:[{lowerCase:"5"}]},{width:.1,chars:[{lowerCase:"6"}]},{width:.1,chars:[{lowerCase:"7"}]},{width:.1,chars:[{lowerCase:"8"}]},{width:.1,chars:[{lowerCase:"9"}]},{width:.1,chars:[{lowerCase:"0"}]}],[{width:.1,chars:[{lowerCase:"@"}]},{width:.1,chars:[{lowerCase:"#"}]},{width:.1,chars:[{lowerCase:"|"}]},{width:.1,chars:[{lowerCase:"_"}]},{width:.1,chars:[{lowerCase:"&"}]},{width:.1,chars:[{lowerCase:"-"}]},{width:.1,chars:[{lowerCase:"+"}]},{width:.1,chars:[{lowerCase:"("}]},{width:.1,chars:[{lowerCase:")"}]},{width:.1,chars:[{lowerCase:"/"}]}],[{width:.1,chars:[{lowerCase:"="}]},{width:.1,chars:[{lowerCase:"*"}]},{width:.1,chars:[{lowerCase:'"'}]},{width:.1,chars:[{lowerCase:"'"}]},{width:.1,chars:[{lowerCase:":"}]},{width:.1,chars:[{lowerCase:";"}]},{width:.1,chars:[{lowerCase:"!"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]]],Vu_eng=[[[{width:.1,chars:[{lowerCase:"q",upperCase:"Q"}]},{width:.1,chars:[{lowerCase:"w",upperCase:"W"}]},{width:.1,chars:[{lowerCase:"e",upperCase:"E"}]},{width:.1,chars:[{lowerCase:"r",upperCase:"R"}]},{width:.1,chars:[{lowerCase:"t",upperCase:"T"}]},{width:.1,chars:[{lowerCase:"y",upperCase:"Y"}]},{width:.1,chars:[{lowerCase:"u",upperCase:"U"}]},{width:.1,chars:[{lowerCase:"i",upperCase:"I"}]},{width:.1,chars:[{lowerCase:"o",upperCase:"O"}]},{width:.1,chars:[{lowerCase:"p",upperCase:"P"}]}],[{width:.1,chars:[{lowerCase:"a",upperCase:"A"}]},{width:.1,chars:[{lowerCase:"s",upperCase:"S"}]},{width:.1,chars:[{lowerCase:"d",upperCase:"D"}]},{width:.1,chars:[{lowerCase:"f",upperCase:"F"}]},{width:.1,chars:[{lowerCase:"g",upperCase:"G"}]},{width:.1,chars:[{lowerCase:"h",upperCase:"H"}]},{width:.1,chars:[{lowerCase:"j",upperCase:"J"}]},{width:.1,chars:[{lowerCase:"k",upperCase:"K"}]},{width:.1,chars:[{lowerCase:"l",upperCase:"L"}]}],[{width:.15,command:"shift",chars:[{icon:"shift"}]},{width:.1,chars:[{lowerCase:"z",upperCase:"Z"}]},{width:.1,chars:[{lowerCase:"x",upperCase:"X"}]},{width:.1,chars:[{lowerCase:"c",upperCase:"C"}]},{width:.1,chars:[{lowerCase:"v",upperCase:"V"}]},{width:.1,chars:[{lowerCase:"b",upperCase:"B"}]},{width:.1,chars:[{lowerCase:"n",upperCase:"N"}]},{width:.1,chars:[{lowerCase:"m",upperCase:"M"}]},{width:.15,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]],[[{width:.1,chars:[{lowerCase:"1"}]},{width:.1,chars:[{lowerCase:"2"}]},{width:.1,chars:[{lowerCase:"3"}]},{width:.1,chars:[{lowerCase:"4"}]},{width:.1,chars:[{lowerCase:"5"}]},{width:.1,chars:[{lowerCase:"6"}]},{width:.1,chars:[{lowerCase:"7"}]},{width:.1,chars:[{lowerCase:"8"}]},{width:.1,chars:[{lowerCase:"9"}]},{width:.1,chars:[{lowerCase:"0"}]}],[{width:.1,chars:[{lowerCase:"@"}]},{width:.1,chars:[{lowerCase:"#"}]},{width:.1,chars:[{lowerCase:"|"}]},{width:.1,chars:[{lowerCase:"_"}]},{width:.1,chars:[{lowerCase:"&"}]},{width:.1,chars:[{lowerCase:"-"}]},{width:.1,chars:[{lowerCase:"+"}]},{width:.1,chars:[{lowerCase:"("}]},{width:.1,chars:[{lowerCase:")"}]},{width:.1,chars:[{lowerCase:"/"}]}],[{width:.1,chars:[{lowerCase:"="}]},{width:.1,chars:[{lowerCase:"*"}]},{width:.1,chars:[{lowerCase:'"'}]},{width:.1,chars:[{lowerCase:"'"}]},{width:.1,chars:[{lowerCase:":"}]},{width:.1,chars:[{lowerCase:";"}]},{width:.1,chars:[{lowerCase:"!"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]]],Vu_ru=[[[{width:1/12,chars:[{lowerCase:"\u0439",upperCase:"\u0419"},{lowerCase:"q",upperCase:"Q"}]},{width:1/12,chars:[{lowerCase:"\u0446",upperCase:"\u0426"},{lowerCase:"w",upperCase:"W"}]},{width:1/12,chars:[{lowerCase:"\u0443",upperCase:"\u0423"},{lowerCase:"e",upperCase:"E"}]},{width:1/12,chars:[{lowerCase:"\u043a",upperCase:"\u041a"},{lowerCase:"r",upperCase:"R"}]},{width:1/12,chars:[{lowerCase:"\u0435",upperCase:"\u0415"},{lowerCase:"t",upperCase:"T"}]},{width:1/12,chars:[{lowerCase:"\u043d",upperCase:"\u041d"},{lowerCase:"y",upperCase:"Y"}]},{width:1/12,chars:[{lowerCase:"\u0433",upperCase:"\u0413"},{lowerCase:"u",upperCase:"U"}]},{width:1/12,chars:[{lowerCase:"\u0448",upperCase:"\u0428"},{lowerCase:"i",upperCase:"I"}]},{width:1/12,chars:[{lowerCase:"\u0449",upperCase:"\u0429"},{lowerCase:"o",upperCase:"O"}]},{width:1/12,chars:[{lowerCase:"\u0437",upperCase:"\u0417"},{lowerCase:"p",upperCase:"P"}]},{width:1/12,chars:[{lowerCase:"\u0445",upperCase:"\u0425"},{lowerCase:"{",upperCase:"["}]},{width:1/12,chars:[{lowerCase:"\u044a",upperCase:"\u042a"},{lowerCase:"}",upperCase:"]"}]}],[{width:1/12,chars:[{lowerCase:"\u0444",upperCase:"\u0424"},{lowerCase:"a",upperCase:"A"}]},{width:1/12,chars:[{lowerCase:"\u044b",upperCase:"\u042b"},{lowerCase:"s",upperCase:"S"}]},{width:1/12,chars:[{lowerCase:"\u0432",upperCase:"\u0412"},{lowerCase:"d",upperCase:"D"}]},{width:1/12,chars:[{lowerCase:"\u0430",upperCase:"\u0410"},{lowerCase:"f",upperCase:"F"}]},{width:1/12,chars:[{lowerCase:"\u043f",upperCase:"\u041f"},{lowerCase:"g",upperCase:"G"}]},{width:1/12,chars:[{lowerCase:"\u0440",upperCase:"\u0420"},{lowerCase:"h",upperCase:"H"}]},{width:1/12,chars:[{lowerCase:"\u043e",upperCase:"\u041e"},{lowerCase:"j",upperCase:"J"}]},{width:1/12,chars:[{lowerCase:"\u043b",upperCase:"\u041b"},{lowerCase:"k",upperCase:"K"}]},{width:1/12,chars:[{lowerCase:"\u0434",upperCase:"\u0414"},{lowerCase:"l",upperCase:"L"}]},{width:1/12,chars:[{lowerCase:"\u0436",upperCase:"\u0416"},{lowerCase:":",upperCase:";"}]},{width:1/12,chars:[{lowerCase:"\u044d",upperCase:"\u042d"},{lowerCase:'"',upperCase:"'"}]},{width:1/12,chars:[{lowerCase:"\u0451",upperCase:"\u0401"},{lowerCase:"|",upperCase:"\\"}]}],[{width:.125,command:"shift",chars:[{icon:"shift"}]},{width:1/12,chars:[{lowerCase:"\u044f",upperCase:"\u042f"},{lowerCase:"z",upperCase:"Z"}]},{width:1/12,chars:[{lowerCase:"\u0447",upperCase:"\u0427"},{lowerCase:"x",upperCase:"X"}]},{width:1/12,chars:[{lowerCase:"\u0441",upperCase:"\u0421"},{lowerCase:"c",upperCase:"C"}]},{width:1/12,chars:[{lowerCase:"\u043c",upperCase:"\u041c"},{lowerCase:"v",upperCase:"V"}]},{width:1/12,chars:[{lowerCase:"\u0438",upperCase:"\u0418"},{lowerCase:"b",upperCase:"B"}]},{width:1/12,chars:[{lowerCase:"\u0442",upperCase:"\u0422"},{lowerCase:"n",upperCase:"N"}]},{width:1/12,chars:[{lowerCase:"\u044c",upperCase:"\u042c"},{lowerCase:"m",upperCase:"M"}]},{width:1/12,chars:[{lowerCase:"\u0431",upperCase:"\u0411"},{lowerCase:",",upperCase:""}]},{width:1/12,chars:[{lowerCase:"\u044e",upperCase:"\u042e"},{lowerCase:".",upperCase:""}]},{width:.125,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.15,command:"switch-set",chars:[{lowerCase:"eng"}]},{width:.15,command:"switch",chars:[{lowerCase:".?12"}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]],[[{width:.1,chars:[{lowerCase:"1"}]},{width:.1,chars:[{lowerCase:"2"}]},{width:.1,chars:[{lowerCase:"3"}]},{width:.1,chars:[{lowerCase:"4"}]},{width:.1,chars:[{lowerCase:"5"}]},{width:.1,chars:[{lowerCase:"6"}]},{width:.1,chars:[{lowerCase:"7"}]},{width:.1,chars:[{lowerCase:"8"}]},{width:.1,chars:[{lowerCase:"9"}]},{width:.1,chars:[{lowerCase:"0"}]}],[{width:.1,chars:[{lowerCase:"@"}]},{width:.1,chars:[{lowerCase:"#"}]},{width:.1,chars:[{lowerCase:"|"}]},{width:.1,chars:[{lowerCase:"_"}]},{width:.1,chars:[{lowerCase:"&"}]},{width:.1,chars:[{lowerCase:"-"}]},{width:.1,chars:[{lowerCase:"+"}]},{width:.1,chars:[{lowerCase:"("}]},{width:.1,chars:[{lowerCase:")"}]},{width:.1,chars:[{lowerCase:"/"}]}],[{width:.1,chars:[{lowerCase:"="}]},{width:.1,chars:[{lowerCase:"*"}]},{width:.1,chars:[{lowerCase:'"'}]},{width:.1,chars:[{lowerCase:"'"}]},{width:.1,chars:[{lowerCase:":"}]},{width:.1,chars:[{lowerCase:";"}]},{width:.1,chars:[{lowerCase:"!"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.3,command:"switch",chars:[{lowerCase:"\u0410\u0411\u0412"}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]]],Vu_de=[[[{width:1/11,chars:[{lowerCase:"q",upperCase:"Q"}]},{width:1/11,chars:[{lowerCase:"w",upperCase:"W"}]},{width:1/11,chars:[{lowerCase:"e",upperCase:"E"}]},{width:1/11,chars:[{lowerCase:"r",upperCase:"R"}]},{width:1/11,chars:[{lowerCase:"t",upperCase:"T"}]},{width:1/11,chars:[{lowerCase:"z",upperCase:"Z"}]},{width:1/11,chars:[{lowerCase:"u",upperCase:"U"}]},{width:1/11,chars:[{lowerCase:"i",upperCase:"I"}]},{width:1/11,chars:[{lowerCase:"o",upperCase:"O"}]},{width:1/11,chars:[{lowerCase:"p",upperCase:"P"}]},{width:1/11,chars:[{lowerCase:"\xfc",upperCase:"\xdc"}]}],[{width:1/11,chars:[{lowerCase:"a",upperCase:"A"}]},{width:1/11,chars:[{lowerCase:"s",upperCase:"S"}]},{width:1/11,chars:[{lowerCase:"d",upperCase:"D"}]},{width:1/11,chars:[{lowerCase:"f",upperCase:"F"}]},{width:1/11,chars:[{lowerCase:"g",upperCase:"G"}]},{width:1/11,chars:[{lowerCase:"h",upperCase:"H"}]},{width:1/11,chars:[{lowerCase:"j",upperCase:"J"}]},{width:1/11,chars:[{lowerCase:"k",upperCase:"K"}]},{width:1/11,chars:[{lowerCase:"l",upperCase:"L"}]},{width:1/11,chars:[{lowerCase:"\xf6",upperCase:"\xd6"}]},{width:1/11,chars:[{lowerCase:"\xe4",upperCase:"\xc4"}]}],[{width:2/11,command:"shift",chars:[{icon:"shift"}]},{width:1/11,chars:[{lowerCase:"y",upperCase:"Y"}]},{width:1/11,chars:[{lowerCase:"x",upperCase:"X"}]},{width:1/11,chars:[{lowerCase:"c",upperCase:"C"}]},{width:1/11,chars:[{lowerCase:"v",upperCase:"V"}]},{width:1/11,chars:[{lowerCase:"b",upperCase:"B"}]},{width:1/11,chars:[{lowerCase:"n",upperCase:"N"}]},{width:1/11,chars:[{lowerCase:"m",upperCase:"M"}]},{width:2/11,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]],[[{width:.1,chars:[{lowerCase:"1"}]},{width:.1,chars:[{lowerCase:"2"}]},{width:.1,chars:[{lowerCase:"3"}]},{width:.1,chars:[{lowerCase:"4"}]},{width:.1,chars:[{lowerCase:"5"}]},{width:.1,chars:[{lowerCase:"6"}]},{width:.1,chars:[{lowerCase:"7"}]},{width:.1,chars:[{lowerCase:"8"}]},{width:.1,chars:[{lowerCase:"9"}]},{width:.1,chars:[{lowerCase:"0"}]}],[{width:.1,chars:[{lowerCase:"@"}]},{width:.1,chars:[{lowerCase:"#"}]},{width:.1,chars:[{lowerCase:"|"}]},{width:.1,chars:[{lowerCase:"_"}]},{width:.1,chars:[{lowerCase:"&"}]},{width:.1,chars:[{lowerCase:"-"}]},{width:.1,chars:[{lowerCase:"+"}]},{width:.1,chars:[{lowerCase:"("}]},{width:.1,chars:[{lowerCase:")"}]},{width:.1,chars:[{lowerCase:"/"}]}],[{width:.1,chars:[{lowerCase:"="}]},{width:.1,chars:[{lowerCase:"*"}]},{width:.1,chars:[{lowerCase:'"'}]},{width:.1,chars:[{lowerCase:"'"}]},{width:.1,chars:[{lowerCase:":"}]},{width:.1,chars:[{lowerCase:";"}]},{width:.1,chars:[{lowerCase:"!"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]]],Vu_es=[[[{width:.1,chars:[{lowerCase:"q",upperCase:"Q"}]},{width:.1,chars:[{lowerCase:"w",upperCase:"W"}]},{width:.1,chars:[{lowerCase:"e",upperCase:"E"}]},{width:.1,chars:[{lowerCase:"r",upperCase:"R"}]},{width:.1,chars:[{lowerCase:"t",upperCase:"T"}]},{width:.1,chars:[{lowerCase:"y",upperCase:"Y"}]},{width:.1,chars:[{lowerCase:"u",upperCase:"U"}]},{width:.1,chars:[{lowerCase:"i",upperCase:"I"}]},{width:.1,chars:[{lowerCase:"o",upperCase:"O"}]},{width:.1,chars:[{lowerCase:"p",upperCase:"P"}]}],[{width:.1,chars:[{lowerCase:"a",upperCase:"A"}]},{width:.1,chars:[{lowerCase:"s",upperCase:"S"}]},{width:.1,chars:[{lowerCase:"d",upperCase:"D"}]},{width:.1,chars:[{lowerCase:"f",upperCase:"F"}]},{width:.1,chars:[{lowerCase:"g",upperCase:"G"}]},{width:.1,chars:[{lowerCase:"h",upperCase:"H"}]},{width:.1,chars:[{lowerCase:"j",upperCase:"J"}]},{width:.1,chars:[{lowerCase:"k",upperCase:"K"}]},{width:.1,chars:[{lowerCase:"l",upperCase:"L"}]},{width:.1,chars:[{lowerCase:"\xf1",upperCase:"\xd1"}]}],[{width:.15,command:"shift",chars:[{icon:"shift"}]},{width:.1,chars:[{lowerCase:"z",upperCase:"Z"}]},{width:.1,chars:[{lowerCase:"x",upperCase:"X"}]},{width:.1,chars:[{lowerCase:"c",upperCase:"C"}]},{width:.1,chars:[{lowerCase:"v",upperCase:"V"}]},{width:.1,chars:[{lowerCase:"b",upperCase:"B"}]},{width:.1,chars:[{lowerCase:"n",upperCase:"N"}]},{width:.1,chars:[{lowerCase:"m",upperCase:"M"}]},{width:.15,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]],[[{width:.1,chars:[{lowerCase:"1"}]},{width:.1,chars:[{lowerCase:"2"}]},{width:.1,chars:[{lowerCase:"3"}]},{width:.1,chars:[{lowerCase:"4"}]},{width:.1,chars:[{lowerCase:"5"}]},{width:.1,chars:[{lowerCase:"6"}]},{width:.1,chars:[{lowerCase:"7"}]},{width:.1,chars:[{lowerCase:"8"}]},{width:.1,chars:[{lowerCase:"9"}]},{width:.1,chars:[{lowerCase:"0"}]}],[{width:.1,chars:[{lowerCase:"@"}]},{width:.1,chars:[{lowerCase:"#"}]},{width:.1,chars:[{lowerCase:"|"}]},{width:.1,chars:[{lowerCase:"_"}]},{width:.1,chars:[{lowerCase:"&"}]},{width:.1,chars:[{lowerCase:"-"}]},{width:.1,chars:[{lowerCase:"+"}]},{width:.1,chars:[{lowerCase:"("}]},{width:.1,chars:[{lowerCase:")"}]},{width:.1,chars:[{lowerCase:"/"}]}],[{width:.1,chars:[{lowerCase:"="}]},{width:.1,chars:[{lowerCase:"*"}]},{width:.1,chars:[{lowerCase:'"'}]},{width:.1,chars:[{lowerCase:"'"}]},{width:.1,chars:[{lowerCase:":"}]},{width:.1,chars:[{lowerCase:";"}]},{width:.1,chars:[{lowerCase:"!"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]]],Vu_el=[[[{width:.1,chars:[{lowerCase:";",upperCase:":"},{lowerCase:"q",upperCase:"Q"}]},{width:.1,chars:[{lowerCase:"\u03c2",upperCase:"\u03c2"},{lowerCase:"w",upperCase:"W"}]},{width:.1,chars:[{lowerCase:"\u03b5",upperCase:"\u0395"},{lowerCase:"e",upperCase:"E"}]},{width:.1,chars:[{lowerCase:"\u03c1",upperCase:"\u03a1"},{lowerCase:"r",upperCase:"R"}]},{width:.1,chars:[{lowerCase:"\u03c4",upperCase:"\u03a4"},{lowerCase:"t",upperCase:"T"}]},{width:.1,chars:[{lowerCase:"\u03c5",upperCase:"\u03a5"},{lowerCase:"y",upperCase:"Y"}]},{width:.1,chars:[{lowerCase:"\u03b8",upperCase:"\u0398"},{lowerCase:"u",upperCase:"U"}]},{width:.1,chars:[{lowerCase:"\u03b9",upperCase:"\u0399"},{lowerCase:"i",upperCase:"I"}]},{width:.1,chars:[{lowerCase:"\u03bf",upperCase:"\u039f"},{lowerCase:"o",upperCase:"O"}]},{width:.1,chars:[{lowerCase:"\u03c0",upperCase:"\u03a0"},{lowerCase:"p",upperCase:"P"}]}],[{width:.1,chars:[{lowerCase:"\u03b1",upperCase:"\u0391"},{lowerCase:"a",upperCase:"A"}]},{width:.1,chars:[{lowerCase:"\u03c3",upperCase:"\u03a3"},{lowerCase:"s",upperCase:"S"}]},{width:.1,chars:[{lowerCase:"\u03b4",upperCase:"\u0394"},{lowerCase:"d",upperCase:"D"}]},{width:.1,chars:[{lowerCase:"\u03c6",upperCase:"\u03a6"},{lowerCase:"f",upperCase:"F"}]},{width:.1,chars:[{lowerCase:"\u03b3",upperCase:"\u0393"},{lowerCase:"g",upperCase:"G"}]},{width:.1,chars:[{lowerCase:"\u03b7",upperCase:"\u0397"},{lowerCase:"h",upperCase:"H"}]},{width:.1,chars:[{lowerCase:"\u03be",upperCase:"\u039e"},{lowerCase:"j",upperCase:"J"}]},{width:.1,chars:[{lowerCase:"\u03ba",upperCase:"\u039a"},{lowerCase:"k",upperCase:"K"}]},{width:.1,chars:[{lowerCase:"\u03bb",upperCase:"\u039b"},{lowerCase:"l",upperCase:"L"}]}],[{width:.15,command:"shift",chars:[{icon:"shift"}]},{width:.1,chars:[{lowerCase:"\u03b6",upperCase:"\u0396"},{lowerCase:"z",upperCase:"Z"}]},{width:.1,chars:[{lowerCase:"\u03c7",upperCase:"\u03a7"},{lowerCase:"x",upperCase:"X"}]},{width:.1,chars:[{lowerCase:"\u03c8",upperCase:"\u03a8"},{lowerCase:"c",upperCase:"C"}]},{width:.1,chars:[{lowerCase:"\u03c9",upperCase:"\u03a9"},{lowerCase:"v",upperCase:"V"}]},{width:.1,chars:[{lowerCase:"\u03b2",upperCase:"\u0392"},{lowerCase:"b",upperCase:"B"}]},{width:.1,chars:[{lowerCase:"\u03bd",upperCase:"\u039d"},{lowerCase:"n",upperCase:"N"}]},{width:.1,chars:[{lowerCase:"\u03bc",upperCase:"\u039c"},{lowerCase:"m",upperCase:"M"}]},{width:.15,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.15,command:"switch-set",chars:[{lowerCase:"eng"}]},{width:.15,command:"switch",chars:[{lowerCase:".?12"}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]],[[{width:.1,chars:[{lowerCase:"1"}]},{width:.1,chars:[{lowerCase:"2"}]},{width:.1,chars:[{lowerCase:"3"}]},{width:.1,chars:[{lowerCase:"4"}]},{width:.1,chars:[{lowerCase:"5"}]},{width:.1,chars:[{lowerCase:"6"}]},{width:.1,chars:[{lowerCase:"7"}]},{width:.1,chars:[{lowerCase:"8"}]},{width:.1,chars:[{lowerCase:"9"}]},{width:.1,chars:[{lowerCase:"0"}]}],[{width:.1,chars:[{lowerCase:"@"}]},{width:.1,chars:[{lowerCase:"#"}]},{width:.1,chars:[{lowerCase:"|"}]},{width:.1,chars:[{lowerCase:"_"}]},{width:.1,chars:[{lowerCase:"&"}]},{width:.1,chars:[{lowerCase:"-"}]},{width:.1,chars:[{lowerCase:"+"}]},{width:.1,chars:[{lowerCase:"("}]},{width:.1,chars:[{lowerCase:")"}]},{width:.1,chars:[{lowerCase:"/"}]}],[{width:.1,chars:[{lowerCase:"="}]},{width:.1,chars:[{lowerCase:"*"}]},{width:.1,chars:[{lowerCase:'"'}]},{width:.1,chars:[{lowerCase:"'"}]},{width:.1,chars:[{lowerCase:":"}]},{width:.1,chars:[{lowerCase:";"}]},{width:.1,chars:[{lowerCase:"!"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]]],Vu_nord=[[[{width:1/11,chars:[{lowerCase:"q",upperCase:"Q"}]},{width:1/11,chars:[{lowerCase:"w",upperCase:"W"}]},{width:1/11,chars:[{lowerCase:"e",upperCase:"E"}]},{width:1/11,chars:[{lowerCase:"r",upperCase:"R"}]},{width:1/11,chars:[{lowerCase:"t",upperCase:"T"}]},{width:1/11,chars:[{lowerCase:"y",upperCase:"Y"}]},{width:1/11,chars:[{lowerCase:"u",upperCase:"U"}]},{width:1/11,chars:[{lowerCase:"i",upperCase:"I"}]},{width:1/11,chars:[{lowerCase:"o",upperCase:"O"}]},{width:1/11,chars:[{lowerCase:"p",upperCase:"P"}]},{width:1/11,chars:[{lowerCase:"\xe5",upperCase:"\xc5"}]}],[{width:1/11,chars:[{lowerCase:"a",upperCase:"A"}]},{width:1/11,chars:[{lowerCase:"s",upperCase:"S"}]},{width:1/11,chars:[{lowerCase:"d",upperCase:"D"}]},{width:1/11,chars:[{lowerCase:"f",upperCase:"F"}]},{width:1/11,chars:[{lowerCase:"g",upperCase:"G"}]},{width:1/11,chars:[{lowerCase:"h",upperCase:"H"}]},{width:1/11,chars:[{lowerCase:"j",upperCase:"J"}]},{width:1/11,chars:[{lowerCase:"k",upperCase:"K"}]},{width:1/11,chars:[{lowerCase:"l",upperCase:"L"}]},{width:1/11,chars:[{lowerCase:"\xe6",upperCase:"\xc6"}]},{width:1/11,chars:[{lowerCase:"\xf8",upperCase:"\xd8"}]}],[{width:2/11,command:"shift",chars:[{icon:"shift"}]},{width:1/11,chars:[{lowerCase:"z",upperCase:"Z"}]},{width:1/11,chars:[{lowerCase:"x",upperCase:"X"}]},{width:1/11,chars:[{lowerCase:"c",upperCase:"C"}]},{width:1/11,chars:[{lowerCase:"v",upperCase:"V"}]},{width:1/11,chars:[{lowerCase:"b",upperCase:"B"}]},{width:1/11,chars:[{lowerCase:"n",upperCase:"N"}]},{width:1/11,chars:[{lowerCase:"m",upperCase:"M"}]},{width:2/11,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]],[[{width:.1,chars:[{lowerCase:"1"}]},{width:.1,chars:[{lowerCase:"2"}]},{width:.1,chars:[{lowerCase:"3"}]},{width:.1,chars:[{lowerCase:"4"}]},{width:.1,chars:[{lowerCase:"5"}]},{width:.1,chars:[{lowerCase:"6"}]},{width:.1,chars:[{lowerCase:"7"}]},{width:.1,chars:[{lowerCase:"8"}]},{width:.1,chars:[{lowerCase:"9"}]},{width:.1,chars:[{lowerCase:"0"}]}],[{width:.1,chars:[{lowerCase:"@"}]},{width:.1,chars:[{lowerCase:"#"}]},{width:.1,chars:[{lowerCase:"|"}]},{width:.1,chars:[{lowerCase:"_"}]},{width:.1,chars:[{lowerCase:"&"}]},{width:.1,chars:[{lowerCase:"-"}]},{width:.1,chars:[{lowerCase:"+"}]},{width:.1,chars:[{lowerCase:"("}]},{width:.1,chars:[{lowerCase:")"}]},{width:.1,chars:[{lowerCase:"/"}]}],[{width:.1,chars:[{lowerCase:"="}]},{width:.1,chars:[{lowerCase:"*"}]},{width:.1,chars:[{lowerCase:'"'}]},{width:.1,chars:[{lowerCase:"'"}]},{width:.1,chars:[{lowerCase:":"}]},{width:.1,chars:[{lowerCase:";"}]},{width:.1,chars:[{lowerCase:"!"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]]],Ice=new ln.TextureLoader;class zG extends(dg.withBase(ln.Object3D)(LP,dC)){constructor(e){let t;if(e||(e={}),e.width||(e.width=1),e.height||(e.height=.4),e.margin||(e.margin=.003),e.padding||(e.padding=.01),super(e),this.currentPanel=0,this.isLowerCase=!0,this.charsetCount=1,e.language||navigator.language)switch(e.language||navigator.language){case"fr":case"fr-CH":case"fr-CA":t=Vu_fr;break;case"ru":this.charsetCount=2,t=Vu_ru;break;case"de":case"de-DE":case"de-AT":case"de-LI":case"de-CH":t=Vu_de;break;case"es":case"es-419":case"es-AR":case"es-CL":case"es-CO":case"es-ES":case"es-CR":case"es-US":case"es-HN":case"es-MX":case"es-PE":case"es-UY":case"es-VE":t=Vu_es;break;case"el":this.charsetCount=2,t=Vu_el;break;case"nord":t=Vu_nord;break;default:t=Vu_eng}else t=Vu_eng;this.keys=[],this.panels=t.map(i=>{const r=e.height/i.length-2*e.margin,s=new o0({width:e.width+2*e.padding,height:e.height+2*e.padding,offset:0,padding:e.padding,fontFamily:e.fontFamily,fontTexture:e.fontTexture,backgroundColor:e.backgroundColor,backgroundOpacity:e.backgroundOpacity});return s.charset=0,s.add(...i.map(o=>{const a=new o0({width:e.width,height:r,margin:e.margin,contentDirection:"row",justifyContent:"center"});a.frame.visible=!1;const l=[];return o.forEach(c=>{const d=new o0({width:e.width*c.width-2*e.margin,height:r,margin:e.margin,justifyContent:"center",offset:0}),h=c.chars[s.charset].lowerCase||c.chars[s.charset].icon||"undif";if("enter"===h&&e.enterTexture||"shift"===h&&e.shiftTexture||"backspace"===h&&e.backspaceTexture){const p=(()=>{switch(h){case"backspace":return e.backspaceTexture;case"enter":return e.enterTexture;case"shift":return e.shiftTexture;default:console.warn("There is no icon image for this key")}})();Ice.load(p,m=>{d.add(new jP({width:.65*d.width,height:.65*d.height,backgroundSize:"contain",backgroundTexture:m}))})}else d.add(new WP({content:h,offset:0}));d.type="Key",d.info=c,d.info.input=h,d.panel=s,l.push(d),this.keys.push(d)}),a.add(...l),a})),s}),this.add(this.panels[0]),this.set(e)}setNextPanel(){this.panels.forEach(e=>{this.remove(e)}),this.currentPanel=(this.currentPanel+1)%this.panels.length,this.add(this.panels[this.currentPanel]),this.update(!0,!0,!0)}setNextCharset(){this.panels[this.currentPanel].charset=(this.panels[this.currentPanel].charset+1)%this.charsetCount,this.keys.forEach(e=>{if(!this.panels[this.currentPanel].getObjectById(e.id))return;const i=e.info.chars[e.panel.charset]||e.info.chars[0],r=this.isLowerCase||!i.upperCase?i.lowerCase:i.upperCase;if(!e.childrenTexts.length)return;const s=e.childrenTexts[0];e.info.input=r,s.set({content:r}),s.update(!0,!0,!0)})}toggleCase(){this.isLowerCase=!this.isLowerCase,this.keys.forEach(e=>{const t=e.info.chars[e.panel.charset]||e.info.chars[0],i=this.isLowerCase||!t.upperCase?t.lowerCase:t.upperCase;if(!e.childrenTexts.length)return;const r=e.childrenTexts[0];e.info.input=i,r.set({content:i}),r.update(!0,!0,!0)})}parseParams(){}updateLayout(){}updateInner(){}}const GG=()=>s0.update(),WG={Block:o0,Text:WP,InlineBlock:jP,Keyboard:zG,FontLibrary:r0,update:GG,TextAlign:iC,Whitespace:nC,JustifyContent:tC,AlignItems:eC,ContentDirection:QE};typeof global<"u"&&(global.ThreeMeshUI=WG);const Rce=WG;var Pce=fo.gO,Nce=fo.xv,Oce=fo.Vx;class jG{constructor(e,t){this.wasIntersected=!1,this.target=e,this.name=t,this.intersected=!1,this.distance=0,this.point=new N(0,0)}}class Gs{constructor(e,t=null){this.coords=new fe(0,0),this.distance=0,this.intersected=!1,this.point=new N,this.cancelBubble=!1,this.type=e,this.originalEvent=t}stopPropagation(){this.cancelBubble=!0}}class Lce{constructor(e,t,i,r){this.dispose=()=>{this.domElement.removeEventListener("click",this.onMouseClick),this.supportsPointerEvents&&(this.bindEventsOnBodyElement?this.domElement.ownerDocument.removeEventListener("pointermove",this.onDocumentPointerMove):this.domElement.removeEventListener("pointermove",this.onDocumentPointerMove),this.domElement.removeEventListener("pointerdown",this.onPointerDown),this.domElement.removeEventListener("pointerup",this.onPointerUp)),this.bindEventsOnBodyElement?this.domElement.ownerDocument.removeEventListener("mousemove",this.onDocumentMouseMove):this.domElement.removeEventListener("mousemove",this.onDocumentMouseMove),this.domElement.removeEventListener("mousedown",this.onMouseDown),this.domElement.removeEventListener("mouseup",this.onMouseUp),this.domElement.removeEventListener("touchstart",this.onTouchStart),this.domElement.removeEventListener("touchmove",this.onTouchMove),this.domElement.removeEventListener("touchend",this.onTouchEnd)},this.add=(s,o=[])=>{if(s&&!this.interactiveObjects.find(a=>a.target===s))if(o.length>0)o.forEach(a=>{const l=s.getObjectByName(a);if(l){const c=new jG(l,a);this.interactiveObjects.push(c)}});else{const a=new jG(s,s.name);this.interactiveObjects.push(a)}},this.remove=(s,o=[])=>{s&&(o.length>0?o.forEach(a=>{const l=s.getObjectByName(a);l&&(this.interactiveObjects=this.interactiveObjects.filter(c=>c.target!==l))}):this.interactiveObjects=this.interactiveObjects.filter(a=>a.target!==s))},this.update=()=>{this.raycaster.setFromCamera(this.mouse,this.camera),this.interactiveObjects.forEach(l=>{l.target&&this.checkIntersection(l)}),this.interactiveObjects.sort(function(l,c){return l.distance-c.distance});const s=this.interactiveObjects.find(l=>l.intersected)??null;if(s!=this.closestObject){if(this.closestObject){const l=new Gs("mouseout");this.dispatch(this.closestObject,l)}if(s){const l=new Gs("mouseover");this.dispatch(s,l)}this.closestObject=s}let o,a;this.interactiveObjects.forEach(l=>{!l.intersected&&l.wasIntersected&&(o||(o=new Gs("mouseleave")),this.dispatch(l,o))}),this.interactiveObjects.forEach(l=>{l.intersected&&!l.wasIntersected&&(a||(a=new Gs("mouseenter")),this.dispatch(l,a))})},this.checkIntersection=s=>{const o=this.raycaster.intersectObjects([s.target],!0);if(s.wasIntersected=s.intersected,o.length>0){let a=o[0].distance;o.forEach(l=>{l.distance<a&&(a=l.distance)}),s.point=o[0].point,s.intersected=!0,s.distance=a}else s.intersected=!1},this.onDocumentMouseMove=s=>{this.mapPositionToPoint(this.mouse,s.clientX,s.clientY);const o=new Gs("mousemove",s);this.interactiveObjects.forEach(a=>{this.dispatch(a,o)})},this.onDocumentPointerMove=s=>{this.mapPositionToPoint(this.mouse,s.clientX,s.clientY);const o=new Gs("pointermove",s);this.interactiveObjects.forEach(a=>{this.dispatch(a,o)})},this.onTouchMove=s=>{s.touches.length>0&&this.mapPositionToPoint(this.mouse,s.touches[0].clientX,s.touches[0].clientY);const o=new Gs(this.treatTouchEventsAsMouseEvents?"mousemove":"touchmove",s);this.interactiveObjects.forEach(a=>{this.dispatch(a,o)})},this.onMouseClick=s=>{this.update();const o=new Gs("click",s);this.interactiveObjects.forEach(a=>{a.intersected&&this.dispatch(a,o)})},this.onMouseDown=s=>{this.mapPositionToPoint(this.mouse,s.clientX,s.clientY),this.update();const o=new Gs("mousedown",s);this.interactiveObjects.forEach(a=>{a.intersected&&this.dispatch(a,o)})},this.onPointerDown=s=>{this.mapPositionToPoint(this.mouse,s.clientX,s.clientY),this.update();const o=new Gs("pointerdown",s);this.interactiveObjects.forEach(a=>{a.intersected&&this.dispatch(a,o)})},this.onTouchStart=s=>{s.touches.length>0&&this.mapPositionToPoint(this.mouse,s.touches[0].clientX,s.touches[0].clientY),this.update();const o=new Gs(this.treatTouchEventsAsMouseEvents?"mousedown":"touchstart",s);this.interactiveObjects.forEach(a=>{a.intersected&&this.dispatch(a,o)})},this.onMouseUp=s=>{const o=new Gs("mouseup",s);this.interactiveObjects.forEach(a=>{this.dispatch(a,o)})},this.onPointerUp=s=>{const o=new Gs("pointerup",s);this.interactiveObjects.forEach(a=>{this.dispatch(a,o)})},this.onTouchEnd=s=>{s.touches.length>0&&this.mapPositionToPoint(this.mouse,s.touches[0].clientX,s.touches[0].clientY),this.update();const o=new Gs(this.treatTouchEventsAsMouseEvents?"mouseup":"touchend",s);this.interactiveObjects.forEach(a=>{this.dispatch(a,o)})},this.dispatch=(s,o)=>{s.target&&!o.cancelBubble&&(o.coords=this.mouse,o.point=s.point,o.distance=s.distance,o.intersected=s.intersected,s.target.dispatchEvent(o))},this.mapPositionToPoint=(s,o,a)=>{const l=this.renderer.domElement.getBoundingClientRect();s.x=(o-l.left)/l.width*2-1,s.y=-(a-l.top)/l.height*2+1},this.renderer=e,this.camera=t,this.domElement=i,this.bindEventsOnBodyElement=!(r&&typeof r.bindEventsOnBodyElement<"u")||r.bindEventsOnBodyElement,this.scene=r&&typeof r.scene<"u"?r.scene:null,this.scene&&(this.scene.onBeforeRender=()=>{this.autoAdd&&null!==this.scene&&this.scene.traverse(s=>{this.add(s),s.addEventListener("removed",o=>{this.remove(o.target)})}),this.update()}),this.autoAdd=!!(r&&typeof r.autoAdd<"u")&&r.autoAdd,this.autoAdd&&null===this.scene&&console.error("Attention: Options.scene needs to be set when using options.autoAdd"),this.mouse=new fe(-1,1),this.supportsPointerEvents=!!window.PointerEvent,this.interactiveObjects=[],this.closestObject=null,this.raycaster=new lP,i.addEventListener("click",this.onMouseClick),this.supportsPointerEvents&&(this.bindEventsOnBodyElement?i.ownerDocument.addEventListener("pointermove",this.onDocumentPointerMove):i.addEventListener("pointermove",this.onDocumentPointerMove),i.addEventListener("pointerdown",this.onPointerDown),i.addEventListener("pointerup",this.onPointerUp)),this.bindEventsOnBodyElement?i.ownerDocument.addEventListener("mousemove",this.onDocumentMouseMove):i.addEventListener("mousemove",this.onDocumentMouseMove),i.addEventListener("mousedown",this.onMouseDown),i.addEventListener("mouseup",this.onMouseUp),i.addEventListener("touchstart",this.onTouchStart,{passive:!0}),i.addEventListener("touchmove",this.onTouchMove,{passive:!0}),i.addEventListener("touchend",this.onTouchEnd,{passive:!0}),this.treatTouchEventsAsMouseEvents=!0}}const Fce=[0,2e3,1e4,3e4,null];class $G{constructor(e){this._retryDelays=void 0!==e?[...e,null]:Fce}nextRetryDelayInMilliseconds(e){return this._retryDelays[e.previousRetryCount]}}let a0=(()=>{class n{}return n.Authorization="Authorization",n.Cookie="Cookie",n})();class qG{constructor(e,t,i){this.statusCode=e,this.statusText=t,this.content=i}}class fC{get(e,t){return this.send({...t,method:"GET",url:e})}post(e,t){return this.send({...t,method:"POST",url:e})}delete(e,t){return this.send({...t,method:"DELETE",url:e})}getCookieString(e){return""}}class kce extends fC{constructor(e,t){super(),this._innerClient=e,this._accessTokenFactory=t}send(e){var t=this;return On(function*(){let i=!0;t._accessTokenFactory&&(!t._accessToken||e.url&&e.url.indexOf("/negotiate?")>0)&&(i=!1,t._accessToken=yield t._accessTokenFactory()),t._setAuthorizationHeader(e);const r=yield t._innerClient.send(e);return i&&401===r.statusCode&&t._accessTokenFactory?(t._accessToken=yield t._accessTokenFactory(),t._setAuthorizationHeader(e),yield t._innerClient.send(e)):r})()}_setAuthorizationHeader(e){e.headers||(e.headers={}),this._accessToken?e.headers[a0.Authorization]=`Bearer ${this._accessToken}`:this._accessTokenFactory&&e.headers[a0.Authorization]&&delete e.headers[a0.Authorization]}getCookieString(e){return this._innerClient.getCookieString(e)}}class hg extends Error{constructor(e,t){const i=new.target.prototype;super(`${e}: Status code '${t}'`),this.statusCode=t,this.__proto__=i}}class $P extends Error{constructor(e="A timeout occurred."){const t=new.target.prototype;super(e),this.__proto__=t}}class Sa extends Error{constructor(e="An abort occurred."){const t=new.target.prototype;super(e),this.__proto__=t}}class Uce extends Error{constructor(e,t){const i=new.target.prototype;super(e),this.transport=t,this.errorType="UnsupportedTransportError",this.__proto__=i}}class Bce extends Error{constructor(e,t){const i=new.target.prototype;super(e),this.transport=t,this.errorType="DisabledTransportError",this.__proto__=i}}class Vce extends Error{constructor(e,t){const i=new.target.prototype;super(e),this.transport=t,this.errorType="FailedToStartTransportError",this.__proto__=i}}class Hce extends Error{constructor(e){const t=new.target.prototype;super(e),this.errorType="FailedToNegotiateWithServerError",this.__proto__=t}}class zce extends Error{constructor(e,t){const i=new.target.prototype;super(e),this.innerErrors=t,this.__proto__=i}}var _e=function(n){return n[n.Trace=0]="Trace",n[n.Debug=1]="Debug",n[n.Information=2]="Information",n[n.Warning=3]="Warning",n[n.Error=4]="Error",n[n.Critical=5]="Critical",n[n.None=6]="None",n}(_e||{});class l0{constructor(){}log(e,t){}}l0.instance=new l0;const Gce="7.0.12";class Er{static isRequired(e,t){if(null==e)throw new Error(`The '${t}' argument is required.`)}static isNotEmpty(e,t){if(!e||e.match(/^\s*$/))throw new Error(`The '${t}' argument should not be empty.`)}static isIn(e,t,i){if(!(e in t))throw new Error(`Unknown ${i} value: ${e}.`)}}class Cr{static get isBrowser(){return"object"==typeof window&&"object"==typeof window.document}static get isWebWorker(){return"object"==typeof self&&"importScripts"in self}static get isReactNative(){return"object"==typeof window&&typeof window.document>"u"}static get isNode(){return!this.isBrowser&&!this.isWebWorker&&!this.isReactNative}}function c0(n,e){let t="";return u0(n)?(t=`Binary data of length ${n.byteLength}`,e&&(t+=`. Content: '${function Wce(n){const e=new Uint8Array(n);let t="";return e.forEach(i=>{t+=`0x${i<16?"0":""}${i.toString(16)} `}),t.substr(0,t.length-1)}(n)}'`)):"string"==typeof n&&(t=`String data of length ${n.length}`,e&&(t+=`. Content: '${n}'`)),t}function u0(n){return n&&typeof ArrayBuffer<"u"&&(n instanceof ArrayBuffer||n.constructor&&"ArrayBuffer"===n.constructor.name)}function XG(n,e,t,i,r,s){return qP.apply(this,arguments)}function qP(){return qP=On(function*(n,e,t,i,r,s){const o={},[a,l]=fg();o[a]=l,n.log(_e.Trace,`(${e} transport) sending data. ${c0(r,s.logMessageContent)}.`);const c=u0(r)?"arraybuffer":"text",d=yield t.post(i,{content:r,headers:{...o,...s.headers},responseType:c,timeout:s.timeout,withCredentials:s.withCredentials});n.log(_e.Trace,`(${e} transport) request complete. Response status: ${d.statusCode}.`)}),qP.apply(this,arguments)}class $ce{constructor(e,t){this._subject=e,this._observer=t}dispose(){const e=this._subject.observers.indexOf(this._observer);e>-1&&this._subject.observers.splice(e,1),0===this._subject.observers.length&&this._subject.cancelCallback&&this._subject.cancelCallback().catch(t=>{})}}class pC{constructor(e){this._minLevel=e,this.out=console}log(e,t){if(e>=this._minLevel){const i=`[${(new Date).toISOString()}] ${_e[e]}: ${t}`;switch(e){case _e.Critical:case _e.Error:this.out.error(i);break;case _e.Warning:this.out.warn(i);break;case _e.Information:this.out.info(i);break;default:this.out.log(i)}}}}function fg(){let n="X-SignalR-User-Agent";return Cr.isNode&&(n="User-Agent"),[n,qce(Gce,Xce(),Cr.isNode?"NodeJS":"Browser",Yce())]}function qce(n,e,t,i){let r="Microsoft SignalR/";const s=n.split(".");return r+=`${s[0]}.${s[1]}`,r+=` (${n}; `,r+=e&&""!==e?`${e}; `:"Unknown OS; ",r+=`${t}`,r+=i?`; ${i}`:"; Unknown Runtime Version",r+=")",r}function Xce(){if(!Cr.isNode)return"";switch(process.platform){case"win32":return"Windows NT";case"darwin":return"macOS";case"linux":return"Linux";default:return process.platform}}function Yce(){if(Cr.isNode)return process.versions.node}function YG(n){return n.stack?n.stack:n.message?n.message:`${n}`}class Jce extends fC{constructor(e){if(super(),this._logger=e,typeof fetch>"u"){const t=require;this._jar=new(t("tough-cookie").CookieJar),this._fetchType=t("node-fetch"),this._fetchType=t("fetch-cookie")(this._fetchType,this._jar)}else this._fetchType=fetch.bind(function Zce(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("could not find global")}());if(typeof AbortController>"u"){const t=require;this._abortControllerType=t("abort-controller")}else this._abortControllerType=AbortController}send(e){var t=this;return On(function*(){if(e.abortSignal&&e.abortSignal.aborted)throw new Sa;if(!e.method)throw new Error("No method defined.");if(!e.url)throw new Error("No url defined.");const i=new t._abortControllerType;let r;e.abortSignal&&(e.abortSignal.onabort=()=>{i.abort(),r=new Sa});let o,s=null;e.timeout&&(s=setTimeout(()=>{i.abort(),t._logger.log(_e.Warning,"Timeout from HTTP request."),r=new $P},e.timeout)),""===e.content&&(e.content=void 0),e.content&&(e.headers=e.headers||{},e.headers["Content-Type"]=u0(e.content)?"application/octet-stream":"text/plain;charset=UTF-8");try{o=yield t._fetchType(e.url,{body:e.content,cache:"no-cache",credentials:!0===e.withCredentials?"include":"same-origin",headers:{"X-Requested-With":"XMLHttpRequest",...e.headers},method:e.method,mode:"cors",redirect:"follow",signal:i.signal})}catch(c){throw r||(t._logger.log(_e.Warning,`Error from HTTP request. ${c}.`),c)}finally{s&&clearTimeout(s),e.abortSignal&&(e.abortSignal.onabort=null)}if(!o.ok){const c=yield KG(o,"text");throw new hg(c||o.statusText,o.status)}const l=yield KG(o,e.responseType);return new qG(o.status,o.statusText,l)})()}getCookieString(e){let t="";return Cr.isNode&&this._jar&&this._jar.getCookies(e,(i,r)=>t=r.join("; ")),t}}function KG(n,e){let t;switch(e){case"arraybuffer":t=n.arrayBuffer();break;case"text":default:t=n.text();break;case"blob":case"document":case"json":throw new Error(`${e} is not supported.`)}return t}class Qce extends fC{constructor(e){super(),this._logger=e}send(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new Sa):e.method?e.url?new Promise((t,i)=>{const r=new XMLHttpRequest;r.open(e.method,e.url,!0),r.withCredentials=void 0===e.withCredentials||e.withCredentials,r.setRequestHeader("X-Requested-With","XMLHttpRequest"),""===e.content&&(e.content=void 0),e.content&&(u0(e.content)?r.setRequestHeader("Content-Type","application/octet-stream"):r.setRequestHeader("Content-Type","text/plain;charset=UTF-8"));const s=e.headers;s&&Object.keys(s).forEach(o=>{r.setRequestHeader(o,s[o])}),e.responseType&&(r.responseType=e.responseType),e.abortSignal&&(e.abortSignal.onabort=()=>{r.abort(),i(new Sa)}),e.timeout&&(r.timeout=e.timeout),r.onload=()=>{e.abortSignal&&(e.abortSignal.onabort=null),r.status>=200&&r.status<300?t(new qG(r.status,r.statusText,r.response||r.responseText)):i(new hg(r.response||r.responseText||r.statusText,r.status))},r.onerror=()=>{this._logger.log(_e.Warning,`Error from HTTP request. ${r.status}: ${r.statusText}.`),i(new hg(r.statusText,r.status))},r.ontimeout=()=>{this._logger.log(_e.Warning,"Timeout from HTTP request."),i(new $P)},r.send(e.content)}):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}}class eue extends fC{constructor(e){if(super(),typeof fetch<"u"||Cr.isNode)this._httpClient=new Jce(e);else{if(!(typeof XMLHttpRequest<"u"))throw new Error("No usable HttpClient found.");this._httpClient=new Qce(e)}}send(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new Sa):e.method?e.url?this._httpClient.send(e):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}getCookieString(e){return this._httpClient.getCookieString(e)}}var Ur=function(n){return n[n.None=0]="None",n[n.WebSockets=1]="WebSockets",n[n.ServerSentEvents=2]="ServerSentEvents",n[n.LongPolling=4]="LongPolling",n}(Ur||{}),Cs=function(n){return n[n.Text=1]="Text",n[n.Binary=2]="Binary",n}(Cs||{});class tue{constructor(){this._isAborted=!1,this.onabort=null}abort(){this._isAborted||(this._isAborted=!0,this.onabort&&this.onabort())}get signal(){return this}get aborted(){return this._isAborted}}class ZG{constructor(e,t,i){this._httpClient=e,this._logger=t,this._pollAbort=new tue,this._options=i,this._running=!1,this.onreceive=null,this.onclose=null}get pollAborted(){return this._pollAbort.aborted}connect(e,t){var i=this;return On(function*(){if(Er.isRequired(e,"url"),Er.isRequired(t,"transferFormat"),Er.isIn(t,Cs,"transferFormat"),i._url=e,i._logger.log(_e.Trace,"(LongPolling transport) Connecting."),t===Cs.Binary&&typeof XMLHttpRequest<"u"&&"string"!=typeof(new XMLHttpRequest).responseType)throw new Error("Binary protocols over XmlHttpRequest not implementing advanced features are not supported.");const[r,s]=fg(),o={[r]:s,...i._options.headers},a={abortSignal:i._pollAbort.signal,headers:o,timeout:1e5,withCredentials:i._options.withCredentials};t===Cs.Binary&&(a.responseType="arraybuffer");const l=`${e}&_=${Date.now()}`;i._logger.log(_e.Trace,`(LongPolling transport) polling: ${l}.`);const c=yield i._httpClient.get(l,a);200!==c.statusCode?(i._logger.log(_e.Error,`(LongPolling transport) Unexpected response code: ${c.statusCode}.`),i._closeError=new hg(c.statusText||"",c.statusCode),i._running=!1):i._running=!0,i._receiving=i._poll(i._url,a)})()}_poll(e,t){var i=this;return On(function*(){try{for(;i._running;)try{const r=`${e}&_=${Date.now()}`;i._logger.log(_e.Trace,`(LongPolling transport) polling: ${r}.`);const s=yield i._httpClient.get(r,t);204===s.statusCode?(i._logger.log(_e.Information,"(LongPolling transport) Poll terminated by server."),i._running=!1):200!==s.statusCode?(i._logger.log(_e.Error,`(LongPolling transport) Unexpected response code: ${s.statusCode}.`),i._closeError=new hg(s.statusText||"",s.statusCode),i._running=!1):s.content?(i._logger.log(_e.Trace,`(LongPolling transport) data received. ${c0(s.content,i._options.logMessageContent)}.`),i.onreceive&&i.onreceive(s.content)):i._logger.log(_e.Trace,"(LongPolling transport) Poll timed out, reissuing.")}catch(r){i._running?r instanceof $P?i._logger.log(_e.Trace,"(LongPolling transport) Poll timed out, reissuing."):(i._closeError=r,i._running=!1):i._logger.log(_e.Trace,`(LongPolling transport) Poll errored after shutdown: ${r.message}`)}}finally{i._logger.log(_e.Trace,"(LongPolling transport) Polling complete."),i.pollAborted||i._raiseOnClose()}})()}send(e){var t=this;return On(function*(){return t._running?XG(t._logger,"LongPolling",t._httpClient,t._url,e,t._options):Promise.reject(new Error("Cannot send until the transport is connected"))})()}stop(){var e=this;return On(function*(){e._logger.log(_e.Trace,"(LongPolling transport) Stopping polling."),e._running=!1,e._pollAbort.abort();try{yield e._receiving,e._logger.log(_e.Trace,`(LongPolling transport) sending DELETE request to ${e._url}.`);const t={},[i,r]=fg();t[i]=r;const s={headers:{...t,...e._options.headers},timeout:e._options.timeout,withCredentials:e._options.withCredentials};yield e._httpClient.delete(e._url,s),e._logger.log(_e.Trace,"(LongPolling transport) DELETE request sent.")}finally{e._logger.log(_e.Trace,"(LongPolling transport) Stop finished."),e._raiseOnClose()}})()}_raiseOnClose(){if(this.onclose){let e="(LongPolling transport) Firing onclose event.";this._closeError&&(e+=" Error: "+this._closeError),this._logger.log(_e.Trace,e),this.onclose(this._closeError)}}}class nue{constructor(e,t,i,r){this._httpClient=e,this._accessToken=t,this._logger=i,this._options=r,this.onreceive=null,this.onclose=null}connect(e,t){var i=this;return On(function*(){return Er.isRequired(e,"url"),Er.isRequired(t,"transferFormat"),Er.isIn(t,Cs,"transferFormat"),i._logger.log(_e.Trace,"(SSE transport) Connecting."),i._url=e,i._accessToken&&(e+=(e.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(i._accessToken)}`),new Promise((r,s)=>{let a,o=!1;if(t===Cs.Text){if(Cr.isBrowser||Cr.isWebWorker)a=new i._options.EventSource(e,{withCredentials:i._options.withCredentials});else{const l=i._httpClient.getCookieString(e),c={};c.Cookie=l;const[d,h]=fg();c[d]=h,a=new i._options.EventSource(e,{withCredentials:i._options.withCredentials,headers:{...c,...i._options.headers}})}try{a.onmessage=l=>{if(i.onreceive)try{i._logger.log(_e.Trace,`(SSE transport) data received. ${c0(l.data,i._options.logMessageContent)}.`),i.onreceive(l.data)}catch(c){return void i._close(c)}},a.onerror=l=>{o?i._close():s(new Error("EventSource failed to connect. The connection could not be found on the server, either the connection ID is not present on the server, or a proxy is refusing/buffering the connection. If you have multiple servers check that sticky sessions are enabled."))},a.onopen=()=>{i._logger.log(_e.Information,`SSE connected to ${i._url}`),i._eventSource=a,o=!0,r()}}catch(l){return void s(l)}}else s(new Error("The Server-Sent Events transport only supports the 'Text' transfer format"))})})()}send(e){var t=this;return On(function*(){return t._eventSource?XG(t._logger,"SSE",t._httpClient,t._url,e,t._options):Promise.reject(new Error("Cannot send until the transport is connected"))})()}stop(){return this._close(),Promise.resolve()}_close(e){this._eventSource&&(this._eventSource.close(),this._eventSource=void 0,this.onclose&&this.onclose(e))}}class iue{constructor(e,t,i,r,s,o){this._logger=i,this._accessTokenFactory=t,this._logMessageContent=r,this._webSocketConstructor=s,this._httpClient=e,this.onreceive=null,this.onclose=null,this._headers=o}connect(e,t){var i=this;return On(function*(){let r;return Er.isRequired(e,"url"),Er.isRequired(t,"transferFormat"),Er.isIn(t,Cs,"transferFormat"),i._logger.log(_e.Trace,"(WebSockets transport) Connecting."),i._accessTokenFactory&&(r=yield i._accessTokenFactory()),new Promise((s,o)=>{let a;e=e.replace(/^http/,"ws");const l=i._httpClient.getCookieString(e);let c=!1;if(Cr.isNode||Cr.isReactNative){const d={},[h,p]=fg();d[h]=p,r&&(d[a0.Authorization]=`Bearer ${r}`),l&&(d[a0.Cookie]=l),a=new i._webSocketConstructor(e,void 0,{headers:{...d,...i._headers}})}else r&&(e+=(e.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(r)}`);a||(a=new i._webSocketConstructor(e)),t===Cs.Binary&&(a.binaryType="arraybuffer"),a.onopen=d=>{i._logger.log(_e.Information,`WebSocket connected to ${e}.`),i._webSocket=a,c=!0,s()},a.onerror=d=>{let h=null;h=typeof ErrorEvent<"u"&&d instanceof ErrorEvent?d.error:"There was an error with the transport",i._logger.log(_e.Information,`(WebSockets transport) ${h}.`)},a.onmessage=d=>{if(i._logger.log(_e.Trace,`(WebSockets transport) data received. ${c0(d.data,i._logMessageContent)}.`),i.onreceive)try{i.onreceive(d.data)}catch(h){return void i._close(h)}},a.onclose=d=>{if(c)i._close(d);else{let h=null;h=typeof ErrorEvent<"u"&&d instanceof ErrorEvent?d.error:"WebSocket failed to connect. The connection could not be found on the server, either the endpoint may not be a SignalR endpoint, the connection ID is not present on the server, or there is a proxy blocking WebSockets. If you have multiple servers check that sticky sessions are enabled.",o(new Error(h))}}})})()}send(e){return this._webSocket&&this._webSocket.readyState===this._webSocketConstructor.OPEN?(this._logger.log(_e.Trace,`(WebSockets transport) sending data. ${c0(e,this._logMessageContent)}.`),this._webSocket.send(e),Promise.resolve()):Promise.reject("WebSocket is not in the OPEN state")}stop(){return this._webSocket&&this._close(void 0),Promise.resolve()}_close(e){this._webSocket&&(this._webSocket.onclose=()=>{},this._webSocket.onmessage=()=>{},this._webSocket.onerror=()=>{},this._webSocket.close(),this._webSocket=void 0),this._logger.log(_e.Trace,"(WebSockets transport) socket closed."),this.onclose&&(!this._isCloseEvent(e)||!1!==e.wasClean&&1e3===e.code?e instanceof Error?this.onclose(e):this.onclose():this.onclose(new Error(`WebSocket closed with status code: ${e.code} (${e.reason||"no reason given"}).`)))}_isCloseEvent(e){return e&&"boolean"==typeof e.wasClean&&"number"==typeof e.code}}class rue{constructor(e,t={}){if(this._stopPromiseResolver=()=>{},this.features={},this._negotiateVersion=1,Er.isRequired(e,"url"),this._logger=function jce(n){return void 0===n?new pC(_e.Information):null===n?l0.instance:void 0!==n.log?n:new pC(n)}(t.logger),this.baseUrl=this._resolveUrl(e),(t=t||{}).logMessageContent=void 0!==t.logMessageContent&&t.logMessageContent,"boolean"!=typeof t.withCredentials&&void 0!==t.withCredentials)throw new Error("withCredentials option was not a 'boolean' or 'undefined' value");t.withCredentials=void 0===t.withCredentials||t.withCredentials,t.timeout=void 0===t.timeout?1e5:t.timeout;let i=null,r=null;if(Cr.isNode){const s=require;i=s("ws"),r=s("eventsource")}!Cr.isNode&&typeof WebSocket<"u"&&!t.WebSocket?t.WebSocket=WebSocket:Cr.isNode&&!t.WebSocket&&i&&(t.WebSocket=i),!Cr.isNode&&typeof EventSource<"u"&&!t.EventSource?t.EventSource=EventSource:Cr.isNode&&!t.EventSource&&typeof r<"u"&&(t.EventSource=r),this._httpClient=new kce(t.httpClient||new eue(this._logger),t.accessTokenFactory),this._connectionState="Disconnected",this._connectionStarted=!1,this._options=t,this.onreceive=null,this.onclose=null}start(e){var t=this;return On(function*(){if(Er.isIn(e=e||Cs.Binary,Cs,"transferFormat"),t._logger.log(_e.Debug,`Starting connection with transfer format '${Cs[e]}'.`),"Disconnected"!==t._connectionState)return Promise.reject(new Error("Cannot start an HttpConnection that is not in the 'Disconnected' state."));if(t._connectionState="Connecting",t._startInternalPromise=t._startInternal(e),yield t._startInternalPromise,"Disconnecting"===t._connectionState){const i="Failed to start the HttpConnection before stop() was called.";return t._logger.log(_e.Error,i),yield t._stopPromise,Promise.reject(new Sa(i))}if("Connected"!==t._connectionState){const i="HttpConnection.startInternal completed gracefully but didn't enter the connection into the connected state!";return t._logger.log(_e.Error,i),Promise.reject(new Sa(i))}t._connectionStarted=!0})()}send(e){return"Connected"!==this._connectionState?Promise.reject(new Error("Cannot send data if the connection is not in the 'Connected' State.")):(this._sendQueue||(this._sendQueue=new XP(this.transport)),this._sendQueue.send(e))}stop(e){var t=this;return On(function*(){return"Disconnected"===t._connectionState?(t._logger.log(_e.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnected state.`),Promise.resolve()):"Disconnecting"===t._connectionState?(t._logger.log(_e.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnecting state.`),t._stopPromise):(t._connectionState="Disconnecting",t._stopPromise=new Promise(i=>{t._stopPromiseResolver=i}),yield t._stopInternal(e),void(yield t._stopPromise))})()}_stopInternal(e){var t=this;return On(function*(){t._stopError=e;try{yield t._startInternalPromise}catch{}if(t.transport){try{yield t.transport.stop()}catch(i){t._logger.log(_e.Error,`HttpConnection.transport.stop() threw error '${i}'.`),t._stopConnection()}t.transport=void 0}else t._logger.log(_e.Debug,"HttpConnection.transport is undefined in HttpConnection.stop() because start() failed.")})()}_startInternal(e){var t=this;return On(function*(){let i=t.baseUrl;t._accessTokenFactory=t._options.accessTokenFactory,t._httpClient._accessTokenFactory=t._accessTokenFactory;try{if(t._options.skipNegotiation){if(t._options.transport!==Ur.WebSockets)throw new Error("Negotiation can only be skipped when using the WebSocket transport directly.");t.transport=t._constructTransport(Ur.WebSockets),yield t._startTransport(i,e)}else{let r=null,s=0;do{if(r=yield t._getNegotiationResponse(i),"Disconnecting"===t._connectionState||"Disconnected"===t._connectionState)throw new Sa("The connection was stopped during negotiation.");if(r.error)throw new Error(r.error);if(r.ProtocolVersion)throw new Error("Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.");if(r.url&&(i=r.url),r.accessToken){const o=r.accessToken;t._accessTokenFactory=()=>o,t._httpClient._accessToken=o,t._httpClient._accessTokenFactory=void 0}s++}while(r.url&&s<100);if(100===s&&r.url)throw new Error("Negotiate redirection limit exceeded.");yield t._createTransport(i,t._options.transport,r,e)}t.transport instanceof ZG&&(t.features.inherentKeepAlive=!0),"Connecting"===t._connectionState&&(t._logger.log(_e.Debug,"The HttpConnection connected successfully."),t._connectionState="Connected")}catch(r){return t._logger.log(_e.Error,"Failed to start the connection: "+r),t._connectionState="Disconnected",t.transport=void 0,t._stopPromiseResolver(),Promise.reject(r)}})()}_getNegotiationResponse(e){var t=this;return On(function*(){const i={},[r,s]=fg();i[r]=s;const o=t._resolveNegotiateUrl(e);t._logger.log(_e.Debug,`Sending negotiation request: ${o}.`);try{const a=yield t._httpClient.post(o,{content:"",headers:{...i,...t._options.headers},timeout:t._options.timeout,withCredentials:t._options.withCredentials});if(200!==a.statusCode)return Promise.reject(new Error(`Unexpected status code returned from negotiate '${a.statusCode}'`));const l=JSON.parse(a.content);return(!l.negotiateVersion||l.negotiateVersion<1)&&(l.connectionToken=l.connectionId),l}catch(a){let l="Failed to complete negotiation with the server: "+a;return a instanceof hg&&404===a.statusCode&&(l+=" Either this is not a SignalR endpoint or there is a proxy blocking the connection."),t._logger.log(_e.Error,l),Promise.reject(new Hce(l))}})()}_createConnectUrl(e,t){return t?e+(-1===e.indexOf("?")?"?":"&")+`id=${t}`:e}_createTransport(e,t,i,r){var s=this;return On(function*(){let o=s._createConnectUrl(e,i.connectionToken);if(s._isITransport(t))return s._logger.log(_e.Debug,"Connection was provided an instance of ITransport, using that directly."),s.transport=t,yield s._startTransport(o,r),void(s.connectionId=i.connectionId);const a=[],l=i.availableTransports||[];let c=i;for(const d of l){const h=s._resolveTransportOrError(d,t,r);if(h instanceof Error)a.push(`${d.transport} failed:`),a.push(h);else if(s._isITransport(h)){if(s.transport=h,!c){try{c=yield s._getNegotiationResponse(e)}catch(p){return Promise.reject(p)}o=s._createConnectUrl(e,c.connectionToken)}try{return yield s._startTransport(o,r),void(s.connectionId=c.connectionId)}catch(p){if(s._logger.log(_e.Error,`Failed to start the transport '${d.transport}': ${p}`),c=void 0,a.push(new Vce(`${d.transport} failed: ${p}`,Ur[d.transport])),"Connecting"!==s._connectionState){const m="Failed to select transport before stop() was called.";return s._logger.log(_e.Debug,m),Promise.reject(new Sa(m))}}}}return Promise.reject(a.length>0?new zce(`Unable to connect to the server with any of the available transports. ${a.join(" ")}`,a):new Error("None of the transports supported by the client are supported by the server."))})()}_constructTransport(e){switch(e){case Ur.WebSockets:if(!this._options.WebSocket)throw new Error("'WebSocket' is not supported in your environment.");return new iue(this._httpClient,this._accessTokenFactory,this._logger,this._options.logMessageContent,this._options.WebSocket,this._options.headers||{});case Ur.ServerSentEvents:if(!this._options.EventSource)throw new Error("'EventSource' is not supported in your environment.");return new nue(this._httpClient,this._httpClient._accessToken,this._logger,this._options);case Ur.LongPolling:return new ZG(this._httpClient,this._logger,this._options);default:throw new Error(`Unknown transport: ${e}.`)}}_startTransport(e,t){return this.transport.onreceive=this.onreceive,this.transport.onclose=i=>this._stopConnection(i),this.transport.connect(e,t)}_resolveTransportOrError(e,t,i){const r=Ur[e.transport];if(null==r)return this._logger.log(_e.Debug,`Skipping transport '${e.transport}' because it is not supported by this client.`),new Error(`Skipping transport '${e.transport}' because it is not supported by this client.`);if(!function sue(n,e){return!n||0!=(e&n)}(t,r))return this._logger.log(_e.Debug,`Skipping transport '${Ur[r]}' because it was disabled by the client.`),new Bce(`'${Ur[r]}' is disabled by the client.`,r);if(!(e.transferFormats.map(o=>Cs[o]).indexOf(i)>=0))return this._logger.log(_e.Debug,`Skipping transport '${Ur[r]}' because it does not support the requested transfer format '${Cs[i]}'.`),new Error(`'${Ur[r]}' does not support ${Cs[i]}.`);if(r===Ur.WebSockets&&!this._options.WebSocket||r===Ur.ServerSentEvents&&!this._options.EventSource)return this._logger.log(_e.Debug,`Skipping transport '${Ur[r]}' because it is not supported in your environment.'`),new Uce(`'${Ur[r]}' is not supported in your environment.`,r);this._logger.log(_e.Debug,`Selecting transport '${Ur[r]}'.`);try{return this._constructTransport(r)}catch(o){return o}}_isITransport(e){return e&&"object"==typeof e&&"connect"in e}_stopConnection(e){if(this._logger.log(_e.Debug,`HttpConnection.stopConnection(${e}) called while in state ${this._connectionState}.`),this.transport=void 0,e=this._stopError||e,this._stopError=void 0,"Disconnected"!==this._connectionState){if("Connecting"===this._connectionState)throw this._logger.log(_e.Warning,`Call to HttpConnection.stopConnection(${e}) was ignored because the connection is still in the connecting state.`),new Error(`HttpConnection.stopConnection(${e}) was called while the connection is still in the connecting state.`);if("Disconnecting"===this._connectionState&&this._stopPromiseResolver(),e?this._logger.log(_e.Error,`Connection disconnected with error '${e}'.`):this._logger.log(_e.Information,"Connection disconnected."),this._sendQueue&&(this._sendQueue.stop().catch(t=>{this._logger.log(_e.Error,`TransportSendQueue.stop() threw error '${t}'.`)}),this._sendQueue=void 0),this.connectionId=void 0,this._connectionState="Disconnected",this._connectionStarted){this._connectionStarted=!1;try{this.onclose&&this.onclose(e)}catch(t){this._logger.log(_e.Error,`HttpConnection.onclose(${e}) threw error '${t}'.`)}}}else this._logger.log(_e.Debug,`Call to HttpConnection.stopConnection(${e}) was ignored because the connection is already in the disconnected state.`)}_resolveUrl(e){if(0===e.lastIndexOf("https://",0)||0===e.lastIndexOf("http://",0))return e;if(!Cr.isBrowser)throw new Error(`Cannot resolve '${e}'.`);const t=window.document.createElement("a");return t.href=e,this._logger.log(_e.Information,`Normalizing '${e}' to '${t.href}'.`),t.href}_resolveNegotiateUrl(e){const t=e.indexOf("?");let i=e.substring(0,-1===t?e.length:t);return"/"!==i[i.length-1]&&(i+="/"),i+="negotiate",i+=-1===t?"":e.substring(t),-1===i.indexOf("negotiateVersion")&&(i+=-1===t?"?":"&",i+="negotiateVersion="+this._negotiateVersion),i}}class XP{constructor(e){this._transport=e,this._buffer=[],this._executing=!0,this._sendBufferedData=new mC,this._transportResult=new mC,this._sendLoopPromise=this._sendLoop()}send(e){return this._bufferData(e),this._transportResult||(this._transportResult=new mC),this._transportResult.promise}stop(){return this._executing=!1,this._sendBufferedData.resolve(),this._sendLoopPromise}_bufferData(e){if(this._buffer.length&&typeof this._buffer[0]!=typeof e)throw new Error(`Expected data to be of type ${typeof this._buffer} but was of type ${typeof e}`);this._buffer.push(e),this._sendBufferedData.resolve()}_sendLoop(){var e=this;return On(function*(){for(;;){if(yield e._sendBufferedData.promise,!e._executing){e._transportResult&&e._transportResult.reject("Connection stopped.");break}e._sendBufferedData=new mC;const t=e._transportResult;e._transportResult=void 0;const i="string"==typeof e._buffer[0]?e._buffer.join(""):XP._concatBuffers(e._buffer);e._buffer.length=0;try{yield e._transport.send(i),t.resolve()}catch(r){t.reject(r)}}})()}static _concatBuffers(e){const t=e.map(s=>s.byteLength).reduce((s,o)=>s+o),i=new Uint8Array(t);let r=0;for(const s of e)i.set(new Uint8Array(s),r),r+=s.byteLength;return i.buffer}}class mC{constructor(){this.promise=new Promise((e,t)=>[this._resolver,this._rejecter]=[e,t])}resolve(){this._resolver()}reject(e){this._rejecter(e)}}class po{static write(e){return`${e}${po.RecordSeparator}`}static parse(e){if(e[e.length-1]!==po.RecordSeparator)throw new Error("Message is incomplete.");const t=e.split(po.RecordSeparator);return t.pop(),t}}po.RecordSeparatorCode=30,po.RecordSeparator=String.fromCharCode(po.RecordSeparatorCode);class oue{writeHandshakeRequest(e){return po.write(JSON.stringify(e))}parseHandshakeResponse(e){let t,i;if(u0(e)){const a=new Uint8Array(e),l=a.indexOf(po.RecordSeparatorCode);if(-1===l)throw new Error("Message is incomplete.");const c=l+1;t=String.fromCharCode.apply(null,Array.prototype.slice.call(a.slice(0,c))),i=a.byteLength>c?a.slice(c).buffer:null}else{const a=e,l=a.indexOf(po.RecordSeparator);if(-1===l)throw new Error("Message is incomplete.");const c=l+1;t=a.substring(0,c),i=a.length>c?a.substring(c):null}const r=po.parse(t),s=JSON.parse(r[0]);if(s.type)throw new Error("Expected a handshake response from the server.");return[i,s]}}var oi=function(n){return n[n.Invocation=1]="Invocation",n[n.StreamItem=2]="StreamItem",n[n.Completion=3]="Completion",n[n.StreamInvocation=4]="StreamInvocation",n[n.CancelInvocation=5]="CancelInvocation",n[n.Ping=6]="Ping",n[n.Close=7]="Close",n}(oi||{});class aue{constructor(){this.observers=[]}next(e){for(const t of this.observers)t.next(e)}error(e){for(const t of this.observers)t.error&&t.error(e)}complete(){for(const e of this.observers)e.complete&&e.complete()}subscribe(e){return this.observers.push(e),new $ce(this,e)}}var Di=function(n){return n.Disconnected="Disconnected",n.Connecting="Connecting",n.Connected="Connected",n.Disconnecting="Disconnecting",n.Reconnecting="Reconnecting",n}(Di||{});class YP{constructor(e,t,i,r){this._nextKeepAlive=0,this._freezeEventListener=()=>{this._logger.log(_e.Warning,"The page is being frozen, this will likely lead to the connection being closed and messages being lost. For more information see the docs at https://docs.microsoft.com/aspnet/core/signalr/javascript-client#bsleep")},Er.isRequired(e,"connection"),Er.isRequired(t,"logger"),Er.isRequired(i,"protocol"),this.serverTimeoutInMilliseconds=3e4,this.keepAliveIntervalInMilliseconds=15e3,this._logger=t,this._protocol=i,this.connection=e,this._reconnectPolicy=r,this._handshakeProtocol=new oue,this.connection.onreceive=s=>this._processIncomingData(s),this.connection.onclose=s=>this._connectionClosed(s),this._callbacks={},this._methods={},this._closedCallbacks=[],this._reconnectingCallbacks=[],this._reconnectedCallbacks=[],this._invocationId=0,this._receivedHandshakeResponse=!1,this._connectionState=Di.Disconnected,this._connectionStarted=!1,this._cachedPingMessage=this._protocol.writeMessage({type:oi.Ping})}static create(e,t,i,r){return new YP(e,t,i,r)}get state(){return this._connectionState}get connectionId(){return this.connection&&this.connection.connectionId||null}get baseUrl(){return this.connection.baseUrl||""}set baseUrl(e){if(this._connectionState!==Di.Disconnected&&this._connectionState!==Di.Reconnecting)throw new Error("The HubConnection must be in the Disconnected or Reconnecting state to change the url.");if(!e)throw new Error("The HubConnection url must be a valid url.");this.connection.baseUrl=e}start(){return this._startPromise=this._startWithStateTransitions(),this._startPromise}_startWithStateTransitions(){var e=this;return On(function*(){if(e._connectionState!==Di.Disconnected)return Promise.reject(new Error("Cannot start a HubConnection that is not in the 'Disconnected' state."));e._connectionState=Di.Connecting,e._logger.log(_e.Debug,"Starting HubConnection.");try{yield e._startInternal(),Cr.isBrowser&&window.document.addEventListener("freeze",e._freezeEventListener),e._connectionState=Di.Connected,e._connectionStarted=!0,e._logger.log(_e.Debug,"HubConnection connected successfully.")}catch(t){return e._connectionState=Di.Disconnected,e._logger.log(_e.Debug,`HubConnection failed to start successfully because of error '${t}'.`),Promise.reject(t)}})()}_startInternal(){var e=this;return On(function*(){e._stopDuringStartError=void 0,e._receivedHandshakeResponse=!1;const t=new Promise((i,r)=>{e._handshakeResolver=i,e._handshakeRejecter=r});yield e.connection.start(e._protocol.transferFormat);try{const i={protocol:e._protocol.name,version:e._protocol.version};if(e._logger.log(_e.Debug,"Sending handshake request."),yield e._sendMessage(e._handshakeProtocol.writeHandshakeRequest(i)),e._logger.log(_e.Information,`Using HubProtocol '${e._protocol.name}'.`),e._cleanupTimeout(),e._resetTimeoutPeriod(),e._resetKeepAliveInterval(),yield t,e._stopDuringStartError)throw e._stopDuringStartError;e.connection.features.inherentKeepAlive||(yield e._sendMessage(e._cachedPingMessage))}catch(i){throw e._logger.log(_e.Debug,`Hub handshake failed with error '${i}' during start(). Stopping HubConnection.`),e._cleanupTimeout(),e._cleanupPingTimer(),yield e.connection.stop(i),i}})()}stop(){var e=this;return On(function*(){const t=e._startPromise;e._stopPromise=e._stopInternal(),yield e._stopPromise;try{yield t}catch{}})()}_stopInternal(e){return this._connectionState===Di.Disconnected?(this._logger.log(_e.Debug,`Call to HubConnection.stop(${e}) ignored because it is already in the disconnected state.`),Promise.resolve()):this._connectionState===Di.Disconnecting?(this._logger.log(_e.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnecting state.`),this._stopPromise):(this._connectionState=Di.Disconnecting,this._logger.log(_e.Debug,"Stopping HubConnection."),this._reconnectDelayHandle?(this._logger.log(_e.Debug,"Connection stopped during reconnect delay. Done reconnecting."),clearTimeout(this._reconnectDelayHandle),this._reconnectDelayHandle=void 0,this._completeClose(),Promise.resolve()):(this._cleanupTimeout(),this._cleanupPingTimer(),this._stopDuringStartError=e||new Sa("The connection was stopped before the hub handshake could complete."),this.connection.stop(e)))}stream(e,...t){const[i,r]=this._replaceStreamingParams(t),s=this._createStreamInvocation(e,t,r);let o;const a=new aue;return a.cancelCallback=()=>{const l=this._createCancelInvocation(s.invocationId);return delete this._callbacks[s.invocationId],o.then(()=>this._sendWithProtocol(l))},this._callbacks[s.invocationId]=(l,c)=>{c?a.error(c):l&&(l.type===oi.Completion?l.error?a.error(new Error(l.error)):a.complete():a.next(l.item))},o=this._sendWithProtocol(s).catch(l=>{a.error(l),delete this._callbacks[s.invocationId]}),this._launchStreams(i,o),a}_sendMessage(e){return this._resetKeepAliveInterval(),this.connection.send(e)}_sendWithProtocol(e){return this._sendMessage(this._protocol.writeMessage(e))}send(e,...t){const[i,r]=this._replaceStreamingParams(t),s=this._sendWithProtocol(this._createInvocation(e,t,!0,r));return this._launchStreams(i,s),s}invoke(e,...t){const[i,r]=this._replaceStreamingParams(t),s=this._createInvocation(e,t,!1,r);return new Promise((a,l)=>{this._callbacks[s.invocationId]=(d,h)=>{h?l(h):d&&(d.type===oi.Completion?d.error?l(new Error(d.error)):a(d.result):l(new Error(`Unexpected message type: ${d.type}`)))};const c=this._sendWithProtocol(s).catch(d=>{l(d),delete this._callbacks[s.invocationId]});this._launchStreams(i,c)})}on(e,t){!e||!t||(e=e.toLowerCase(),this._methods[e]||(this._methods[e]=[]),-1===this._methods[e].indexOf(t)&&this._methods[e].push(t))}off(e,t){if(!e)return;e=e.toLowerCase();const i=this._methods[e];if(i)if(t){const r=i.indexOf(t);-1!==r&&(i.splice(r,1),0===i.length&&delete this._methods[e])}else delete this._methods[e]}onclose(e){e&&this._closedCallbacks.push(e)}onreconnecting(e){e&&this._reconnectingCallbacks.push(e)}onreconnected(e){e&&this._reconnectedCallbacks.push(e)}_processIncomingData(e){if(this._cleanupTimeout(),this._receivedHandshakeResponse||(e=this._processHandshakeResponse(e),this._receivedHandshakeResponse=!0),e){const t=this._protocol.parseMessages(e,this._logger);for(const i of t)switch(i.type){case oi.Invocation:this._invokeClientMethod(i);break;case oi.StreamItem:case oi.Completion:{const r=this._callbacks[i.invocationId];if(r){i.type===oi.Completion&&delete this._callbacks[i.invocationId];try{r(i)}catch(s){this._logger.log(_e.Error,`Stream callback threw error: ${YG(s)}`)}}break}case oi.Ping:break;case oi.Close:{this._logger.log(_e.Information,"Close message received from server.");const r=i.error?new Error("Server returned an error on close: "+i.error):void 0;!0===i.allowReconnect?this.connection.stop(r):this._stopPromise=this._stopInternal(r);break}default:this._logger.log(_e.Warning,`Invalid message type: ${i.type}.`)}}this._resetTimeoutPeriod()}_processHandshakeResponse(e){let t,i;try{[i,t]=this._handshakeProtocol.parseHandshakeResponse(e)}catch(r){const s="Error parsing handshake response: "+r;this._logger.log(_e.Error,s);const o=new Error(s);throw this._handshakeRejecter(o),o}if(t.error){const r="Server returned handshake error: "+t.error;this._logger.log(_e.Error,r);const s=new Error(r);throw this._handshakeRejecter(s),s}return this._logger.log(_e.Debug,"Server handshake complete."),this._handshakeResolver(),i}_resetKeepAliveInterval(){this.connection.features.inherentKeepAlive||(this._nextKeepAlive=(new Date).getTime()+this.keepAliveIntervalInMilliseconds,this._cleanupPingTimer())}_resetTimeoutPeriod(){var e=this;if(!(this.connection.features&&this.connection.features.inherentKeepAlive||(this._timeoutHandle=setTimeout(()=>this.serverTimeout(),this.serverTimeoutInMilliseconds),void 0!==this._pingServerHandle))){let t=this._nextKeepAlive-(new Date).getTime();t<0&&(t=0),this._pingServerHandle=setTimeout(On(function*(){if(e._connectionState===Di.Connected)try{yield e._sendMessage(e._cachedPingMessage)}catch{e._cleanupPingTimer()}}),t)}}serverTimeout(){this.connection.stop(new Error("Server timeout elapsed without receiving a message from the server."))}_invokeClientMethod(e){var t=this;return On(function*(){const i=e.target.toLowerCase(),r=t._methods[i];if(!r)return t._logger.log(_e.Warning,`No client method with the name '${i}' found.`),void(e.invocationId&&(t._logger.log(_e.Warning,`No result given for '${i}' method and invocation ID '${e.invocationId}'.`),yield t._sendWithProtocol(t._createCompletionMessage(e.invocationId,"Client didn't provide a result.",null))));const s=r.slice(),o=!!e.invocationId;let a,l,c;for(const d of s)try{const h=a;a=yield d.apply(t,e.arguments),o&&a&&h&&(t._logger.log(_e.Error,`Multiple results provided for '${i}'. Sending error to server.`),c=t._createCompletionMessage(e.invocationId,"Client provided multiple results.",null)),l=void 0}catch(h){l=h,t._logger.log(_e.Error,`A callback for the method '${i}' threw error '${h}'.`)}c?yield t._sendWithProtocol(c):o?(l?c=t._createCompletionMessage(e.invocationId,`${l}`,null):void 0!==a?c=t._createCompletionMessage(e.invocationId,null,a):(t._logger.log(_e.Warning,`No result given for '${i}' method and invocation ID '${e.invocationId}'.`),c=t._createCompletionMessage(e.invocationId,"Client didn't provide a result.",null)),yield t._sendWithProtocol(c)):a&&t._logger.log(_e.Error,`Result given for '${i}' method but server is not expecting a result.`)})()}_connectionClosed(e){this._logger.log(_e.Debug,`HubConnection.connectionClosed(${e}) called while in state ${this._connectionState}.`),this._stopDuringStartError=this._stopDuringStartError||e||new Sa("The underlying connection was closed before the hub handshake could complete."),this._handshakeResolver&&this._handshakeResolver(),this._cancelCallbacksWithError(e||new Error("Invocation canceled due to the underlying connection being closed.")),this._cleanupTimeout(),this._cleanupPingTimer(),this._connectionState===Di.Disconnecting?this._completeClose(e):this._connectionState===Di.Connected&&this._reconnectPolicy?this._reconnect(e):this._connectionState===Di.Connected&&this._completeClose(e)}_completeClose(e){if(this._connectionStarted){this._connectionState=Di.Disconnected,this._connectionStarted=!1,Cr.isBrowser&&window.document.removeEventListener("freeze",this._freezeEventListener);try{this._closedCallbacks.forEach(t=>t.apply(this,[e]))}catch(t){this._logger.log(_e.Error,`An onclose callback called with error '${e}' threw error '${t}'.`)}}}_reconnect(e){var t=this;return On(function*(){const i=Date.now();let r=0,s=void 0!==e?e:new Error("Attempting to reconnect due to a unknown error."),o=t._getNextRetryDelay(r++,0,s);if(null===o)return t._logger.log(_e.Debug,"Connection not reconnecting because the IRetryPolicy returned null on the first reconnect attempt."),void t._completeClose(e);if(t._connectionState=Di.Reconnecting,t._logger.log(_e.Information,e?`Connection reconnecting because of error '${e}'.`:"Connection reconnecting."),0!==t._reconnectingCallbacks.length){try{t._reconnectingCallbacks.forEach(a=>a.apply(t,[e]))}catch(a){t._logger.log(_e.Error,`An onreconnecting callback called with error '${e}' threw error '${a}'.`)}if(t._connectionState!==Di.Reconnecting)return void t._logger.log(_e.Debug,"Connection left the reconnecting state in onreconnecting callback. Done reconnecting.")}for(;null!==o;){if(t._logger.log(_e.Information,`Reconnect attempt number ${r} will start in ${o} ms.`),yield new Promise(a=>{t._reconnectDelayHandle=setTimeout(a,o)}),t._reconnectDelayHandle=void 0,t._connectionState!==Di.Reconnecting)return void t._logger.log(_e.Debug,"Connection left the reconnecting state during reconnect delay. Done reconnecting.");try{if(yield t._startInternal(),t._connectionState=Di.Connected,t._logger.log(_e.Information,"HubConnection reconnected successfully."),0!==t._reconnectedCallbacks.length)try{t._reconnectedCallbacks.forEach(a=>a.apply(t,[t.connection.connectionId]))}catch(a){t._logger.log(_e.Error,`An onreconnected callback called with connectionId '${t.connection.connectionId}; threw error '${a}'.`)}return}catch(a){if(t._logger.log(_e.Information,`Reconnect attempt failed because of error '${a}'.`),t._connectionState!==Di.Reconnecting)return t._logger.log(_e.Debug,`Connection moved to the '${t._connectionState}' from the reconnecting state during reconnect attempt. Done reconnecting.`),void(t._connectionState===Di.Disconnecting&&t._completeClose());s=a instanceof Error?a:new Error(a.toString()),o=t._getNextRetryDelay(r++,Date.now()-i,s)}}t._logger.log(_e.Information,`Reconnect retries have been exhausted after ${Date.now()-i} ms and ${r} failed attempts. Connection disconnecting.`),t._completeClose()})()}_getNextRetryDelay(e,t,i){try{return this._reconnectPolicy.nextRetryDelayInMilliseconds({elapsedMilliseconds:t,previousRetryCount:e,retryReason:i})}catch(r){return this._logger.log(_e.Error,`IRetryPolicy.nextRetryDelayInMilliseconds(${e}, ${t}) threw error '${r}'.`),null}}_cancelCallbacksWithError(e){const t=this._callbacks;this._callbacks={},Object.keys(t).forEach(i=>{const r=t[i];try{r(null,e)}catch(s){this._logger.log(_e.Error,`Stream 'error' callback called with '${e}' threw error: ${YG(s)}`)}})}_cleanupPingTimer(){this._pingServerHandle&&(clearTimeout(this._pingServerHandle),this._pingServerHandle=void 0)}_cleanupTimeout(){this._timeoutHandle&&clearTimeout(this._timeoutHandle)}_createInvocation(e,t,i,r){if(i)return 0!==r.length?{arguments:t,streamIds:r,target:e,type:oi.Invocation}:{arguments:t,target:e,type:oi.Invocation};{const s=this._invocationId;return this._invocationId++,0!==r.length?{arguments:t,invocationId:s.toString(),streamIds:r,target:e,type:oi.Invocation}:{arguments:t,invocationId:s.toString(),target:e,type:oi.Invocation}}}_launchStreams(e,t){if(0!==e.length){t||(t=Promise.resolve());for(const i in e)e[i].subscribe({complete:()=>{t=t.then(()=>this._sendWithProtocol(this._createCompletionMessage(i)))},error:r=>{let s;s=r instanceof Error?r.message:r&&r.toString?r.toString():"Unknown error",t=t.then(()=>this._sendWithProtocol(this._createCompletionMessage(i,s)))},next:r=>{t=t.then(()=>this._sendWithProtocol(this._createStreamItemMessage(i,r)))}})}}_replaceStreamingParams(e){const t=[],i=[];for(let r=0;r<e.length;r++){const s=e[r];if(this._isObservable(s)){const o=this._invocationId;this._invocationId++,t[o]=s,i.push(o.toString()),e.splice(r,1)}}return[t,i]}_isObservable(e){return e&&e.subscribe&&"function"==typeof e.subscribe}_createStreamInvocation(e,t,i){const r=this._invocationId;return this._invocationId++,0!==i.length?{arguments:t,invocationId:r.toString(),streamIds:i,target:e,type:oi.StreamInvocation}:{arguments:t,invocationId:r.toString(),target:e,type:oi.StreamInvocation}}_createCancelInvocation(e){return{invocationId:e,type:oi.CancelInvocation}}_createStreamItemMessage(e,t){return{invocationId:e,item:t,type:oi.StreamItem}}_createCompletionMessage(e,t,i){return t?{error:t,invocationId:e,type:oi.Completion}:{invocationId:e,result:i,type:oi.Completion}}}class due{constructor(){this.name="json",this.version=1,this.transferFormat=Cs.Text}parseMessages(e,t){if("string"!=typeof e)throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!e)return[];null===t&&(t=l0.instance);const i=po.parse(e),r=[];for(const s of i){const o=JSON.parse(s);if("number"!=typeof o.type)throw new Error("Invalid payload.");switch(o.type){case oi.Invocation:this._isInvocationMessage(o);break;case oi.StreamItem:this._isStreamItemMessage(o);break;case oi.Completion:this._isCompletionMessage(o);break;case oi.Ping:case oi.Close:break;default:t.log(_e.Information,"Unknown message type '"+o.type+"' ignored.");continue}r.push(o)}return r}writeMessage(e){return po.write(JSON.stringify(e))}_isInvocationMessage(e){this._assertNotEmptyString(e.target,"Invalid payload for Invocation message."),void 0!==e.invocationId&&this._assertNotEmptyString(e.invocationId,"Invalid payload for Invocation message.")}_isStreamItemMessage(e){if(this._assertNotEmptyString(e.invocationId,"Invalid payload for StreamItem message."),void 0===e.item)throw new Error("Invalid payload for StreamItem message.")}_isCompletionMessage(e){if(e.result&&e.error)throw new Error("Invalid payload for Completion message.");!e.result&&e.error&&this._assertNotEmptyString(e.error,"Invalid payload for Completion message."),this._assertNotEmptyString(e.invocationId,"Invalid payload for Completion message.")}_assertNotEmptyString(e,t){if("string"!=typeof e||""===e)throw new Error(t)}}const hue={trace:_e.Trace,debug:_e.Debug,info:_e.Information,information:_e.Information,warn:_e.Warning,warning:_e.Warning,error:_e.Error,critical:_e.Critical,none:_e.None};class pue{configureLogging(e){if(Er.isRequired(e,"logging"),function mue(n){return void 0!==n.log}(e))this.logger=e;else if("string"==typeof e){const t=function fue(n){const e=hue[n.toLowerCase()];if(typeof e<"u")return e;throw new Error(`Unknown log level: ${n}`)}(e);this.logger=new pC(t)}else this.logger=new pC(e);return this}withUrl(e,t){return Er.isRequired(e,"url"),Er.isNotEmpty(e,"url"),this.url=e,this.httpConnectionOptions="object"==typeof t?{...this.httpConnectionOptions,...t}:{...this.httpConnectionOptions,transport:t},this}withHubProtocol(e){return Er.isRequired(e,"protocol"),this.protocol=e,this}withAutomaticReconnect(e){if(this.reconnectPolicy)throw new Error("A reconnectPolicy has already been set.");return this.reconnectPolicy=e?Array.isArray(e)?new $G(e):e:new $G,this}build(){const e=this.httpConnectionOptions||{};if(void 0===e.logger&&(e.logger=this.logger),!this.url)throw new Error("The 'HubConnectionBuilder.withUrl' method must be called before building the connection.");const t=new rue(this.url,e);return YP.create(t,this.logger||l0.instance,this.protocol||new due,this.reconnectPolicy)}}const d0={appVersion:Hh(147).i8,production:!0,serverURL:""};let h0=(()=>{class n{constructor(){}startConnection(t){this.hubConnection=(new pue).withUrl(d0.serverURL+"/notifications").withAutomaticReconnect().build(),this.hubConnection.start().then(()=>{console.log("Connection started"),this.hubConnection.send("SetConnectionIDUser",t)}).catch(i=>console.log("Error while starting connection: "+i))}executeAction(t,i,r,s,o,a){this.hubConnection.send("ExecuteAction",{gameId:t,playerId:i,itemId:r,actionId:s,dragTargetItemId:o,point:a})}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Qe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),pg=(()=>{class n{GenerateGuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const i=16*Math.random()|0;return("x"===t?i:3&i|8).toString(16)})}randomIntFromInterval(t,i){return Math.random()*(i-t+1)+t}deepEqual(t,i){const r=Object.keys(t),s=Object.keys(i);if(r.length!==s.length)return!1;for(const o of r){const a=t[o],l=i[o],c=this.isObject(a)&&this.isObject(l);if(c&&!this.deepEqual(a,l)||!c&&a!==l)return!1}return!0}isObject(t){return null!=t&&"object"==typeof t}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Qe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class gC{}class _C{}class ul{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?"string"==typeof e?this.lazyInit=()=>{this.headers=new Map,e.split("\n").forEach(t=>{const i=t.indexOf(":");if(i>0){const r=t.slice(0,i),s=r.toLowerCase(),o=t.slice(i+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,i)=>{this.setHeaderEntries(i,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,i])=>{this.setHeaderEntries(t,i)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof ul?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new ul;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof ul?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(e.name,t);const r=("a"===e.op?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":const s=e.value;if(s){let o=this.headers.get(t);if(!o)return;o=o.filter(a=>-1===s.indexOf(a)),0===o.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}else this.headers.delete(t),this.normalizedNames.delete(t)}}setHeaderEntries(e,t){const i=(Array.isArray(t)?t:[t]).map(s=>s.toString()),r=e.toLowerCase();this.headers.set(r,i),this.maybeSetNormalizedName(e,r)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class gue{encodeKey(e){return QG(e)}encodeValue(e){return QG(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const yue=/%(\d[a-f0-9])/gi,vue={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function QG(n){return encodeURIComponent(n).replace(yue,(e,t)=>vue[t]??e)}function yC(n){return`${n}`}class Hu{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new gue,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function _ue(n,e){const t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(r=>{const s=r.indexOf("="),[o,a]=-1==s?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,s)),e.decodeValue(r.slice(s+1))],l=t.get(o)||[];l.push(a),t.set(o,l)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const i=e.fromObject[t],r=Array.isArray(i)?i.map(yC):[yC(i)];this.map.set(t,r)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(i=>{const r=e[i];Array.isArray(r)?r.forEach(s=>{t.push({param:i,value:s,op:"a"})}):t.push({param:i,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new Hu({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(yC(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let i=this.map.get(e.param)||[];const r=i.indexOf(yC(e.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(e.param,i):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class wue{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function e5(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function t5(n){return typeof Blob<"u"&&n instanceof Blob}function n5(n){return typeof FormData<"u"&&n instanceof FormData}class f0{constructor(e,t,i,r){let s;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function bue(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,s=r):s=i,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new ul),this.context||(this.context=new wue),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=t;else{const a=t.indexOf("?");this.urlWithParams=t+(-1===a?"?":a<t.length-1?"&":"")+o}}else this.params=new Hu,this.urlWithParams=t}serializeBody(){return null===this.body?null:e5(this.body)||t5(this.body)||n5(this.body)||function xue(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Hu?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||n5(this.body)?null:t5(this.body)?this.body.type||null:e5(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Hu?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){const t=e.method||this.method,i=e.url||this.url,r=e.responseType||this.responseType,s=void 0!==e.body?e.body:this.body,o=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,a=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let l=e.headers||this.headers,c=e.params||this.params;const d=e.context??this.context;return void 0!==e.setHeaders&&(l=Object.keys(e.setHeaders).reduce((h,p)=>h.set(p,e.setHeaders[p]),l)),e.setParams&&(c=Object.keys(e.setParams).reduce((h,p)=>h.set(p,e.setParams[p]),c)),new f0(t,i,s,{params:c,headers:l,context:d,reportProgress:a,responseType:r,withCredentials:o})}}var mg=function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n}(mg||{});class KP{constructor(e,t=200,i="OK"){this.headers=e.headers||new ul,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class ZP extends KP{constructor(e={}){super(e),this.type=mg.ResponseHeader}clone(e={}){return new ZP({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class gg extends KP{constructor(e={}){super(e),this.type=mg.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new gg({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class i5 extends KP{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function JP(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let r5=(()=>{class n{constructor(t){this.handler=t}request(t,i,r={}){let s;if(t instanceof f0)s=t;else{let l,c;l=r.headers instanceof ul?r.headers:new ul(r.headers),r.params&&(c=r.params instanceof Hu?r.params:new Hu({fromObject:r.params})),s=new f0(t,i,void 0!==r.body?r.body:null,{headers:l,context:r.context,params:c,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const o=wt(s).pipe(em(l=>this.handler.handle(l)));if(t instanceof f0||"events"===r.observe)return o;const a=o.pipe(Kl(l=>l instanceof gg));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(tn(l=>{if(null!==l.body&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return a.pipe(tn(l=>{if(null!==l.body&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return a.pipe(tn(l=>{if(null!==l.body&&"string"!=typeof l.body)throw new Error("Response is not a string.");return l.body}));default:return a.pipe(tn(l=>l.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:(new Hu).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,r={}){return this.request("PATCH",t,JP(r,i))}post(t,i,r={}){return this.request("POST",t,JP(r,i))}put(t,i,r={}){return this.request("PUT",t,JP(r,i))}static#e=this.\u0275fac=function(i){return new(i||n)(Le(gC))};static#t=this.\u0275prov=Qe({token:n,factory:n.\u0275fac})}return n})();function a5(n,e){return e(n)}function Eue(n,e){return(t,i)=>e.intercept(t,{handle:r=>n(r,i)})}const Mue=new Ye(""),p0=new Ye(""),l5=new Ye("");function Tue(){let n=null;return(e,t)=>{null===n&&(n=(ze(Mue,{optional:!0})??[]).reduceRight(Eue,a5));const i=ze(Cx),r=i.add();return n(e,t).pipe(ov(()=>i.remove(r)))}}let c5=(()=>{class n extends gC{constructor(t,i){super(),this.backend=t,this.injector=i,this.chain=null,this.pendingTasks=ze(Cx)}handle(t){if(null===this.chain){const r=Array.from(new Set([...this.injector.get(p0),...this.injector.get(l5,[])]));this.chain=r.reduceRight((s,o)=>function Cue(n,e,t){return(i,r)=>t.runInContext(()=>e(i,s=>n(s,r)))}(s,o,this.injector),a5)}const i=this.pendingTasks.add();return this.chain(t,r=>this.backend.handle(r)).pipe(ov(()=>this.pendingTasks.remove(i)))}static#e=this.\u0275fac=function(i){return new(i||n)(Le(_C),Le(ms))};static#t=this.\u0275prov=Qe({token:n,factory:n.\u0275fac})}return n})();const Rue=/^\)\]\}',?\n/;let d5=(()=>{class n{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new ae(-2800,!1);const i=this.xhrFactory;return(i.\u0275loadImpl?vi(i.\u0275loadImpl()):wt(null)).pipe(As(()=>new Tn(s=>{const o=i.build();if(o.open(t.method,t.urlWithParams),t.withCredentials&&(o.withCredentials=!0),t.headers.forEach((v,w)=>o.setRequestHeader(v,w.join(","))),t.headers.has("Accept")||o.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const v=t.detectContentTypeHeader();null!==v&&o.setRequestHeader("Content-Type",v)}if(t.responseType){const v=t.responseType.toLowerCase();o.responseType="json"!==v?v:"text"}const a=t.serializeBody();let l=null;const c=()=>{if(null!==l)return l;const v=o.statusText||"OK",w=new ul(o.getAllResponseHeaders()),y=function Pue(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}(o)||t.url;return l=new ZP({headers:w,status:o.status,statusText:v,url:y}),l},d=()=>{let{headers:v,status:w,statusText:y,url:b}=c(),x=null;204!==w&&(x=typeof o.response>"u"?o.responseText:o.response),0===w&&(w=x?200:0);let E=w>=200&&w<300;if("json"===t.responseType&&"string"==typeof x){const C=x;x=x.replace(Rue,"");try{x=""!==x?JSON.parse(x):null}catch(A){x=C,E&&(E=!1,x={error:A,text:x})}}E?(s.next(new gg({body:x,headers:v,status:w,statusText:y,url:b||void 0})),s.complete()):s.error(new i5({error:x,headers:v,status:w,statusText:y,url:b||void 0}))},h=v=>{const{url:w}=c(),y=new i5({error:v,status:o.status||0,statusText:o.statusText||"Unknown Error",url:w||void 0});s.error(y)};let p=!1;const m=v=>{p||(s.next(c()),p=!0);let w={type:mg.DownloadProgress,loaded:v.loaded};v.lengthComputable&&(w.total=v.total),"text"===t.responseType&&o.responseText&&(w.partialText=o.responseText),s.next(w)},g=v=>{let w={type:mg.UploadProgress,loaded:v.loaded};v.lengthComputable&&(w.total=v.total),s.next(w)};return o.addEventListener("load",d),o.addEventListener("error",h),o.addEventListener("timeout",h),o.addEventListener("abort",h),t.reportProgress&&(o.addEventListener("progress",m),null!==a&&o.upload&&o.upload.addEventListener("progress",g)),o.send(a),s.next({type:mg.Sent}),()=>{o.removeEventListener("error",h),o.removeEventListener("abort",h),o.removeEventListener("load",d),o.removeEventListener("timeout",h),t.reportProgress&&(o.removeEventListener("progress",m),null!==a&&o.upload&&o.upload.removeEventListener("progress",g)),o.readyState!==o.DONE&&o.abort()}})))}static#e=this.\u0275fac=function(i){return new(i||n)(Le(MU))};static#t=this.\u0275prov=Qe({token:n,factory:n.\u0275fac})}return n})();const QP=new Ye("XSRF_ENABLED"),h5=new Ye("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),f5=new Ye("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class p5{}let Lue=(()=>{class n{constructor(t,i,r){this.doc=t,this.platform=i,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=gU(t,this.cookieName),this.lastCookieString=t),this.lastToken}static#e=this.\u0275fac=function(i){return new(i||n)(Le(qr),Le(Ya),Le(h5))};static#t=this.\u0275prov=Qe({token:n,factory:n.\u0275fac})}return n})();function Fue(n,e){const t=n.url.toLowerCase();if(!ze(QP)||"GET"===n.method||"HEAD"===n.method||t.startsWith("http://")||t.startsWith("https://"))return e(n);const i=ze(p5).getToken(),r=ze(f5);return null!=i&&!n.headers.has(r)&&(n=n.clone({headers:n.headers.set(r,i)})),e(n)}var zu=function(n){return n[n.Interceptors=0]="Interceptors",n[n.LegacyInterceptors=1]="LegacyInterceptors",n[n.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",n[n.NoXsrfProtection=3]="NoXsrfProtection",n[n.JsonpSupport=4]="JsonpSupport",n[n.RequestsMadeViaParent=5]="RequestsMadeViaParent",n[n.Fetch=6]="Fetch",n}(zu||{});function kue(...n){const e=[r5,d5,c5,{provide:gC,useExisting:c5},{provide:_C,useExisting:d5},{provide:p0,useValue:Fue,multi:!0},{provide:QP,useValue:!0},{provide:p5,useClass:Lue}];for(const t of n)e.push(...t.\u0275providers);return function ry(n){return{\u0275providers:n}}(e)}const m5=new Ye("LEGACY_INTERCEPTOR_FN");function Uue(){return function Ph(n,e){return{\u0275kind:n,\u0275providers:e}}(zu.LegacyInterceptors,[{provide:m5,useFactory:Tue},{provide:p0,useExisting:m5,multi:!0}])}let Bue=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Oi({type:n});static#n=this.\u0275inj=wi({providers:[kue(Uue())]})}return n})(),wC=(()=>{class n{constructor(t){this.http=t,this.baseGameUrl=d0.serverURL+"/api/Game",this.baseUserUrl=d0.serverURL+"/api/User"}login(t){return this.http.post(this.baseUserUrl+"/Login",{name:t})}getGameById(t){return this.http.get(this.baseGameUrl+`/GetGameByID?GameId=${t}`)}getGamesList(){return this.http.get(this.baseGameUrl+"/GetGamesList")}createGame(t,i){return this.http.post(this.baseGameUrl+"/CreateGame",{userId:t,gameType:i})}setupGame(t,i){return this.http.post(this.baseGameUrl+"/SetupGame",{gameId:t,userId:i})}startGame(t){return this.http.post(this.baseGameUrl+"/StartGame",{gameId:t})}deleteGame(t){return this.http.post(this.baseGameUrl+"/DeleteGame",{gameId:t})}executeAction(t,i,r,s,o,a){return this.http.post(this.baseGameUrl+"/ExecuteAction",{GameId:t,PlayerId:i,ActionId:r,ItemId:s,ClientX:o,ClientY:a})}joinGame(t,i,r,s){return this.http.post(this.baseGameUrl+"/JoinGame",{gameId:t,playerId:i,user:r,type:s})}static#e=this.\u0275fac=function(i){return new(i||n)(Le(r5))};static#t=this.\u0275prov=Qe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const jue=["rendererContainer"];function $ue(n,e){if(1&n){const t=Hl();St(0,"div",9)(1,"button",5),pn("click",function(){return Ir(t),or(rn().showDebug())}),bn(2,"DEBUG"),vt()()}}function que(n,e){1&n&&Up(0)}function Xue(n,e){1&n&&Up(0)}const eN=function(n){return{$implicit:n}};function Yue(n,e){if(1&n&&(St(0,"div",10),en(1,que,1,0,"ng-container",11),en(2,Xue,1,0,"ng-container",11),vt()),2&n){const t=rn(),i=Ay(10);mt(1),ut("ngTemplateOutlet",i)("ngTemplateOutletContext",Uy(4,eN,t.camera)),mt(1),ut("ngTemplateOutlet",i)("ngTemplateOutletContext",Uy(6,eN,t.scene))}}function Kue(n,e){1&n&&Up(0)}function Zue(n,e){if(1&n&&(St(0,"div",17),en(1,Kue,1,0,"ng-container",11),vt()),2&n){const t=e.$implicit;rn(2);const i=Ay(10);mt(1),ut("ngTemplateOutlet",i)("ngTemplateOutletContext",Uy(2,eN,t))}}function Jue(n,e){if(1&n){const t=Hl();bn(0),St(1,"i",12),pn("click",function(){const s=Ir(t).$implicit;return or(rn().onRemoveClick(s))}),vt(),Nr(2,"i",13)(3,"i",14)(4,"i",15),bn(5),function GF(n,e){const t=Qt();let i;const r=n+Bt;t.firstCreatePass?(i=function F$(n,e){if(e)for(let t=e.length-1;t>=0;t--){const i=e[t];if(n===i.name)return i}}(e,t.pipeRegistry),t.data[r]=i,i.onDestroy&&(t.destroyHooks??=[]).push(r,i.onDestroy)):i=t.data[r];const s=i.factory||(i.factory=Sl(i.type)),a=Un(ce);try{const l=Ui(!1),c=s();return Ui(l),function b8(n,e,t,i){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=i}(t,ge(),r,c),c}finally{Un(a)}}(6,"json"),en(7,Zue,2,4,"div",16)}if(2&n){const t=e.$implicit;J1(" ",rn().getAnyClass(t)," ",t.name," "),mt(5),Gd(" ",WF(6,4,t.position)," "),mt(2),ut("ngForOf",t.children)}}let Que=(()=>{class n{constructor(t,i,r,s,o,a){this.signalRService=t,this.router=i,this.generalService=r,this.activatedRoute=s,this.unsubscriberService=o,this.dalService=a,this.interactionObjects=[],this.objectUnselectedColor="red",this.objectSelectedColor="blue",this.allItems={},this.gameId="",this.debugObjects=[],this.onMeshClickFunc=this.MeshClickFunc.bind(this),this.onMeshMouseOverFunc=this.MeshMouseOverFunc.bind(this),this.onMeshMouseOutFunc=this.MeshMouseOutFunc.bind(this),this.currentSession=null,this.showDebugWindow=!1}ngOnInit(){this.gameId=this.activatedRoute.snapshot.paramMap.get("id"),console.log(this.gameId),this.signalRService.hubConnection.off("GameUpdated"),this.signalRService.hubConnection.on("GameUpdated",t=>{console.log("GameUpdated",t),this.updateGame(t)})}ngOnDestroy(){this.signalRService.hubConnection.off("GameUpdated")}ngAfterViewInit(){this.dalService.getGameById(this.gameId).subscribe(t=>{t?(this.gameData=t,this.playerData=this.getPlayerByUserId(this.generalService.User.id),this.initThree()):this.router.navigate([$s.GamesList])})}getPlayerByUserId(t){return(0,sg.find)(this.gameData.players,i=>i.user?.id==t)}updateGame(t){(0,sg.forEach)(this.allItems,(i,r)=>{i.markForDelete=!0}),this.updateItem(t.table,null),(0,sg.forEach)(this.allItems,(i,r)=>{i.markForDelete&&(this.removeAction(i),i.playType&&i.mesh.children[0].stop(),i.mesh?.parent?.remove(i.mesh),delete this.allItems[i.id])})}updateItem(t,i){let r=this.allItems[t.id];r?(r.markForDelete=!1,r.clickActions=t.clickActions,r.visible=t.visible,r.hoverActions=t.hoverActions,this.updateItemPosition(r,e0.FromJson(t.position)),this.updateItemScale(r,e0.FromJson(t.scale)),this.updateItemRotation(r,e0.FromJson(t.rotation)),this.updateItemText(r,t.text),(0,sg.forEach)(t.items,s=>{this.updateItem(s,r.mesh)}),this.handleItemClickActions(r),this.handleItemVisibility(r)):this.createItem(t,i)}updateItemPosition(t,i){t.position=i,this.generalService.deepEqual(i,t.mesh.position)||new KE(t.mesh.position).to(i,300).start()}updateItemScale(t,i){t.scale=i,this.generalService.deepEqual(i,t.mesh.scale)||new KE(t.mesh.scale).to(i,300).start()}updateItemRotation(t,i){t.rotation=i,i={x:Du_degToRad(i.x),y:Du_degToRad(i.y),z:Du_degToRad(i.z)},this.generalService.deepEqual(i,{x:t.mesh.rotation.x,y:t.mesh.rotation.y,z:t.mesh.rotation.z})||new KE(t.mesh.rotation).to(i,300).start()}updateItemText(t,i){"TEXTBLOCK"==t.asset&&(t.text=i,t.mesh.childrenTexts[0].set({content:i}))}resizeCanvasToDisplaySize(){const t=this.renderer.domElement,i=t.clientWidth,r=t.clientHeight;this.renderer.setSize(i,r,!1),this.camera.aspect=i/r,this.camera.updateProjectionMatrix()}initThree(){this.scene=new wE;const i=(new E4).load(["assets/skyboxes/afterrain/afterrain_ft.jpg","assets/skyboxes/afterrain/afterrain_bk.jpg","assets/skyboxes/afterrain/afterrain_up.jpg","assets/skyboxes/afterrain/afterrain_dn.jpg","assets/skyboxes/afterrain/afterrain_rt.jpg","assets/skyboxes/afterrain/afterrain_lf.jpg"]);this.scene.background=i,this.camera=new cr(75,this.rendererContainer.nativeElement.clientWidth/this.rendererContainer.nativeElement.clientHeight,.1,5e3),this.audioListener=new Tae,this.camera.add(this.audioListener),this.renderer=new xR({antialias:!0}),this.renderer.xr.enabled=!0,this.renderer.setSize(this.rendererContainer.nativeElement.clientWidth,this.rendererContainer.nativeElement.clientHeight),this.rendererContainer.nativeElement.appendChild(this.renderer.domElement),this.renderer.xr.addEventListener("sessionstart",()=>{this.renderer.xr.getCamera().position.copy(this.camera.position),this.renderer.xr.getCamera().lookAt(this.orbitControls.target)}),this.renderer.xr.addEventListener("sessionend",()=>{});const r=new _R(this.renderer);this.scene.environment=r.fromScene(new jle,0).texture,this.orbitControls=new Q4(this.camera,this.renderer.domElement),this.orbitControls.addEventListener("change",()=>{this.renderer.render(this.scene,this.camera)}),this.orbitControls.enableZoom=!0,this.orbitControls.update(),this.interactionManager=new Lce(this.renderer,this.camera,this.renderer.domElement),this.renderer.setAnimationLoop(()=>{Oce(),this.controllers&&this.controllers.forEach(s=>{this.handleController(s)}),this.orbitControls.update(),this.interactionManager.update(),this.renderer.render(this.scene,this.camera),cG()}),this.gltfLoader=new tG,this.stlLoader=new $le,this.objLoader=new Jle,this.textureLoader=new QR,this.fontLoader=new Qle,this.loadGame()}onSelectStart(t){console.log("onSelectStart",t)}onSelectEnd(t){console.log("onSelectEnd",t)}buildControllers(){const t=new Wle,i=(new Ot).setFromPoints([new N(0,0,0),new N(0,0,-1)]),r=new Qr(i);r.scale.z=10;const s=[];for(let o=0;o<2;o++){const a=this.renderer.xr.getController(o);a.add(r.clone()),a.userData.selectPressed=!1,a.userData.selectPressedPrev=!1,this.scene.add(a),s.push(a);const l=this.renderer.xr.getControllerGrip(o);l.add(t.createControllerModel(l)),this.scene.add(l)}return s}handleController(t){if(t.userData.selectPressed)if(t.userData.selectPressedPrev){if(this.selectedObject){const i=t.getWorldDirection(new N).multiplyScalar(this.selectedObjectDistance).negate();this.selectedObject.position.copy(t.position.clone().add(i))}}else{t.children[0].scale.z=10;const i=new Ct;i.extractRotation(t.matrixWorld);const r=new lP;r.ray.origin.setFromMatrixPosition(t.matrixWorld),r.ray.direction.set(0,0,-1).applyMatrix4(i);const s=r.intersectObjects(this.interactionObjects);s.length>0&&(t.children[0].scale.z=s[0].distance,this.selectedObject=s[0].object,this.selectedObject.material.color=this.objectSelectedColor,this.selectedObjectDistance=this.selectedObject.position.distanceTo(t.position))}else t.userData.selectPressedPrev&&(t.children[0].scale.z=10,null!=this.selectedObject&&(this.selectedObject.material.color=this.objectUnselectedColor,this.selectedObject=null));t.userData.selectPressedPrev=t.userData.selectPressed}createItem(t,i){if(t.asset){const r="\\assets\\games\\"+this.gameData.assets[t.asset].frontURL,s="\\assets\\games\\"+(this.gameData.assets[t.asset].backURL||this.gameData.assets[t.asset].frontURL),o=this.gameData.assets[t.asset].type;if("OBJECT"==o&&((r.toLowerCase().endsWith("glb")||r.toLowerCase().endsWith("gltf"))&&this.gltfLoader.load(r,a=>{this.processItem(t,a.scene,i)}),r.toLowerCase().endsWith("stl")&&this.stlLoader.load(r,a=>{const l=new Me(a);this.processItem(t,l,i)}),r.toLowerCase().endsWith("obj")&&this.objLoader.load(r,a=>{this.processItem(t,a,i)})),"TOKEN"==o&&this.textureLoader.load(r,a=>{let l=a.image.width/a.image.height,c=1,d=1/l;l<1&&(d=1,c=l);var h=[new Mi({color:16777215,opacity:.5,transparent:!0}),new Mi({color:16777215,opacity:.5,transparent:!0}),new Mi({map:a,transparent:!0}),new Mi({map:this.textureLoader.load(s),transparent:!0}),new Mi({color:16777215,opacity:.5,transparent:!0}),new Mi({color:16777215,opacity:.5,transparent:!0})];let p=new Me(new di(c,c/100,d),h);this.processItem(t,p,i)}),"TEXT3D"==o&&this.fontLoader.load("https://threejs.org/examples/fonts/helvetiker_regular.typeface.json",a=>{const l=new ice(t.text,{font:a,size:.5,height:.2,curveSegments:12,bevelEnabled:!0,bevelThickness:.03,bevelSize:.02,bevelOffset:0,bevelSegments:5});var c=new KR({color:16711680,specular:16777215});let d=new Me(l,c);this.processItem(t,d,i)}),"TEXTBLOCK"==o){const a=new Pce({bestFit:"auto",width:100,height:100,justifyContent:"center",textAlign:"center",fontFamily:"assets/fonts/Roboto-msdf.json",fontTexture:"assets/fonts/Roboto-msdf.png",fontColor:new We(0),backgroundOpacity:0}),l=new Nce({content:t.text});a.add(l),this.processItem(t,a,i)}if("SOUND"==o){const a=new Iae(this.audioListener);(new Eae).load(r,function(d){a.setBuffer(d),a.setLoop("LOOP"==t.playType),a.setVolume(1),a.play()});let c=new xa;c.add(a),this.processItem(t,c,i)}}else{const r=new xa;this.processItem(t,r,i)}}processItem(t,i,r){i.position.set(t.position.x,t.position.y,t.position.z),i.rotation.set(Du_degToRad(t.rotation.x),Du_degToRad(t.rotation.y),Du_degToRad(t.rotation.z)),i.scale.set(t.scale.x,t.scale.y,t.scale.z),r?r.add(i):this.scene.add(i),i.userData.ItemData=t,t.mesh=i,(0,sg.forEach)(t.items,s=>{this.createItem(s,i)}),this.handleItemClickActions(t),this.handleItemVisibility(t),this.allItems[t.id]=t}handleItemClickActions(t){let i=null;this.playerData&&(i=t.clickActions[this.playerData.id]||t.clickActions[""]),i?this.addClickAction(t,i):this.removeAction(t)}handleItemVisibility(t){let i=0==(0,sg.keys)(t.visible).length;this.playerData&&(i=i||1==t.visible[this.playerData.id]),t.mesh.visible=i,i||this.removeAction(t)}MeshClickFunc(t){this.playerData&&this.signalRService.executeAction(this.gameData.id,this.playerData.id,t.target.userData.ItemData.id,t.target.userData.ItemData.clickActions[this.playerData.id]||t.target.userData.ItemData.clickActions[""],"",t.point)}MeshMouseOverFunc(t){document.body.style.cursor="pointer",this.orbitControls.enabled=!1}MeshMouseOutFunc(t){document.body.style.cursor="default",this.orbitControls.enabled=!0}addClickAction(t,i){this.removeAction(t),t.mesh.addEventListener("click",this.onMeshClickFunc),t.mesh.addEventListener("mouseover",this.onMeshMouseOverFunc),t.mesh.addEventListener("mouseout",this.onMeshMouseOutFunc),this.interactionManager.add(t.mesh)}removeAction(t){t.mesh.removeEventListener("click",this.onMeshClickFunc),t.mesh.removeEventListener("click",this.onMeshMouseOverFunc),this.interactionManager.remove(t.mesh)}loadGame(){console.log("loadGame"),this.createItem(this.gameData.table,null),this.playerData?this.camera.position.set(this.playerData.camera.position.x,this.playerData.camera.position.y,this.playerData.camera.position.z):this.camera.position.set(this.gameData.observer.position.x,this.gameData.observer.position.y,this.gameData.observer.position.z)}ngOnChanges(t){}onVrClick(){var t=this;this.controllers=this.buildControllers(),this.controllers.forEach(r=>{r.addEventListener("selectstart",this.onSelectStart),r.addEventListener("selectend",this.onSelectEnd)}),window.navigator.xr.requestSession("immersive-vr",{optionalFeatures:["local-floor","bounded-floor","hand-tracking","layers"]}).then(function(){var r=On(function*(s){yield t.renderer.xr.setSession(s),t.currentSession=s});return function(s){return r.apply(this,arguments)}}())}loadDebugObjects(){this.debugObjects=[],this.scene.traverse(t=>{this.debugObjects.push(t),console.log(t)})}getAnyClass(t){return typeof t>"u"?"undefined":null===t?"null":t.constructor.name}onRemoveClick(t){t.removeFromParent()}showDebug(){this.showDebugWindow=!0}static#e=this.\u0275fac=function(i){return new(i||n)(ce(h0),ce(Or),ce(pg),ce(Jl),ce(ZE),ce(wC))};static#t=this.\u0275cmp=ir({type:n,selectors:[["app-game-play"]],viewQuery:function(i,r){if(1&i&&gA(jue,7),2&i){let s;zp(s=Gp())&&(r.rendererContainer=s.first)}},features:[Vn([ZE]),$i],decls:11,vars:2,consts:[[1,"main-div"],[2,"flex-shrink","0"],[2,"flex-grow","1","border","1px dashed red"],["rendererContainer",""],[2,"position","absolute","bottom","0","right","0"],[2,"width","100px","height","30px",3,"click"],["style","position: absolute;top: 0px;right: 0px;",4,"ngIf"],["style","position: absolute;top: 0px;right: 0px;width: 500px;height: 400px;background: red;overflow: auto;",4,"ngIf"],["tmpl",""],[2,"position","absolute","top","0px","right","0px"],[2,"position","absolute","top","0px","right","0px","width","500px","height","400px","background","red","overflow","auto"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"pi","pi-trash",2,"color","black","cursor","pointer",3,"click"],[1,"fa-solid","fa-crosshairs"],[1,"fa-solid","fa-hippo"],[1,"fa-solid","fa-eye"],["style","padding-left: 10px;",4,"ngFor","ngForOf"],[2,"padding-left","10px"]],template:function(i,r){1&i&&(St(0,"div",0),Nr(1,"div",1)(2,"div",2,3),vt(),St(4,"div",4)(5,"button",5),pn("click",function(){return r.onVrClick()}),bn(6,"VR"),vt()(),en(7,$ue,3,0,"div",6),en(8,Yue,3,8,"div",7),en(9,Jue,8,6,"ng-template",null,8,sk)),2&i&&(mt(7),ut("ngIf",r.scene),mt(1),ut("ngIf",r.scene&&r.showDebugWindow))},dependencies:[qy,Xp,Wx,xU],styles:[".main-div[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;height:100%;background:yellow}"]})}return n})(),bC=(()=>{class n{constructor(t,i){this.router=t,this.generalService=i}canActivate(){return!!this.generalService.User||(this.router.navigate([$s.Home]),!1)}static#e=this.\u0275fac=function(i){return new(i||n)(Le(Or),Le(pg))};static#t=this.\u0275prov=Qe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),ts=(()=>class n{static STARTS_WITH="startsWith";static CONTAINS="contains";static NOT_CONTAINS="notContains";static ENDS_WITH="endsWith";static EQUALS="equals";static NOT_EQUALS="notEquals";static IN="in";static LESS_THAN="lt";static LESS_THAN_OR_EQUAL_TO="lte";static GREATER_THAN="gt";static GREATER_THAN_OR_EQUAL_TO="gte";static BETWEEN="between";static IS="is";static IS_NOT="isNot";static BEFORE="before";static AFTER="after";static DATE_IS="dateIs";static DATE_IS_NOT="dateIsNot";static DATE_BEFORE="dateBefore";static DATE_AFTER="dateAfter"})(),tde=(()=>{class n{ripple=!1;overlayOptions={};filterMatchModeOptions={text:[ts.STARTS_WITH,ts.CONTAINS,ts.NOT_CONTAINS,ts.ENDS_WITH,ts.EQUALS,ts.NOT_EQUALS],numeric:[ts.EQUALS,ts.NOT_EQUALS,ts.LESS_THAN,ts.LESS_THAN_OR_EQUAL_TO,ts.GREATER_THAN,ts.GREATER_THAN_OR_EQUAL_TO],date:[ts.DATE_IS,ts.DATE_IS_NOT,ts.DATE_BEFORE,ts.DATE_AFTER]};translation={startsWith:"Starts with",contains:"Contains",notContains:"Not contains",endsWith:"Ends with",equals:"Equals",notEquals:"Not equals",noFilter:"No Filter",lt:"Less than",lte:"Less than or equal to",gt:"Greater than",gte:"Greater than or equal to",is:"Is",isNot:"Is not",before:"Before",after:"After",dateIs:"Date is",dateIsNot:"Date is not",dateBefore:"Date is before",dateAfter:"Date is after",clear:"Clear",apply:"Apply",matchAll:"Match All",matchAny:"Match Any",addRule:"Add Rule",removeRule:"Remove Rule",accept:"Yes",reject:"No",choose:"Choose",upload:"Upload",cancel:"Cancel",pending:"Pending",fileSizeTypes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],chooseYear:"Choose Year",chooseMonth:"Choose Month",chooseDate:"Choose Date",prevDecade:"Previous Decade",nextDecade:"Next Decade",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",prevHour:"Previous Hour",nextHour:"Next Hour",prevMinute:"Previous Minute",nextMinute:"Next Minute",prevSecond:"Previous Second",nextSecond:"Next Second",am:"am",pm:"pm",dateFormat:"mm/dd/yy",firstDayOfWeek:0,today:"Today",weekHeader:"Wk",weak:"Weak",medium:"Medium",strong:"Strong",passwordPrompt:"Enter a password",emptyMessage:"No results found",searchMessage:"{0} results are available",selectionMessage:"{0} items selected",emptySelectionMessage:"No selected item",emptySearchMessage:"No results found",emptyFilterMessage:"No results found",aria:{trueLabel:"True",falseLabel:"False",nullLabel:"Not Selected",star:"1 star",stars:"{star} stars",selectAll:"All items selected",unselectAll:"All items unselected",close:"Close",previous:"Previous",next:"Next",navigation:"Navigation",scrollTop:"Scroll Top",moveTop:"Move Top",moveUp:"Move Up",moveDown:"Move Down",moveBottom:"Move Bottom",moveToTarget:"Move to Target",moveToSource:"Move to Source",moveAllToTarget:"Move All to Target",moveAllToSource:"Move All to Source",pageLabel:"{page}",firstPageLabel:"First Page",lastPageLabel:"Last Page",nextPageLabel:"Next Page",prevPageLabel:"Previous Page",rowsPerPageLabel:"Rows per page",previousPageLabel:"Previous Page",jumpToPageDropdownLabel:"Jump to Page Dropdown",jumpToPageInputLabel:"Jump to Page Input",selectRow:"Row Selected",unselectRow:"Row Unselected",expandRow:"Row Expanded",collapseRow:"Row Collapsed",showFilterMenu:"Show Filter Menu",hideFilterMenu:"Hide Filter Menu",filterOperator:"Filter Operator",filterConstraint:"Filter Constraint",editRow:"Row Edit",saveEdit:"Save Edit",cancelEdit:"Cancel Edit",listView:"List View",gridView:"Grid View",slide:"Slide",slideNumber:"{slideNumber}",zoomImage:"Zoom Image",zoomIn:"Zoom In",zoomOut:"Zoom Out",rotateRight:"Rotate Right",rotateLeft:"Rotate Left"}};zIndex={modal:1100,overlay:1e3,menu:1e3,tooltip:1100};translationSource=new ss;translationObserver=this.translationSource.asObservable();getTranslation(t){return this.translation[t]}setTranslation(t){this.translation={...this.translation,...t},this.translationSource.next(this.translation)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Qe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),g5=(()=>{class n{template;type;name;constructor(t){this.template=t}getType(){return this.name}static \u0275fac=function(i){return new(i||n)(ce(el))};static \u0275dir=yt({type:n,selectors:[["","pTemplate",""]],inputs:{type:"type",name:["pTemplate","name"]}})}return n})(),tN=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=Oi({type:n});static \u0275inj=wi({imports:[Yp]})}return n})();class m0{static equals(e,t,i){return i?this.resolveFieldData(e,i)===this.resolveFieldData(t,i):this.equalsByValue(e,t)}static equalsByValue(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var s,o,a,i=Array.isArray(e),r=Array.isArray(t);if(i&&r){if((o=e.length)!=t.length)return!1;for(s=o;0!=s--;)if(!this.equalsByValue(e[s],t[s]))return!1;return!0}if(i!=r)return!1;var l=this.isDate(e),c=this.isDate(t);if(l!=c)return!1;if(l&&c)return e.getTime()==t.getTime();var d=e instanceof RegExp,h=t instanceof RegExp;if(d!=h)return!1;if(d&&h)return e.toString()==t.toString();var p=Object.keys(e);if((o=p.length)!==Object.keys(t).length)return!1;for(s=o;0!=s--;)if(!Object.prototype.hasOwnProperty.call(t,p[s]))return!1;for(s=o;0!=s--;)if(!this.equalsByValue(e[a=p[s]],t[a]))return!1;return!0}return e!=e&&t!=t}static resolveFieldData(e,t){if(e&&t){if(this.isFunction(t))return t(e);if(-1==t.indexOf("."))return e[t];{let i=t.split("."),r=e;for(let s=0,o=i.length;s<o;++s){if(null==r)return null;r=r[i[s]]}return r}}return null}static isFunction(e){return!!(e&&e.constructor&&e.call&&e.apply)}static reorderArray(e,t,i){e&&t!==i&&(i>=e.length&&(i%=e.length,t%=e.length),e.splice(i,0,e.splice(t,1)[0]))}static insertIntoOrderedArray(e,t,i,r){if(i.length>0){let s=!1;for(let o=0;o<i.length;o++)if(this.findIndexInList(i[o],r)>t){i.splice(o,0,e),s=!0;break}s||i.push(e)}else i.push(e)}static findIndexInList(e,t){let i=-1;if(t)for(let r=0;r<t.length;r++)if(t[r]==e){i=r;break}return i}static contains(e,t){if(null!=e&&t&&t.length)for(let i of t)if(this.equals(e,i))return!0;return!1}static removeAccents(e){return e&&e.search(/[\xC0-\xFF]/g)>-1&&(e=e.replace(/[\xC0-\xC5]/g,"A").replace(/[\xC6]/g,"AE").replace(/[\xC7]/g,"C").replace(/[\xC8-\xCB]/g,"E").replace(/[\xCC-\xCF]/g,"I").replace(/[\xD0]/g,"D").replace(/[\xD1]/g,"N").replace(/[\xD2-\xD6\xD8]/g,"O").replace(/[\xD9-\xDC]/g,"U").replace(/[\xDD]/g,"Y").replace(/[\xDE]/g,"P").replace(/[\xE0-\xE5]/g,"a").replace(/[\xE6]/g,"ae").replace(/[\xE7]/g,"c").replace(/[\xE8-\xEB]/g,"e").replace(/[\xEC-\xEF]/g,"i").replace(/[\xF1]/g,"n").replace(/[\xF2-\xF6\xF8]/g,"o").replace(/[\xF9-\xFC]/g,"u").replace(/[\xFE]/g,"p").replace(/[\xFD\xFF]/g,"y")),e}static isDate(e){return"[object Date]"===Object.prototype.toString.call(e)}static isEmpty(e){return null==e||""===e||Array.isArray(e)&&0===e.length||!this.isDate(e)&&"object"==typeof e&&0===Object.keys(e).length}static isNotEmpty(e){return!this.isEmpty(e)}static compare(e,t,i,r=1){let s=-1;const o=this.isEmpty(e),a=this.isEmpty(t);return s=o&&a?0:o?r:a?-r:"string"==typeof e&&"string"==typeof t?e.localeCompare(t,i,{numeric:!0}):e<t?-1:e>t?1:0,s}static sort(e,t,i=1,r,s=1){return(1===s?i:s)*m0.compare(e,t,r,i)}static merge(e,t){if(null!=e||null!=t)return null!=e&&"object"!=typeof e||null!=t&&"object"!=typeof t?null!=e&&"string"!=typeof e||null!=t&&"string"!=typeof t?t||e:[e||"",t||""].join(" "):{...e||{},...t||{}}}static isPrintableCharacter(e=""){return this.isNotEmpty(e)&&1===e.length&&e.match(/\S| /)}static getItemValue(e,...t){return this.isFunction(e)?e(...t):e}static findLastIndex(e,t){let i=-1;if(this.isNotEmpty(e))try{i=e.findLastIndex(t)}catch{i=e.lastIndexOf([...e].reverse().find(t))}return i}static findLast(e,t){let i;if(this.isNotEmpty(e))try{i=e.findLast(t)}catch{i=[...e].reverse().find(t)}return i}}var _5=0;!function ide(){let n=[];const r=s=>s&&parseInt(s.style.zIndex,10)||0}();const rde=["*"];let y5=(()=>{class n{label;spin=!1;styleClass;role;ariaLabel;ariaHidden;ngOnInit(){this.getAttributes()}getAttributes(){const t=m0.isEmpty(this.label);this.role=t?void 0:"img",this.ariaLabel=t?void 0:this.label,this.ariaHidden=t}getClassNames(){return`p-icon ${this.styleClass?this.styleClass+" ":""}${this.spin?"p-icon-spin":""}`}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=ir({type:n,selectors:[["ng-component"]],hostAttrs:[1,"p-element","p-icon-wrapper"],inputs:{label:"label",spin:"spin",styleClass:"styleClass"},standalone:!0,features:[ky],ngContentSelectors:rde,decls:1,vars:0,template:function(i,r){1&i&&(j1(),$1(0))},encapsulation:2,changeDetection:0})}return n})(),v5=(()=>{class n extends y5{pathId;ngOnInit(){this.pathId="url(#"+function nde(n="pn_id_"){return`${n}${++_5}`}()+")"}static \u0275fac=function(){let t;return function(r){return(t||(t=bi(n)))(r||n)}}();static \u0275cmp=ir({type:n,selectors:[["SpinnerIcon"]],standalone:!0,features:[wn,ky],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M6.99701 14C5.85441 13.999 4.72939 13.7186 3.72012 13.1832C2.71084 12.6478 1.84795 11.8737 1.20673 10.9284C0.565504 9.98305 0.165424 8.89526 0.041387 7.75989C-0.0826496 6.62453 0.073125 5.47607 0.495122 4.4147C0.917119 3.35333 1.59252 2.4113 2.46241 1.67077C3.33229 0.930247 4.37024 0.413729 5.4857 0.166275C6.60117 -0.0811796 7.76026 -0.0520535 8.86188 0.251112C9.9635 0.554278 10.9742 1.12227 11.8057 1.90555C11.915 2.01493 11.9764 2.16319 11.9764 2.31778C11.9764 2.47236 11.915 2.62062 11.8057 2.73C11.7521 2.78503 11.688 2.82877 11.6171 2.85864C11.5463 2.8885 11.4702 2.90389 11.3933 2.90389C11.3165 2.90389 11.2404 2.8885 11.1695 2.85864C11.0987 2.82877 11.0346 2.78503 10.9809 2.73C9.9998 1.81273 8.73246 1.26138 7.39226 1.16876C6.05206 1.07615 4.72086 1.44794 3.62279 2.22152C2.52471 2.99511 1.72683 4.12325 1.36345 5.41602C1.00008 6.70879 1.09342 8.08723 1.62775 9.31926C2.16209 10.5513 3.10478 11.5617 4.29713 12.1803C5.48947 12.7989 6.85865 12.988 8.17414 12.7157C9.48963 12.4435 10.6711 11.7264 11.5196 10.6854C12.3681 9.64432 12.8319 8.34282 12.8328 7C12.8328 6.84529 12.8943 6.69692 13.0038 6.58752C13.1132 6.47812 13.2616 6.41667 13.4164 6.41667C13.5712 6.41667 13.7196 6.47812 13.8291 6.58752C13.9385 6.69692 14 6.84529 14 7C14 8.85651 13.2622 10.637 11.9489 11.9497C10.6356 13.2625 8.85432 14 6.99701 14Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(i,r){1&i&&(kf(),St(0,"svg",0)(1,"g"),Nr(2,"path",1),vt(),St(3,"defs")(4,"clipPath",2),Nr(5,"rect",3),vt()()()),2&i&&(zl(r.getClassNames()),ui("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role),mt(1),ui("clip-path",r.pathId),mt(3),ut("id",r.pathId))},encapsulation:2})}return n})(),Ws=(()=>{class n{static zindex=1e3;static calculatedScrollbarWidth=null;static calculatedScrollbarHeight=null;static browser;static addClass(t,i){t&&i&&(t.classList?t.classList.add(i):t.className+=" "+i)}static addMultipleClasses(t,i){if(t&&i)if(t.classList){let r=i.trim().split(" ");for(let s=0;s<r.length;s++)t.classList.add(r[s])}else{let r=i.split(" ");for(let s=0;s<r.length;s++)t.className+=" "+r[s]}}static removeClass(t,i){t&&i&&(t.classList?t.classList.remove(i):t.className=t.className.replace(new RegExp("(^|\\b)"+i.split(" ").join("|")+"(\\b|$)","gi")," "))}static hasClass(t,i){return!(!t||!i)&&(t.classList?t.classList.contains(i):new RegExp("(^| )"+i+"( |$)","gi").test(t.className))}static siblings(t){return Array.prototype.filter.call(t.parentNode.children,function(i){return i!==t})}static find(t,i){return Array.from(t.querySelectorAll(i))}static findSingle(t,i){return this.isElement(t)?t.querySelector(i):null}static index(t){let i=t.parentNode.childNodes,r=0;for(var s=0;s<i.length;s++){if(i[s]==t)return r;1==i[s].nodeType&&r++}return-1}static indexWithinGroup(t,i){let r=t.parentNode?t.parentNode.childNodes:[],s=0;for(var o=0;o<r.length;o++){if(r[o]==t)return s;r[o].attributes&&r[o].attributes[i]&&1==r[o].nodeType&&s++}return-1}static appendOverlay(t,i,r="self"){"self"!==r&&t&&i&&this.appendChild(t,i)}static alignOverlay(t,i,r="self",s=!0){t&&i&&(s&&(t.style.minWidth=`${n.getOuterWidth(i)}px`),"self"===r?this.relativePosition(t,i):this.absolutePosition(t,i))}static relativePosition(t,i){const r=y=>{if(y)return"relative"===getComputedStyle(y).getPropertyValue("position")?y:r(y.parentElement)},s=t.offsetParent?{width:t.offsetWidth,height:t.offsetHeight}:this.getHiddenElementDimensions(t),o=i.offsetHeight,a=i.getBoundingClientRect(),l=this.getWindowScrollTop(),c=this.getWindowScrollLeft(),d=this.getViewport(),p=r(t)?.getBoundingClientRect()||{top:-1*l,left:-1*c};let m,g;a.top+o+s.height>d.height?(m=a.top-p.top-s.height,t.style.transformOrigin="bottom",a.top+m<0&&(m=-1*a.top)):(m=o+a.top-p.top,t.style.transformOrigin="top");const v=a.left+s.width-d.width;g=s.width>d.width?-1*(a.left-p.left):v>0?a.left-p.left-v:a.left-p.left,t.style.top=m+"px",t.style.left=g+"px"}static absolutePosition(t,i){const r=t.offsetParent?{width:t.offsetWidth,height:t.offsetHeight}:this.getHiddenElementDimensions(t),s=r.height,o=r.width,a=i.offsetHeight,l=i.offsetWidth,c=i.getBoundingClientRect(),d=this.getWindowScrollTop(),h=this.getWindowScrollLeft(),p=this.getViewport();let m,g;c.top+a+s>p.height?(m=c.top+d-s,t.style.transformOrigin="bottom",m<0&&(m=d)):(m=a+c.top+d,t.style.transformOrigin="top"),g=c.left+o>p.width?Math.max(0,c.left+h+l-o):c.left+h,t.style.top=m+"px",t.style.left=g+"px"}static getParents(t,i=[]){return null===t.parentNode?i:this.getParents(t.parentNode,i.concat([t.parentNode]))}static getScrollableParents(t){let i=[];if(t){let r=this.getParents(t);const s=/(auto|scroll)/,o=a=>{let l=window.getComputedStyle(a,null);return s.test(l.getPropertyValue("overflow"))||s.test(l.getPropertyValue("overflowX"))||s.test(l.getPropertyValue("overflowY"))};for(let a of r){let l=1===a.nodeType&&a.dataset.scrollselectors;if(l){let c=l.split(",");for(let d of c){let h=this.findSingle(a,d);h&&o(h)&&i.push(h)}}9!==a.nodeType&&o(a)&&i.push(a)}}return i}static getHiddenElementOuterHeight(t){t.style.visibility="hidden",t.style.display="block";let i=t.offsetHeight;return t.style.display="none",t.style.visibility="visible",i}static getHiddenElementOuterWidth(t){t.style.visibility="hidden",t.style.display="block";let i=t.offsetWidth;return t.style.display="none",t.style.visibility="visible",i}static getHiddenElementDimensions(t){let i={};return t.style.visibility="hidden",t.style.display="block",i.width=t.offsetWidth,i.height=t.offsetHeight,t.style.display="none",t.style.visibility="visible",i}static scrollInView(t,i){let r=getComputedStyle(t).getPropertyValue("borderTopWidth"),s=r?parseFloat(r):0,o=getComputedStyle(t).getPropertyValue("paddingTop"),a=o?parseFloat(o):0,l=t.getBoundingClientRect(),d=i.getBoundingClientRect().top+document.body.scrollTop-(l.top+document.body.scrollTop)-s-a,h=t.scrollTop,p=t.clientHeight,m=this.getOuterHeight(i);d<0?t.scrollTop=h+d:d+m>p&&(t.scrollTop=h+d-p+m)}static fadeIn(t,i){t.style.opacity=0;let r=+new Date,s=0,o=function(){s=+t.style.opacity.replace(",",".")+((new Date).getTime()-r)/i,t.style.opacity=s,r=+new Date,+s<1&&(window.requestAnimationFrame&&requestAnimationFrame(o)||setTimeout(o,16))};o()}static fadeOut(t,i){var r=1,a=50/i;let l=setInterval(()=>{(r-=a)<=0&&(r=0,clearInterval(l)),t.style.opacity=r},50)}static getWindowScrollTop(){let t=document.documentElement;return(window.pageYOffset||t.scrollTop)-(t.clientTop||0)}static getWindowScrollLeft(){let t=document.documentElement;return(window.pageXOffset||t.scrollLeft)-(t.clientLeft||0)}static matches(t,i){var r=Element.prototype;return(r.matches||r.webkitMatchesSelector||r.mozMatchesSelector||r.msMatchesSelector||function(o){return-1!==[].indexOf.call(document.querySelectorAll(o),this)}).call(t,i)}static getOuterWidth(t,i){let r=t.offsetWidth;if(i){let s=getComputedStyle(t);r+=parseFloat(s.marginLeft)+parseFloat(s.marginRight)}return r}static getHorizontalPadding(t){let i=getComputedStyle(t);return parseFloat(i.paddingLeft)+parseFloat(i.paddingRight)}static getHorizontalMargin(t){let i=getComputedStyle(t);return parseFloat(i.marginLeft)+parseFloat(i.marginRight)}static innerWidth(t){let i=t.offsetWidth,r=getComputedStyle(t);return i+=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight),i}static width(t){let i=t.offsetWidth,r=getComputedStyle(t);return i-=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight),i}static getInnerHeight(t){let i=t.offsetHeight,r=getComputedStyle(t);return i+=parseFloat(r.paddingTop)+parseFloat(r.paddingBottom),i}static getOuterHeight(t,i){let r=t.offsetHeight;if(i){let s=getComputedStyle(t);r+=parseFloat(s.marginTop)+parseFloat(s.marginBottom)}return r}static getHeight(t){let i=t.offsetHeight,r=getComputedStyle(t);return i-=parseFloat(r.paddingTop)+parseFloat(r.paddingBottom)+parseFloat(r.borderTopWidth)+parseFloat(r.borderBottomWidth),i}static getWidth(t){let i=t.offsetWidth,r=getComputedStyle(t);return i-=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight)+parseFloat(r.borderLeftWidth)+parseFloat(r.borderRightWidth),i}static getViewport(){let t=window,i=document,r=i.documentElement,s=i.getElementsByTagName("body")[0];return{width:t.innerWidth||r.clientWidth||s.clientWidth,height:t.innerHeight||r.clientHeight||s.clientHeight}}static getOffset(t){var i=t.getBoundingClientRect();return{top:i.top+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0),left:i.left+(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0)}}static replaceElementWith(t,i){let r=t.parentNode;if(!r)throw"Can't replace element";return r.replaceChild(i,t)}static getUserAgent(){if(navigator&&this.isClient())return navigator.userAgent}static isIE(){var t=window.navigator.userAgent;return t.indexOf("MSIE ")>0||(t.indexOf("Trident/")>0?(t.indexOf("rv:"),!0):t.indexOf("Edge/")>0)}static isIOS(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream}static isAndroid(){return/(android)/i.test(navigator.userAgent)}static isTouchDevice(){return"ontouchstart"in window||navigator.maxTouchPoints>0}static appendChild(t,i){if(this.isElement(i))i.appendChild(t);else{if(!(i&&i.el&&i.el.nativeElement))throw"Cannot append "+i+" to "+t;i.el.nativeElement.appendChild(t)}}static removeChild(t,i){if(this.isElement(i))i.removeChild(t);else{if(!i.el||!i.el.nativeElement)throw"Cannot remove "+t+" from "+i;i.el.nativeElement.removeChild(t)}}static removeElement(t){"remove"in Element.prototype?t.remove():t.parentNode.removeChild(t)}static isElement(t){return"object"==typeof HTMLElement?t instanceof HTMLElement:t&&"object"==typeof t&&null!==t&&1===t.nodeType&&"string"==typeof t.nodeName}static calculateScrollbarWidth(t){if(t){let i=getComputedStyle(t);return t.offsetWidth-t.clientWidth-parseFloat(i.borderLeftWidth)-parseFloat(i.borderRightWidth)}{if(null!==this.calculatedScrollbarWidth)return this.calculatedScrollbarWidth;let i=document.createElement("div");i.className="p-scrollbar-measure",document.body.appendChild(i);let r=i.offsetWidth-i.clientWidth;return document.body.removeChild(i),this.calculatedScrollbarWidth=r,r}}static calculateScrollbarHeight(){if(null!==this.calculatedScrollbarHeight)return this.calculatedScrollbarHeight;let t=document.createElement("div");t.className="p-scrollbar-measure",document.body.appendChild(t);let i=t.offsetHeight-t.clientHeight;return document.body.removeChild(t),this.calculatedScrollbarWidth=i,i}static invokeElementMethod(t,i,r){t[i].apply(t,r)}static clearSelection(){if(window.getSelection)window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().rangeCount>0&&window.getSelection().getRangeAt(0).getClientRects().length>0&&window.getSelection().removeAllRanges();else if(document.selection&&document.selection.empty)try{document.selection.empty()}catch{}}static getBrowser(){if(!this.browser){let t=this.resolveUserAgent();this.browser={},t.browser&&(this.browser[t.browser]=!0,this.browser.version=t.version),this.browser.chrome?this.browser.webkit=!0:this.browser.webkit&&(this.browser.safari=!0)}return this.browser}static resolveUserAgent(){let t=navigator.userAgent.toLowerCase(),i=/(chrome)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[];return{browser:i[1]||"",version:i[2]||"0"}}static isInteger(t){return Number.isInteger?Number.isInteger(t):"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}static isHidden(t){return!t||null===t.offsetParent}static isVisible(t){return t&&null!=t.offsetParent}static isExist(t){return null!==t&&typeof t<"u"&&t.nodeName&&t.parentNode}static focus(t,i){t&&document.activeElement!==t&&t.focus(i)}static getFocusableElements(t){let i=n.find(t,'button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),\n                [href]:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),\n                input:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]), select:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),\n                textarea:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]), [tabIndex]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),\n                [contenteditable]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]):not(.p-disabled)'),r=[];for(let s of i)(s.offsetWidth||s.offsetHeight||s.getClientRects().length)&&r.push(s);return r}static getNextFocusableElement(t,i=!1){const r=n.getFocusableElements(t);let s=0;if(r&&r.length>0){const o=r.indexOf(r[0].ownerDocument.activeElement);i?s=-1==o||0===o?r.length-1:o-1:-1!=o&&o!==r.length-1&&(s=o+1)}return r[s]}static generateZIndex(){return this.zindex=this.zindex||999,++this.zindex}static getSelection(){return window.getSelection?window.getSelection().toString():document.getSelection?document.getSelection().toString():document.selection?document.selection.createRange().text:null}static getTargetElement(t,i){if(!t)return null;switch(t){case"document":return document;case"window":return window;case"@next":return i?.nextElementSibling;case"@prev":return i?.previousElementSibling;case"@parent":return i?.parentElement;case"@grandparent":return i?.parentElement.parentElement;default:const r=typeof t;if("string"===r)return document.querySelector(t);if("object"===r&&t.hasOwnProperty("nativeElement"))return this.isExist(t.nativeElement)?t.nativeElement:void 0;const o=(a=t)&&a.constructor&&a.call&&a.apply?t():t;return o&&9===o.nodeType||this.isExist(o)?o:null}var a}static isClient(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}static getAttribute(t,i){if(t){const r=t.getAttribute(i);return isNaN(r)?"true"===r||"false"===r?"true"===r:r:+r}}static calculateBodyScrollbarWidth(){return window.innerWidth-document.documentElement.offsetWidth}static blockBodyScroll(t="p-overflow-hidden"){document.body.style.setProperty("--scrollbar-width",this.calculateBodyScrollbarWidth()+"px"),this.addClass(document.body,t)}static unblockBodyScroll(t="p-overflow-hidden"){document.body.style.removeProperty("--scrollbar-width"),this.removeClass(document.body,t)}}return n})(),sde=(()=>{class n{document;platformId;renderer;el;zone;config;constructor(t,i,r,s,o,a){this.document=t,this.platformId=i,this.renderer=r,this.el=s,this.zone=o,this.config=a}animationListener;mouseDownListener;timeout;ngAfterViewInit(){(function iX(n){return n===EU})(this.platformId)&&this.config&&this.config.ripple&&this.zone.runOutsideAngular(()=>{this.create(),this.mouseDownListener=this.renderer.listen(this.el.nativeElement,"mousedown",this.onMouseDown.bind(this))})}onMouseDown(t){let i=this.getInk();if(!i||"none"===this.document.defaultView?.getComputedStyle(i,null).display)return;if(Ws.removeClass(i,"p-ink-active"),!Ws.getHeight(i)&&!Ws.getWidth(i)){let a=Math.max(Ws.getOuterWidth(this.el.nativeElement),Ws.getOuterHeight(this.el.nativeElement));i.style.height=a+"px",i.style.width=a+"px"}let r=Ws.getOffset(this.el.nativeElement),s=t.pageX-r.left+this.document.body.scrollTop-Ws.getWidth(i)/2,o=t.pageY-r.top+this.document.body.scrollLeft-Ws.getHeight(i)/2;this.renderer.setStyle(i,"top",o+"px"),this.renderer.setStyle(i,"left",s+"px"),Ws.addClass(i,"p-ink-active"),this.timeout=setTimeout(()=>{let a=this.getInk();a&&Ws.removeClass(a,"p-ink-active")},401)}getInk(){const t=this.el.nativeElement.children;for(let i=0;i<t.length;i++)if("string"==typeof t[i].className&&-1!==t[i].className.indexOf("p-ink"))return t[i];return null}resetInk(){let t=this.getInk();t&&Ws.removeClass(t,"p-ink-active")}onAnimationEnd(t){this.timeout&&clearTimeout(this.timeout),Ws.removeClass(t.currentTarget,"p-ink-active")}create(){let t=this.renderer.createElement("span");this.renderer.addClass(t,"p-ink"),this.renderer.appendChild(this.el.nativeElement,t),this.renderer.setAttribute(t,"aria-hidden","true"),this.renderer.setAttribute(t,"role","presentation"),this.animationListener||(this.animationListener=this.renderer.listen(t,"animationend",this.onAnimationEnd.bind(this)))}remove(){let t=this.getInk();t&&(this.mouseDownListener&&this.mouseDownListener(),this.animationListener&&this.animationListener(),this.mouseDownListener=null,this.animationListener=null,Ws.removeElement(t))}ngOnDestroy(){this.config&&this.config.ripple&&this.remove()}static \u0275fac=function(i){return new(i||n)(ce(qr),ce(Ya),ce(Si),ce(Cn),ce(Dn),ce(tde,8))};static \u0275dir=yt({type:n,selectors:[["","pRipple",""]],hostAttrs:[1,"p-ripple","p-element"]})}return n})(),ode=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=Oi({type:n});static \u0275inj=wi({imports:[Yp]})}return n})();function ade(n,e){1&n&&Up(0)}function lde(n,e){if(1&n&&Nr(0,"span",8),2&n){const t=rn(3);zl("p-button-loading-icon pi-spin "+t.loadingIcon),ut("ngClass",t.iconClass()),ui("aria-hidden",!0)("data-pc-section","loadingicon")}}function cde(n,e){1&n&&Nr(0,"SpinnerIcon",9),2&n&&(ut("styleClass",rn(3).spinnerIconClass())("spin",!0),ui("aria-hidden",!0)("data-pc-section","loadingicon"))}function ude(n,e){if(1&n&&(du(0),en(1,lde,1,5,"span",6),en(2,cde,1,4,"SpinnerIcon",7),hu()),2&n){const t=rn(2);mt(1),ut("ngIf",t.loadingIcon),mt(1),ut("ngIf",!t.loadingIcon)}}function dde(n,e){}function hde(n,e){1&n&&en(0,dde,0,0,"ng-template")}function fde(n,e){if(1&n&&(St(0,"span",10),en(1,hde,1,0,null,1),vt()),2&n){const t=rn(2);ut("ngClass",t.iconClass()),ui("aria-hidden",!0)("data-pc-section","loadingicon"),mt(1),ut("ngTemplateOutlet",t.loadingIconTemplate)}}function pde(n,e){if(1&n&&(du(0),en(1,ude,3,2,"ng-container",2),en(2,fde,2,4,"span",5),hu()),2&n){const t=rn();mt(1),ut("ngIf",!t.loadingIconTemplate),mt(1),ut("ngIf",t.loadingIconTemplate)}}function mde(n,e){if(1&n&&Nr(0,"span",8),2&n){const t=rn(2);zl(t.icon),ut("ngClass",t.iconClass()),ui("data-pc-section","icon")}}function gde(n,e){}function _de(n,e){1&n&&en(0,gde,0,0,"ng-template",12),2&n&&ut("ngIf",!rn(3).icon)}function yde(n,e){if(1&n&&(St(0,"span",8),en(1,_de,1,1,null,1),vt()),2&n){const t=rn(2);ut("ngClass",t.iconClass()),ui("data-pc-section","icon"),mt(1),ut("ngTemplateOutlet",t.iconTemplate)}}function vde(n,e){if(1&n&&(du(0),en(1,mde,1,4,"span",6),en(2,yde,2,3,"span",11),hu()),2&n){const t=rn();mt(1),ut("ngIf",t.icon&&!t.iconTemplate),mt(1),ut("ngIf",!t.icon&&t.iconTemplate)}}function wde(n,e){if(1&n&&(St(0,"span",13),bn(1),vt()),2&n){const t=rn();ui("aria-hidden",t.icon&&!t.label)("data-pc-section","label"),mt(1),Gl(t.label)}}function bde(n,e){if(1&n&&(St(0,"span",8),bn(1),vt()),2&n){const t=rn();zl(t.badgeClass),ut("ngClass",t.badgeStyleClass()),ui("data-pc-section","badge"),mt(1),Gl(t.badge)}}const xde=["*"];let nN=(()=>{class n{type="button";iconPos="left";icon;badge;label;disabled;loading=!1;loadingIcon;raised=!1;rounded=!1;text=!1;plain=!1;severity;outlined=!1;link=!1;size;style;styleClass;badgeClass;ariaLabel;onClick=new Yn;onFocus=new Yn;onBlur=new Yn;contentTemplate;loadingIconTemplate;iconTemplate;templates;spinnerIconClass(){return Object.entries(this.iconClass()).filter(([,t])=>!!t).reduce((t,[i])=>t+` ${i}`,"p-button-loading-icon")}iconClass(){return{"p-button-icon":!0,"p-button-icon-left":"left"===this.iconPos&&this.label,"p-button-icon-right":"right"===this.iconPos&&this.label,"p-button-icon-top":"top"===this.iconPos&&this.label,"p-button-icon-bottom":"bottom"===this.iconPos&&this.label}}buttonClass(){return{"p-button p-component":!0,"p-button-icon-only":(this.icon||this.iconTemplate||this.loadingIcon||this.loadingIconTemplate)&&!this.label,"p-button-vertical":("top"===this.iconPos||"bottom"===this.iconPos)&&this.label,"p-disabled":this.disabled||this.loading,"p-button-loading":this.loading,"p-button-loading-label-only":this.loading&&!this.icon&&this.label&&!this.loadingIcon&&"left"===this.iconPos,"p-button-link":this.link,[`p-button-${this.severity}`]:this.severity,"p-button-raised":this.raised,"p-button-rounded":this.rounded,"p-button-text":this.text,"p-button-outlined":this.outlined,"p-button-sm":"small"===this.size,"p-button-lg":"large"===this.size,"p-button-plain":this.plain}}ngAfterContentInit(){this.templates?.forEach(t=>{switch(t.getType()){case"content":default:this.contentTemplate=t.template;break;case"icon":this.iconTemplate=t.template;break;case"loadingicon":this.loadingIconTemplate=t.template}})}badgeStyleClass(){return{"p-badge p-component":!0,"p-badge-no-gutter":this.badge&&1===String(this.badge).length}}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=ir({type:n,selectors:[["p-button"]],contentQueries:function(i,r,s){if(1&i&&Sx(s,g5,4),2&i){let o;zp(o=Gp())&&(r.templates=o)}},hostAttrs:[1,"p-element"],hostVars:2,hostBindings:function(i,r){2&i&&Iy("p-disabled",r.disabled)},inputs:{type:"type",iconPos:"iconPos",icon:"icon",badge:"badge",label:"label",disabled:"disabled",loading:"loading",loadingIcon:"loadingIcon",raised:"raised",rounded:"rounded",text:"text",plain:"plain",severity:"severity",outlined:"outlined",link:"link",size:"size",style:"style",styleClass:"styleClass",badgeClass:"badgeClass",ariaLabel:"ariaLabel"},outputs:{onClick:"onClick",onFocus:"onFocus",onBlur:"onBlur"},ngContentSelectors:xde,decls:7,vars:14,consts:[["pRipple","",3,"ngStyle","disabled","ngClass","click","focus","blur"],[4,"ngTemplateOutlet"],[4,"ngIf"],["class","p-button-label",4,"ngIf"],[3,"ngClass","class",4,"ngIf"],["class","p-button-loading-icon",3,"ngClass",4,"ngIf"],[3,"class","ngClass",4,"ngIf"],[3,"styleClass","spin",4,"ngIf"],[3,"ngClass"],[3,"styleClass","spin"],[1,"p-button-loading-icon",3,"ngClass"],[3,"ngClass",4,"ngIf"],[3,"ngIf"],[1,"p-button-label"]],template:function(i,r){1&i&&(j1(),St(0,"button",0),pn("click",function(o){return r.onClick.emit(o)})("focus",function(o){return r.onFocus.emit(o)})("blur",function(o){return r.onBlur.emit(o)}),$1(1),en(2,ade,1,0,"ng-container",1),en(3,pde,3,2,"ng-container",2),en(4,vde,3,2,"ng-container",2),en(5,wde,2,3,"span",3),en(6,bde,2,5,"span",4),vt()),2&i&&(zl(r.styleClass),ut("ngStyle",r.style)("disabled",r.disabled||r.loading)("ngClass",r.buttonClass()),ui("type",r.type)("aria-label",r.ariaLabel)("data-pc-name","button")("data-pc-section","root"),mt(2),ut("ngTemplateOutlet",r.contentTemplate),mt(1),ut("ngIf",r.loading),mt(1),ut("ngIf",!r.loading),mt(1),ut("ngIf",!r.contentTemplate&&r.label),mt(1),ut("ngIf",!r.contentTemplate&&r.badge))},dependencies:function(){return[Gx,Xp,Wx,QA,sde,v5]},encapsulation:2,changeDetection:0})}return n})(),Sde=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=Oi({type:n});static \u0275inj=wi({imports:[Yp,ode,tN,v5,tN]})}return n})(),Ede=(()=>{class n{constructor(t,i,r,s,o){this.router=t,this.generalService=i,this.signalRService=r,this.activatedRoute=s,this.dalService=o,this.usernameModel="",this.usernameModel=i.User?i.User.name:""}ngAfterViewInit(){}ngOnChanges(t){}ngOnDestroy(){}ngOnInit(){}login(){this.dalService.login(this.usernameModel).subscribe(t=>{this.generalService.User=t,this.signalRService.startConnection(this.generalService.User.id),localStorage.setItem("user",JSON.stringify(t)),this.router.navigate([$s.GamesList])})}static#e=this.\u0275fac=function(i){return new(i||n)(ce(Or),ce(pg),ce(h0),ce(Jl),ce(wC))};static#t=this.\u0275cmp=ir({type:n,selectors:[["app-home-view"]],features:[$i],decls:5,vars:1,consts:[[1,"home-view"],[1,"title"],[1,"username-input",3,"ngModel","ngModelChange"],["styleClass","p-button-lg","icon","pi pi-user","label","LOGIN",3,"onClick"]],template:function(i,r){1&i&&(St(0,"div",0)(1,"div",1),bn(2,"MG X"),vt(),St(3,"input",2),pn("ngModelChange",function(o){return r.usernameModel=o}),vt(),St(4,"p-button",3),pn("onClick",function(){return r.login()}),vt()()),2&i&&(mt(3),ut("ngModel",r.usernameModel))},dependencies:[lS,rB,ZD,nN],styles:[".home-view[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column;justify-content:center;align-items:center}.home-view[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:70px;margin-bottom:30px;font-weight:700}.home-view[_ngcontent-%COMP%]   .username-input[_ngcontent-%COMP%]{font-size:30px;margin-bottom:30px}"]})}return n})();function Cde(n,e){if(1&n){const t=Hl();St(0,"div",4)(1,"div"),bn(2),vt(),St(3,"div"),bn(4),vt(),St(5,"div"),bn(6),vt(),St(7,"p-button",5),pn("onClick",function(){const s=Ir(t).$implicit;return or(rn().setup(s))}),bn(8,"settings"),vt(),St(9,"p-button",6),pn("onClick",function(){const s=Ir(t).$implicit;return or(rn().delete(s))}),bn(10,"DELETE"),vt()()}if(2&n){const t=e.$implicit;mt(2),Gd("",t.name," "),mt(2),Gd("",t.gameStatus," "),mt(2),Gd("",t.gameType," ")}}let Mde=(()=>{class n{constructor(t,i,r,s){this.signalRService=t,this.router=i,this.generalService=r,this.dalService=s,this.games=[]}ngOnInit(){this.user=this.generalService.User,this.updateGamesList(),this.signalRService.hubConnection.on("GamesUpdated",t=>{console.log("GamesUpdated",t),this.updateGamesList()}),this.signalRService.hubConnection.on("GameDeleted",t=>{console.log("GameDeleted",t),this.updateGamesList()})}ngAfterViewInit(){}ngOnChanges(t){}ngOnDestroy(){}updateGamesList(){this.dalService.getGamesList().subscribe(t=>{this.games=t})}createGame(t){this.dalService.createGame(this.user.id,t).subscribe()}setup(t){this.router.navigate([$s.GameSetup,t.id])}delete(t){this.dalService.deleteGame(t.id).subscribe()}static#e=this.\u0275fac=function(i){return new(i||n)(ce(h0),ce(Or),ce(pg),ce(wC))};static#t=this.\u0275cmp=ir({type:n,selectors:[["app-games-list"]],features:[$i],decls:13,vars:2,consts:[[2,"font-size","20px"],["class","mg-row-center","style","margin:10px;column-gap: 10px;border: 1px solid black;",4,"ngFor","ngForOf"],[1,"mg-row-center",2,"column-gap","10px"],["severity","secondary",3,"onClick"],[1,"mg-row-center",2,"margin","10px","column-gap","10px","border","1px solid black"],["severity","warning",3,"onClick"],["severity","danger",3,"onClick"]],template:function(i,r){1&i&&(St(0,"div")(1,"div",0),bn(2,"Hello "),St(3,"b"),bn(4),vt()(),en(5,Cde,11,3,"div",1),St(6,"div",2)(7,"p-button",3),pn("onClick",function(){return r.createGame("TIK_TAK_TOE")}),bn(8,"create game TIK_TAK_TOE"),vt(),St(9,"p-button",3),pn("onClick",function(){return r.createGame("CHESS")}),bn(10,"create game CHESS"),vt(),St(11,"p-button",3),pn("onClick",function(){return r.createGame("DND")}),bn(12,"create game DnD"),vt()()()),2&i&&(mt(4),Gl(r.user.name),mt(1),ut("ngForOf",r.games))},dependencies:[qy,nN]})}return n})();function Tde(n,e){1&n&&Nr(0,"div",9)}function Ade(n,e){if(1&n&&(St(0,"span",10),bn(1),vt()),2&n){const t=rn().$implicit;mt(1),Gl(t.description)}}function Dde(n,e){if(1&n&&(St(0,"section",11),Nr(1,"ngx-json-viewer",12),vt()),2&n){const t=rn().$implicit,i=rn();mt(1),ut("json",t.value)("expanded",i.expanded)("depth",i.depth)("_currentDepth",i._currentDepth+1)}}const Ide=function(n){return["segment",n]},Rde=function(n,e){return{"segment-main":!0,expandable:n,expanded:e}};function Pde(n,e){if(1&n){const t=Hl();St(0,"section",2)(1,"section",3),pn("click",function(){const s=Ir(t).$implicit;return or(rn().toggle(s))}),en(2,Tde,1,0,"div",4),St(3,"span",5),bn(4),vt(),St(5,"span",6),bn(6,": "),vt(),en(7,Ade,2,1,"span",7),vt(),en(8,Dde,2,4,"section",8),vt()}if(2&n){const t=e.$implicit,i=rn();ut("ngClass",Uy(6,Ide,"segment-type-"+t.type)),mt(1),ut("ngClass",kF(8,Rde,i.isExpandable(t),t.expanded)),mt(1),ut("ngIf",i.isExpandable(t)),mt(2),Gl(t.key),mt(3),ut("ngIf",!t.expanded||!i.isExpandable(t)),mt(1),ut("ngIf",t.expanded&&i.isExpandable(t))}}let Nde=(()=>{class n{constructor(){this.expanded=!0,this.depth=-1,this._currentDepth=0,this.segments=[]}ngOnChanges(){this.segments=[],this.json=this.decycle(this.json),"object"==typeof this.json?Object.keys(this.json).forEach(t=>{this.segments.push(this.parseKeyValue(t,this.json[t]))}):this.segments.push(this.parseKeyValue(`(${typeof this.json})`,this.json))}isExpandable(t){return"object"===t.type||"array"===t.type}toggle(t){this.isExpandable(t)&&(t.expanded=!t.expanded)}parseKeyValue(t,i){const r={key:t,value:i,type:void 0,description:""+i,expanded:this.isExpanded()};switch(typeof r.value){case"number":r.type="number";break;case"boolean":r.type="boolean";break;case"function":r.type="function";break;case"string":r.type="string",r.description='"'+r.value+'"';break;case"undefined":r.type="undefined",r.description="undefined";break;case"object":null===r.value?(r.type="null",r.description="null"):Array.isArray(r.value)?(r.type="array",r.description="Array["+r.value.length+"] "+JSON.stringify(r.value)):r.value instanceof Date?r.type="date":(r.type="object",r.description="Object "+JSON.stringify(r.value))}return r}isExpanded(){return this.expanded&&!(this.depth>-1&&this._currentDepth>=this.depth)}decycle(t){const i=new WeakMap;return function r(s,o){let a,l;return"object"!=typeof s||null===s||s instanceof Boolean||s instanceof Date||s instanceof Number||s instanceof RegExp||s instanceof String?s:(a=i.get(s),void 0!==a?{$ref:a}:(i.set(s,o),Array.isArray(s)?(l=[],s.forEach(function(c,d){l[d]=r(c,o+"["+d+"]")})):(l={},Object.keys(s).forEach(function(c){l[c]=r(s[c],o+"["+JSON.stringify(c)+"]")})),l))}(t,"$")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=ir({type:n,selectors:[["ngx-json-viewer"]],inputs:{json:"json",expanded:"expanded",depth:"depth",_currentDepth:"_currentDepth"},features:[$i],decls:2,vars:1,consts:[[1,"ngx-json-viewer"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],[3,"ngClass","click"],["class","toggler",4,"ngIf"],[1,"segment-key"],[1,"segment-separator"],["class","segment-value",4,"ngIf"],["class","children",4,"ngIf"],[1,"toggler"],[1,"segment-value"],[1,"children"],[3,"json","expanded","depth","_currentDepth"]],template:function(t,i){1&t&&(St(0,"section",0),en(1,Pde,9,11,"section",1),vt()),2&t&&(mt(1),ut("ngForOf",i.segments))},dependencies:[Gx,qy,Xp,n],styles:['@charset "UTF-8";.ngx-json-viewer[_ngcontent-%COMP%]{font-family:var(--ngx-json-font-family, monospace);font-size:var(--ngx-json-font-size, 1em);width:100%;height:100%;overflow:hidden;position:relative}.ngx-json-viewer[_ngcontent-%COMP%]   .segment[_ngcontent-%COMP%]{padding:2px;margin:1px 1px 1px 12px}.ngx-json-viewer[_ngcontent-%COMP%]   .segment[_ngcontent-%COMP%]   .segment-main[_ngcontent-%COMP%]{word-wrap:break-word}.ngx-json-viewer[_ngcontent-%COMP%]   .segment[_ngcontent-%COMP%]   .segment-main[_ngcontent-%COMP%]   .toggler[_ngcontent-%COMP%]{position:absolute;margin-left:-14px;margin-top:3px;font-size:.8em;line-height:1.2em;vertical-align:middle;color:var(--ngx-json-toggler, #787878)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment[_ngcontent-%COMP%]   .segment-main[_ngcontent-%COMP%]   .toggler[_ngcontent-%COMP%]:after{display:inline-block;content:"\\25ba";transition:transform .1s ease-in}.ngx-json-viewer[_ngcontent-%COMP%]   .segment[_ngcontent-%COMP%]   .segment-main[_ngcontent-%COMP%]   .segment-key[_ngcontent-%COMP%]{color:var(--ngx-json-key, #4E187C)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment[_ngcontent-%COMP%]   .segment-main[_ngcontent-%COMP%]   .segment-separator[_ngcontent-%COMP%]{color:var(--ngx-json-separator, #999)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment[_ngcontent-%COMP%]   .segment-main[_ngcontent-%COMP%]   .segment-value[_ngcontent-%COMP%]{color:var(--ngx-json-value, #000)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment[_ngcontent-%COMP%]   .children[_ngcontent-%COMP%]{margin-left:12px}.ngx-json-viewer[_ngcontent-%COMP%]   .segment-type-string[_ngcontent-%COMP%] > .segment-main[_ngcontent-%COMP%] > .segment-value[_ngcontent-%COMP%]{color:var(--ngx-json-string, #FF6B6B)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment-type-number[_ngcontent-%COMP%] > .segment-main[_ngcontent-%COMP%] > .segment-value[_ngcontent-%COMP%]{color:var(--ngx-json-number, #009688)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment-type-boolean[_ngcontent-%COMP%] > .segment-main[_ngcontent-%COMP%] > .segment-value[_ngcontent-%COMP%]{color:var(--ngx-json-boolean, #B938A4)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment-type-date[_ngcontent-%COMP%] > .segment-main[_ngcontent-%COMP%] > .segment-value[_ngcontent-%COMP%]{color:var(--ngx-json-date, #05668D)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment-type-array[_ngcontent-%COMP%] > .segment-main[_ngcontent-%COMP%] > .segment-value[_ngcontent-%COMP%]{color:var(--ngx-json-array, #999)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment-type-object[_ngcontent-%COMP%] > .segment-main[_ngcontent-%COMP%] > .segment-value[_ngcontent-%COMP%]{color:var(--ngx-json-object, #999)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment-type-function[_ngcontent-%COMP%] > .segment-main[_ngcontent-%COMP%] > .segment-value[_ngcontent-%COMP%]{color:var(--ngx-json-function, #999)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment-type-null[_ngcontent-%COMP%] > .segment-main[_ngcontent-%COMP%] > .segment-value[_ngcontent-%COMP%]{color:var(--ngx-json-null, #fff)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment-type-undefined[_ngcontent-%COMP%] > .segment-main[_ngcontent-%COMP%] > .segment-value[_ngcontent-%COMP%]{color:var(--ngx-json-undefined, #fff)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment-type-null[_ngcontent-%COMP%] > .segment-main[_ngcontent-%COMP%] > .segment-value[_ngcontent-%COMP%]{background-color:var(--ngx-json-null-bg, red)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment-type-undefined[_ngcontent-%COMP%] > .segment-main[_ngcontent-%COMP%] > .segment-key[_ngcontent-%COMP%]{color:var(--ngx-json-undefined-key, #999)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment-type-undefined[_ngcontent-%COMP%] > .segment-main[_ngcontent-%COMP%] > .segment-value[_ngcontent-%COMP%]{background-color:var(--ngx-json-undefined-key, #999)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment-type-object[_ngcontent-%COMP%] > .segment-main[_ngcontent-%COMP%], .ngx-json-viewer[_ngcontent-%COMP%]   .segment-type-array[_ngcontent-%COMP%] > .segment-main[_ngcontent-%COMP%]{white-space:nowrap}.ngx-json-viewer[_ngcontent-%COMP%]   .expanded[_ngcontent-%COMP%] > .toggler[_ngcontent-%COMP%]:after{transform:rotate(90deg)}.ngx-json-viewer[_ngcontent-%COMP%]   .expandable[_ngcontent-%COMP%], .ngx-json-viewer[_ngcontent-%COMP%]   .expandable[_ngcontent-%COMP%] > .toggler[_ngcontent-%COMP%]{cursor:pointer}']}),n})(),Ode=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Oi({type:n}),n.\u0275inj=wi({imports:[Yp]}),n})();function Lde(n,e){if(1&n){const t=Hl();St(0,"div",11)(1,"div",12),bn(2),vt(),St(3,"div")(4,"p-button",6),pn("onClick",function(){const s=Ir(t).$implicit;return or(rn(2).join_game(s))}),bn(5,"JOIN"),vt()(),St(6,"div")(7,"p-button",5),pn("onClick",function(){const s=Ir(t).$implicit;return or(rn(2).set_ai(s))}),bn(8,"AI"),vt()(),St(9,"div")(10,"p-button",13),pn("onClick",function(){const s=Ir(t).$implicit;return or(rn(2).leave(s))}),bn(11,"LEAVE"),vt()()()}if(2&n){const t=e.$implicit;mt(2),Gl(t.type)}}function Fde(n,e){if(1&n){const t=Hl();St(0,"div",1)(1,"div",2),bn(2,"Settings"),vt(),St(3,"div",3)(4,"p-button",4),pn("onClick",function(){return Ir(t),or(rn().setup())}),bn(5,"SETUP"),vt(),St(6,"p-button",5),pn("onClick",function(){return Ir(t),or(rn().start())}),bn(7,"START"),vt(),St(8,"p-button",6),pn("onClick",function(){return Ir(t),or(rn().open())}),bn(9,"OPEN"),vt()(),St(10,"div",7)(11,"div",8),bn(12,"Players"),vt(),en(13,Lde,12,1,"div",9),vt(),St(14,"div"),Nr(15,"ngx-json-viewer",10),vt()()}if(2&n){const t=rn();mt(13),ut("ngForOf",t.gameData.players),mt(2),ut("json",t.gameData)("depth",1)}}let kde=(()=>{class n{constructor(t,i,r,s,o,a){this.signalRService=t,this.router=i,this.unsubscriberService=r,this.activatedRoute=s,this.generalService=o,this.dalService=a,this.gameId=""}ngOnInit(){this.user=this.generalService.User,this.gameId=this.activatedRoute.snapshot.paramMap.get("id"),this.updateGame(),this.signalRService.hubConnection.off("GameUpdated"),this.signalRService.hubConnection.on("GameUpdated",t=>{console.log("GameUpdated",t),this.gameData=t}),this.signalRService.hubConnection.off("GameDeleted"),this.signalRService.hubConnection.on("GameDeleted",t=>{console.log("GameDeleted",t)})}ngOnDestroy(){this.signalRService.hubConnection.off("GameUpdated"),this.signalRService.hubConnection.off("GamesUpdated"),this.signalRService.hubConnection.off("GameDeleted")}updateGame(){this.dalService.getGameById(this.gameId).subscribe(t=>{t?this.gameData?this.iterate(this.gameData,t):this.gameData=t:this.router.navigate([$s.GamesList])})}iterate(t,i){for(let r in t)i.hasOwnProperty(r)&&("object"==typeof t[r]?this.iterate(t[r],i[r]):t[r]=i[r])}ngAfterViewInit(){}ngOnChanges(t){}start(){this.dalService.startGame(this.gameId).subscribe()}leave(t){this.dalService.joinGame(this.gameId,t.id,null,"EMPTY_SEAT").subscribe()}set_ai(t){this.dalService.joinGame(this.gameId,t.id,null,"AI").subscribe()}join_game(t){this.dalService.joinGame(this.gameId,t.id,this.user,"HUMAN").subscribe()}setup(){this.dalService.setupGame(this.gameId,this.user.id).subscribe()}open(){this.router.navigate([$s.GamePlay,this.gameId])}static#e=this.\u0275fac=function(i){return new(i||n)(ce(h0),ce(Or),ce(ZE),ce(Jl),ce(pg),ce(wC))};static#t=this.\u0275cmp=ir({type:n,selectors:[["app-game-setup"]],features:[Vn([ZE]),$i],decls:1,vars:1,consts:[["style","overflow: auto;width: 100%;height: 100%;padding: 20px;",4,"ngIf"],[2,"overflow","auto","width","100%","height","100%","padding","20px"],[2,"font-size","20px"],[1,"mg-row-center",2,"margin-top","20px"],["severity","secondary",3,"onClick"],["severity","warning",3,"onClick"],["severity","success",3,"onClick"],[1,"mg-col"],[2,"margin-top","20px","font-size","20px"],["class","mg-row-center",4,"ngFor","ngForOf"],[3,"json","depth"],[1,"mg-row-center"],[2,"width","100px"],["severity","danger",3,"onClick"]],template:function(i,r){1&i&&en(0,Fde,16,3,"div",0),2&i&&ut("ngIf",r.gameData)},dependencies:[qy,Xp,nN,Nde]})}return n})();const Nh=new lP,js=new N,Gu=new N,hi=new zn,w5={X:new N(1,0,0),Y:new N(0,1,0),Z:new N(0,0,1)},iN={type:"change"},b5={type:"mouseDown"},x5={type:"mouseUp",mode:null},S5={type:"objectChange"};class Ude extends si{constructor(e,t){super(),void 0===t&&(console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.'),t=document),this.isTransformControls=!0,this.visible=!1,this.domElement=t,this.domElement.style.touchAction="none";const i=new Wde;this._gizmo=i,this.add(i);const r=new jde;this._plane=r,this.add(r);const s=this;function o(b,x){let E=x;Object.defineProperty(s,b,{get:function(){return void 0!==E?E:x},set:function(C){E!==C&&(E=C,r[b]=C,i[b]=C,s.dispatchEvent({type:b+"-changed",value:C}),s.dispatchEvent(iN))}}),s[b]=x,r[b]=x,i[b]=x}o("camera",e),o("object",void 0),o("enabled",!0),o("axis",null),o("mode","translate"),o("translationSnap",null),o("rotationSnap",null),o("scaleSnap",null),o("space","world"),o("size",1),o("dragging",!1),o("showX",!0),o("showY",!0),o("showZ",!0);const a=new N,l=new N,c=new zn,d=new zn,h=new N,p=new zn,m=new N,g=new N,v=new N,y=new N;o("worldPosition",a),o("worldPositionStart",l),o("worldQuaternion",c),o("worldQuaternionStart",d),o("cameraPosition",h),o("cameraQuaternion",p),o("pointStart",m),o("pointEnd",g),o("rotationAxis",v),o("rotationAngle",0),o("eye",y),this._offset=new N,this._startNorm=new N,this._endNorm=new N,this._cameraScale=new N,this._parentPosition=new N,this._parentQuaternion=new zn,this._parentQuaternionInv=new zn,this._parentScale=new N,this._worldScaleStart=new N,this._worldQuaternionInv=new zn,this._worldScale=new N,this._positionStart=new N,this._quaternionStart=new zn,this._scaleStart=new N,this._getPointer=Bde.bind(this),this._onPointerDown=Hde.bind(this),this._onPointerHover=Vde.bind(this),this._onPointerMove=zde.bind(this),this._onPointerUp=Gde.bind(this),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointermove",this._onPointerHover),this.domElement.addEventListener("pointerup",this._onPointerUp)}updateMatrixWorld(){void 0!==this.object&&(this.object.updateMatrixWorld(),null===this.object.parent?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this._parentPosition,this._parentQuaternion,this._parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this._worldScale),this._parentQuaternionInv.copy(this._parentQuaternion).invert(),this._worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this._cameraScale),this.camera.isOrthographicCamera?this.camera.getWorldDirection(this.eye).negate():this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld(this)}pointerHover(e){if(void 0===this.object||!0===this.dragging)return;Nh.setFromCamera(e,this.camera);const t=rN(this._gizmo.picker[this.mode],Nh);this.axis=t?t.object.name:null}pointerDown(e){if(void 0!==this.object&&!0!==this.dragging&&0===e.button&&null!==this.axis){Nh.setFromCamera(e,this.camera);const t=rN(this._plane,Nh,!0);t&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(t.point).sub(this.worldPositionStart)),this.dragging=!0,b5.mode=this.mode,this.dispatchEvent(b5)}}pointerMove(e){const t=this.axis,i=this.mode,r=this.object;let s=this.space;if("scale"===i?s="local":("E"===t||"XYZE"===t||"XYZ"===t)&&(s="world"),void 0===r||null===t||!1===this.dragging||-1!==e.button)return;Nh.setFromCamera(e,this.camera);const o=rN(this._plane,Nh,!0);if(o){if(this.pointEnd.copy(o.point).sub(this.worldPositionStart),"translate"===i)this._offset.copy(this.pointEnd).sub(this.pointStart),"local"===s&&"XYZ"!==t&&this._offset.applyQuaternion(this._worldQuaternionInv),-1===t.indexOf("X")&&(this._offset.x=0),-1===t.indexOf("Y")&&(this._offset.y=0),-1===t.indexOf("Z")&&(this._offset.z=0),"local"===s&&"XYZ"!==t?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),r.position.copy(this._offset).add(this._positionStart),this.translationSnap&&("local"===s&&(r.position.applyQuaternion(hi.copy(this._quaternionStart).invert()),-1!==t.search("X")&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.position.applyQuaternion(this._quaternionStart)),"world"===s&&(r.parent&&r.position.add(js.setFromMatrixPosition(r.parent.matrixWorld)),-1!==t.search("X")&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.parent&&r.position.sub(js.setFromMatrixPosition(r.parent.matrixWorld))));else if("scale"===i){if(-1!==t.search("XYZ")){let a=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(a*=-1),Gu.set(a,a,a)}else js.copy(this.pointStart),Gu.copy(this.pointEnd),js.applyQuaternion(this._worldQuaternionInv),Gu.applyQuaternion(this._worldQuaternionInv),Gu.divide(js),-1===t.search("X")&&(Gu.x=1),-1===t.search("Y")&&(Gu.y=1),-1===t.search("Z")&&(Gu.z=1);r.scale.copy(this._scaleStart).multiply(Gu),this.scaleSnap&&(-1!==t.search("X")&&(r.scale.x=Math.round(r.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Y")&&(r.scale.y=Math.round(r.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Z")&&(r.scale.z=Math.round(r.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if("rotate"===i){this._offset.copy(this.pointEnd).sub(this.pointStart);const a=20/this.worldPosition.distanceTo(js.setFromMatrixPosition(this.camera.matrixWorld));"E"===t?(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this._endNorm.cross(this._startNorm).dot(this.eye)<0?1:-1):"XYZE"===t?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(js.copy(this.rotationAxis).cross(this.eye))*a):("X"===t||"Y"===t||"Z"===t)&&(this.rotationAxis.copy(w5[t]),js.copy(w5[t]),"local"===s&&js.applyQuaternion(this.worldQuaternion),this.rotationAngle=this._offset.dot(js.cross(this.eye).normalize())*a),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),"local"===s&&"E"!==t&&"XYZE"!==t?(r.quaternion.copy(this._quaternionStart),r.quaternion.multiply(hi.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),r.quaternion.copy(hi.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),r.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent(iN),this.dispatchEvent(S5)}}pointerUp(e){0===e.button&&(this.dragging&&null!==this.axis&&(x5.mode=this.mode,this.dispatchEvent(x5)),this.dragging=!1,this.axis=null)}dispose(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.traverse(function(e){e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()})}attach(e){return this.object=e,this.visible=!0,this}detach(){return this.object=void 0,this.visible=!1,this.axis=null,this}reset(){this.enabled&&this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent(iN),this.dispatchEvent(S5),this.pointStart.copy(this.pointEnd))}getRaycaster(){return Nh}getMode(){return this.mode}setMode(e){this.mode=e}setTranslationSnap(e){this.translationSnap=e}setRotationSnap(e){this.rotationSnap=e}setScaleSnap(e){this.scaleSnap=e}setSize(e){this.size=e}setSpace(e){this.space=e}}function Bde(n){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:n.button};{const e=this.domElement.getBoundingClientRect();return{x:(n.clientX-e.left)/e.width*2-1,y:-(n.clientY-e.top)/e.height*2+1,button:n.button}}}function Vde(n){if(this.enabled)switch(n.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(n))}}function Hde(n){this.enabled&&(document.pointerLockElement||this.domElement.setPointerCapture(n.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(n)),this.pointerDown(this._getPointer(n)))}function zde(n){this.enabled&&this.pointerMove(this._getPointer(n))}function Gde(n){this.enabled&&(this.domElement.releasePointerCapture(n.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(n)))}function rN(n,e,t){const i=e.intersectObject(n,!0);for(let r=0;r<i.length;r++)if(i[r].object.visible||t)return i[r];return!1}const xC=new $H,Gn=new N(0,1,0),E5=new N(0,0,0),C5=new Ct,SC=new zn,EC=new zn,dl=new N,M5=new Ct,g0=new N(1,0,0),Oh=new N(0,1,0),_0=new N(0,0,1),CC=new N,y0=new N,v0=new N;class Wde extends si{constructor(){super(),this.isTransformControlsGizmo=!0,this.type="TransformControlsGizmo";const e=new Mi({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),t=new Sr({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),i=e.clone();i.opacity=.15;const r=t.clone();r.opacity=.5;const s=e.clone();s.color.setHex(16711680);const o=e.clone();o.color.setHex(65280);const a=e.clone();a.color.setHex(255);const l=e.clone();l.color.setHex(16711680),l.opacity=.5;const c=e.clone();c.color.setHex(65280),c.opacity=.5;const d=e.clone();d.color.setHex(255),d.opacity=.5;const h=e.clone();h.opacity=.25;const p=e.clone();p.color.setHex(16776960),p.opacity=.25,e.clone().color.setHex(16776960);const g=e.clone();g.color.setHex(7895160);const v=new hr(0,.04,.1,12);v.translate(0,.05,0);const w=new di(.08,.08,.08);w.translate(0,.04,0);const y=new Ot;y.setAttribute("position",new Ke([0,0,0,1,0,0],3));const b=new hr(.0075,.0075,.5,3);function x(J,G){const X=new Fu(J,.0075,3,64,G*Math.PI*2);return X.rotateY(Math.PI/2),X.rotateX(Math.PI/2),X}b.translate(0,.25,0);const C={X:[[new Me(v,s),[.5,0,0],[0,0,-Math.PI/2]],[new Me(v,s),[-.5,0,0],[0,0,Math.PI/2]],[new Me(b,s),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new Me(v,o),[0,.5,0]],[new Me(v,o),[0,-.5,0],[Math.PI,0,0]],[new Me(b,o)]],Z:[[new Me(v,a),[0,0,.5],[Math.PI/2,0,0]],[new Me(v,a),[0,0,-.5],[-Math.PI/2,0,0]],[new Me(b,a),null,[Math.PI/2,0,0]]],XYZ:[[new Me(new Lu(.1,0),h.clone()),[0,0,0]]],XY:[[new Me(new di(.15,.15,.01),d.clone()),[.15,.15,0]]],YZ:[[new Me(new di(.15,.15,.01),l.clone()),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new Me(new di(.15,.15,.01),c.clone()),[.15,0,.15],[-Math.PI/2,0,0]]]},A={X:[[new Me(new hr(.2,0,.6,4),i),[.3,0,0],[0,0,-Math.PI/2]],[new Me(new hr(.2,0,.6,4),i),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new Me(new hr(.2,0,.6,4),i),[0,.3,0]],[new Me(new hr(.2,0,.6,4),i),[0,-.3,0],[0,0,Math.PI]]],Z:[[new Me(new hr(.2,0,.6,4),i),[0,0,.3],[Math.PI/2,0,0]],[new Me(new hr(.2,0,.6,4),i),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new Me(new Lu(.2,0),i)]],XY:[[new Me(new di(.2,.2,.01),i),[.15,.15,0]]],YZ:[[new Me(new di(.2,.2,.01),i),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new Me(new di(.2,.2,.01),i),[.15,0,.15],[-Math.PI/2,0,0]]]},D={START:[[new Me(new Lu(.01,2),r),null,null,null,"helper"]],END:[[new Me(new Lu(.01,2),r),null,null,null,"helper"]],DELTA:[[new Qr(function E(){const J=new Ot;return J.setAttribute("position",new Ke([0,0,0,1,1,1],3)),J}(),r),null,null,null,"helper"]],X:[[new Qr(y,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Qr(y,r.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Qr(y,r.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},L={XYZE:[[new Me(x(.5,1),g),null,[0,Math.PI/2,0]]],X:[[new Me(x(.5,.5),s)]],Y:[[new Me(x(.5,.5),o),null,[0,0,-Math.PI/2]]],Z:[[new Me(x(.5,.5),a),null,[0,Math.PI/2,0]]],E:[[new Me(x(.75,1),p),null,[0,Math.PI/2,0]]]},M={AXIS:[[new Qr(y,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},R={XYZE:[[new Me(new Zm(.25,10,8),i)]],X:[[new Me(new Fu(.5,.1,4,24),i),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new Me(new Fu(.5,.1,4,24),i),[0,0,0],[Math.PI/2,0,0]]],Z:[[new Me(new Fu(.5,.1,4,24),i),[0,0,0],[0,0,-Math.PI/2]]],E:[[new Me(new Fu(.75,.1,2,24),i)]]},$={X:[[new Me(w,s),[.5,0,0],[0,0,-Math.PI/2]],[new Me(b,s),[0,0,0],[0,0,-Math.PI/2]],[new Me(w,s),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new Me(w,o),[0,.5,0]],[new Me(b,o)],[new Me(w,o),[0,-.5,0],[0,0,Math.PI]]],Z:[[new Me(w,a),[0,0,.5],[Math.PI/2,0,0]],[new Me(b,a),[0,0,0],[Math.PI/2,0,0]],[new Me(w,a),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new Me(new di(.15,.15,.01),d),[.15,.15,0]]],YZ:[[new Me(new di(.15,.15,.01),l),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new Me(new di(.15,.15,.01),c),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new Me(new di(.1,.1,.1),h.clone())]]},ee={X:[[new Me(new hr(.2,0,.6,4),i),[.3,0,0],[0,0,-Math.PI/2]],[new Me(new hr(.2,0,.6,4),i),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new Me(new hr(.2,0,.6,4),i),[0,.3,0]],[new Me(new hr(.2,0,.6,4),i),[0,-.3,0],[0,0,Math.PI]]],Z:[[new Me(new hr(.2,0,.6,4),i),[0,0,.3],[Math.PI/2,0,0]],[new Me(new hr(.2,0,.6,4),i),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new Me(new di(.2,.2,.01),i),[.15,.15,0]]],YZ:[[new Me(new di(.2,.2,.01),i),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new Me(new di(.2,.2,.01),i),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new Me(new di(.2,.2,.2),i),[0,0,0]]]},se={X:[[new Qr(y,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Qr(y,r.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Qr(y,r.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function V(J){const G=new si;for(const X in J)for(let Q=J[X].length;Q--;){const Z=J[X][Q][0].clone(),le=J[X][Q][1],q=J[X][Q][2],oe=J[X][Q][3],Se=J[X][Q][4];Z.name=X,Z.tag=Se,le&&Z.position.set(le[0],le[1],le[2]),q&&Z.rotation.set(q[0],q[1],q[2]),oe&&Z.scale.set(oe[0],oe[1],oe[2]),Z.updateMatrix();const ve=Z.geometry.clone();ve.applyMatrix4(Z.matrix),Z.geometry=ve,Z.renderOrder=1/0,Z.position.set(0,0,0),Z.rotation.set(0,0,0),Z.scale.set(1,1,1),G.add(Z)}return G}this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=V(C)),this.add(this.gizmo.rotate=V(L)),this.add(this.gizmo.scale=V($)),this.add(this.picker.translate=V(A)),this.add(this.picker.rotate=V(R)),this.add(this.picker.scale=V(ee)),this.add(this.helper.translate=V(D)),this.add(this.helper.rotate=V(M)),this.add(this.helper.scale=V(se)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}updateMatrixWorld(e){const i="local"===("scale"===this.mode?"local":this.space)?this.worldQuaternion:EC;this.gizmo.translate.visible="translate"===this.mode,this.gizmo.rotate.visible="rotate"===this.mode,this.gizmo.scale.visible="scale"===this.mode,this.helper.translate.visible="translate"===this.mode,this.helper.rotate.visible="rotate"===this.mode,this.helper.scale.visible="scale"===this.mode;let r=[];r=r.concat(this.picker[this.mode].children),r=r.concat(this.gizmo[this.mode].children),r=r.concat(this.helper[this.mode].children);for(let s=0;s<r.length;s++){const o=r[s];let a;o.visible=!0,o.rotation.set(0,0,0),o.position.copy(this.worldPosition),a=this.camera.isOrthographicCamera?(this.camera.top-this.camera.bottom)/this.camera.zoom:this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),o.scale.set(1,1,1).multiplyScalar(a*this.size/4),"helper"!==o.tag?(o.quaternion.copy(i),"translate"===this.mode||"scale"===this.mode?("X"===o.name&&Math.abs(Gn.copy(g0).applyQuaternion(i).dot(this.eye))>.99&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"Y"===o.name&&Math.abs(Gn.copy(Oh).applyQuaternion(i).dot(this.eye))>.99&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"Z"===o.name&&Math.abs(Gn.copy(_0).applyQuaternion(i).dot(this.eye))>.99&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"XY"===o.name&&Math.abs(Gn.copy(_0).applyQuaternion(i).dot(this.eye))<.2&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"YZ"===o.name&&Math.abs(Gn.copy(g0).applyQuaternion(i).dot(this.eye))<.2&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"XZ"===o.name&&Math.abs(Gn.copy(Oh).applyQuaternion(i).dot(this.eye))<.2&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1)):"rotate"===this.mode&&(SC.copy(i),Gn.copy(this.eye).applyQuaternion(hi.copy(i).invert()),-1!==o.name.search("E")&&o.quaternion.setFromRotationMatrix(C5.lookAt(this.eye,E5,Oh)),"X"===o.name&&(hi.setFromAxisAngle(g0,Math.atan2(-Gn.y,Gn.z)),hi.multiplyQuaternions(SC,hi),o.quaternion.copy(hi)),"Y"===o.name&&(hi.setFromAxisAngle(Oh,Math.atan2(Gn.x,Gn.z)),hi.multiplyQuaternions(SC,hi),o.quaternion.copy(hi)),"Z"===o.name&&(hi.setFromAxisAngle(_0,Math.atan2(Gn.y,Gn.x)),hi.multiplyQuaternions(SC,hi),o.quaternion.copy(hi))),o.visible=o.visible&&(-1===o.name.indexOf("X")||this.showX),o.visible=o.visible&&(-1===o.name.indexOf("Y")||this.showY),o.visible=o.visible&&(-1===o.name.indexOf("Z")||this.showZ),o.visible=o.visible&&(-1===o.name.indexOf("E")||this.showX&&this.showY&&this.showZ),o.material._color=o.material._color||o.material.color.clone(),o.material._opacity=o.material._opacity||o.material.opacity,o.material.color.copy(o.material._color),o.material.opacity=o.material._opacity,this.enabled&&this.axis&&(o.name===this.axis||this.axis.split("").some(function(l){return o.name===l}))&&(o.material.color.setHex(16776960),o.material.opacity=1)):(o.visible=!1,"AXIS"===o.name?(o.visible=!!this.axis,"X"===this.axis&&(hi.setFromEuler(xC.set(0,0,0)),o.quaternion.copy(i).multiply(hi),Math.abs(Gn.copy(g0).applyQuaternion(i).dot(this.eye))>.9&&(o.visible=!1)),"Y"===this.axis&&(hi.setFromEuler(xC.set(0,0,Math.PI/2)),o.quaternion.copy(i).multiply(hi),Math.abs(Gn.copy(Oh).applyQuaternion(i).dot(this.eye))>.9&&(o.visible=!1)),"Z"===this.axis&&(hi.setFromEuler(xC.set(0,Math.PI/2,0)),o.quaternion.copy(i).multiply(hi),Math.abs(Gn.copy(_0).applyQuaternion(i).dot(this.eye))>.9&&(o.visible=!1)),"XYZE"===this.axis&&(hi.setFromEuler(xC.set(0,Math.PI/2,0)),Gn.copy(this.rotationAxis),o.quaternion.setFromRotationMatrix(C5.lookAt(E5,Gn,Oh)),o.quaternion.multiply(hi),o.visible=this.dragging),"E"===this.axis&&(o.visible=!1)):"START"===o.name?(o.position.copy(this.worldPositionStart),o.visible=this.dragging):"END"===o.name?(o.position.copy(this.worldPosition),o.visible=this.dragging):"DELTA"===o.name?(o.position.copy(this.worldPositionStart),o.quaternion.copy(this.worldQuaternionStart),js.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),js.applyQuaternion(this.worldQuaternionStart.clone().invert()),o.scale.copy(js),o.visible=this.dragging):(o.quaternion.copy(i),o.position.copy(this.dragging?this.worldPositionStart:this.worldPosition),this.axis&&(o.visible=-1!==this.axis.search(o.name))))}super.updateMatrixWorld(e)}}class jde extends Me{constructor(){super(new Um(1e5,1e5,2,2),new Mi({visible:!1,wireframe:!0,side:2,transparent:!0,opacity:.1,toneMapped:!1})),this.isTransformControlsPlane=!0,this.type="TransformControlsPlane"}updateMatrixWorld(e){let t=this.space;switch(this.position.copy(this.worldPosition),"scale"===this.mode&&(t="local"),CC.copy(g0).applyQuaternion("local"===t?this.worldQuaternion:EC),y0.copy(Oh).applyQuaternion("local"===t?this.worldQuaternion:EC),v0.copy(_0).applyQuaternion("local"===t?this.worldQuaternion:EC),Gn.copy(y0),this.mode){case"translate":case"scale":switch(this.axis){case"X":Gn.copy(this.eye).cross(CC),dl.copy(CC).cross(Gn);break;case"Y":Gn.copy(this.eye).cross(y0),dl.copy(y0).cross(Gn);break;case"Z":Gn.copy(this.eye).cross(v0),dl.copy(v0).cross(Gn);break;case"XY":dl.copy(v0);break;case"YZ":dl.copy(CC);break;case"XZ":Gn.copy(v0),dl.copy(y0);break;case"XYZ":case"E":dl.set(0,0,0)}break;default:dl.set(0,0,0)}0===dl.length()?this.quaternion.copy(this.cameraQuaternion):(M5.lookAt(js.set(0,0,0),dl,Gn),this.quaternion.setFromRotationMatrix(M5)),super.updateMatrixWorld(e)}}let $de=(()=>{class n{ngAfterViewInit(){const t=new wE;t.add(new jae(5));const i=new cr(75,window.innerWidth/window.innerHeight,.1,1e3);i.position.z=2;const r=new xR;r.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(r.domElement);const s=new di,o=new y4({transparent:!0}),a=new Me(s,o);t.add(a);const l=new Q4(i,r.domElement),c=new Ude(i,r.domElement);c.attach(a),c.setMode("rotate"),t.add(c),c.addEventListener("dragging-changed",function(g){l.enabled=!g.value}),window.addEventListener("keydown",function(g){switch(g.key){case"g":c.setMode("translate");break;case"r":c.setMode("rotate");break;case"s":c.setMode("scale")}});const d=(new E4).load(["img/px_eso0932a.jpg","img/nx_eso0932a.jpg","img/py_eso0932a.jpg","img/ny_eso0932a.jpg","img/pz_eso0932a.jpg","img/nz_eso0932a.jpg"]);function m(){r.render(t,i)}t.background=d,window.addEventListener("resize",function h(){i.aspect=window.innerWidth/window.innerHeight,i.updateProjectionMatrix(),r.setSize(window.innerWidth,window.innerHeight),m()},!1),function p(){requestAnimationFrame(p),m()}()}ngOnChanges(t){}ngOnDestroy(){}ngOnInit(){}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=ir({type:n,selectors:[["app-editor"]],features:[$i],decls:0,vars:0,template:function(i,r){}})}return n})();var $s=function(n){return n.Home="home",n.GamesList="games-list",n.GameSetup="game-setup",n.GamePlay="game-play",n.Editor="editor",n}($s||{});const qde=[{path:"",redirectTo:`/${$s.Home}`,pathMatch:"full"},{path:$s.Home,component:Ede},{path:$s.Editor,component:$de,canActivate:[bC]},{path:$s.GamesList,component:Mde,canActivate:[bC]},{path:`${$s.GameSetup}/:id`,component:kde,canActivate:[bC]},{path:`${$s.GamePlay}/:id`,component:Que,canActivate:[bC]},{path:"**",redirectTo:`/${$s.Home}`}];let Xde=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Oi({type:n});static#n=this.\u0275inj=wi({imports:[zV.forRoot(qde),zV]})}return n})(),Yde=(()=>{class n{constructor(t,i,r){this.generalService=t,this.titleService=i,this.signalRService=r,this.appVersionAttr=d0.appVersion,this.titleService.setTitle("MGx - v"+d0.appVersion);let s=localStorage.getItem("user");try{s=JSON.parse(s),this.generalService.User=s,this.signalRService.startConnection(this.generalService.User.id)}catch{this.generalService.User=void 0}}static#e=this.\u0275fac=function(i){return new(i||n)(ce(pg),ce(hD),ce(h0))};static#t=this.\u0275cmp=ir({type:n,selectors:[["app-root"]],hostVars:1,hostBindings:function(i,r){2&i&&ui("app-version",r.appVersionAttr)},decls:1,vars:0,template:function(i,r){1&i&&Nr(0,"router-outlet")},dependencies:[wI]})}return n})(),T5=(()=>{class n extends y5{static \u0275fac=function(){let t;return function(r){return(t||(t=bi(n)))(r||n)}}();static \u0275cmp=ir({type:n,selectors:[["CheckIcon"]],standalone:!0,features:[wn,ky],decls:2,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M4.86199 11.5948C4.78717 11.5923 4.71366 11.5745 4.64596 11.5426C4.57826 11.5107 4.51779 11.4652 4.46827 11.4091L0.753985 7.69483C0.683167 7.64891 0.623706 7.58751 0.580092 7.51525C0.536478 7.44299 0.509851 7.36177 0.502221 7.27771C0.49459 7.19366 0.506156 7.10897 0.536046 7.03004C0.565935 6.95111 0.613367 6.88 0.674759 6.82208C0.736151 6.76416 0.8099 6.72095 0.890436 6.69571C0.970973 6.67046 1.05619 6.66385 1.13966 6.67635C1.22313 6.68886 1.30266 6.72017 1.37226 6.76792C1.44186 6.81567 1.4997 6.8786 1.54141 6.95197L4.86199 10.2503L12.6397 2.49483C12.7444 2.42694 12.8689 2.39617 12.9932 2.40745C13.1174 2.41873 13.2343 2.47141 13.3251 2.55705C13.4159 2.64268 13.4753 2.75632 13.4938 2.87973C13.5123 3.00315 13.4888 3.1292 13.4271 3.23768L5.2557 11.4091C5.20618 11.4652 5.14571 11.5107 5.07801 11.5426C5.01031 11.5745 4.9368 11.5923 4.86199 11.5948Z","fill","currentColor"]],template:function(i,r){1&i&&(kf(),St(0,"svg",0),Nr(1,"path",1),vt()),2&i&&(zl(r.getClassNames()),ui("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role))},encapsulation:2})}return n})();const Kde=["cb"];function Zde(n,e){1&n&&Nr(0,"span",10),2&n&&ut("ngClass",rn(3).checkboxIcon)}function Jde(n,e){1&n&&Nr(0,"CheckIcon",11),2&n&&ut("styleClass","p-checkbox-icon")}function Qde(n,e){if(1&n&&(du(0),en(1,Zde,1,1,"span",8),en(2,Jde,1,1,"CheckIcon",9),hu()),2&n){const t=rn(2);mt(1),ut("ngIf",t.checkboxIcon),mt(1),ut("ngIf",!t.checkboxIcon)}}function ehe(n,e){}function the(n,e){1&n&&en(0,ehe,0,0,"ng-template")}function nhe(n,e){if(1&n&&(St(0,"span",12),en(1,the,1,0,null,13),vt()),2&n){const t=rn(2);mt(1),ut("ngTemplateOutlet",t.checkboxIconTemplate)}}function ihe(n,e){if(1&n&&(du(0),en(1,Qde,3,2,"ng-container",5),en(2,nhe,2,1,"span",7),hu()),2&n){const t=rn();mt(1),ut("ngIf",!t.checkboxIconTemplate),mt(1),ut("ngIf",t.checkboxIconTemplate)}}const rhe=function(n,e,t){return{"p-checkbox-label":!0,"p-checkbox-label-active":n,"p-disabled":e,"p-checkbox-label-focus":t}};function she(n,e){if(1&n){const t=Hl();St(0,"label",14),pn("click",function(r){Ir(t);const s=rn(),o=Ay(3);return or(s.onClick(r,o,!0))}),bn(1),vt()}if(2&n){const t=rn();zl(t.labelStyleClass),ut("ngClass",wx(5,rhe,t.checked(),t.disabled,t.focused)),ui("for",t.inputId),mt(1),Gl(t.label)}}const ohe=function(n,e,t){return{"p-checkbox p-component":!0,"p-checkbox-checked":n,"p-checkbox-disabled":e,"p-checkbox-focused":t}},ahe=function(n,e,t){return{"p-highlight":n,"p-disabled":e,"p-focus":t}},lhe={provide:ga,useExisting:yn(()=>che),multi:!0};let che=(()=>{class n{cd;value;name;disabled;binary;label;ariaLabelledBy;ariaLabel;tabindex;inputId;style;styleClass;labelStyleClass;formControl;checkboxIcon;readonly;required;trueValue=!0;falseValue=!1;onChange=new Yn;inputViewChild;templates;checkboxIconTemplate;model;onModelChange=()=>{};onModelTouched=()=>{};focused=!1;constructor(t){this.cd=t}ngAfterContentInit(){this.templates.forEach(t=>{"icon"===t.getType()&&(this.checkboxIconTemplate=t.template)})}onClick(t,i,r){t.preventDefault(),!this.disabled&&!this.readonly&&(this.updateModel(t),r&&i.focus())}updateModel(t){let i;this.binary?(i=this.checked()?this.falseValue:this.trueValue,this.model=i,this.onModelChange(i)):(i=this.checked()?this.model.filter(r=>!m0.equals(r,this.value)):this.model?[...this.model,this.value]:[this.value],this.onModelChange(i),this.model=i,this.formControl&&this.formControl.setValue(i)),this.onChange.emit({checked:i,originalEvent:t})}handleChange(t){this.readonly||this.updateModel(t)}onFocus(){this.focused=!0}onBlur(){this.focused=!1,this.onModelTouched()}focus(){this.inputViewChild?.nativeElement.focus()}writeValue(t){this.model=t,this.cd.markForCheck()}registerOnChange(t){this.onModelChange=t}registerOnTouched(t){this.onModelTouched=t}setDisabledState(t){this.disabled=t,this.cd.markForCheck()}checked(){return this.binary?this.model===this.trueValue:m0.contains(this.value,this.model)}static \u0275fac=function(i){return new(i||n)(ce(Gy))};static \u0275cmp=ir({type:n,selectors:[["p-checkbox"]],contentQueries:function(i,r,s){if(1&i&&Sx(s,g5,4),2&i){let o;zp(o=Gp())&&(r.templates=o)}},viewQuery:function(i,r){if(1&i&&gA(Kde,5),2&i){let s;zp(s=Gp())&&(r.inputViewChild=s.first)}},hostAttrs:[1,"p-element"],inputs:{value:"value",name:"name",disabled:"disabled",binary:"binary",label:"label",ariaLabelledBy:"ariaLabelledBy",ariaLabel:"ariaLabel",tabindex:"tabindex",inputId:"inputId",style:"style",styleClass:"styleClass",labelStyleClass:"labelStyleClass",formControl:"formControl",checkboxIcon:"checkboxIcon",readonly:"readonly",required:"required",trueValue:"trueValue",falseValue:"falseValue"},outputs:{onChange:"onChange"},features:[Vn([lhe])],decls:7,vars:26,consts:[[3,"ngStyle","ngClass"],[1,"p-hidden-accessible"],["type","checkbox",3,"readonly","value","checked","disabled","focus","blur","change"],["cb",""],[1,"p-checkbox-box",3,"ngClass","click"],[4,"ngIf"],[3,"class","ngClass","click",4,"ngIf"],["class","p-checkbox-icon",4,"ngIf"],["class","p-checkbox-icon",3,"ngClass",4,"ngIf"],[3,"styleClass",4,"ngIf"],[1,"p-checkbox-icon",3,"ngClass"],[3,"styleClass"],[1,"p-checkbox-icon"],[4,"ngTemplateOutlet"],[3,"ngClass","click"]],template:function(i,r){if(1&i){const s=Hl();St(0,"div",0)(1,"div",1)(2,"input",2,3),pn("focus",function(){return r.onFocus()})("blur",function(){return r.onBlur()})("change",function(a){return r.handleChange(a)}),vt()(),St(4,"div",4),pn("click",function(a){Ir(s);const l=Ay(3);return or(r.onClick(a,l,!0))}),en(5,ihe,3,2,"ng-container",5),vt()(),en(6,she,2,9,"label",6)}2&i&&(zl(r.styleClass),ut("ngStyle",r.style)("ngClass",wx(18,ohe,r.checked(),r.disabled,r.focused)),mt(2),ut("readonly",r.readonly)("value",r.value)("checked",r.checked())("disabled",r.disabled),ui("id",r.inputId)("name",r.name)("tabindex",r.tabindex)("aria-labelledby",r.ariaLabelledBy)("aria-label",r.ariaLabel)("aria-checked",r.checked())("required",r.required),mt(2),ut("ngClass",wx(22,ahe,r.checked(),r.disabled,r.focused)),mt(1),ut("ngIf",r.checked()),mt(1),ut("ngIf",r.label))},dependencies:function(){return[Gx,Xp,Wx,QA,T5]},styles:["@layer primeng{.p-checkbox{display:inline-flex;cursor:pointer;-webkit-user-select:none;user-select:none;vertical-align:bottom;position:relative}.p-checkbox-disabled{cursor:default!important;pointer-events:none}.p-checkbox-box{display:flex;justify-content:center;align-items:center}p-checkbox{display:inline-flex;vertical-align:bottom;align-items:center}.p-checkbox-label{line-height:1}}\n"],encapsulation:2,changeDetection:0})}return n})(),uhe=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=Oi({type:n});static \u0275inj=wi({imports:[Yp,T5,tN]})}return n})();function A5(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function Je(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?A5(Object(t),!0).forEach(function(i){fr(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):A5(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function MC(n){return(MC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(n)}function D5(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function fr(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function sN(n,e){return function mhe(n){if(Array.isArray(n))return n}(n)||function _he(n,e){var t=null==n?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(null!=t){var o,a,i=[],r=!0,s=!1;try{for(t=t.call(n);!(r=(o=t.next()).done)&&(i.push(o.value),!e||i.length!==e);r=!0);}catch(l){s=!0,a=l}finally{try{!r&&null!=t.return&&t.return()}finally{if(s)throw a}}return i}}(n,e)||I5(n,e)||function vhe(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b0(n){return function phe(n){if(Array.isArray(n))return oN(n)}(n)||function ghe(n){if(typeof Symbol<"u"&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||I5(n)||function yhe(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I5(n,e){if(n){if("string"==typeof n)return oN(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if("Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t)return Array.from(n);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return oN(n,e)}}function oN(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}var R5=function(){},aN={},P5={},N5=null,O5={mark:R5,measure:R5};try{typeof window<"u"&&(aN=window),typeof document<"u"&&(P5=document),typeof MutationObserver<"u"&&(N5=MutationObserver),typeof performance<"u"&&(O5=performance)}catch{}var DC,IC,RC,PC,NC,L5=(aN.navigator||{}).userAgent,F5=void 0===L5?"":L5,Wu=aN,ai=P5,k5=N5,AC=O5,_c=!!ai.documentElement&&!!ai.head&&"function"==typeof ai.addEventListener&&"function"==typeof ai.createElement,U5=~F5.indexOf("MSIE")||~F5.indexOf("Trident/"),yc="___FONT_AWESOME___",B5="fa",V5="svg-inline--fa",Lh="data-fa-i2svg",cN="data-fa-pseudo-element",bhe="data-fa-pseudo-element-pending",uN="data-prefix",dN="data-icon",H5="fontawesome-i2svg",xhe="async",She=["HTML","HEAD","STYLE","SCRIPT"],z5=function(){try{return!0}catch{return!1}}(),li="classic",Ii="sharp",hN=[li,Ii];function x0(n){return new Proxy(n,{get:function(t,i){return i in t?t[i]:t[li]}})}var S0=x0((fr(DC={},li,{fa:"solid",fas:"solid","fa-solid":"solid",far:"regular","fa-regular":"regular",fal:"light","fa-light":"light",fat:"thin","fa-thin":"thin",fad:"duotone","fa-duotone":"duotone",fab:"brands","fa-brands":"brands",fak:"kit","fa-kit":"kit"}),fr(DC,Ii,{fa:"solid",fass:"solid","fa-solid":"solid",fasr:"regular","fa-regular":"regular",fasl:"light","fa-light":"light"}),DC)),E0=x0((fr(IC={},li,{solid:"fas",regular:"far",light:"fal",thin:"fat",duotone:"fad",brands:"fab",kit:"fak"}),fr(IC,Ii,{solid:"fass",regular:"fasr",light:"fasl"}),IC)),C0=x0((fr(RC={},li,{fab:"fa-brands",fad:"fa-duotone",fak:"fa-kit",fal:"fa-light",far:"fa-regular",fas:"fa-solid",fat:"fa-thin"}),fr(RC,Ii,{fass:"fa-solid",fasr:"fa-regular",fasl:"fa-light"}),RC)),Ehe=x0((fr(PC={},li,{"fa-brands":"fab","fa-duotone":"fad","fa-kit":"fak","fa-light":"fal","fa-regular":"far","fa-solid":"fas","fa-thin":"fat"}),fr(PC,Ii,{"fa-solid":"fass","fa-regular":"fasr","fa-light":"fasl"}),PC)),Che=/fa(s|r|l|t|d|b|k|ss|sr|sl)?[\-\ ]/,G5="fa-layers-text",Mhe=/Font ?Awesome ?([56 ]*)(Solid|Regular|Light|Thin|Duotone|Brands|Free|Pro|Sharp|Kit)?.*/i,The=x0((fr(NC={},li,{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"}),fr(NC,Ii,{900:"fass",400:"fasr",300:"fasl"}),NC)),W5=[1,2,3,4,5,6,7,8,9,10],Ahe=W5.concat([11,12,13,14,15,16,17,18,19,20]),Dhe=["class","data-prefix","data-icon","data-fa-transform","data-fa-mask"],Fh={GROUP:"duotone-group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},M0=new Set;Object.keys(E0[li]).map(M0.add.bind(M0)),Object.keys(E0[Ii]).map(M0.add.bind(M0));var Ihe=[].concat(hN,b0(M0),["2xs","xs","sm","lg","xl","2xl","beat","border","fade","beat-fade","bounce","flip-both","flip-horizontal","flip-vertical","flip","fw","inverse","layers-counter","layers-text","layers","li","pull-left","pull-right","pulse","rotate-180","rotate-270","rotate-90","rotate-by","shake","spin-pulse","spin-reverse","spin","stack-1x","stack-2x","stack","ul",Fh.GROUP,Fh.SWAP_OPACITY,Fh.PRIMARY,Fh.SECONDARY]).concat(W5.map(function(n){return"".concat(n,"x")})).concat(Ahe.map(function(n){return"w-".concat(n)})),T0=Wu.FontAwesomeConfig||{};ai&&"function"==typeof ai.querySelector&&[["data-family-prefix","familyPrefix"],["data-css-prefix","cssPrefix"],["data-family-default","familyDefault"],["data-style-default","styleDefault"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach(function(n){var e=sN(n,2),i=e[1],r=function Phe(n){return""===n||"false"!==n&&("true"===n||n)}(function Rhe(n){var e=ai.querySelector("script["+n+"]");if(e)return e.getAttribute(n)}(e[0]));null!=r&&(T0[i]=r)});var j5={styleDefault:"solid",familyDefault:"classic",cssPrefix:B5,replacementClass:V5,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0};T0.familyPrefix&&(T0.cssPrefix=T0.familyPrefix);var _g=Je(Je({},j5),T0);_g.autoReplaceSvg||(_g.observeMutations=!1);var rt={};Object.keys(j5).forEach(function(n){Object.defineProperty(rt,n,{enumerable:!0,set:function(t){_g[n]=t,A0.forEach(function(i){return i(rt)})},get:function(){return _g[n]}})}),Object.defineProperty(rt,"familyPrefix",{enumerable:!0,set:function(e){_g.cssPrefix=e,A0.forEach(function(t){return t(rt)})},get:function(){return _g.cssPrefix}}),Wu.FontAwesomeConfig=rt;var A0=[],hl={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1},Fhe="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";function D0(){for(var n=12,e="";n-- >0;)e+=Fhe[62*Math.random()|0];return e}function yg(n){for(var e=[],t=(n||[]).length>>>0;t--;)e[t]=n[t];return e}function fN(n){return n.classList?yg(n.classList):(n.getAttribute("class")||"").split(" ").filter(function(e){return e})}function $5(n){return"".concat(n).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function OC(n){return Object.keys(n||{}).reduce(function(e,t){return e+"".concat(t,": ").concat(n[t].trim(),";")},"")}function pN(n){return n.size!==hl.size||n.x!==hl.x||n.y!==hl.y||n.rotate!==hl.rotate||n.flipX||n.flipY}var Vhe=':root, :host {\n  --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Solid";\n  --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Regular";\n  --fa-font-light: normal 300 1em/1 "Font Awesome 6 Light";\n  --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Thin";\n  --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";\n  --fa-font-sharp-solid: normal 900 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-sharp-regular: normal 400 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-sharp-light: normal 300 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";\n}\n\nsvg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {\n  overflow: visible;\n  box-sizing: content-box;\n}\n\n.svg-inline--fa {\n  display: var(--fa-display, inline-block);\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.svg-inline--fa.fa-2xs {\n  vertical-align: 0.1em;\n}\n.svg-inline--fa.fa-xs {\n  vertical-align: 0em;\n}\n.svg-inline--fa.fa-sm {\n  vertical-align: -0.0714285705em;\n}\n.svg-inline--fa.fa-lg {\n  vertical-align: -0.2em;\n}\n.svg-inline--fa.fa-xl {\n  vertical-align: -0.25em;\n}\n.svg-inline--fa.fa-2xl {\n  vertical-align: -0.3125em;\n}\n.svg-inline--fa.fa-pull-left {\n  margin-right: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-pull-right {\n  margin-left: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-li {\n  width: var(--fa-li-width, 2em);\n  top: 0.25em;\n}\n.svg-inline--fa.fa-fw {\n  width: var(--fa-fw-width, 1.25em);\n}\n\n.fa-layers svg.svg-inline--fa {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.fa-layers-counter, .fa-layers-text {\n  display: inline-block;\n  position: absolute;\n  text-align: center;\n}\n\n.fa-layers {\n  display: inline-block;\n  height: 1em;\n  position: relative;\n  text-align: center;\n  vertical-align: -0.125em;\n  width: 1em;\n}\n.fa-layers svg.svg-inline--fa {\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-text {\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter {\n  background-color: var(--fa-counter-background-color, #ff253a);\n  border-radius: var(--fa-counter-border-radius, 1em);\n  box-sizing: border-box;\n  color: var(--fa-inverse, #fff);\n  line-height: var(--fa-counter-line-height, 1);\n  max-width: var(--fa-counter-max-width, 5em);\n  min-width: var(--fa-counter-min-width, 1.5em);\n  overflow: hidden;\n  padding: var(--fa-counter-padding, 0.25em 0.5em);\n  right: var(--fa-right, 0);\n  text-overflow: ellipsis;\n  top: var(--fa-top, 0);\n  -webkit-transform: scale(var(--fa-counter-scale, 0.25));\n          transform: scale(var(--fa-counter-scale, 0.25));\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-bottom-right {\n  bottom: var(--fa-bottom, 0);\n  right: var(--fa-right, 0);\n  top: auto;\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: bottom right;\n          transform-origin: bottom right;\n}\n\n.fa-layers-bottom-left {\n  bottom: var(--fa-bottom, 0);\n  left: var(--fa-left, 0);\n  right: auto;\n  top: auto;\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: bottom left;\n          transform-origin: bottom left;\n}\n\n.fa-layers-top-right {\n  top: var(--fa-top, 0);\n  right: var(--fa-right, 0);\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-top-left {\n  left: var(--fa-left, 0);\n  right: auto;\n  top: var(--fa-top, 0);\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: top left;\n          transform-origin: top left;\n}\n\n.fa-1x {\n  font-size: 1em;\n}\n\n.fa-2x {\n  font-size: 2em;\n}\n\n.fa-3x {\n  font-size: 3em;\n}\n\n.fa-4x {\n  font-size: 4em;\n}\n\n.fa-5x {\n  font-size: 5em;\n}\n\n.fa-6x {\n  font-size: 6em;\n}\n\n.fa-7x {\n  font-size: 7em;\n}\n\n.fa-8x {\n  font-size: 8em;\n}\n\n.fa-9x {\n  font-size: 9em;\n}\n\n.fa-10x {\n  font-size: 10em;\n}\n\n.fa-2xs {\n  font-size: 0.625em;\n  line-height: 0.1em;\n  vertical-align: 0.225em;\n}\n\n.fa-xs {\n  font-size: 0.75em;\n  line-height: 0.0833333337em;\n  vertical-align: 0.125em;\n}\n\n.fa-sm {\n  font-size: 0.875em;\n  line-height: 0.0714285718em;\n  vertical-align: 0.0535714295em;\n}\n\n.fa-lg {\n  font-size: 1.25em;\n  line-height: 0.05em;\n  vertical-align: -0.075em;\n}\n\n.fa-xl {\n  font-size: 1.5em;\n  line-height: 0.0416666682em;\n  vertical-align: -0.125em;\n}\n\n.fa-2xl {\n  font-size: 2em;\n  line-height: 0.03125em;\n  vertical-align: -0.1875em;\n}\n\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n\n.fa-ul {\n  list-style-type: none;\n  margin-left: var(--fa-li-margin, 2.5em);\n  padding-left: 0;\n}\n.fa-ul > li {\n  position: relative;\n}\n\n.fa-li {\n  left: calc(var(--fa-li-width, 2em) * -1);\n  position: absolute;\n  text-align: center;\n  width: var(--fa-li-width, 2em);\n  line-height: inherit;\n}\n\n.fa-border {\n  border-color: var(--fa-border-color, #eee);\n  border-radius: var(--fa-border-radius, 0.1em);\n  border-style: var(--fa-border-style, solid);\n  border-width: var(--fa-border-width, 0.08em);\n  padding: var(--fa-border-padding, 0.2em 0.25em 0.15em);\n}\n\n.fa-pull-left {\n  float: left;\n  margin-right: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-pull-right {\n  float: right;\n  margin-left: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-beat {\n  -webkit-animation-name: fa-beat;\n          animation-name: fa-beat;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);\n          animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-bounce {\n  -webkit-animation-name: fa-bounce;\n          animation-name: fa-bounce;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));\n}\n\n.fa-fade {\n  -webkit-animation-name: fa-fade;\n          animation-name: fa-fade;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-beat-fade {\n  -webkit-animation-name: fa-beat-fade;\n          animation-name: fa-beat-fade;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-flip {\n  -webkit-animation-name: fa-flip;\n          animation-name: fa-flip;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);\n          animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-shake {\n  -webkit-animation-name: fa-shake;\n          animation-name: fa-shake;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, linear);\n          animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin {\n  -webkit-animation-name: fa-spin;\n          animation-name: fa-spin;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 2s);\n          animation-duration: var(--fa-animation-duration, 2s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, linear);\n          animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin-reverse {\n  --fa-animation-direction: reverse;\n}\n\n.fa-pulse,\n.fa-spin-pulse {\n  -webkit-animation-name: fa-spin;\n          animation-name: fa-spin;\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, steps(8));\n          animation-timing-function: var(--fa-animation-timing, steps(8));\n}\n\n@media (prefers-reduced-motion: reduce) {\n  .fa-beat,\n.fa-bounce,\n.fa-fade,\n.fa-beat-fade,\n.fa-flip,\n.fa-pulse,\n.fa-shake,\n.fa-spin,\n.fa-spin-pulse {\n    -webkit-animation-delay: -1ms;\n            animation-delay: -1ms;\n    -webkit-animation-duration: 1ms;\n            animation-duration: 1ms;\n    -webkit-animation-iteration-count: 1;\n            animation-iteration-count: 1;\n    -webkit-transition-delay: 0s;\n            transition-delay: 0s;\n    -webkit-transition-duration: 0s;\n            transition-duration: 0s;\n  }\n}\n@-webkit-keyframes fa-beat {\n  0%, 90% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  45% {\n    -webkit-transform: scale(var(--fa-beat-scale, 1.25));\n            transform: scale(var(--fa-beat-scale, 1.25));\n  }\n}\n@keyframes fa-beat {\n  0%, 90% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  45% {\n    -webkit-transform: scale(var(--fa-beat-scale, 1.25));\n            transform: scale(var(--fa-beat-scale, 1.25));\n  }\n}\n@-webkit-keyframes fa-bounce {\n  0% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  10% {\n    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n  }\n  30% {\n    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n  }\n  50% {\n    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n  }\n  57% {\n    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n  }\n  64% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  100% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n}\n@keyframes fa-bounce {\n  0% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  10% {\n    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n  }\n  30% {\n    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n  }\n  50% {\n    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n  }\n  57% {\n    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n  }\n  64% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  100% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n}\n@-webkit-keyframes fa-fade {\n  50% {\n    opacity: var(--fa-fade-opacity, 0.4);\n  }\n}\n@keyframes fa-fade {\n  50% {\n    opacity: var(--fa-fade-opacity, 0.4);\n  }\n}\n@-webkit-keyframes fa-beat-fade {\n  0%, 100% {\n    opacity: var(--fa-beat-fade-opacity, 0.4);\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  50% {\n    opacity: 1;\n    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));\n            transform: scale(var(--fa-beat-fade-scale, 1.125));\n  }\n}\n@keyframes fa-beat-fade {\n  0%, 100% {\n    opacity: var(--fa-beat-fade-opacity, 0.4);\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  50% {\n    opacity: 1;\n    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));\n            transform: scale(var(--fa-beat-fade-scale, 1.125));\n  }\n}\n@-webkit-keyframes fa-flip {\n  50% {\n    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n  }\n}\n@keyframes fa-flip {\n  50% {\n    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n  }\n}\n@-webkit-keyframes fa-shake {\n  0% {\n    -webkit-transform: rotate(-15deg);\n            transform: rotate(-15deg);\n  }\n  4% {\n    -webkit-transform: rotate(15deg);\n            transform: rotate(15deg);\n  }\n  8%, 24% {\n    -webkit-transform: rotate(-18deg);\n            transform: rotate(-18deg);\n  }\n  12%, 28% {\n    -webkit-transform: rotate(18deg);\n            transform: rotate(18deg);\n  }\n  16% {\n    -webkit-transform: rotate(-22deg);\n            transform: rotate(-22deg);\n  }\n  20% {\n    -webkit-transform: rotate(22deg);\n            transform: rotate(22deg);\n  }\n  32% {\n    -webkit-transform: rotate(-12deg);\n            transform: rotate(-12deg);\n  }\n  36% {\n    -webkit-transform: rotate(12deg);\n            transform: rotate(12deg);\n  }\n  40%, 100% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n}\n@keyframes fa-shake {\n  0% {\n    -webkit-transform: rotate(-15deg);\n            transform: rotate(-15deg);\n  }\n  4% {\n    -webkit-transform: rotate(15deg);\n            transform: rotate(15deg);\n  }\n  8%, 24% {\n    -webkit-transform: rotate(-18deg);\n            transform: rotate(-18deg);\n  }\n  12%, 28% {\n    -webkit-transform: rotate(18deg);\n            transform: rotate(18deg);\n  }\n  16% {\n    -webkit-transform: rotate(-22deg);\n            transform: rotate(-22deg);\n  }\n  20% {\n    -webkit-transform: rotate(22deg);\n            transform: rotate(22deg);\n  }\n  32% {\n    -webkit-transform: rotate(-12deg);\n            transform: rotate(-12deg);\n  }\n  36% {\n    -webkit-transform: rotate(12deg);\n            transform: rotate(12deg);\n  }\n  40%, 100% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n}\n@-webkit-keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n@keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n.fa-rotate-90 {\n  -webkit-transform: rotate(90deg);\n          transform: rotate(90deg);\n}\n\n.fa-rotate-180 {\n  -webkit-transform: rotate(180deg);\n          transform: rotate(180deg);\n}\n\n.fa-rotate-270 {\n  -webkit-transform: rotate(270deg);\n          transform: rotate(270deg);\n}\n\n.fa-flip-horizontal {\n  -webkit-transform: scale(-1, 1);\n          transform: scale(-1, 1);\n}\n\n.fa-flip-vertical {\n  -webkit-transform: scale(1, -1);\n          transform: scale(1, -1);\n}\n\n.fa-flip-both,\n.fa-flip-horizontal.fa-flip-vertical {\n  -webkit-transform: scale(-1, -1);\n          transform: scale(-1, -1);\n}\n\n.fa-rotate-by {\n  -webkit-transform: rotate(var(--fa-rotate-angle, none));\n          transform: rotate(var(--fa-rotate-angle, none));\n}\n\n.fa-stack {\n  display: inline-block;\n  vertical-align: middle;\n  height: 2em;\n  position: relative;\n  width: 2.5em;\n}\n\n.fa-stack-1x,\n.fa-stack-2x {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n  z-index: var(--fa-stack-z-index, auto);\n}\n\n.svg-inline--fa.fa-stack-1x {\n  height: 1em;\n  width: 1.25em;\n}\n.svg-inline--fa.fa-stack-2x {\n  height: 2em;\n  width: 2.5em;\n}\n\n.fa-inverse {\n  color: var(--fa-inverse, #fff);\n}\n\n.sr-only,\n.fa-sr-only {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.sr-only-focusable:not(:focus),\n.fa-sr-only-focusable:not(:focus) {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.svg-inline--fa .fa-primary {\n  fill: var(--fa-primary-color, currentColor);\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa .fa-secondary {\n  fill: var(--fa-secondary-color, currentColor);\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-primary {\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-secondary {\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa mask .fa-primary,\n.svg-inline--fa mask .fa-secondary {\n  fill: black;\n}\n\n.fad.fa-inverse,\n.fa-duotone.fa-inverse {\n  color: var(--fa-inverse, #fff);\n}';function q5(){var n=B5,e=V5,t=rt.cssPrefix,i=rt.replacementClass,r=Vhe;if(t!==n||i!==e){var s=new RegExp("\\.".concat(n,"\\-"),"g"),o=new RegExp("\\--".concat(n,"\\-"),"g"),a=new RegExp("\\.".concat(e),"g");r=r.replace(s,".".concat(t,"-")).replace(o,"--".concat(t,"-")).replace(a,".".concat(i))}return r}var X5=!1;function mN(){rt.autoAddCss&&!X5&&(function Lhe(n){if(n&&_c){var e=ai.createElement("style");e.setAttribute("type","text/css"),e.innerHTML=n;for(var t=ai.head.childNodes,i=null,r=t.length-1;r>-1;r--){var s=t[r],o=(s.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(o)>-1&&(i=s)}ai.head.insertBefore(e,i)}}(q5()),X5=!0)}var Hhe={mixout:function(){return{dom:{css:q5,insertCss:mN}}},hooks:function(){return{beforeDOMElementCreation:function(){mN()},beforeI2svg:function(){mN()}}}},vc=Wu||{};vc[yc]||(vc[yc]={}),vc[yc].styles||(vc[yc].styles={}),vc[yc].hooks||(vc[yc].hooks={}),vc[yc].shims||(vc[yc].shims=[]);var Ea=vc[yc],Y5=[],LC=!1;function I0(n){var e=n.tag,t=n.attributes,i=void 0===t?{}:t,r=n.children,s=void 0===r?[]:r;return"string"==typeof n?$5(n):"<".concat(e," ").concat(function khe(n){return Object.keys(n||{}).reduce(function(e,t){return e+"".concat(t,'="').concat($5(n[t]),'" ')},"").trim()}(i),">").concat(s.map(I0).join(""),"</").concat(e,">")}function K5(n,e,t){if(n&&n[e]&&n[e][t])return{prefix:e,iconName:t,icon:n[e][t]}}_c&&((LC=(ai.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(ai.readyState))||ai.addEventListener("DOMContentLoaded",function n(){ai.removeEventListener("DOMContentLoaded",n),LC=1,Y5.map(function(e){return e()})}));var gN=function(e,t,i,r){var l,c,d,s=Object.keys(e),o=s.length,a=void 0!==r?function(e,t){return function(i,r,s,o){return e.call(t,i,r,s,o)}}(t,r):t;for(void 0===i?(l=1,d=e[s[0]]):(l=0,d=i);l<o;l++)d=a(d,e[c=s[l]],c,e);return d};function _N(n){var e=function jhe(n){for(var e=[],t=0,i=n.length;t<i;){var r=n.charCodeAt(t++);if(r>=55296&&r<=56319&&t<i){var s=n.charCodeAt(t++);56320==(64512&s)?e.push(((1023&r)<<10)+(1023&s)+65536):(e.push(r),t--)}else e.push(r)}return e}(n);return 1===e.length?e[0].toString(16):null}function Z5(n){return Object.keys(n).reduce(function(e,t){var i=n[t];return i.icon?e[i.iconName]=i.icon:e[t]=i,e},{})}function yN(n,e){var i=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).skipHooks,r=void 0!==i&&i,s=Z5(e);"function"!=typeof Ea.hooks.addPack||r?Ea.styles[n]=Je(Je({},Ea.styles[n]||{}),s):Ea.hooks.addPack(n,Z5(e)),"fas"===n&&yN("fa",e)}var FC,kC,UC,vg=Ea.styles,qhe=Ea.shims,Xhe=(fr(FC={},li,Object.values(C0[li])),fr(FC,Ii,Object.values(C0[Ii])),FC),vN=null,J5={},Q5={},eW={},tW={},nW={},Yhe=(fr(kC={},li,Object.keys(S0[li])),fr(kC,Ii,Object.keys(S0[Ii])),kC);var iW=function(){var e=function(s){return gN(vg,function(o,a,l){return o[l]=gN(a,s,{}),o},{})};J5=e(function(r,s,o){return s[3]&&(r[s[3]]=o),s[2]&&s[2].filter(function(l){return"number"==typeof l}).forEach(function(l){r[l.toString(16)]=o}),r}),Q5=e(function(r,s,o){return r[o]=o,s[2]&&s[2].filter(function(l){return"string"==typeof l}).forEach(function(l){r[l]=o}),r}),nW=e(function(r,s,o){var a=s[2];return r[o]=o,a.forEach(function(l){r[l]=o}),r});var t="far"in vg||rt.autoFetchSvg,i=gN(qhe,function(r,s){var o=s[0],a=s[1],l=s[2];return"far"===a&&!t&&(a="fas"),"string"==typeof o&&(r.names[o]={prefix:a,iconName:l}),"number"==typeof o&&(r.unicodes[o.toString(16)]={prefix:a,iconName:l}),r},{names:{},unicodes:{}});eW=i.names,tW=i.unicodes,vN=BC(rt.styleDefault,{family:rt.familyDefault})};function wN(n,e){return(J5[n]||{})[e]}function kh(n,e){return(nW[n]||{})[e]}function rW(n){return eW[n]||{prefix:null,iconName:null}}function $u(){return vN}(function Ohe(n){A0.push(n)})(function(n){vN=BC(n.styleDefault,{family:rt.familyDefault})}),iW();var bN=function(){return{prefix:null,iconName:null,rest:[]}};function BC(n){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).family,i=void 0===t?li:t;return E0[i][n]||E0[i][S0[i][n]]||(n in Ea.styles?n:null)||null}var sW=(fr(UC={},li,Object.keys(C0[li])),fr(UC,Ii,Object.keys(C0[Ii])),UC);function VC(n){var e,i=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).skipLookups,r=void 0!==i&&i,s=(fr(e={},li,"".concat(rt.cssPrefix,"-").concat(li)),fr(e,Ii,"".concat(rt.cssPrefix,"-").concat(Ii)),e),o=null,a=li;(n.includes(s[li])||n.some(function(c){return sW[li].includes(c)}))&&(a=li),(n.includes(s[Ii])||n.some(function(c){return sW[Ii].includes(c)}))&&(a=Ii);var l=n.reduce(function(c,d){var h=function Zhe(n,e){var t=e.split("-"),i=t[0],r=t.slice(1).join("-");return i!==n||""===r||function Khe(n){return~Ihe.indexOf(n)}(r)?null:r}(rt.cssPrefix,d);if(vg[d]?(d=Xhe[a].includes(d)?Ehe[a][d]:d,o=d,c.prefix=d):Yhe[a].indexOf(d)>-1?(o=d,c.prefix=BC(d,{family:a})):h?c.iconName=h:d!==rt.replacementClass&&d!==s[li]&&d!==s[Ii]&&c.rest.push(d),!r&&c.prefix&&c.iconName){var p="fa"===o?rW(c.iconName):{},m=kh(c.prefix,c.iconName);p.prefix&&(o=null),c.iconName=p.iconName||m||c.iconName,c.prefix=p.prefix||c.prefix,"far"===c.prefix&&!vg.far&&vg.fas&&!rt.autoFetchSvg&&(c.prefix="fas")}return c},bN());return(n.includes("fa-brands")||n.includes("fab"))&&(l.prefix="fab"),(n.includes("fa-duotone")||n.includes("fad"))&&(l.prefix="fad"),!l.prefix&&a===Ii&&(vg.fass||rt.autoFetchSvg)&&(l.prefix="fass",l.iconName=kh(l.prefix,l.iconName)||l.iconName),("fa"===l.prefix||"fa"===o)&&(l.prefix=$u()||"fas"),l}var efe=function(){function n(){(function dhe(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")})(this,n),this.definitions={}}return function hhe(n,e,t){e&&D5(n.prototype,e),t&&D5(n,t),Object.defineProperty(n,"prototype",{writable:!1})}(n,[{key:"add",value:function(){for(var t=this,i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];var o=r.reduce(this._pullDefinitions,{});Object.keys(o).forEach(function(a){t.definitions[a]=Je(Je({},t.definitions[a]||{}),o[a]),yN(a,o[a]);var l=C0[li][a];l&&yN(l,o[a]),iW()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(t,i){var r=i.prefix&&i.iconName&&i.icon?{0:i}:i;return Object.keys(r).map(function(s){var o=r[s],a=o.prefix,l=o.iconName,c=o.icon,d=c[2];t[a]||(t[a]={}),d.length>0&&d.forEach(function(h){"string"==typeof h&&(t[a][h]=c)}),t[a][l]=c}),t}}]),n}(),oW=[],wg={},bg={},tfe=Object.keys(bg);function xN(n,e){for(var t=arguments.length,i=new Array(t>2?t-2:0),r=2;r<t;r++)i[r-2]=arguments[r];return(wg[n]||[]).forEach(function(o){e=o.apply(null,[e].concat(i))}),e}function Uh(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),i=1;i<e;i++)t[i-1]=arguments[i];(wg[n]||[]).forEach(function(s){s.apply(null,t)})}function wc(){var n=arguments[0],e=Array.prototype.slice.call(arguments,1);return bg[n]?bg[n].apply(null,e):void 0}function SN(n){"fa"===n.prefix&&(n.prefix="fas");var e=n.iconName,t=n.prefix||$u();if(e)return e=kh(t,e)||e,K5(aW.definitions,t,e)||K5(Ea.styles,t,e)}var aW=new efe,rfe={i2svg:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _c?(Uh("beforeI2svg",e),wc("pseudoElements2svg",e),wc("i2svg",e)):Promise.reject("Operation requires a DOM of some kind.")},watch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.autoReplaceSvgRoot;!1===rt.autoReplaceSvg&&(rt.autoReplaceSvg=!0),rt.observeMutations=!0,function Ghe(n){_c&&(LC?setTimeout(n,0):Y5.push(n))}(function(){ofe({autoReplaceSvgRoot:t}),Uh("watch",e)})}},mo={noAuto:function(){rt.autoReplaceSvg=!1,rt.observeMutations=!1,Uh("noAuto")},config:rt,dom:rfe,parse:{icon:function(e){if(null===e)return null;if("object"===MC(e)&&e.prefix&&e.iconName)return{prefix:e.prefix,iconName:kh(e.prefix,e.iconName)||e.iconName};if(Array.isArray(e)&&2===e.length){var t=0===e[1].indexOf("fa-")?e[1].slice(3):e[1],i=BC(e[0]);return{prefix:i,iconName:kh(i,t)||t}}if("string"==typeof e&&(e.indexOf("".concat(rt.cssPrefix,"-"))>-1||e.match(Che))){var r=VC(e.split(" "),{skipLookups:!0});return{prefix:r.prefix||$u(),iconName:kh(r.prefix,r.iconName)||r.iconName}}if("string"==typeof e){var s=$u();return{prefix:s,iconName:kh(s,e)||e}}}},library:aW,findIconDefinition:SN,toHtml:I0},ofe=function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).autoReplaceSvgRoot,i=void 0===t?ai:t;(Object.keys(Ea.styles).length>0||rt.autoFetchSvg)&&_c&&rt.autoReplaceSvg&&mo.dom.i2svg({node:i})};function HC(n,e){return Object.defineProperty(n,"abstract",{get:e}),Object.defineProperty(n,"html",{get:function(){return n.abstract.map(function(i){return I0(i)})}}),Object.defineProperty(n,"node",{get:function(){if(_c){var i=ai.createElement("div");return i.innerHTML=n.html,i.children}}}),n}function EN(n){var e=n.icons,t=e.main,i=e.mask,r=n.prefix,s=n.iconName,o=n.transform,a=n.symbol,l=n.title,c=n.maskId,d=n.titleId,h=n.extra,p=n.watchable,m=void 0!==p&&p,g=i.found?i:t,v=g.width,w=g.height,y="fak"===r,b=[rt.replacementClass,s?"".concat(rt.cssPrefix,"-").concat(s):""].filter(function(M){return-1===h.classes.indexOf(M)}).filter(function(M){return""!==M||!!M}).concat(h.classes).join(" "),x={children:[],attributes:Je(Je({},h.attributes),{},{"data-prefix":r,"data-icon":s,class:b,role:h.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(v," ").concat(w)})},E=y&&!~h.classes.indexOf("fa-fw")?{width:"".concat(v/w*16*.0625,"em")}:{};m&&(x.attributes[Lh]=""),l&&(x.children.push({tag:"title",attributes:{id:x.attributes["aria-labelledby"]||"title-".concat(d||D0())},children:[l]}),delete x.attributes.title);var C=Je(Je({},x),{},{prefix:r,iconName:s,main:t,mask:i,maskId:c,transform:o,symbol:a,styles:Je(Je({},E),h.styles)}),A=i.found&&t.found?wc("generateAbstractMask",C)||{children:[],attributes:{}}:wc("generateAbstractIcon",C)||{children:[],attributes:{}},L=A.attributes;return C.children=A.children,C.attributes=L,a?function lfe(n){var t=n.iconName,i=n.children,r=n.attributes,s=n.symbol,o=!0===s?"".concat(n.prefix,"-").concat(rt.cssPrefix,"-").concat(t):s;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:Je(Je({},r),{},{id:o}),children:i}]}]}(C):function afe(n){var e=n.children,t=n.main,i=n.mask,r=n.attributes,s=n.styles,o=n.transform;if(pN(o)&&t.found&&!i.found){var c={x:t.width/t.height/2,y:.5};r.style=OC(Je(Je({},s),{},{"transform-origin":"".concat(c.x+o.x/16,"em ").concat(c.y+o.y/16,"em")}))}return[{tag:"svg",attributes:r,children:e}]}(C)}function lW(n){var e=n.content,t=n.width,i=n.height,r=n.transform,s=n.title,o=n.extra,a=n.watchable,l=void 0!==a&&a,c=Je(Je(Je({},o.attributes),s?{title:s}:{}),{},{class:o.classes.join(" ")});l&&(c[Lh]="");var d=Je({},o.styles);pN(r)&&(d.transform=function Bhe(n){var e=n.transform,t=n.width,r=n.height,s=void 0===r?16:r,o=n.startCentered,a=void 0!==o&&o,l="";return l+=a&&U5?"translate(".concat(e.x/16-(void 0===t?16:t)/2,"em, ").concat(e.y/16-s/2,"em) "):a?"translate(calc(-50% + ".concat(e.x/16,"em), calc(-50% + ").concat(e.y/16,"em)) "):"translate(".concat(e.x/16,"em, ").concat(e.y/16,"em) "),(l+="scale(".concat(e.size/16*(e.flipX?-1:1),", ").concat(e.size/16*(e.flipY?-1:1),") "))+"rotate(".concat(e.rotate,"deg) ")}({transform:r,startCentered:!0,width:t,height:i}),d["-webkit-transform"]=d.transform);var h=OC(d);h.length>0&&(c.style=h);var p=[];return p.push({tag:"span",attributes:c,children:[e]}),s&&p.push({tag:"span",attributes:{class:"sr-only"},children:[s]}),p}var CN=Ea.styles;function MN(n){var e=n[0],t=n[1],s=sN(n.slice(4),1)[0];return{found:!0,width:e,height:t,icon:Array.isArray(s)?{tag:"g",attributes:{class:"".concat(rt.cssPrefix,"-").concat(Fh.GROUP)},children:[{tag:"path",attributes:{class:"".concat(rt.cssPrefix,"-").concat(Fh.SECONDARY),fill:"currentColor",d:s[0]}},{tag:"path",attributes:{class:"".concat(rt.cssPrefix,"-").concat(Fh.PRIMARY),fill:"currentColor",d:s[1]}}]}:{tag:"path",attributes:{fill:"currentColor",d:s}}}}var ufe={found:!1,width:512,height:512};function TN(n,e){var t=e;return"fa"===e&&null!==rt.styleDefault&&(e=$u()),new Promise(function(i,r){if(wc("missingIconAbstract"),"fa"===t){var o=rW(n)||{};n=o.iconName||n,e=o.prefix||e}if(n&&e&&CN[e]&&CN[e][n])return i(MN(CN[e][n]));(function dfe(n,e){!z5&&!rt.showMissingIcons&&n&&console.error('Icon with name "'.concat(n,'" and prefix "').concat(e,'" is missing.'))})(n,e),i(Je(Je({},ufe),{},{icon:rt.showMissingIcons&&n&&wc("missingIconAbstract")||{}}))})}var cW=function(){},AN=rt.measurePerformance&&AC&&AC.mark&&AC.measure?AC:{mark:cW,measure:cW},R0='FA "6.4.2"',uW=function(e){AN.mark("".concat(R0," ").concat(e," ends")),AN.measure("".concat(R0," ").concat(e),"".concat(R0," ").concat(e," begins"),"".concat(R0," ").concat(e," ends"))},DN={begin:function(e){return AN.mark("".concat(R0," ").concat(e," begins")),function(){return uW(e)}},end:uW},zC=function(){};function dW(n){return"string"==typeof(n.getAttribute?n.getAttribute(Lh):null)}function gfe(n){return ai.createElementNS("http://www.w3.org/2000/svg",n)}function _fe(n){return ai.createElement(n)}function hW(n){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).ceFn,i=void 0===t?"svg"===n.tag?gfe:_fe:t;if("string"==typeof n)return ai.createTextNode(n);var r=i(n.tag);return Object.keys(n.attributes||[]).forEach(function(o){r.setAttribute(o,n.attributes[o])}),(n.children||[]).forEach(function(o){r.appendChild(hW(o,{ceFn:i}))}),r}var GC={replace:function(e){var t=e[0];if(t.parentNode)if(e[1].forEach(function(r){t.parentNode.insertBefore(hW(r),t)}),null===t.getAttribute(Lh)&&rt.keepOriginalSource){var i=ai.createComment(function yfe(n){var e=" ".concat(n.outerHTML," ");return"".concat(e,"Font Awesome fontawesome.com ")}(t));t.parentNode.replaceChild(i,t)}else t.remove()},nest:function(e){var t=e[0],i=e[1];if(~fN(t).indexOf(rt.replacementClass))return GC.replace(e);var r=new RegExp("".concat(rt.cssPrefix,"-.*"));if(delete i[0].attributes.id,i[0].attributes.class){var s=i[0].attributes.class.split(" ").reduce(function(a,l){return l===rt.replacementClass||l.match(r)?a.toSvg.push(l):a.toNode.push(l),a},{toNode:[],toSvg:[]});i[0].attributes.class=s.toSvg.join(" "),0===s.toNode.length?t.removeAttribute("class"):t.setAttribute("class",s.toNode.join(" "))}var o=i.map(function(a){return I0(a)}).join("\n");t.setAttribute(Lh,""),t.innerHTML=o}};function fW(n){n()}function pW(n,e){var t="function"==typeof e?e:zC;if(0===n.length)t();else{var i=fW;rt.mutateApproach===xhe&&(i=Wu.requestAnimationFrame||fW),i(function(){var r=function mfe(){return!0===rt.autoReplaceSvg?GC.replace:GC[rt.autoReplaceSvg]||GC.replace}(),s=DN.begin("mutate");n.map(r),s(),t()})}}var IN=!1;function mW(){IN=!0}function RN(){IN=!1}var WC=null;function gW(n){if(k5&&rt.observeMutations){var e=n.treeCallback,t=void 0===e?zC:e,i=n.nodeCallback,r=void 0===i?zC:i,s=n.pseudoElementsCallback,o=void 0===s?zC:s,a=n.observeMutationsRoot,l=void 0===a?ai:a;WC=new k5(function(c){if(!IN){var d=$u();yg(c).forEach(function(h){if("childList"===h.type&&h.addedNodes.length>0&&!dW(h.addedNodes[0])&&(rt.searchPseudoElements&&o(h.target),t(h.target)),"attributes"===h.type&&h.target.parentNode&&rt.searchPseudoElements&&o(h.target.parentNode),"attributes"===h.type&&dW(h.target)&&~Dhe.indexOf(h.attributeName))if("class"===h.attributeName&&function ffe(n){var e=n.getAttribute?n.getAttribute(uN):null,t=n.getAttribute?n.getAttribute(dN):null;return e&&t}(h.target)){var p=VC(fN(h.target)),g=p.iconName;h.target.setAttribute(uN,p.prefix||d),g&&h.target.setAttribute(dN,g)}else(function pfe(n){return n&&n.classList&&n.classList.contains&&n.classList.contains(rt.replacementClass)})(h.target)&&r(h.target)})}}),_c&&WC.observe(l,{childList:!0,attributes:!0,characterData:!0,subtree:!0})}}function _W(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{styleParser:!0},t=function bfe(n){var e=n.getAttribute("data-prefix"),t=n.getAttribute("data-icon"),i=void 0!==n.innerText?n.innerText.trim():"",r=VC(fN(n));return r.prefix||(r.prefix=$u()),e&&t&&(r.prefix=e,r.iconName=t),r.iconName&&r.prefix||(r.prefix&&i.length>0&&(r.iconName=function Jhe(n,e){return(Q5[n]||{})[e]}(r.prefix,n.innerText)||wN(r.prefix,_N(n.innerText))),!r.iconName&&rt.autoFetchSvg&&n.firstChild&&n.firstChild.nodeType===Node.TEXT_NODE&&(r.iconName=n.firstChild.data)),r}(n),i=t.iconName,r=t.prefix,s=t.rest,o=function xfe(n){var e=yg(n.attributes).reduce(function(r,s){return"class"!==r.name&&"style"!==r.name&&(r[s.name]=s.value),r},{}),t=n.getAttribute("title"),i=n.getAttribute("data-fa-title-id");return rt.autoA11y&&(t?e["aria-labelledby"]="".concat(rt.replacementClass,"-title-").concat(i||D0()):(e["aria-hidden"]="true",e.focusable="false")),e}(n),a=xN("parseNodeAttributes",{},n),l=e.styleParser?function wfe(n){var e=n.getAttribute("style"),t=[];return e&&(t=e.split(";").reduce(function(i,r){var s=r.split(":"),o=s[0],a=s.slice(1);return o&&a.length>0&&(i[o]=a.join(":").trim()),i},{})),t}(n):[];return Je({iconName:i,title:n.getAttribute("title"),titleId:n.getAttribute("data-fa-title-id"),prefix:r,transform:hl,mask:{iconName:null,prefix:null,rest:[]},maskId:null,symbol:!1,extra:{classes:s,styles:l,attributes:o}},a)}var Efe=Ea.styles;function yW(n){var e="nest"===rt.autoReplaceSvg?_W(n,{styleParser:!1}):_W(n);return~e.extra.classes.indexOf(G5)?wc("generateLayersText",n,e):wc("generateSvgReplacementMutation",n,e)}var qu=new Set;function vW(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!_c)return Promise.resolve();var t=ai.documentElement.classList,i=function(h){return t.add("".concat(H5,"-").concat(h))},r=function(h){return t.remove("".concat(H5,"-").concat(h))},s=rt.autoFetchSvg?qu:hN.map(function(d){return"fa-".concat(d)}).concat(Object.keys(Efe));s.includes("fa")||s.push("fa");var o=[".".concat(G5,":not([").concat(Lh,"])")].concat(s.map(function(d){return".".concat(d,":not([").concat(Lh,"])")})).join(", ");if(0===o.length)return Promise.resolve();var a=[];try{a=yg(n.querySelectorAll(o))}catch{}if(!(a.length>0))return Promise.resolve();i("pending"),r("complete");var l=DN.begin("onTree"),c=a.reduce(function(d,h){try{var p=yW(h);p&&d.push(p)}catch(m){z5||"MissingIcon"===m.name&&console.error(m)}return d},[]);return new Promise(function(d,h){Promise.all(c).then(function(p){pW(p,function(){i("active"),i("complete"),r("pending"),"function"==typeof e&&e(),l(),d()})}).catch(function(p){l(),h(p)})})}function Cfe(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;yW(n).then(function(t){t&&pW([t],e)})}function Mfe(n){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=(e||{}).icon?e:SN(e||{}),r=t.mask;return r&&(r=(r||{}).icon?r:SN(r||{})),n(i,Je(Je({},t),{},{mask:r}))}}hN.map(function(n){qu.add("fa-".concat(n))}),Object.keys(S0[li]).map(qu.add.bind(qu)),Object.keys(S0[Ii]).map(qu.add.bind(qu)),qu=b0(qu);var Tfe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.transform,r=void 0===i?hl:i,s=t.symbol,o=void 0!==s&&s,a=t.mask,l=void 0===a?null:a,c=t.maskId,d=void 0===c?null:c,h=t.title,p=void 0===h?null:h,m=t.titleId,g=void 0===m?null:m,v=t.classes,w=void 0===v?[]:v,y=t.attributes,b=void 0===y?{}:y,x=t.styles,E=void 0===x?{}:x;if(e){var C=e.prefix,A=e.iconName,D=e.icon;return HC(Je({type:"icon"},e),function(){return Uh("beforeDOMElementCreation",{iconDefinition:e,params:t}),rt.autoA11y&&(p?b["aria-labelledby"]="".concat(rt.replacementClass,"-title-").concat(g||D0()):(b["aria-hidden"]="true",b.focusable="false")),EN({icons:{main:MN(D),mask:l?MN(l.icon):{found:!1,width:null,height:null,icon:{}}},prefix:C,iconName:A,transform:Je(Je({},hl),r),symbol:o,title:p,maskId:d,titleId:g,extra:{attributes:b,styles:E,classes:w}})})}},Afe={mixout:function(){return{icon:Mfe(Tfe)}},hooks:function(){return{mutationObserverCallbacks:function(t){return t.treeCallback=vW,t.nodeCallback=Cfe,t}}},provides:function(e){e.i2svg=function(t){var i=t.node,s=t.callback;return vW(void 0===i?ai:i,void 0===s?function(){}:s)},e.generateSvgReplacementMutation=function(t,i){var r=i.iconName,s=i.title,o=i.titleId,a=i.prefix,l=i.transform,c=i.symbol,d=i.mask,h=i.maskId,p=i.extra;return new Promise(function(m,g){Promise.all([TN(r,a),d.iconName?TN(d.iconName,d.prefix):Promise.resolve({found:!1,width:512,height:512,icon:{}})]).then(function(v){var w=sN(v,2);m([t,EN({icons:{main:w[0],mask:w[1]},prefix:a,iconName:r,transform:l,symbol:c,maskId:h,title:s,titleId:o,extra:p,watchable:!0})])}).catch(g)})},e.generateAbstractIcon=function(t){var c,i=t.children,r=t.attributes,s=t.main,o=t.transform,l=OC(t.styles);return l.length>0&&(r.style=l),pN(o)&&(c=wc("generateAbstractTransformGrouping",{main:s,transform:o,containerWidth:s.width,iconWidth:s.width})),i.push(c||s.icon),{children:i,attributes:r}}}},Dfe={mixout:function(){return{layer:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=i.classes,s=void 0===r?[]:r;return HC({type:"layer"},function(){Uh("beforeDOMElementCreation",{assembler:t,params:i});var o=[];return t(function(a){Array.isArray(a)?a.map(function(l){o=o.concat(l.abstract)}):o=o.concat(a.abstract)}),[{tag:"span",attributes:{class:["".concat(rt.cssPrefix,"-layers")].concat(b0(s)).join(" ")},children:o}]})}}}},Ife={mixout:function(){return{counter:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=i.title,s=void 0===r?null:r,o=i.classes,a=void 0===o?[]:o,l=i.attributes,c=void 0===l?{}:l,d=i.styles,h=void 0===d?{}:d;return HC({type:"counter",content:t},function(){return Uh("beforeDOMElementCreation",{content:t,params:i}),function cfe(n){var e=n.content,t=n.title,i=n.extra,r=Je(Je(Je({},i.attributes),t?{title:t}:{}),{},{class:i.classes.join(" ")}),s=OC(i.styles);s.length>0&&(r.style=s);var o=[];return o.push({tag:"span",attributes:r,children:[e]}),t&&o.push({tag:"span",attributes:{class:"sr-only"},children:[t]}),o}({content:t.toString(),title:s,extra:{attributes:c,styles:h,classes:["".concat(rt.cssPrefix,"-layers-counter")].concat(b0(a))}})})}}}},Rfe={mixout:function(){return{text:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=i.transform,s=void 0===r?hl:r,o=i.title,a=void 0===o?null:o,l=i.classes,c=void 0===l?[]:l,d=i.attributes,h=void 0===d?{}:d,p=i.styles,m=void 0===p?{}:p;return HC({type:"text",content:t},function(){return Uh("beforeDOMElementCreation",{content:t,params:i}),lW({content:t,transform:Je(Je({},hl),s),title:a,extra:{attributes:h,styles:m,classes:["".concat(rt.cssPrefix,"-layers-text")].concat(b0(c))}})})}}},provides:function(e){e.generateLayersText=function(t,i){var r=i.title,s=i.transform,o=i.extra,a=null,l=null;if(U5){var c=parseInt(getComputedStyle(t).fontSize,10),d=t.getBoundingClientRect();a=d.width/c,l=d.height/c}return rt.autoA11y&&!r&&(o.attributes["aria-hidden"]="true"),Promise.resolve([t,lW({content:t.innerHTML,width:a,height:l,transform:s,title:r,extra:o,watchable:!0})])}}},Pfe=new RegExp('"',"ug"),wW=[1105920,1112319];function bW(n,e){var t="".concat(bhe).concat(e.replace(":","-"));return new Promise(function(i,r){if(null!==n.getAttribute(t))return i();var o=yg(n.children).filter(function(D){return D.getAttribute(cN)===e})[0],a=Wu.getComputedStyle(n,e),l=a.getPropertyValue("font-family").match(Mhe),c=a.getPropertyValue("font-weight"),d=a.getPropertyValue("content");if(o&&!l)return n.removeChild(o),i();if(l&&"none"!==d&&""!==d){var h=a.getPropertyValue("content"),p=~["Sharp"].indexOf(l[2])?Ii:li,m=~["Solid","Regular","Light","Thin","Duotone","Brands","Kit"].indexOf(l[2])?E0[p][l[2].toLowerCase()]:The[p][c],g=function Nfe(n){var e=n.replace(Pfe,""),t=function $he(n,e){var r,t=n.length,i=n.charCodeAt(e);return i>=55296&&i<=56319&&t>e+1&&(r=n.charCodeAt(e+1))>=56320&&r<=57343?1024*(i-55296)+r-56320+65536:i}(e,0),i=t>=wW[0]&&t<=wW[1],r=2===e.length&&e[0]===e[1];return{value:_N(r?e[0]:e),isSecondary:i||r}}(h),v=g.value,w=g.isSecondary,y=l[0].startsWith("FontAwesome"),b=wN(m,v),x=b;if(y){var E=function Qhe(n){var e=tW[n],t=wN("fas",n);return e||(t?{prefix:"fas",iconName:t}:null)||{prefix:null,iconName:null}}(v);E.iconName&&E.prefix&&(b=E.iconName,m=E.prefix)}if(!b||w||o&&o.getAttribute(uN)===m&&o.getAttribute(dN)===x)i();else{n.setAttribute(t,x),o&&n.removeChild(o);var C=function Sfe(){return{iconName:null,title:null,titleId:null,prefix:null,transform:hl,symbol:!1,mask:{iconName:null,prefix:null,rest:[]},maskId:null,extra:{classes:[],styles:{},attributes:{}}}}(),A=C.extra;A.attributes[cN]=e,TN(b,m).then(function(D){var L=EN(Je(Je({},C),{},{icons:{main:D,mask:bN()},prefix:m,iconName:x,extra:A,watchable:!0})),M=ai.createElementNS("http://www.w3.org/2000/svg","svg");"::before"===e?n.insertBefore(M,n.firstChild):n.appendChild(M),M.outerHTML=L.map(function(R){return I0(R)}).join("\n"),n.removeAttribute(t),i()}).catch(r)}}else i()})}function Ofe(n){return Promise.all([bW(n,"::before"),bW(n,"::after")])}function Lfe(n){return!(n.parentNode===document.head||~She.indexOf(n.tagName.toUpperCase())||n.getAttribute(cN)||n.parentNode&&"svg"===n.parentNode.tagName)}function xW(n){if(_c)return new Promise(function(e,t){var i=yg(n.querySelectorAll("*")).filter(Lfe).map(Ofe),r=DN.begin("searchPseudoElements");mW(),Promise.all(i).then(function(){r(),RN(),e()}).catch(function(){r(),RN(),t()})})}var SW=!1,EW=function(e){return e.toLowerCase().split(" ").reduce(function(i,r){var s=r.toLowerCase().split("-"),o=s[0],a=s.slice(1).join("-");if(o&&"h"===a)return i.flipX=!0,i;if(o&&"v"===a)return i.flipY=!0,i;if(a=parseFloat(a),isNaN(a))return i;switch(o){case"grow":i.size=i.size+a;break;case"shrink":i.size=i.size-a;break;case"left":i.x=i.x-a;break;case"right":i.x=i.x+a;break;case"up":i.y=i.y-a;break;case"down":i.y=i.y+a;break;case"rotate":i.rotate=i.rotate+a}return i},{size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0})},PN={x:0,y:0,width:"100%",height:"100%"};function CW(n){return n.attributes&&(n.attributes.fill||!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(n.attributes.fill="black"),n}function Bfe(n){return"g"===n.tag?n.children:[n]}var Vfe={hooks:function(){return{parseNodeAttributes:function(t,i){var r=i.getAttribute("data-fa-mask"),s=r?VC(r.split(" ").map(function(o){return o.trim()})):bN();return s.prefix||(s.prefix=$u()),t.mask=s,t.maskId=i.getAttribute("data-fa-mask-id"),t}}},provides:function(e){e.generateAbstractMask=function(t){var i=t.children,r=t.attributes,s=t.main,o=t.mask,a=t.maskId,d=s.icon,p=o.icon,m=function Uhe(n){var e=n.transform,i=n.iconWidth,r={transform:"translate(".concat(n.containerWidth/2," 256)")},s="translate(".concat(32*e.x,", ").concat(32*e.y,") "),o="scale(".concat(e.size/16*(e.flipX?-1:1),", ").concat(e.size/16*(e.flipY?-1:1),") "),a="rotate(".concat(e.rotate," 0 0)");return{outer:r,inner:{transform:"".concat(s," ").concat(o," ").concat(a)},path:{transform:"translate(".concat(i/2*-1," -256)")}}}({transform:t.transform,containerWidth:o.width,iconWidth:s.width}),g={tag:"rect",attributes:Je(Je({},PN),{},{fill:"white"})},v=d.children?{children:d.children.map(CW)}:{},w={tag:"g",attributes:Je({},m.inner),children:[CW(Je({tag:d.tag,attributes:Je(Je({},d.attributes),m.path)},v))]},y={tag:"g",attributes:Je({},m.outer),children:[w]},b="mask-".concat(a||D0()),x="clip-".concat(a||D0()),E={tag:"mask",attributes:Je(Je({},PN),{},{id:b,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[g,y]},C={tag:"defs",children:[{tag:"clipPath",attributes:{id:x},children:Bfe(p)},E]};return i.push(C,{tag:"rect",attributes:Je({fill:"currentColor","clip-path":"url(#".concat(x,")"),mask:"url(#".concat(b,")")},PN)}),{children:i,attributes:r}}}};!function nfe(n,e){var t=e.mixoutsTo;oW=n,wg={},Object.keys(bg).forEach(function(i){-1===tfe.indexOf(i)&&delete bg[i]}),oW.forEach(function(i){var r=i.mixout?i.mixout():{};if(Object.keys(r).forEach(function(o){"function"==typeof r[o]&&(t[o]=r[o]),"object"===MC(r[o])&&Object.keys(r[o]).forEach(function(a){t[o]||(t[o]={}),t[o][a]=r[o][a]})}),i.hooks){var s=i.hooks();Object.keys(s).forEach(function(o){wg[o]||(wg[o]=[]),wg[o].push(s[o])})}i.provides&&i.provides(bg)})}([Hhe,Afe,Dfe,Ife,Rfe,{hooks:function(){return{mutationObserverCallbacks:function(t){return t.pseudoElementsCallback=xW,t}}},provides:function(e){e.pseudoElements2svg=function(t){var i=t.node;rt.searchPseudoElements&&xW(void 0===i?ai:i)}}},{mixout:function(){return{dom:{unwatch:function(){mW(),SW=!0}}}},hooks:function(){return{bootstrap:function(){gW(xN("mutationObserverCallbacks",{}))},noAuto:function(){!function vfe(){WC&&WC.disconnect()}()},watch:function(t){var i=t.observeMutationsRoot;SW?RN():gW(xN("mutationObserverCallbacks",{observeMutationsRoot:i}))}}}},{mixout:function(){return{parse:{transform:function(t){return EW(t)}}}},hooks:function(){return{parseNodeAttributes:function(t,i){var r=i.getAttribute("data-fa-transform");return r&&(t.transform=EW(r)),t}}},provides:function(e){e.generateAbstractTransformGrouping=function(t){var i=t.main,r=t.transform,o=t.iconWidth,a={transform:"translate(".concat(t.containerWidth/2," 256)")},l="translate(".concat(32*r.x,", ").concat(32*r.y,") "),c="scale(".concat(r.size/16*(r.flipX?-1:1),", ").concat(r.size/16*(r.flipY?-1:1),") "),d="rotate(".concat(r.rotate," 0 0)"),m={outer:a,inner:{transform:"".concat(l," ").concat(c," ").concat(d)},path:{transform:"translate(".concat(o/2*-1," -256)")}};return{tag:"g",attributes:Je({},m.outer),children:[{tag:"g",attributes:Je({},m.inner),children:[{tag:i.icon.tag,children:i.icon.children,attributes:Je(Je({},i.icon.attributes),m.path)}]}]}}}},Vfe,{provides:function(e){var t=!1;Wu.matchMedia&&(t=Wu.matchMedia("(prefers-reduced-motion: reduce)").matches),e.missingIconAbstract=function(){var i=[],r={fill:"currentColor"},s={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};i.push({tag:"path",attributes:Je(Je({},r),{},{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"})});var o=Je(Je({},s),{},{attributeName:"opacity"}),a={tag:"circle",attributes:Je(Je({},r),{},{cx:"256",cy:"364",r:"28"}),children:[]};return t||a.children.push({tag:"animate",attributes:Je(Je({},s),{},{attributeName:"r",values:"28;14;28;28;14;28;"})},{tag:"animate",attributes:Je(Je({},o),{},{values:"1;0;1;1;0;1;"})}),i.push(a),i.push({tag:"path",attributes:Je(Je({},r),{},{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),children:t?[]:[{tag:"animate",attributes:Je(Je({},o),{},{values:"1;0;0;0;0;1;"})}]}),t||i.push({tag:"path",attributes:Je(Je({},r),{},{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),children:[{tag:"animate",attributes:Je(Je({},o),{},{values:"0;0;1;1;0;0;"})}]}),{tag:"g",attributes:{class:"missing"},children:i}}}},{hooks:function(){return{parseNodeAttributes:function(t,i){var r=i.getAttribute("data-fa-symbol");return t.symbol=null!==r&&(""===r||r),t}}}}],{mixoutsTo:mo});let jfe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Oi({type:n});static#n=this.\u0275inj=wi({})}return n})(),$fe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Oi({type:n,bootstrap:[Yde]});static#n=this.\u0275inj=wi({imports:[GU,JK,rJ,Xde,Sde,uhe,Bue,Ode,jfe]})}return n})();YX().bootstrapModule($fe).catch(n=>console.error(n))},990:function(qs,xc,Hh){var _n;qs=Hh.nmd(qs),function(){var B,is="Expected a function",zh="__lodash_hash_undefined__",ml="__lodash_placeholder__",Tn=1/0,qo=9007199254740991,vo=4294967295,F0=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],Wn="[object Arguments]",ei="[object Array]",tn="[object Boolean]",gl="[object Date]",Mc="[object Error]",$h="[object Function]",k0="[object GeneratorFunction]",Xs="[object Map]",qh="[object Number]",Ta="[object Object]",QC="[object Promise]",Tc="[object RegExp]",Ys="[object Set]",_l="[object String]",Xh="[object Symbol]",Ac="[object WeakMap]",Ku="[object ArrayBuffer]",Dc="[object DataView]",wo="[object Float32Array]",Yh="[object Float64Array]",Mg="[object Int8Array]",Kh="[object Int16Array]",Tg="[object Int32Array]",Ag="[object Uint8Array]",Dg="[object Uint8ClampedArray]",Ig="[object Uint16Array]",Rg="[object Uint32Array]",nM=/\b__p \+= '';/g,iM=/\b(__p \+=) '' \+/g,rM=/(__e\(.*?\)|\b__t\)) \+\n'';/g,U0=/&(?:amp|lt|gt|quot|#39);/g,B0=/[&<>"']/g,UN=RegExp(U0.source),V0=RegExp(B0.source),H0=/<%-([\s\S]+?)%>/g,z0=/<%([\s\S]+?)%>/g,Pg=/<%=([\s\S]+?)%>/g,G0=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,sM=/^\w*$/,W0=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Zh=/[\\^$.*+?()[\]{}|]/g,j0=RegExp(Zh.source),Jh=/^\s+/,os=/\s/,oM=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,aM=/\{\n\/\* \[wrapped with (.+)\] \*/,lM=/,? & /,cM=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,$0=/[()=,{}\[\]\/\s]/,uM=/\\(\\)?/g,dM=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,bo=/\w*$/,hM=/^[-+]0x[0-9a-f]+$/i,nr=/^0b[01]+$/i,Ic=/^\[object .+?Constructor\]$/,xo=/^0o[0-7]+$/i,BN=/^(?:0|[1-9]\d*)$/,fM=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Qh=/($^)/,Ng=/['\n\r\u2028\u2029\\]/g,Zu="\\ud800-\\udfff",Og="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",X0="\\u2700-\\u27bf",Y0="a-z\\xdf-\\xf6\\xf8-\\xff",Z0="A-Z\\xc0-\\xd6\\xd8-\\xde",vi="\\ufe0e\\ufe0f",J0="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",wt="["+Zu+"]",Lg="["+J0+"]",Rc="["+Og+"]",As="\\d+",yM="["+X0+"]",Q0="["+Y0+"]",mn="[^"+Zu+J0+As+X0+Y0+Z0+"]",Pc="\\ud83c[\\udffb-\\udfff]",ef="[^"+Zu+"]",Fg="(?:\\ud83c[\\udde6-\\uddff]){2}",yn="[\\ud800-\\udbff][\\udc00-\\udfff]",dt="["+Z0+"]",nf="(?:"+Q0+"|"+mn+")",VN="(?:"+dt+"|"+mn+")",kg="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",ae="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",Qu="(?:"+Rc+"|"+Pc+")?",Tt="["+vi+"]?",ew=Tt+Qu+"(?:\\u200d(?:"+[ef,Fg,yn].join("|")+")"+Tt+Qu+")*",Ug="(?:"+[yM,Fg,yn].join("|")+")"+ew,as="(?:"+[ef+Rc+"?",Rc,Fg,yn,wt].join("|")+")",zN=RegExp("['\u2019]","g"),wM=RegExp(Rc,"g"),tw=RegExp(Pc+"(?="+Pc+")|"+as+ew,"g"),yl=RegExp([dt+"?"+Q0+"+"+kg+"(?="+[Lg,dt,"$"].join("|")+")",VN+"+"+ae+"(?="+[Lg,dt+nf,"$"].join("|")+")",dt+"?"+nf+"+"+kg,dt+"+"+ae,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",As,Ug].join("|"),"g"),GN=RegExp("[\\u200d"+Zu+Og+vi+"]"),WN=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,jN=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],$N=-1,Fn={};Fn[wo]=Fn[Yh]=Fn[Mg]=Fn[Kh]=Fn[Tg]=Fn[Ag]=Fn[Dg]=Fn[Ig]=Fn[Rg]=!0,Fn[Wn]=Fn[ei]=Fn[Ku]=Fn[tn]=Fn[Dc]=Fn[gl]=Fn[Mc]=Fn[$h]=Fn[Xs]=Fn[qh]=Fn[Ta]=Fn[Tc]=Fn[Ys]=Fn[_l]=Fn[Ac]=!1;var kn={};kn[Wn]=kn[ei]=kn[Ku]=kn[Dc]=kn[tn]=kn[gl]=kn[wo]=kn[Yh]=kn[Mg]=kn[Kh]=kn[Tg]=kn[Xs]=kn[qh]=kn[Ta]=kn[Tc]=kn[Ys]=kn[_l]=kn[Xh]=kn[Ag]=kn[Dg]=kn[Ig]=kn[Rg]=!0,kn[Mc]=kn[$h]=kn[Ac]=!1;var bt={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},XN=parseFloat,YN=parseInt,xM="object"==typeof global&&global&&global.Object===Object&&global,Qe="object"==typeof self&&self&&self.Object===Object&&self,pr=xM||Qe||Function("return this")(),wi=xc&&!xc.nodeType&&xc,Aa=wi&&qs&&!qs.nodeType&&qs,nw=Aa&&Aa.exports===wi,rf=nw&&xM.process,Is=function(){try{return Aa&&Aa.require&&Aa.require("util").types||rf&&rf.binding&&rf.binding("util")}catch{}}(),ed=Is&&Is.isArrayBuffer,td=Is&&Is.isDate,sf=Is&&Is.isMap,Bg=Is&&Is.isRegExp,iw=Is&&Is.isSet,Xt=Is&&Is.isTypedArray;function Mr(Y,ue,re){switch(re.length){case 0:return Y.call(ue);case 1:return Y.call(ue,re[0]);case 2:return Y.call(ue,re[0],re[1]);case 3:return Y.call(ue,re[0],re[1],re[2])}return Y.apply(ue,re)}function rw(Y,ue,re,Ue){for(var Pt=-1,fn=null==Y?0:Y.length;++Pt<fn;){var Ni=Y[Pt];ue(Ue,Ni,re(Ni),Y)}return Ue}function Un(Y,ue){for(var re=-1,Ue=null==Y?0:Y.length;++re<Ue&&!1!==ue(Y[re],re,Y););return Y}function sw(Y,ue){for(var re=null==Y?0:Y.length;re--&&!1!==ue(Y[re],re,Y););return Y}function SM(Y,ue){for(var re=-1,Ue=null==Y?0:Y.length;++re<Ue;)if(!ue(Y[re],re,Y))return!1;return!0}function un(Y,ue){for(var re=-1,Ue=null==Y?0:Y.length,Pt=0,fn=[];++re<Ue;){var Ni=Y[re];ue(Ni,re,Y)&&(fn[Pt++]=Ni)}return fn}function Vg(Y,ue){return!(null==Y||!Y.length)&&nd(Y,ue,0)>-1}function ow(Y,ue,re){for(var Ue=-1,Pt=null==Y?0:Y.length;++Ue<Pt;)if(re(ue,Y[Ue]))return!0;return!1}function Rn(Y,ue){for(var re=-1,Ue=null==Y?0:Y.length,Pt=Array(Ue);++re<Ue;)Pt[re]=ue(Y[re],re,Y);return Pt}function So(Y,ue){for(var re=-1,Ue=ue.length,Pt=Y.length;++re<Ue;)Y[Pt+re]=ue[re];return Y}function af(Y,ue,re,Ue){var Pt=-1,fn=null==Y?0:Y.length;for(Ue&&fn&&(re=Y[++Pt]);++Pt<fn;)re=ue(re,Y[Pt],Pt,Y);return re}function Hg(Y,ue,re,Ue){var Pt=null==Y?0:Y.length;for(Ue&&Pt&&(re=Y[--Pt]);Pt--;)re=ue(re,Y[Pt],Pt,Y);return re}function zg(Y,ue){for(var re=-1,Ue=null==Y?0:Y.length;++re<Ue;)if(ue(Y[re],re,Y))return!0;return!1}var Gg=jg("length");function EM(Y,ue,re){var Ue;return re(Y,function(Pt,fn,Ni){if(ue(Pt,fn,Ni))return Ue=fn,!1}),Ue}function Wg(Y,ue,re,Ue){for(var Pt=Y.length,fn=re+(Ue?1:-1);Ue?fn--:++fn<Pt;)if(ue(Y[fn],fn,Y))return fn;return-1}function nd(Y,ue,re){return ue==ue?function Ko(Y,ue,re){for(var Ue=re-1,Pt=Y.length;++Ue<Pt;)if(Y[Ue]===ue)return Ue;return-1}(Y,ue,re):Wg(Y,lf,re)}function id(Y,ue,re,Ue){for(var Pt=re-1,fn=Y.length;++Pt<fn;)if(Ue(Y[Pt],ue))return Pt;return-1}function lf(Y){return Y!=Y}function rd(Y,ue){var re=null==Y?0:Y.length;return re?Da(Y,ue)/re:NaN}function jg(Y){return function(ue){return null==ue?B:ue[Y]}}function $g(Y){return function(ue){return null==Y?B:Y[ue]}}function aw(Y,ue,re,Ue,Pt){return Pt(Y,function(fn,Ni,An){re=Ue?(Ue=!1,fn):ue(re,fn,Ni,An)}),re}function Da(Y,ue){for(var re,Ue=-1,Pt=Y.length;++Ue<Pt;){var fn=ue(Y[Ue]);fn!==B&&(re=re===B?fn:re+fn)}return re}function qg(Y,ue){for(var re=-1,Ue=Array(Y);++re<Y;)Ue[re]=ue(re);return Ue}function cw(Y){return Y&&Y.slice(0,df(Y)+1).replace(Jh,"")}function Le(Y){return function(ue){return Y(ue)}}function cf(Y,ue){return Rn(ue,function(re){return Y[re]})}function ze(Y,ue){return Y.has(ue)}function sd(Y,ue){for(var re=-1,Ue=Y.length;++re<Ue&&nd(ue,Y[re],0)>-1;);return re}function uf(Y,ue){for(var re=Y.length;re--&&nd(ue,Y[re],0)>-1;);return re}var CM=$g({\u00c0:"A",\u00c1:"A",\u00c2:"A",\u00c3:"A",\u00c4:"A",\u00c5:"A",\u00e0:"a",\u00e1:"a",\u00e2:"a",\u00e3:"a",\u00e4:"a",\u00e5:"a",\u00c7:"C",\u00e7:"c",\u00d0:"D",\u00f0:"d",\u00c8:"E",\u00c9:"E",\u00ca:"E",\u00cb:"E",\u00e8:"e",\u00e9:"e",\u00ea:"e",\u00eb:"e",\u00cc:"I",\u00cd:"I",\u00ce:"I",\u00cf:"I",\u00ec:"i",\u00ed:"i",\u00ee:"i",\u00ef:"i",\u00d1:"N",\u00f1:"n",\u00d2:"O",\u00d3:"O",\u00d4:"O",\u00d5:"O",\u00d6:"O",\u00d8:"O",\u00f2:"o",\u00f3:"o",\u00f4:"o",\u00f5:"o",\u00f6:"o",\u00f8:"o",\u00d9:"U",\u00da:"U",\u00db:"U",\u00dc:"U",\u00f9:"u",\u00fa:"u",\u00fb:"u",\u00fc:"u",\u00dd:"Y",\u00fd:"y",\u00ff:"y",\u00c6:"Ae",\u00e6:"ae",\u00de:"Th",\u00fe:"th",\u00df:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010a:"C",\u010c:"C",\u0107:"c",\u0109:"c",\u010b:"c",\u010d:"c",\u010e:"D",\u0110:"D",\u010f:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011a:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011b:"e",\u011c:"G",\u011e:"G",\u0120:"G",\u0122:"G",\u011d:"g",\u011f:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012a:"I",\u012c:"I",\u012e:"I",\u0130:"I",\u0129:"i",\u012b:"i",\u012d:"i",\u012f:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013b:"L",\u013d:"L",\u013f:"L",\u0141:"L",\u013a:"l",\u013c:"l",\u013e:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014a:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014b:"n",\u014c:"O",\u014e:"O",\u0150:"O",\u014d:"o",\u014f:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015a:"S",\u015c:"S",\u015e:"S",\u0160:"S",\u015b:"s",\u015d:"s",\u015f:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016a:"U",\u016c:"U",\u016e:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016b:"u",\u016d:"u",\u016f:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017b:"Z",\u017d:"Z",\u017a:"z",\u017c:"z",\u017e:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017f:"s"}),MM=$g({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function TM(Y){return"\\"+bt[Y]}function Yo(Y){return GN.test(Y)}function an(Y){var ue=-1,re=Array(Y.size);return Y.forEach(function(Ue,Pt){re[++ue]=[Pt,Ue]}),re}function ad(Y,ue){return function(re){return Y(ue(re))}}function Co(Y,ue){for(var re=-1,Ue=Y.length,Pt=0,fn=[];++re<Ue;){var Ni=Y[re];(Ni===ue||Ni===ml)&&(Y[re]=ml,fn[Pt++]=re)}return fn}function Nc(Y){var ue=-1,re=Array(Y.size);return Y.forEach(function(Ue){re[++ue]=Ue}),re}function vl(Y){return Yo(Y)?function hw(Y){for(var ue=tw.lastIndex=0;tw.test(Y);)++ue;return ue}(Y):Gg(Y)}function Ps(Y){return Yo(Y)?function cd(Y){return Y.match(tw)||[]}(Y):function KN(Y){return Y.split("")}(Y)}function df(Y){for(var ue=Y.length;ue--&&os.test(Y.charAt(ue)););return ue}var dw=$g({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),hf=function Y(ue){var u,re=(ue=null==ue?pr:hf.defaults(pr.Object(),ue,hf.pick(pr,jN))).Array,Ue=ue.Date,Pt=ue.Error,fn=ue.Function,Ni=ue.Math,An=ue.Object,Xg=ue.RegExp,AM=ue.String,ls=ue.TypeError,ff=re.prototype,Oc=An.prototype,ir=ue["__core-js_shared__"],pf=fn.prototype.toString,vn=Oc.hasOwnProperty,IM=0,Oi=(u=/[^.]+$/.exec(ir&&ir.keys&&ir.keys.IE_PROTO||""))?"Symbol(src)_1."+u:"",mf=Oc.toString,mw=pf.call(An),yt=pr._,Hr=Xg("^"+pf.call(vn).replace(Zh,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Zt=nw?ue.Buffer:B,jn=ue.Symbol,Gi=ue.Uint8Array,wl=Zt?Zt.allocUnsafe:B,mr=ad(An.getPrototypeOf,An),Yg=An.create,Kg=Oc.propertyIsEnumerable,bl=ff.splice,gw=jn?jn.isConcatSpreadable:B,ud=jn?jn.iterator:B,En=jn?jn.toStringTag:B,Ve=function(){try{var u=eo(An,"defineProperty");return u({},"",{}),u}catch{}}(),Ft=ue.clearTimeout!==pr.clearTimeout&&ue.clearTimeout,$n=Ue&&Ue.now!==pr.Date.now&&Ue.now,Ks=ue.setTimeout!==pr.setTimeout&&ue.setTimeout,Ra=Ni.ceil,Li=Ni.floor,Pa=An.getOwnPropertySymbols,pi=Zt?Zt.isBuffer:B,Zo=ue.isFinite,Lc=ff.join,It=ad(An.keys,An),ti=Ni.max,rr=Ni.min,Fc=Ue.now,mi=ue.parseInt,kc=Ni.random,Uc=ff.reverse,Ns=eo(ue,"DataView"),Jo=eo(ue,"Map"),gf=eo(ue,"Promise"),cs=eo(ue,"Set"),us=eo(ue,"WeakMap"),Qo=eo(An,"create"),Na=us&&new us,Bt={},JN=Wa(Ns),Zg=Wa(Jo),_w=Wa(gf),Mo=Wa(cs),_f=Wa(us),ea=jn?jn.prototype:B,ta=ea?ea.valueOf:B,Wi=ea?ea.toString:B;function I(u){if(ii(u)&&!Nt(u)&&!(u instanceof Vt)){if(u instanceof zr)return u;if(vn.call(u,"__wrapped__"))return Pl(u)}return new zr(u)}var Fi=function(){function u(){}return function(f){if(!Xn(f))return{};if(Yg)return Yg(f);u.prototype=f;var _=new u;return u.prototype=B,_}}();function ji(){}function zr(u,f){this.__wrapped__=u,this.__actions__=[],this.__chain__=!!f,this.__index__=0,this.__values__=B}function Vt(u){this.__wrapped__=u,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=vo,this.__views__=[]}function xl(u){var f=-1,_=null==u?0:u.length;for(this.clear();++f<_;){var S=u[f];this.set(S[0],S[1])}}function Oa(u){var f=-1,_=null==u?0:u.length;for(this.clear();++f<_;){var S=u[f];this.set(S[0],S[1])}}function La(u){var f=-1,_=null==u?0:u.length;for(this.clear();++f<_;){var S=u[f];this.set(S[0],S[1])}}function Fa(u){var f=-1,_=null==u?0:u.length;for(this.__data__=new La;++f<_;)this.add(u[f])}function To(u){var f=this.__data__=new Oa(u);this.size=f.size}function dd(u,f){var _=Nt(u),S=!_&&Nl(u),T=!_&&!S&&$a(u),O=!_&&!S&&!T&&ru(u),U=_||S||T||O,j=U?qg(u.length,AM):[],K=j.length;for(var pe in u)(f||vn.call(u,pe))&&(!U||!("length"==pe||T&&("offset"==pe||"parent"==pe)||O&&("buffer"==pe||"byteLength"==pe||"byteOffset"==pe)||Ro(pe,K)))&&j.push(pe);return j}function ds(u){var f=u.length;return f?u[Rf(0,f-1)]:B}function vw(u,f){return oa(_r(u),Ua(f,0,u.length))}function ww(u){return oa(_r(u))}function vf(u,f,_){(_!==B&&!no(u[f],_)||_===B&&!(f in u))&&Ao(u,f,_)}function Bc(u,f,_){var S=u[f];(!vn.call(u,f)||!no(S,_)||_===B&&!(f in u))&&Ao(u,f,_)}function Vc(u,f){for(var _=u.length;_--;)if(no(u[_][0],f))return _;return-1}function bw(u,f,_,S){return Cl(u,function(T,O,U){f(S,T,_(T),U)}),S}function wf(u,f){return u&&Qs(f,Yi(f),u)}function Ao(u,f,_){"__proto__"==f&&Ve?Ve(u,f,{configurable:!0,enumerable:!0,value:_,writable:!0}):u[f]=_}function bf(u,f){for(var _=-1,S=f.length,T=re(S),O=null==u;++_<S;)T[_]=O?B:Ob(u,f[_]);return T}function Ua(u,f,_){return u==u&&(_!==B&&(u=u<=_?u:_),f!==B&&(u=u>=f?u:f)),u}function Tr(u,f,_,S,T,O){var U,j=1&f,K=2&f,pe=4&f;if(_&&(U=T?_(u,S,T,O):_(u)),U!==B)return U;if(!Xn(u))return u;var me=Nt(u);if(me){if(U=function YM(u){var f=u.length,_=new u.constructor(f);return f&&"string"==typeof u[0]&&vn.call(u,"index")&&(_.index=u.index,_.input=u.input),_}(u),!j)return _r(u,U)}else{var be=Ui(u),He=be==$h||be==k0;if($a(u))return gr(u,j);if(be==Ta||be==Wn||He&&!T){if(U=K||He?{}:to(u),!j)return K?function $M(u,f){return Qs(u,Gf(u),f)}(u,function Qg(u,f){return u&&Qs(f,wr(f),u)}(U,u)):function u_(u,f){return Qs(u,Al(u),f)}(u,wf(U,u))}else{if(!kn[be])return T?u:{};U=function KM(u,f,_){var S=u.constructor;switch(f){case Ku:return Js(u);case tn:case gl:return new S(+u);case Dc:return function kw(u,f){var _=f?Js(u.buffer):u.buffer;return new u.constructor(_,u.byteOffset,u.byteLength)}(u,_);case wo:case Yh:case Mg:case Kh:case Tg:case Ag:case Dg:case Ig:case Rg:return Uw(u,_);case Xs:return new S;case qh:case _l:return new S(u);case Tc:return function Wc(u){var f=new u.constructor(u.source,bo.exec(u));return f.lastIndex=u.lastIndex,f}(u);case Ys:return new S;case Xh:return function ia(u){return ta?An(ta.call(u)):{}}(u)}}(u,be,j)}}O||(O=new To);var nt=O.get(u);if(nt)return nt;O.set(u,U),X_(u)?u.forEach(function(pt){U.add(Tr(pt,f,_,pt,u,O))}):up(u)&&u.forEach(function(pt,Gt){U.set(Gt,Tr(pt,f,_,Gt,u,O))});var $t=me?B:(pe?K?xd:Ww:K?wr:Yi)(u);return Un($t||u,function(pt,Gt){$t&&(pt=u[Gt=pt]),Bc(U,Gt,Tr(pt,f,_,Gt,u,O))}),U}function El(u,f,_){var S=_.length;if(null==u)return!S;for(u=An(u);S--;){var T=_[S],U=u[T];if(U===B&&!(T in u)||!(0,f[T])(U))return!1}return!0}function e_(u,f,_){if("function"!=typeof u)throw new ls(is);return Il(function(){u.apply(B,_)},f)}function xf(u,f,_,S){var T=-1,O=Vg,U=!0,j=u.length,K=[],pe=f.length;if(!j)return K;_&&(f=Rn(f,Le(_))),S?(O=ow,U=!1):f.length>=200&&(O=ze,U=!1,f=new Fa(f));e:for(;++T<j;){var me=u[T],be=null==_?me:_(me);if(me=S||0!==me?me:0,U&&be==be){for(var He=pe;He--;)if(f[He]===be)continue e;K.push(me)}else O(f,be,S)||K.push(me)}return K}I.templateSettings={escape:H0,evaluate:z0,interpolate:Pg,variable:"",imports:{_:I}},(I.prototype=ji.prototype).constructor=I,(zr.prototype=Fi(ji.prototype)).constructor=zr,(Vt.prototype=Fi(ji.prototype)).constructor=Vt,xl.prototype.clear=function RM(){this.__data__=Qo?Qo(null):{},this.size=0},xl.prototype.delete=function QN(u){var f=this.has(u)&&delete this.__data__[u];return this.size-=f?1:0,f},xl.prototype.get=function PM(u){var f=this.__data__;if(Qo){var _=f[u];return _===zh?B:_}return vn.call(f,u)?f[u]:B},xl.prototype.has=function NM(u){var f=this.__data__;return Qo?f[u]!==B:vn.call(f,u)},xl.prototype.set=function eO(u,f){var _=this.__data__;return this.size+=this.has(u)?0:1,_[u]=Qo&&f===B?zh:f,this},Oa.prototype.clear=function tO(){this.__data__=[],this.size=0},Oa.prototype.delete=function nO(u){var f=this.__data__,_=Vc(f,u);return!(_<0||(_==f.length-1?f.pop():bl.call(f,_,1),--this.size,0))},Oa.prototype.get=function iO(u){var f=this.__data__,_=Vc(f,u);return _<0?B:f[_][1]},Oa.prototype.has=function rO(u){return Vc(this.__data__,u)>-1},Oa.prototype.set=function sO(u,f){var _=this.__data__,S=Vc(_,u);return S<0?(++this.size,_.push([u,f])):_[S][1]=f,this},La.prototype.clear=function oO(){this.size=0,this.__data__={hash:new xl,map:new(Jo||Oa),string:new xl}},La.prototype.delete=function aO(u){var f=y_(this,u).delete(u);return this.size-=f?1:0,f},La.prototype.get=function lO(u){return y_(this,u).get(u)},La.prototype.has=function cO(u){return y_(this,u).has(u)},La.prototype.set=function yw(u,f){var _=y_(this,u),S=_.size;return _.set(u,f),this.size+=_.size==S?0:1,this},Fa.prototype.add=Fa.prototype.push=function uO(u){return this.__data__.set(u,zh),this},Fa.prototype.has=function dO(u){return this.__data__.has(u)},To.prototype.clear=function Sl(){this.__data__=new Oa,this.size=0},To.prototype.delete=function ka(u){var f=this.__data__,_=f.delete(u);return this.size=f.size,_},To.prototype.get=function hO(u){return this.__data__.get(u)},To.prototype.has=function fO(u){return this.__data__.has(u)},To.prototype.set=function sr(u,f){var _=this.__data__;if(_ instanceof Oa){var S=_.__data__;if(!Jo||S.length<199)return S.push([u,f]),this.size=++_.size,this;_=this.__data__=new La(S)}return _.set(u,f),this.size=_.size,this};var Cl=d_(na),OM=d_(xw,!0);function LM(u,f){var _=!0;return Cl(u,function(S,T,O){return _=!!f(S,T,O)}),_}function Sf(u,f,_){for(var S=-1,T=u.length;++S<T;){var O=u[S],U=f(O);if(null!=U&&(j===B?U==U&&!ps(U):_(U,j)))var j=U,K=O}return K}function t_(u,f){var _=[];return Cl(u,function(S,T,O){f(S,T,O)&&_.push(S)}),_}function ki(u,f,_,S,T){var O=-1,U=u.length;for(_||(_=w_),T||(T=[]);++O<U;){var j=u[O];f>0&&_(j)?f>1?ki(j,f-1,_,S,T):So(T,j):S||(T[T.length]=j)}return T}var n_=h_(),Ef=h_(!0);function na(u,f){return u&&n_(u,f,Yi)}function xw(u,f){return u&&Ef(u,f,Yi)}function Cf(u,f){return un(f,function(_){return ks(u[_])})}function Ba(u,f){for(var _=0,S=(f=Io(f,u)).length;null!=u&&_<S;)u=u[Pr(f[_++])];return _&&_==S?u:B}function i_(u,f,_){var S=f(u);return Nt(u)?S:So(S,_(u))}function Ar(u){return null==u?u===B?"[object Undefined]":"[object Null]":En&&En in An(u)?function XM(u){var f=vn.call(u,En),_=u[En];try{u[En]=B;var S=!0}catch{}var T=mf.call(u);return S&&(f?u[En]=_:delete u[En]),T}(u):function Zw(u){return mf.call(u)}(u)}function r_(u,f){return u>f}function FM(u,f){return null!=u&&vn.call(u,f)}function Sw(u,f){return null!=u&&f in An(u)}function Mf(u,f,_){for(var S=_?ow:Vg,T=u[0].length,O=u.length,U=O,j=re(O),K=1/0,pe=[];U--;){var me=u[U];U&&f&&(me=Rn(me,Le(f))),K=rr(me.length,K),j[U]=!_&&(f||T>=120&&me.length>=120)?new Fa(U&&me):B}me=u[0];var be=-1,He=j[0];e:for(;++be<T&&pe.length<K;){var nt=me[be],ht=f?f(nt):nt;if(nt=_||0!==nt?nt:0,!(He?ze(He,ht):S(pe,ht,_))){for(U=O;--U;){var $t=j[U];if(!($t?ze($t,ht):S(u[U],ht,_)))continue e}He&&He.push(ht),pe.push(nt)}}return pe}function Tf(u,f,_){var S=null==(u=Jw(u,f=Io(f,u)))?u:u[Pr(qn(f))];return null==S?B:Mr(S,u,_)}function Ew(u){return ii(u)&&Ar(u)==Wn}function fd(u,f,_,S,T){return u===f||(null==u||null==f||!ii(u)&&!ii(f)?u!=u&&f!=f:function BM(u,f,_,S,T,O){var U=Nt(u),j=Nt(f),K=U?ei:Ui(u),pe=j?ei:Ui(f),me=(K=K==Wn?Ta:K)==Ta,be=(pe=pe==Wn?Ta:pe)==Ta,He=K==pe;if(He&&$a(u)){if(!$a(f))return!1;U=!0,me=!1}if(He&&!me)return O||(O=new To),U||ru(u)?Gw(u,f,_,S,T,O):function jc(u,f,_,S,T,O,U){switch(_){case Dc:if(u.byteLength!=f.byteLength||u.byteOffset!=f.byteOffset)return!1;u=u.buffer,f=f.buffer;case Ku:return!(u.byteLength!=f.byteLength||!O(new Gi(u),new Gi(f)));case tn:case gl:case qh:return no(+u,+f);case Mc:return u.name==f.name&&u.message==f.message;case Tc:case _l:return u==f+"";case Xs:var j=an;case Ys:if(j||(j=Nc),u.size!=f.size&&!(1&S))return!1;var pe=U.get(u);if(pe)return pe==f;S|=2,U.set(u,f);var me=Gw(j(u),j(f),S,T,O,U);return U.delete(u),me;case Xh:if(ta)return ta.call(u)==ta.call(f)}return!1}(u,f,K,_,S,T,O);if(!(1&_)){var nt=me&&vn.call(u,"__wrapped__"),ht=be&&vn.call(f,"__wrapped__");if(nt||ht){var $t=nt?u.value():u,pt=ht?f.value():f;return O||(O=new To),T($t,pt,_,S,O)}}return!!He&&(O||(O=new To),function bd(u,f,_,S,T,O){var U=1&_,j=Ww(u),K=j.length;if(K!=Ww(f).length&&!U)return!1;for(var be=K;be--;){var He=j[be];if(!(U?He in f:vn.call(f,He)))return!1}var nt=O.get(u),ht=O.get(f);if(nt&&ht)return nt==f&&ht==u;var $t=!0;O.set(u,f),O.set(f,u);for(var pt=U;++be<K;){var Gt=u[He=j[be]],nn=f[He];if(S)var Ki=U?S(nn,Gt,He,f,u,O):S(Gt,nn,He,u,f,O);if(!(Ki===B?Gt===nn||T(Gt,nn,_,S,O):Ki)){$t=!1;break}pt||(pt="constructor"==He)}if($t&&!pt){var Cn=u.constructor,gs=f.constructor;Cn!=gs&&"constructor"in u&&"constructor"in f&&!("function"==typeof Cn&&Cn instanceof Cn&&"function"==typeof gs&&gs instanceof gs)&&($t=!1)}return O.delete(u),O.delete(f),$t}(u,f,_,S,T,O))}(u,f,_,S,fd,T))}function Af(u,f,_,S){var T=_.length,O=T,U=!S;if(null==u)return!O;for(u=An(u);T--;){var j=_[T];if(U&&j[2]?j[1]!==u[j[0]]:!(j[0]in u))return!1}for(;++T<O;){var K=(j=_[T])[0],pe=u[K],me=j[1];if(U&&j[2]){if(pe===B&&!(K in u))return!1}else{var be=new To;if(S)var He=S(pe,me,K,u,f,be);if(!(He===B?fd(me,pe,3,S,be):He))return!1}}return!0}function Tw(u){return!(!Xn(u)||function qw(u){return!!Oi&&Oi in u}(u))&&(ks(u)?Hr:Ic).test(Wa(u))}function o_(u){return"function"==typeof u?u:null==u?br:"object"==typeof u?Nt(u)?Aw(u[0],u[1]):Dr(u):f1(u)}function Df(u){if(!qc(u))return It(u);var f=[];for(var _ in An(u))vn.call(u,_)&&"constructor"!=_&&f.push(_);return f}function pd(u,f){return u<f}function md(u,f){var _=-1,S=vr(u)?re(u.length):[];return Cl(u,function(T,O,U){S[++_]=f(T,O,U)}),S}function Dr(u){var f=Sd(u);return 1==f.length&&f[0][2]?Cd(f[0][0],f[0][1]):function(_){return _===u||Af(_,u,f)}}function Aw(u,f){return Ed(u)&&Yw(f)?Cd(Pr(u),f):function(_){var S=Ob(_,u);return S===B&&S===f?mp(_,u):fd(f,S,3)}}function gd(u,f,_,S,T){u!==f&&n_(f,function(O,U){if(T||(T=new To),Xn(O))!function Hc(u,f,_,S,T,O,U){var j=b_(u,_),K=b_(f,_),pe=U.get(K);if(pe)vf(u,_,pe);else{var me=O?O(j,K,_+"",u,f,U):B,be=me===B;if(be){var He=Nt(K),nt=!He&&$a(K),ht=!He&&!nt&&ru(K);me=K,He||nt||ht?Nt(j)?me=j:ni(j)?me=_r(j):nt?(be=!1,me=gr(K,!0)):ht?(be=!1,me=Uw(K,!0)):me=[]:Ll(K)||Nl(K)?(me=j,Nl(j)?me=Rb(j):(!Xn(j)||ks(j))&&(me=to(K))):be=!1}be&&(U.set(K,me),T(me,K,S,O,U),U.delete(K)),vf(u,_,me)}}(u,f,U,_,gd,S,T);else{var j=S?S(b_(u,U),O,U+"",u,f,T):B;j===B&&(j=O),vf(u,U,j)}},wr)}function Gr(u,f){var _=u.length;if(_)return Ro(f+=f<0?_:0,_)?u[f]:B}function Dw(u,f,_){f=f.length?Rn(f,function(O){return Nt(O)?function(U){return Ba(U,1===O.length?O[0]:O)}:O}):[br];var S=-1;return f=Rn(f,Le(ft())),function lw(Y,ue){var re=Y.length;for(Y.sort(ue);re--;)Y[re]=Y[re].value;return Y}(md(u,function(O,U,j){return{criteria:Rn(f,function(pe){return pe(O)}),index:++S,value:O}}),function(O,U){return function jM(u,f,_){for(var S=-1,T=u.criteria,O=f.criteria,U=T.length,j=_.length;++S<U;){var K=c_(T[S],O[S]);if(K)return S>=j?K:K*("desc"==_[S]?-1:1)}return u.index-f.index}(O,U,_)})}function Iw(u,f,_){for(var S=-1,T=f.length,O={};++S<T;){var U=f[S],j=Ba(u,U);_(j,U)&&Nf(O,Io(U,u),j)}return O}function If(u,f,_,S){var T=S?id:nd,O=-1,U=f.length,j=u;for(u===f&&(f=_r(f)),_&&(j=Rn(u,Le(_)));++O<U;)for(var K=0,pe=f[O],me=_?_(pe):pe;(K=T(j,me,K,S))>-1;)j!==u&&bl.call(j,K,1),bl.call(u,K,1);return u}function Rw(u,f){for(var _=u?f.length:0,S=_-1;_--;){var T=f[_];if(_==S||T!==O){var O=T;Ro(T)?bl.call(u,T,1):Qt(u,T)}}return u}function Rf(u,f){return u+Li(kc()*(f-u+1))}function Pf(u,f){var _="";if(!u||f<1||f>qo)return _;do{f%2&&(_+=u),(f=Li(f/2))&&(u+=u)}while(f);return _}function jt(u,f){return x_(Xc(u,f,br),u+"")}function xt(u){return ds(kl(u))}function Nw(u,f){var _=kl(u);return oa(_,Ua(f,0,_.length))}function Nf(u,f,_,S){if(!Xn(u))return u;for(var T=-1,O=(f=Io(f,u)).length,U=O-1,j=u;null!=j&&++T<O;){var K=Pr(f[T]),pe=_;if("__proto__"===K||"constructor"===K||"prototype"===K)return u;if(T!=U){var me=j[K];(pe=S?S(me,K,j):B)===B&&(pe=Xn(me)?me:Ro(f[T+1])?[]:{})}Bc(j,K,pe),j=j[K]}return u}var Ow=Na?function(u,f){return Na.set(u,f),u}:br,zM=Ve?function(u,f){return Ve(u,"toString",{configurable:!0,enumerable:!1,value:kd(f),writable:!0})}:br;function GM(u){return oa(kl(u))}function hs(u,f,_){var S=-1,T=u.length;f<0&&(f=-f>T?0:T+f),(_=_>T?T:_)<0&&(_+=T),T=f>_?0:_-f>>>0,f>>>=0;for(var O=re(T);++S<T;)O[S]=u[S+f];return O}function zc(u,f){var _;return Cl(u,function(S,T,O){return!(_=f(S,T,O))}),!!_}function Of(u,f,_){var S=0,T=null==u?S:u.length;if("number"==typeof f&&f==f&&T<=2147483647){for(;S<T;){var O=S+T>>>1,U=u[O];null!==U&&!ps(U)&&(_?U<=f:U<f)?S=O+1:T=O}return T}return a_(u,f,br,_)}function a_(u,f,_,S){var T=0,O=null==u?0:u.length;if(0===O)return 0;for(var U=(f=_(f))!=f,j=null===f,K=ps(f),pe=f===B;T<O;){var me=Li((T+O)/2),be=_(u[me]),He=be!==B,nt=null===be,ht=be==be,$t=ps(be);if(U)var pt=S||ht;else pt=pe?ht&&(S||He):j?ht&&He&&(S||!nt):K?ht&&He&&!nt&&(S||!$t):!nt&&!$t&&(S?be<=f:be<f);pt?T=me+1:O=me}return rr(O,4294967294)}function Lw(u,f){for(var _=-1,S=u.length,T=0,O=[];++_<S;){var U=u[_],j=f?f(U):U;if(!_||!no(j,K)){var K=j;O[T++]=0===U?0:U}}return O}function Fw(u){return"number"==typeof u?u:ps(u)?NaN:+u}function fs(u){if("string"==typeof u)return u;if(Nt(u))return Rn(u,fs)+"";if(ps(u))return Wi?Wi.call(u):"";var f=u+"";return"0"==f&&1/u==-Tn?"-0":f}function ge(u,f,_){var S=-1,T=Vg,O=u.length,U=!0,j=[],K=j;if(_)U=!1,T=ow;else if(O>=200){var pe=f?null:Vf(u);if(pe)return Nc(pe);U=!1,T=ze,K=new Fa}else K=f?[]:j;e:for(;++S<O;){var me=u[S],be=f?f(me):me;if(me=_||0!==me?me:0,U&&be==be){for(var He=K.length;He--;)if(K[He]===be)continue e;f&&K.push(be),j.push(me)}else T(K,be,_)||(K!==j&&K.push(be),j.push(me))}return j}function Qt(u,f){return null==(u=Jw(u,f=Io(f,u)))||delete u[Pr(qn(f))]}function Ir(u,f,_,S){return Nf(u,f,_(Ba(u,f)),S)}function or(u,f,_,S){for(var T=u.length,O=S?T:-1;(S?O--:++O<T)&&f(u[O],O,u););return _?hs(u,S?0:O,S?O+1:T):hs(u,S?O+1:0,S?T:O)}function qi(u,f){var _=u;return _ instanceof Vt&&(_=_.value()),af(f,function(S,T){return T.func.apply(T.thisArg,So([S],T.args))},_)}function Lf(u,f,_){var S=u.length;if(S<2)return S?ge(u[0]):[];for(var T=-1,O=re(S);++T<S;)for(var U=u[T],j=-1;++j<S;)j!=T&&(O[T]=xf(O[T]||U,u[j],f,_));return ge(ki(O,1),f,_)}function Gc(u,f,_){for(var S=-1,T=u.length,O=f.length,U={};++S<T;)_(U,u[S],S<O?f[S]:B);return U}function Os(u){return ni(u)?u:[]}function _d(u){return"function"==typeof u?u:br}function Io(u,f){return Nt(u)?u:Ed(u,f)?[u]:Rl(dn(u))}var WM=jt;function Ml(u,f,_){var S=u.length;return _=_===B?S:_,!f&&_>=S?u:hs(u,f,_)}var l_=Ft||function(u){return pr.clearTimeout(u)};function gr(u,f){if(f)return u.slice();var _=u.length,S=wl?wl(_):new u.constructor(_);return u.copy(S),S}function Js(u){var f=new u.constructor(u.byteLength);return new Gi(f).set(new Gi(u)),f}function Uw(u,f){var _=f?Js(u.buffer):u.buffer;return new u.constructor(_,u.byteOffset,u.length)}function c_(u,f){if(u!==f){var _=u!==B,S=null===u,T=u==u,O=ps(u),U=f!==B,j=null===f,K=f==f,pe=ps(f);if(!j&&!pe&&!O&&u>f||O&&U&&K&&!j&&!pe||S&&U&&K||!_&&K||!T)return 1;if(!S&&!O&&!pe&&u<f||pe&&_&&T&&!S&&!O||j&&_&&T||!U&&T||!K)return-1}return 0}function Bw(u,f,_,S){for(var T=-1,O=u.length,U=_.length,j=-1,K=f.length,pe=ti(O-U,0),me=re(K+pe),be=!S;++j<K;)me[j]=f[j];for(;++T<U;)(be||T<O)&&(me[_[T]]=u[T]);for(;pe--;)me[j++]=u[T++];return me}function Ff(u,f,_,S){for(var T=-1,O=u.length,U=-1,j=_.length,K=-1,pe=f.length,me=ti(O-j,0),be=re(me+pe),He=!S;++T<me;)be[T]=u[T];for(var nt=T;++K<pe;)be[nt+K]=f[K];for(;++U<j;)(He||T<O)&&(be[nt+_[U]]=u[T++]);return be}function _r(u,f){var _=-1,S=u.length;for(f||(f=re(S));++_<S;)f[_]=u[_];return f}function Qs(u,f,_,S){var T=!_;_||(_={});for(var O=-1,U=f.length;++O<U;){var j=f[O],K=S?S(_[j],u[j],j,_,u):B;K===B&&(K=u[j]),T?Ao(_,j,K):Bc(_,j,K)}return _}function yd(u,f){return function(_,S){var T=Nt(_)?rw:bw,O=f?f():{};return T(_,u,ft(S,2),O)}}function Ha(u){return jt(function(f,_){var S=-1,T=_.length,O=T>1?_[T-1]:B,U=T>2?_[2]:B;for(O=u.length>3&&"function"==typeof O?(T--,O):B,U&&Xi(_[0],_[1],U)&&(O=T<3?B:O,T=1),f=An(f);++S<T;){var j=_[S];j&&u(f,j,S,O)}return f})}function d_(u,f){return function(_,S){if(null==_)return _;if(!vr(_))return u(_,S);for(var T=_.length,O=f?T:-1,U=An(_);(f?O--:++O<T)&&!1!==S(U[O],O,U););return _}}function h_(u){return function(f,_,S){for(var T=-1,O=An(f),U=S(f),j=U.length;j--;){var K=U[u?j:++T];if(!1===_(O[K],K,O))break}return f}}function f_(u){return function(f){var _=Yo(f=dn(f))?Ps(f):B,S=_?_[0]:f.charAt(0),T=_?Ml(_,1).join(""):f.slice(1);return S[u]()+T}}function za(u){return function(f){return af(Xa(Ub(f).replace(zN,"")),u,"")}}function vd(u){return function(){var f=arguments;switch(f.length){case 0:return new u;case 1:return new u(f[0]);case 2:return new u(f[0],f[1]);case 3:return new u(f[0],f[1],f[2]);case 4:return new u(f[0],f[1],f[2],f[3]);case 5:return new u(f[0],f[1],f[2],f[3],f[4]);case 6:return new u(f[0],f[1],f[2],f[3],f[4],f[5]);case 7:return new u(f[0],f[1],f[2],f[3],f[4],f[5],f[6])}var _=Fi(u.prototype),S=u.apply(_,f);return Xn(S)?S:_}}function yr(u){return function(f,_,S){var T=An(f);if(!vr(f)){var O=ft(_,3);f=Yi(f),_=function(j){return O(T[j],j,T)}}var U=u(f,_,S);return U>-1?T[O?f[U]:U]:B}}function Ga(u){return sa(function(f){var _=f.length,S=_,T=zr.prototype.thru;for(u&&f.reverse();S--;){var O=f[S];if("function"!=typeof O)throw new ls(is);if(T&&!U&&"wrapper"==zf(O))var U=new zr([],!0)}for(S=U?S:_;++S<_;){var j=zf(O=f[S]),K="wrapper"==j?jw(O):B;U=K&&jf(K[0])&&424==K[1]&&!K[4].length&&1==K[9]?U[zf(K[0])].apply(U,K[3]):1==O.length&&jf(O)?U[j]():U.thru(O)}return function(){var pe=arguments,me=pe[0];if(U&&1==pe.length&&Nt(me))return U.plant(me).value();for(var be=0,He=_?f[be].apply(this,pe):me;++be<_;)He=f[be].call(this,He);return He}})}function Nn(u,f,_,S,T,O,U,j,K,pe){var me=128&f,be=1&f,He=2&f,nt=24&f,ht=512&f,$t=He?B:vd(u);return function pt(){for(var Gt=arguments.length,nn=re(Gt),Ki=Gt;Ki--;)nn[Ki]=arguments[Ki];if(nt)var Cn=$c(pt),gs=function od(Y,ue){for(var re=Y.length,Ue=0;re--;)Y[re]===ue&&++Ue;return Ue}(nn,Cn);if(S&&(nn=Bw(nn,S,T,nt)),O&&(nn=Ff(nn,O,U,nt)),Gt-=gs,nt&&Gt<pe){var Bn=Co(nn,Cn);return ra(u,f,Nn,pt.placeholder,_,nn,Bn,j,K,pe-Gt)}var Si=be?_:this,ca=He?Si[u]:u;return Gt=nn.length,j?nn=function Rr(u,f){for(var _=u.length,S=rr(f.length,_),T=_r(u);S--;){var O=f[S];u[S]=Ro(O,_)?T[O]:B}return u}(nn,j):ht&&Gt>1&&nn.reverse(),me&&K<Gt&&(nn.length=K),this&&this!==pr&&this instanceof pt&&(ca=$t||vd(ca)),ca.apply(Si,nn)}}function kf(u,f){return function(_,S){return function UM(u,f,_,S){return na(u,function(T,O,U){f(S,_(T),O,U)}),S}(_,u,f(S),{})}}function Uf(u,f){return function(_,S){var T;if(_===B&&S===B)return f;if(_!==B&&(T=_),S!==B){if(T===B)return S;"string"==typeof _||"string"==typeof S?(_=fs(_),S=fs(S)):(_=Fw(_),S=Fw(S)),T=u(_,S)}return T}}function p_(u){return sa(function(f){return f=Rn(f,Le(ft())),jt(function(_){var S=this;return u(f,function(T){return Mr(T,S,_)})})})}function Bf(u,f){var _=(f=f===B?" ":fs(f)).length;if(_<2)return _?Pf(f,u):f;var S=Pf(f,Ra(u/vl(f)));return Yo(f)?Ml(Ps(S),0,u).join(""):S.slice(0,u)}function m_(u){return function(f,_,S){return S&&"number"!=typeof S&&Xi(f,_,S)&&(_=S=B),f=aa(f),_===B?(_=f,f=0):_=aa(_),function Pw(u,f,_,S){for(var T=-1,O=ti(Ra((f-u)/(_||1)),0),U=re(O);O--;)U[S?O:++T]=u,u+=_;return U}(f,_,S=S===B?f<_?1:-1:aa(S),u)}}function Tl(u){return function(f,_){return"string"==typeof f&&"string"==typeof _||(f=jr(f),_=jr(_)),u(f,_)}}function ra(u,f,_,S,T,O,U,j,K,pe){var me=8&f;f|=me?32:64,4&(f&=~(me?64:32))||(f&=-4);var $t=[u,f,T,me?O:B,me?U:B,me?B:O,me?B:U,j,K,pe],pt=_.apply(B,$t);return jf(u)&&bi(pt,$t),pt.placeholder=S,S_(pt,u,f)}function g_(u){var f=Ni[u];return function(_,S){if(_=jr(_),(S=null==S?0:rr(zt(S),292))&&Zo(_)){var T=(dn(_)+"e").split("e");return+((T=(dn(f(T[0]+"e"+(+T[1]+S)))+"e").split("e"))[0]+"e"+(+T[1]-S))}return f(_)}}var Vf=cs&&1/Nc(new cs([,-0]))[1]==Tn?function(u){return new cs(u)}:Ud;function wd(u){return function(f){var _=Ui(f);return _==Xs?an(f):_==Ys?function uw(Y){var ue=-1,re=Array(Y.size);return Y.forEach(function(Ue){re[++ue]=[Ue,Ue]}),re}(f):function Ia(Y,ue){return Rn(ue,function(re){return[re,Y[re]]})}(f,u(f))}}function Ls(u,f,_,S,T,O,U,j){var K=2&f;if(!K&&"function"!=typeof u)throw new ls(is);var pe=S?S.length:0;if(pe||(f&=-97,S=T=B),U=U===B?U:ti(zt(U),0),j=j===B?j:zt(j),pe-=T?T.length:0,64&f){var me=S,be=T;S=T=B}var He=K?B:jw(u),nt=[u,f,_,S,T,me,be,O,U,j];if(He&&function JM(u,f){var _=u[1],S=f[1],T=_|S;if(!(T<131)&&!(128==S&&8==_||128==S&&256==_&&u[7].length<=f[8]||384==S&&f[7].length<=f[8]&&8==_))return u;1&S&&(u[2]=f[2],T|=1&_?0:4);var j=f[3];if(j){var K=u[3];u[3]=K?Bw(K,j,f[4]):j,u[4]=K?Co(u[3],ml):f[4]}(j=f[5])&&(u[5]=(K=u[5])?Ff(K,j,f[6]):j,u[6]=K?Co(u[5],ml):f[6]),(j=f[7])&&(u[7]=j),128&S&&(u[8]=null==u[8]?f[8]:rr(u[8],f[8])),null==u[9]&&(u[9]=f[9]),u[0]=f[0],u[1]=T}(nt,He),u=nt[0],f=nt[1],_=nt[2],S=nt[3],T=nt[4],!(j=nt[9]=nt[9]===B?K?0:u.length:ti(nt[9]-pe,0))&&24&f&&(f&=-25),f&&1!=f)ht=8==f||16==f?function qM(u,f,_){var S=vd(u);return function T(){for(var O=arguments.length,U=re(O),j=O,K=$c(T);j--;)U[j]=arguments[j];var pe=O<3&&U[0]!==K&&U[O-1]!==K?[]:Co(U,K);return(O-=pe.length)<_?ra(u,f,Nn,T.placeholder,B,U,pe,B,B,_-O):Mr(this&&this!==pr&&this instanceof T?S:u,this,U)}}(u,f,j):32!=f&&33!=f||T.length?Nn.apply(B,nt):function Hw(u,f,_,S){var T=1&f,O=vd(u);return function U(){for(var j=-1,K=arguments.length,pe=-1,me=S.length,be=re(me+K),He=this&&this!==pr&&this instanceof U?O:u;++pe<me;)be[pe]=S[pe];for(;K--;)be[pe++]=arguments[++j];return Mr(He,T?_:this,be)}}(u,f,_,S);else var ht=function Vw(u,f,_){var S=1&f,T=vd(u);return function O(){return(this&&this!==pr&&this instanceof O?T:u).apply(S?_:this,arguments)}}(u,f,_);return S_((He?Ow:bi)(ht,nt),u,f)}function Hf(u,f,_,S){return u===B||no(u,Oc[_])&&!vn.call(S,_)?f:u}function __(u,f,_,S,T,O){return Xn(u)&&Xn(f)&&(O.set(f,u),gd(u,f,B,__,O),O.delete(f)),u}function zw(u){return Ll(u)?B:u}function Gw(u,f,_,S,T,O){var U=1&_,j=u.length,K=f.length;if(j!=K&&!(U&&K>j))return!1;var pe=O.get(u),me=O.get(f);if(pe&&me)return pe==f&&me==u;var be=-1,He=!0,nt=2&_?new Fa:B;for(O.set(u,f),O.set(f,u);++be<j;){var ht=u[be],$t=f[be];if(S)var pt=U?S($t,ht,be,f,u,O):S(ht,$t,be,u,f,O);if(pt!==B){if(pt)continue;He=!1;break}if(nt){if(!zg(f,function(Gt,nn){if(!ze(nt,nn)&&(ht===Gt||T(ht,Gt,_,S,O)))return nt.push(nn)})){He=!1;break}}else if(ht!==$t&&!T(ht,$t,_,S,O)){He=!1;break}}return O.delete(u),O.delete(f),He}function sa(u){return x_(Xc(u,B,Kc),u+"")}function Ww(u){return i_(u,Yi,Al)}function xd(u){return i_(u,wr,Gf)}var jw=Na?function(u){return Na.get(u)}:Ud;function zf(u){for(var f=u.name+"",_=Bt[f],S=vn.call(Bt,f)?_.length:0;S--;){var T=_[S],O=T.func;if(null==O||O==u)return T.name}return f}function $c(u){return(vn.call(I,"placeholder")?I:u).placeholder}function ft(){var u=I.iteratee||ly;return u=u===ly?o_:u,arguments.length?u(arguments[0],arguments[1]):u}function y_(u,f){var _=u.__data__;return function ZM(u){var f=typeof u;return"string"==f||"number"==f||"symbol"==f||"boolean"==f?"__proto__"!==u:null===u}(f)?_["string"==typeof f?"string":"hash"]:_.map}function Sd(u){for(var f=Yi(u),_=f.length;_--;){var S=f[_],T=u[S];f[_]=[S,T,Yw(T)]}return f}function eo(u,f){var _=function Xo(Y,ue){return null==Y?B:Y[ue]}(u,f);return Tw(_)?_:B}var Al=Pa?function(u){return null==u?[]:(u=An(u),un(Pa(u),function(f){return Kg.call(u,f)}))}:Jb,Gf=Pa?function(u){for(var f=[];u;)So(f,Al(u)),u=mr(u);return f}:Jb,Ui=Ar;function v_(u,f,_){for(var S=-1,T=(f=Io(f,u)).length,O=!1;++S<T;){var U=Pr(f[S]);if(!(O=null!=u&&_(u,U)))break;u=u[U]}return O||++S!=T?O:!!(T=null==u?0:u.length)&&Id(T)&&Ro(U,T)&&(Nt(u)||Nl(u))}function to(u){return"function"!=typeof u.constructor||qc(u)?{}:Fi(mr(u))}function w_(u){return Nt(u)||Nl(u)||!!(gw&&u&&u[gw])}function Ro(u,f){var _=typeof u;return!!(f=f??qo)&&("number"==_||"symbol"!=_&&BN.test(u))&&u>-1&&u%1==0&&u<f}function Xi(u,f,_){if(!Xn(_))return!1;var S=typeof f;return!!("number"==S?vr(_)&&Ro(f,_.length):"string"==S&&f in _)&&no(_[f],u)}function Ed(u,f){if(Nt(u))return!1;var _=typeof u;return!("number"!=_&&"symbol"!=_&&"boolean"!=_&&null!=u&&!ps(u))||sM.test(u)||!G0.test(u)||null!=f&&u in An(f)}function jf(u){var f=zf(u),_=I[f];if("function"!=typeof _||!(f in Vt.prototype))return!1;if(u===_)return!0;var S=jw(_);return!!S&&u===S[0]}(Ns&&Ui(new Ns(new ArrayBuffer(1)))!=Dc||Jo&&Ui(new Jo)!=Xs||gf&&Ui(gf.resolve())!=QC||cs&&Ui(new cs)!=Ys||us&&Ui(new us)!=Ac)&&(Ui=function(u){var f=Ar(u),_=f==Ta?u.constructor:B,S=_?Wa(_):"";if(S)switch(S){case JN:return Dc;case Zg:return Xs;case _w:return QC;case Mo:return Ys;case _f:return Ac}return f});var Xw=ir?ks:Qb;function qc(u){var f=u&&u.constructor;return u===("function"==typeof f&&f.prototype||Oc)}function Yw(u){return u==u&&!Xn(u)}function Cd(u,f){return function(_){return null!=_&&_[u]===f&&(f!==B||u in An(_))}}function Xc(u,f,_){return f=ti(f===B?u.length-1:f,0),function(){for(var S=arguments,T=-1,O=ti(S.length-f,0),U=re(O);++T<O;)U[T]=S[f+T];T=-1;for(var j=re(f+1);++T<f;)j[T]=S[T];return j[f]=_(U),Mr(u,this,j)}}function Jw(u,f){return f.length<2?u:Ba(u,hs(f,0,-1))}function b_(u,f){if(("constructor"!==f||"function"!=typeof u[f])&&"__proto__"!=f)return u[f]}var bi=Md(Ow),Il=Ks||function(u,f){return pr.setTimeout(u,f)},x_=Md(zM);function S_(u,f,_){var S=f+"";return x_(u,function Wf(u,f){var _=f.length;if(!_)return u;var S=_-1;return f[S]=(_>1?"& ":"")+f[S],f=f.join(_>2?", ":" "),u.replace(oM,"{\n/* [wrapped with "+f+"] */\n")}(S,function E_(u,f){return Un(F0,function(_){var S="_."+_[0];f&_[1]&&!Vg(u,S)&&u.push(S)}),u.sort()}(function $w(u){var f=u.match(aM);return f?f[1].split(lM):[]}(S),_)))}function Md(u){var f=0,_=0;return function(){var S=Fc(),T=16-(S-_);if(_=S,T>0){if(++f>=800)return arguments[0]}else f=0;return u.apply(B,arguments)}}function oa(u,f){var _=-1,S=u.length,T=S-1;for(f=f===B?S:f;++_<f;){var O=Rf(_,T),U=u[O];u[O]=u[_],u[_]=U}return u.length=f,u}var Rl=function Dl(u){var f=sp(u,function(S){return 500===_.size&&_.clear(),S}),_=f.cache;return f}(function(u){var f=[];return 46===u.charCodeAt(0)&&f.push(""),u.replace(W0,function(_,S,T,O){f.push(T?O.replace(uM,"$1"):S||_)}),f});function Pr(u){if("string"==typeof u||ps(u))return u;var f=u+"";return"0"==f&&1/u==-Tn?"-0":f}function Wa(u){if(null!=u){try{return pf.call(u)}catch{}try{return u+""}catch{}}return""}function Pl(u){if(u instanceof Vt)return u.clone();var f=new zr(u.__wrapped__,u.__chain__);return f.__actions__=_r(u.__actions__),f.__index__=u.__index__,f.__values__=u.__values__,f}var yO=jt(function(u,f){return ni(u)?xf(u,ki(f,1,ni,!0)):[]}),vO=jt(function(u,f){var _=qn(f);return ni(_)&&(_=B),ni(u)?xf(u,ki(f,1,ni,!0),ft(_,2)):[]}),wO=jt(function(u,f){var _=qn(f);return ni(_)&&(_=B),ni(u)?xf(u,ki(f,1,ni,!0),B,_):[]});function xi(u,f,_){var S=null==u?0:u.length;if(!S)return-1;var T=null==_?0:zt(_);return T<0&&(T=ti(S+T,0)),Wg(u,ft(f,3),T)}function Qw(u,f,_){var S=null==u?0:u.length;if(!S)return-1;var T=S-1;return _!==B&&(T=zt(_),T=_<0?ti(S+T,0):rr(T,S-1)),Wg(u,ft(f,3),T,!0)}function Kc(u){return null!=u&&u.length?ki(u,1):[]}function C_(u){return u&&u.length?u[0]:B}var iT=jt(function(u){var f=Rn(u,Os);return f.length&&f[0]===u[0]?Mf(f):[]}),SO=jt(function(u){var f=qn(u),_=Rn(u,Os);return f===qn(_)?f=B:_.pop(),_.length&&_[0]===u[0]?Mf(_,ft(f,2)):[]}),rT=jt(function(u){var f=qn(u),_=Rn(u,Os);return(f="function"==typeof f?f:B)&&_.pop(),_.length&&_[0]===u[0]?Mf(_,B,f):[]});function qn(u){var f=null==u?0:u.length;return f?u[f-1]:B}var CO=jt(T_);function T_(u,f){return u&&u.length&&f&&f.length?If(u,f):u}var aT=sa(function(u,f){var _=null==u?0:u.length,S=bf(u,f);return Rw(u,Rn(f,function(T){return Ro(T,_)?+T:T}).sort(c_)),S});function A_(u){return null==u?u:Uc.call(u)}var Qc=jt(function(u){return ge(ki(u,1,ni,!0))}),Ad=jt(function(u){var f=qn(u);return ni(f)&&(f=B),ge(ki(u,1,ni,!0),ft(f,2))}),mT=jt(function(u){var f=qn(u);return f="function"==typeof f?f:B,ge(ki(u,1,ni,!0),B,f)});function ib(u){if(!u||!u.length)return[];var f=0;return u=un(u,function(_){if(ni(_))return f=ti(_.length,f),!0}),qg(f,function(_){return Rn(u,jg(_))})}function rb(u,f){if(!u||!u.length)return[];var _=ib(u);return null==f?_:Rn(_,function(S){return Mr(f,B,S)})}var _T=jt(function(u,f){return ni(u)?xf(u,f):[]}),yT=jt(function(u){return Lf(un(u,ni))}),Zf=jt(function(u){var f=qn(u);return ni(f)&&(f=B),Lf(un(u,ni),ft(f,2))}),sb=jt(function(u){var f=qn(u);return f="function"==typeof f?f:B,Lf(un(u,ni),B,f)}),vT=jt(ib),ab=jt(function(u){var f=u.length,_=f>1?u[f-1]:B;return _="function"==typeof _?(u.pop(),_):B,rb(u,_)});function wT(u){var f=I(u);return f.__chain__=!0,f}function Jf(u,f){return f(u)}var R_=sa(function(u){var f=u.length,_=f?u[0]:0,S=this.__wrapped__,T=function(O){return bf(O,u)};return!(f>1||this.__actions__.length)&&S instanceof Vt&&Ro(_)?((S=S.slice(_,+_+(f?1:0))).__actions__.push({func:Jf,args:[T],thisArg:B}),new zr(S,this.__chain__).thru(function(O){return f&&!O.length&&O.push(B),O})):this.thru(T)}),OO=yd(function(u,f,_){vn.call(u,_)?++u[_]:Ao(u,_,1)}),ep=yr(xi),lb=yr(Qw);function N_(u,f){return(Nt(u)?Un:Cl)(u,ft(f,3))}function O_(u,f){return(Nt(u)?sw:OM)(u,ft(f,3))}var tp=yd(function(u,f,_){vn.call(u,_)?u[_].push(f):Ao(u,_,[f])}),ja=jt(function(u,f,_){var S=-1,T="function"==typeof f,O=vr(u)?re(u.length):[];return Cl(u,function(U){O[++S]=T?Mr(f,U,_):Tf(U,f,_)}),O}),ST=yd(function(u,f,_){Ao(u,_,f)});function ip(u,f){return(Nt(u)?Rn:md)(u,ft(f,3))}var db=yd(function(u,f,_){u[_?0:1].push(f)},function(){return[[],[]]}),F_=jt(function(u,f){if(null==u)return[];var _=f.length;return _>1&&Xi(u,f[0],f[1])?f=[]:_>2&&Xi(f[0],f[1],f[2])&&(f=[f[0]]),Dw(u,ki(f,1),[])}),Dd=$n||function(){return pr.Date.now()};function ar(u,f,_){return f=_?B:f,Ls(u,128,B,B,B,B,f=u&&null==f?u.length:f)}function tu(u,f){var _;if("function"!=typeof f)throw new ls(is);return u=zt(u),function(){return--u>0&&(_=f.apply(this,arguments)),u<=1&&(f=B),_}}var rp=jt(function(u,f,_){var S=1;if(_.length){var T=Co(_,$c(rp));S|=32}return Ls(u,S,f,_,T)}),U_=jt(function(u,f,_){var S=3;if(_.length){var T=Co(_,$c(U_));S|=32}return Ls(f,S,u,_,T)});function pb(u,f,_){var S,T,O,U,j,K,pe=0,me=!1,be=!1,He=!0;if("function"!=typeof u)throw new ls(is);function nt(Bn){var Si=S,ca=T;return S=T=B,pe=Bn,U=u.apply(ca,Si)}function pt(Bn){var Si=Bn-K;return K===B||Si>=f||Si<0||be&&Bn-pe>=O}function Gt(){var Bn=Dd();if(pt(Bn))return nn(Bn);j=Il(Gt,function $t(Bn){var tx=f-(Bn-K);return be?rr(tx,O-(Bn-pe)):tx}(Bn))}function nn(Bn){return j=B,He&&S?nt(Bn):(S=T=B,U)}function gs(){var Bn=Dd(),Si=pt(Bn);if(S=arguments,T=this,K=Bn,Si){if(j===B)return function ht(Bn){return pe=Bn,j=Il(Gt,f),me?nt(Bn):U}(K);if(be)return l_(j),j=Il(Gt,f),nt(K)}return j===B&&(j=Il(Gt,f)),U}return f=jr(f)||0,Xn(_)&&(me=!!_.leading,O=(be="maxWait"in _)?ti(jr(_.maxWait)||0,f):O,He="trailing"in _?!!_.trailing:He),gs.cancel=function Ki(){j!==B&&l_(j),pe=0,S=K=T=j=B},gs.flush=function Cn(){return j===B?U:nn(Dd())},gs}var mb=jt(function(u,f){return e_(u,1,f)}),IT=jt(function(u,f,_){return e_(u,jr(f)||0,_)});function sp(u,f){if("function"!=typeof u||null!=f&&"function"!=typeof f)throw new ls(is);var _=function(){var S=arguments,T=f?f.apply(this,S):S[0],O=_.cache;if(O.has(T))return O.get(T);var U=u.apply(this,S);return _.cache=O.set(T,U)||O,U};return _.cache=new(sp.Cache||La),_}function op(u){if("function"!=typeof u)throw new ls(is);return function(){var f=arguments;switch(f.length){case 0:return!u.call(this);case 1:return!u.call(this,f[0]);case 2:return!u.call(this,f[0],f[1]);case 3:return!u.call(this,f[0],f[1],f[2])}return!u.apply(this,f)}}sp.Cache=La;var H_=WM(function(u,f){var _=(f=1==f.length&&Nt(f[0])?Rn(f[0],Le(ft())):Rn(ki(f,1),Le(ft()))).length;return jt(function(S){for(var T=-1,O=rr(S.length,_);++T<O;)S[T]=f[T].call(this,S[T]);return Mr(u,this,S)})}),z_=jt(function(u,f){var _=Co(f,$c(z_));return Ls(u,32,B,f,_)}),nu=jt(function(u,f){var _=Co(f,$c(nu));return Ls(u,64,B,f,_)}),RT=sa(function(u,f){return Ls(u,256,B,B,B,f)});function no(u,f){return u===f||u!=u&&f!=f}var LT=Tl(r_),FT=Tl(function(u,f){return u>=f}),Nl=Ew(function(){return arguments}())?Ew:function(u){return ii(u)&&vn.call(u,"callee")&&!Kg.call(u,"callee")},Nt=re.isArray,cp=ed?Le(ed):function $i(u){return ii(u)&&Ar(u)==Ku};function vr(u){return null!=u&&Id(u.length)&&!ks(u)}function ni(u){return ii(u)&&vr(u)}var $a=pi||Qb,W_=td?Le(td):function Cw(u){return ii(u)&&Ar(u)==gl};function j_(u){if(!ii(u))return!1;var f=Ar(u);return f==Mc||"[object DOMException]"==f||"string"==typeof u.message&&"string"==typeof u.name&&!Ll(u)}function ks(u){if(!Xn(u))return!1;var f=Ar(u);return f==$h||f==k0||"[object AsyncFunction]"==f||"[object Proxy]"==f}function Eb(u){return"number"==typeof u&&u==zt(u)}function Id(u){return"number"==typeof u&&u>-1&&u%1==0&&u<=qo}function Xn(u){var f=typeof u;return null!=u&&("object"==f||"function"==f)}function ii(u){return null!=u&&"object"==typeof u}var up=sf?Le(sf):function Mw(u){return ii(u)&&Ui(u)==Xs};function q_(u){return"number"==typeof u||ii(u)&&Ar(u)==qh}function Ll(u){if(!ii(u)||Ar(u)!=Ta)return!1;var f=mr(u);if(null===f)return!0;var _=vn.call(f,"constructor")&&f.constructor;return"function"==typeof _&&_ instanceof _&&pf.call(_)==mw}var Fl=Bg?Le(Bg):function s_(u){return ii(u)&&Ar(u)==Tc},X_=iw?Le(iw):function VM(u){return ii(u)&&Ui(u)==Ys};function fp(u){return"string"==typeof u||!Nt(u)&&ii(u)&&Ar(u)==_l}function ps(u){return"symbol"==typeof u||ii(u)&&Ar(u)==Xh}var ru=Xt?Le(Xt):function Do(u){return ii(u)&&Id(u.length)&&!!Fn[Ar(u)]},Y_=Tl(pd),su=Tl(function(u,f){return u<=f});function Db(u){if(!u)return[];if(vr(u))return fp(u)?Ps(u):_r(u);if(ud&&u[ud])return function Eo(Y){for(var ue,re=[];!(ue=Y.next()).done;)re.push(ue.value);return re}(u[ud]());var f=Ui(u);return(f==Xs?an:f==Ys?Nc:kl)(u)}function aa(u){return u?(u=jr(u))===Tn||u===-Tn?17976931348623157e292*(u<0?-1:1):u==u?u:0:0===u?u:0}function zt(u){var f=aa(u),_=f%1;return f==f?_?f-_:f:0}function Ib(u){return u?Ua(zt(u),0,vo):0}function jr(u){if("number"==typeof u)return u;if(ps(u))return NaN;if(Xn(u)){var f="function"==typeof u.valueOf?u.valueOf():u;u=Xn(f)?f+"":f}if("string"!=typeof u)return 0===u?u:+u;u=cw(u);var _=nr.test(u);return _||xo.test(u)?YN(u.slice(2),_?2:8):hM.test(u)?NaN:+u}function Rb(u){return Qs(u,wr(u))}function dn(u){return null==u?"":fs(u)}var K_=Ha(function(u,f){if(qc(f)||vr(f))Qs(f,Yi(f),u);else for(var _ in f)vn.call(f,_)&&Bc(u,_,f[_])}),Z_=Ha(function(u,f){Qs(f,wr(f),u)}),Pd=Ha(function(u,f,_,S){Qs(f,wr(f),u,S)}),Pb=Ha(function(u,f,_,S){Qs(f,Yi(f),u,S)}),Nb=sa(bf),VT=jt(function(u,f){u=An(u);var _=-1,S=f.length,T=S>2?f[2]:B;for(T&&Xi(f[0],f[1],T)&&(S=1);++_<S;)for(var O=f[_],U=wr(O),j=-1,K=U.length;++j<K;){var pe=U[j],me=u[pe];(me===B||no(me,Oc[pe])&&!vn.call(u,pe))&&(u[pe]=O[pe])}return u}),HT=jt(function(u){return u.push(B,__),Mr(J_,B,u)});function Ob(u,f,_){var S=null==u?B:Ba(u,f);return S===B?_:S}function mp(u,f){return null!=u&&v_(u,f,Sw)}var jT=kf(function(u,f,_){null!=f&&"function"!=typeof f.toString&&(f=mf.call(f)),u[f]=_},kd(br)),$T=kf(function(u,f,_){null!=f&&"function"!=typeof f.toString&&(f=mf.call(f)),vn.call(u,f)?u[f].push(_):u[f]=[_]},ft),qT=jt(Tf);function Yi(u){return vr(u)?dd(u):Df(u)}function wr(u){return vr(u)?dd(u,!0):function Pn(u){if(!Xn(u))return function Kw(u){var f=[];if(null!=u)for(var _ in An(u))f.push(_);return f}(u);var f=qc(u),_=[];for(var S in u)"constructor"==S&&(f||!vn.call(u,S))||_.push(S);return _}(u)}var Lb=Ha(function(u,f,_){gd(u,f,_)}),J_=Ha(function(u,f,_,S){gd(u,f,_,S)}),Fb=sa(function(u,f){var _={};if(null==u)return _;var S=!1;f=Rn(f,function(O){return O=Io(O,u),S||(S=O.length>1),O}),Qs(u,xd(u),_),S&&(_=Tr(_,7,zw));for(var T=f.length;T--;)Qt(_,f[T]);return _}),HO=sa(function(u,f){return null==u?{}:function HM(u,f){return Iw(u,f,function(_,S){return mp(u,S)})}(u,f)});function XT(u,f){if(null==u)return{};var _=Rn(xd(u),function(S){return[S]});return f=ft(f),Iw(u,_,function(S,T){return f(S,T[0])})}var YT=wd(Yi),ty=wd(wr);function kl(u){return null==u?[]:cf(u,Yi(u))}var au=za(function(u,f,_){return f=f.toLowerCase(),u+(_?kb(f):f)});function kb(u){return yp(dn(u).toLowerCase())}function Ub(u){return(u=dn(u))&&u.replace(fM,CM).replace(wM,"")}var i1=za(function(u,f,_){return u+(_?"-":"")+f.toLowerCase()}),r1=za(function(u,f,_){return u+(_?" ":"")+f.toLowerCase()}),s1=f_("toLowerCase"),zb=za(function(u,f,_){return u+(_?"_":"")+f.toLowerCase()}),iy=za(function(u,f,_){return u+(_?" ":"")+yp(f)}),$b=za(function(u,f,_){return u+(_?" ":"")+f.toUpperCase()}),yp=f_("toUpperCase");function Xa(u,f,_){return u=dn(u),(f=_?B:f)===B?function Rs(Y){return WN.test(Y)}(u)?function fw(Y){return Y.match(yl)||[]}(u):function ZN(Y){return Y.match(cM)||[]}(u):u.match(f)||[]}var qb=jt(function(u,f){try{return Mr(u,B,f)}catch(_){return j_(_)?_:new Pt(_)}}),ay=sa(function(u,f){return Un(f,function(_){_=Pr(_),Ao(u,_,rp(u[_],u))}),u});function kd(u){return function(){return u}}var ms=Ga(),bp=Ga(!0);function br(u){return u}function ly(u){return o_("function"==typeof u?u:Tr(u,1))}var lu=jt(function(u,f){return function(_){return Tf(_,u,f)}}),u1=jt(function(u,f){return function(_){return Tf(u,_,f)}});function cy(u,f,_){var S=Yi(f),T=Cf(f,S);null==_&&(!Xn(f)||!T.length&&S.length)&&(_=f,f=u,u=this,T=Cf(f,Yi(f)));var O=!(Xn(_)&&"chain"in _&&!_.chain),U=ks(u);return Un(T,function(j){var K=f[j];u[j]=K,U&&(u.prototype[j]=function(){var pe=this.__chain__;if(O||pe){var me=u(this.__wrapped__);return(me.__actions__=_r(this.__actions__)).push({func:K,args:arguments,thisArg:u}),me.__chain__=pe,me}return K.apply(u,So([this.value()],arguments))})}),u}function Ud(){}var h1=p_(Rn),Yb=p_(SM),Ya=p_(zg);function f1(u){return Ed(u)?jg(Pr(u)):function Va(u){return function(f){return Ba(f,u)}}(u)}var Zb=m_(),p1=m_(!0);function Jb(){return[]}function Qb(){return!1}var fy=Uf(function(u,f){return u+f},0),Bd=g_("ceil"),Ep=Uf(function(u,f){return u/f},1),uu=g_("floor"),g1=Uf(function(u,f){return u*f},1),ex=g_("round"),_1=Uf(function(u,f){return u-f},0);return I.after=function k_(u,f){if("function"!=typeof f)throw new ls(is);return u=zt(u),function(){if(--u<1)return f.apply(this,arguments)}},I.ary=ar,I.assign=K_,I.assignIn=Z_,I.assignInWith=Pd,I.assignWith=Pb,I.at=Nb,I.before=tu,I.bind=rp,I.bindAll=ay,I.bindKey=U_,I.castArray=function ap(){if(!arguments.length)return[];var u=arguments[0];return Nt(u)?u:[u]},I.chain=wT,I.chunk=function gO(u,f,_){f=(_?Xi(u,f,_):f===B)?1:ti(zt(f),0);var S=null==u?0:u.length;if(!S||f<1)return[];for(var T=0,O=0,U=re(Ra(S/f));T<S;)U[O++]=hs(u,T,T+=f);return U},I.compact=function QM(u){for(var f=-1,_=null==u?0:u.length,S=0,T=[];++f<_;){var O=u[f];O&&(T[S++]=O)}return T},I.concat=function _O(){var u=arguments.length;if(!u)return[];for(var f=re(u-1),_=arguments[0],S=u;S--;)f[S-1]=arguments[S];return So(Nt(_)?_r(_):[_],ki(f,1))},I.cond=function vp(u){var f=null==u?0:u.length,_=ft();return u=f?Rn(u,function(S){if("function"!=typeof S[1])throw new ls(is);return[_(S[0]),S[1]]}):[],jt(function(S){for(var T=-1;++T<f;){var O=u[T];if(Mr(O[0],this,S))return Mr(O[1],this,S)}})},I.conforms=function l1(u){return function hd(u){var f=Yi(u);return function(_){return El(_,u,f)}}(Tr(u,1))},I.constant=kd,I.countBy=OO,I.create=function BT(u,f){var _=Fi(u);return null==f?_:wf(_,f)},I.curry=function fb(u,f,_){var S=Ls(u,8,B,B,B,B,B,f=_?B:f);return S.placeholder=fb.placeholder,S},I.curryRight=function B_(u,f,_){var S=Ls(u,16,B,B,B,B,B,f=_?B:f);return S.placeholder=B_.placeholder,S},I.debounce=pb,I.defaults=VT,I.defaultsDeep=HT,I.defer=mb,I.delay=IT,I.difference=yO,I.differenceBy=vO,I.differenceWith=wO,I.drop=function bO(u,f,_){var S=null==u?0:u.length;return S?hs(u,(f=_||f===B?1:zt(f))<0?0:f,S):[]},I.dropRight=function xO(u,f,_){var S=null==u?0:u.length;return S?hs(u,0,(f=S-(f=_||f===B?1:zt(f)))<0?0:f):[]},I.dropRightWhile=function Yc(u,f){return u&&u.length?or(u,ft(f,3),!0,!0):[]},I.dropWhile=function eT(u,f){return u&&u.length?or(u,ft(f,3),!0):[]},I.fill=function tT(u,f,_,S){var T=null==u?0:u.length;return T?(_&&"number"!=typeof _&&Xi(u,f,_)&&(_=0,S=T),function pO(u,f,_,S){var T=u.length;for((_=zt(_))<0&&(_=-_>T?0:T+_),(S=S===B||S>T?T:zt(S))<0&&(S+=T),S=_>S?0:Ib(S);_<S;)u[_++]=f;return u}(u,f,_,S)):[]},I.filter=function Qf(u,f){return(Nt(u)?un:t_)(u,ft(f,3))},I.flatMap=function cb(u,f){return ki(ip(u,f),1)},I.flatMapDeep=function ub(u,f){return ki(ip(u,f),Tn)},I.flatMapDepth=function eu(u,f,_){return _=_===B?1:zt(_),ki(ip(u,f),_)},I.flatten=Kc,I.flattenDeep=function nT(u){return null!=u&&u.length?ki(u,Tn):[]},I.flattenDepth=function Fs(u,f){return null!=u&&u.length?ki(u,f=f===B?1:zt(f)):[]},I.flip=function gb(u){return Ls(u,512)},I.flow=ms,I.flowRight=bp,I.fromPairs=function Zc(u){for(var f=-1,_=null==u?0:u.length,S={};++f<_;){var T=u[f];S[T[0]]=T[1]}return S},I.functions=function kO(u){return null==u?[]:Cf(u,Yi(u))},I.functionsIn=function UO(u){return null==u?[]:Cf(u,wr(u))},I.groupBy=tp,I.initial=function Td(u){return null!=u&&u.length?hs(u,0,-1):[]},I.intersection=iT,I.intersectionBy=SO,I.intersectionWith=rT,I.invert=jT,I.invertBy=$T,I.invokeMap=ja,I.iteratee=ly,I.keyBy=ST,I.keys=Yi,I.keysIn=wr,I.map=ip,I.mapKeys=function la(u,f){var _={};return f=ft(f,3),na(u,function(S,T,O){Ao(_,f(S,T,O),S)}),_},I.mapValues=function Od(u,f){var _={};return f=ft(f,3),na(u,function(S,T,O){Ao(_,T,f(S,T,O))}),_},I.matches=function c1(u){return Dr(Tr(u,1))},I.matchesProperty=function Xb(u,f){return Aw(u,Tr(f,1))},I.memoize=sp,I.merge=Lb,I.mergeWith=J_,I.method=lu,I.methodOf=u1,I.mixin=cy,I.negate=op,I.nthArg=function xp(u){return u=zt(u),jt(function(f){return Gr(f,u)})},I.omit=Fb,I.omitBy=function VO(u,f){return XT(u,op(ft(f)))},I.once=function V_(u){return tu(2,u)},I.orderBy=function ET(u,f,_,S){return null==u?[]:(Nt(f)||(f=null==f?[]:[f]),Nt(_=S?B:_)||(_=null==_?[]:[_]),Dw(u,f,_))},I.over=h1,I.overArgs=H_,I.overEvery=Yb,I.overSome=Ya,I.partial=z_,I.partialRight=nu,I.partition=db,I.pick=HO,I.pickBy=XT,I.property=f1,I.propertyOf=function Kb(u){return function(f){return null==u?B:Ba(u,f)}},I.pull=CO,I.pullAll=T_,I.pullAllBy=function sT(u,f,_){return u&&u.length&&f&&f.length?If(u,f,ft(_,2)):u},I.pullAllWith=function oT(u,f,_){return u&&u.length&&f&&f.length?If(u,f,B,_):u},I.pullAt=aT,I.range=Zb,I.rangeRight=p1,I.rearg=RT,I.reject=function MT(u,f){return(Nt(u)?un:t_)(u,op(ft(f,3)))},I.remove=function lT(u,f){var _=[];if(!u||!u.length)return _;var S=-1,T=[],O=u.length;for(f=ft(f,3);++S<O;){var U=u[S];f(U,S,u)&&(_.push(U),T.push(S))}return Rw(u,T),_},I.rest=function PT(u,f){if("function"!=typeof u)throw new ls(is);return jt(u,f=f===B?f:zt(f))},I.reverse=A_,I.sampleSize=function hb(u,f,_){return f=(_?Xi(u,f,_):f===B)?1:zt(f),(Nt(u)?vw:Nw)(u,f)},I.set=function ey(u,f,_){return null==u?u:Nf(u,f,_)},I.setWith=function zO(u,f,_,S){return S="function"==typeof S?S:B,null==u?u:Nf(u,f,_,S)},I.shuffle=function AT(u){return(Nt(u)?ww:GM)(u)},I.slice=function cT(u,f,_){var S=null==u?0:u.length;return S?(_&&"number"!=typeof _&&Xi(u,f,_)?(f=0,_=S):(f=null==f?0:zt(f),_=_===B?S:zt(_)),hs(u,f,_)):[]},I.sortBy=F_,I.sortedUniq=function hT(u){return u&&u.length?Lw(u):[]},I.sortedUniqBy=function eb(u,f){return u&&u.length?Lw(u,ft(f,2)):[]},I.split=function Gb(u,f,_){return _&&"number"!=typeof _&&Xi(u,f,_)&&(f=_=B),(_=_===B?vo:_>>>0)?(u=dn(u))&&("string"==typeof f||null!=f&&!Fl(f))&&!(f=fs(f))&&Yo(u)?Ml(Ps(u),0,_):u.split(f,_):[]},I.spread=function _b(u,f){if("function"!=typeof u)throw new ls(is);return f=null==f?0:ti(zt(f),0),jt(function(_){var S=_[f],T=Ml(_,0,f);return S&&So(T,S),Mr(u,this,T)})},I.tail=function I_(u){var f=null==u?0:u.length;return f?hs(u,1,f):[]},I.take=function Kf(u,f,_){return u&&u.length?hs(u,0,(f=_||f===B?1:zt(f))<0?0:f):[]},I.takeRight=function tb(u,f,_){var S=null==u?0:u.length;return S?hs(u,(f=S-(f=_||f===B?1:zt(f)))<0?0:f,S):[]},I.takeRightWhile=function fT(u,f){return u&&u.length?or(u,ft(f,3),!1,!0):[]},I.takeWhile=function pT(u,f){return u&&u.length?or(u,ft(f,3)):[]},I.tap=function bT(u,f){return f(u),u},I.throttle=function yb(u,f,_){var S=!0,T=!0;if("function"!=typeof u)throw new ls(is);return Xn(_)&&(S="leading"in _?!!_.leading:S,T="trailing"in _?!!_.trailing:T),pb(u,f,{leading:S,maxWait:f,trailing:T})},I.thru=Jf,I.toArray=Db,I.toPairs=YT,I.toPairsIn=ty,I.toPath=function cu(u){return Nt(u)?Rn(u,Pr):ps(u)?[u]:_r(Rl(dn(u)))},I.toPlainObject=Rb,I.transform=function KT(u,f,_){var S=Nt(u),T=S||$a(u)||ru(u);if(f=ft(f,4),null==_){var O=u&&u.constructor;_=T?S?new O:[]:Xn(u)&&ks(O)?Fi(mr(u)):{}}return(T?Un:na)(u,function(U,j,K){return f(_,U,j,K)}),_},I.unary=function vb(u){return ar(u,1)},I.union=Qc,I.unionBy=Ad,I.unionWith=mT,I.uniq=function MO(u){return u&&u.length?ge(u):[]},I.uniqBy=function nb(u,f){return u&&u.length?ge(u,ft(f,2)):[]},I.uniqWith=function gT(u,f){return f="function"==typeof f?f:B,u&&u.length?ge(u,B,f):[]},I.unset=function ZT(u,f){return null==u||Qt(u,f)},I.unzip=ib,I.unzipWith=rb,I.update=function JT(u,f,_){return null==u?u:Ir(u,f,_d(_))},I.updateWith=function QT(u,f,_,S){return S="function"==typeof S?S:B,null==u?u:Ir(u,f,_d(_),S)},I.values=kl,I.valuesIn=function gp(u){return null==u?[]:cf(u,wr(u))},I.without=_T,I.words=Xa,I.wrap=function iu(u,f){return z_(_d(f),u)},I.xor=yT,I.xorBy=Zf,I.xorWith=sb,I.zip=vT,I.zipObject=function ob(u,f){return Gc(u||[],f||[],Bc)},I.zipObjectDeep=function TO(u,f){return Gc(u||[],f||[],Nf)},I.zipWith=ab,I.entries=YT,I.entriesIn=ty,I.extend=Z_,I.extendWith=Pd,cy(I,I),I.add=fy,I.attempt=qb,I.camelCase=au,I.capitalize=kb,I.ceil=Bd,I.clamp=function e1(u,f,_){return _===B&&(_=f,f=B),_!==B&&(_=(_=jr(_))==_?_:0),f!==B&&(f=(f=jr(f))==f?f:0),Ua(jr(u),f,_)},I.clone=function wb(u){return Tr(u,4)},I.cloneDeep=function lp(u){return Tr(u,5)},I.cloneDeepWith=function NT(u,f){return Tr(u,5,f="function"==typeof f?f:B)},I.cloneWith=function G_(u,f){return Tr(u,4,f="function"==typeof f?f:B)},I.conformsTo=function OT(u,f){return null==f||El(u,f,Yi(f))},I.deburr=Ub,I.defaultTo=function wp(u,f){return null==u||u!=u?f:u},I.divide=Ep,I.endsWith=function Bb(u,f,_){u=dn(u),f=fs(f);var S=u.length,T=_=_===B?S:Ua(zt(_),0,S);return(_-=f.length)>=0&&u.slice(_,T)==f},I.eq=no,I.escape=function Vb(u){return(u=dn(u))&&V0.test(u)?u.replace(B0,MM):u},I.escapeRegExp=function n1(u){return(u=dn(u))&&j0.test(u)?u.replace(Zh,"\\$&"):u},I.every=function xT(u,f,_){var S=Nt(u)?SM:LM;return _&&Xi(u,f,_)&&(f=B),S(u,ft(f,3))},I.find=ep,I.findIndex=xi,I.findKey=function zT(u,f){return EM(u,ft(f,3),na)},I.findLast=lb,I.findLastIndex=Qw,I.findLastKey=function GT(u,f){return EM(u,ft(f,3),xw)},I.floor=uu,I.forEach=N_,I.forEachRight=O_,I.forIn=function qa(u,f){return null==u?u:n_(u,ft(f,3),wr)},I.forInRight=function Nd(u,f){return null==u?u:Ef(u,ft(f,3),wr)},I.forOwn=function WT(u,f){return u&&na(u,ft(f,3))},I.forOwnRight=function FO(u,f){return u&&xw(u,ft(f,3))},I.get=Ob,I.gt=LT,I.gte=FT,I.has=function BO(u,f){return null!=u&&v_(u,f,FM)},I.hasIn=mp,I.head=C_,I.identity=br,I.includes=function np(u,f,_,S){u=vr(u)?u:kl(u),_=_&&!S?zt(_):0;var T=u.length;return _<0&&(_=ti(T+_,0)),fp(u)?_<=T&&u.indexOf(f,_)>-1:!!T&&nd(u,f,_)>-1},I.indexOf=function $f(u,f,_){var S=null==u?0:u.length;if(!S)return-1;var T=null==_?0:zt(_);return T<0&&(T=ti(S+T,0)),nd(u,f,T)},I.inRange=function ny(u,f,_){return f=aa(f),_===B?(_=f,f=0):_=aa(_),function kM(u,f,_){return u>=rr(f,_)&&u<ti(f,_)}(u=jr(u),f,_)},I.invoke=qT,I.isArguments=Nl,I.isArray=Nt,I.isArrayBuffer=cp,I.isArrayLike=vr,I.isArrayLikeObject=ni,I.isBoolean=function kT(u){return!0===u||!1===u||ii(u)&&Ar(u)==tn},I.isBuffer=$a,I.isDate=W_,I.isElement=function bb(u){return ii(u)&&1===u.nodeType&&!Ll(u)},I.isEmpty=function Ol(u){if(null==u)return!0;if(vr(u)&&(Nt(u)||"string"==typeof u||"function"==typeof u.splice||$a(u)||ru(u)||Nl(u)))return!u.length;var f=Ui(u);if(f==Xs||f==Ys)return!u.size;if(qc(u))return!Df(u).length;for(var _ in u)if(vn.call(u,_))return!1;return!0},I.isEqual=function xb(u,f){return fd(u,f)},I.isEqualWith=function Sb(u,f,_){var S=(_="function"==typeof _?_:B)?_(u,f):B;return S===B?fd(u,f,B,_):!!S},I.isError=j_,I.isFinite=function LO(u){return"number"==typeof u&&Zo(u)},I.isFunction=ks,I.isInteger=Eb,I.isLength=Id,I.isMap=up,I.isMatch=function Cb(u,f){return u===f||Af(u,f,Sd(f))},I.isMatchWith=function dp(u,f,_){return _="function"==typeof _?_:B,Af(u,f,Sd(f),_)},I.isNaN=function Rd(u){return q_(u)&&u!=+u},I.isNative=function Mb(u){if(Xw(u))throw new Pt("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Tw(u)},I.isNil=function hp(u){return null==u},I.isNull=function $_(u){return null===u},I.isNumber=q_,I.isObject=Xn,I.isObjectLike=ii,I.isPlainObject=Ll,I.isRegExp=Fl,I.isSafeInteger=function UT(u){return Eb(u)&&u>=-qo&&u<=qo},I.isSet=X_,I.isString=fp,I.isSymbol=ps,I.isTypedArray=ru,I.isUndefined=function Tb(u){return u===B},I.isWeakMap=function Ab(u){return ii(u)&&Ui(u)==Ac},I.isWeakSet=function pp(u){return ii(u)&&"[object WeakSet]"==Ar(u)},I.join=function EO(u,f){return null==u?"":Lc.call(u,f)},I.kebabCase=i1,I.last=qn,I.lastIndexOf=function M_(u,f,_){var S=null==u?0:u.length;if(!S)return-1;var T=S;return _!==B&&(T=(T=zt(_))<0?ti(S+T,0):rr(T,S-1)),f==f?function ld(Y,ue,re){for(var Ue=re+1;Ue--;)if(Y[Ue]===ue)return Ue;return Ue}(u,f,T):Wg(u,lf,T,!0)},I.lowerCase=r1,I.lowerFirst=s1,I.lt=Y_,I.lte=su,I.max=function py(u){return u&&u.length?Sf(u,br,r_):B},I.maxBy=function my(u,f){return u&&u.length?Sf(u,ft(f,2),r_):B},I.mean=function Cp(u){return rd(u,br)},I.meanBy=function $O(u,f){return rd(u,ft(f,2))},I.min=function gy(u){return u&&u.length?Sf(u,br,pd):B},I.minBy=function Vd(u,f){return u&&u.length?Sf(u,ft(f,2),pd):B},I.stubArray=Jb,I.stubFalse=Qb,I.stubObject=function Sp(){return{}},I.stubString=function m1(){return""},I.stubTrue=function uy(){return!0},I.multiply=g1,I.nth=function Jc(u,f){return u&&u.length?Gr(u,zt(f)):B},I.noConflict=function d1(){return pr._===this&&(pr._=yt),this},I.noop=Ud,I.now=Dd,I.pad=function Hb(u,f,_){u=dn(u);var S=(f=zt(f))?vl(u):0;if(!f||S>=f)return u;var T=(f-S)/2;return Bf(Li(T),_)+u+Bf(Ra(T),_)},I.padEnd=function GO(u,f,_){u=dn(u);var S=(f=zt(f))?vl(u):0;return f&&S<f?u+Bf(f-S,_):u},I.padStart=function WO(u,f,_){u=dn(u);var S=(f=zt(f))?vl(u):0;return f&&S<f?Bf(f-S,_)+u:u},I.parseInt=function Ld(u,f,_){return _||null==f?f=0:f&&(f=+f),mi(dn(u).replace(Jh,""),f||0)},I.random=function t1(u,f,_){if(_&&"boolean"!=typeof _&&Xi(u,f,_)&&(f=_=B),_===B&&("boolean"==typeof f?(_=f,f=B):"boolean"==typeof u&&(_=u,u=B)),u===B&&f===B?(u=0,f=1):(u=aa(u),f===B?(f=u,u=0):f=aa(f)),u>f){var S=u;u=f,f=S}if(_||u%1||f%1){var T=kc();return rr(u+T*(f-u+XN("1e-"+((T+"").length-1))),f)}return Rf(u,f)},I.reduce=function L_(u,f,_){var S=Nt(u)?af:aw,T=arguments.length<3;return S(u,ft(f,4),_,T,Cl)},I.reduceRight=function CT(u,f,_){var S=Nt(u)?Hg:aw,T=arguments.length<3;return S(u,ft(f,4),_,T,OM)},I.repeat=function Ye(u,f,_){return f=(_?Xi(u,f,_):f===B)?1:zt(f),Pf(dn(u),f)},I.replace=function Fd(){var u=arguments,f=dn(u[0]);return u.length<3?f:f.replace(u[1],u[2])},I.result=function Q_(u,f,_){var S=-1,T=(f=Io(f,u)).length;for(T||(T=1,u=B);++S<T;){var O=null==u?B:u[Pr(f[S])];O===B&&(S=T,O=_),u=ks(O)?O.call(u):O}return u},I.round=ex,I.runInContext=Y,I.sample=function TT(u){return(Nt(u)?ds:xt)(u)},I.size=function DT(u){if(null==u)return 0;if(vr(u))return fp(u)?vl(u):u.length;var f=Ui(u);return f==Xs||f==Ys?u.size:Df(u).length},I.snakeCase=zb,I.some=function Wr(u,f,_){var S=Nt(u)?zg:zc;return _&&Xi(u,f,_)&&(f=B),S(u,ft(f,3))},I.sortedIndex=function D_(u,f){return Of(u,f)},I.sortedIndexBy=function qf(u,f,_){return a_(u,f,ft(_,2))},I.sortedIndexOf=function uT(u,f){var _=null==u?0:u.length;if(_){var S=Of(u,f);if(S<_&&no(u[S],f))return S}return-1},I.sortedLastIndex=function Xf(u,f){return Of(u,f,!0)},I.sortedLastIndexBy=function dT(u,f,_){return a_(u,f,ft(_,2),!0)},I.sortedLastIndexOf=function Yf(u,f){if(null!=u&&u.length){var S=Of(u,f,!0)-1;if(no(u[S],f))return S}return-1},I.startCase=iy,I.startsWith=function ry(u,f,_){return u=dn(u),_=null==_?0:Ua(zt(_),0,u.length),f=fs(f),u.slice(_,_+f.length)==f},I.subtract=_1,I.sum=function y1(u){return u&&u.length?Da(u,br):0},I.sumBy=function _y(u,f){return u&&u.length?Da(u,ft(f,2)):0},I.template=function o1(u,f,_){var S=I.templateSettings;_&&Xi(u,f,_)&&(f=B),u=dn(u),f=Pd({},f,S,Hf);var j,K,T=Pd({},f.imports,S.imports,Hf),O=Yi(T),U=cf(T,O),pe=0,me=f.interpolate||Qh,be="__p += '",He=Xg((f.escape||Qh).source+"|"+me.source+"|"+(me===Pg?dM:Qh).source+"|"+(f.evaluate||Qh).source+"|$","g"),nt="//# sourceURL="+(vn.call(f,"sourceURL")?(f.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++$N+"]")+"\n";u.replace(He,function(pt,Gt,nn,Ki,Cn,gs){return nn||(nn=Ki),be+=u.slice(pe,gs).replace(Ng,TM),Gt&&(j=!0,be+="' +\n__e("+Gt+") +\n'"),Cn&&(K=!0,be+="';\n"+Cn+";\n__p += '"),nn&&(be+="' +\n((__t = ("+nn+")) == null ? '' : __t) +\n'"),pe=gs+pt.length,pt}),be+="';\n";var ht=vn.call(f,"variable")&&f.variable;if(ht){if($0.test(ht))throw new Pt("Invalid `variable` option passed into `_.template`")}else be="with (obj) {\n"+be+"\n}\n";be=(K?be.replace(nM,""):be).replace(iM,"$1").replace(rM,"$1;"),be="function("+(ht||"obj")+") {\n"+(ht?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(j?", __e = _.escape":"")+(K?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+be+"return __p\n}";var $t=qb(function(){return fn(O,nt+"return "+be).apply(B,U)});if($t.source=be,j_($t))throw $t;return $t},I.times=function dy(u,f){if((u=zt(u))<1||u>qo)return[];var _=vo,S=rr(u,vo);f=ft(f),u-=vo;for(var T=qg(S,f);++_<u;)f(_);return T},I.toFinite=aa,I.toInteger=zt,I.toLength=Ib,I.toLower=function Wb(u){return dn(u).toLowerCase()},I.toNumber=jr,I.toSafeInteger=function ou(u){return u?Ua(zt(u),-qo,qo):0===u?u:0},I.toString=dn,I.toUpper=function jb(u){return dn(u).toUpperCase()},I.trim=function _p(u,f,_){if((u=dn(u))&&(_||f===B))return cw(u);if(!u||!(f=fs(f)))return u;var S=Ps(u),T=Ps(f);return Ml(S,sd(S,T),uf(S,T)+1).join("")},I.trimEnd=function jO(u,f,_){if((u=dn(u))&&(_||f===B))return u.slice(0,df(u)+1);if(!u||!(f=fs(f)))return u;var S=Ps(u);return Ml(S,0,uf(S,Ps(f))+1).join("")},I.trimStart=function sy(u,f,_){if((u=dn(u))&&(_||f===B))return u.replace(Jh,"");if(!u||!(f=fs(f)))return u;var S=Ps(u);return Ml(S,sd(S,Ps(f))).join("")},I.truncate=function a1(u,f){var _=30,S="...";if(Xn(f)){var T="separator"in f?f.separator:T;_="length"in f?zt(f.length):_,S="omission"in f?fs(f.omission):S}var O=(u=dn(u)).length;if(Yo(u)){var U=Ps(u);O=U.length}if(_>=O)return u;var j=_-vl(S);if(j<1)return S;var K=U?Ml(U,0,j).join(""):u.slice(0,j);if(T===B)return K+S;if(U&&(j+=K.length-j),Fl(T)){if(u.slice(j).search(T)){var pe,me=K;for(T.global||(T=Xg(T.source,dn(bo.exec(T))+"g")),T.lastIndex=0;pe=T.exec(me);)var be=pe.index;K=K.slice(0,be===B?j:be)}}else if(u.indexOf(fs(T),j)!=j){var He=K.lastIndexOf(T);He>-1&&(K=K.slice(0,He))}return K+S},I.unescape=function oy(u){return(u=dn(u))&&UN.test(u)?u.replace(U0,dw):u},I.uniqueId=function hy(u){var f=++IM;return dn(u)+f},I.upperCase=$b,I.upperFirst=yp,I.each=N_,I.eachRight=O_,I.first=C_,cy(I,function(){var u={};return na(I,function(f,_){vn.call(I.prototype,_)||(u[_]=f)}),u}(),{chain:!1}),I.VERSION="4.17.21",Un(["bind","bindKey","curry","curryRight","partial","partialRight"],function(u){I[u].placeholder=I}),Un(["drop","take"],function(u,f){Vt.prototype[u]=function(_){_=_===B?1:ti(zt(_),0);var S=this.__filtered__&&!f?new Vt(this):this.clone();return S.__filtered__?S.__takeCount__=rr(_,S.__takeCount__):S.__views__.push({size:rr(_,vo),type:u+(S.__dir__<0?"Right":"")}),S},Vt.prototype[u+"Right"]=function(_){return this.reverse()[u](_).reverse()}}),Un(["filter","map","takeWhile"],function(u,f){var _=f+1,S=1==_||3==_;Vt.prototype[u]=function(T){var O=this.clone();return O.__iteratees__.push({iteratee:ft(T,3),type:_}),O.__filtered__=O.__filtered__||S,O}}),Un(["head","last"],function(u,f){var _="take"+(f?"Right":"");Vt.prototype[u]=function(){return this[_](1).value()[0]}}),Un(["initial","tail"],function(u,f){var _="drop"+(f?"":"Right");Vt.prototype[u]=function(){return this.__filtered__?new Vt(this):this[_](1)}}),Vt.prototype.compact=function(){return this.filter(br)},Vt.prototype.find=function(u){return this.filter(u).head()},Vt.prototype.findLast=function(u){return this.reverse().find(u)},Vt.prototype.invokeMap=jt(function(u,f){return"function"==typeof u?new Vt(this):this.map(function(_){return Tf(_,u,f)})}),Vt.prototype.reject=function(u){return this.filter(op(ft(u)))},Vt.prototype.slice=function(u,f){u=zt(u);var _=this;return _.__filtered__&&(u>0||f<0)?new Vt(_):(u<0?_=_.takeRight(-u):u&&(_=_.drop(u)),f!==B&&(_=(f=zt(f))<0?_.dropRight(-f):_.take(f-u)),_)},Vt.prototype.takeRightWhile=function(u){return this.reverse().takeWhile(u).reverse()},Vt.prototype.toArray=function(){return this.take(vo)},na(Vt.prototype,function(u,f){var _=/^(?:filter|find|map|reject)|While$/.test(f),S=/^(?:head|last)$/.test(f),T=I[S?"take"+("last"==f?"Right":""):f],O=S||/^find/.test(f);T&&(I.prototype[f]=function(){var U=this.__wrapped__,j=S?[1]:arguments,K=U instanceof Vt,pe=j[0],me=K||Nt(U),be=function(Gt){var nn=T.apply(I,So([Gt],j));return S&&He?nn[0]:nn};me&&_&&"function"==typeof pe&&1!=pe.length&&(K=me=!1);var He=this.__chain__,ht=O&&!He,$t=K&&!this.__actions__.length;if(!O&&me){U=$t?U:new Vt(this);var pt=u.apply(U,j);return pt.__actions__.push({func:Jf,args:[be],thisArg:B}),new zr(pt,He)}return ht&&$t?u.apply(this,j):(pt=this.thru(be),ht?S?pt.value()[0]:pt.value():pt)})}),Un(["pop","push","shift","sort","splice","unshift"],function(u){var f=ff[u],_=/^(?:push|sort|unshift)$/.test(u)?"tap":"thru",S=/^(?:pop|shift)$/.test(u);I.prototype[u]=function(){var T=arguments;if(S&&!this.__chain__){var O=this.value();return f.apply(Nt(O)?O:[],T)}return this[_](function(U){return f.apply(Nt(U)?U:[],T)})}}),na(Vt.prototype,function(u,f){var _=I[f];if(_){var S=_.name+"";vn.call(Bt,S)||(Bt[S]=[]),Bt[S].push({name:f,func:_})}}),Bt[Nn(B,2).name]=[{name:"wrapper",func:B}],Vt.prototype.clone=function yf(){var u=new Vt(this.__wrapped__);return u.__actions__=_r(this.__actions__),u.__dir__=this.__dir__,u.__filtered__=this.__filtered__,u.__iteratees__=_r(this.__iteratees__),u.__takeCount__=this.__takeCount__,u.__views__=_r(this.__views__),u},Vt.prototype.reverse=function Zs(){if(this.__filtered__){var u=new Vt(this);u.__dir__=-1,u.__filtered__=!0}else(u=this.clone()).__dir__*=-1;return u},Vt.prototype.value=function Jg(){var u=this.__wrapped__.value(),f=this.__dir__,_=Nt(u),S=f<0,T=_?u.length:0,O=function mO(u,f,_){for(var S=-1,T=_.length;++S<T;){var O=_[S],U=O.size;switch(O.type){case"drop":u+=U;break;case"dropRight":f-=U;break;case"take":f=rr(f,u+U);break;case"takeRight":u=ti(u,f-U)}}return{start:u,end:f}}(0,T,this.__views__),U=O.start,j=O.end,K=j-U,pe=S?j:U-1,me=this.__iteratees__,be=me.length,He=0,nt=rr(K,this.__takeCount__);if(!_||!S&&T==K&&nt==K)return qi(u,this.__actions__);var ht=[];e:for(;K--&&He<nt;){for(var $t=-1,pt=u[pe+=f];++$t<be;){var Gt=me[$t],Ki=Gt.type,Cn=(0,Gt.iteratee)(pt);if(2==Ki)pt=Cn;else if(!Cn){if(1==Ki)continue e;break e}}ht[He++]=pt}return ht},I.prototype.at=R_,I.prototype.chain=function AO(){return wT(this)},I.prototype.commit=function DO(){return new zr(this.value(),this.__chain__)},I.prototype.next=function P_(){this.__values__===B&&(this.__values__=Db(this.value()));var u=this.__index__>=this.__values__.length;return{done:u,value:u?B:this.__values__[this.__index__++]}},I.prototype.plant=function RO(u){for(var f,_=this;_ instanceof ji;){var S=Pl(_);S.__index__=0,S.__values__=B,f?T.__wrapped__=S:f=S;var T=S;_=_.__wrapped__}return T.__wrapped__=u,f},I.prototype.reverse=function PO(){var u=this.__wrapped__;if(u instanceof Vt){var f=u;return this.__actions__.length&&(f=new Vt(this)),(f=f.reverse()).__actions__.push({func:Jf,args:[A_],thisArg:B}),new zr(f,this.__chain__)}return this.thru(A_)},I.prototype.toJSON=I.prototype.valueOf=I.prototype.value=function NO(){return qi(this.__wrapped__,this.__actions__)},I.prototype.first=I.prototype.head,ud&&(I.prototype[ud]=function IO(){return this}),I}();pr._=hf,(_n=function(){return hf}.call(xc,Hh,xc,qs))!==B&&(qs.exports=_n)}.call(this)},147:qs=>{"use strict";qs.exports={i8:"0.0.25"}}},qs=>{qs(qs.s=766)}]);