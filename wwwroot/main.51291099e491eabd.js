(self.webpackChunkmgx=self.webpackChunkmgx||[]).push([[179],{262:(Fs,ec,fh)=>{"use strict";function hn(n){return"function"==typeof n}function B(n){const t=n(i=>{Error.call(i),i.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const Um=B(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function xu(n,e){if(n){const t=n.indexOf(e);0<=t&&n.splice(t,1)}}class jr{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:i}=this;if(hn(i))try{i()}catch(s){e=s instanceof Um?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{ph(s)}catch(o){e=e??[],o instanceof Um?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Um(e)}}add(e){var t;if(e&&e!==this)if(this.closed)ph(e);else{if(e instanceof jr){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&xu(t,e)}remove(e){const{_finalizers:t}=this;t&&xu(t,e),e instanceof jr&&e._removeParent(this)}}jr.EMPTY=(()=>{const n=new jr;return n.closed=!0,n})();const $r=jr.EMPTY;function Iv(n){return n instanceof jr||n&&"closed"in n&&hn(n.remove)&&hn(n.add)&&hn(n.unsubscribe)}function ph(n){hn(n)?n():n.unsubscribe()}const Qa={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},el={setTimeout(n,e,...t){const{delegate:i}=el;return i?.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){const{delegate:e}=el;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Io(n){el.setTimeout(()=>{const{onUnhandledError:e}=Qa;if(!e)throw n;e(n)})}function mh(){}const tc=Ar("C",void 0,void 0);function Ar(n,e,t){return{kind:n,value:e,error:t}}let qr=null;function Mu(n){if(Qa.useDeprecatedSynchronousErrorHandling){const e=!qr;if(e&&(qr={errorThrown:!1,error:null}),n(),e){const{errorThrown:t,error:i}=qr;if(qr=null,t)throw i}}else n()}class da extends jr{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Iv(e)&&e.add(this)):this.destination=hx}static create(e,t,i){return new Po(e,t,i)}next(e){this.isStopped?Bm(function gh(n){return Ar("N",n,void 0)}(e),this):this._next(e)}error(e){this.isStopped?Bm(function nc(n){return Ar("E",void 0,n)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Bm(tc,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const ro=Function.prototype.bind;function ha(n,e){return ro.call(n,e)}class Ro{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){ic(i)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){ic(i)}else ic(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){ic(t)}}}class Po extends da{constructor(e,t,i){let r;if(super(),hn(e)||!e)r={next:e??void 0,error:t??void 0,complete:i??void 0};else{let s;this&&Qa.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&ha(e.next,s),error:e.error&&ha(e.error,s),complete:e.complete&&ha(e.complete,s)}):r=e}this.destination=new Ro(r)}}function ic(n){Qa.useDeprecatedSynchronousErrorHandling?function io(n){Qa.useDeprecatedSynchronousErrorHandling&&qr&&(qr.errorThrown=!0,qr.error=n)}(n):Io(n)}function Bm(n,e){const{onStoppedNotification:t}=Qa;t&&el.setTimeout(()=>t(n,e))}const hx={closed:!0,next:mh,error:function dx(n){throw n},complete:mh},Vm="function"==typeof Symbol&&Symbol.observable||"@@observable";function No(n){return n}function Rv(n){return 0===n.length?No:1===n.length?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}let Sn=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){const i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){const s=function _h(n){return n&&n instanceof da||function px(n){return n&&hn(n.next)&&hn(n.error)&&hn(n.complete)}(n)&&Iv(n)}(t)?t:new Po(t,i,r);return Mu(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return new(i=Lo(i))((r,s)=>{const o=new Po({next:a=>{try{t(a)}catch(l){s(l),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(t){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(t)}[Vm](){return this}pipe(...t){return Rv(t)(this)}toPromise(t){return new(t=Lo(t))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return n.create=e=>new n(e),n})();function Lo(n){var e;return null!==(e=n??Qa.Promise)&&void 0!==e?e:Promise}const so=B(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Xr=(()=>{class n extends Sn{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const i=new Pv(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new so}next(t){Mu(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(t)}})}error(t){Mu(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){Mu(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:i,isStopped:r,observers:s}=this;return i||r?$r:(this.currentObservers=null,s.push(t),new jr(()=>{this.currentObservers=null,xu(s,t)}))}_checkFinalizedStatuses(t){const{hasError:i,thrownError:r,isStopped:s}=this;i?t.error(r):s&&t.complete()}asObservable(){const t=new Sn;return t.source=this,t}}return n.create=(e,t)=>new Pv(e,t),n})();class Pv extends Xr{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===i||i.call(t,e)}error(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===i||i.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,i;return null!==(i=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==i?i:$r}}function Nv(n){return hn(n?.lift)}function Hn(n){return e=>{if(Nv(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function Zn(n,e,t,i,r){return new mx(n,e,t,i,r)}class mx extends da{constructor(e,t,i,r,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(l){e.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function Jt(n,e){return Hn((t,i)=>{let r=0;t.subscribe(Zn(i,s=>{i.next(n.call(e,s,r++))}))})}function oo(n){return this instanceof oo?(this.v=n,this):new oo(n)}function Eh(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=n[Symbol.asyncIterator];return e?e.call(n):(n=function Hm(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(o){return new Promise(function(a,l){!function r(s,o,a,l){Promise.resolve(l).then(function(c){s({value:c,done:a})},o)}(a,l,(o=n[s](o)).done,o.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const kv=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function Uv(n){return hn(n?.then)}function Bv(n){return hn(n[Vm])}function Xm(n){return Symbol.asyncIterator&&hn(n?.[Symbol.asyncIterator])}function Vv(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const Hv=function Sx(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function Sh(n){return hn(n?.[Hv])}function zv(n){return function wh(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=t.apply(n,e||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(p){i[p]&&(r[p]=function(m){return new Promise(function(g,b){s.push([p,m,g,b])>1||a(p,m)})})}function a(p,m){try{!function l(p){p.value instanceof oo?Promise.resolve(p.value.v).then(c,d):h(s[0][2],p)}(i[p](m))}catch(g){h(s[0][3],g)}}function c(p){a("next",p)}function d(p){a("throw",p)}function h(p,m){p(m),s.shift(),s.length&&a(s[0][0],s[0][1])}}(this,arguments,function*(){const t=n.getReader();try{for(;;){const{value:i,done:r}=yield oo(t.read());if(r)return yield oo(void 0);yield yield oo(i)}}finally{t.releaseLock()}})}function xh(n){return hn(n?.getReader)}function Yr(n){if(n instanceof Sn)return n;if(null!=n){if(Bv(n))return function xx(n){return new Sn(e=>{const t=n[Vm]();if(hn(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(kv(n))return function Mx(n){return new Sn(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}(n);if(Uv(n))return function Cx(n){return new Sn(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Io)})}(n);if(Xm(n))return Gv(n);if(Sh(n))return function Tx(n){return new Sn(e=>{for(const t of n)if(e.next(t),e.closed)return;e.complete()})}(n);if(xh(n))return function Ax(n){return Gv(zv(n))}(n)}throw Vv(n)}function Gv(n){return new Sn(e=>{(function Dx(n,e){var t,i,r,s;return function sc(n,e,t,i){return new(t||(t=Promise))(function(s,o){function a(d){try{c(i.next(d))}catch(h){o(h)}}function l(d){try{c(i.throw(d))}catch(h){o(h)}}function c(d){d.done?s(d.value):function r(s){return s instanceof t?s:new t(function(o){o(s)})}(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=Eh(n);!(i=yield t.next()).done;)if(e.next(i.value),e.closed)return}catch(o){r={error:o}}finally{try{i&&!i.done&&(s=t.return)&&(yield s.call(t))}finally{if(r)throw r.error}}e.complete()})})(n,e).catch(t=>e.error(t))})}function ao(n,e,t,i=0,r=!1){const s=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(s),!r)return s}function Zi(n,e,t=1/0){return hn(e)?Zi((i,r)=>Jt((s,o)=>e(i,s,r,o))(Yr(n(i,r))),t):("number"==typeof e&&(t=e),Hn((i,r)=>function Ix(n,e,t,i,r,s,o,a){const l=[];let c=0,d=0,h=!1;const p=()=>{h&&!l.length&&!c&&e.complete()},m=b=>c<i?g(b):l.push(b),g=b=>{s&&e.next(b),c++;let v=!1;Yr(t(b,d++)).subscribe(Zn(e,y=>{r?.(y),s?m(y):e.next(y)},()=>{v=!0},void 0,()=>{if(v)try{for(c--;l.length&&c<i;){const y=l.shift();o?ao(e,o,()=>g(y)):g(y)}p()}catch(y){e.error(y)}}))};return n.subscribe(Zn(e,m,()=>{h=!0,p()})),()=>{a?.()}}(i,r,n,t)))}function lc(n=1/0){return Zi(No,n)}const lo=new Sn(n=>n.complete());function Ym(n){return n[n.length-1]}function Tu(n){return hn(Ym(n))?n.pop():void 0}function Au(n){return function Mh(n){return n&&hn(n.schedule)}(Ym(n))?n.pop():void 0}function Wv(n,e=0){return Hn((t,i)=>{t.subscribe(Zn(i,r=>ao(i,n,()=>i.next(r),e),()=>ao(i,n,()=>i.complete(),e),r=>ao(i,n,()=>i.error(r),e)))})}function Zm(n,e=0){return Hn((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function qv(n,e){if(!n)throw new Error("Iterable cannot be null");return new Sn(t=>{ao(t,e,()=>{const i=n[Symbol.asyncIterator]();ao(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function hi(n,e){return e?function Xv(n,e){if(null!=n){if(Bv(n))return function jv(n,e){return Yr(n).pipe(Zm(e),Wv(e))}(n,e);if(kv(n))return function Nx(n,e){return new Sn(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}(n,e);if(Uv(n))return function $v(n,e){return Yr(n).pipe(Zm(e),Wv(e))}(n,e);if(Xm(n))return qv(n,e);if(Sh(n))return function Lx(n,e){return new Sn(t=>{let i;return ao(t,e,()=>{i=n[Hv](),ao(t,e,()=>{let r,s;try{({value:r,done:s}=i.next())}catch(o){return void t.error(o)}s?t.complete():t.next(r)},0,!0)}),()=>hn(i?.return)&&i.return()})}(n,e);if(xh(n))return function Ox(n,e){return qv(zv(n),e)}(n,e)}throw Vv(n)}(n,e):Yr(n)}class Dr extends Xr{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}}function pt(...n){return hi(n,Au(n))}function Km(n={}){const{connector:e=(()=>new Xr),resetOnError:t=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=n;return s=>{let o,a,l,c=0,d=!1,h=!1;const p=()=>{a?.unsubscribe(),a=void 0},m=()=>{p(),o=l=void 0,d=h=!1},g=()=>{const b=o;m(),b?.unsubscribe()};return Hn((b,v)=>{c++,!h&&!d&&p();const y=l=l??e();v.add(()=>{c--,0===c&&!h&&!d&&(a=cc(g,r))}),y.subscribe(v),!o&&c>0&&(o=new Po({next:w=>y.next(w),error:w=>{h=!0,p(),a=cc(m,t,w),y.error(w)},complete:()=>{d=!0,p(),a=cc(m,i),y.complete()}}),Yr(b).subscribe(o))})(s)}}function cc(n,e,...t){if(!0===e)return void n();if(!1===e)return;const i=new Po({next:()=>{i.unsubscribe(),n()}});return Yr(e(...t)).subscribe(i)}function ys(n,e){return Hn((t,i)=>{let r=null,s=0,o=!1;const a=()=>o&&!r&&i.complete();t.subscribe(Zn(i,l=>{r?.unsubscribe();let c=0;const d=s++;Yr(n(l,d)).subscribe(r=Zn(i,h=>i.next(e?e(l,h,d,c++):h),()=>{r=null,a()}))},()=>{o=!0,a()}))})}function Zv(n,e){return n===e}function cn(n){for(let e in n)if(n[e]===cn)return e;throw Error("Could not find renamed property on target object.")}function uc(n,e){for(const t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function Mi(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(Mi).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function Ch(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const Jm=cn({__forward_ref__:cn});function fn(n){return n.__forward_ref__=fn,n.toString=function(){return Mi(this())},n}function lt(n){return Th(n)?n():n}function Th(n){return"function"==typeof n&&n.hasOwnProperty(Jm)&&n.__forward_ref__===fn}function Ah(n){return n&&!!n.\u0275providers}class se extends Error{constructor(e,t){super(function Du(n,e){return`NG0${Math.abs(n)}${e?": "+e:""}`}(e,t)),this.code=e}}function Et(n){return"string"==typeof n?n:null==n?"":String(n)}function eg(n,e){throw new se(-201,!1)}function vs(n,e){null==n&&function mt(n,e,t,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${t} ${i} ${e} <=Actual]`))}(e,n,null,"!=")}function Ke(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Ci(n){return{providers:n.providers||[],imports:n.imports||[]}}function pa(n){return Dh(n,Ru)||Dh(n,tg)}function Dh(n,e){return n.hasOwnProperty(e)?n[e]:null}function Iu(n){return n&&(n.hasOwnProperty(Ih)||n.hasOwnProperty(e0))?n[Ih]:null}const Ru=cn({\u0275prov:cn}),Ih=cn({\u0275inj:cn}),tg=cn({ngInjectableDef:cn}),e0=cn({ngInjectorDef:cn});var jt=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(jt||{});let yr;function On(n){const e=yr;return yr=n,e}function n0(n,e,t){const i=pa(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&jt.Optional?null:void 0!==e?e:void eg(Mi(n))}const sn=globalThis,Nu={},Ph="__NG_DI_FLAG__",Lu="ngTempTokenPath",lg=/\n/gm,o0="__source";let ma;function ga(n){const e=ma;return ma=n,e}function a0(n,e=jt.Default){if(void 0===ma)throw new se(-203,!1);return null===ma?n0(n,void 0,e):ma.get(n,e&jt.Optional?null:void 0,e)}function Le(n,e=jt.Default){return(function t0(){return yr}()||a0)(lt(n),e)}function Ve(n,e=jt.Default){return Le(n,Ou(e))}function Ou(n){return typeof n>"u"||"number"==typeof n?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Lh(n){const e=[];for(let t=0;t<n.length;t++){const i=lt(n[t]);if(Array.isArray(i)){if(0===i.length)throw new se(900,!1);let r,s=jt.Default;for(let o=0;o<i.length;o++){const a=i[o],l=Gx(a);"number"==typeof l?-1===l?r=a.token:s|=l:r=a}e.push(Le(r,s))}else e.push(Le(i))}return e}function Fu(n,e){return n[Ph]=e,n.prototype[Ph]=e,n}function Gx(n){return n[Ph]}function Oo(n){return{toString:n}.toString()}var Fo=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(Fo||{}),ws=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(ws||{});const uo={},nn=[],ku=cn({\u0275cmp:cn}),ho=cn({\u0275dir:cn}),dc=cn({\u0275pipe:cn}),l0=cn({\u0275mod:cn}),ko=cn({\u0275fac:cn}),Uu=cn({__NG_ELEMENT_ID__:cn}),rl=cn({__NG_ENV_ID__:cn});function Es(n,e,t){let i=n.length;for(;;){const r=n.indexOf(e,t);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const s=e.length;if(r+s===i||n.charCodeAt(r+s)<=32)return r}t=r+1}}function Oh(n,e,t){let i=0;for(;i<t.length;){const r=t[i];if("number"==typeof r){if(0!==r)break;i++;const s=t[i++],o=t[i++],a=t[i++];n.setAttribute(e,o,a,s)}else{const s=r,o=t[++i];u0(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),i++}}return i}function c0(n){return 3===n||4===n||6===n}function u0(n){return 64===n.charCodeAt(0)}function Bu(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?t=r:0===t||d0(n,t,r,null,-1===t||2===t?e[++i]:null)}}return n}function d0(n,e,t,i,r){let s=0,o=n.length;if(-1===e)o=-1;else for(;s<n.length;){const a=n[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<n.length;){const a=n[s];if("number"==typeof a)break;if(a===t){if(null===i)return void(null!==r&&(n[s+1]=r));if(i===n[s+1])return void(n[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),null!==i&&n.splice(s++,0,i),null!==r&&n.splice(s++,0,r)}const h0="ng-template";function Fh(n,e,t){let i=0,r=!0;for(;i<n.length;){let s=n[i++];if("string"==typeof s&&r){const o=n[i++];if(t&&"class"===s&&-1!==Es(o.toLowerCase(),e,0))return!0}else{if(1===s){for(;i<n.length&&"string"==typeof(s=n[i++]);)if(s.toLowerCase()===e)return!0;return!1}"number"==typeof s&&(r=!1)}}return!1}function Y(n){return 4===n.type&&n.value!==h0}function ue(n,e,t){return e===(4!==n.type||t?n.value:h0)}function ie(n,e,t){let i=4;const r=n.attrs||[],s=function xn(n){for(let e=0;e<n.length;e++)if(c0(n[e]))return e;return n.length}(r);let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&i){if(i=2|1&i,""!==l&&!ue(n,l,t)||""===l&&1===e.length){if(ke(i))return!1;o=!0}}else{const c=8&i?l:e[++a];if(8&i&&null!==n.attrs){if(!Fh(n.attrs,c,t)){if(ke(i))return!1;o=!0}continue}const h=Ct(8&i?"class":l,r,Y(n),t);if(-1===h){if(ke(i))return!1;o=!0;continue}if(""!==c){let p;p=h>s?"":r[h+1].toLowerCase();const m=8&i?p:null;if(m&&-1!==Es(m,c,0)||2&i&&c!==p){if(ke(i))return!1;o=!0}}}}else{if(!o&&!ke(i)&&!ke(l))return!1;if(o&&ke(l))continue;o=!1,i=l|1&i}}return ke(i)||o}function ke(n){return 0==(1&n)}function Ct(n,e,t,i){if(null===e)return-1;let r=0;if(i||!t){let s=!1;for(;r<e.length;){const o=e[r];if(o===n)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function ug(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const i=n[t];if("number"==typeof i)return-1;if(i===e)return t;t++}return-1}(e,n)}function ln(n,e,t=!1){for(let i=0;i<e.length;i++)if(ie(n,e[i],t))return!0;return!1}function $x(n,e){e:for(let t=0;t<e.length;t++){const i=e[t];if(n.length===i.length){for(let r=0;r<n.length;r++)if(n[r]!==i[r])continue e;return!0}}return!1}function Kr(n,e){return n?":not("+e.trim()+")":e}function kh(n){let e=n[0],t=1,i=2,r="",s=!1;for(;t<n.length;){let o=n[t];if("string"==typeof o)if(2&i){const a=n[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!ke(o)&&(e+=Kr(s,r),r=""),i=o,s=s||!ke(i);t++}return""!==r&&(e+=Kr(s,r)),e}function Ki(n){return Oo(()=>{const e=dg(n),t={...e,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===Fo.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||ws.Emulated,styles:n.styles||nn,_:null,schemas:n.schemas||null,tView:null,id:""};hg(t);const i=n.dependencies;return t.directiveDefs=ol(i,!1),t.pipeDefs=ol(i,!0),t.id=function Vu(n){let e=0;const t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(const r of t)e=Math.imul(31,e)+r.charCodeAt(0)<<0;return e+=2147483648,"c"+e}(t),t})}function pn(n){return Yt(n)||zn(n)}function Xx(n){return null!==n}function Fi(n){return Oo(()=>({type:n.type,bootstrap:n.bootstrap||nn,declarations:n.declarations||nn,imports:n.imports||nn,exports:n.exports||nn,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function f0(n,e){if(null==n)return uo;const t={};for(const i in n)if(n.hasOwnProperty(i)){let r=n[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),t[r]=i,e&&(e[r]=s)}return t}function ft(n){return Oo(()=>{const e=dg(n);return hg(e),e})}function Yt(n){return n[ku]||null}function zn(n){return n[ho]||null}function ki(n){return n[dc]||null}function ar(n,e){const t=n[l0]||null;if(!t&&!0===e)throw new Error(`Type ${Mi(n)} does not have '\u0275mod' property.`);return t}function dg(n){const e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||uo,exportAs:n.exportAs||null,standalone:!0===n.standalone,signals:!0===n.signals,selectors:n.selectors||nn,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:f0(n.inputs,e),outputs:f0(n.outputs)}}function hg(n){n.features?.forEach(e=>e(n))}function ol(n,e){if(!n)return null;const t=e?ki:pn;return()=>("function"==typeof n?n():n).map(i=>t(i)).filter(Xx)}const vn=0,Ue=1,It=2,Gn=3,Bs=4,_a=5,Ai=6,ya=7,li=8,Uo=9,fc=10,xt=11,Kn=12,Ji=13,pc=14,ci=15,mc=16,gc=17,Ss=18,Bo=19,Vh=20,Jr=21,Qr=22,Vo=23,va=24,Ft=25,fg=1,m0=2,fo=7,Ho=9,Ui=11;function Di(n){return Array.isArray(n)&&"object"==typeof n[fg]}function Bi(n){return Array.isArray(n)&&!0===n[fg]}function Rr(n){return 0!=(4&n.flags)}function kt(n){return n.componentOffset>-1}function zh(n){return 1==(1&n.flags)}function Vs(n){return!!n.template}function pg(n){return 0!=(512&n[It])}function ll(n,e){return n.hasOwnProperty(ko)?n[ko]:null}let Qi=null,Hu=!1;function es(n){const e=Qi;return Qi=n,e}const _0={version:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{}};function Gh(n){if(!zu(n)||n.dirty){if(!n.producerMustRecompute(n)&&!mo(n))return void(n.dirty=!1);n.producerRecomputeValue(n),n.dirty=!1}}function v0(n){n.dirty=!0,function _c(n){if(void 0===n.liveConsumerNode)return;const e=Hu;Hu=!0;try{for(const t of n.liveConsumerNode)t.dirty||v0(t)}finally{Hu=e}}(n),n.consumerMarkedDirty?.(n)}function Wh(n){return n&&(n.nextProducerIndex=0),es(n)}function mg(n,e){if(es(e),n&&void 0!==n.producerNode&&void 0!==n.producerIndexOfThis&&void 0!==n.producerLastReadVersion){if(zu(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)vr(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function mo(n){cl(n);for(let e=0;e<n.producerNode.length;e++){const t=n.producerNode[e],i=n.producerLastReadVersion[e];if(i!==t.version||(Gh(t),i!==t.version))return!0}return!1}function jh(n){if(cl(n),zu(n))for(let e=0;e<n.producerNode.length;e++)vr(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function vr(n,e){if(function gg(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}(n),cl(n),1===n.liveConsumerNode.length)for(let i=0;i<n.producerNode.length;i++)vr(n.producerNode[i],n.producerIndexOfThis[i]);const t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){const i=n.liveConsumerIndexOfThis[e],r=n.liveConsumerNode[e];cl(r),r.producerIndexOfThis[i]=e}}function zu(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function cl(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}let _g=null;const Zh=()=>{},nM=(()=>({..._0,consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:n=>{n.schedule(n.ref)},hasRun:!1,cleanupFn:Zh}))();class E0{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function Vi(){return S0}function S0(n){return n.type.prototype.ngOnChanges&&(n.setInput=iM),Gu}function Gu(){const n=Jh(this),e=n?.current;if(e){const t=n.previous;if(t===uo)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function iM(n,e,t,i){const r=this.declaredInputs[t],s=Jh(n)||function M0(n,e){return n[x0]=e}(n,{previous:uo,current:null}),o=s.current||(s.current={}),a=s.previous,l=a[r];o[r]=new E0(l&&l.currentValue,e,a===uo),n[i]=e}Vi.ngInherit=!0;const x0="__ngSimpleChanges__";function Jh(n){return n[x0]||null}const go=function(n,e,t){};function An(n){for(;Array.isArray(n);)n=n[vn];return n}function ju(n,e){return An(e[n])}function wr(n,e){return An(e[n.index])}function $u(n,e){return n.data[e]}function Pr(n,e){const t=e[n];return Di(t)?t:t[vn]}function Ca(n,e){return null==e?null:n[e]}function ef(n){n[gc]=0}function D0(n){1024&n[It]||(n[It]|=1024,I0(n,1))}function tf(n){1024&n[It]&&(n[It]&=-1025,I0(n,-1))}function I0(n,e){let t=n[Gn];if(null===t)return;t[_a]+=e;let i=t;for(t=t[Gn];null!==t&&(1===e&&1===i[_a]||-1===e&&0===i[_a]);)t[_a]+=e,i=t,t=t[Gn]}const gt={lFrame:Ag(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function ts(){return gt.bindingsEnabled}function bc(){return null!==gt.skipHydrationRootTNode}function ge(){return gt.lFrame.lView}function Kt(){return gt.lFrame.tView}function is(n){return gt.lFrame.contextLView=n,n[li]}function Er(n){return gt.lFrame.contextLView=null,n}function Hi(){let n=af();for(;null!==n&&64===n.type;)n=n.parent;return n}function af(){return gt.lFrame.currentTNode}function xs(n,e){const t=gt.lFrame;t.currentTNode=n,t.isParent=e}function qu(){return gt.lFrame.isParent}function _o(){gt.lFrame.isParent=!1}function lr(){const n=gt.lFrame;let e=n.bindingRootIndex;return-1===e&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function Ec(){return gt.lFrame.bindingIndex++}function Wo(n){const e=gt.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function cM(n,e){const t=gt.lFrame;t.bindingIndex=t.bindingRootIndex=n,lf(e)}function lf(n){gt.lFrame.currentDirectiveIndex=n}function zs(){return gt.lFrame.currentQueryIndex}function Cg(n){gt.lFrame.currentQueryIndex=n}function uM(n){const e=n[Ue];return 2===e.type?e.declTNode:1===e.type?n[Ai]:null}function Xu(n,e,t){if(t&jt.SkipSelf){let r=e,s=n;for(;!(r=r.parent,null!==r||t&jt.Host||(r=uM(s),null===r||(s=s[pc],10&r.type))););if(null===r)return!1;e=r,n=s}const i=gt.lFrame=Tg();return i.currentTNode=e,i.lView=n,!0}function Ta(n){const e=Tg(),t=n[Ue];gt.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function Tg(){const n=gt.lFrame,e=null===n?null:n.child;return null===e?Ag(n):e}function Ag(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function U0(){const n=gt.lFrame;return gt.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const Dg=U0;function Aa(){const n=U0();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function ur(){return gt.lFrame.selectedIndex}function Da(n){gt.lFrame.selectedIndex=n}function Dn(){const n=gt.lFrame;return $u(n.tView,n.selectedIndex)}function cf(){gt.lFrame.currentNamespace="svg"}let Rg=!0;function hl(){return Rg}function jo(n){Rg=n}function hf(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){const s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:d}=s;o&&(n.contentHooks??=[]).push(-t,o),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),l&&(n.viewHooks??=[]).push(-t,l),c&&((n.viewHooks??=[]).push(t,c),(n.viewCheckHooks??=[]).push(t,c)),null!=d&&(n.destroyHooks??=[]).push(t,d)}}function Zu(n,e,t){Ng(n,e,3,t)}function Ms(n,e,t,i){(3&n[It])===t&&Ng(n,e,t,i)}function ff(n,e){let t=n[It];(3&t)===e&&(t&=8191,t+=1,n[It]=t)}function Ng(n,e,t,i){const s=i??-1,o=e.length-1;let a=0;for(let l=void 0!==i?65535&n[gc]:0;l<o;l++)if("number"==typeof e[l+1]){if(a=e[l],null!=i&&a>=i)break}else e[l]<0&&(n[gc]+=65536),(a<s||-1==s)&&(H0(n,t,e,l),n[gc]=(4294901760&n[gc])+l+2),l++}function V0(n,e){go(4,n,e);const t=es(null);try{e.call(n)}finally{es(t),go(5,n,e)}}function H0(n,e,t,i){const r=t[i]<0,s=t[i+1],a=n[r?-t[i]:t[i]];r?n[It]>>13<n[gc]>>16&&(3&n[It])===e&&(n[It]+=8192,V0(a,s)):V0(a,s)}const Sc=-1;class Ku{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function Qu(n){return n!==Sc}function Gs(n){return 32767&n}function fl(n,e){let t=function hM(n){return n>>16}(n),i=e;for(;t>0;)i=i[pc],t--;return i}let mf=!0;function Ri(n){const e=mf;return mf=n,e}const W0=255,Og=5;let fM=0;const Ws={};function gf(n,e){const t=yo(n,e);if(-1!==t)return t;const i=e[Ue];i.firstCreatePass&&(n.injectorIndex=e.length,Fg(i.data,n),Fg(e,null),Fg(i.blueprint,null));const r=zi(n,e),s=n.injectorIndex;if(Qu(r)){const o=Gs(r),a=fl(r,e),l=a[Ue].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|l[o+c]}return e[s+8]=r,s}function Fg(n,e){n.push(0,0,0,0,0,0,0,0,e)}function yo(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function zi(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;null!==r;){if(i=Bg(r),null===i)return Sc;if(t++,r=r[pc],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return Sc}function ed(n,e,t){!function pM(n,e,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(Uu)&&(i=t[Uu]),null==i&&(i=t[Uu]=fM++);const r=i&W0;e.data[n+(r>>Og)]|=1<<r}(n,e,t)}function _f(n,e,t){if(t&jt.Optional||void 0!==n)return n;eg()}function j0(n,e,t,i){if(t&jt.Optional&&void 0===i&&(i=null),!(t&(jt.Self|jt.Host))){const r=n[Uo],s=On(void 0);try{return r?r.get(e,i,t&jt.Optional):n0(e,i,t&jt.Optional)}finally{On(s)}}return _f(i,0,t)}function $0(n,e,t,i=jt.Default,r){if(null!==n){if(2048&e[It]&&!(i&jt.Self)){const o=function Ug(n,e,t,i,r){let s=n,o=e;for(;null!==s&&null!==o&&2048&o[It]&&!(512&o[It]);){const a=Mc(s,o,t,i|jt.Self,Ws);if(a!==Ws)return a;let l=s.parent;if(!l){const c=o[Vh];if(c){const d=c.get(t,Ws,i);if(d!==Ws)return d}l=Bg(o),o=o[pc]}s=l}return r}(n,e,t,i,Ws);if(o!==Ws)return o}const s=Mc(n,e,t,i,Ws);if(s!==Ws)return s}return j0(e,t,i,r)}function Mc(n,e,t,i,r){const s=function gM(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(Uu)?n[Uu]:void 0;return"number"==typeof e?e>=0?e&W0:kg:e}(t);if("function"==typeof s){if(!Xu(e,n,i))return i&jt.Host?_f(r,0,i):j0(e,t,i,r);try{let o;if(o=s(i),null!=o||i&jt.Optional)return o;eg()}finally{Dg()}}else if("number"==typeof s){let o=null,a=yo(n,e),l=Sc,c=i&jt.Host?e[ci][Ai]:null;for((-1===a||i&jt.SkipSelf)&&(l=-1===a?zi(n,e):e[a+8],l!==Sc&&Y0(i,!1)?(o=e[Ue],a=Gs(l),e=fl(l,e)):a=-1);-1!==a;){const d=e[Ue];if(X0(s,a,d.data)){const h=q0(a,e,t,o,i,c);if(h!==Ws)return h}l=e[a+8],l!==Sc&&Y0(i,e[Ue].data[a+8]===c)&&X0(s,a,e)?(o=d,a=Gs(l),e=fl(l,e)):a=-1}}return r}function q0(n,e,t,i,r,s){const o=e[Ue],a=o.data[n+8],d=td(a,o,t,null==i?kt(a)&&mf:i!=o&&0!=(3&a.type),r&jt.Host&&s===a);return null!==d?pl(e,o,d,a):Ws}function td(n,e,t,i,r){const s=n.providerIndexes,o=e.data,a=1048575&s,l=n.directiveStart,d=s>>20,p=r?a+d:n.directiveEnd;for(let m=i?a:a+d;m<p;m++){const g=o[m];if(m<l&&t===g||m>=l&&g.type===t)return m}if(r){const m=o[l];if(m&&Vs(m)&&m.type===t)return l}return null}function pl(n,e,t,i){let r=n[t];const s=e.data;if(function $o(n){return n instanceof Ku}(r)){const o=r;o.resolving&&function kx(n,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new se(-200,`Circular dependency in DI detected for ${n}${t}`)}(function un(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():Et(n)}(s[t]));const a=Ri(o.canSeeViewProviders);o.resolving=!0;const c=o.injectImpl?On(o.injectImpl):null;Xu(n,i,jt.Default);try{r=n[t]=o.factory(void 0,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&function Pg(n,e,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const o=S0(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}r&&(t.preOrderHooks??=[]).push(0-n,r),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}(t,s[t],e)}finally{null!==c&&On(c),Ri(a),o.resolving=!1,Dg()}}return r}function X0(n,e,t){return!!(t[e+(n>>Og)]&1<<n)}function Y0(n,e){return!(n&jt.Self||n&jt.Host&&e)}class Sr{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return $0(this._tNode,this._lView,e,Ou(i),t)}}function kg(){return new Sr(Hi(),ge())}function fi(n){return Oo(()=>{const e=n.prototype.constructor,t=e[ko]||ml(e),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const s=r[ko]||ml(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function ml(n){return Th(n)?()=>{const e=ml(lt(n));return e&&e()}:ll(n)}function Bg(n){const e=n[Ue],t=e.type;return 2===t?e.declTNode:1===t?n[Ai]:null}const gl="__parameters__";function _l(n,e,t){return Oo(()=>{const i=function Vg(n){return function(...t){if(n){const i=n(...t);for(const r in i)this[r]=i[r]}}}(e);function r(...s){if(this instanceof r)return i.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(l,c,d){const h=l.hasOwnProperty(gl)?l[gl]:Object.defineProperty(l,gl,{value:[]})[gl];for(;h.length<=d;)h.push(null);return(h[d]=h[d]||[]).push(o),l}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}function Dc(n,e){n.forEach(t=>Array.isArray(t)?Dc(t,e):e(t))}function Hg(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function yf(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function id(n,e){const t=[];for(let i=0;i<n;i++)t.push(e);return t}function Wn(n,e,t){let i=Ic(n,e);return i>=0?n[1|i]=t:(i=~i,function EM(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(1===r)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;)n[r]=n[r-2],r--;n[e]=t,n[e+1]=i}}(n,i,e,t)),i}function zg(n,e){const t=Ic(n,e);if(t>=0)return n[1|t]}function Ic(n,e){return function Gg(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){const s=i+(r-i>>1),o=n[s<<t];if(e===o)return s<<t;o>e?r=s:i=s+1}return~(r<<t)}(n,e,1)}const bf=Fu(_l("Optional"),8),wf=Fu(_l("SkipSelf"),4);function Tf(n){return 128==(128&n.flags)}var Ra=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(Ra||{});const HM=/^>|^->|<!--|-->|--!>|<!-$/g,Df=/(<|>)/g,zM="\u200b$1\u200b";const Kg=new Map;let GM=0;const Qg="__ngContext__";function er(n,e){Di(e)?(n[Qg]=e[Bo],function jM(n){Kg.set(n[Bo],n)}(e)):n[Qg]=e}let n_;function i_(n,e){return n_(n,e)}function Lc(n){const e=n[Gn];return Bi(e)?e[Gn]:e}function mb(n){return _b(n[Kn])}function gb(n){return _b(n[Bs])}function _b(n){for(;null!==n&&!Bi(n);)n=n[Bs];return n}function Oc(n,e,t,i,r){if(null!=i){let s,o=!1;Bi(i)?s=i:Di(i)&&(o=!0,i=i[vn]);const a=An(i);0===n&&null!==t?null==r?bb(e,t,a):vl(e,t,a,r||null,!0):1===n&&null!==t?vl(e,t,a,r||null,!0):2===n?function Uf(n,e,t){const i=Ts(n,e);i&&function a_(n,e,t,i){n.removeChild(e,t,i)}(n,i,e,t)}(e,a,o):3===n&&e.destroyNode(a),null!=s&&function Bf(n,e,t,i,r){const s=t[fo];s!==An(t)&&Oc(e,n,i,s,r);for(let a=Ui;a<t.length;a++){const l=t[a];wl(l[Ue],l,n,e,i,s)}}(e,n,s,t,r)}}function s_(n,e){return n.createComment(function cb(n){return n.replace(HM,e=>e.replace(Df,zM))}(e))}function Lf(n,e,t){return n.createElement(e,t)}function Tt(n,e){const t=n[Ho],i=t.indexOf(e);tf(e),t.splice(i,1)}function Of(n,e){if(n.length<=Ui)return;const t=Ui+e,i=n[t];if(i){const r=i[mc];null!==r&&r!==n&&Tt(r,i),e>0&&(n[t-1][Bs]=i[Bs]);const s=yf(n,Ui+e);!function KM(n,e){wl(n,e,e[xt],2,null,null),e[vn]=null,e[Ai]=null}(i[Ue],i);const o=s[Ss];null!==o&&o.detachView(s[Ue]),i[Gn]=null,i[Bs]=null,i[It]&=-129}return i}function dr(n,e){if(!(256&e[It])){const t=e[xt];e[Vo]&&jh(e[Vo]),e[va]&&jh(e[va]),t.destroyNode&&wl(n,e,t,3,null,null),function QM(n){let e=n[Kn];if(!e)return Jn(n[Ue],n);for(;e;){let t=null;if(Di(e))t=e[Kn];else{const i=e[Ui];i&&(t=i)}if(!t){for(;e&&!e[Bs]&&e!==n;)Di(e)&&Jn(e[Ue],e),e=e[Gn];null===e&&(e=n),Di(e)&&Jn(e[Ue],e),t=e&&e[Bs]}e=t}}(e)}}function Jn(n,e){if(!(256&e[It])){e[It]&=-129,e[It]|=256,function Pa(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let i=0;i<t.length;i+=2){const r=e[t[i]];if(!(r instanceof Ku)){const s=t[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],l=s[o+1];go(4,a,l);try{l.call(a)}finally{go(5,a,l)}}else{go(4,r,s);try{s.call(r)}finally{go(5,r,s)}}}}}(n,e),function tC(n,e){const t=n.cleanup,i=e[ya];if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+3];o>=0?i[o]():i[-o].unsubscribe(),s+=2}else t[s].call(i[t[s+1]]);null!==i&&(e[ya]=null);const r=e[Jr];if(null!==r){e[Jr]=null;for(let s=0;s<r.length;s++)(0,r[s])()}}(n,e),1===e[Ue].type&&e[xt].destroy();const t=e[mc];if(null!==t&&Bi(e[Gn])){t!==e[Gn]&&Tt(t,e);const i=e[Ss];null!==i&&i.detachView(n)}!function $M(n){Kg.delete(n[Bo])}(e)}}function o_(n,e,t){return function vb(n,e,t){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return t[vn];{const{componentOffset:r}=i;if(r>-1){const{encapsulation:s}=n.data[i.directiveStart+r];if(s===ws.None||s===ws.Emulated)return null}return wr(i,t)}}(n,e.parent,t)}function vl(n,e,t,i,r){n.insertBefore(e,t,i,r)}function bb(n,e,t){n.appendChild(e,t)}function wb(n,e,t,i,r){null!==i?vl(n,e,t,i,r):bb(n,e,t)}function Ts(n,e){return n.parentNode(e)}function od(n,e,t){return Qn(n,e,t)}let Ff,Lr,Qn=function jn(n,e,t){return 40&n.type?wr(n,t):null};function kf(n,e,t,i){const r=o_(n,i,e),s=e[xt],a=od(i.parent||e[Ai],i,e);if(null!=r)if(Array.isArray(t))for(let l=0;l<t.length;l++)wb(s,r,t[l],a,!1);else wb(s,r,t,a,!1);void 0!==Ff&&Ff(s,i,e,t,r)}function ad(n,e){if(null!==e){const t=e.type;if(3&t)return wr(e,n);if(4&t)return l_(-1,n[e.index]);if(8&t){const i=e.child;if(null!==i)return ad(n,i);{const r=n[e.index];return Bi(r)?l_(-1,r):An(r)}}if(32&t)return i_(e,n)()||An(n[e.index]);{const i=xb(n,e);return null!==i?Array.isArray(i)?i[0]:ad(Lc(n[ci]),i):ad(n,e.next)}}return null}function xb(n,e){return null!==e?n[ci][Ai].projection[e.projection]:null}function l_(n,e){const t=Ui+n+1;if(t<e.length){const i=e[t],r=i[Ue].firstChild;if(null!==r)return ad(i,r)}return e[fo]}function bl(n,e,t,i,r,s,o){for(;null!=t;){const a=i[t.index],l=t.type;if(o&&0===e&&(a&&er(An(a),i),t.flags|=2),32!=(32&t.flags))if(8&l)bl(n,e,t.child,i,r,s,!1),Oc(e,n,r,a,s);else if(32&l){const c=i_(t,i);let d;for(;d=c();)Oc(e,n,r,d,s);Oc(e,n,r,a,s)}else 16&l?u_(n,e,i,t,r,s):Oc(e,n,r,a,s);t=o?t.projectionNext:t.next}}function wl(n,e,t,i,r,s){bl(t,i,n.firstChild,e,r,s,!1)}function u_(n,e,t,i,r,s){const o=t[ci],l=o[Ai].projection[i.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++)Oc(e,n,r,l[c],s);else{let c=l;const d=o[Gn];Tf(i)&&(c.flags|=128),bl(n,e,c,d,r,s,!0)}}function Mb(n,e,t){""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function Cb(n,e,t){const{mergedAttrs:i,classes:r,styles:s}=t;null!==i&&Oh(n,e,i),null!==r&&Mb(n,e,r),null!==s&&function Fc(n,e,t){n.setAttribute(e,"style",t)}(n,e,s)}class Rb{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}function Na(n){return n instanceof Rb?n.changingThisBreaksApplicationSecurity:n}class qe{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=Ke({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const hd=new qe("ENVIRONMENT_INITIALIZER"),Vb=new qe("INJECTOR",-1),Hb=new qe("INJECTOR_DEF_TYPES");class v_{get(e,t=Nu){if(t===Nu){const i=new Error(`NullInjectorError: No provider for ${Mi(e)}!`);throw i.name="NullInjectorError",i}return t}}function xC(...n){return{\u0275providers:zb(0,n),\u0275fromNgModule:!0}}function zb(n,...e){const t=[],i=new Set;let r;const s=o=>{t.push(o)};return Dc(e,o=>{const a=o;Gf(a,s,[],i)&&(r||=[],r.push(a))}),void 0!==r&&Gb(r,s),t}function Gb(n,e){for(let t=0;t<n.length;t++){const{ngModule:i,providers:r}=n[t];w_(r,s=>{e(s,i)})}}function Gf(n,e,t,i){if(!(n=lt(n)))return!1;let r=null,s=Iu(n);const o=!s&&Yt(n);if(s||o){if(o&&!o.standalone)return!1;r=n}else{const l=n.ngModule;if(s=Iu(l),!s)return!1;r=l}const a=i.has(r);if(o){if(a)return!1;if(i.add(r),o.dependencies){const l="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const c of l)Gf(c,e,t,i)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let c;i.add(r);try{Dc(s.imports,d=>{Gf(d,e,t,i)&&(c||=[],c.push(d))})}finally{}void 0!==c&&Gb(c,e)}if(!a){const c=ll(r)||(()=>new r);e({provide:r,useFactory:c,deps:nn},r),e({provide:Hb,useValue:r,multi:!0},r),e({provide:hd,useValue:()=>Le(r),multi:!0},r)}const l=s.providers;if(null!=l&&!a){const c=n;w_(l,d=>{e(d,c)})}}}return r!==n&&void 0!==n.providers}function w_(n,e){for(let t of n)Ah(t)&&(t=t.\u0275providers),Array.isArray(t)?w_(t,e):e(t)}const MC=cn({provide:String,useValue:cn});function E_(n){return null!==n&&"object"==typeof n&&MC in n}function La(n){return"function"==typeof n}const S_=new qe("Set Injector scope."),jf={},CC={};let fd;function $f(){return void 0===fd&&(fd=new v_),fd}class ss{}class qf extends ss{get destroyed(){return this._destroyed}constructor(e,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,pd(e,o=>this.processProvider(o)),this.records.set(Vb,Vc(void 0,this)),r.has("environment")&&this.records.set(ss,Vc(void 0,this));const s=this.records.get(S_);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(Hb.multi,nn,jt.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();const e=this._onDestroyHooks;this._onDestroyHooks=[];for(const t of e)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();const t=ga(this),i=On(void 0);try{return e()}finally{ga(t),On(i)}}get(e,t=Nu,i=jt.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(rl))return e[rl](this);i=Ou(i);const s=ga(this),o=On(void 0);try{if(!(i&jt.SkipSelf)){let l=this.records.get(e);if(void 0===l){const c=function DC(n){return"function"==typeof n||"object"==typeof n&&n instanceof qe}(e)&&pa(e);l=c&&this.injectableDefInScope(c)?Vc(fr(e),jf):null,this.records.set(e,l)}if(null!=l)return this.hydrate(e,l)}return(i&jt.Self?$f():this.parent).get(e,t=i&jt.Optional&&t===Nu?null:t)}catch(a){if("NullInjectorError"===a.name){if((a[Lu]=a[Lu]||[]).unshift(Mi(e)),s)throw a;return function Wx(n,e,t,i){const r=n[Lu];throw e[o0]&&r.unshift(e[o0]),n.message=function jx(n,e,t,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let r=Mi(e);if(Array.isArray(e))r=e.map(Mi).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):Mi(a)))}r=`{${s.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${n.replace(lg,"\n  ")}`}("\n"+n.message,r,t,i),n.ngTokenPath=r,n[Lu]=null,n}(a,e,"R3InjectorError",this.source)}throw a}finally{On(o),ga(s)}}resolveInjectorInitializers(){const e=ga(this),t=On(void 0);try{const r=this.get(hd.multi,nn,jt.Self);for(const s of r)s()}finally{ga(e),On(t)}}toString(){const e=[],t=this.records;for(const i of t.keys())e.push(Mi(i));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new se(205,!1)}processProvider(e){let t=La(e=lt(e))?e:lt(e&&e.provide);const i=function TC(n){return E_(n)?Vc(void 0,n.useValue):Vc($b(n),jf)}(e);if(La(e)||!0!==e.multi)this.records.get(t);else{let r=this.records.get(t);r||(r=Vc(void 0,jf,!0),r.factory=()=>Lh(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,i)}hydrate(e,t){return t.value===jf&&(t.value=CC,t.value=t.factory()),"object"==typeof t.value&&t.value&&function M_(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=lt(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){const t=this._onDestroyHooks.indexOf(e);-1!==t&&this._onDestroyHooks.splice(t,1)}}function fr(n){const e=pa(n),t=null!==e?e.factory:ll(n);if(null!==t)return t;if(n instanceof qe)throw new se(204,!1);if(n instanceof Function)return function x_(n){const e=n.length;if(e>0)throw id(e,"?"),new se(204,!1);const t=function bs(n){return n&&(n[Ru]||n[tg])||null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new se(204,!1)}function $b(n,e,t){let i;if(La(n)){const r=lt(n);return ll(r)||fr(r)}if(E_(n))i=()=>lt(n.useValue);else if(function Wf(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...Lh(n.deps||[]));else if(function Wb(n){return!(!n||!n.useExisting)}(n))i=()=>Le(lt(n.useExisting));else{const r=lt(n&&(n.useClass||n.provide));if(!function AC(n){return!!n.deps}(n))return ll(r)||fr(r);i=()=>new r(...Lh(n.deps))}return i}function Vc(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function pd(n,e){for(const t of n)Array.isArray(t)?pd(t,e):t&&Ah(t)?pd(t.\u0275providers,e):e(t)}const Xf=new qe("AppId",{providedIn:"root",factory:()=>IC}),IC="ng",qb=new qe("Platform Initializer"),Oa=new qe("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),Xb=new qe("AnimationModuleType"),Yb=new qe("CSP nonce",{providedIn:"root",factory:()=>function Uc(){if(void 0!==Lr)return Lr;if(typeof document<"u")return document;throw new se(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let Jb=(n,e,t)=>null;function N_(n,e,t=!1){return Jb(n,e,t)}class be{}class Be{}class dt{resolveComponentFactory(e){throw function tt(n){const e=Error(`No component factory found for ${Mi(n)}.`);return e.ngComponent=n,e}(e)}}let Vt=(()=>{class n{static#e=this.NULL=new dt}return n})();function Qt(){return Wi(Hi(),ge())}function Wi(n,e){return new bn(wr(n,e))}let bn=(()=>{class n{constructor(t){this.nativeElement=t}static#e=this.__NG_ELEMENT_ID__=Qt}return n})();function os(n){return n instanceof bn?n.nativeElement:n}class Fn{}let mi=(()=>{class n{constructor(){this.destroyNode=null}static#e=this.__NG_ELEMENT_ID__=()=>function Zo(){const n=ge(),t=Pr(Hi().index,n);return(Di(t)?t:n)[xt]}()}return n})(),Qb=(()=>{class n{static#e=this.\u0275prov=Ke({token:n,providedIn:"root",factory:()=>null})}return n})();class L_{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const Az=new L_("16.2.9"),kC={};function bP(n,e=null,t=null,i){const r=wP(n,e,t,i);return r.resolveInjectorInitializers(),r}function wP(n,e=null,t=null,i,r=new Set){const s=[t||nn,xC(n)];return i=i||("object"==typeof n?void 0:Mi(n)),new qf(s,e||$f(),i||null,r)}let $s=(()=>{class n{static#e=this.THROW_IF_NOT_FOUND=Nu;static#t=this.NULL=new v_;static create(t,i){if(Array.isArray(t))return bP({name:""},i,t,"");{const r=t.name??"";return bP({name:r},t.parent,t.providers,r)}}static#n=this.\u0275prov=Ke({token:n,providedIn:"any",factory:()=>Le(Vb)});static#i=this.__NG_ELEMENT_ID__=-1}return n})();function BC(n){return n.ngOriginalError}class Sl{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&BC(e);for(;t&&BC(t);)t=BC(t);return t||null}}function HC(n){return e=>{setTimeout(n,void 0,e)}}const $n=class Oz extends Xr{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,i){let r=e,s=t||(()=>null),o=i;if(e&&"object"==typeof e){const l=e;r=l.next?.bind(l),s=l.error?.bind(l),o=l.complete?.bind(l)}this.__isAsync&&(s=HC(s),r&&(r=HC(r)),o&&(o=HC(o)));const a=super.subscribe({next:r,error:s,complete:o});return e instanceof jr&&e.add(a),a}};function SP(...n){}class Mn{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new $n(!1),this.onMicrotaskEmpty=new $n(!1),this.onStable=new $n(!1),this.onError=new $n(!1),typeof Zone>"u")throw new se(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&t,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function Fz(){const n="function"==typeof sn.requestAnimationFrame;let e=sn[n?"requestAnimationFrame":"setTimeout"],t=sn[n?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&t){const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i);const r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function Bz(n){const e=()=>{!function Uz(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(sn,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,GC(n),n.isCheckStableRunning=!0,zC(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),GC(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,r,s,o,a)=>{if(function Hz(n){return!(!Array.isArray(n)||1!==n.length)&&!0===n[0].data?.__ignore_ng_zone__}(a))return t.invokeTask(r,s,o,a);try{return xP(n),t.invokeTask(r,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||n.shouldCoalesceRunChangeDetection)&&e(),MP(n)}},onInvoke:(t,i,r,s,o,a,l)=>{try{return xP(n),t.invoke(r,s,o,a,l)}finally{n.shouldCoalesceRunChangeDetection&&e(),MP(n)}},onHasTask:(t,i,r,s)=>{t.hasTask(r,s),i===r&&("microTask"==s.change?(n._hasPendingMicrotasks=s.microTask,GC(n),zC(n)):"macroTask"==s.change&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,i,r,s)=>(t.handleError(r,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Mn.isInAngularZone())throw new se(909,!1)}static assertNotInAngularZone(){if(Mn.isInAngularZone())throw new se(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,kz,SP,SP);try{return s.runTask(o,t,i)}finally{s.cancelTask(o)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const kz={};function zC(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function GC(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function xP(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function MP(n){n._nesting--,zC(n)}class Vz{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new $n,this.onMicrotaskEmpty=new $n,this.onStable=new $n,this.onError=new $n}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}}const CP=new qe("",{providedIn:"root",factory:TP});function TP(){const n=Ve(Mn);let e=!0;return function Yv(...n){const e=Au(n),t=function Px(n,e){return"number"==typeof Ym(n)?n.pop():e}(n,1/0),i=n;return i.length?1===i.length?Yr(i[0]):lc(t)(hi(i,e)):lo}(new Sn(r=>{e=n.isStable&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks,n.runOutsideAngular(()=>{r.next(e),r.complete()})}),new Sn(r=>{let s;n.runOutsideAngular(()=>{s=n.onStable.subscribe(()=>{Mn.assertNotInAngularZone(),queueMicrotask(()=>{!e&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks&&(e=!0,r.next(!0))})})});const o=n.onUnstable.subscribe(()=>{Mn.assertInAngularZone(),e&&(e=!1,n.runOutsideAngular(()=>{r.next(!1)}))});return()=>{s.unsubscribe(),o.unsubscribe()}}).pipe(Km()))}function xl(n){return n instanceof Function?n():n}let WC=(()=>{class n{constructor(){this.renderDepth=0,this.handler=null}begin(){this.handler?.validateBegin(),this.renderDepth++}end(){this.renderDepth--,0===this.renderDepth&&this.handler?.execute()}ngOnDestroy(){this.handler?.destroy(),this.handler=null}static#e=this.\u0275prov=Ke({token:n,providedIn:"root",factory:()=>new n})}return n})();function O_(n){for(;n;){n[It]|=64;const e=Lc(n);if(pg(n)&&!e)return n;n=e}return null}const PP=new qe("",{providedIn:"root",factory:()=>!1});let tw=null;function FP(n,e){return n[e]??BP()}function kP(n,e){const t=BP();t.producerNode?.length&&(n[e]=tw,t.lView=n,tw=UP())}const Kz={..._0,consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{O_(n.lView)},lView:null};function UP(){return Object.create(Kz)}function BP(){return tw??=UP(),tw}const Ut={};function Rt(n){VP(Kt(),ge(),ur()+n,!1)}function VP(n,e,t,i){if(!i)if(3==(3&e[It])){const s=n.preOrderCheckHooks;null!==s&&Zu(e,s,t)}else{const s=n.preOrderHooks;null!==s&&Ms(e,s,0,t)}Da(t)}function le(n,e=jt.Default){const t=ge();return null===t?Le(n,e):$0(Hi(),t,lt(n),e)}function nw(n,e,t,i,r,s,o,a,l,c,d){const h=e.blueprint.slice();return h[vn]=r,h[It]=140|i,(null!==c||n&&2048&n[It])&&(h[It]|=2048),ef(h),h[Gn]=h[pc]=n,h[li]=t,h[fc]=o||n&&n[fc],h[xt]=a||n&&n[xt],h[Uo]=l||n&&n[Uo]||null,h[Ai]=s,h[Bo]=function WM(){return GM++}(),h[Qr]=d,h[Vh]=c,h[ci]=2==e.type?n[ci]:h,h}function ep(n,e,t,i,r){let s=n.data[e];if(null===s)s=function jC(n,e,t,i,r){const s=af(),o=qu(),l=n.data[e]=function sG(n,e,t,i,r,s){let o=e?e.injectorIndex:-1,a=0;return bc()&&(a|=128),{type:t,index:i,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,i,r);return null===n.firstChild&&(n.firstChild=l),null!==s&&(o?null==s.child&&null!==l.parent&&(s.child=l):null===s.next&&(s.next=l,l.prev=s)),l}(n,e,t,i,r),function F0(){return gt.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=t,s.value=i,s.attrs=r;const o=function wc(){const n=gt.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return xs(s,!0),s}function F_(n,e,t,i){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function zP(n,e,t,i,r){const s=FP(e,Vo),o=ur(),a=2&i;try{Da(-1),a&&e.length>Ft&&VP(n,e,Ft,!1),go(a?2:0,r);const c=a?s:null,d=Wh(c);try{null!==c&&(c.dirty=!1),t(i,r)}finally{mg(c,d)}}finally{a&&null===e[Vo]&&kP(e,Vo),Da(o),go(a?3:1,r)}}function $C(n,e,t){if(Rr(e)){const i=es(null);try{const s=e.directiveEnd;for(let o=e.directiveStart;o<s;o++){const a=n.data[o];a.contentQueries&&a.contentQueries(1,t[o],o)}}finally{es(i)}}}function qC(n,e,t){ts()&&(function hG(n,e,t,i){const r=t.directiveStart,s=t.directiveEnd;kt(t)&&function vG(n,e,t){const i=wr(e,n),r=GP(t);let o=16;t.signals?o=4096:t.onPush&&(o=64);const a=iw(n,nw(n,r,null,o,i,e,null,n[fc].rendererFactory.createRenderer(i,t),null,null,null));n[e.index]=a}(e,t,n.data[r+t.componentOffset]),n.firstCreatePass||gf(t,e),er(i,e);const o=t.initialInputs;for(let a=r;a<s;a++){const l=n.data[a],c=pl(e,n,a,t);er(c,e),null!==o&&bG(0,a-r,c,l,0,o),Vs(l)&&(Pr(t.index,e)[li]=pl(e,n,a,t))}}(n,e,t,wr(t,e)),64==(64&t.flags)&&XP(n,e,t))}function XC(n,e,t=wr){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?t(e,n):n[o];n[r++]=a}}}function GP(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=YC(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function YC(n,e,t,i,r,s,o,a,l,c,d){const h=Ft+i,p=h+r,m=function Qz(n,e){const t=[];for(let i=0;i<e;i++)t.push(i<n?null:Ut);return t}(h,p),g="function"==typeof c?c():c;return m[Ue]={type:n,blueprint:m,template:t,queries:null,viewQuery:a,declTNode:e,data:m.slice().fill(null,h),bindingStartIndex:h,expandoStartIndex:p,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:g,incompleteFirstPass:!1,ssrId:d}}let WP=n=>null;function jP(n,e,t,i){for(let r in n)if(n.hasOwnProperty(r)){t=null===t?{}:t;const s=n[r];null===i?$P(t,e,r,s):i.hasOwnProperty(r)&&$P(t,e,i[r],s)}return t}function $P(n,e,t,i){n.hasOwnProperty(t)?n[t].push(e,i):n[t]=[e,i]}function ZC(n,e,t,i){if(ts()){const r=null===i?null:{"":-1},s=function pG(n,e){const t=n.directiveRegistry;let i=null,r=null;if(t)for(let s=0;s<t.length;s++){const o=t[s];if(ln(e,o.selectors,!1))if(i||(i=[]),Vs(o))if(null!==o.findHostDirectiveDefs){const a=[];r=r||new Map,o.findHostDirectiveDefs(o,a,r),i.unshift(...a,o),KC(n,e,a.length)}else i.unshift(o),KC(n,e,0);else r=r||new Map,o.findHostDirectiveDefs?.(o,i,r),i.push(o)}return null===i?null:[i,r]}(n,t);let o,a;null===s?o=a=null:[o,a]=s,null!==o&&qP(n,e,t,o,r,a),r&&function mG(n,e,t){if(e){const i=n.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new se(-301,!1);i.push(e[r],s)}}}(t,i,r)}t.mergedAttrs=Bu(t.mergedAttrs,t.attrs)}function qP(n,e,t,i,r,s){for(let c=0;c<i.length;c++)ed(gf(t,e),n,i[c].type);!function _G(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}(t,n.data.length,i.length);for(let c=0;c<i.length;c++){const d=i[c];d.providersResolver&&d.providersResolver(d)}let o=!1,a=!1,l=F_(n,e,i.length,null);for(let c=0;c<i.length;c++){const d=i[c];t.mergedAttrs=Bu(t.mergedAttrs,d.hostAttrs),yG(n,t,e,l,d),gG(l,d,r),null!==d.contentQueries&&(t.flags|=4),(null!==d.hostBindings||null!==d.hostAttrs||0!==d.hostVars)&&(t.flags|=64);const h=d.type.prototype;!o&&(h.ngOnChanges||h.ngOnInit||h.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),o=!0),!a&&(h.ngOnChanges||h.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),l++}!function oG(n,e,t){const r=e.directiveEnd,s=n.data,o=e.attrs,a=[];let l=null,c=null;for(let d=e.directiveStart;d<r;d++){const h=s[d],p=t?t.get(h):null,g=p?p.outputs:null;l=jP(h.inputs,d,l,p?p.inputs:null),c=jP(h.outputs,d,c,g);const b=null===l||null===o||Y(e)?null:wG(l,d,o);a.push(b)}null!==l&&(l.hasOwnProperty("class")&&(e.flags|=8),l.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=l,e.outputs=c}(n,t,s)}function XP(n,e,t){const i=t.directiveStart,r=t.directiveEnd,s=t.index,o=function k0(){return gt.lFrame.currentDirectiveIndex}();try{Da(s);for(let a=i;a<r;a++){const l=n.data[a],c=e[a];lf(a),(null!==l.hostBindings||0!==l.hostVars||null!==l.hostAttrs)&&fG(l,c)}}finally{Da(-1),lf(o)}}function fG(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function KC(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function gG(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;Vs(e)&&(t[""]=n)}}function yG(n,e,t,i,r){n.data[i]=r;const s=r.factory||(r.factory=ll(r.type)),o=new Ku(s,Vs(r),le);n.blueprint[i]=o,t[i]=o,function uG(n,e,t,i,r){const s=r.hostBindings;if(s){let o=n.hostBindingOpCodes;null===o&&(o=n.hostBindingOpCodes=[]);const a=~e.index;(function dG(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(o)!=a&&o.push(a),o.push(t,i,s)}}(n,e,i,F_(n,t,r.hostVars,Ut),r)}function Fa(n,e,t,i,r,s){const o=wr(n,e);!function JC(n,e,t,i,r,s,o){if(null==s)n.removeAttribute(e,r,t);else{const a=null==o?Et(s):o(s,i||"",r);n.setAttribute(e,r,a,t)}}(e[xt],o,s,n.value,t,i,r)}function bG(n,e,t,i,r,s){const o=s[e];if(null!==o)for(let a=0;a<o.length;)YP(i,t,o[a++],o[a++],o[a++])}function YP(n,e,t,i,r){const s=es(null);try{const o=n.inputTransforms;null!==o&&o.hasOwnProperty(i)&&(r=o[i].call(e,r)),null!==n.setInput?n.setInput(e,r,t,i):e[i]=r}finally{es(s)}}function wG(n,e,t){let i=null,r=0;for(;r<t.length;){const s=t[r];if(0!==s)if(5!==s){if("number"==typeof s)break;if(n.hasOwnProperty(s)){null===i&&(i=[]);const o=n[s];for(let a=0;a<o.length;a+=2)if(o[a]===e){i.push(s,o[a+1],t[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function ZP(n,e,t,i){return[n,!0,!1,e,null,0,i,t,null,null,null]}function KP(n,e){const t=n.contentQueries;if(null!==t)for(let i=0;i<t.length;i+=2){const s=t[i+1];if(-1!==s){const o=n.data[s];Cg(t[i]),o.contentQueries(2,e[s],s)}}}function iw(n,e){return n[Kn]?n[Ji][Bs]=e:n[Kn]=e,n[Ji]=e,e}function QC(n,e,t){Cg(0);const i=es(null);try{e(n,t)}finally{es(i)}}function JP(n){return n[ya]||(n[ya]=[])}function QP(n){return n.cleanup||(n.cleanup=[])}function tN(n,e){const t=n[Uo],i=t?t.get(Sl,null):null;i&&i.handleError(e)}function eT(n,e,t,i,r){for(let s=0;s<t.length;){const o=t[s++],a=t[s++];YP(n.data[o],e[o],i,a,r)}}function EG(n,e){const t=Pr(e,n),i=t[Ue];!function SG(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}(i,t);const r=t[vn];null!==r&&null===t[Qr]&&(t[Qr]=N_(r,t[Uo])),tT(i,t,t[li])}function tT(n,e,t){Ta(e);try{const i=n.viewQuery;null!==i&&QC(1,i,t);const r=n.template;null!==r&&zP(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&KP(n,e),n.staticViewQueries&&QC(2,n.viewQuery,t);const s=n.components;null!==s&&function xG(n,e){for(let t=0;t<e.length;t++)EG(n,e[t])}(e,s)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[It]&=-5,Aa()}}let nN=(()=>{class n{constructor(){this.all=new Set,this.queue=new Map}create(t,i,r){const s=typeof Zone>"u"?null:Zone.current,o=function tM(n,e,t){const i=Object.create(nM);t&&(i.consumerAllowSignalWrites=!0),i.fn=n,i.schedule=e;const r=o=>{i.cleanupFn=o};return i.ref={notify:()=>v0(i),run:()=>{if(i.dirty=!1,i.hasRun&&!mo(i))return;i.hasRun=!0;const o=Wh(i);try{i.cleanupFn(),i.cleanupFn=Zh,i.fn(r)}finally{mg(i,o)}},cleanup:()=>i.cleanupFn()},i.ref}(t,c=>{this.all.has(c)&&this.queue.set(c,s)},r);let a;this.all.add(o),o.notify();const l=()=>{o.cleanup(),a?.(),this.all.delete(o),this.queue.delete(o)};return a=i?.onDestroy(l),{destroy:l}}flush(){if(0!==this.queue.size)for(const[t,i]of this.queue)this.queue.delete(t),i?i.run(()=>t.run()):t.run()}get isQueueEmpty(){return 0===this.queue.size}static#e=this.\u0275prov=Ke({token:n,providedIn:"root",factory:()=>new n})}return n})();function rw(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?r=Ch(r,a):2==s&&(i=Ch(i,a+": "+e[++o]+";"))}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}function k_(n,e,t,i,r=!1){for(;null!==t;){const s=e[t.index];null!==s&&i.push(An(s)),Bi(s)&&iN(s,i);const o=t.type;if(8&o)k_(n,e,t.child,i);else if(32&o){const a=i_(t,e);let l;for(;l=a();)i.push(l)}else if(16&o){const a=xb(e,t);if(Array.isArray(a))i.push(...a);else{const l=Lc(e[ci]);k_(l[Ue],l,a,i,!0)}}t=r?t.projectionNext:t.next}return i}function iN(n,e){for(let t=Ui;t<n.length;t++){const i=n[t],r=i[Ue].firstChild;null!==r&&k_(i[Ue],i,r,e)}n[fo]!==n[vn]&&e.push(n[fo])}function sw(n,e,t,i=!0){const r=e[fc],s=r.rendererFactory,o=r.afterRenderEventManager;s.begin?.(),o?.begin();try{rN(n,e,n.template,t)}catch(l){throw i&&tN(e,l),l}finally{s.end?.(),r.effectManager?.flush(),o?.end()}}function rN(n,e,t,i){const r=e[It];if(256!=(256&r)){e[fc].effectManager?.flush(),Ta(e);try{ef(e),function O0(n){return gt.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&zP(n,e,t,2,i);const o=3==(3&r);if(o){const c=n.preOrderCheckHooks;null!==c&&Zu(e,c,null)}else{const c=n.preOrderHooks;null!==c&&Ms(e,c,0,null),ff(e,0)}if(function TG(n){for(let e=mb(n);null!==e;e=gb(e)){if(!e[m0])continue;const t=e[Ho];for(let i=0;i<t.length;i++){D0(t[i])}}}(e),sN(e,2),null!==n.contentQueries&&KP(n,e),o){const c=n.contentCheckHooks;null!==c&&Zu(e,c)}else{const c=n.contentHooks;null!==c&&Ms(e,c,1),ff(e,1)}!function Jz(n,e){const t=n.hostBindingOpCodes;if(null===t)return;const i=FP(e,va);try{for(let r=0;r<t.length;r++){const s=t[r];if(s<0)Da(~s);else{const o=s,a=t[++r],l=t[++r];cM(a,o),i.dirty=!1;const c=Wh(i);try{l(2,e[o])}finally{mg(i,c)}}}}finally{null===e[va]&&kP(e,va),Da(-1)}}(n,e);const a=n.components;null!==a&&aN(e,a,0);const l=n.viewQuery;if(null!==l&&QC(2,l,i),o){const c=n.viewCheckHooks;null!==c&&Zu(e,c)}else{const c=n.viewHooks;null!==c&&Ms(e,c,2),ff(e,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),e[It]&=-73,tf(e)}finally{Aa()}}}function sN(n,e){for(let t=mb(n);null!==t;t=gb(t))for(let i=Ui;i<t.length;i++)oN(t[i],e)}function AG(n,e,t){oN(Pr(e,n),t)}function oN(n,e){if(!function sM(n){return 128==(128&n[It])}(n))return;const t=n[Ue],i=n[It];if(80&i&&0===e||1024&i||2===e)rN(t,n,t.template,n[li]);else if(n[_a]>0){sN(n,1);const r=t.components;null!==r&&aN(n,r,1)}}function aN(n,e,t){for(let i=0;i<e.length;i++)AG(n,e[i],t)}class U_{get rootNodes(){const e=this._lView,t=e[Ue];return k_(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[li]}set context(e){this._lView[li]=e}get destroyed(){return 256==(256&this._lView[It])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[Gn];if(Bi(e)){const t=e[8],i=t?t.indexOf(this):-1;i>-1&&(Of(e,i),yf(t,i))}this._attachedToViewContainer=!1}dr(this._lView[Ue],this._lView)}onDestroy(e){!function nf(n,e){if(256==(256&n[It]))throw new se(911,!1);null===n[Jr]&&(n[Jr]=[]),n[Jr].push(e)}(this._lView,e)}markForCheck(){O_(this._cdRefInjectingView||this._lView)}detach(){this._lView[It]&=-129}reattach(){this._lView[It]|=128}detectChanges(){sw(this._lView[Ue],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new se(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function js(n,e){wl(n,e,e[xt],2,null,null)}(this._lView[Ue],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new se(902,!1);this._appRef=e}}class DG extends U_{constructor(e){super(e),this._view=e}detectChanges(){const e=this._view;sw(e[Ue],e,e[li],!1)}checkNoChanges(){}get context(){return null}}class lN extends Vt{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=Yt(e);return new B_(t,this.ngModule)}}function cN(n){const e=[];for(let t in n)n.hasOwnProperty(t)&&e.push({propName:n[t],templateName:t});return e}class RG{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){i=Ou(i);const r=this.injector.get(e,kC,i);return r!==kC||t===kC?r:this.parentInjector.get(e,t,i)}}class B_ extends Be{get inputs(){const e=this.componentDef,t=e.inputTransforms,i=cN(e.inputs);if(null!==t)for(const r of i)t.hasOwnProperty(r.propName)&&(r.transform=t[r.propName]);return i}get outputs(){return cN(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function qx(n){return n.map(kh).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,i,r){let s=(r=r||this.ngModule)instanceof ss?r:r?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const o=s?new RG(e,s):e,a=o.get(Fn,null);if(null===a)throw new se(407,!1);const h={rendererFactory:a,sanitizer:o.get(Qb,null),effectManager:o.get(nN,null),afterRenderEventManager:o.get(WC,null)},p=a.createRenderer(null,this.componentDef),m=this.componentDef.selectors[0][0]||"div",g=i?function eG(n,e,t,i){const s=i.get(PP,!1)||t===ws.ShadowDom,o=n.selectRootElement(e,s);return function tG(n){WP(n)}(o),o}(p,i,this.componentDef.encapsulation,o):Lf(p,m,function IG(n){const e=n.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(m)),y=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let w=null;null!==g&&(w=N_(g,o,!0));const E=YC(0,null,null,1,0,null,null,null,null,null,null),x=nw(null,E,null,y,null,null,h,p,o,null,w);let C,A;Ta(x);try{const D=this.componentDef;let O,T=null;D.findHostDirectiveDefs?(O=[],T=new Map,D.findHostDirectiveDefs(D,O,T),O.push(D)):O=[D];const L=function NG(n,e){const t=n[Ue],i=Ft;return n[i]=e,ep(t,i,2,"#host",null)}(x,g),X=function LG(n,e,t,i,r,s,o){const a=r[Ue];!function OG(n,e,t,i){for(const r of n)e.mergedAttrs=Bu(e.mergedAttrs,r.hostAttrs);null!==e.mergedAttrs&&(rw(e,e.mergedAttrs,!0),null!==t&&Cb(i,t,e))}(i,n,e,o);let l=null;null!==e&&(l=N_(e,r[Uo]));const c=s.rendererFactory.createRenderer(e,t);let d=16;t.signals?d=4096:t.onPush&&(d=64);const h=nw(r,GP(t),null,d,r[n.index],n,s,c,null,null,l);return a.firstCreatePass&&KC(a,n,i.length-1),iw(r,h),r[n.index]=h}(L,g,D,O,x,h,p);A=$u(E,Ft),g&&function kG(n,e,t,i){if(i)Oh(n,t,["ng-version",Az.full]);else{const{attrs:r,classes:s}=function hc(n){const e=[],t=[];let i=1,r=2;for(;i<n.length;){let s=n[i];if("string"==typeof s)2===r?""!==s&&e.push(s,n[++i]):8===r&&t.push(s);else{if(!ke(r))break;r=s}i++}return{attrs:e,classes:t}}(e.selectors[0]);r&&Oh(n,t,r),s&&s.length>0&&Mb(n,t,s.join(" "))}}(p,D,g,i),void 0!==t&&function UG(n,e,t){const i=n.projection=[];for(let r=0;r<e.length;r++){const s=t[r];i.push(null!=s?Array.from(s):null)}}(A,this.ngContentSelectors,t),C=function FG(n,e,t,i,r,s){const o=Hi(),a=r[Ue],l=wr(o,r);qP(a,r,o,t,null,i);for(let d=0;d<t.length;d++)er(pl(r,a,o.directiveStart+d,o),r);XP(a,r,o),l&&er(l,r);const c=pl(r,a,o.directiveStart+o.componentOffset,o);if(n[li]=r[li]=c,null!==s)for(const d of s)d(c,e);return $C(a,o,n),c}(X,D,O,T,x,[BG]),tT(E,x,null)}finally{Aa()}return new PG(this.componentType,C,Wi(A,x),x,A)}}class PG extends be{constructor(e,t,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new DG(r),this.componentType=e}setInput(e,t){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;const s=this._rootLView;eT(s[Ue],s,r,e,t),this.previousInputValues.set(e,t),O_(Pr(this._tNode.index,s))}}get injector(){return new Sr(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function BG(){const n=Hi();hf(ge()[Ue],n)}function mn(n){let e=function uN(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),t=!0;const i=[n];for(;e;){let r;if(Vs(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new se(903,!1);r=e.\u0275dir}if(r){if(t){i.push(r);const o=n;o.inputs=ow(n.inputs),o.inputTransforms=ow(n.inputTransforms),o.declaredInputs=ow(n.declaredInputs),o.outputs=ow(n.outputs);const a=r.hostBindings;a&&GG(n,a);const l=r.viewQuery,c=r.contentQueries;if(l&&HG(n,l),c&&zG(n,c),uc(n.inputs,r.inputs),uc(n.declaredInputs,r.declaredInputs),uc(n.outputs,r.outputs),null!==r.inputTransforms&&(null===o.inputTransforms&&(o.inputTransforms={}),uc(o.inputTransforms,r.inputTransforms)),Vs(r)&&r.data.animation){const d=n.data;d.animation=(d.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(n),a===mn&&(t=!1)}}e=Object.getPrototypeOf(e)}!function VG(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){const r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=Bu(r.hostAttrs,t=Bu(t,r.hostAttrs))}}(i)}function ow(n){return n===uo?{}:n===nn?[]:n}function HG(n,e){const t=n.viewQuery;n.viewQuery=t?(i,r)=>{e(i,r),t(i,r)}:e}function zG(n,e){const t=n.contentQueries;n.contentQueries=t?(i,r,s)=>{e(i,r,s),t(i,r,s)}:e}function GG(n,e){const t=n.hostBindings;n.hostBindings=t?(i,r)=>{e(i,r),t(i,r)}:e}function aw(n){return!!nT(n)&&(Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n)}function nT(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function ka(n,e,t){return n[e]=t}function Or(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function _d(n,e,t,i){const r=Or(n,e,t);return Or(n,e+1,i)||r}function ri(n,e,t,i){const r=ge();return Or(r,Ec(),e)&&(Kt(),Fa(Dn(),r,n,e,t,i)),ri}function gn(n,e,t,i,r,s,o,a){const l=ge(),c=Kt(),d=n+Ft,h=c.firstCreatePass?function p4(n,e,t,i,r,s,o,a,l){const c=e.consts,d=ep(e,n,4,o||null,Ca(c,a));ZC(e,t,d,Ca(c,l)),hf(e,d);const h=d.tView=YC(2,d,i,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c,null);return null!==e.queries&&(e.queries.template(e,d),h.queries=e.queries.embeddedTView(d)),d}(d,c,l,e,t,i,r,s,o):c.data[d];xs(h,!1);const p=TN(c,l,h,n);hl()&&kf(c,l,p,h),er(p,l),iw(l,l[d]=ZP(p,l,p,h)),zh(h)&&qC(c,l,h),null!=o&&XC(l,h,a)}let TN=function AN(n,e,t,i){return jo(!0),e[xt].createComment("")};function lT(n){return function vc(n,e){return n[e]}(function lM(){return gt.lFrame.contextLView}(),Ft+n)}function vt(n,e,t){const i=ge();return Or(i,Ec(),e)&&function qs(n,e,t,i,r,s,o,a){const l=wr(e,t);let d,c=e.inputs;!a&&null!=c&&(d=c[i])?(eT(n,t,d,i,r),kt(e)&&function lG(n,e){const t=Pr(e,n);16&t[It]||(t[It]|=64)}(t,e.index)):3&e.type&&(i=function aG(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=o?o(r,e.value||"",i):r,s.setProperty(l,i,r))}(Kt(),Dn(),i,n,e,i[xt],t,!1),vt}function cT(n,e,t,i,r){const o=r?"class":"style";eT(n,t,e.inputs[o],o,i)}function Pt(n,e,t,i){const r=ge(),s=Kt(),o=Ft+n,a=r[xt],l=s.firstCreatePass?function y4(n,e,t,i,r,s){const o=e.consts,l=ep(e,n,2,i,Ca(o,r));return ZC(e,t,l,Ca(o,s)),null!==l.attrs&&rw(l,l.attrs,!1),null!==l.mergedAttrs&&rw(l,l.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,l),l}(o,s,r,e,t,i):s.data[o],c=DN(s,r,l,a,e,n);r[o]=c;const d=zh(l);return xs(l,!0),Cb(a,c,l),32!=(32&l.flags)&&hl()&&kf(s,r,c,l),0===function P0(){return gt.lFrame.elementDepthCount}()&&er(c,r),function oM(){gt.lFrame.elementDepthCount++}(),d&&(qC(s,r,l),$C(s,l,r)),null!==i&&XC(r,l),Pt}function At(){let n=Hi();qu()?_o():(n=n.parent,xs(n,!1));const e=n;(function sf(n){return gt.skipHydrationRootTNode===n})(e)&&function ns(){gt.skipHydrationRootTNode=null}(),function aM(){gt.lFrame.elementDepthCount--}();const t=Kt();return t.firstCreatePass&&(hf(t,n),Rr(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function pf(n){return 0!=(8&n.flags)}(e)&&cT(t,e,ge(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function xc(n){return 0!=(16&n.flags)}(e)&&cT(t,e,ge(),e.stylesWithoutHost,!1),At}function Fr(n,e,t,i){return Pt(n,e,t,i),At(),Fr}let DN=(n,e,t,i,r,s)=>(jo(!0),Lf(i,r,function B0(){return gt.lFrame.currentNamespace}()));function Gc(n,e,t){const i=ge(),r=Kt(),s=n+Ft,o=r.firstCreatePass?function w4(n,e,t,i,r){const s=e.consts,o=Ca(s,i),a=ep(e,n,8,"ng-container",o);return null!==o&&rw(a,o,!0),ZC(e,t,a,Ca(s,r)),null!==e.queries&&e.queries.elementStart(e,a),a}(s,r,i,e,t):r.data[s];xs(o,!0);const a=IN(r,i,o,n);return i[s]=a,hl()&&kf(r,i,a,o),er(a,i),zh(o)&&(qC(r,i,o),$C(r,o,i)),null!=t&&XC(i,o),Gc}function Wc(){let n=Hi();const e=Kt();return qu()?_o():(n=n.parent,xs(n,!1)),e.firstCreatePass&&(hf(e,n),Rr(n)&&e.queries.elementEnd(n)),Wc}function uT(n,e,t){return Gc(n,e,t),Wc(),uT}let IN=(n,e,t,i)=>(jo(!0),s_(e[xt],""));function yd(){return ge()}function W_(n){return!!n&&"function"==typeof n.then}function RN(n){return!!n&&"function"==typeof n.subscribe}function wn(n,e,t,i){const r=ge(),s=Kt(),o=Hi();return function NN(n,e,t,i,r,s,o){const a=zh(i),c=n.firstCreatePass&&QP(n),d=e[li],h=JP(e);let p=!0;if(3&i.type||o){const b=wr(i,e),v=o?o(b):b,y=h.length,w=o?x=>o(An(x[i.index])):i.index;let E=null;if(!o&&a&&(E=function x4(n,e,t,i){const r=n.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===t&&r[s+1]===i){const a=e[ya],l=r[s+2];return a.length>l?a[l]:null}"string"==typeof o&&(s+=2)}return null}(n,e,r,i.index)),null!==E)(E.__ngLastListenerFn__||E).__ngNextListenerFn__=s,E.__ngLastListenerFn__=s,p=!1;else{s=ON(i,e,d,s,!1);const x=t.listen(v,r,s);h.push(s,x),c&&c.push(r,w,y,y+1)}}else s=ON(i,e,d,s,!1);const m=i.outputs;let g;if(p&&null!==m&&(g=m[r])){const b=g.length;if(b)for(let v=0;v<b;v+=2){const C=e[g[v]][g[v+1]].subscribe(s),A=h.length;h.push(s,C),c&&c.push(r,i.index,A,-(A+1))}}}(s,r,r[xt],o,n,e,i),wn}function LN(n,e,t,i){try{return go(6,e,t),!1!==t(i)}catch(r){return tN(n,r),!1}finally{go(7,e,t)}}function ON(n,e,t,i,r){return function s(o){if(o===Function)return i;O_(n.componentOffset>-1?Pr(n.index,e):e);let l=LN(e,t,i,o),c=s.__ngNextListenerFn__;for(;c;)l=LN(e,t,c,o)&&l,c=c.__ngNextListenerFn__;return r&&!1===l&&o.preventDefault(),l}}function dn(n=1){return function Yu(n){return(gt.lFrame.contextLView=function dM(n,e){for(;n>0;)e=e[pc],n--;return e}(n,gt.lFrame.contextLView))[li]}(n)}function M4(n,e){let t=null;const i=function Ti(n){const e=n.attrs;if(null!=e){const t=e.indexOf(5);if(!(1&t))return e[t+1]}return null}(n);for(let r=0;r<e.length;r++){const s=e[r];if("*"!==s){if(null===i?ln(n,s,!0):$x(i,s))return r}else t=r}return t}function dT(n){const e=ge()[ci][Ai];if(!e.projection){const i=e.projection=id(n?n.length:1,null),r=i.slice();let s=e.child;for(;null!==s;){const o=n?M4(s,n):0;null!==o&&(r[o]?r[o].projectionNext=s:i[o]=s,r[o]=s),s=s.next}}}function hT(n,e=0,t){const i=ge(),r=Kt(),s=ep(r,Ft+n,16,null,t||null);null===s.projection&&(s.projection=e),_o(),(!i[Qr]||bc())&&32!=(32&s.flags)&&function nC(n,e,t){u_(e[xt],0,e,t,o_(n,t,e),od(t.parent||e[Ai],t,e))}(r,i,s)}function hw(n,e){return n<<17|e<<2}function jc(n){return n>>17&32767}function pT(n){return 2|n}function vd(n){return(131068&n)>>2}function mT(n,e){return-131069&n|e<<2}function gT(n){return 1|n}function jN(n,e,t,i,r){const s=n[t+1],o=null===e;let a=i?jc(s):vd(s),l=!1;for(;0!==a&&(!1===l||o);){const d=n[a+1];R4(n[a],e)&&(l=!0,n[a+1]=i?gT(d):pT(d)),a=i?jc(d):vd(d)}l&&(n[t+1]=i?pT(s):gT(s))}function R4(n,e){return null===n||null==e||(Array.isArray(n)?n[1]:n)===e||!(!Array.isArray(n)||"string"!=typeof e)&&Ic(n,e)>=0}const tr={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function $N(n){return n.substring(tr.key,tr.keyEnd)}function qN(n,e){const t=tr.textEnd;return t===e?-1:(e=tr.keyEnd=function O4(n,e,t){for(;e<t&&n.charCodeAt(e)>32;)e++;return e}(n,tr.key=e,t),up(n,e,t))}function up(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function j_(n,e){return function Ko(n,e,t,i){const r=ge(),s=Kt(),o=Wo(2);s.firstUpdatePass&&eL(s,n,o,i),e!==Ut&&Or(r,o,e)&&nL(s,s.data[ur()],r,r[xt],n,r[o+1]=function $4(n,e){return null==n||""===n||("string"==typeof e?n+=e:"object"==typeof n&&(n=Mi(Na(n)))),n}(e,t),i,o)}(n,e,null,!0),j_}function Cl(n){!function Jo(n,e,t,i){const r=Kt(),s=Wo(2);r.firstUpdatePass&&eL(r,null,s,i);const o=ge();if(t!==Ut&&Or(o,s,t)){const a=r.data[ur()];if(rL(a,i)&&!QN(r,s)){let l=i?a.classesWithoutHost:a.stylesWithoutHost;null!==l&&(t=Ch(l,t||"")),cT(r,a,o,t,i)}else!function j4(n,e,t,i,r,s,o,a){r===Ut&&(r=nn);let l=0,c=0,d=0<r.length?r[0]:null,h=0<s.length?s[0]:null;for(;null!==d||null!==h;){const p=l<r.length?r[l+1]:void 0,m=c<s.length?s[c+1]:void 0;let b,g=null;d===h?(l+=2,c+=2,p!==m&&(g=h,b=m)):null===h||null!==d&&d<h?(l+=2,g=d):(c+=2,g=h,b=m),null!==g&&nL(n,e,t,i,g,b,o,a),d=l<r.length?r[l]:null,h=c<s.length?s[c]:null}}(r,a,o,o[xt],o[s+1],o[s+1]=function G4(n,e,t){if(null==t||""===t)return nn;const i=[],r=Na(t);if(Array.isArray(r))for(let s=0;s<r.length;s++)n(i,r[s],!0);else if("object"==typeof r)for(const s in r)r.hasOwnProperty(s)&&n(i,s,r[s]);else"string"==typeof r&&e(i,r);return i}(n,e,t),i,s)}}(W4,Ba,n,!0)}function Ba(n,e){for(let t=function N4(n){return function YN(n){tr.key=0,tr.keyEnd=0,tr.value=0,tr.valueEnd=0,tr.textEnd=n.length}(n),qN(n,up(n,0,tr.textEnd))}(e);t>=0;t=qN(e,t))Wn(n,$N(e),!0)}function QN(n,e){return e>=n.expandoStartIndex}function eL(n,e,t,i){const r=n.data;if(null===r[t+1]){const s=r[ur()],o=QN(n,t);rL(s,i)&&null===e&&!o&&(e=!1),e=function B4(n,e,t,i){const r=function cr(n){const e=gt.lFrame.currentDirectiveIndex;return-1===e?null:n[e]}(n);let s=i?e.residualClasses:e.residualStyles;if(null===r)0===(i?e.classBindings:e.styleBindings)&&(t=$_(t=_T(null,n,e,t,i),e.attrs,i),s=null);else{const o=e.directiveStylingLast;if(-1===o||n[o]!==r)if(t=_T(r,n,e,t,i),null===s){let l=function V4(n,e,t){const i=t?e.classBindings:e.styleBindings;if(0!==vd(i))return n[jc(i)]}(n,e,i);void 0!==l&&Array.isArray(l)&&(l=_T(null,n,e,l[1],i),l=$_(l,e.attrs,i),function H4(n,e,t,i){n[jc(t?e.classBindings:e.styleBindings)]=i}(n,e,i,l))}else s=function z4(n,e,t){let i;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)i=$_(i,n[s].hostAttrs,t);return $_(i,e.attrs,t)}(n,e,i)}return void 0!==s&&(i?e.residualClasses=s:e.residualStyles=s),t}(r,s,e,i),function D4(n,e,t,i,r,s){let o=s?e.classBindings:e.styleBindings,a=jc(o),l=vd(o);n[i]=t;let d,c=!1;if(Array.isArray(t)?(d=t[1],(null===d||Ic(t,d)>0)&&(c=!0)):d=t,r)if(0!==l){const p=jc(n[a+1]);n[i+1]=hw(p,a),0!==p&&(n[p+1]=mT(n[p+1],i)),n[a+1]=function T4(n,e){return 131071&n|e<<17}(n[a+1],i)}else n[i+1]=hw(a,0),0!==a&&(n[a+1]=mT(n[a+1],i)),a=i;else n[i+1]=hw(l,0),0===a?a=i:n[l+1]=mT(n[l+1],i),l=i;c&&(n[i+1]=pT(n[i+1])),jN(n,d,i,!0),jN(n,d,i,!1),function I4(n,e,t,i,r){const s=r?n.residualClasses:n.residualStyles;null!=s&&"string"==typeof e&&Ic(s,e)>=0&&(t[i+1]=gT(t[i+1]))}(e,d,n,i,s),o=hw(a,l),s?e.classBindings=o:e.styleBindings=o}(r,s,e,t,o,i)}}function _T(n,e,t,i,r){let s=null;const o=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<o&&(s=e[a],i=$_(i,s.hostAttrs,r),s!==n);)a++;return null!==n&&(t.directiveStylingLast=a),i}function $_(n,e,t){const i=t?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?r=o:r===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),Wn(n,o,!!t||e[++s]))}return void 0===n?null:n}function W4(n,e,t){const i=String(e);""!==i&&!i.includes(" ")&&Wn(n,i,t)}function nL(n,e,t,i,r,s,o,a){if(!(3&e.type))return;const l=n.data,c=l[a+1],d=function A4(n){return 1==(1&n)}(c)?iL(l,e,t,r,vd(c),o):void 0;fw(d)||(fw(s)||function C4(n){return 2==(2&n)}(c)&&(s=iL(l,null,t,r,a,o)),function rs(n,e,t,i,r){if(e)r?n.addClass(t,i):n.removeClass(t,i);else{let s=-1===i.indexOf("-")?void 0:Ra.DashCase;null==r?n.removeStyle(t,i,s):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),s|=Ra.Important),n.setStyle(t,i,r,s))}}(i,o,ju(ur(),t),r,s))}function iL(n,e,t,i,r,s){const o=null===e;let a;for(;r>0;){const l=n[r],c=Array.isArray(l),d=c?l[1]:l,h=null===d;let p=t[r+1];p===Ut&&(p=h?nn:void 0);let m=h?zg(p,i):d===i?p:void 0;if(c&&!fw(m)&&(m=zg(l,i)),fw(m)&&(a=m,o))return a;const g=n[r+1];r=o?jc(g):vd(g)}if(null!==e){let l=s?e.residualClasses:e.residualStyles;null!=l&&(a=zg(l,i))}return a}function fw(n){return void 0!==n}function rL(n,e){return 0!=(n.flags&(e?8:16))}function In(n,e=""){const t=ge(),i=Kt(),r=n+Ft,s=i.firstCreatePass?ep(i,r,1,e,null):i.data[r],o=sL(i,t,s,e,n);t[r]=o,hl()&&kf(i,t,o,s),xs(s,!1)}let sL=(n,e,t,i,r)=>(jo(!0),function Nf(n,e){return n.createText(e)}(e[xt],i));function Tl(n){return dp("",n,""),Tl}function dp(n,e,t){const i=ge(),r=function np(n,e,t,i){return Or(n,Ec(),t)?e+Et(t)+i:Ut}(i,n,e,t);return r!==Ut&&function Ml(n,e,t){const i=ju(e,n);!function yb(n,e,t){n.setValue(e,t)}(n[xt],i,t)}(i,ur(),r),dp}const fp="en-US";let TL=fp;function bT(n,e,t,i,r){if(n=lt(n),Array.isArray(n))for(let s=0;s<n.length;s++)bT(n[s],e,t,i,r);else{const s=Kt(),o=ge(),a=Hi();let l=La(n)?n:lt(n.provide);const c=$b(n),d=1048575&a.providerIndexes,h=a.directiveStart,p=a.providerIndexes>>20;if(La(n)||!n.multi){const m=new Ku(c,r,le),g=ET(l,e,r?d:d+p,h);-1===g?(ed(gf(a,o),s,l),wT(s,n,e.length),e.push(l),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(m),o.push(m)):(t[g]=m,o[g]=m)}else{const m=ET(l,e,d+p,h),g=ET(l,e,d,d+p),v=g>=0&&t[g];if(r&&!v||!r&&!(m>=0&&t[m])){ed(gf(a,o),s,l);const y=function fW(n,e,t,i,r){const s=new Ku(n,t,le);return s.multi=[],s.index=e,s.componentProviders=0,JL(s,r,i&&!t),s}(r?hW:dW,t.length,r,i,c);!r&&v&&(t[g].providerFactory=y),wT(s,n,e.length,0),e.push(l),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(y),o.push(y)}else wT(s,n,m>-1?m:g,JL(t[r?g:m],c,!r&&i));!r&&i&&v&&t[g].componentProviders++}}}function wT(n,e,t,i){const r=La(e),s=function jb(n){return!!n.useClass}(e);if(r||s){const l=(s?lt(e.useClass):e).prototype.ngOnDestroy;if(l){const c=n.destroyHooks||(n.destroyHooks=[]);if(!r&&e.multi){const d=c.indexOf(t);-1===d?c.push(t,[i,l]):c[d+1].push(i,l)}else c.push(t,l)}}}function JL(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function ET(n,e,t,i){for(let r=t;r<i;r++)if(e[r]===n)return r;return-1}function dW(n,e,t,i){return ST(this.multi,[])}function hW(n,e,t,i){const r=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=pl(t,t[Ue],this.providerFactory.index,i);s=a.slice(0,o),ST(r,s);for(let l=o;l<a.length;l++)s.push(a[l])}else s=[],ST(r,s);return s}function ST(n,e){for(let t=0;t<n.length;t++)e.push((0,n[t])());return e}function kn(n,e=[]){return t=>{t.providersResolver=(i,r)=>function uW(n,e,t){const i=Kt();if(i.firstCreatePass){const r=Vs(n);bT(t,i.data,i.blueprint,r,!0),bT(e,i.data,i.blueprint,r,!1)}}(i,r?r(n):n,e)}}class wd{}class QL{}class xT extends wd{constructor(e,t,i){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new lN(this);const r=ar(e);this._bootstrapComponents=xl(r.bootstrap),this._r3Injector=wP(e,t,[{provide:wd,useValue:this},{provide:Vt,useValue:this.componentFactoryResolver},...i],Mi(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class MT extends QL{constructor(e){super(),this.moduleType=e}create(e){return new xT(this.moduleType,e,[])}}class eO extends wd{constructor(e){super(),this.componentFactoryResolver=new lN(this),this.instance=null;const t=new qf([...e.providers,{provide:wd,useValue:this},{provide:Vt,useValue:this.componentFactoryResolver}],e.parent||$f(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function CT(n,e,t=null){return new eO({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}let gW=(()=>{class n{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){const i=zb(0,t.type),r=i.length>0?CT([i],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,r)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}static#e=this.\u0275prov=Ke({token:n,providedIn:"environment",factory:()=>new n(Le(ss))})}return n})();function J_(n){n.getStandaloneInjector=e=>e.get(gW).getOrCreateStandaloneInjector(n)}function aO(n,e,t,i){return function cO(n,e,t,i,r,s){const o=e+t;return Or(n,o,r)?ka(n,o+1,s?i.call(s,r):i(r)):Q_(n,o+1)}(ge(),lr(),n,e,t,i)}function lO(n,e,t,i,r){return function uO(n,e,t,i,r,s,o){const a=e+t;return _d(n,a,r,s)?ka(n,a+2,o?i.call(o,r,s):i(r,s)):Q_(n,a+2)}(ge(),lr(),n,e,t,i,r)}function yw(n,e,t,i,r,s){return function dO(n,e,t,i,r,s,o,a){const l=e+t;return function lw(n,e,t,i,r){const s=_d(n,e,t,i);return Or(n,e+2,r)||s}(n,l,r,s,o)?ka(n,l+3,a?i.call(a,r,s,o):i(r,s,o)):Q_(n,l+3)}(ge(),lr(),n,e,t,i,r,s)}function Q_(n,e){const t=n[e];return t===Ut?void 0:t}function BW(){return this._results[Symbol.iterator]()}class AT{static#e=Symbol.iterator;get changes(){return this._changes||(this._changes=new $n)}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=AT.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=BW)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const i=this;i.dirty=!1;const r=function Cs(n){return n.flat(Number.POSITIVE_INFINITY)}(e);(this._changesDetected=!function bM(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],s=e[i];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}(i._results,r,t))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}function HW(n,e,t,i=!0){const r=e[Ue];if(function eC(n,e,t,i){const r=Ui+i,s=t.length;i>0&&(t[r-1][Bs]=e),i<s-Ui?(e[Bs]=t[r],Hg(t,Ui+i,e)):(t.push(e),e[Bs]=null),e[Gn]=t;const o=e[mc];null!==o&&t!==o&&function yl(n,e){const t=n[Ho];e[ci]!==e[Gn][Gn][ci]&&(n[m0]=!0),null===t?n[Ho]=[e]:t.push(e)}(o,e);const a=e[Ss];null!==a&&a.insertView(n),e[It]|=128}(r,e,n,t),i){const s=l_(t,n),o=e[xt],a=Ts(o,n[fo]);null!==a&&function JM(n,e,t,i,r,s){i[vn]=r,i[Ai]=e,wl(n,i,t,1,r,s)}(r,n[Ai],o,e,a,s)}}let Va=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=WW}return n})();const zW=Va,GW=class extends zW{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,i){const r=function VW(n,e,t,i){const r=e.tView,a=nw(n,r,t,4096&n[It]?4096:16,null,e,null,null,null,i?.injector??null,i?.hydrationInfo??null);a[mc]=n[e.index];const c=n[Ss];return null!==c&&(a[Ss]=c.createEmbeddedView(r)),tT(r,a,t),a}(this._declarationLView,this._declarationTContainer,e,{injector:t,hydrationInfo:i});return new U_(r)}};function WW(){return vw(Hi(),ge())}function vw(n,e){return 4&n.type?new GW(e,n,Wi(n,e)):null}let Qo=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=ZW}return n})();function ZW(){return bO(Hi(),ge())}const KW=Qo,yO=class extends KW{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return Wi(this._hostTNode,this._hostLView)}get injector(){return new Sr(this._hostTNode,this._hostLView)}get parentInjector(){const e=zi(this._hostTNode,this._hostLView);if(Qu(e)){const t=fl(e,this._hostLView),i=Gs(e);return new Sr(t[Ue].data[i+8],t)}return new Sr(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=vO(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-Ui}createEmbeddedView(e,t,i){let r,s;"number"==typeof i?r=i:null!=i&&(r=i.index,s=i.injector);const a=e.createEmbeddedViewImpl(t||{},s,null);return this.insertImpl(a,r,false),a}createComponent(e,t,i,r,s){const o=e&&!function Ac(n){return"function"==typeof n}(e);let a;if(o)a=t;else{const b=t||{};a=b.index,i=b.injector,r=b.projectableNodes,s=b.environmentInjector||b.ngModuleRef}const l=o?e:new B_(Yt(e)),c=i||this.parentInjector;if(!s&&null==l.ngModule){const v=(o?c:this.parentInjector).get(ss,null);v&&(s=v)}Yt(l.componentType??{});const m=l.create(c,r,null,s);return this.insertImpl(m.hostView,a,false),m}insert(e,t){return this.insertImpl(e,t,!1)}insertImpl(e,t,i){const r=e._lView;if(function A0(n){return Bi(n[Gn])}(r)){const l=this.indexOf(e);if(-1!==l)this.detach(l);else{const c=r[Gn],d=new yO(c,c[Ai],c[Gn]);d.detach(d.indexOf(e))}}const o=this._adjustIndex(t),a=this._lContainer;return HW(a,r,o,!i),e.attachToViewContainerRef(),Hg(DT(a),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=vO(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=Of(this._lContainer,t);i&&(yf(DT(this._lContainer),t),dr(i[Ue],i))}detach(e){const t=this._adjustIndex(e,-1),i=Of(this._lContainer,t);return i&&null!=yf(DT(this._lContainer),t)?new U_(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function vO(n){return n[8]}function DT(n){return n[8]||(n[8]=[])}function bO(n,e){let t;const i=e[n.index];return Bi(i)?t=i:(t=ZP(i,e,null,n),e[n.index]=t,iw(e,t)),wO(t,e,n,i),new yO(t,n,e)}let wO=function EO(n,e,t,i){if(n[fo])return;let r;r=8&t.type?An(i):function JW(n,e){const t=n[xt],i=t.createComment(""),r=wr(e,n);return vl(t,Ts(t,r),i,function Eb(n,e){return n.nextSibling(e)}(t,r),!1),i}(e,t),n[fo]=r};class IT{constructor(e){this.queryList=e,this.matches=null}clone(){return new IT(this.queryList)}setDirty(){this.queryList.setDirty()}}class RT{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let s=0;s<i;s++){const o=t.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new RT(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==TO(e,t).matches&&this.queries[t].setDirty()}}class SO{constructor(e,t,i=null){this.predicate=e,this.flags=t,this.read=i}}class PT{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,s=this.getByIndex(i).embeddedTView(e,r);s&&(s.indexInDeclarationView=i,null!==t?t.push(s):t=[s])}return null!==t?new PT(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class NT{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new NT(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(e,t,tj(t,s)),this.matchTNodeWithReadOption(e,t,td(t,e,s,!1,!1))}else i===Va?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,td(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===bn||r===Qo||r===Va&&4&t.type)this.addMatch(t.index,-2);else{const s=td(t,e,r,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function tj(n,e){const t=n.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1];return null}function ij(n,e,t,i){return-1===t?function nj(n,e){return 11&n.type?Wi(n,e):4&n.type?vw(n,e):null}(e,n):-2===t?function rj(n,e,t){return t===bn?Wi(e,n):t===Va?vw(e,n):t===Qo?bO(e,n):void 0}(n,e,i):pl(n,n[Ue],t,e)}function xO(n,e,t,i){const r=e[Ss].queries[i];if(null===r.matches){const s=n.data,o=t.matches,a=[];for(let l=0;l<o.length;l+=2){const c=o[l];a.push(c<0?null:ij(e,s[c],o[l+1],t.metadata.read))}r.matches=a}return r.matches}function LT(n,e,t,i){const r=n.queries.getByIndex(t),s=r.matches;if(null!==s){const o=xO(n,e,r,t);for(let a=0;a<s.length;a+=2){const l=s[a];if(l>0)i.push(o[a/2]);else{const c=s[a+1],d=e[-l];for(let h=Ui;h<d.length;h++){const p=d[h];p[mc]===p[Gn]&&LT(p[Ue],p,c,i)}if(null!==d[Ho]){const h=d[Ho];for(let p=0;p<h.length;p++){const m=h[p];LT(m[Ue],m,c,i)}}}}}return i}function pp(n){const e=ge(),t=Kt(),i=zs();Cg(i+1);const r=TO(t,i);if(n.dirty&&function T0(n){return 4==(4&n[It])}(e)===(2==(2&r.metadata.flags))){if(null===r.matches)n.reset([]);else{const s=r.crossesNgTemplate?LT(t,e,i,[]):xO(t,e,r,i);n.reset(s,os),n.notifyOnChanges()}return!0}return!1}function OT(n,e,t){const i=Kt();i.firstCreatePass&&(CO(i,new SO(n,e,t),-1),2==(2&e)&&(i.staticViewQueries=!0)),MO(i,ge(),e)}function ww(n,e,t,i){const r=Kt();if(r.firstCreatePass){const s=Hi();CO(r,new SO(e,t,i),s.index),function oj(n,e){const t=n.contentQueries||(n.contentQueries=[]);e!==(t.length?t[t.length-1]:-1)&&t.push(n.queries.length-1,e)}(r,n),2==(2&t)&&(r.staticContentQueries=!0)}MO(r,ge(),t)}function mp(){return function sj(n,e){return n[Ss].queries[e].queryList}(ge(),zs())}function MO(n,e,t){const i=new AT(4==(4&t));(function rG(n,e,t,i){const r=JP(e);r.push(t),n.firstCreatePass&&QP(n).push(i,r.length-1)})(n,e,i,i.destroy),null===e[Ss]&&(e[Ss]=new RT),e[Ss].queries.push(new IT(i))}function CO(n,e,t){null===n.queries&&(n.queries=new PT),n.queries.track(new NT(e,t))}function TO(n,e){return n.queries.getByIndex(e)}const HT=new qe("Application Initializer");let zT=(()=>{class n{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,i)=>{this.resolve=t,this.reject=i}),this.appInits=Ve(HT,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const t=[];for(const r of this.appInits){const s=r();if(W_(s))t.push(s);else if(RN(s)){const o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});t.push(o)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Ke({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),WO=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Ke({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();const Al=new qe("LocaleId",{providedIn:"root",factory:()=>Ve(Al,jt.Optional|jt.SkipSelf)||function Aj(){return typeof $localize<"u"&&$localize.locale||fp}()});let Sw=(()=>{class n{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Dr(!1)}add(){this.hasPendingTasks.next(!0);const t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Ke({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class Rj{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let jO=(()=>{class n{compileModuleSync(t){return new MT(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const i=this.compileModuleSync(t),s=xl(ar(t).declarations).reduce((o,a)=>{const l=Yt(a);return l&&o.push(new B_(l)),o},[]);return new Rj(i,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Ke({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const YO=new qe(""),Mw=new qe("");let qT,jT=(()=>{class n{constructor(t,i,r){this._ngZone=t,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,qT||(function Kj(n){qT=n}(r),r.addToWindow(i)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Mn.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,i,r){return[]}static#e=this.\u0275fac=function(i){return new(i||n)(Le(Mn),Le($T),Le(Mw))};static#t=this.\u0275prov=Ke({token:n,factory:n.\u0275fac})}return n})(),$T=(()=>{class n{constructor(){this._applications=new Map}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return qT?.findTestabilityInTree(this,t,i)??null}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Ke({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})(),$c=null;const ZO=new qe("AllowMultipleToken"),XT=new qe("PlatformDestroyListeners"),YT=new qe("appBootstrapListener");class JO{constructor(e,t){this.name=e,this.token=t}}function eF(n,e,t=[]){const i=`Platform: ${e}`,r=new qe(i);return(s=[])=>{let o=ZT();if(!o||o.injector.get(ZO,!1)){const a=[...t,...s,{provide:r,useValue:!0}];n?n(a):function e8(n){if($c&&!$c.get(ZO,!1))throw new se(400,!1);(function KO(){!function yg(n){_g=n}(()=>{throw new se(600,!1)})})(),$c=n;const e=n.get(nF);(function QO(n){n.get(qb,null)?.forEach(t=>t())})(n)}(function tF(n=[],e){return $s.create({name:e,providers:[{provide:S_,useValue:"platform"},{provide:XT,useValue:new Set([()=>$c=null])},...n]})}(a,i))}return function n8(n){const e=ZT();if(!e)throw new se(401,!1);return e}()}}function ZT(){return $c?.get(nF)??null}let nF=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,i){const r=function i8(n="zone.js",e){return"noop"===n?new Vz:"zone.js"===n?new Mn(e):n}(i?.ngZone,function iF(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return r.run(()=>{const s=function mW(n,e,t){return new xT(n,e,t)}(t.moduleType,this.injector,function lF(n){return[{provide:Mn,useFactory:n},{provide:hd,multi:!0,useFactory:()=>{const e=Ve(s8,{optional:!0});return()=>e.initialize()}},{provide:aF,useFactory:r8},{provide:CP,useFactory:TP}]}(()=>r)),o=s.injector.get(Sl,null);return r.runOutsideAngular(()=>{const a=r.onError.subscribe({next:l=>{o.handleError(l)}});s.onDestroy(()=>{Cw(this._modules,s),a.unsubscribe()})}),function rF(n,e,t){try{const i=t();return W_(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}(o,r,()=>{const a=s.injector.get(zT);return a.runInitializers(),a.donePromise.then(()=>(function AL(n){vs(n,"Expected localeId to be defined"),"string"==typeof n&&(TL=n.toLowerCase().replace(/_/g,"-"))}(s.injector.get(Al,fp)||fp),this._moduleDoBootstrap(s),s))})})}bootstrapModule(t,i=[]){const r=sF({},i);return function Jj(n,e,t){const i=new MT(t);return Promise.resolve(i)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(t){const i=t.injector.get(Ed);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new se(-403,!1);t.instance.ngDoBootstrap(i)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new se(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const t=this._injector.get(XT,null);t&&(t.forEach(i=>i()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static#e=this.\u0275fac=function(i){return new(i||n)(Le($s))};static#t=this.\u0275prov=Ke({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();function sF(n,e){return Array.isArray(e)?e.reduce(sF,n):{...n,...e}}let Ed=(()=>{class n{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=Ve(aF),this.zoneIsStable=Ve(CP),this.componentTypes=[],this.components=[],this.isStable=Ve(Sw).hasPendingTasks.pipe(ys(t=>t?pt(!1):this.zoneIsStable),function Fx(n,e=No){return n=n??Zv,Hn((t,i)=>{let r,s=!0;t.subscribe(Zn(i,o=>{const a=e(o);(s||!n(r,a))&&(s=!1,r=a,i.next(o))}))})}(),Km()),this._injector=Ve(ss)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(t,i){const r=t instanceof Be;if(!this._injector.get(zT).done)throw!r&&function sl(n){const e=Yt(n)||zn(n)||ki(n);return null!==e&&e.standalone}(t),new se(405,!1);let o;o=r?t:this._injector.get(Vt).resolveComponentFactory(t),this.componentTypes.push(o.componentType);const a=function Qj(n){return n.isBoundToModule}(o)?void 0:this._injector.get(wd),c=o.create($s.NULL,[],i||o.selector,a),d=c.location.nativeElement,h=c.injector.get(YO,null);return h?.registerApplication(d),c.onDestroy(()=>{this.detachView(c.hostView),Cw(this.components,c),h?.unregisterApplication(d)}),this._loadComponent(c),c}tick(){if(this._runningTick)throw new se(101,!1);try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this.internalErrorHandler(t)}finally{this._runningTick=!1}}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;Cw(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);const i=this._injector.get(YT,[]);i.push(...this._bootstrapListeners),i.forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>Cw(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new se(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Ke({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Cw(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const aF=new qe("",{providedIn:"root",factory:()=>Ve(Sl).handleError.bind(void 0)});function r8(){const n=Ve(Mn),e=Ve(Sl);return t=>n.runOutsideAngular(()=>e.handleError(t))}let s8=(()=>{class n{constructor(){this.zone=Ve(Mn),this.applicationRef=Ve(Ed)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Ke({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();let iy=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=a8}return n})();function a8(n){return function l8(n,e,t){if(kt(n)&&!t){const i=Pr(n.index,e);return new U_(i,i)}return 47&n.type?new U_(e[ci],e):null}(Hi(),ge(),16==(16&n))}class hF{constructor(){}supports(e){return aw(e)}create(e){return new p8(e)}}const f8=(n,e)=>e;class p8{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||f8}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,s=null;for(;t||i;){const o=!i||t&&t.currentIndex<pF(i,r,s)?t:i,a=pF(o,r,s),l=o.currentIndex;if(o===i)r--,i=i._nextRemoved;else if(t=t._next,null==o.previousIndex)r++;else{s||(s=[]);const c=a-r,d=l-r;if(c!=d){for(let p=0;p<c;p++){const m=p<s.length?s[p]:s[p]=0,g=m+p;d<=g&&g<c&&(s[p]=m+1)}s[o.previousIndex]=d-c}}a!==l&&e(o,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!aw(e))throw new se(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let r,s,o,t=this._itHead,i=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,o,a),i=!0),t=t._next}else r=0,function ZG(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{const t=n[Symbol.iterator]();let i;for(;!(i=t.next()).done;)e(i.value)}}(e,a=>{o=this._trackByFn(r,a),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,a,o,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,o,r),i=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,r)):e=this._addAfter(new m8(t,i),s,r),e}_verifyReinsertion(e,t,i,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?e=this._reinsertAfter(s,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,s=e._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){const r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new fF),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,i=e._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new fF),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class m8{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class g8{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){const t=e._prevDup,i=e._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}class fF{constructor(){this.map=new Map}put(e){const t=e.trackById;let i=this.map.get(t);i||(i=new g8,this.map.set(t,i)),i.add(e)}get(e,t){const r=this.map.get(e);return r?r.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function pF(n,e,t){const i=n.previousIndex;if(null===i)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}class mF{constructor(){}supports(e){return e instanceof Map||nT(e)}create(){return new _8}}class _8{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||nT(e)))throw new se(900,!1)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(i,r)=>{if(t&&t.key===r)this._maybeAddToChanges(t,i),this._appendAfter=t,t=t._next;else{const s=this._getOrCreateRecordForKey(r,i);t=this._insertBeforeOrAppend(t,s)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let i=t;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const i=e._prev;return t._next=e,t._prev=i,e._prev=t,i&&(i._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const r=this._records.get(e);this._maybeAddToChanges(r,t);const s=r._prev,o=r._next;return s&&(s._next=o),o&&(o._prev=s),r._next=null,r._prev=null,r}const i=new y8(e);return this._records.set(e,i),i.currentValue=t,this._addToAdditions(i),i}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(i=>t(e[i],i))}}class y8{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function gF(){return new Dw([new hF])}let Dw=(()=>{class n{static#e=this.\u0275prov=Ke({token:n,providedIn:"root",factory:gF});constructor(t){this.factories=t}static create(t,i){if(null!=i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||gF()),deps:[[n,new wf,new bf]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(null!=i)return i;throw new se(901,!1)}}return n})();function _F(){return new ry([new mF])}let ry=(()=>{class n{static#e=this.\u0275prov=Ke({token:n,providedIn:"root",factory:_F});constructor(t){this.factories=t}static create(t,i){if(i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||_F()),deps:[[n,new wf,new bf]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(i)return i;throw new se(901,!1)}}return n})();const w8=eF(null,"core",[]);let E8=(()=>{class n{constructor(t){}static#e=this.\u0275fac=function(i){return new(i||n)(Le(Ed))};static#t=this.\u0275mod=Fi({type:n});static#n=this.\u0275inj=Ci({})}return n})();let nA=null;function qc(){return nA}class F8{}const kr=new qe("DocumentToken");let iA=(()=>{class n{historyGo(t){throw new Error("Not implemented")}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Ke({token:n,factory:function(){return Ve(U8)},providedIn:"platform"})}return n})();const k8=new qe("Location Initialized");let U8=(()=>{class n extends iA{constructor(){super(),this._doc=Ve(kr),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return qc().getBaseHref(this._doc)}onPopState(t){const i=qc().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=qc().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,r){this._history.pushState(t,i,r)}replaceState(t,i,r){this._history.replaceState(t,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Ke({token:n,factory:function(){return new n},providedIn:"platform"})}return n})();function rA(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function CF(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function Dl(n){return n&&"?"!==n[0]?"?"+n:n}let xd=(()=>{class n{historyGo(t){throw new Error("Not implemented")}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Ke({token:n,factory:function(){return Ve(AF)},providedIn:"root"})}return n})();const TF=new qe("appBaseHref");let AF=(()=>{class n extends xd{constructor(t,i){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??Ve(kr).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return rA(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+Dl(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,s){const o=this.prepareExternalUrl(r+Dl(s));this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){const o=this.prepareExternalUrl(r+Dl(s));this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static#e=this.\u0275fac=function(i){return new(i||n)(Le(iA),Le(TF,8))};static#t=this.\u0275prov=Ke({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),B8=(()=>{class n extends xd{constructor(t,i){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(t){const i=rA(this._baseHref,t);return i.length>0?"#"+i:i}pushState(t,i,r,s){let o=this.prepareExternalUrl(r+Dl(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){let o=this.prepareExternalUrl(r+Dl(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static#e=this.\u0275fac=function(i){return new(i||n)(Le(iA),Le(TF,8))};static#t=this.\u0275prov=Ke({token:n,factory:n.\u0275fac})}return n})(),sA=(()=>{class n{constructor(t){this._subject=new $n,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const i=this._locationStrategy.getBaseHref();this._basePath=function z8(n){if(new RegExp("^(https?:)?//").test(n)){const[,t]=n.split(/\/\/[^\/]+/);return t}return n}(CF(DF(i))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+Dl(i))}normalize(t){return n.stripTrailingSlash(function H8(n,e){if(!n||!e.startsWith(n))return e;const t=e.substring(n.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,DF(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Dl(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Dl(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{const i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i,complete:r})}static#e=this.normalizeQueryParams=Dl;static#t=this.joinWithSlash=rA;static#n=this.stripTrailingSlash=CF;static#i=this.\u0275fac=function(i){return new(i||n)(Le(xd))};static#r=this.\u0275prov=Ke({token:n,factory:function(){return function V8(){return new sA(Le(xd))}()},providedIn:"root"})}return n})();function DF(n){return n.replace(/\/index.html$/,"")}function UF(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,s]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}const mA=/\s+/,BF=[];let Hw=(()=>{class n{constructor(t,i,r,s){this._iterableDiffers=t,this._keyValueDiffers=i,this._ngEl=r,this._renderer=s,this.initialClasses=BF,this.stateMap=new Map}set klass(t){this.initialClasses=null!=t?t.trim().split(mA):BF}set ngClass(t){this.rawClass="string"==typeof t?t.trim().split(mA):t}ngDoCheck(){for(const i of this.initialClasses)this._updateState(i,!0);const t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(const i of t)this._updateState(i,!0);else if(null!=t)for(const i of Object.keys(t))this._updateState(i,!!t[i]);this._applyStateDiff()}_updateState(t,i){const r=this.stateMap.get(t);void 0!==r?(r.enabled!==i&&(r.changed=!0,r.enabled=i),r.touched=!0):this.stateMap.set(t,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(const t of this.stateMap){const i=t[0],r=t[1];r.changed?(this._toggleClass(i,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),r.touched=!1}}_toggleClass(t,i){(t=t.trim()).length>0&&t.split(mA).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}static#e=this.\u0275fac=function(i){return new(i||n)(le(Dw),le(ry),le(bn),le(mi))};static#t=this.\u0275dir=ft({type:n,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0})}return n})();class T6{constructor(e,t,i,r){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let zw=(()=>{class n{set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const i=this._viewContainer;t.forEachOperation((r,s,o)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new T6(r.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)i.remove(null===s?void 0:s);else if(null!==s){const a=i.get(s);i.move(a,o),HF(a,r)}});for(let r=0,s=i.length;r<s;r++){const a=i.get(r).context;a.index=r,a.count=s,a.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{HF(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(t,i){return!0}static#e=this.\u0275fac=function(i){return new(i||n)(le(Qo),le(Va),le(Dw))};static#t=this.\u0275dir=ft({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}return n})();function HF(n,e){n.context.$implicit=e.item}let ay=(()=>{class n{constructor(t,i){this._viewContainer=t,this._context=new A6,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){zF("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){zF("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}static#e=this.\u0275fac=function(i){return new(i||n)(le(Qo),le(Va))};static#t=this.\u0275dir=ft({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}return n})();class A6{constructor(){this.$implicit=null,this.ngIf=null}}function zF(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${Mi(e)}'.`)}let yA=(()=>{class n{constructor(t,i,r){this._ngEl=t,this._differs=i,this._renderer=r,this._ngStyle=null,this._differ=null}set ngStyle(t){this._ngStyle=t,!this._differ&&t&&(this._differ=this._differs.find(t).create())}ngDoCheck(){if(this._differ){const t=this._differ.diff(this._ngStyle);t&&this._applyChanges(t)}}_setStyle(t,i){const[r,s]=t.split("."),o=-1===r.indexOf("-")?void 0:Ra.DashCase;null!=i?this._renderer.setStyle(this._ngEl.nativeElement,r,s?`${i}${s}`:i,o):this._renderer.removeStyle(this._ngEl.nativeElement,r,o)}_applyChanges(t){t.forEachRemovedItem(i=>this._setStyle(i.key,null)),t.forEachAddedItem(i=>this._setStyle(i.key,i.currentValue)),t.forEachChangedItem(i=>this._setStyle(i.key,i.currentValue))}static#e=this.\u0275fac=function(i){return new(i||n)(le(bn),le(ry),le(mi))};static#t=this.\u0275dir=ft({type:n,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0})}return n})(),vA=(()=>{class n{constructor(t){this._viewContainerRef=t,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(t){if(t.ngTemplateOutlet||t.ngTemplateOutletInjector){const i=this._viewContainerRef;if(this._viewRef&&i.remove(i.indexOf(this._viewRef)),this.ngTemplateOutlet){const{ngTemplateOutlet:r,ngTemplateOutletContext:s,ngTemplateOutletInjector:o}=this;this._viewRef=i.createEmbeddedView(r,s,o?{injector:o}:void 0)}else this._viewRef=null}else this._viewRef&&t.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}static#e=this.\u0275fac=function(i){return new(i||n)(le(Qo))};static#t=this.\u0275dir=ft({type:n,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[Vi]})}return n})(),bp=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Fi({type:n});static#n=this.\u0275inj=Ci({})}return n})();const jF="browser";function $F(n){return"server"===n}let r$=(()=>{class n{static#e=this.\u0275prov=Ke({token:n,providedIn:"root",factory:()=>new s$(Le(kr),window)})}return n})();class s${constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function o$(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&"function"==typeof n.body.attachShadow){const i=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const s=r.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}r=i.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.supportsScrolling()&&(this.window.history.scrollRestoration=e)}scrollToElement(e){const t=e.getBoundingClientRect(),i=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(i-s[0],r-s[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}class qF{}class D$ extends F8{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class xA extends D${static makeCurrent(){!function O8(n){nA||(nA=n)}(new xA)}onAndCancel(e,t,i){return e.addEventListener(t,i),()=>{e.removeEventListener(t,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function I$(){return cy=cy||document.querySelector("base"),cy?cy.getAttribute("href"):null}();return null==t?null:function R$(n){jw=jw||document.createElement("a"),jw.setAttribute("href",n);const e=jw.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){cy=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return UF(document.cookie,e)}}let jw,cy=null,N$=(()=>{class n{build(){return new XMLHttpRequest}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Ke({token:n,factory:n.\u0275fac})}return n})();const MA=new qe("EventManagerPlugins");let JF=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>{r.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(s=>s.supports(t)),!i)throw new se(5101,!1);return this._eventNameToPlugin.set(t,i),i}static#e=this.\u0275fac=function(i){return new(i||n)(Le(MA),Le(Mn))};static#t=this.\u0275prov=Ke({token:n,factory:n.\u0275fac})}return n})();class QF{constructor(e){this._doc=e}}const CA="ng-app-id";let e2=(()=>{class n{constructor(t,i,r,s={}){this.doc=t,this.appId=i,this.nonce=r,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=$F(s),this.resetHostNodes()}addStyles(t){for(const i of t)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(t){for(const i of t)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){const t=this.styleNodesInDOM;t&&(t.forEach(i=>i.remove()),t.clear());for(const i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const i of this.getAllStyles())this.addStyleToHost(t,i)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(const i of this.hostNodes)this.addStyleToHost(i,t)}onStyleRemoved(t){const i=this.styleRef;i.get(t)?.elements?.forEach(r=>r.remove()),i.delete(t)}collectServerRenderedStyles(){const t=this.doc.head?.querySelectorAll(`style[${CA}="${this.appId}"]`);if(t?.length){const i=new Map;return t.forEach(r=>{null!=r.textContent&&i.set(r.textContent,r)}),i}return null}changeUsageCount(t,i){const r=this.styleRef;if(r.has(t)){const s=r.get(t);return s.usage+=i,s.usage}return r.set(t,{usage:i,elements:[]}),i}getStyleElement(t,i){const r=this.styleNodesInDOM,s=r?.get(i);if(s?.parentNode===t)return r.delete(i),s.removeAttribute(CA),s;{const o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=i,this.platformIsServer&&o.setAttribute(CA,this.appId),o}}addStyleToHost(t,i){const r=this.getStyleElement(t,i);t.appendChild(r);const s=this.styleRef,o=s.get(i)?.elements;o?o.push(r):s.set(i,{elements:[r],usage:1})}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}static#e=this.\u0275fac=function(i){return new(i||n)(Le(kr),Le(Xf),Le(Yb,8),Le(Oa))};static#t=this.\u0275prov=Ke({token:n,factory:n.\u0275fac})}return n})();const TA={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},AA=/%COMP%/g,k$=new qe("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function n2(n,e){return e.map(t=>t.replace(AA,n))}let DA=(()=>{class n{constructor(t,i,r,s,o,a,l,c=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=a,this.ngZone=l,this.nonce=c,this.rendererByCompId=new Map,this.platformIsServer=$F(a),this.defaultRenderer=new IA(t,o,l,this.platformIsServer)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===ws.ShadowDom&&(i={...i,encapsulation:ws.Emulated});const r=this.getOrCreateRenderer(t,i);return r instanceof r2?r.applyToHost(t):r instanceof RA&&r.applyStyles(),r}getOrCreateRenderer(t,i){const r=this.rendererByCompId;let s=r.get(i.id);if(!s){const o=this.doc,a=this.ngZone,l=this.eventManager,c=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,h=this.platformIsServer;switch(i.encapsulation){case ws.Emulated:s=new r2(l,c,i,this.appId,d,o,a,h);break;case ws.ShadowDom:return new H$(l,c,t,i,o,a,this.nonce,h);default:s=new RA(l,c,i,d,o,a,h)}r.set(i.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static#e=this.\u0275fac=function(i){return new(i||n)(Le(JF),Le(e2),Le(Xf),Le(k$),Le(kr),Le(Oa),Le(Mn),Le(Yb))};static#t=this.\u0275prov=Ke({token:n,factory:n.\u0275fac})}return n})();class IA{constructor(e,t,i,r){this.eventManager=e,this.doc=t,this.ngZone=i,this.platformIsServer=r,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(TA[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(i2(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(i2(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?this.doc.querySelector(e):e;if(!i)throw new se(-5104,!1);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const s=TA[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=TA[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(Ra.DashCase|Ra.Important)?e.style.setProperty(t,i,r&Ra.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&Ra.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e[t]=i}setValue(e,t){e.nodeValue=t}listen(e,t,i){if("string"==typeof e&&!(e=qc().getGlobalEventTarget(this.doc,e)))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(i))}decoratePreventDefault(e){return t=>{if("__ngUnwrap__"===t)return e;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))&&t.preventDefault()}}}function i2(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class H$ extends IA{constructor(e,t,i,r,s,o,a,l){super(e,s,o,l),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const c=n2(r.id,r.styles);for(const d of c){const h=document.createElement("style");a&&h.setAttribute("nonce",a),h.textContent=d,this.shadowRoot.appendChild(h)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class RA extends IA{constructor(e,t,i,r,s,o,a,l){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r,this.styles=l?n2(l,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class r2 extends RA{constructor(e,t,i,r,s,o,a,l){const c=r+"-"+i.id;super(e,t,i,s,o,a,l,c),this.contentAttr=function U$(n){return"_ngcontent-%COMP%".replace(AA,n)}(c),this.hostAttr=function B$(n){return"_nghost-%COMP%".replace(AA,n)}(c)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}let z$=(()=>{class n extends QF{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}static#e=this.\u0275fac=function(i){return new(i||n)(Le(kr))};static#t=this.\u0275prov=Ke({token:n,factory:n.\u0275fac})}return n})();const s2=["alt","control","meta","shift"],G$={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},W$={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let j$=(()=>{class n extends QF{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,r){const s=n.parseEventName(i),o=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>qc().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=n._normalizeKey(i.pop());let o="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),o="code."),s2.forEach(c=>{const d=i.indexOf(c);d>-1&&(i.splice(d,1),o+=c+".")}),o+=s,0!=i.length||0===s.length)return null;const l={};return l.domEventName=r,l.fullKey=o,l}static matchEventFullKeyCode(t,i){let r=G$[t.key]||t.key,s="";return i.indexOf("code.")>-1&&(r=t.code,s="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),s2.forEach(o=>{o!==r&&(0,W$[o])(t)&&(s+=o+".")}),s+=r,s===i)}static eventCallback(t,i,r){return s=>{n.matchEventFullKeyCode(s,t)&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}static#e=this.\u0275fac=function(i){return new(i||n)(Le(kr))};static#t=this.\u0275prov=Ke({token:n,factory:n.\u0275fac})}return n})();const a2=[{provide:Oa,useValue:jF},{provide:qb,useValue:function $$(){xA.makeCurrent()},multi:!0},{provide:kr,useFactory:function X$(){return function Db(n){Lr=n}(document),document},deps:[]}],Y$=eF(w8,"browser",a2),Z$=new qe(""),l2=[{provide:Mw,useClass:class P${addToWindow(e){sn.getAngularTestability=(i,r=!0)=>{const s=e.findTestabilityInTree(i,r);if(null==s)throw new se(5103,!1);return s},sn.getAllAngularTestabilities=()=>e.getAllTestabilities(),sn.getAllAngularRootElements=()=>e.getAllRootElements(),sn.frameworkStabilizers||(sn.frameworkStabilizers=[]),sn.frameworkStabilizers.push(i=>{const r=sn.getAllAngularTestabilities();let s=r.length,o=!1;const a=function(l){o=o||l,s--,0==s&&i(o)};r.forEach(l=>{l.whenStable(a)})})}findTestabilityInTree(e,t,i){return null==t?null:e.getTestability(t)??(i?qc().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:YO,useClass:jT,deps:[Mn,$T,Mw]},{provide:jT,useClass:jT,deps:[Mn,$T,Mw]}],c2=[{provide:S_,useValue:"root"},{provide:Sl,useFactory:function q$(){return new Sl},deps:[]},{provide:MA,useClass:z$,multi:!0,deps:[kr,Mn,Oa]},{provide:MA,useClass:j$,multi:!0,deps:[kr]},DA,e2,JF,{provide:Fn,useExisting:DA},{provide:qF,useClass:N$,deps:[]},[]];let u2=(()=>{class n{constructor(t){}static withServerTransition(t){return{ngModule:n,providers:[{provide:Xf,useValue:t.appId}]}}static#e=this.\u0275fac=function(i){return new(i||n)(Le(Z$,12))};static#t=this.\u0275mod=Fi({type:n});static#n=this.\u0275inj=Ci({providers:[...c2,...l2],imports:[bp,E8]})}return n})(),PA=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static#e=this.\u0275fac=function(i){return new(i||n)(Le(kr))};static#t=this.\u0275prov=Ke({token:n,factory:function(i){let r=null;return r=i?new i:function J$(){return new PA(Le(kr))}(),r},providedIn:"root"})}return n})();typeof window<"u"&&window;class p2{}class i9{}const Pl="*";function m2(n,e=null){return{type:2,steps:n,options:e}}function g2(n){return{type:6,styles:n,offset:null}}class uy{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class _2{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,i=0,r=0;const s=this.players.length;0==s?queueMicrotask(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++t==s&&this._onFinish()}),o.onDestroy(()=>{++i==s&&this._onDestroy()}),o.onStart(()=>{++r==s&&this._onStart()})}),this.totalTime=this.players.reduce((o,a)=>Math.max(o,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,t/i.totalTime):1;i.setPosition(r)})}getPosition(){const e=this.players.reduce((t,i)=>null===t||i.totalTime>t.totalTime?i:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}function y2(n){return new se(3e3,!1)}function Yc(n){switch(n.length){case 0:return new uy;case 1:return n[0];default:return new _2(n)}}function v2(n,e,t=new Map,i=new Map){const r=[],s=[];let o=-1,a=null;if(e.forEach(l=>{const c=l.get("offset"),d=c==o,h=d&&a||new Map;l.forEach((p,m)=>{let g=m,b=p;if("offset"!==m)switch(g=n.normalizePropertyName(g,r),b){case"!":b=t.get(m);break;case Pl:b=i.get(m);break;default:b=n.normalizeStyleValue(m,g,b,r)}h.set(g,b)}),d||s.push(h),a=h,o=c}),r.length)throw function C9(n){return new se(3502,!1)}();return s}function OA(n,e,t,i){switch(e){case"start":n.onStart(()=>i(t&&FA(t,"start",n)));break;case"done":n.onDone(()=>i(t&&FA(t,"done",n)));break;case"destroy":n.onDestroy(()=>i(t&&FA(t,"destroy",n)))}}function FA(n,e,t){const s=kA(n.element,n.triggerName,n.fromState,n.toState,e||n.phaseName,t.totalTime??n.totalTime,!!t.disabled),o=n._data;return null!=o&&(s._data=o),s}function kA(n,e,t,i,r="",s=0,o){return{element:n,triggerName:e,fromState:t,toState:i,phaseName:r,totalTime:s,disabled:!!o}}function Ys(n,e,t){let i=n.get(e);return i||n.set(e,i=t),i}function b2(n){const e=n.indexOf(":");return[n.substring(1,e),n.slice(e+1)]}const U9=(()=>typeof document>"u"?null:document.documentElement)();function UA(n){const e=n.parentNode||n.host||null;return e===U9?null:e}let Md=null,w2=!1;function E2(n,e){for(;e;){if(e===n)return!0;e=UA(e)}return!1}function S2(n,e,t){if(t)return Array.from(n.querySelectorAll(e));const i=n.querySelector(e);return i?[i]:[]}let x2=(()=>{class n{validateStyleProperty(t){return function V9(n){Md||(Md=function H9(){return typeof document<"u"?document.body:null}()||{},w2=!!Md.style&&"WebkitAppearance"in Md.style);let e=!0;return Md.style&&!function B9(n){return"ebkit"==n.substring(1,6)}(n)&&(e=n in Md.style,!e&&w2&&(e="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in Md.style)),e}(t)}matchesElement(t,i){return!1}containsElement(t,i){return E2(t,i)}getParentElement(t){return UA(t)}query(t,i,r){return S2(t,i,r)}computeStyle(t,i,r){return r||""}animate(t,i,r,s,o,a=[],l){return new uy(r,s)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Ke({token:n,factory:n.\u0275fac})}return n})(),BA=(()=>{class n{static#e=this.NOOP=new x2}return n})();const z9=1e3,VA="ng-enter",$w="ng-leave",qw="ng-trigger",Xw=".ng-trigger",C2="ng-animating",HA=".ng-animating";function Nl(n){if("number"==typeof n)return n;const e=n.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:zA(parseFloat(e[1]),e[2])}function zA(n,e){return"s"===e?n*z9:n}function Yw(n,e,t){return n.hasOwnProperty("duration")?n:function W9(n,e,t){let r,s=0,o="";if("string"==typeof n){const a=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return e.push(y2()),{duration:0,delay:0,easing:""};r=zA(parseFloat(a[1]),a[2]);const l=a[3];null!=l&&(s=zA(parseFloat(l),a[4]));const c=a[5];c&&(o=c)}else r=n;if(!t){let a=!1,l=e.length;r<0&&(e.push(function r9(){return new se(3100,!1)}()),a=!0),s<0&&(e.push(function s9(){return new se(3101,!1)}()),a=!0),a&&e.splice(l,0,y2())}return{duration:r,delay:s,easing:o}}(n,e,t)}function dy(n,e={}){return Object.keys(n).forEach(t=>{e[t]=n[t]}),e}function T2(n){const e=new Map;return Object.keys(n).forEach(t=>{e.set(t,n[t])}),e}function Zc(n,e=new Map,t){if(t)for(let[i,r]of t)e.set(i,r);for(let[i,r]of n)e.set(i,r);return e}function Ha(n,e,t){e.forEach((i,r)=>{const s=WA(r);t&&!t.has(r)&&t.set(r,n.style[s]),n.style[s]=i})}function Cd(n,e){e.forEach((t,i)=>{const r=WA(i);n.style[r]=""})}function hy(n){return Array.isArray(n)?1==n.length?n[0]:m2(n):n}const GA=new RegExp("{{\\s*(.+?)\\s*}}","g");function D2(n){let e=[];if("string"==typeof n){let t;for(;t=GA.exec(n);)e.push(t[1]);GA.lastIndex=0}return e}function fy(n,e,t){const i=n.toString(),r=i.replace(GA,(s,o)=>{let a=e[o];return null==a&&(t.push(function a9(n){return new se(3003,!1)}()),a=""),a.toString()});return r==i?n:r}function Zw(n){const e=[];let t=n.next();for(;!t.done;)e.push(t.value),t=n.next();return e}const q9=/-+([a-z0-9])/g;function WA(n){return n.replace(q9,(...e)=>e[1].toUpperCase())}function Zs(n,e,t){switch(e.type){case 7:return n.visitTrigger(e,t);case 0:return n.visitState(e,t);case 1:return n.visitTransition(e,t);case 2:return n.visitSequence(e,t);case 3:return n.visitGroup(e,t);case 4:return n.visitAnimate(e,t);case 5:return n.visitKeyframes(e,t);case 6:return n.visitStyle(e,t);case 8:return n.visitReference(e,t);case 9:return n.visitAnimateChild(e,t);case 10:return n.visitAnimateRef(e,t);case 11:return n.visitQuery(e,t);case 12:return n.visitStagger(e,t);default:throw function l9(n){return new se(3004,!1)}()}}function I2(n,e){return window.getComputedStyle(n)[e]}const Kw="*";function Z9(n,e){const t=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(i=>function K9(n,e,t){if(":"==n[0]){const l=function J9(n,e){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,i)=>parseFloat(i)>parseFloat(t);case":decrement":return(t,i)=>parseFloat(i)<parseFloat(t);default:return e.push(function E9(n){return new se(3016,!1)}()),"* => *"}}(n,t);if("function"==typeof l)return void e.push(l);n=l}const i=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return t.push(function w9(n){return new se(3015,!1)}()),e;const r=i[1],s=i[2],o=i[3];e.push(R2(r,o));"<"==s[0]&&!(r==Kw&&o==Kw)&&e.push(R2(o,r))}(i,t,e)):t.push(n),t}const Jw=new Set(["true","1"]),Qw=new Set(["false","0"]);function R2(n,e){const t=Jw.has(n)||Qw.has(n),i=Jw.has(e)||Qw.has(e);return(r,s)=>{let o=n==Kw||n==r,a=e==Kw||e==s;return!o&&t&&"boolean"==typeof r&&(o=r?Jw.has(n):Qw.has(n)),!a&&i&&"boolean"==typeof s&&(a=s?Jw.has(e):Qw.has(e)),o&&a}}const Q9=new RegExp("s*:selfs*,?","g");function jA(n,e,t,i){return new e7(n).build(e,t,i)}class e7{constructor(e){this._driver=e}build(e,t,i){const r=new i7(t);return this._resetContextStyleTimingState(r),Zs(this,hy(e),r)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles=new Map,e.collectedStyles.set("",new Map),e.currentTime=0}visitTrigger(e,t){let i=t.queryCount=0,r=t.depCount=0;const s=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push(function u9(){return new se(3006,!1)}()),e.definitions.forEach(a=>{if(this._resetContextStyleTimingState(t),0==a.type){const l=a,c=l.name;c.toString().split(/\s*,\s*/).forEach(d=>{l.name=d,s.push(this.visitState(l,t))}),l.name=c}else if(1==a.type){const l=this.visitTransition(a,t);i+=l.queryCount,r+=l.depCount,o.push(l)}else t.errors.push(function d9(){return new se(3007,!1)}())}),{type:7,name:e.name,states:s,transitions:o,queryCount:i,depCount:r,options:null}}visitState(e,t){const i=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(i.containsDynamicStyles){const s=new Set,o=r||{};i.styles.forEach(a=>{a instanceof Map&&a.forEach(l=>{D2(l).forEach(c=>{o.hasOwnProperty(c)||s.add(c)})})}),s.size&&(Zw(s.values()),t.errors.push(function h9(n,e){return new se(3008,!1)}()))}return{type:0,name:e.name,style:i,options:r?{params:r}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const i=Zs(this,hy(e.animation),t);return{type:1,matchers:Z9(e.expr,t.errors),animation:i,queryCount:t.queryCount,depCount:t.depCount,options:Td(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(i=>Zs(this,i,t)),options:Td(e.options)}}visitGroup(e,t){const i=t.currentTime;let r=0;const s=e.steps.map(o=>{t.currentTime=i;const a=Zs(this,o,t);return r=Math.max(r,t.currentTime),a});return t.currentTime=r,{type:3,steps:s,options:Td(e.options)}}visitAnimate(e,t){const i=function s7(n,e){if(n.hasOwnProperty("duration"))return n;if("number"==typeof n)return $A(Yw(n,e).duration,0,"");const t=n;if(t.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=$A(0,0,"");return s.dynamic=!0,s.strValue=t,s}const r=Yw(t,e);return $A(r.duration,r.delay,r.easing)}(e.timings,t.errors);t.currentAnimateTimings=i;let r,s=e.styles?e.styles:g2({});if(5==s.type)r=this.visitKeyframes(s,t);else{let o=e.styles,a=!1;if(!o){a=!0;const c={};i.easing&&(c.easing=i.easing),o=g2(c)}t.currentTime+=i.duration+i.delay;const l=this.visitStyle(o,t);l.isEmptyStep=a,r=l}return t.currentAnimateTimings=null,{type:4,timings:i,style:r,options:null}}visitStyle(e,t){const i=this._makeStyleAst(e,t);return this._validateStyleAst(i,t),i}_makeStyleAst(e,t){const i=[],r=Array.isArray(e.styles)?e.styles:[e.styles];for(let a of r)"string"==typeof a?a===Pl?i.push(a):t.errors.push(new se(3002,!1)):i.push(T2(a));let s=!1,o=null;return i.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(o=a.get("easing"),a.delete("easing")),!s))for(let l of a.values())if(l.toString().indexOf("{{")>=0){s=!0;break}}),{type:6,styles:i,easing:o,offset:e.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(e,t){const i=t.currentAnimateTimings;let r=t.currentTime,s=t.currentTime;i&&s>0&&(s-=i.duration+i.delay),e.styles.forEach(o=>{"string"!=typeof o&&o.forEach((a,l)=>{const c=t.collectedStyles.get(t.currentQuerySelector),d=c.get(l);let h=!0;d&&(s!=r&&s>=d.startTime&&r<=d.endTime&&(t.errors.push(function p9(n,e,t,i,r){return new se(3010,!1)}()),h=!1),s=d.startTime),h&&c.set(l,{startTime:s,endTime:r}),t.options&&function $9(n,e,t){const i=e.params||{},r=D2(n);r.length&&r.forEach(s=>{i.hasOwnProperty(s)||t.push(function o9(n){return new se(3001,!1)}())})}(a,t.options,t.errors)})})}visitKeyframes(e,t){const i={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function m9(){return new se(3011,!1)}()),i;let s=0;const o=[];let a=!1,l=!1,c=0;const d=e.steps.map(y=>{const w=this._makeStyleAst(y,t);let E=null!=w.offset?w.offset:function r7(n){if("string"==typeof n)return null;let e=null;if(Array.isArray(n))n.forEach(t=>{if(t instanceof Map&&t.has("offset")){const i=t;e=parseFloat(i.get("offset")),i.delete("offset")}});else if(n instanceof Map&&n.has("offset")){const t=n;e=parseFloat(t.get("offset")),t.delete("offset")}return e}(w.styles),x=0;return null!=E&&(s++,x=w.offset=E),l=l||x<0||x>1,a=a||x<c,c=x,o.push(x),w});l&&t.errors.push(function g9(){return new se(3012,!1)}()),a&&t.errors.push(function _9(){return new se(3200,!1)}());const h=e.steps.length;let p=0;s>0&&s<h?t.errors.push(function y9(){return new se(3202,!1)}()):0==s&&(p=1/(h-1));const m=h-1,g=t.currentTime,b=t.currentAnimateTimings,v=b.duration;return d.forEach((y,w)=>{const E=p>0?w==m?1:p*w:o[w],x=E*v;t.currentTime=g+b.delay+x,b.duration=x,this._validateStyleAst(y,t),y.offset=E,i.styles.push(y)}),i}visitReference(e,t){return{type:8,animation:Zs(this,hy(e.animation),t),options:Td(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:Td(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:Td(e.options)}}visitQuery(e,t){const i=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;const[s,o]=function t7(n){const e=!!n.split(/\s*,\s*/).find(t=>":self"==t);return e&&(n=n.replace(Q9,"")),n=n.replace(/@\*/g,Xw).replace(/@\w+/g,t=>Xw+"-"+t.slice(1)).replace(/:animating/g,HA),[n,e]}(e.selector);t.currentQuerySelector=i.length?i+" "+s:s,Ys(t.collectedStyles,t.currentQuerySelector,new Map);const a=Zs(this,hy(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=i,{type:11,selector:s,limit:r.limit||0,optional:!!r.optional,includeSelf:o,animation:a,originalSelector:e.selector,options:Td(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function v9(){return new se(3013,!1)}());const i="full"===e.timings?{duration:0,delay:0,easing:"full"}:Yw(e.timings,t.errors,!0);return{type:12,animation:Zs(this,hy(e.animation),t),timings:i,options:null}}}class i7{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function Td(n){return n?(n=dy(n)).params&&(n.params=function n7(n){return n?dy(n):null}(n.params)):n={},n}function $A(n,e,t){return{duration:n,delay:e,easing:t}}function qA(n,e,t,i,r,s,o=null,a=!1){return{type:1,element:n,keyframes:e,preStyleProps:t,postStyleProps:i,duration:r,delay:s,totalTime:r+s,easing:o,subTimeline:a}}class eE{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let i=this._map.get(e);i||this._map.set(e,i=[]),i.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const l7=new RegExp(":enter","g"),u7=new RegExp(":leave","g");function XA(n,e,t,i,r,s=new Map,o=new Map,a,l,c=[]){return(new d7).buildKeyframes(n,e,t,i,r,s,o,a,l,c)}class d7{buildKeyframes(e,t,i,r,s,o,a,l,c,d=[]){c=c||new eE;const h=new YA(e,t,c,r,s,d,[]);h.options=l;const p=l.delay?Nl(l.delay):0;h.currentTimeline.delayNextStep(p),h.currentTimeline.setStyles([o],null,h.errors,l),Zs(this,i,h);const m=h.timelines.filter(g=>g.containsAnimation());if(m.length&&a.size){let g;for(let b=m.length-1;b>=0;b--){const v=m[b];if(v.element===t){g=v;break}}g&&!g.allowOnlyTimelineStyles()&&g.setStyles([a],null,h.errors,l)}return m.length?m.map(g=>g.buildKeyframes()):[qA(t,[],[],[],0,p,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const i=t.subInstructions.get(t.element);if(i){const r=t.createSubContext(e.options),s=t.currentTimeline.currentTime,o=this._visitSubInstructions(i,r,r.options);s!=o&&t.transformIntoNewTimeline(o)}t.previousNode=e}visitAnimateRef(e,t){const i=t.createSubContext(e.options);i.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],t,i),this.visitReference(e.animation,i),t.transformIntoNewTimeline(i.currentTimeline.currentTime),t.previousNode=e}_applyAnimationRefDelays(e,t,i){for(const r of e){const s=r?.delay;if(s){const o="number"==typeof s?s:Nl(fy(s,r?.params??{},t.errors));i.delayNextStep(o)}}}_visitSubInstructions(e,t,i){let s=t.currentTimeline.currentTime;const o=null!=i.duration?Nl(i.duration):null,a=null!=i.delay?Nl(i.delay):null;return 0!==o&&e.forEach(l=>{const c=t.appendInstructionToTimeline(l,o,a);s=Math.max(s,c.duration+c.delay)}),s}visitReference(e,t){t.updateOptions(e.options,!0),Zs(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const i=t.subContextCount;let r=t;const s=e.options;if(s&&(s.params||s.delay)&&(r=t.createSubContext(s),r.transformIntoNewTimeline(),null!=s.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=tE);const o=Nl(s.delay);r.delayNextStep(o)}e.steps.length&&(e.steps.forEach(o=>Zs(this,o,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const i=[];let r=t.currentTimeline.currentTime;const s=e.options&&e.options.delay?Nl(e.options.delay):0;e.steps.forEach(o=>{const a=t.createSubContext(e.options);s&&a.delayNextStep(s),Zs(this,o,a),r=Math.max(r,a.currentTimeline.currentTime),i.push(a.currentTimeline)}),i.forEach(o=>t.currentTimeline.mergeTimelineCollectedStyles(o)),t.transformIntoNewTimeline(r),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const i=e.strValue;return Yw(t.params?fy(i,t.params,t.errors):i,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const i=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;i.delay&&(t.incrementTime(i.delay),r.snapshotCurrentStyles());const s=e.style;5==s.type?this.visitKeyframes(s,t):(t.incrementTime(i.duration),this.visitStyle(s,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const i=t.currentTimeline,r=t.currentAnimateTimings;!r&&i.hasCurrentStyleProperties()&&i.forwardFrame();const s=r&&r.easing||e.easing;e.isEmptyStep?i.applyEmptyStep(s):i.setStyles(e.styles,s,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const i=t.currentAnimateTimings,r=t.currentTimeline.duration,s=i.duration,a=t.createSubContext().currentTimeline;a.easing=i.easing,e.styles.forEach(l=>{a.forwardTime((l.offset||0)*s),a.setStyles(l.styles,l.easing,t.errors,t.options),a.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(r+s),t.previousNode=e}visitQuery(e,t){const i=t.currentTimeline.currentTime,r=e.options||{},s=r.delay?Nl(r.delay):0;s&&(6===t.previousNode.type||0==i&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=tE);let o=i;const a=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!r.optional,t.errors);t.currentQueryTotal=a.length;let l=null;a.forEach((c,d)=>{t.currentQueryIndex=d;const h=t.createSubContext(e.options,c);s&&h.delayNextStep(s),c===t.element&&(l=h.currentTimeline),Zs(this,e.animation,h),h.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,h.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),l&&(t.currentTimeline.mergeTimelineCollectedStyles(l),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const i=t.parentContext,r=t.currentTimeline,s=e.timings,o=Math.abs(s.duration),a=o*(t.currentQueryTotal-1);let l=o*t.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":l=a-l;break;case"full":l=i.currentStaggerTime}const d=t.currentTimeline;l&&d.delayNextStep(l);const h=d.currentTime;Zs(this,e.animation,t),t.previousNode=e,i.currentStaggerTime=r.currentTime-h+(r.startTime-i.currentTimeline.startTime)}}const tE={};class YA{constructor(e,t,i,r,s,o,a,l){this._driver=e,this.element=t,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=s,this.errors=o,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=tE,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=l||new nE(this._driver,t,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const i=e;let r=this.options;null!=i.duration&&(r.duration=Nl(i.duration)),null!=i.delay&&(r.delay=Nl(i.delay));const s=i.params;if(s){let o=r.params;o||(o=this.options.params={}),Object.keys(s).forEach(a=>{(!t||!o.hasOwnProperty(a))&&(o[a]=fy(s[a],o,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const i=e.params={};Object.keys(t).forEach(r=>{i[r]=t[r]})}}return e}createSubContext(e=null,t,i){const r=t||this.element,s=new YA(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(e),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(e){return this.previousNode=tE,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,i){const r={duration:t??e.duration,delay:this.currentTimeline.currentTime+(i??0)+e.delay,easing:""},s=new h7(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(s),r}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,i,r,s,o){let a=[];if(r&&a.push(this.element),e.length>0){e=(e=e.replace(l7,"."+this._enterClassName)).replace(u7,"."+this._leaveClassName);let c=this._driver.query(this.element,e,1!=i);0!==i&&(c=i<0?c.slice(c.length+i,c.length):c.slice(0,i)),a.push(...c)}return!s&&0==a.length&&o.push(function b9(n){return new se(3014,!1)}()),a}}class nE{constructor(e,t,i,r){this._driver=e,this.element=t,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new nE(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,i]of this._globalTimelineStyles)this._backFill.set(t,i||Pl),this._currentKeyframe.set(t,Pl);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,i,r){t&&this._previousKeyframe.set("easing",t);const s=r&&r.params||{},o=function f7(n,e){const t=new Map;let i;return n.forEach(r=>{if("*"===r){i=i||e.keys();for(let s of i)t.set(s,Pl)}else Zc(r,t)}),t}(e,this._globalTimelineStyles);for(let[a,l]of o){const c=fy(l,s,i);this._pendingStyles.set(a,c),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??Pl),this._updateStyle(a,c)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,i)=>{const r=this._styleSummary.get(i);(!r||t.time>r.time)&&this._updateStyle(i,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((a,l)=>{const c=Zc(a,new Map,this._backFill);c.forEach((d,h)=>{"!"===d?e.add(h):d===Pl&&t.add(h)}),i||c.set("offset",l/this.duration),r.push(c)});const s=e.size?Zw(e.values()):[],o=t.size?Zw(t.values()):[];if(i){const a=r[0],l=new Map(a);a.set("offset",0),l.set("offset",1),r=[a,l]}return qA(this.element,r,s,o,this.duration,this.startTime,this.easing,!1)}}class h7 extends nE{constructor(e,t,i,r,s,o,a=!1){super(e,t,o.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=s,this._stretchStartingKeyframe=a,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&t){const s=[],o=i+t,a=t/o,l=Zc(e[0]);l.set("offset",0),s.push(l);const c=Zc(e[0]);c.set("offset",L2(a)),s.push(c);const d=e.length-1;for(let h=1;h<=d;h++){let p=Zc(e[h]);const m=p.get("offset");p.set("offset",L2((t+m*i)/o)),s.push(p)}i=o,t=0,r="",e=s}return qA(this.element,e,this.preStyleProps,this.postStyleProps,i,t,r,!0)}}function L2(n,e=3){const t=Math.pow(10,e-1);return Math.round(n*t)/t}class ZA{}const p7=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class m7 extends ZA{normalizePropertyName(e,t){return WA(e)}normalizeStyleValue(e,t,i,r){let s="";const o=i.toString().trim();if(p7.has(t)&&0!==i&&"0"!==i)if("number"==typeof i)s="px";else{const a=i.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&r.push(function c9(n,e){return new se(3005,!1)}())}return o+s}}function O2(n,e,t,i,r,s,o,a,l,c,d,h,p){return{type:0,element:n,triggerName:e,isRemovalTransition:r,fromState:t,fromStyles:s,toState:i,toStyles:o,timelines:a,queriedElements:l,preStyleProps:c,postStyleProps:d,totalTime:h,errors:p}}const KA={};class F2{constructor(e,t,i){this._triggerName=e,this.ast=t,this._stateStyles=i}match(e,t,i,r){return function g7(n,e,t,i,r){return n.some(s=>s(e,t,i,r))}(this.ast.matchers,e,t,i,r)}buildStyles(e,t,i){let r=this._stateStyles.get("*");return void 0!==e&&(r=this._stateStyles.get(e?.toString())||r),r?r.buildStyles(t,i):new Map}build(e,t,i,r,s,o,a,l,c,d){const h=[],p=this.ast.options&&this.ast.options.params||KA,g=this.buildStyles(i,a&&a.params||KA,h),b=l&&l.params||KA,v=this.buildStyles(r,b,h),y=new Set,w=new Map,E=new Map,x="void"===r,C={params:_7(b,p),delay:this.ast.options?.delay},A=d?[]:XA(e,t,this.ast.animation,s,o,g,v,C,c,h);let D=0;if(A.forEach(T=>{D=Math.max(T.duration+T.delay,D)}),h.length)return O2(t,this._triggerName,i,r,x,g,v,[],[],w,E,D,h);A.forEach(T=>{const L=T.element,X=Ys(w,L,new Set);T.preStyleProps.forEach(ae=>X.add(ae));const re=Ys(E,L,new Set);T.postStyleProps.forEach(ae=>re.add(ae)),L!==t&&y.add(L)});const O=Zw(y.values());return O2(t,this._triggerName,i,r,x,g,v,A,O,w,E,D)}}function _7(n,e){const t=dy(e);for(const i in n)n.hasOwnProperty(i)&&null!=n[i]&&(t[i]=n[i]);return t}class y7{constructor(e,t,i){this.styles=e,this.defaultParams=t,this.normalizer=i}buildStyles(e,t){const i=new Map,r=dy(this.defaultParams);return Object.keys(e).forEach(s=>{const o=e[s];null!==o&&(r[s]=o)}),this.styles.styles.forEach(s=>{"string"!=typeof s&&s.forEach((o,a)=>{o&&(o=fy(o,r,t));const l=this.normalizer.normalizePropertyName(a,t);o=this.normalizer.normalizeStyleValue(a,l,o,t),i.set(a,o)})}),i}}class b7{constructor(e,t,i){this.name=e,this.ast=t,this._normalizer=i,this.transitionFactories=[],this.states=new Map,t.states.forEach(r=>{this.states.set(r.name,new y7(r.style,r.options&&r.options.params||{},i))}),k2(this.states,"true","1"),k2(this.states,"false","0"),t.transitions.forEach(r=>{this.transitionFactories.push(new F2(e,r,this.states))}),this.fallbackTransition=function w7(n,e,t){return new F2(n,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,a)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,i,r){return this.transitionFactories.find(o=>o.match(e,t,i,r))||null}matchStyles(e,t,i){return this.fallbackTransition.buildStyles(e,t,i)}}function k2(n,e,t){n.has(e)?n.has(t)||n.set(t,n.get(e)):n.has(t)&&n.set(e,n.get(t))}const E7=new eE;class S7{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,t){const i=[],s=jA(this._driver,t,i,[]);if(i.length)throw function T9(n){return new se(3503,!1)}();this._animations.set(e,s)}_buildPlayer(e,t,i){const r=e.element,s=v2(this._normalizer,e.keyframes,t,i);return this._driver.animate(r,s,e.duration,e.delay,e.easing,[],!0)}create(e,t,i={}){const r=[],s=this._animations.get(e);let o;const a=new Map;if(s?(o=XA(this._driver,t,s,VA,$w,new Map,new Map,i,E7,r),o.forEach(d=>{const h=Ys(a,d.element,new Map);d.postStyleProps.forEach(p=>h.set(p,null))})):(r.push(function A9(){return new se(3300,!1)}()),o=[]),r.length)throw function D9(n){return new se(3504,!1)}();a.forEach((d,h)=>{d.forEach((p,m)=>{d.set(m,this._driver.computeStyle(h,m,Pl))})});const c=Yc(o.map(d=>{const h=a.get(d.element);return this._buildPlayer(d,new Map,h)}));return this._playersById.set(e,c),c.onDestroy(()=>this.destroy(e)),this.players.push(c),c}destroy(e){const t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);const i=this.players.indexOf(t);i>=0&&this.players.splice(i,1)}_getPlayer(e){const t=this._playersById.get(e);if(!t)throw function I9(n){return new se(3301,!1)}();return t}listen(e,t,i,r){const s=kA(t,"","","");return OA(this._getPlayer(e),i,s,r),()=>{}}command(e,t,i,r){if("register"==i)return void this.register(e,r[0]);if("create"==i)return void this.create(e,t,r[0]||{});const s=this._getPlayer(e);switch(i){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}}const U2="ng-animate-queued",JA="ng-animate-disabled",A7=[],B2={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},D7={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},na="__ng_removed";class QA{get params(){return this.options.params}constructor(e,t=""){this.namespaceId=t;const i=e&&e.hasOwnProperty("value");if(this.value=function N7(n){return n??null}(i?e.value:e),i){const s=dy(e);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){const t=e.params;if(t){const i=this.options.params;Object.keys(t).forEach(r=>{null==i[r]&&(i[r]=t[r])})}}}const py="void",eD=new QA(py);class I7{constructor(e,t,i){this.id=e,this.hostElement=t,this._engine=i,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,Eo(t,this._hostClassName)}listen(e,t,i,r){if(!this._triggers.has(t))throw function R9(n,e){return new se(3302,!1)}();if(null==i||0==i.length)throw function P9(n){return new se(3303,!1)}();if(!function L7(n){return"start"==n||"done"==n}(i))throw function N9(n,e){return new se(3400,!1)}();const s=Ys(this._elementListeners,e,[]),o={name:t,phase:i,callback:r};s.push(o);const a=Ys(this._engine.statesByElement,e,new Map);return a.has(t)||(Eo(e,qw),Eo(e,qw+"-"+t),a.set(t,eD)),()=>{this._engine.afterFlush(()=>{const l=s.indexOf(o);l>=0&&s.splice(l,1),this._triggers.has(t)||a.delete(t)})}}register(e,t){return!this._triggers.has(e)&&(this._triggers.set(e,t),!0)}_getTrigger(e){const t=this._triggers.get(e);if(!t)throw function L9(n){return new se(3401,!1)}();return t}trigger(e,t,i,r=!0){const s=this._getTrigger(t),o=new tD(this.id,t,e);let a=this._engine.statesByElement.get(e);a||(Eo(e,qw),Eo(e,qw+"-"+t),this._engine.statesByElement.set(e,a=new Map));let l=a.get(t);const c=new QA(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&l&&c.absorbOptions(l.options),a.set(t,c),l||(l=eD),c.value!==py&&l.value===c.value){if(!function k7(n,e){const t=Object.keys(n),i=Object.keys(e);if(t.length!=i.length)return!1;for(let r=0;r<t.length;r++){const s=t[r];if(!e.hasOwnProperty(s)||n[s]!==e[s])return!1}return!0}(l.params,c.params)){const b=[],v=s.matchStyles(l.value,l.params,b),y=s.matchStyles(c.value,c.params,b);b.length?this._engine.reportError(b):this._engine.afterFlush(()=>{Cd(e,v),Ha(e,y)})}return}const p=Ys(this._engine.playersByElement,e,[]);p.forEach(b=>{b.namespaceId==this.id&&b.triggerName==t&&b.queued&&b.destroy()});let m=s.matchTransition(l.value,c.value,e,c.params),g=!1;if(!m){if(!r)return;m=s.fallbackTransition,g=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:m,fromState:l,toState:c,player:o,isFallbackTransition:g}),g||(Eo(e,U2),o.onStart(()=>{wp(e,U2)})),o.onDone(()=>{let b=this.players.indexOf(o);b>=0&&this.players.splice(b,1);const v=this._engine.playersByElement.get(e);if(v){let y=v.indexOf(o);y>=0&&v.splice(y,1)}}),this.players.push(o),p.push(o),o}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,i)=>{this._elementListeners.set(i,t.filter(r=>r.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(i=>i.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const i=this._engine.driver.query(e,Xw,!0);i.forEach(r=>{if(r[na])return;const s=this._engine.fetchNamespacesByElement(r);s.size?s.forEach(o=>o.triggerLeaveAnimation(r,t,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(e,t,i,r){const s=this._engine.statesByElement.get(e),o=new Map;if(s){const a=[];if(s.forEach((l,c)=>{if(o.set(c,l.value),this._triggers.has(c)){const d=this.trigger(e,c,py,r);d&&a.push(d)}}),a.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,o),i&&Yc(a).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),i=this._engine.statesByElement.get(e);if(t&&i){const r=new Set;t.forEach(s=>{const o=s.name;if(r.has(o))return;r.add(o);const l=this._triggers.get(o).fallbackTransition,c=i.get(o)||eD,d=new QA(py),h=new tD(this.id,o,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:o,transition:l,fromState:c,toState:d,player:h,isFallbackTransition:!0})})}}removeNode(e,t){const i=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let r=!1;if(i.totalAnimations){const s=i.players.length?i.playersByQueriedElement.get(e):[];if(s&&s.length)r=!0;else{let o=e;for(;o=o.parentNode;)if(i.statesByElement.get(o)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(e),r)i.markElementAsRemoved(this.id,e,!1,t);else{const s=e[na];(!s||s===B2)&&(i.afterFlush(()=>this.clearElementCache(e)),i.destroyInnerAnimations(e),i._onRemovalComplete(e,t))}}insertNode(e,t){Eo(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const s=i.element,o=this._elementListeners.get(s);o&&o.forEach(a=>{if(a.name==i.triggerName){const l=kA(s,i.triggerName,i.fromState.value,i.toState.value);l._data=e,OA(i.player,a.phase,l,a.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):t.push(i)}),this._queue=[],t.sort((i,r)=>{const s=i.transition.ast.depCount,o=r.transition.ast.depCount;return 0==s||0==o?s-o:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}}class R7{_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}constructor(e,t,i){this.bodyNode=e,this.driver=t,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,s)=>{}}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(i=>{i.queued&&e.push(i)})}),e}createNamespace(e,t){const i=new I7(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(i,t):(this.newHostElements.set(t,i),this.collectEnterElement(t)),this._namespaceLookup[e]=i}_balanceNamespaceList(e,t){const i=this._namespaceList,r=this.namespacesByHostElement;if(i.length-1>=0){let o=!1,a=this.driver.getParentElement(t);for(;a;){const l=r.get(a);if(l){const c=i.indexOf(l);i.splice(c+1,0,e),o=!0;break}a=this.driver.getParentElement(a)}o||i.unshift(e)}else i.push(e);return r.set(t,e),e}register(e,t){let i=this._namespaceLookup[e];return i||(i=this.createNamespace(e,t)),i}registerTrigger(e,t,i){let r=this._namespaceLookup[e];r&&r.register(t,i)&&this.totalAnimations++}destroy(e,t){e&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const i=this._fetchNamespace(e);this.namespacesByHostElement.delete(i.hostElement);const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1),i.destroy(t),delete this._namespaceLookup[e]}))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,i=this.statesByElement.get(e);if(i)for(let r of i.values())if(r.namespaceId){const s=this._fetchNamespace(r.namespaceId);s&&t.add(s)}return t}trigger(e,t,i,r){if(iE(t)){const s=this._fetchNamespace(e);if(s)return s.trigger(t,i,r),!0}return!1}insertNode(e,t,i,r){if(!iE(t))return;const s=t[na];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const o=this.collectedLeaveElements.indexOf(t);o>=0&&this.collectedLeaveElements.splice(o,1)}if(e){const o=this._fetchNamespace(e);o&&o.insertNode(t,i)}r&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),Eo(e,JA)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),wp(e,JA))}removeNode(e,t,i){if(iE(t)){const r=e?this._fetchNamespace(e):null;r?r.removeNode(t,i):this.markElementAsRemoved(e,t,!1,i);const s=this.namespacesByHostElement.get(t);s&&s.id!==e&&s.removeNode(t,i)}else this._onRemovalComplete(t,i)}markElementAsRemoved(e,t,i,r,s){this.collectedLeaveElements.push(t),t[na]={namespaceId:e,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:s}}listen(e,t,i,r,s){return iE(t)?this._fetchNamespace(e).listen(t,i,r,s):()=>{}}_buildInstruction(e,t,i,r,s){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,i,r,e.fromState.options,e.toState.options,t,s)}destroyInnerAnimations(e){let t=this.driver.query(e,Xw,!0);t.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,HA,!0),t.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return Yc(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e[na];if(t&&t.setForRemoval){if(e[na]=B2,t.namespaceId){this.destroyInnerAnimations(e);const i=this._fetchNamespace(t.namespaceId);i&&i.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(JA)&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)Eo(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{t=this._flushAnimations(i,e)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],t.length?Yc(t).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(e){throw function O9(n){return new se(3402,!1)}()}_flushAnimations(e,t){const i=new eE,r=[],s=new Map,o=[],a=new Map,l=new Map,c=new Map,d=new Set;this.disabledNodes.forEach(j=>{d.add(j);const $=this.driver.query(j,".ng-animate-queued",!0);for(let Q=0;Q<$.length;Q++)d.add($[Q])});const h=this.bodyNode,p=Array.from(this.statesByElement.keys()),m=z2(p,this.collectedEnterElements),g=new Map;let b=0;m.forEach((j,$)=>{const Q=VA+b++;g.set($,Q),j.forEach(K=>Eo(K,Q))});const v=[],y=new Set,w=new Set;for(let j=0;j<this.collectedLeaveElements.length;j++){const $=this.collectedLeaveElements[j],Q=$[na];Q&&Q.setForRemoval&&(v.push($),y.add($),Q.hasAnimation?this.driver.query($,".ng-star-inserted",!0).forEach(K=>y.add(K)):w.add($))}const E=new Map,x=z2(p,Array.from(y));x.forEach((j,$)=>{const Q=$w+b++;E.set($,Q),j.forEach(K=>Eo(K,Q))}),e.push(()=>{m.forEach((j,$)=>{const Q=g.get($);j.forEach(K=>wp(K,Q))}),x.forEach((j,$)=>{const Q=E.get($);j.forEach(K=>wp(K,Q))}),v.forEach(j=>{this.processLeaveNode(j)})});const C=[],A=[];for(let j=this._namespaceList.length-1;j>=0;j--)this._namespaceList[j].drainQueuedTransitions(t).forEach(Q=>{const K=Q.player,ce=Q.element;if(C.push(K),this.collectedEnterElements.length){const Ge=ce[na];if(Ge&&Ge.setForMove){if(Ge.previousTriggersValues&&Ge.previousTriggersValues.has(Q.triggerName)){const Ye=Ge.previousTriggersValues.get(Q.triggerName),_t=this.statesByElement.get(Q.element);if(_t&&_t.has(Q.triggerName)){const qt=_t.get(Q.triggerName);qt.value=Ye,_t.set(Q.triggerName,qt)}}return void K.destroy()}}const q=!h||!this.driver.containsElement(h,ce),oe=E.get(ce),Me=g.get(ce),we=this._buildInstruction(Q,i,Me,oe,q);if(we.errors&&we.errors.length)return void A.push(we);if(q)return K.onStart(()=>Cd(ce,we.fromStyles)),K.onDestroy(()=>Ha(ce,we.toStyles)),void r.push(K);if(Q.isFallbackTransition)return K.onStart(()=>Cd(ce,we.fromStyles)),K.onDestroy(()=>Ha(ce,we.toStyles)),void r.push(K);const ze=[];we.timelines.forEach(Ge=>{Ge.stretchStartingKeyframe=!0,this.disabledNodes.has(Ge.element)||ze.push(Ge)}),we.timelines=ze,i.append(ce,we.timelines),o.push({instruction:we,player:K,element:ce}),we.queriedElements.forEach(Ge=>Ys(a,Ge,[]).push(K)),we.preStyleProps.forEach((Ge,Ye)=>{if(Ge.size){let _t=l.get(Ye);_t||l.set(Ye,_t=new Set),Ge.forEach((qt,rt)=>_t.add(rt))}}),we.postStyleProps.forEach((Ge,Ye)=>{let _t=c.get(Ye);_t||c.set(Ye,_t=new Set),Ge.forEach((qt,rt)=>_t.add(rt))})});if(A.length){const j=[];A.forEach($=>{j.push(function F9(n,e){return new se(3505,!1)}())}),C.forEach($=>$.destroy()),this.reportError(j)}const D=new Map,O=new Map;o.forEach(j=>{const $=j.element;i.has($)&&(O.set($,$),this._beforeAnimationBuild(j.player.namespaceId,j.instruction,D))}),r.forEach(j=>{const $=j.element;this._getPreviousPlayers($,!1,j.namespaceId,j.triggerName,null).forEach(K=>{Ys(D,$,[]).push(K),K.destroy()})});const T=v.filter(j=>W2(j,l,c)),L=new Map;H2(L,this.driver,w,c,Pl).forEach(j=>{W2(j,l,c)&&T.push(j)});const re=new Map;m.forEach((j,$)=>{H2(re,this.driver,new Set(j),l,"!")}),T.forEach(j=>{const $=L.get(j),Q=re.get(j);L.set(j,new Map([...$?.entries()??[],...Q?.entries()??[]]))});const ae=[],H=[],J={};o.forEach(j=>{const{element:$,player:Q,instruction:K}=j;if(i.has($)){if(d.has($))return Q.onDestroy(()=>Ha($,K.toStyles)),Q.disabled=!0,Q.overrideTotalTime(K.totalTime),void r.push(Q);let ce=J;if(O.size>1){let oe=$;const Me=[];for(;oe=oe.parentNode;){const we=O.get(oe);if(we){ce=we;break}Me.push(oe)}Me.forEach(we=>O.set(we,ce))}const q=this._buildAnimation(Q.namespaceId,K,D,s,re,L);if(Q.setRealPlayer(q),ce===J)ae.push(Q);else{const oe=this.playersByElement.get(ce);oe&&oe.length&&(Q.parentPlayer=Yc(oe)),r.push(Q)}}else Cd($,K.fromStyles),Q.onDestroy(()=>Ha($,K.toStyles)),H.push(Q),d.has($)&&r.push(Q)}),H.forEach(j=>{const $=s.get(j.element);if($&&$.length){const Q=Yc($);j.setRealPlayer(Q)}}),r.forEach(j=>{j.parentPlayer?j.syncPlayerEvents(j.parentPlayer):j.destroy()});for(let j=0;j<v.length;j++){const $=v[j],Q=$[na];if(wp($,$w),Q&&Q.hasAnimation)continue;let K=[];if(a.size){let q=a.get($);q&&q.length&&K.push(...q);let oe=this.driver.query($,HA,!0);for(let Me=0;Me<oe.length;Me++){let we=a.get(oe[Me]);we&&we.length&&K.push(...we)}}const ce=K.filter(q=>!q.destroyed);ce.length?O7(this,$,ce):this.processLeaveNode($)}return v.length=0,ae.forEach(j=>{this.players.push(j),j.onDone(()=>{j.destroy();const $=this.players.indexOf(j);this.players.splice($,1)}),j.play()}),ae}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,i,r,s){let o=[];if(t){const a=this.playersByQueriedElement.get(e);a&&(o=a)}else{const a=this.playersByElement.get(e);if(a){const l=!s||s==py;a.forEach(c=>{c.queued||!l&&c.triggerName!=r||o.push(c)})}}return(i||r)&&(o=o.filter(a=>!(i&&i!=a.namespaceId||r&&r!=a.triggerName))),o}_beforeAnimationBuild(e,t,i){const s=t.element,o=t.isRemovalTransition?void 0:e,a=t.isRemovalTransition?void 0:t.triggerName;for(const l of t.timelines){const c=l.element,d=c!==s,h=Ys(i,c,[]);this._getPreviousPlayers(c,d,o,a,t.toState).forEach(m=>{const g=m.getRealPlayer();g.beforeDestroy&&g.beforeDestroy(),m.destroy(),h.push(m)})}Cd(s,t.fromStyles)}_buildAnimation(e,t,i,r,s,o){const a=t.triggerName,l=t.element,c=[],d=new Set,h=new Set,p=t.timelines.map(g=>{const b=g.element;d.add(b);const v=b[na];if(v&&v.removedBeforeQueried)return new uy(g.duration,g.delay);const y=b!==l,w=function F7(n){const e=[];return G2(n,e),e}((i.get(b)||A7).map(D=>D.getRealPlayer())).filter(D=>!!D.element&&D.element===b),E=s.get(b),x=o.get(b),C=v2(this._normalizer,g.keyframes,E,x),A=this._buildPlayer(g,C,w);if(g.subTimeline&&r&&h.add(b),y){const D=new tD(e,a,b);D.setRealPlayer(A),c.push(D)}return A});c.forEach(g=>{Ys(this.playersByQueriedElement,g.element,[]).push(g),g.onDone(()=>function P7(n,e,t){let i=n.get(e);if(i){if(i.length){const r=i.indexOf(t);i.splice(r,1)}0==i.length&&n.delete(e)}return i}(this.playersByQueriedElement,g.element,g))}),d.forEach(g=>Eo(g,C2));const m=Yc(p);return m.onDestroy(()=>{d.forEach(g=>wp(g,C2)),Ha(l,t.toStyles)}),h.forEach(g=>{Ys(r,g,[]).push(m)}),m}_buildPlayer(e,t,i){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,i):new uy(e.duration,e.delay)}}class tD{constructor(e,t,i){this.namespaceId=e,this.triggerName=t,this.element=i,this._player=new uy,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,i)=>{t.forEach(r=>OA(e,i,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){Ys(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function iE(n){return n&&1===n.nodeType}function V2(n,e){const t=n.style.display;return n.style.display=e??"none",t}function H2(n,e,t,i,r){const s=[];t.forEach(l=>s.push(V2(l)));const o=[];i.forEach((l,c)=>{const d=new Map;l.forEach(h=>{const p=e.computeStyle(c,h,r);d.set(h,p),(!p||0==p.length)&&(c[na]=D7,o.push(c))}),n.set(c,d)});let a=0;return t.forEach(l=>V2(l,s[a++])),o}function z2(n,e){const t=new Map;if(n.forEach(a=>t.set(a,[])),0==e.length)return t;const r=new Set(e),s=new Map;function o(a){if(!a)return 1;let l=s.get(a);if(l)return l;const c=a.parentNode;return l=t.has(c)?c:r.has(c)?1:o(c),s.set(a,l),l}return e.forEach(a=>{const l=o(a);1!==l&&t.get(l).push(a)}),t}function Eo(n,e){n.classList?.add(e)}function wp(n,e){n.classList?.remove(e)}function O7(n,e,t){Yc(t).onDone(()=>n.processLeaveNode(e))}function G2(n,e){for(let t=0;t<n.length;t++){const i=n[t];i instanceof _2?G2(i.players,e):e.push(i)}}function W2(n,e,t){const i=t.get(n);if(!i)return!1;let r=e.get(n);return r?i.forEach(s=>r.add(s)):e.set(n,i),t.delete(n),!0}class rE{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(r,s)=>{},this._transitionEngine=new R7(e,t,i),this._timelineEngine=new S7(e,t,i),this._transitionEngine.onRemovalComplete=(r,s)=>this.onRemovalComplete(r,s)}registerTrigger(e,t,i,r,s){const o=e+"-"+r;let a=this._triggerCache[o];if(!a){const l=[],d=jA(this._driver,s,l,[]);if(l.length)throw function M9(n,e){return new se(3404,!1)}();a=function v7(n,e,t){return new b7(n,e,t)}(r,d,this._normalizer),this._triggerCache[o]=a}this._transitionEngine.registerTrigger(t,r,a)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,i,r){this._transitionEngine.insertNode(e,t,i,r)}onRemove(e,t,i){this._transitionEngine.removeNode(e,t,i)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,i,r){if("@"==i.charAt(0)){const[s,o]=b2(i);this._timelineEngine.command(s,t,o,r)}else this._transitionEngine.trigger(e,t,i,r)}listen(e,t,i,r,s){if("@"==i.charAt(0)){const[o,a]=b2(i);return this._timelineEngine.listen(o,t,a,s)}return this._transitionEngine.listen(e,t,i,r,s)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(e){this._transitionEngine.afterFlushAnimationsDone(e)}}let B7=(()=>{class n{static#e=this.initialStylesByElement=new WeakMap;constructor(t,i,r){this._element=t,this._startStyles=i,this._endStyles=r,this._state=0;let s=n.initialStylesByElement.get(t);s||n.initialStylesByElement.set(t,s=new Map),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&Ha(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Ha(this._element,this._initialStyles),this._endStyles&&(Ha(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(Cd(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Cd(this._element,this._endStyles),this._endStyles=null),Ha(this._element,this._initialStyles),this._state=3)}}return n})();function nD(n){let e=null;return n.forEach((t,i)=>{(function V7(n){return"display"===n||"position"===n})(i)&&(e=e||new Map,e.set(i,t))}),e}class j2{constructor(e,t,i,r){this.element=e,this.keyframes=t,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){const t=[];return e.forEach(i=>{t.push(Object.fromEntries(i))}),t}_triggerWebAnimation(e,t,i){return e.animate(this._convertKeyframesToObject(t),i)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((i,r)=>{"offset"!==r&&e.set(r,this._finished?i:I2(this.element,r))}),this.currentSnapshot=e}triggerCallback(e){const t="start"===e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class H7{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}matchesElement(e,t){return!1}containsElement(e,t){return E2(e,t)}getParentElement(e){return UA(e)}query(e,t,i){return S2(e,t,i)}computeStyle(e,t,i){return window.getComputedStyle(e)[t]}animate(e,t,i,r,s,o=[]){const l={duration:i,delay:r,fill:0==r?"both":"forwards"};s&&(l.easing=s);const c=new Map,d=o.filter(m=>m instanceof j2);(function X9(n,e){return 0===n||0===e})(i,r)&&d.forEach(m=>{m.currentSnapshot.forEach((g,b)=>c.set(b,g))});let h=function j9(n){return n.length?n[0]instanceof Map?n:n.map(e=>T2(e)):[]}(t).map(m=>Zc(m));h=function Y9(n,e,t){if(t.size&&e.length){let i=e[0],r=[];if(t.forEach((s,o)=>{i.has(o)||r.push(o),i.set(o,s)}),r.length)for(let s=1;s<e.length;s++){let o=e[s];r.forEach(a=>o.set(a,I2(n,a)))}}return e}(e,h,c);const p=function U7(n,e){let t=null,i=null;return Array.isArray(e)&&e.length?(t=nD(e[0]),e.length>1&&(i=nD(e[e.length-1]))):e instanceof Map&&(t=nD(e)),t||i?new B7(n,t,i):null}(e,h);return new j2(e,h,l,p)}}let z7=(()=>{class n extends p2{constructor(t,i){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(i.body,{id:"0",encapsulation:ws.None,styles:[],data:{animation:[]}})}build(t){const i=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(t)?m2(t):t;return $2(this._renderer,null,i,"register",[r]),new G7(i,this._renderer)}static#e=this.\u0275fac=function(i){return new(i||n)(Le(Fn),Le(kr))};static#t=this.\u0275prov=Ke({token:n,factory:n.\u0275fac})}return n})();class G7 extends i9{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new W7(this._id,e,t||{},this._renderer)}}class W7{constructor(e,t,i,r){this.id=e,this.element=t,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return $2(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function $2(n,e,t,i,r){return n.setProperty(e,`@@${t}:${i}`,r)}const q2="@.disabled";let j7=(()=>{class n{constructor(t,i,r){this.delegate=t,this.engine=i,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,i.onRemovalComplete=(s,o)=>{const a=o?.parentNode(s);a&&o.removeChild(a,s)}}createRenderer(t,i){const s=this.delegate.createRenderer(t,i);if(!(t&&i&&i.data&&i.data.animation)){let d=this._rendererCache.get(s);return d||(d=new X2("",s,this.engine,()=>this._rendererCache.delete(s)),this._rendererCache.set(s,d)),d}const o=i.id,a=i.id+"-"+this._currentId;this._currentId++,this.engine.register(a,t);const l=d=>{Array.isArray(d)?d.forEach(l):this.engine.registerTrigger(o,a,t,d.name,d)};return i.data.animation.forEach(l),new $7(this,a,s,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(t,i,r){t>=0&&t<this._microtaskId?this._zone.run(()=>i(r)):(0==this._animationCallbacksBuffer.length&&queueMicrotask(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(s=>{const[o,a]=s;o(a)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}static#e=this.\u0275fac=function(i){return new(i||n)(Le(Fn),Le(rE),Le(Mn))};static#t=this.\u0275prov=Ke({token:n,factory:n.\u0275fac})}return n})();class X2{constructor(e,t,i,r){this.namespaceId=e,this.delegate=t,this.engine=i,this._onDestroy=r}get data(){return this.delegate.data}destroyNode(e){this.delegate.destroyNode?.(e)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,i,r=!0){this.delegate.insertBefore(e,t,i),this.engine.onInsert(this.namespaceId,t,e,r)}removeChild(e,t,i){this.engine.onRemove(this.namespaceId,t,this.delegate)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,i,r){this.delegate.setAttribute(e,t,i,r)}removeAttribute(e,t,i){this.delegate.removeAttribute(e,t,i)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,i,r){this.delegate.setStyle(e,t,i,r)}removeStyle(e,t,i){this.delegate.removeStyle(e,t,i)}setProperty(e,t,i){"@"==t.charAt(0)&&t==q2?this.disableAnimations(e,!!i):this.delegate.setProperty(e,t,i)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,i){return this.delegate.listen(e,t,i)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class $7 extends X2{constructor(e,t,i,r,s){super(t,i,r,s),this.factory=e,this.namespaceId=t}setProperty(e,t,i){"@"==t.charAt(0)?"."==t.charAt(1)&&t==q2?this.disableAnimations(e,i=void 0===i||!!i):this.engine.process(this.namespaceId,e,t.slice(1),i):this.delegate.setProperty(e,t,i)}listen(e,t,i){if("@"==t.charAt(0)){const r=function q7(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(e);let s=t.slice(1),o="";return"@"!=s.charAt(0)&&([s,o]=function X7(n){const e=n.indexOf(".");return[n.substring(0,e),n.slice(e+1)]}(s)),this.engine.listen(this.namespaceId,r,s,o,a=>{this.factory.scheduleListenerCallback(a._data||-1,i,a)})}return this.delegate.listen(e,t,i)}}let Y7=(()=>{class n extends rE{constructor(t,i,r,s){super(t.body,i,r)}ngOnDestroy(){this.flush()}static#e=this.\u0275fac=function(i){return new(i||n)(Le(kr),Le(BA),Le(ZA),Le(Ed))};static#t=this.\u0275prov=Ke({token:n,factory:n.\u0275fac})}return n})();const Y2=[{provide:p2,useClass:z7},{provide:ZA,useFactory:function Z7(){return new m7}},{provide:rE,useClass:Y7},{provide:Fn,useFactory:function K7(n,e,t){return new j7(n,e,t)},deps:[DA,rE,Mn]}],iD=[{provide:BA,useFactory:()=>new H7},{provide:Xb,useValue:"BrowserAnimations"},...Y2],Z2=[{provide:BA,useClass:x2},{provide:Xb,useValue:"NoopAnimations"},...Y2];let J7=(()=>{class n{static withConfig(t){return{ngModule:n,providers:t.disableAnimations?Z2:iD}}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Fi({type:n});static#n=this.\u0275inj=Ci({providers:iD,imports:[u2]})}return n})();const{isArray:Q7}=Array,{getPrototypeOf:eq,prototype:tq,keys:nq}=Object;function K2(n){if(1===n.length){const e=n[0];if(Q7(e))return{args:e,keys:null};if(function iq(n){return n&&"object"==typeof n&&eq(n)===tq}(e)){const t=nq(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}const{isArray:rq}=Array;function J2(n){return Jt(e=>function sq(n,e){return rq(e)?n(...e):n(e)}(n,e))}function Q2(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}let ek=(()=>{class n{constructor(t,i){this._renderer=t,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static#e=this.\u0275fac=function(i){return new(i||n)(le(mi),le(bn))};static#t=this.\u0275dir=ft({type:n})}return n})(),Ad=(()=>{class n extends ek{static#e=this.\u0275fac=function(){let t;return function(r){return(t||(t=fi(n)))(r||n)}}();static#t=this.\u0275dir=ft({type:n,features:[mn]})}return n})();const ia=new qe("NgValueAccessor"),lq={provide:ia,useExisting:fn(()=>oE),multi:!0},uq=new qe("CompositionEventMode");let oE=(()=>{class n extends ek{constructor(t,i,r){super(t,i),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function cq(){const n=qc()?qc().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(t){this.setProperty("value",t??"")}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static#e=this.\u0275fac=function(i){return new(i||n)(le(mi),le(bn),le(uq,8))};static#t=this.\u0275dir=ft({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,r){1&i&&wn("input",function(o){return r._handleInput(o.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(o){return r._compositionEnd(o.target.value)})},features:[kn([lq]),mn]})}return n})();const Ur=new qe("NgValidators"),Jc=new qe("NgAsyncValidators");function dk(n){return null!=n}function hk(n){return W_(n)?hi(n):n}function fk(n){let e={};return n.forEach(t=>{e=null!=t?{...e,...t}:e}),0===Object.keys(e).length?null:e}function pk(n,e){return e.map(t=>t(n))}function mk(n){return n.map(e=>function hq(n){return!n.validate}(e)?e:t=>e.validate(t))}function rD(n){return null!=n?function gk(n){if(!n)return null;const e=n.filter(dk);return 0==e.length?null:function(t){return fk(pk(t,e))}}(mk(n)):null}function sD(n){return null!=n?function _k(n){if(!n)return null;const e=n.filter(dk);return 0==e.length?null:function(t){return function oq(...n){const e=Tu(n),{args:t,keys:i}=K2(n),r=new Sn(s=>{const{length:o}=t;if(!o)return void s.complete();const a=new Array(o);let l=o,c=o;for(let d=0;d<o;d++){let h=!1;Yr(t[d]).subscribe(Zn(s,p=>{h||(h=!0,c--),a[d]=p},()=>l--,void 0,()=>{(!l||!h)&&(c||s.next(i?Q2(i,a):a),s.complete())}))}});return e?r.pipe(J2(e)):r}(pk(t,e).map(hk)).pipe(Jt(fk))}}(mk(n)):null}function yk(n,e){return null===n?[e]:Array.isArray(n)?[...n,e]:[n,e]}function oD(n){return n?Array.isArray(n)?n:[n]:[]}function lE(n,e){return Array.isArray(n)?n.includes(e):n===e}function wk(n,e){const t=oD(e);return oD(n).forEach(r=>{lE(t,r)||t.push(r)}),t}function Ek(n,e){return oD(e).filter(t=>!lE(n,t))}class Sk{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=rD(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=sD(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class us extends Sk{get formDirective(){return null}get path(){return null}}class Qc extends Sk{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class xk{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let Mk=(()=>{class n extends xk{constructor(t){super(t)}static#e=this.\u0275fac=function(i){return new(i||n)(le(Qc,2))};static#t=this.\u0275dir=ft({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,r){2&i&&j_("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[mn]})}return n})();const my="VALID",uE="INVALID",Ep="PENDING",gy="DISABLED";function dE(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}class Dk{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===my}get invalid(){return this.status===uE}get pending(){return this.status==Ep}get disabled(){return this.status===gy}get enabled(){return this.status!==gy}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(wk(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(wk(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(Ek(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(Ek(e,this._rawAsyncValidators))}hasValidator(e){return lE(this._rawValidators,e)}hasAsyncValidator(e){return lE(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=Ep,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=gy,this.errors=null,this._forEachChild(i=>{i.disable({...e,onlySelf:!0})}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=my,this._forEachChild(i=>{i.enable({...e,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===my||this.status===Ep)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?gy:my}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=Ep,this._hasOwnPendingAsyncValidator=!0;const t=hk(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){let t=e;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((i,r)=>i&&i._find(r),this)}getError(e,t){const i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new $n,this.statusChanges=new $n}_calculateStatus(){return this._allControlsDisabled()?gy:this.errors?uE:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Ep)?Ep:this._anyControlsHaveStatus(uE)?uE:my}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){dE(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=function _q(n){return Array.isArray(n)?rD(n):n||null}(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=function yq(n){return Array.isArray(n)?sD(n):n||null}(this._rawAsyncValidators)}}const Sp=new qe("CallSetDisabledState",{providedIn:"root",factory:()=>hE}),hE="always";function _y(n,e,t=hE){(function hD(n,e){const t=function vk(n){return n._rawValidators}(n);null!==e.validator?n.setValidators(yk(t,e.validator)):"function"==typeof t&&n.setValidators([t]);const i=function bk(n){return n._rawAsyncValidators}(n);null!==e.asyncValidator?n.setAsyncValidators(yk(i,e.asyncValidator)):"function"==typeof i&&n.setAsyncValidators([i]);const r=()=>n.updateValueAndValidity();mE(e._rawValidators,r),mE(e._rawAsyncValidators,r)})(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||"always"===t)&&e.valueAccessor.setDisabledState?.(n.disabled),function wq(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&Ik(n,e)})}(n,e),function Sq(n,e){const t=(i,r)=>{e.valueAccessor.writeValue(i),r&&e.viewToModelUpdate(i)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}(n,e),function Eq(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&Ik(n,e),"submit"!==n.updateOn&&n.markAsTouched()})}(n,e),function bq(n,e){if(e.valueAccessor.setDisabledState){const t=i=>{e.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}(n,e)}function mE(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function Ik(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function Nk(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}function Lk(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}const Ok=class extends Dk{constructor(e=null,t,i){super(function cD(n){return(dE(n)?n.validators:n)||null}(t),function uD(n,e){return(dE(e)?e.asyncValidators:n)||null}(i,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),dE(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=Lk(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Nk(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Nk(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){Lk(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}},Rq={provide:Qc,useExisting:fn(()=>_D)},Uk=(()=>Promise.resolve())();let _D=(()=>{class n extends Qc{constructor(t,i,r,s,o,a){super(),this._changeDetectorRef=o,this.callSetDisabledState=a,this.control=new Ok,this._registered=!1,this.name="",this.update=new $n,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=function mD(n,e){if(!e)return null;let t,i,r;return Array.isArray(e),e.forEach(s=>{s.constructor===oE?t=s:function Cq(n){return Object.getPrototypeOf(n.constructor)===Ad}(s)?i=s:r=s}),r||i||t||null}(0,s)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){const i=t.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),function pD(n,e){if(!n.hasOwnProperty("model"))return!1;const t=n.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){_y(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){Uk.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){const i=t.isDisabled.currentValue,r=0!==i&&function yp(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}(i);Uk.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?function fE(n,e){return[...e.path,n]}(t,this._parent):[t]}static#e=this.\u0275fac=function(i){return new(i||n)(le(us,9),le(Ur,10),le(Jc,10),le(ia,10),le(iy,8),le(Sp,8))};static#t=this.\u0275dir=ft({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[kn([Rq]),mn,Vi]})}return n})(),Vk=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Fi({type:n});static#n=this.\u0275inj=Ci({})}return n})(),nX=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Fi({type:n});static#n=this.\u0275inj=Ci({imports:[Vk]})}return n})(),rX=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:Sp,useValue:t.callSetDisabledState??hE}]}}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Fi({type:n});static#n=this.\u0275inj=Ci({imports:[nX]})}return n})();function xD(...n){const e=Au(n),t=Tu(n),{args:i,keys:r}=K2(n);if(0===i.length)return hi([],e);const s=new Sn(function oX(n,e,t=No){return i=>{rU(e,()=>{const{length:r}=n,s=new Array(r);let o=r,a=r;for(let l=0;l<r;l++)rU(e,()=>{const c=hi(n[l],e);let d=!1;c.subscribe(Zn(i,h=>{s[l]=h,d||(d=!0,a--),a||i.next(t(s.slice()))},()=>{--o||i.complete()}))},i)},i)}}(i,e,r?o=>Q2(r,o):No));return t?s.pipe(J2(t)):s}function rU(n,e,t){n?ao(t,n,e):e()}const _E=B(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function MD(...n){return function aX(){return lc(1)}()(hi(n,Au(n)))}function sU(n){return new Sn(e=>{Yr(n()).subscribe(e)})}function vy(n,e){const t=hn(n)?n:()=>n,i=r=>r.error(t());return new Sn(e?r=>e.schedule(i,0,r):i)}function CD(){return Hn((n,e)=>{let t=null;n._refCount++;const i=Zn(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const r=n._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});n.subscribe(i),i.closed||(t=n.connect())})}class oU extends Sn{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Nv(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new jr;const t=this.getSubject();e.add(this.source.subscribe(Zn(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=jr.EMPTY)}return e}refCount(){return CD()(this)}}function xp(n){return n<=0?()=>lo:Hn((e,t)=>{let i=0;e.subscribe(Zn(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function Ll(n,e){return Hn((t,i)=>{let r=0;t.subscribe(Zn(i,s=>n.call(e,s,r++)&&i.next(s)))})}function yE(n){return Hn((e,t)=>{let i=!1;e.subscribe(Zn(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function aU(n=cX){return Hn((e,t)=>{let i=!1;e.subscribe(Zn(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function cX(){return new _E}function Id(n,e){const t=arguments.length>=2;return i=>i.pipe(n?Ll((r,s)=>n(r,s,i)):No,xp(1),t?yE(e):aU(()=>new _E))}function Mp(n,e){return hn(e)?Zi(n,e,1):Zi(n,1)}function Br(n,e,t){const i=hn(n)||e||t?{next:n,error:e,complete:t}:n;return i?Hn((r,s)=>{var o;null===(o=i.subscribe)||void 0===o||o.call(i);let a=!0;r.subscribe(Zn(s,l=>{var c;null===(c=i.next)||void 0===c||c.call(i,l),s.next(l)},()=>{var l;a=!1,null===(l=i.complete)||void 0===l||l.call(i),s.complete()},l=>{var c;a=!1,null===(c=i.error)||void 0===c||c.call(i,l),s.error(l)},()=>{var l,c;a&&(null===(l=i.unsubscribe)||void 0===l||l.call(i)),null===(c=i.finalize)||void 0===c||c.call(i)}))}):No}function Rd(n){return Hn((e,t)=>{let s,i=null,r=!1;i=e.subscribe(Zn(t,void 0,void 0,o=>{s=Yr(n(o,Rd(n)(e))),i?(i.unsubscribe(),i=null,s.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,s.subscribe(t))})}function TD(n){return n<=0?()=>lo:Hn((e,t)=>{let i=[];e.subscribe(Zn(t,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(const r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function by(n){return Hn((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function lU(n){return Hn((e,t)=>{Yr(n).subscribe(Zn(t,()=>t.complete(),mh)),!t.closed&&e.subscribe(t)})}const Ht="primary",wy=Symbol("RouteTitle");class pX{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function Cp(n){return new pX(n)}function mX(n,e,t){const i=t.path.split("/");if(i.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||i.length<n.length))return null;const r={};for(let s=0;s<i.length;s++){const o=i[s],a=n[s];if(o.startsWith(":"))r[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function za(n,e){const t=n?Object.keys(n):void 0,i=e?Object.keys(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!cU(n[r],e[r]))return!1;return!0}function cU(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),i=[...e].sort();return t.every((r,s)=>i[s]===r)}return n===e}function uU(n){return n.length>0?n[n.length-1]:null}function eu(n){return function sX(n){return!!n&&(n instanceof Sn||hn(n.lift)&&hn(n.subscribe))}(n)?n:W_(n)?hi(Promise.resolve(n)):pt(n)}const _X={exact:function fU(n,e,t){if(!Pd(n.segments,e.segments)||!vE(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const i in e.children)if(!n.children[i]||!fU(n.children[i],e.children[i],t))return!1;return!0},subset:pU},dU={exact:function yX(n,e){return za(n,e)},subset:function vX(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>cU(n[t],e[t]))},ignored:()=>!0};function hU(n,e,t){return _X[t.paths](n.root,e.root,t.matrixParams)&&dU[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function pU(n,e,t){return mU(n,e,e.segments,t)}function mU(n,e,t,i){if(n.segments.length>t.length){const r=n.segments.slice(0,t.length);return!(!Pd(r,t)||e.hasChildren()||!vE(r,t,i))}if(n.segments.length===t.length){if(!Pd(n.segments,t)||!vE(n.segments,t,i))return!1;for(const r in e.children)if(!n.children[r]||!pU(n.children[r],e.children[r],i))return!1;return!0}{const r=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!!(Pd(n.segments,r)&&vE(n.segments,r,i)&&n.children[Ht])&&mU(n.children[Ht],e,s,i)}}function vE(n,e,t){return e.every((i,r)=>dU[t](n[r].parameters,i.parameters))}class Tp{constructor(e=new Cn([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Cp(this.queryParams)),this._queryParamMap}toString(){return EX.serialize(this)}}class Cn{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return bE(this)}}class Ey{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=Cp(this.parameters)),this._parameterMap}toString(){return yU(this)}}function Pd(n,e){return n.length===e.length&&n.every((t,i)=>t.path===e[i].path)}let Sy=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Ke({token:n,factory:function(){return new AD},providedIn:"root"})}return n})();class AD{parse(e){const t=new NX(e);return new Tp(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${xy(e.root,!0)}`,i=function MX(n){const e=Object.keys(n).map(t=>{const i=n[t];return Array.isArray(i)?i.map(r=>`${wE(t)}=${wE(r)}`).join("&"):`${wE(t)}=${wE(i)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${i}${"string"==typeof e.fragment?`#${function SX(n){return encodeURI(n)}(e.fragment)}`:""}`}}const EX=new AD;function bE(n){return n.segments.map(e=>yU(e)).join("/")}function xy(n,e){if(!n.hasChildren())return bE(n);if(e){const t=n.children[Ht]?xy(n.children[Ht],!1):"",i=[];return Object.entries(n.children).forEach(([r,s])=>{r!==Ht&&i.push(`${r}:${xy(s,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}{const t=function wX(n,e){let t=[];return Object.entries(n.children).forEach(([i,r])=>{i===Ht&&(t=t.concat(e(r,i)))}),Object.entries(n.children).forEach(([i,r])=>{i!==Ht&&(t=t.concat(e(r,i)))}),t}(n,(i,r)=>r===Ht?[xy(n.children[Ht],!1)]:[`${r}:${xy(i,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[Ht]?`${bE(n)}/${t[0]}`:`${bE(n)}/(${t.join("//")})`}}function gU(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function wE(n){return gU(n).replace(/%3B/gi,";")}function DD(n){return gU(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function EE(n){return decodeURIComponent(n)}function _U(n){return EE(n.replace(/\+/g,"%20"))}function yU(n){return`${DD(n.path)}${function xX(n){return Object.keys(n).map(e=>`;${DD(e)}=${DD(n[e])}`).join("")}(n.parameters)}`}const CX=/^[^\/()?;#]+/;function ID(n){const e=n.match(CX);return e?e[0]:""}const TX=/^[^\/()?;=#]+/,DX=/^[^=?&#]+/,RX=/^[^&#]+/;class NX{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Cn([],{}):new Cn([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[Ht]=new Cn(e,t)),i}parseSegment(){const e=ID(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new se(4009,!1);return this.capture(e),new Ey(EE(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=function AX(n){const e=n.match(TX);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const r=ID(this.remaining);r&&(i=r,this.capture(i))}e[EE(t)]=EE(i)}parseQueryParam(e){const t=function IX(n){const e=n.match(DX);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const o=function PX(n){const e=n.match(RX);return e?e[0]:""}(this.remaining);o&&(i=o,this.capture(i))}const r=_U(t),s=_U(i);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=ID(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new se(4010,!1);let s;i.indexOf(":")>-1?(s=i.slice(0,i.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=Ht);const o=this.parseChildren();t[s]=1===Object.keys(o).length?o[Ht]:new Cn([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new se(4011,!1)}}function vU(n){return n.segments.length>0?new Cn([],{[Ht]:n}):n}function bU(n){const e={};for(const i of Object.keys(n.children)){const s=bU(n.children[i]);if(i===Ht&&0===s.segments.length&&s.hasChildren())for(const[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[i]=s)}return function LX(n){if(1===n.numberOfChildren&&n.children[Ht]){const e=n.children[Ht];return new Cn(n.segments.concat(e.segments),e.children)}return n}(new Cn(n.segments,e))}function Nd(n){return n instanceof Tp}function wU(n){let e;const r=vU(function t(s){const o={};for(const l of s.children){const c=t(l);o[l.outlet]=c}const a=new Cn(s.url,o);return s===n&&(e=a),a}(n.root));return e??r}function EU(n,e,t,i){let r=n;for(;r.parent;)r=r.parent;if(0===e.length)return RD(r,r,r,t,i);const s=function FX(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new xU(!0,0,n);let e=0,t=!1;const i=n.reduce((r,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return Object.entries(s.outlets).forEach(([l,c])=>{a[l]="string"==typeof c?c.split("/"):c}),[...r,{outlets:a}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===o?(s.split("/").forEach((a,l)=>{0==l&&"."===a||(0==l&&""===a?t=!0:".."===a?e++:""!=a&&r.push(a))}),r):[...r,s]},[]);return new xU(t,e,i)}(e);if(s.toRoot())return RD(r,r,new Cn([],{}),t,i);const o=function kX(n,e,t){if(n.isAbsolute)return new xE(e,!0,0);if(!t)return new xE(e,!1,NaN);if(null===t.parent)return new xE(t,!0,0);const i=SE(n.commands[0])?0:1;return function UX(n,e,t){let i=n,r=e,s=t;for(;s>r;){if(s-=r,i=i.parent,!i)throw new se(4005,!1);r=i.segments.length}return new xE(i,!1,r-s)}(t,t.segments.length-1+i,n.numberOfDoubleDots)}(s,r,n),a=o.processChildren?Cy(o.segmentGroup,o.index,s.commands):MU(o.segmentGroup,o.index,s.commands);return RD(r,o.segmentGroup,a,t,i)}function SE(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function My(n){return"object"==typeof n&&null!=n&&n.outlets}function RD(n,e,t,i,r){let o,s={};i&&Object.entries(i).forEach(([l,c])=>{s[l]=Array.isArray(c)?c.map(d=>`${d}`):`${c}`}),o=n===e?t:SU(n,e,t);const a=vU(bU(o));return new Tp(a,s,r)}function SU(n,e,t){const i={};return Object.entries(n.children).forEach(([r,s])=>{i[r]=s===e?t:SU(s,e,t)}),new Cn(n.segments,i)}class xU{constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&SE(i[0]))throw new se(4003,!1);const r=i.find(My);if(r&&r!==uU(i))throw new se(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class xE{constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}}function MU(n,e,t){if(n||(n=new Cn([],{})),0===n.segments.length&&n.hasChildren())return Cy(n,e,t);const i=function VX(n,e,t){let i=0,r=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return s;const o=n.segments[r],a=t[i];if(My(a))break;const l=`${a}`,c=i<t.length-1?t[i+1]:null;if(r>0&&void 0===l)break;if(l&&c&&"object"==typeof c&&void 0===c.outlets){if(!TU(l,c,o))return s;i+=2}else{if(!TU(l,{},o))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){const s=new Cn(n.segments.slice(0,i.pathIndex),{});return s.children[Ht]=new Cn(n.segments.slice(i.pathIndex),n.children),Cy(s,0,r)}return i.match&&0===r.length?new Cn(n.segments,{}):i.match&&!n.hasChildren()?PD(n,e,t):i.match?Cy(n,0,r):PD(n,e,t)}function Cy(n,e,t){if(0===t.length)return new Cn(n.segments,{});{const i=function BX(n){return My(n[0])?n[0].outlets:{[Ht]:n}}(t),r={};if(Object.keys(i).some(s=>s!==Ht)&&n.children[Ht]&&1===n.numberOfChildren&&0===n.children[Ht].segments.length){const s=Cy(n.children[Ht],e,t);return new Cn(n.segments,s.children)}return Object.entries(i).forEach(([s,o])=>{"string"==typeof o&&(o=[o]),null!==o&&(r[s]=MU(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{void 0===i[s]&&(r[s]=o)}),new Cn(n.segments,r)}}function PD(n,e,t){const i=n.segments.slice(0,e);let r=0;for(;r<t.length;){const s=t[r];if(My(s)){const l=HX(s.outlets);return new Cn(i,l)}if(0===r&&SE(t[0])){i.push(new Ey(n.segments[e].path,CU(t[0]))),r++;continue}const o=My(s)?s.outlets[Ht]:`${s}`,a=r<t.length-1?t[r+1]:null;o&&a&&SE(a)?(i.push(new Ey(o,CU(a))),r+=2):(i.push(new Ey(o,{})),r++)}return new Cn(i,{})}function HX(n){const e={};return Object.entries(n).forEach(([t,i])=>{"string"==typeof i&&(i=[i]),null!==i&&(e[t]=PD(new Cn([],{}),0,i))}),e}function CU(n){const e={};return Object.entries(n).forEach(([t,i])=>e[t]=`${i}`),e}function TU(n,e,t){return n==t.path&&za(e,t.parameters)}const Ty="imperative";class Ga{constructor(e,t){this.id=e,this.url=t}}class ME extends Ga{constructor(e,t,i="imperative",r=null){super(e,t),this.type=0,this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class tu extends Ga{constructor(e,t,i){super(e,t),this.urlAfterRedirects=i,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Ay extends Ga{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Ap extends Ga{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=16}}class CE extends Ga{constructor(e,t,i,r){super(e,t),this.error=i,this.target=r,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class AU extends Ga{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class zX extends Ga{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class GX extends Ga{constructor(e,t,i,r,s){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class WX extends Ga{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class jX extends Ga{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class $X{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class qX{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class XX{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class YX{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ZX{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class KX{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class DU{constructor(e,t,i){this.routerEvent=e,this.position=t,this.anchor=i,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class ND{}class LD{constructor(e){this.url=e}}class JX{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Dy,this.attachRef=null}}let Dy=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(t,i){const r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){const i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new JX,this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Ke({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class IU{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=OD(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){const t=OD(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=FD(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return FD(e,this._root).map(t=>t.value)}}function OD(n,e){if(n===e.value)return e;for(const t of e.children){const i=OD(n,t);if(i)return i}return null}function FD(n,e){if(n===e.value)return[e];for(const t of e.children){const i=FD(n,t);if(i.length)return i.unshift(e),i}return[]}class Ol{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function Dp(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class RU extends IU{constructor(e,t){super(e),this.snapshot=t,kD(this,e)}toString(){return this.snapshot.toString()}}function PU(n,e){const t=function QX(n,e){const o=new TE([],{},{},"",{},Ht,e,null,{});return new LU("",new Ol(o,[]))}(0,e),i=new Dr([new Ey("",{})]),r=new Dr({}),s=new Dr({}),o=new Dr({}),a=new Dr(""),l=new Fl(i,r,o,a,s,Ht,e,t.root);return l.snapshot=t.root,new RU(new Ol(l,[]),t)}class Fl{constructor(e,t,i,r,s,o,a,l){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(Jt(c=>c[wy]))??pt(void 0),this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(Jt(e=>Cp(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Jt(e=>Cp(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function NU(n,e="emptyOnly"){const t=n.pathFromRoot;let i=0;if("always"!==e)for(i=t.length-1;i>=1;){const r=t[i],s=t[i-1];if(r.routeConfig&&""===r.routeConfig.path)i--;else{if(s.component)break;i--}}return function eY(n){return n.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(i))}class TE{get title(){return this.data?.[wy]}constructor(e,t,i,r,s,o,a,l,c){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.routeConfig=l,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Cp(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Cp(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class LU extends IU{constructor(e,t){super(t),this.url=e,kD(this,t)}toString(){return OU(this._root)}}function kD(n,e){e.value._routerState=n,e.children.forEach(t=>kD(n,t))}function OU(n){const e=n.children.length>0?` { ${n.children.map(OU).join(", ")} } `:"";return`${n.value}${e}`}function UD(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,za(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),za(e.params,t.params)||n.paramsSubject.next(t.params),function gX(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!za(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.urlSubject.next(t.url),za(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function BD(n,e){const t=za(n.params,e.params)&&function bX(n,e){return Pd(n,e)&&n.every((t,i)=>za(t.parameters,e[i].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||BD(n.parent,e.parent))}let VD=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=Ht,this.activateEvents=new $n,this.deactivateEvents=new $n,this.attachEvents=new $n,this.detachEvents=new $n,this.parentContexts=Ve(Dy),this.location=Ve(Qo),this.changeDetector=Ve(iy),this.environmentInjector=Ve(ss),this.inputBinder=Ve(AE,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){const{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new se(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new se(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new se(4012,!1);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new se(4013,!1);this._activatedRoute=t;const r=this.location,o=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,l=new tY(t,a,r.injector);this.activated=r.createComponent(o,{index:r.length,injector:l,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275dir=ft({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Vi]})}return n})();class tY{constructor(e,t,i){this.route=e,this.childContexts=t,this.parent=i}get(e,t){return e===Fl?this.route:e===Dy?this.childContexts:this.parent.get(e,t)}}const AE=new qe("");let FU=(()=>{class n{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){const{activatedRoute:i}=t,r=xD([i.queryParams,i.params,i.data]).pipe(ys(([s,o,a],l)=>(a={...s,...o,...a},0===l?pt(a):Promise.resolve(a)))).subscribe(s=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==i||null===i.component)return void this.unsubscribeFromRouteData(t);const o=function L8(n){const e=Yt(n);if(!e)return null;const t=new B_(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}(i.component);if(o)for(const{templateName:a}of o.inputs)t.activatedComponentRef.setInput(a,s[a]);else this.unsubscribeFromRouteData(t)});this.outletDataSubscriptions.set(t,r)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Ke({token:n,factory:n.\u0275fac})}return n})();function Iy(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const i=t.value;i._futureSnapshot=e.value;const r=function iY(n,e,t){return e.children.map(i=>{for(const r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return Iy(n,i,r);return Iy(n,i)})}(n,e,t);return new Ol(i,r)}{if(n.shouldAttach(e.value)){const s=n.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Iy(n,a)),o}}const i=function rY(n){return new Fl(new Dr(n.url),new Dr(n.params),new Dr(n.queryParams),new Dr(n.fragment),new Dr(n.data),n.outlet,n.component,n)}(e.value),r=e.children.map(s=>Iy(n,s));return new Ol(i,r)}}const HD="ngNavigationCancelingError";function kU(n,e){const{redirectTo:t,navigationBehaviorOptions:i}=Nd(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=UU(!1,0,e);return r.url=t,r.navigationBehaviorOptions=i,r}function UU(n,e,t){const i=new Error("NavigationCancelingError: "+(n||""));return i[HD]=!0,i.cancellationCode=e,t&&(i.url=t),i}function BU(n){return n&&n[HD]}let VU=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=Ki({type:n,selectors:[["ng-component"]],standalone:!0,features:[J_],decls:1,vars:0,template:function(i,r){1&i&&Fr(0,"router-outlet")},dependencies:[VD],encapsulation:2})}return n})();function zD(n){const e=n.children&&n.children.map(zD),t=e?{...n,children:e}:{...n};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Ht&&(t.component=VU),t}function ra(n){return n.outlet||Ht}function Ry(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class hY{constructor(e,t,i,r,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=s}activate(e){const t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),UD(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){const r=Dp(t);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,r[o],i),delete r[o]}),Object.values(r).forEach(s=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(r===s)if(r.component){const o=i.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,i);else s&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=Dp(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);if(i&&i.outlet){const o=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=Dp(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(e,t,i){const r=Dp(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new KX(s.value.snapshot))}),e.children.length&&this.forwardEvent(new YX(e.value.snapshot))}activateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(UD(r),r===s)if(r.component){const o=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,i);else if(r.component){const o=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),UD(a.route.value),this.activateChildRoutes(e,null,o.children)}else{const a=Ry(r.snapshot);o.attachRef=null,o.route=r,o.injector=a,o.outlet&&o.outlet.activateWith(r,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,i)}}class HU{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class DE{constructor(e,t){this.component=e,this.route=t}}function fY(n,e,t){const i=n._root;return Py(i,e?e._root:null,t,[i.value])}function Ip(n,e){const t=Symbol(),i=e.get(n,t);return i===t?"function"!=typeof n||function Qv(n){return null!==pa(n)}(n)?e.get(n):n:i}function Py(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=Dp(e);return n.children.forEach(o=>{(function mY(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const l=function gY(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!Pd(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Pd(n.url,e.url)||!za(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!BD(n,e)||!za(n.queryParams,e.queryParams);default:return!BD(n,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new HU(i)):(s.data=o.data,s._resolvedData=o._resolvedData),Py(n,e,s.component?a?a.children:null:t,i,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new DE(a.outlet.component,o))}else o&&Ny(e,a,r),r.canActivateChecks.push(new HU(i)),Py(n,null,s.component?a?a.children:null:t,i,r)})(o,s[o.value.outlet],t,i.concat([o.value]),r),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>Ny(a,t.getContext(o),r)),r}function Ny(n,e,t){const i=Dp(n),r=n.value;Object.entries(i).forEach(([s,o])=>{Ny(o,r.component?e?e.children.getContext(s):null:e,t)}),t.canDeactivateChecks.push(new DE(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}function Ly(n){return"function"==typeof n}function zU(n){return n instanceof _E||"EmptyError"===n?.name}const IE=Symbol("INITIAL_VALUE");function Rp(){return ys(n=>xD(n.map(e=>e.pipe(xp(1),function lX(...n){const e=Au(n);return Hn((t,i)=>{(e?MD(n,t,e):MD(n,t)).subscribe(i)})}(IE)))).pipe(Jt(e=>{for(const t of e)if(!0!==t){if(t===IE)return IE;if(!1===t||t instanceof Tp)return t}return!0}),Ll(e=>e!==IE),xp(1)))}function GU(n){return function fx(...n){return Rv(n)}(Br(e=>{if(Nd(e))throw kU(0,e)}),Jt(e=>!0===e))}class RE{constructor(e){this.segmentGroup=e||null}}class WU{constructor(e){this.urlTree=e}}function Pp(n){return vy(new RE(n))}function jU(n){return vy(new WU(n))}class FY{constructor(e,t){this.urlSerializer=e,this.urlTree=t}noMatchError(e){return new se(4002,!1)}lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return pt(i);if(r.numberOfChildren>1||!r.children[Ht])return vy(new se(4e3,!1));r=r.children[Ht]}}applyRedirectCommands(e,t,i){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,i)}applyRedirectCreateUrlTree(e,t,i,r){const s=this.createSegmentGroup(e,t.root,i,r);return new Tp(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const i={};return Object.entries(e).forEach(([r,s])=>{if("string"==typeof s&&s.startsWith(":")){const a=s.substring(1);i[r]=t[a]}else i[r]=s}),i}createSegmentGroup(e,t,i,r){const s=this.createSegments(e,t.segments,i,r);let o={};return Object.entries(t.children).forEach(([a,l])=>{o[a]=this.createSegmentGroup(e,l,i,r)}),new Cn(s,o)}createSegments(e,t,i,r){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,r):this.findOrReturn(s,i))}findPosParam(e,t,i){const r=i[t.path.substring(1)];if(!r)throw new se(4001,!1);return r}findOrReturn(e,t){let i=0;for(const r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}}const GD={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function kY(n,e,t,i,r){const s=WD(n,e,t);return s.matched?(i=function oY(n,e){return n.providers&&!n._injector&&(n._injector=CT(n.providers,e,`Route: ${n.path}`)),n._injector??e}(e,i),function NY(n,e,t,i){const r=e.canMatch;return r&&0!==r.length?pt(r.map(o=>{const a=Ip(o,n);return eu(function EY(n){return n&&Ly(n.canMatch)}(a)?a.canMatch(e,t):n.runInContext(()=>a(e,t)))})).pipe(Rp(),GU()):pt(!0)}(i,e,t).pipe(Jt(o=>!0===o?s:{...GD}))):pt(s)}function WD(n,e,t){if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?{...GD}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const r=(e.matcher||mX)(t,n,e);if(!r)return{...GD};const s={};Object.entries(r.posParams??{}).forEach(([a,l])=>{s[a]=l.path});const o=r.consumed.length>0?{...s,...r.consumed[r.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:o,positionalParamSegments:r.posParams??{}}}function $U(n,e,t,i){return t.length>0&&function VY(n,e,t){return t.some(i=>PE(n,e,i)&&ra(i)!==Ht)}(n,t,i)?{segmentGroup:new Cn(e,BY(i,new Cn(t,n.children))),slicedSegments:[]}:0===t.length&&function HY(n,e,t){return t.some(i=>PE(n,e,i))}(n,t,i)?{segmentGroup:new Cn(n.segments,UY(n,0,t,i,n.children)),slicedSegments:t}:{segmentGroup:new Cn(n.segments,n.children),slicedSegments:t}}function UY(n,e,t,i,r){const s={};for(const o of i)if(PE(n,t,o)&&!r[ra(o)]){const a=new Cn([],{});s[ra(o)]=a}return{...r,...s}}function BY(n,e){const t={};t[Ht]=e;for(const i of n)if(""===i.path&&ra(i)!==Ht){const r=new Cn([],{});t[ra(i)]=r}return t}function PE(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}class jY{constructor(e,t,i,r,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=i,this.config=r,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.allowRedirects=!0,this.applyRedirects=new FY(this.urlSerializer,this.urlTree)}noMatchError(e){return new se(4002,!1)}recognize(){const e=$U(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,Ht).pipe(Rd(t=>{if(t instanceof WU)return this.allowRedirects=!1,this.urlTree=t.urlTree,this.match(t.urlTree);throw t instanceof RE?this.noMatchError(t):t}),Jt(t=>{const i=new TE([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Ht,this.rootComponentType,null,{}),r=new Ol(i,t),s=new LU("",r),o=function OX(n,e,t=null,i=null){return EU(wU(n),e,t,i)}(i,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e.root,Ht).pipe(Rd(i=>{throw i instanceof RE?this.noMatchError(i):i}))}inheritParamsAndData(e){const t=e.value,i=NU(t,this.paramsInheritanceStrategy);t.params=Object.freeze(i.params),t.data=Object.freeze(i.data),e.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(e,t,i,r){return 0===i.segments.length&&i.hasChildren()?this.processChildren(e,t,i):this.processSegment(e,t,i,i.segments,r,!0)}processChildren(e,t,i){const r=[];for(const s of Object.keys(i.children))"primary"===s?r.unshift(s):r.push(s);return hi(r).pipe(Mp(s=>{const o=i.children[s],a=function uY(n,e){const t=n.filter(i=>ra(i)===e);return t.push(...n.filter(i=>ra(i)!==e)),t}(t,s);return this.processSegmentGroup(e,a,o,s)}),function dX(n,e){return Hn(function uX(n,e,t,i,r){return(s,o)=>{let a=t,l=e,c=0;s.subscribe(Zn(o,d=>{const h=c++;l=a?n(l,d,h):(a=!0,d),i&&o.next(l)},r&&(()=>{a&&o.next(l),o.complete()})))}}(n,e,arguments.length>=2,!0))}((s,o)=>(s.push(...o),s)),yE(null),function hX(n,e){const t=arguments.length>=2;return i=>i.pipe(n?Ll((r,s)=>n(r,s,i)):No,TD(1),t?yE(e):aU(()=>new _E))}(),Zi(s=>{if(null===s)return Pp(i);const o=qU(s);return function $Y(n){n.sort((e,t)=>e.value.outlet===Ht?-1:t.value.outlet===Ht?1:e.value.outlet.localeCompare(t.value.outlet))}(o),pt(o)}))}processSegment(e,t,i,r,s,o){return hi(t).pipe(Mp(a=>this.processSegmentAgainstRoute(a._injector??e,t,a,i,r,s,o).pipe(Rd(l=>{if(l instanceof RE)return pt(null);throw l}))),Id(a=>!!a),Rd(a=>{if(zU(a))return function GY(n,e,t){return 0===e.length&&!n.children[t]}(i,r,s)?pt([]):Pp(i);throw a}))}processSegmentAgainstRoute(e,t,i,r,s,o,a){return function zY(n,e,t,i){return!!(ra(n)===i||i!==Ht&&PE(e,t,n))&&("**"===n.path||WD(e,n,t).matched)}(i,r,s,o)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(e,r,i,s,o,a):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,r,t,i,s,o):Pp(r):Pp(r)}expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,i,r,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,i,r){const s=this.applyRedirects.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?jU(s):this.applyRedirects.lineralizeSegments(i,s).pipe(Zi(o=>{const a=new Cn(o,{});return this.processSegment(e,t,a,o,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o){const{matched:a,consumedSegments:l,remainingSegments:c,positionalParamSegments:d}=WD(t,r,s);if(!a)return Pp(t);const h=this.applyRedirects.applyRedirectCommands(l,r.redirectTo,d);return r.redirectTo.startsWith("/")?jU(h):this.applyRedirects.lineralizeSegments(r,h).pipe(Zi(p=>this.processSegment(e,i,t,p.concat(c),o,!1)))}matchSegmentAgainstRoute(e,t,i,r,s,o){let a;if("**"===i.path){const l=r.length>0?uU(r).parameters:{};a=pt({snapshot:new TE(r,l,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,XU(i),ra(i),i.component??i._loadedComponent??null,i,YU(i)),consumedSegments:[],remainingSegments:[]}),t.children={}}else a=kY(t,i,r,e).pipe(Jt(({matched:l,consumedSegments:c,remainingSegments:d,parameters:h})=>l?{snapshot:new TE(c,h,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,XU(i),ra(i),i.component??i._loadedComponent??null,i,YU(i)),consumedSegments:c,remainingSegments:d}:null));return a.pipe(ys(l=>null===l?Pp(t):this.getChildConfig(e=i._injector??e,i,r).pipe(ys(({routes:c})=>{const d=i._loadedInjector??e,{snapshot:h,consumedSegments:p,remainingSegments:m}=l,{segmentGroup:g,slicedSegments:b}=$U(t,p,m,c);if(0===b.length&&g.hasChildren())return this.processChildren(d,c,g).pipe(Jt(y=>null===y?null:[new Ol(h,y)]));if(0===c.length&&0===b.length)return pt([new Ol(h,[])]);const v=ra(i)===s;return this.processSegment(d,c,g,b,v?Ht:s,!0).pipe(Jt(y=>[new Ol(h,y)]))}))))}getChildConfig(e,t,i){return t.children?pt({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?pt({routes:t._loadedRoutes,injector:t._loadedInjector}):function PY(n,e,t,i){const r=e.canLoad;return void 0===r||0===r.length?pt(!0):pt(r.map(o=>{const a=Ip(o,n);return eu(function yY(n){return n&&Ly(n.canLoad)}(a)?a.canLoad(e,t):n.runInContext(()=>a(e,t)))})).pipe(Rp(),GU())}(e,t,i).pipe(Zi(r=>r?this.configLoader.loadChildren(e,t).pipe(Br(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):function OY(n){return vy(UU(!1,3))}())):pt({routes:[],injector:e})}}function qY(n){const e=n.value.routeConfig;return e&&""===e.path}function qU(n){const e=[],t=new Set;for(const i of n){if(!qY(i)){e.push(i);continue}const r=e.find(s=>i.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...i.children),t.add(r)):e.push(i)}for(const i of t){const r=qU(i.children);e.push(new Ol(i.value,r))}return e.filter(i=>!t.has(i))}function XU(n){return n.data||{}}function YU(n){return n.resolve||{}}function ZU(n){return"string"==typeof n.title||null===n.title}function jD(n){return ys(e=>{const t=n(e);return t?hi(t).pipe(Jt(()=>e)):pt(e)})}const Np=new qe("ROUTES");let $D=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=Ve(jO)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return pt(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const i=eu(t.loadComponent()).pipe(Jt(KU),Br(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),by(()=>{this.componentLoaders.delete(t)})),r=new oU(i,()=>new Xr).pipe(CD());return this.componentLoaders.set(t,r),r}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return pt({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const s=function eZ(n,e,t,i){return eu(n.loadChildren()).pipe(Jt(KU),Zi(r=>r instanceof QL||Array.isArray(r)?pt(r):hi(e.compileModuleAsync(r))),Jt(r=>{i&&i(n);let s,o,a=!1;return Array.isArray(r)?(o=r,!0):(s=r.create(t).injector,o=s.get(Np,[],{optional:!0,self:!0}).flat()),{routes:o.map(zD),injector:s}}))}(i,this.compiler,t,this.onLoadEndListener).pipe(by(()=>{this.childrenLoaders.delete(i)})),o=new oU(s,()=>new Xr).pipe(CD());return this.childrenLoaders.set(i,o),o}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Ke({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function KU(n){return function tZ(n){return n&&"object"==typeof n&&"default"in n}(n)?n.default:n}let NE=(()=>{class n{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Xr,this.transitionAbortSubject=new Xr,this.configLoader=Ve($D),this.environmentInjector=Ve(ss),this.urlSerializer=Ve(Sy),this.rootContexts=Ve(Dy),this.inputBindingEnabled=null!==Ve(AE,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>pt(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=r=>this.events.next(new qX(r)),this.configLoader.onLoadStartListener=r=>this.events.next(new $X(r))}complete(){this.transitions?.complete()}handleNavigationRequest(t){const i=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:i})}setupNavigations(t,i,r){return this.transitions=new Dr({id:0,currentUrlTree:i,currentRawUrl:i,currentBrowserUrl:i,extractedUrl:t.urlHandlingStrategy.extract(i),urlAfterRedirects:t.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Ty,restoredState:null,currentSnapshot:r.snapshot,targetSnapshot:null,currentRouterState:r,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Ll(s=>0!==s.id),Jt(s=>({...s,extractedUrl:t.urlHandlingStrategy.extract(s.rawUrl)})),ys(s=>{this.currentTransition=s;let o=!1,a=!1;return pt(s).pipe(Br(l=>{this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),ys(l=>{const c=l.currentBrowserUrl.toString(),d=!t.navigated||l.extractedUrl.toString()!==c||c!==l.currentUrlTree.toString();if(!d&&"reload"!==(l.extras.onSameUrlNavigation??t.onSameUrlNavigation)){const p="";return this.events.next(new Ap(l.id,this.urlSerializer.serialize(l.rawUrl),p,0)),l.resolve(null),lo}if(t.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return pt(l).pipe(ys(p=>{const m=this.transitions?.getValue();return this.events.next(new ME(p.id,this.urlSerializer.serialize(p.extractedUrl),p.source,p.restoredState)),m!==this.transitions?.getValue()?lo:Promise.resolve(p)}),function XY(n,e,t,i,r,s){return Zi(o=>function WY(n,e,t,i,r,s,o="emptyOnly"){return new jY(n,e,t,i,r,o,s).recognize()}(n,e,t,i,o.extractedUrl,r,s).pipe(Jt(({state:a,tree:l})=>({...o,targetSnapshot:a,urlAfterRedirects:l}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,t.paramsInheritanceStrategy),Br(p=>{s.targetSnapshot=p.targetSnapshot,s.urlAfterRedirects=p.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:p.urlAfterRedirects};const m=new AU(p.id,this.urlSerializer.serialize(p.extractedUrl),this.urlSerializer.serialize(p.urlAfterRedirects),p.targetSnapshot);this.events.next(m)}));if(d&&t.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){const{id:p,extractedUrl:m,source:g,restoredState:b,extras:v}=l,y=new ME(p,this.urlSerializer.serialize(m),g,b);this.events.next(y);const w=PU(0,this.rootComponentType).snapshot;return this.currentTransition=s={...l,targetSnapshot:w,urlAfterRedirects:m,extras:{...v,skipLocationChange:!1,replaceUrl:!1}},pt(s)}{const p="";return this.events.next(new Ap(l.id,this.urlSerializer.serialize(l.extractedUrl),p,1)),l.resolve(null),lo}}),Br(l=>{const c=new zX(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(c)}),Jt(l=>(this.currentTransition=s={...l,guards:fY(l.targetSnapshot,l.currentSnapshot,this.rootContexts)},s)),function xY(n,e){return Zi(t=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return 0===o.length&&0===s.length?pt({...t,guardsResult:!0}):function MY(n,e,t,i){return hi(n).pipe(Zi(r=>function RY(n,e,t,i,r){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?pt(s.map(a=>{const l=Ry(e)??r,c=Ip(a,l);return eu(function wY(n){return n&&Ly(n.canDeactivate)}(c)?c.canDeactivate(n,e,t,i):l.runInContext(()=>c(n,e,t,i))).pipe(Id())})).pipe(Rp()):pt(!0)}(r.component,r.route,t,e,i)),Id(r=>!0!==r,!0))}(o,i,r,n).pipe(Zi(a=>a&&function _Y(n){return"boolean"==typeof n}(a)?function CY(n,e,t,i){return hi(e).pipe(Mp(r=>MD(function AY(n,e){return null!==n&&e&&e(new XX(n)),pt(!0)}(r.route.parent,i),function TY(n,e){return null!==n&&e&&e(new ZX(n)),pt(!0)}(r.route,i),function IY(n,e,t){const i=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function pY(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(o)).filter(o=>null!==o).map(o=>sU(()=>pt(o.guards.map(l=>{const c=Ry(o.node)??t,d=Ip(l,c);return eu(function bY(n){return n&&Ly(n.canActivateChild)}(d)?d.canActivateChild(i,n):c.runInContext(()=>d(i,n))).pipe(Id())})).pipe(Rp())));return pt(s).pipe(Rp())}(n,r.path,t),function DY(n,e,t){const i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||0===i.length)return pt(!0);const r=i.map(s=>sU(()=>{const o=Ry(e)??t,a=Ip(s,o);return eu(function vY(n){return n&&Ly(n.canActivate)}(a)?a.canActivate(e,n):o.runInContext(()=>a(e,n))).pipe(Id())}));return pt(r).pipe(Rp())}(n,r.route,t))),Id(r=>!0!==r,!0))}(i,s,n,e):pt(a)),Jt(a=>({...t,guardsResult:a})))})}(this.environmentInjector,l=>this.events.next(l)),Br(l=>{if(s.guardsResult=l.guardsResult,Nd(l.guardsResult))throw kU(0,l.guardsResult);const c=new GX(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(c)}),Ll(l=>!!l.guardsResult||(this.cancelNavigationTransition(l,"",3),!1)),jD(l=>{if(l.guards.canActivateChecks.length)return pt(l).pipe(Br(c=>{const d=new WX(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(d)}),ys(c=>{let d=!1;return pt(c).pipe(function YY(n,e){return Zi(t=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return pt(t);let s=0;return hi(r).pipe(Mp(o=>function ZY(n,e,t,i){const r=n.routeConfig,s=n._resolve;return void 0!==r?.title&&!ZU(r)&&(s[wy]=r.title),function KY(n,e,t,i){const r=function JY(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===r.length)return pt({});const s={};return hi(r).pipe(Zi(o=>function QY(n,e,t,i){const r=Ry(e)??i,s=Ip(n,r);return eu(s.resolve?s.resolve(e,t):r.runInContext(()=>s(e,t)))}(n[o],e,t,i).pipe(Id(),Br(a=>{s[o]=a}))),TD(1),function fX(n){return Jt(()=>n)}(s),Rd(o=>zU(o)?lo:vy(o)))}(s,n,e,i).pipe(Jt(o=>(n._resolvedData=o,n.data=NU(n,t).resolve,r&&ZU(r)&&(n.data[wy]=r.title),null)))}(o.route,i,n,e)),Br(()=>s++),TD(1),Zi(o=>s===r.length?pt(t):lo))})}(t.paramsInheritanceStrategy,this.environmentInjector),Br({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(c,"",2)}}))}),Br(c=>{const d=new jX(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(d)}))}),jD(l=>{const c=d=>{const h=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&h.push(this.configLoader.loadComponent(d.routeConfig).pipe(Br(p=>{d.component=p}),Jt(()=>{})));for(const p of d.children)h.push(...c(p));return h};return xD(c(l.targetSnapshot.root)).pipe(yE(),xp(1))}),jD(()=>this.afterPreactivation()),Jt(l=>{const c=function nY(n,e,t){const i=Iy(n,e._root,t?t._root:void 0);return new RU(i,e)}(t.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=s={...l,targetRouterState:c},s}),Br(()=>{this.events.next(new ND)}),((n,e,t,i)=>Jt(r=>(new hY(e,r.targetRouterState,r.currentRouterState,t,i).activate(n),r)))(this.rootContexts,t.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),xp(1),Br({next:l=>{o=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new tu(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),t.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{o=!0}}),lU(this.transitionAbortSubject.pipe(Br(l=>{throw l}))),by(()=>{o||a||this.cancelNavigationTransition(s,"",1),this.currentNavigation?.id===s.id&&(this.currentNavigation=null)}),Rd(l=>{if(a=!0,BU(l))this.events.next(new Ay(s.id,this.urlSerializer.serialize(s.extractedUrl),l.message,l.cancellationCode)),function sY(n){return BU(n)&&Nd(n.url)}(l)?this.events.next(new LD(l.url)):s.resolve(!1);else{this.events.next(new CE(s.id,this.urlSerializer.serialize(s.extractedUrl),l,s.targetSnapshot??void 0));try{s.resolve(t.errorHandler(l))}catch(c){s.reject(c)}}return lo}))}))}cancelNavigationTransition(t,i,r){const s=new Ay(t.id,this.urlSerializer.serialize(t.extractedUrl),i,r);this.events.next(s),t.resolve(!1)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Ke({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function JU(n){return n!==Ty}let QU=(()=>{class n{buildTitle(t){let i,r=t.root;for(;void 0!==r;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(s=>s.outlet===Ht);return i}getResolvedTitleForRoute(t){return t.data[wy]}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Ke({token:n,factory:function(){return Ve(nZ)},providedIn:"root"})}return n})(),nZ=(()=>{class n extends QU{constructor(t){super(),this.title=t}updateTitle(t){const i=this.buildTitle(t);void 0!==i&&this.title.setTitle(i)}static#e=this.\u0275fac=function(i){return new(i||n)(Le(PA))};static#t=this.\u0275prov=Ke({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),iZ=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Ke({token:n,factory:function(){return Ve(sZ)},providedIn:"root"})}return n})();class rZ{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let sZ=(()=>{class n extends rZ{static#e=this.\u0275fac=function(){let t;return function(r){return(t||(t=fi(n)))(r||n)}}();static#t=this.\u0275prov=Ke({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const LE=new qe("",{providedIn:"root",factory:()=>({})});let oZ=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Ke({token:n,factory:function(){return Ve(aZ)},providedIn:"root"})}return n})(),aZ=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Ke({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Oy=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(Oy||{});function e3(n,e){n.events.pipe(Ll(t=>t instanceof tu||t instanceof Ay||t instanceof CE||t instanceof Ap),Jt(t=>t instanceof tu||t instanceof Ap?Oy.COMPLETE:t instanceof Ay&&(0===t.code||1===t.code)?Oy.REDIRECTING:Oy.FAILED),Ll(t=>t!==Oy.REDIRECTING),xp(1)).subscribe(()=>{e()})}function lZ(n){throw n}function cZ(n,e,t){return e.parse("/")}const uZ={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},dZ={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Mr=(()=>{class n{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.location.getState()?.\u0275routerPageId??this.currentPageId}get events(){return this._events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=Ve(WO),this.isNgZoneEnabled=!1,this._events=new Xr,this.options=Ve(LE,{optional:!0})||{},this.pendingTasks=Ve(Sw),this.errorHandler=this.options.errorHandler||lZ,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||cZ,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=Ve(oZ),this.routeReuseStrategy=Ve(iZ),this.titleStrategy=Ve(QU),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=Ve(Np,{optional:!0})?.flat()??[],this.navigationTransitions=Ve(NE),this.urlSerializer=Ve(Sy),this.location=Ve(sA),this.componentInputBindingEnabled=!!Ve(AE,{optional:!0}),this.eventsSubscription=new jr,this.isNgZoneEnabled=Ve(Mn)instanceof Mn&&Mn.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new Tp,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=PU(0,null),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe(t=>{this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const t=this.navigationTransitions.events.subscribe(i=>{try{const{currentTransition:r}=this.navigationTransitions;if(null===r)return void(t3(i)&&this._events.next(i));if(i instanceof ME)JU(r.source)&&(this.browserUrlTree=r.extractedUrl);else if(i instanceof Ap)this.rawUrlTree=r.rawUrl;else if(i instanceof AU){if("eager"===this.urlUpdateStrategy){if(!r.extras.skipLocationChange){const s=this.urlHandlingStrategy.merge(r.urlAfterRedirects,r.rawUrl);this.setBrowserUrl(s,r)}this.browserUrlTree=r.urlAfterRedirects}}else if(i instanceof ND)this.currentUrlTree=r.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(r.urlAfterRedirects,r.rawUrl),this.routerState=r.targetRouterState,"deferred"===this.urlUpdateStrategy&&(r.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,r),this.browserUrlTree=r.urlAfterRedirects);else if(i instanceof Ay)0!==i.code&&1!==i.code&&(this.navigated=!0),(3===i.code||2===i.code)&&this.restoreHistory(r);else if(i instanceof LD){const s=this.urlHandlingStrategy.merge(i.url,r.currentRawUrl),o={skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||JU(r.source)};this.scheduleNavigation(s,Ty,null,o,{resolve:r.resolve,reject:r.reject,promise:r.promise})}i instanceof CE&&this.restoreHistory(r,!0),i instanceof tu&&(this.navigated=!0),t3(i)&&this._events.next(i)}catch(r){this.navigationTransitions.transitionAbortSubject.next(r)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const t=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),Ty,t)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const i="popstate"===t.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{this.navigateToSyncWithBrowser(t.url,i,t.state)},0)}))}navigateToSyncWithBrowser(t,i,r){const s={replaceUrl:!0},o=r?.navigationId?r:null;if(r){const l={...r};delete l.navigationId,delete l.\u0275routerPageId,0!==Object.keys(l).length&&(s.state=l)}const a=this.parseUrl(t);this.scheduleNavigation(a,i,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(zD),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,i={}){const{relativeTo:r,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:l}=i,c=l?this.currentUrlTree.fragment:o;let h,d=null;switch(a){case"merge":d={...this.currentUrlTree.queryParams,...s};break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=s||null}null!==d&&(d=this.removeEmptyProps(d));try{h=wU(r?r.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof t[0]||!t[0].startsWith("/"))&&(t=[]),h=this.currentUrlTree.root}return EU(h,t,d,c??null)}navigateByUrl(t,i={skipLocationChange:!1}){const r=Nd(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,Ty,null,i)}navigate(t,i={skipLocationChange:!1}){return function hZ(n){for(let e=0;e<n.length;e++)if(null==n[e])throw new se(4008,!1)}(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let i;try{i=this.urlSerializer.parse(t)}catch(r){i=this.malformedUriErrorHandler(r,this.urlSerializer,t)}return i}isActive(t,i){let r;if(r=!0===i?{...uZ}:!1===i?{...dZ}:i,Nd(t))return hU(this.currentUrlTree,t,r);const s=this.parseUrl(t);return hU(this.currentUrlTree,s,r)}removeEmptyProps(t){return Object.keys(t).reduce((i,r)=>{const s=t[r];return null!=s&&(i[r]=s),i},{})}scheduleNavigation(t,i,r,s,o){if(this.disposed)return Promise.resolve(!1);let a,l,c;o?(a=o.resolve,l=o.reject,c=o.promise):c=new Promise((h,p)=>{a=h,l=p});const d=this.pendingTasks.add();return e3(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,currentBrowserUrl:this.browserUrlTree,rawUrl:t,extras:s,resolve:a,reject:l,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(h=>Promise.reject(h))}setBrowserUrl(t,i){const r=this.urlSerializer.serialize(t);if(this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl){const o={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId)};this.location.replaceState(r,"",o)}else{const s={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId+1)};this.location.go(r,"",s)}}restoreHistory(t,i=!1){if("computed"===this.canceledNavigationResolution){const s=this.currentPageId-this.browserPageId;0!==s?this.location.historyGo(s):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===s&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Ke({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function t3(n){return!(n instanceof ND||n instanceof LD)}class n3{}let mZ=(()=>{class n{constructor(t,i,r,s,o){this.router=t,this.injector=r,this.preloadingStrategy=s,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(Ll(t=>t instanceof tu),Mp(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,i){const r=[];for(const s of i){s.providers&&!s._injector&&(s._injector=CT(s.providers,t,`Route: ${s.path}`));const o=s._injector??t,a=s._loadedInjector??o;(s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent)&&r.push(this.preloadConfig(o,s)),(s.children||s._loadedRoutes)&&r.push(this.processRoutes(a,s.children??s._loadedRoutes))}return hi(r).pipe(lc())}preloadConfig(t,i){return this.preloadingStrategy.preload(i,()=>{let r;r=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(t,i):pt(null);const s=r.pipe(Zi(o=>null===o?pt(void 0):(i._loadedRoutes=o.routes,i._loadedInjector=o.injector,this.processRoutes(o.injector??t,o.routes))));return i.loadComponent&&!i._loadedComponent?hi([s,this.loader.loadComponent(i)]).pipe(lc()):s})}static#e=this.\u0275fac=function(i){return new(i||n)(Le(Mr),Le(jO),Le(ss),Le(n3),Le($D))};static#t=this.\u0275prov=Ke({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const XD=new qe("");let i3=(()=>{class n{constructor(t,i,r,s,o={}){this.urlSerializer=t,this.transitions=i,this.viewportScroller=r,this.zone=s,this.options=o,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},o.scrollPositionRestoration=o.scrollPositionRestoration||"disabled",o.anchorScrolling=o.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof ME?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof tu?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof Ap&&0===t.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof DU&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new DU(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static#e=this.\u0275fac=function(i){!function HP(){throw new Error("invalid")}()};static#t=this.\u0275prov=Ke({token:n,factory:n.\u0275fac})}return n})();function kl(n,e){return{\u0275kind:n,\u0275providers:e}}function s3(){const n=Ve($s);return e=>{const t=n.get(Ed);if(e!==t.components[0])return;const i=n.get(Mr),r=n.get(o3);1===n.get(YD)&&i.initialNavigation(),n.get(a3,null,jt.Optional)?.setUpPreloading(),n.get(XD,null,jt.Optional)?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}const o3=new qe("",{factory:()=>new Xr}),YD=new qe("",{providedIn:"root",factory:()=>1}),a3=new qe("");function vZ(n){return kl(0,[{provide:a3,useExisting:mZ},{provide:n3,useExisting:n}])}const l3=new qe("ROUTER_FORROOT_GUARD"),wZ=[sA,{provide:Sy,useClass:AD},Mr,Dy,{provide:Fl,useFactory:function r3(n){return n.routerState.root},deps:[Mr]},$D,[]];function EZ(){return new JO("Router",Mr)}let c3=(()=>{class n{constructor(t){}static forRoot(t,i){return{ngModule:n,providers:[wZ,[],{provide:Np,multi:!0,useValue:t},{provide:l3,useFactory:CZ,deps:[[Mr,new bf,new wf]]},{provide:LE,useValue:i||{}},i?.useHash?{provide:xd,useClass:B8}:{provide:xd,useClass:AF},{provide:XD,useFactory:()=>{const n=Ve(r$),e=Ve(Mn),t=Ve(LE),i=Ve(NE),r=Ve(Sy);return t.scrollOffset&&n.setOffset(t.scrollOffset),new i3(r,i,n,e,t)}},i?.preloadingStrategy?vZ(i.preloadingStrategy).\u0275providers:[],{provide:JO,multi:!0,useFactory:EZ},i?.initialNavigation?TZ(i):[],i?.bindToComponentInputs?kl(8,[FU,{provide:AE,useExisting:FU}]).\u0275providers:[],[{provide:u3,useFactory:s3},{provide:YT,multi:!0,useExisting:u3}]]}}static forChild(t){return{ngModule:n,providers:[{provide:Np,multi:!0,useValue:t}]}}static#e=this.\u0275fac=function(i){return new(i||n)(Le(l3,8))};static#t=this.\u0275mod=Fi({type:n});static#n=this.\u0275inj=Ci({})}return n})();function CZ(n){return"guarded"}function TZ(n){return["disabled"===n.initialNavigation?kl(3,[{provide:HT,multi:!0,useFactory:()=>{const e=Ve(Mr);return()=>{e.setUpLocationChangeListener()}}},{provide:YD,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?kl(2,[{provide:YD,useValue:0},{provide:HT,multi:!0,deps:[$s],useFactory:e=>{const t=e.get(k8,Promise.resolve());return()=>t.then(()=>new Promise(i=>{const r=e.get(Mr),s=e.get(o3);e3(r,()=>{i(!0)}),e.get(NE).afterPreactivation=()=>(i(!0),s.closed?pt(void 0):s),r.initialNavigation()}))}}]).\u0275providers:[]]}const u3=new qe("");function d3(n,e,t,i,r,s,o){try{var a=n[s](o),l=a.value}catch(c){return void t(c)}a.done?e(l):Promise.resolve(l).then(i,r)}function Rn(n){return function(){var e=this,t=arguments;return new Promise(function(i,r){var s=n.apply(e,t);function o(l){d3(s,i,r,o,a,"next",l)}function a(l){d3(s,i,r,o,a,"throw",l)}o(void 0)})}}const f3=1,RZ=2,Ul=3,OE=0,KZ=1,JZ=2,iu=0,QZ=1,eK=2,tK=3,nK=4,iK=5,ru=301,Ld=302,Fy=306,Od=1e3,Vr=1001,Ni=1003,_i=1006,Vl=1008,su=1009,ou=1014,Hl=1015,By=1016,Fd=1020,So=1023,kd=1026,Up=1027,Vy=2300,Bp=2301,Ud=3001,ui="srgb",Cr="srgb-linear",c1="display-p3",VE="display-p3-linear",HE="linear",ei="srgb",zE="rec709",GE="p3",tB="300 es",zl=2e3;class Vd{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const r=this._listeners[e];if(void 0!==r){const s=r.indexOf(t);-1!==s&&r.splice(s,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const i=this._listeners[e.type];if(void 0!==i){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const Hr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];const Hd=Math.PI/180,zp=180/Math.PI;function Ks(){const n=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(Hr[255&n]+Hr[n>>8&255]+Hr[n>>16&255]+Hr[n>>24&255]+"-"+Hr[255&e]+Hr[e>>8&255]+"-"+Hr[e>>16&15|64]+Hr[e>>24&255]+"-"+Hr[63&t|128]+Hr[t>>8&255]+"-"+Hr[t>>16&255]+Hr[t>>24&255]+Hr[255&i]+Hr[i>>8&255]+Hr[i>>16&255]+Hr[i>>24&255]).toLowerCase()}function yi(n,e,t){return Math.max(e,Math.min(t,n))}function h1(n,e){return(n%e+e)%e}function Hy(n,e,t){return(1-t)*n+t*e}function f1(n){return 0==(n&n-1)&&0!==n}function iB(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function $E(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function Is(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function Wt(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(4294967295*n);case Uint16Array:return Math.round(65535*n);case Uint8Array:return Math.round(255*n);case Int32Array:return Math.round(2147483647*n);case Int16Array:return Math.round(32767*n);case Int8Array:return Math.round(127*n);default:throw new Error("Invalid component type.")}}const au_DEG2RAD=Hd,au_degToRad=function BK(n){return n*Hd},au_radToDeg=function VK(n){return n*zp};class fe{constructor(e=0,t=0){fe.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(yi(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Zt{constructor(e,t,i,r,s,o,a,l,c){Zt.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,i,r,s,o,a,l,c)}set(e,t,i,r,s,o,a,l,c){const d=this.elements;return d[0]=e,d[1]=r,d[2]=a,d[3]=t,d[4]=s,d[5]=l,d[6]=i,d[7]=o,d[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[3],l=i[6],c=i[1],d=i[4],h=i[7],p=i[2],m=i[5],g=i[8],b=r[0],v=r[3],y=r[6],w=r[1],E=r[4],x=r[7],C=r[2],A=r[5],D=r[8];return s[0]=o*b+a*w+l*C,s[3]=o*v+a*E+l*A,s[6]=o*y+a*x+l*D,s[1]=c*b+d*w+h*C,s[4]=c*v+d*E+h*A,s[7]=c*y+d*x+h*D,s[2]=p*b+m*w+g*C,s[5]=p*v+m*E+g*A,s[8]=p*y+m*x+g*D,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],d=e[8];return t*o*d-t*a*c-i*s*d+i*a*l+r*s*c-r*o*l}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],d=e[8],h=d*o-a*c,p=a*l-d*s,m=c*s-o*l,g=t*h+i*p+r*m;if(0===g)return this.set(0,0,0,0,0,0,0,0,0);const b=1/g;return e[0]=h*b,e[1]=(r*c-d*i)*b,e[2]=(a*i-r*o)*b,e[3]=p*b,e[4]=(d*t-r*l)*b,e[5]=(r*s-a*t)*b,e[6]=m*b,e[7]=(i*l-c*t)*b,e[8]=(o*t-i*s)*b,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(i*l,i*c,-i*(l*o+c*a)+o+e,-r*c,r*l,-r*(-c*o+l*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(p1.makeScale(e,t)),this}rotate(e){return this.premultiply(p1.makeRotation(-e)),this}translate(e,t){return this.premultiply(p1.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const p1=new Zt;function rB(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function zy(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function GK(){const n=zy("canvas");return n.style.display="block",n}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const sB={};function Gy(n){n in sB||(sB[n]=!0,console.warn(n))}const oB=(new Zt).set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),aB=(new Zt).set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),qE={[Cr]:{transfer:HE,primaries:zE,toReference:n=>n,fromReference:n=>n},[ui]:{transfer:ei,primaries:zE,toReference:n=>n.convertSRGBToLinear(),fromReference:n=>n.convertLinearToSRGB()},[VE]:{transfer:HE,primaries:GE,toReference:n=>n.applyMatrix3(aB),fromReference:n=>n.applyMatrix3(oB)},[c1]:{transfer:ei,primaries:GE,toReference:n=>n.convertSRGBToLinear().applyMatrix3(aB),fromReference:n=>n.applyMatrix3(oB).convertLinearToSRGB()}},WK=new Set([Cr,VE]),En={enabled:!0,_workingColorSpace:Cr,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(n){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!n},get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(n){if(!WK.has(n))throw new Error(`Unsupported working color space, "${n}".`);this._workingColorSpace=n},convert:function(n,e,t){return!1!==this.enabled&&e!==t&&e&&t?(0,qE[t].fromReference)((0,qE[e].toReference)(n)):n},fromWorkingColorSpace:function(n,e){return this.convert(n,this._workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this._workingColorSpace)},getPrimaries:function(n){return qE[n].primaries},getTransfer:function(n){return""===n?HE:qE[n].transfer}};function Wp(n){return n<.04045?.0773993808*n:Math.pow(.9478672986*n+.0521327014,2.4)}function m1(n){return n<.0031308?12.92*n:1.055*Math.pow(n,.41666)-.055}let jp;class lB{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===jp&&(jp=zy("canvas")),jp.width=e.width,jp.height=e.height;const i=jp.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=jp}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=zy("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=255*Wp(s[o]/255);return i.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t[i]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*Wp(t[i]/255)):Wp(t[i]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let jK=0;class $p{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:jK++}),this.uuid=Ks(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(null!==r){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)s.push(g1(r[o].isDataTexture?r[o].image:r[o]))}else s=g1(r);i.url=s}return t||(e.images[this.uuid]=i),i}}function g1(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?lB.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let $K=0,oa=(()=>{class n extends Vd{constructor(t=n.DEFAULT_IMAGE,i=n.DEFAULT_MAPPING,r=Vr,s=Vr,o=_i,a=Vl,l=So,c=su,d=n.DEFAULT_ANISOTROPY,h=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:$K++}),this.uuid=Ks(),this.name="",this.source=new $p(t),this.mipmaps=[],this.mapping=i,this.channel=0,this.wrapS=r,this.wrapT=s,this.magFilter=o,this.minFilter=a,this.anisotropy=d,this.format=l,this.internalFormat=null,this.type=c,this.offset=new fe(0,0),this.repeat=new fe(1,1),this.center=new fe(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Zt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,"string"==typeof h?this.colorSpace=h:(Gy("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=h===Ud?ui:""),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const i=void 0===t||"string"==typeof t;if(!i&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),i||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Od:t.x=t.x-Math.floor(t.x);break;case Vr:t.x=t.x<0?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case Od:t.y=t.y-Math.floor(t.y);break;case Vr:t.y=t.y<0?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return Gy("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===ui?Ud:3e3}set encoding(t){Gy("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=t===Ud?ui:""}}return n.DEFAULT_IMAGE=null,n.DEFAULT_MAPPING=300,n.DEFAULT_ANISOTROPY=1,n})();class Pn{constructor(e=0,t=0,i=0,r=1){Pn.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*i+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,s;const l=e.elements,c=l[0],d=l[4],h=l[8],p=l[1],m=l[5],g=l[9],b=l[2],v=l[6],y=l[10];if(Math.abs(d-p)<.01&&Math.abs(h-b)<.01&&Math.abs(g-v)<.01){if(Math.abs(d+p)<.1&&Math.abs(h+b)<.1&&Math.abs(g+v)<.1&&Math.abs(c+m+y-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const E=(c+1)/2,x=(m+1)/2,C=(y+1)/2,A=(d+p)/4,D=(h+b)/4,O=(g+v)/4;return E>x&&E>C?E<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(E),r=A/i,s=D/i):x>C?x<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(x),i=A/r,s=O/r):C<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(C),i=D/s,r=O/s),this.set(i,r,s,t),this}let w=Math.sqrt((v-g)*(v-g)+(h-b)*(h-b)+(p-d)*(p-d));return Math.abs(w)<.001&&(w=1),this.x=(v-g)/w,this.y=(h-b)/w,this.z=(p-d)/w,this.w=Math.acos((c+m+y-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class qK extends Vd{constructor(e=1,t=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Pn(0,0,e,t),this.scissorTest=!1,this.viewport=new Pn(0,0,e,t);const r={width:e,height:t,depth:1};void 0!==i.encoding&&(Gy("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),i.colorSpace=i.encoding===Ud?ui:""),i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:_i,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},i),this.texture=new oa(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps,this.texture.internalFormat=i.internalFormat,this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.depthTexture=i.depthTexture,this.samples=i.samples}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new $p(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class zd extends qK{constructor(e=1,t=1,i={}){super(e,t,i),this.isWebGLRenderTarget=!0}}class _1 extends oa{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=Ni,this.minFilter=Ni,this.wrapR=Vr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class cB extends oa{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=Ni,this.minFilter=Ni,this.wrapR=Vr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Bn{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,s,o,a){let l=i[r+0],c=i[r+1],d=i[r+2],h=i[r+3];const p=s[o+0],m=s[o+1],g=s[o+2],b=s[o+3];if(0===a)return e[t+0]=l,e[t+1]=c,e[t+2]=d,void(e[t+3]=h);if(1===a)return e[t+0]=p,e[t+1]=m,e[t+2]=g,void(e[t+3]=b);if(h!==b||l!==p||c!==m||d!==g){let v=1-a;const y=l*p+c*m+d*g+h*b,w=y>=0?1:-1,E=1-y*y;if(E>Number.EPSILON){const C=Math.sqrt(E),A=Math.atan2(C,y*w);v=Math.sin(v*A)/C,a=Math.sin(a*A)/C}const x=a*w;if(l=l*v+p*x,c=c*v+m*x,d=d*v+g*x,h=h*v+b*x,v===1-a){const C=1/Math.sqrt(l*l+c*c+d*d+h*h);l*=C,c*=C,d*=C,h*=C}}e[t]=l,e[t+1]=c,e[t+2]=d,e[t+3]=h}static multiplyQuaternionsFlat(e,t,i,r,s,o){const a=i[r],l=i[r+1],c=i[r+2],d=i[r+3],h=s[o],p=s[o+1],m=s[o+2],g=s[o+3];return e[t]=a*g+d*h+l*m-c*p,e[t+1]=l*g+d*p+c*h-a*m,e[t+2]=c*g+d*m+a*p-l*h,e[t+3]=d*g-a*h-l*p-c*m,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,c=a(i/2),d=a(r/2),h=a(s/2),p=l(i/2),m=l(r/2),g=l(s/2);switch(o){case"XYZ":this._x=p*d*h+c*m*g,this._y=c*m*h-p*d*g,this._z=c*d*g+p*m*h,this._w=c*d*h-p*m*g;break;case"YXZ":this._x=p*d*h+c*m*g,this._y=c*m*h-p*d*g,this._z=c*d*g-p*m*h,this._w=c*d*h+p*m*g;break;case"ZXY":this._x=p*d*h-c*m*g,this._y=c*m*h+p*d*g,this._z=c*d*g+p*m*h,this._w=c*d*h-p*m*g;break;case"ZYX":this._x=p*d*h-c*m*g,this._y=c*m*h+p*d*g,this._z=c*d*g-p*m*h,this._w=c*d*h+p*m*g;break;case"YZX":this._x=p*d*h+c*m*g,this._y=c*m*h+p*d*g,this._z=c*d*g-p*m*h,this._w=c*d*h-p*m*g;break;case"XZY":this._x=p*d*h-c*m*g,this._y=c*m*h-p*d*g,this._z=c*d*g+p*m*h,this._w=c*d*h+p*m*g;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],s=t[8],o=t[1],a=t[5],l=t[9],c=t[2],d=t[6],h=t[10],p=i+a+h;if(p>0){const m=.5/Math.sqrt(p+1);this._w=.25/m,this._x=(d-l)*m,this._y=(s-c)*m,this._z=(o-r)*m}else if(i>a&&i>h){const m=2*Math.sqrt(1+i-a-h);this._w=(d-l)/m,this._x=.25*m,this._y=(r+o)/m,this._z=(s+c)/m}else if(a>h){const m=2*Math.sqrt(1+a-i-h);this._w=(s-c)/m,this._x=(r+o)/m,this._y=.25*m,this._z=(l+d)/m}else{const m=2*Math.sqrt(1+h-i-a);this._w=(o-r)/m,this._x=(s+c)/m,this._y=(l+d)/m,this._z=.25*m}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(yi(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(0===i)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,s=e._z,o=e._w,a=t._x,l=t._y,c=t._z,d=t._w;return this._x=i*d+o*a+r*c-s*l,this._y=r*d+o*l+s*a-i*c,this._z=s*d+o*c+i*l-r*a,this._w=o*d-i*a-r*l-s*c,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const i=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const m=1-t;return this._w=m*o+t*this._w,this._x=m*i+t*this._x,this._y=m*r+t*this._y,this._z=m*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const c=Math.sqrt(l),d=Math.atan2(c,a),h=Math.sin((1-t)*d)/c,p=Math.sin(t*d)/c;return this._w=o*h+this._w*p,this._x=i*h+this._x*p,this._y=r*h+this._y*p,this._z=s*h+this._z*p,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(r),i*Math.sin(s),i*Math.cos(s),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class N{constructor(e=0,t=0,i=0){N.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return void 0===i&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(uB.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(uB.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*r,this.y=s[1]*t+s[4]*i+s[7]*r,this.z=s[2]*t+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=l*t+o*r-a*i,d=l*i+a*t-s*r,h=l*r+s*i-o*t,p=-s*t-o*i-a*r;return this.x=c*l+p*-s+d*-a-h*-o,this.y=d*l+p*-o+h*-s-c*-a,this.z=h*l+p*-a+c*-o-d*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r,this.y=s[1]*t+s[5]*i+s[9]*r,this.z=s[2]*t+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=r*l-s*a,this.y=s*o-i*l,this.z=i*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return y1.copy(this).projectOnVector(e),this.sub(y1)}reflect(e){return this.sub(y1.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(yi(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const y1=new N,uB=new Bn;class Wa{constructor(e=new N(1/0,1/0,1/0),t=new N(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(Wl.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(Wl.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=Wl.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){if(e.updateWorldMatrix(!1,!1),void 0!==e.boundingBox)null===e.boundingBox&&e.computeBoundingBox(),qp.copy(e.boundingBox),qp.applyMatrix4(e.matrixWorld),this.union(qp);else{const r=e.geometry;if(void 0!==r)if(t&&void 0!==r.attributes&&void 0!==r.attributes.position){const s=r.attributes.position;for(let o=0,a=s.count;o<a;o++)Wl.fromBufferAttribute(s,o).applyMatrix4(e.matrixWorld),this.expandByPoint(Wl)}else null===r.boundingBox&&r.computeBoundingBox(),qp.copy(r.boundingBox),qp.applyMatrix4(e.matrixWorld),this.union(qp)}const i=e.children;for(let r=0,s=i.length;r<s;r++)this.expandByObject(i[r],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Wl),Wl.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Wy),XE.subVectors(this.max,Wy),Xp.subVectors(e.a,Wy),Yp.subVectors(e.b,Wy),Zp.subVectors(e.c,Wy),lu.subVectors(Yp,Xp),cu.subVectors(Zp,Yp),Gd.subVectors(Xp,Zp);let t=[0,-lu.z,lu.y,0,-cu.z,cu.y,0,-Gd.z,Gd.y,lu.z,0,-lu.x,cu.z,0,-cu.x,Gd.z,0,-Gd.x,-lu.y,lu.x,0,-cu.y,cu.x,0,-Gd.y,Gd.x,0];return!(!v1(t,Xp,Yp,Zp,XE)||(t=[1,0,0,0,1,0,0,0,1],!v1(t,Xp,Yp,Zp,XE)))&&(YE.crossVectors(lu,cu),t=[YE.x,YE.y,YE.z],v1(t,Xp,Yp,Zp,XE))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Wl).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(Wl).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(Gl[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Gl[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Gl[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Gl[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Gl[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Gl[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Gl[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Gl[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Gl)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Gl=[new N,new N,new N,new N,new N,new N,new N,new N],Wl=new N,qp=new Wa,Xp=new N,Yp=new N,Zp=new N,lu=new N,cu=new N,Gd=new N,Wy=new N,XE=new N,YE=new N,Wd=new N;function v1(n,e,t,i,r){for(let s=0,o=n.length-3;s<=o;s+=3){Wd.fromArray(n,s);const a=r.x*Math.abs(Wd.x)+r.y*Math.abs(Wd.y)+r.z*Math.abs(Wd.z),l=e.dot(Wd),c=t.dot(Wd),d=i.dot(Wd);if(Math.max(-Math.max(l,c,d),Math.min(l,c,d))>a)return!1}return!0}const XK=new Wa,jy=new N,b1=new N;class aa{constructor(e=new N,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;void 0!==t?i.copy(t):XK.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;jy.subVectors(e,this.center);const t=jy.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=.5*(i-this.radius);this.center.addScaledVector(jy,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(b1.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(jy.copy(e.center).add(b1)),this.expandByPoint(jy.copy(e.center).sub(b1))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const jl=new N,w1=new N,ZE=new N,uu=new N,E1=new N,KE=new N,S1=new N;class Kp{constructor(e=new N,t=new N(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,jl)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=jl.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(jl.copy(this.origin).addScaledVector(this.direction,t),jl.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){w1.copy(e).add(t).multiplyScalar(.5),ZE.copy(t).sub(e).normalize(),uu.copy(this.origin).sub(w1);const s=.5*e.distanceTo(t),o=-this.direction.dot(ZE),a=uu.dot(this.direction),l=-uu.dot(ZE),c=uu.lengthSq(),d=Math.abs(1-o*o);let h,p,m,g;if(d>0)if(h=o*l-a,p=o*a-l,g=s*d,h>=0)if(p>=-g)if(p<=g){const b=1/d;h*=b,p*=b,m=h*(h+o*p+2*a)+p*(o*h+p+2*l)+c}else p=s,h=Math.max(0,-(o*p+a)),m=-h*h+p*(p+2*l)+c;else p=-s,h=Math.max(0,-(o*p+a)),m=-h*h+p*(p+2*l)+c;else p<=-g?(h=Math.max(0,-(-o*s+a)),p=h>0?-s:Math.min(Math.max(-s,-l),s),m=-h*h+p*(p+2*l)+c):p<=g?(h=0,p=Math.min(Math.max(-s,-l),s),m=p*(p+2*l)+c):(h=Math.max(0,-(o*s+a)),p=h>0?s:Math.min(Math.max(-s,-l),s),m=-h*h+p*(p+2*l)+c);else p=o>0?-s:s,h=Math.max(0,-(o*p+a)),m=-h*h+p*(p+2*l)+c;return i&&i.copy(this.origin).addScaledVector(this.direction,h),r&&r.copy(w1).addScaledVector(ZE,p),m}intersectSphere(e,t){jl.subVectors(e.center,this.origin);const i=jl.dot(this.direction),r=jl.dot(jl)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=i-o,l=i+o;return l<0?null:this.at(a<0?l:a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return null===i?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,s,o,a,l;const c=1/this.direction.x,d=1/this.direction.y,h=1/this.direction.z,p=this.origin;return c>=0?(i=(e.min.x-p.x)*c,r=(e.max.x-p.x)*c):(i=(e.max.x-p.x)*c,r=(e.min.x-p.x)*c),d>=0?(s=(e.min.y-p.y)*d,o=(e.max.y-p.y)*d):(s=(e.max.y-p.y)*d,o=(e.min.y-p.y)*d),i>o||s>r||((s>i||isNaN(i))&&(i=s),(o<r||isNaN(r))&&(r=o),h>=0?(a=(e.min.z-p.z)*h,l=(e.max.z-p.z)*h):(a=(e.max.z-p.z)*h,l=(e.min.z-p.z)*h),i>l||a>r)||((a>i||i!=i)&&(i=a),(l<r||r!=r)&&(r=l),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return null!==this.intersectBox(e,jl)}intersectTriangle(e,t,i,r,s){E1.subVectors(t,e),KE.subVectors(i,e),S1.crossVectors(E1,KE);let a,o=this.direction.dot(S1);if(o>0){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}uu.subVectors(this.origin,e);const l=a*this.direction.dot(KE.crossVectors(uu,KE));if(l<0)return null;const c=a*this.direction.dot(E1.cross(uu));if(c<0||l+c>o)return null;const d=-a*uu.dot(S1);return d<0?null:this.at(d/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class bt{constructor(e,t,i,r,s,o,a,l,c,d,h,p,m,g,b,v){bt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,i,r,s,o,a,l,c,d,h,p,m,g,b,v)}set(e,t,i,r,s,o,a,l,c,d,h,p,m,g,b,v){const y=this.elements;return y[0]=e,y[4]=t,y[8]=i,y[12]=r,y[1]=s,y[5]=o,y[9]=a,y[13]=l,y[2]=c,y[6]=d,y[10]=h,y[14]=p,y[3]=m,y[7]=g,y[11]=b,y[15]=v,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new bt).fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/Jp.setFromMatrixColumn(e,0).length(),s=1/Jp.setFromMatrixColumn(e,1).length(),o=1/Jp.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),l=Math.cos(r),c=Math.sin(r),d=Math.cos(s),h=Math.sin(s);if("XYZ"===e.order){const p=o*d,m=o*h,g=a*d,b=a*h;t[0]=l*d,t[4]=-l*h,t[8]=c,t[1]=m+g*c,t[5]=p-b*c,t[9]=-a*l,t[2]=b-p*c,t[6]=g+m*c,t[10]=o*l}else if("YXZ"===e.order){const p=l*d,m=l*h,g=c*d,b=c*h;t[0]=p+b*a,t[4]=g*a-m,t[8]=o*c,t[1]=o*h,t[5]=o*d,t[9]=-a,t[2]=m*a-g,t[6]=b+p*a,t[10]=o*l}else if("ZXY"===e.order){const p=l*d,m=l*h,g=c*d,b=c*h;t[0]=p-b*a,t[4]=-o*h,t[8]=g+m*a,t[1]=m+g*a,t[5]=o*d,t[9]=b-p*a,t[2]=-o*c,t[6]=a,t[10]=o*l}else if("ZYX"===e.order){const p=o*d,m=o*h,g=a*d,b=a*h;t[0]=l*d,t[4]=g*c-m,t[8]=p*c+b,t[1]=l*h,t[5]=b*c+p,t[9]=m*c-g,t[2]=-c,t[6]=a*l,t[10]=o*l}else if("YZX"===e.order){const p=o*l,m=o*c,g=a*l,b=a*c;t[0]=l*d,t[4]=b-p*h,t[8]=g*h+m,t[1]=h,t[5]=o*d,t[9]=-a*d,t[2]=-c*d,t[6]=m*h+g,t[10]=p-b*h}else if("XZY"===e.order){const p=o*l,m=o*c,g=a*l,b=a*c;t[0]=l*d,t[4]=-h,t[8]=c*d,t[1]=p*h+b,t[5]=o*d,t[9]=m*h-g,t[2]=g*h-m,t[6]=a*d,t[10]=b*h+p}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(YK,e,ZK)}lookAt(e,t,i){const r=this.elements;return Js.subVectors(e,t),0===Js.lengthSq()&&(Js.z=1),Js.normalize(),du.crossVectors(i,Js),0===du.lengthSq()&&(1===Math.abs(i.z)?Js.x+=1e-4:Js.z+=1e-4,Js.normalize(),du.crossVectors(i,Js)),du.normalize(),JE.crossVectors(Js,du),r[0]=du.x,r[4]=JE.x,r[8]=Js.x,r[1]=du.y,r[5]=JE.y,r[9]=Js.y,r[2]=du.z,r[6]=JE.z,r[10]=Js.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[4],l=i[8],c=i[12],d=i[1],h=i[5],p=i[9],m=i[13],g=i[2],b=i[6],v=i[10],y=i[14],w=i[3],E=i[7],x=i[11],C=i[15],A=r[0],D=r[4],O=r[8],T=r[12],L=r[1],X=r[5],re=r[9],ae=r[13],H=r[2],J=r[6],j=r[10],$=r[14],Q=r[3],K=r[7],ce=r[11],q=r[15];return s[0]=o*A+a*L+l*H+c*Q,s[4]=o*D+a*X+l*J+c*K,s[8]=o*O+a*re+l*j+c*ce,s[12]=o*T+a*ae+l*$+c*q,s[1]=d*A+h*L+p*H+m*Q,s[5]=d*D+h*X+p*J+m*K,s[9]=d*O+h*re+p*j+m*ce,s[13]=d*T+h*ae+p*$+m*q,s[2]=g*A+b*L+v*H+y*Q,s[6]=g*D+b*X+v*J+y*K,s[10]=g*O+b*re+v*j+y*ce,s[14]=g*T+b*ae+v*$+y*q,s[3]=w*A+E*L+x*H+C*Q,s[7]=w*D+E*X+x*J+C*K,s[11]=w*O+E*re+x*j+C*ce,s[15]=w*T+E*ae+x*$+C*q,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],d=e[2],h=e[6],p=e[10],m=e[14];return e[3]*(+s*l*h-r*c*h-s*a*p+i*c*p+r*a*m-i*l*m)+e[7]*(+t*l*m-t*c*p+s*o*p-r*o*m+r*c*d-s*l*d)+e[11]*(+t*c*h-t*a*m-s*o*h+i*o*m+s*a*d-i*c*d)+e[15]*(-r*a*d-t*l*h+t*a*p+r*o*h-i*o*p+i*l*d)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],d=e[8],h=e[9],p=e[10],m=e[11],g=e[12],b=e[13],v=e[14],y=e[15],w=h*v*c-b*p*c+b*l*m-a*v*m-h*l*y+a*p*y,E=g*p*c-d*v*c-g*l*m+o*v*m+d*l*y-o*p*y,x=d*b*c-g*h*c+g*a*m-o*b*m-d*a*y+o*h*y,C=g*h*l-d*b*l-g*a*p+o*b*p+d*a*v-o*h*v,A=t*w+i*E+r*x+s*C;if(0===A)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const D=1/A;return e[0]=w*D,e[1]=(b*p*s-h*v*s-b*r*m+i*v*m+h*r*y-i*p*y)*D,e[2]=(a*v*s-b*l*s+b*r*c-i*v*c-a*r*y+i*l*y)*D,e[3]=(h*l*s-a*p*s-h*r*c+i*p*c+a*r*m-i*l*m)*D,e[4]=E*D,e[5]=(d*v*s-g*p*s+g*r*m-t*v*m-d*r*y+t*p*y)*D,e[6]=(g*l*s-o*v*s-g*r*c+t*v*c+o*r*y-t*l*y)*D,e[7]=(o*p*s-d*l*s+d*r*c-t*p*c-o*r*m+t*l*m)*D,e[8]=x*D,e[9]=(g*h*s-d*b*s-g*i*m+t*b*m+d*i*y-t*h*y)*D,e[10]=(o*b*s-g*a*s+g*i*c-t*b*c-o*i*y+t*a*y)*D,e[11]=(d*a*s-o*h*s-d*i*c+t*h*c+o*i*m-t*a*m)*D,e[12]=C*D,e[13]=(d*b*r-g*h*r+g*i*p-t*b*p-d*i*v+t*h*v)*D,e[14]=(g*a*r-o*b*r-g*i*l+t*b*l+o*i*v-t*a*v)*D,e[15]=(o*h*r-d*a*r+d*i*l-t*h*l-o*i*p+t*a*p)*D,this}scale(e){const t=this.elements,i=e.x,r=e.y,s=e.z;return t[0]*=i,t[4]*=r,t[8]*=s,t[1]*=i,t[5]*=r,t[9]*=s,t[2]*=i,t[6]*=r,t[10]*=s,t[3]*=i,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),s=1-i,o=e.x,a=e.y,l=e.z,c=s*o,d=s*a;return this.set(c*o+i,c*a-r*l,c*l+r*a,0,c*a+r*l,d*a+i,d*l-r*o,0,c*l-r*a,d*l+r*o,s*l*l+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,c=s+s,d=o+o,h=a+a,p=s*c,m=s*d,g=s*h,b=o*d,v=o*h,y=a*h,w=l*c,E=l*d,x=l*h,C=i.x,A=i.y,D=i.z;return r[0]=(1-(b+y))*C,r[1]=(m+x)*C,r[2]=(g-E)*C,r[3]=0,r[4]=(m-x)*A,r[5]=(1-(p+y))*A,r[6]=(v+w)*A,r[7]=0,r[8]=(g+E)*D,r[9]=(v-w)*D,r[10]=(1-(p+b))*D,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let s=Jp.set(r[0],r[1],r[2]).length();const o=Jp.set(r[4],r[5],r[6]).length(),a=Jp.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],la.copy(this);const c=1/s,d=1/o,h=1/a;return la.elements[0]*=c,la.elements[1]*=c,la.elements[2]*=c,la.elements[4]*=d,la.elements[5]*=d,la.elements[6]*=d,la.elements[8]*=h,la.elements[9]*=h,la.elements[10]*=h,t.setFromRotationMatrix(la),i.x=s,i.y=o,i.z=a,this}makePerspective(e,t,i,r,s,o,a=zl){const l=this.elements,c=2*s/(t-e),d=2*s/(i-r),h=(t+e)/(t-e),p=(i+r)/(i-r);let m,g;if(a===zl)m=-(o+s)/(o-s),g=-2*o*s/(o-s);else{if(2001!==a)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);m=-o/(o-s),g=-o*s/(o-s)}return l[0]=c,l[4]=0,l[8]=h,l[12]=0,l[1]=0,l[5]=d,l[9]=p,l[13]=0,l[2]=0,l[6]=0,l[10]=m,l[14]=g,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,i,r,s,o,a=zl){const l=this.elements,c=1/(t-e),d=1/(i-r),h=1/(o-s),p=(t+e)*c,m=(i+r)*d;let g,b;if(a===zl)g=(o+s)*h,b=-2*h;else{if(2001!==a)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);g=s*h,b=-1*h}return l[0]=2*c,l[4]=0,l[8]=0,l[12]=-p,l[1]=0,l[5]=2*d,l[9]=0,l[13]=-m,l[2]=0,l[6]=0,l[10]=b,l[14]=-g,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const Jp=new N,la=new bt,YK=new N(0,0,0),ZK=new N(1,1,1),du=new N,JE=new N,Js=new N,dB=new bt,hB=new Bn;let fB=(()=>{class n{constructor(t=0,i=0,r=0,s=n.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=i,this._z=r,this._order=s}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,i,r,s=this._order){return this._x=t,this._y=i,this._z=r,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,i=this._order,r=!0){const s=t.elements,o=s[0],a=s[4],l=s[8],c=s[1],d=s[5],h=s[9],p=s[2],m=s[6],g=s[10];switch(i){case"XYZ":this._y=Math.asin(yi(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-h,g),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(m,d),this._z=0);break;case"YXZ":this._x=Math.asin(-yi(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(l,g),this._z=Math.atan2(c,d)):(this._y=Math.atan2(-p,o),this._z=0);break;case"ZXY":this._x=Math.asin(yi(m,-1,1)),Math.abs(m)<.9999999?(this._y=Math.atan2(-p,g),this._z=Math.atan2(-a,d)):(this._y=0,this._z=Math.atan2(c,o));break;case"ZYX":this._y=Math.asin(-yi(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(m,g),this._z=Math.atan2(c,o)):(this._x=0,this._z=Math.atan2(-a,d));break;case"YZX":this._z=Math.asin(yi(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-h,d),this._y=Math.atan2(-p,o)):(this._x=0,this._y=Math.atan2(l,g));break;case"XZY":this._z=Math.asin(-yi(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(m,d),this._y=Math.atan2(l,o)):(this._x=Math.atan2(-h,g),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,!0===r&&this._onChangeCallback(),this}setFromQuaternion(t,i,r){return dB.makeRotationFromQuaternion(t),this.setFromRotationMatrix(dB,i,r)}setFromVector3(t,i=this._order){return this.set(t.x,t.y,t.z,i)}reorder(t){return hB.setFromEuler(this),this.setFromQuaternion(hB,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],i=0){return t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return n.DEFAULT_ORDER="XYZ",n})();class x1{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let KK=0;const pB=new N,Qp=new Bn,$l=new bt,QE=new N,$y=new N,JK=new N,QK=new Bn,mB=new N(1,0,0),gB=new N(0,1,0),_B=new N(0,0,1),eJ={type:"added"},tJ={type:"removed"};let vi=(()=>{class n extends Vd{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:KK++}),this.uuid=Ks(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=n.DEFAULT_UP.clone();const t=new N,i=new fB,r=new Bn,s=new N(1,1,1);i._onChange(function o(){r.setFromEuler(i,!1)}),r._onChange(function a(){i.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new bt},normalMatrix:{value:new Zt}}),this.matrix=new bt,this.matrixWorld=new bt,this.matrixAutoUpdate=n.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new x1,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,i){this.quaternion.setFromAxisAngle(t,i)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,i){return Qp.setFromAxisAngle(t,i),this.quaternion.multiply(Qp),this}rotateOnWorldAxis(t,i){return Qp.setFromAxisAngle(t,i),this.quaternion.premultiply(Qp),this}rotateX(t){return this.rotateOnAxis(mB,t)}rotateY(t){return this.rotateOnAxis(gB,t)}rotateZ(t){return this.rotateOnAxis(_B,t)}translateOnAxis(t,i){return pB.copy(t).applyQuaternion(this.quaternion),this.position.add(pB.multiplyScalar(i)),this}translateX(t){return this.translateOnAxis(mB,t)}translateY(t){return this.translateOnAxis(gB,t)}translateZ(t){return this.translateOnAxis(_B,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4($l.copy(this.matrixWorld).invert())}lookAt(t,i,r){t.isVector3?QE.copy(t):QE.set(t,i,r);const s=this.parent;this.updateWorldMatrix(!0,!1),$y.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?$l.lookAt($y,QE,this.up):$l.lookAt(QE,$y,this.up),this.quaternion.setFromRotationMatrix($l),s&&($l.extractRotation(s.matrixWorld),Qp.setFromRotationMatrix($l),this.quaternion.premultiply(Qp.invert()))}add(t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(eJ)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const i=this.children.indexOf(t);return-1!==i&&(t.parent=null,this.children.splice(i,1),t.dispatchEvent(tJ)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),$l.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),$l.multiply(t.parent.matrixWorld)),t.applyMatrix4($l),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,i){if(this[t]===i)return this;for(let r=0,s=this.children.length;r<s;r++){const a=this.children[r].getObjectByProperty(t,i);if(void 0!==a)return a}}getObjectsByProperty(t,i){let r=[];this[t]===i&&r.push(this);for(let s=0,o=this.children.length;s<o;s++){const a=this.children[s].getObjectsByProperty(t,i);a.length>0&&(r=r.concat(a))}return r}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose($y,t,JK),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose($y,QK,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return t.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(t){t(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].traverseVisible(t)}traverseAncestors(t){const i=this.parent;null!==i&&(t(i),i.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const i=this.children;for(let r=0,s=i.length;r<s;r++){const o=i[r];(!0===o.matrixWorldAutoUpdate||!0===t)&&o.updateMatrixWorld(t)}}updateWorldMatrix(t,i){const r=this.parent;if(!0===t&&null!==r&&!0===r.matrixWorldAutoUpdate&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===i){const s=this.children;for(let o=0,a=s.length;o<a;o++){const l=s[o];!0===l.matrixWorldAutoUpdate&&l.updateWorldMatrix(!1,!0)}}}toJSON(t){const i=void 0===t||"string"==typeof t,r={};i&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const s={};function o(l,c){return void 0===l[c.uuid]&&(l[c.uuid]=c.toJSON(t)),c.uuid}if(s.uuid=this.uuid,s.type=this.type,""!==this.name&&(s.name=this.name),!0===this.castShadow&&(s.castShadow=!0),!0===this.receiveShadow&&(s.receiveShadow=!0),!1===this.visible&&(s.visible=!1),!1===this.frustumCulled&&(s.frustumCulled=!1),0!==this.renderOrder&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(s.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(s.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=o(t.geometries,this.geometry);const l=this.geometry.parameters;if(void 0!==l&&void 0!==l.shapes){const c=l.shapes;if(Array.isArray(c))for(let d=0,h=c.length;d<h;d++)o(t.shapes,c[d]);else o(t.shapes,c)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(o(t.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const l=[];for(let c=0,d=this.material.length;c<d;c++)l.push(o(t.materials,this.material[c]));s.material=l}else s.material=o(t.materials,this.material);if(this.children.length>0){s.children=[];for(let l=0;l<this.children.length;l++)s.children.push(this.children[l].toJSON(t).object)}if(this.animations.length>0){s.animations=[];for(let l=0;l<this.animations.length;l++)s.animations.push(o(t.animations,this.animations[l]))}if(i){const l=a(t.geometries),c=a(t.materials),d=a(t.textures),h=a(t.images),p=a(t.shapes),m=a(t.skeletons),g=a(t.animations),b=a(t.nodes);l.length>0&&(r.geometries=l),c.length>0&&(r.materials=c),d.length>0&&(r.textures=d),h.length>0&&(r.images=h),p.length>0&&(r.shapes=p),m.length>0&&(r.skeletons=m),g.length>0&&(r.animations=g),b.length>0&&(r.nodes=b)}return r.object=s,r;function a(l){const c=[];for(const d in l){const h=l[d];delete h.metadata,c.push(h)}return c}}clone(t){return(new this.constructor).copy(this,t)}copy(t,i=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),!0===i)for(let r=0;r<t.children.length;r++)this.add(t.children[r].clone());return this}}return n.DEFAULT_UP=new N(0,1,0),n.DEFAULT_MATRIX_AUTO_UPDATE=!0,n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,n})();const ca=new N,ql=new N,M1=new N,Xl=new N,em=new N,tm=new N,yB=new N,C1=new N,T1=new N,A1=new N;let eS=!1;class Qs{constructor(e=new N,t=new N,i=new N){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),ca.subVectors(e,t),r.cross(ca);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,i,r,s){ca.subVectors(r,t),ql.subVectors(i,t),M1.subVectors(e,t);const o=ca.dot(ca),a=ca.dot(ql),l=ca.dot(M1),c=ql.dot(ql),d=ql.dot(M1),h=o*c-a*a;if(0===h)return s.set(-2,-1,-1);const p=1/h,m=(c*l-a*d)*p,g=(o*d-a*l)*p;return s.set(1-m-g,g,m)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,Xl),Xl.x>=0&&Xl.y>=0&&Xl.x+Xl.y<=1}static getUV(e,t,i,r,s,o,a,l){return!1===eS&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),eS=!0),this.getInterpolation(e,t,i,r,s,o,a,l)}static getInterpolation(e,t,i,r,s,o,a,l){return this.getBarycoord(e,t,i,r,Xl),l.setScalar(0),l.addScaledVector(s,Xl.x),l.addScaledVector(o,Xl.y),l.addScaledVector(a,Xl.z),l}static isFrontFacing(e,t,i,r){return ca.subVectors(i,t),ql.subVectors(e,t),ca.cross(ql).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return ca.subVectors(this.c,this.b),ql.subVectors(this.a,this.b),.5*ca.cross(ql).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Qs.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Qs.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,r,s){return!1===eS&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),eS=!0),Qs.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}getInterpolation(e,t,i,r,s){return Qs.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}containsPoint(e){return Qs.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Qs.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,s=this.c;let o,a;em.subVectors(r,i),tm.subVectors(s,i),C1.subVectors(e,i);const l=em.dot(C1),c=tm.dot(C1);if(l<=0&&c<=0)return t.copy(i);T1.subVectors(e,r);const d=em.dot(T1),h=tm.dot(T1);if(d>=0&&h<=d)return t.copy(r);const p=l*h-d*c;if(p<=0&&l>=0&&d<=0)return o=l/(l-d),t.copy(i).addScaledVector(em,o);A1.subVectors(e,s);const m=em.dot(A1),g=tm.dot(A1);if(g>=0&&m<=g)return t.copy(s);const b=m*c-l*g;if(b<=0&&c>=0&&g<=0)return a=c/(c-g),t.copy(i).addScaledVector(tm,a);const v=d*g-m*h;if(v<=0&&h-d>=0&&m-g>=0)return yB.subVectors(s,r),a=(h-d)/(h-d+(m-g)),t.copy(r).addScaledVector(yB,a);const y=1/(v+b+p);return o=b*y,a=p*y,t.copy(i).addScaledVector(em,o).addScaledVector(tm,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let nJ=0;class hs extends Vd{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:nJ++}),this.uuid=Ks(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const i=e[t];if(void 0===i){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i:console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`)}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),void 0!==this.sheen&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(i.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(i.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(i.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(i.combine=this.combine)),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(i.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(i.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(i.size=this.size),null!==this.shadowSide&&(i.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(i.blending=this.blending),0!==this.side&&(i.side=this.side),!0===this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=!0),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.alphaHash&&(i.alphaHash=!0),!0===this.alphaToCoverage&&(i.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=!0),!0===this.forceSinglePass&&(i.forceSinglePass=!0),!0===this.wireframe&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(i.flatShading=!0),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),!1===this.fog&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData),t){const s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(null!==t){const r=t.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=t[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}const vB={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},hu={h:0,s:0,l:0},tS={h:0,s:0,l:0};function D1(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+6*(e-n)*t:t<.5?e:t<2/3?n+6*(e-n)*(2/3-t):n}class je{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(void 0===t&&void 0===i){const r=e;r&&r.isColor?this.copy(r):"number"==typeof r?this.setHex(r):"string"==typeof r&&this.setStyle(r)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=ui){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,En.toWorkingColorSpace(this,t),this}setRGB(e,t,i,r=En.workingColorSpace){return this.r=e,this.g=t,this.b=i,En.toWorkingColorSpace(this,r),this}setHSL(e,t,i,r=En.workingColorSpace){if(e=h1(e,1),t=yi(t,0,1),i=yi(i,0,1),0===t)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+t):i+t-i*t,o=2*i-s;this.r=D1(o,s,e+1/3),this.g=D1(o,s,e),this.b=D1(o,s,e-1/3)}return En.toWorkingColorSpace(this,r),this}setStyle(e,t=ui){function i(s){void 0!==s&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const a=r[2];switch(r[1]){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(3===o)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(6===o)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=ui){const i=vB[e.toLowerCase()];return void 0!==i?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Wp(e.r),this.g=Wp(e.g),this.b=Wp(e.b),this}copyLinearToSRGB(e){return this.r=m1(e.r),this.g=m1(e.g),this.b=m1(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=ui){return En.fromWorkingColorSpace(zr.copy(this),e),65536*Math.round(yi(255*zr.r,0,255))+256*Math.round(yi(255*zr.g,0,255))+Math.round(yi(255*zr.b,0,255))}getHexString(e=ui){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=En.workingColorSpace){En.fromWorkingColorSpace(zr.copy(this),t);const i=zr.r,r=zr.g,s=zr.b,o=Math.max(i,r,s),a=Math.min(i,r,s);let l,c;const d=(a+o)/2;if(a===o)l=0,c=0;else{const h=o-a;switch(c=d<=.5?h/(o+a):h/(2-o-a),o){case i:l=(r-s)/h+(r<s?6:0);break;case r:l=(s-i)/h+2;break;case s:l=(i-r)/h+4}l/=6}return e.h=l,e.s=c,e.l=d,e}getRGB(e,t=En.workingColorSpace){return En.fromWorkingColorSpace(zr.copy(this),t),e.r=zr.r,e.g=zr.g,e.b=zr.b,e}getStyle(e=ui){En.fromWorkingColorSpace(zr.copy(this),e);const t=zr.r,i=zr.g,r=zr.b;return e!==ui?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(255*t)},${Math.round(255*i)},${Math.round(255*r)})`}offsetHSL(e,t,i){return this.getHSL(hu),this.setHSL(hu.h+e,hu.s+t,hu.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(hu),e.getHSL(tS);const i=Hy(hu.h,tS.h,t),r=Hy(hu.s,tS.s,t),s=Hy(hu.l,tS.l,t);return this.setHSL(i,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,i=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*i+s[6]*r,this.g=s[1]*t+s[4]*i+s[7]*r,this.b=s[2]*t+s[5]*i+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const zr=new je;je.NAMES=vB;class bi extends hs{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new je(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=OE,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const $i=new N,nS=new fe;class ti{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=i,this.usage=35044,this.updateRange={offset:0,count:-1},this.gpuType=Hl,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,i=this.count;t<i;t++)nS.fromBufferAttribute(this,t),nS.applyMatrix3(e),this.setXY(t,nS.x,nS.y);else if(3===this.itemSize)for(let t=0,i=this.count;t<i;t++)$i.fromBufferAttribute(this,t),$i.applyMatrix3(e),this.setXYZ(t,$i.x,$i.y,$i.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)$i.fromBufferAttribute(this,t),$i.applyMatrix4(e),this.setXYZ(t,$i.x,$i.y,$i.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)$i.fromBufferAttribute(this,t),$i.applyNormalMatrix(e),this.setXYZ(t,$i.x,$i.y,$i.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)$i.fromBufferAttribute(this,t),$i.transformDirection(e),this.setXYZ(t,$i.x,$i.y,$i.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=Is(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=Wt(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Is(t,this.array)),t}setX(e,t){return this.normalized&&(t=Wt(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Is(t,this.array)),t}setY(e,t){return this.normalized&&(t=Wt(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Is(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Wt(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Is(t,this.array)),t}setW(e,t){return this.normalized&&(t=Wt(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=Wt(t,this.array),i=Wt(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=Wt(t,this.array),i=Wt(i,this.array),r=Wt(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=Wt(t,this.array),i=Wt(i,this.array),r=Wt(r,this.array),s=Wt(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}}class bB extends ti{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class wB extends ti{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class Xe extends ti{constructor(e,t,i){super(new Float32Array(e),t,i)}}let rJ=0;const Mo=new bt,I1=new vi,nm=new N,eo=new Wa,Xy=new Wa,pr=new N;class Nt extends Vd{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:rJ++}),this.uuid=Ks(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(rB(e)?wB:bB)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(void 0!==i){const s=(new Zt).getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return Mo.makeRotationFromQuaternion(e),this.applyMatrix4(Mo),this}rotateX(e){return Mo.makeRotationX(e),this.applyMatrix4(Mo),this}rotateY(e){return Mo.makeRotationY(e),this.applyMatrix4(Mo),this}rotateZ(e){return Mo.makeRotationZ(e),this.applyMatrix4(Mo),this}translate(e,t,i){return Mo.makeTranslation(e,t,i),this.applyMatrix4(Mo),this}scale(e,t,i){return Mo.makeScale(e,t,i),this.applyMatrix4(Mo),this}lookAt(e){return I1.lookAt(e),I1.updateMatrix(),this.applyMatrix4(I1.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(nm).negate(),this.translate(nm.x,nm.y,nm.z),this}setFromPoints(e){const t=[];for(let i=0,r=e.length;i<r;i++){const s=e[i];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new Xe(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Wa);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new N(-1/0,-1/0,-1/0),new N(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++)eo.setFromBufferAttribute(t[i]),this.morphTargetsRelative?(pr.addVectors(this.boundingBox.min,eo.min),this.boundingBox.expandByPoint(pr),pr.addVectors(this.boundingBox.max,eo.max),this.boundingBox.expandByPoint(pr)):(this.boundingBox.expandByPoint(eo.min),this.boundingBox.expandByPoint(eo.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new aa);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new N,1/0);if(e){const i=this.boundingSphere.center;if(eo.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++)Xy.setFromBufferAttribute(t[s]),this.morphTargetsRelative?(pr.addVectors(eo.min,Xy.min),eo.expandByPoint(pr),pr.addVectors(eo.max,Xy.max),eo.expandByPoint(pr)):(eo.expandByPoint(Xy.min),eo.expandByPoint(Xy.max));eo.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)pr.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(pr));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let c=0,d=a.count;c<d;c++)pr.fromBufferAttribute(a,c),l&&(nm.fromBufferAttribute(e,c),pr.add(nm)),r=Math.max(r,i.distanceToSquared(pr))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const i=e.array,r=t.position.array,s=t.normal.array,o=t.uv.array,a=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new ti(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,c=[],d=[];for(let L=0;L<a;L++)c[L]=new N,d[L]=new N;const h=new N,p=new N,m=new N,g=new fe,b=new fe,v=new fe,y=new N,w=new N;function E(L,X,re){h.fromArray(r,3*L),p.fromArray(r,3*X),m.fromArray(r,3*re),g.fromArray(o,2*L),b.fromArray(o,2*X),v.fromArray(o,2*re),p.sub(h),m.sub(h),b.sub(g),v.sub(g);const ae=1/(b.x*v.y-v.x*b.y);isFinite(ae)&&(y.copy(p).multiplyScalar(v.y).addScaledVector(m,-b.y).multiplyScalar(ae),w.copy(m).multiplyScalar(b.x).addScaledVector(p,-v.x).multiplyScalar(ae),c[L].add(y),c[X].add(y),c[re].add(y),d[L].add(w),d[X].add(w),d[re].add(w))}let x=this.groups;0===x.length&&(x=[{start:0,count:i.length}]);for(let L=0,X=x.length;L<X;++L){const re=x[L],ae=re.start;for(let J=ae,j=ae+re.count;J<j;J+=3)E(i[J+0],i[J+1],i[J+2])}const C=new N,A=new N,D=new N,O=new N;function T(L){D.fromArray(s,3*L),O.copy(D);const X=c[L];C.copy(X),C.sub(D.multiplyScalar(D.dot(X))).normalize(),A.crossVectors(O,X);const ae=A.dot(d[L])<0?-1:1;l[4*L]=C.x,l[4*L+1]=C.y,l[4*L+2]=C.z,l[4*L+3]=ae}for(let L=0,X=x.length;L<X;++L){const re=x[L],ae=re.start;for(let J=ae,j=ae+re.count;J<j;J+=3)T(i[J+0]),T(i[J+1]),T(i[J+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let i=this.getAttribute("normal");if(void 0===i)i=new ti(new Float32Array(3*t.count),3),this.setAttribute("normal",i);else for(let p=0,m=i.count;p<m;p++)i.setXYZ(p,0,0,0);const r=new N,s=new N,o=new N,a=new N,l=new N,c=new N,d=new N,h=new N;if(e)for(let p=0,m=e.count;p<m;p+=3){const g=e.getX(p+0),b=e.getX(p+1),v=e.getX(p+2);r.fromBufferAttribute(t,g),s.fromBufferAttribute(t,b),o.fromBufferAttribute(t,v),d.subVectors(o,s),h.subVectors(r,s),d.cross(h),a.fromBufferAttribute(i,g),l.fromBufferAttribute(i,b),c.fromBufferAttribute(i,v),a.add(d),l.add(d),c.add(d),i.setXYZ(g,a.x,a.y,a.z),i.setXYZ(b,l.x,l.y,l.z),i.setXYZ(v,c.x,c.y,c.z)}else for(let p=0,m=t.count;p<m;p+=3)r.fromBufferAttribute(t,p+0),s.fromBufferAttribute(t,p+1),o.fromBufferAttribute(t,p+2),d.subVectors(o,s),h.subVectors(r,s),d.cross(h),i.setXYZ(p+0,d.x,d.y,d.z),i.setXYZ(p+1,d.x,d.y,d.z),i.setXYZ(p+2,d.x,d.y,d.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)pr.fromBufferAttribute(e,t),pr.normalize(),e.setXYZ(t,pr.x,pr.y,pr.z)}toNonIndexed(){function e(a,l){const c=a.array,d=a.itemSize,h=a.normalized,p=new c.constructor(l.length*d);let m=0,g=0;for(let b=0,v=l.length;b<v;b++){m=a.isInterleavedBufferAttribute?l[b]*a.data.stride+a.offset:l[b]*d;for(let y=0;y<d;y++)p[g++]=c[m++]}return new ti(p,d,h)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Nt,i=this.index.array,r=this.attributes;for(const a in r){const c=e(r[a],i);t.setAttribute(a,c)}const s=this.morphAttributes;for(const a in s){const l=[],c=s[a];for(let d=0,h=c.length;d<h;d++){const m=e(c[d],i);l.push(m)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const c=o[a];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const l=this.parameters;for(const c in l)void 0!==l[c]&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const l in i)e.data.attributes[l]=i[l].toJSON(e.data);const r={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],d=[];for(let h=0,p=c.length;h<p;h++)d.push(c[h].toJSON(e.data));d.length>0&&(r[l]=d,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return null!==a&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;null!==i&&this.setIndex(i.clone(t));const r=e.attributes;for(const c in r)this.setAttribute(c,r[c].clone(t));const s=e.morphAttributes;for(const c in s){const d=[],h=s[c];for(let p=0,m=h.length;p<m;p++)d.push(h[p].clone(t));this.morphAttributes[c]=d}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let c=0,d=o.length;c<d;c++){const h=o[c];this.addGroup(h.start,h.count,h.materialIndex)}const a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());const l=e.boundingSphere;return null!==l&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const EB=new bt,jd=new Kp,iS=new aa,SB=new N,im=new N,rm=new N,sm=new N,R1=new N,rS=new N,sS=new fe,oS=new fe,aS=new fe,xB=new N,MB=new N,CB=new N,lS=new N,cS=new N;class Ce extends vi{constructor(e=new Nt,t=new bi){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){const i=this.geometry,s=i.morphAttributes.position,o=i.morphTargetsRelative;t.fromBufferAttribute(i.attributes.position,e);const a=this.morphTargetInfluences;if(s&&a){rS.set(0,0,0);for(let l=0,c=s.length;l<c;l++){const d=a[l];0!==d&&(R1.fromBufferAttribute(s[l],e),rS.addScaledVector(o?R1:R1.sub(t),d))}t.add(rS)}return t}raycast(e,t){const i=this.geometry,s=this.matrixWorld;void 0!==this.material&&(null===i.boundingSphere&&i.computeBoundingSphere(),iS.copy(i.boundingSphere),iS.applyMatrix4(s),jd.copy(e.ray).recast(e.near),(!1!==iS.containsPoint(jd.origin)||!(null===jd.intersectSphere(iS,SB)||jd.origin.distanceToSquared(SB)>(e.far-e.near)**2))&&(EB.copy(s).invert(),jd.copy(e.ray).applyMatrix4(EB),(null===i.boundingBox||!1!==jd.intersectsBox(i.boundingBox))&&this._computeIntersections(e,t,jd)))}_computeIntersections(e,t,i){let r;const s=this.geometry,o=this.material,a=s.index,l=s.attributes.position,c=s.attributes.uv,d=s.attributes.uv1,h=s.attributes.normal,p=s.groups,m=s.drawRange;if(null!==a)if(Array.isArray(o))for(let g=0,b=p.length;g<b;g++){const v=p[g],y=o[v.materialIndex];for(let x=Math.max(v.start,m.start),C=Math.min(a.count,Math.min(v.start+v.count,m.start+m.count));x<C;x+=3)r=uS(this,y,e,i,c,d,h,a.getX(x),a.getX(x+1),a.getX(x+2)),r&&(r.faceIndex=Math.floor(x/3),r.face.materialIndex=v.materialIndex,t.push(r))}else for(let v=Math.max(0,m.start),y=Math.min(a.count,m.start+m.count);v<y;v+=3)r=uS(this,o,e,i,c,d,h,a.getX(v),a.getX(v+1),a.getX(v+2)),r&&(r.faceIndex=Math.floor(v/3),t.push(r));else if(void 0!==l)if(Array.isArray(o))for(let g=0,b=p.length;g<b;g++){const v=p[g],y=o[v.materialIndex];for(let x=Math.max(v.start,m.start),C=Math.min(l.count,Math.min(v.start+v.count,m.start+m.count));x<C;x+=3)r=uS(this,y,e,i,c,d,h,x,x+1,x+2),r&&(r.faceIndex=Math.floor(x/3),r.face.materialIndex=v.materialIndex,t.push(r))}else for(let v=Math.max(0,m.start),y=Math.min(l.count,m.start+m.count);v<y;v+=3)r=uS(this,o,e,i,c,d,h,v,v+1,v+2),r&&(r.faceIndex=Math.floor(v/3),t.push(r))}}function uS(n,e,t,i,r,s,o,a,l,c){n.getVertexPosition(a,im),n.getVertexPosition(l,rm),n.getVertexPosition(c,sm);const d=function sJ(n,e,t,i,r,s,o,a){let l;if(l=1===e.side?i.intersectTriangle(o,s,r,!0,a):i.intersectTriangle(r,s,o,0===e.side,a),null===l)return null;cS.copy(a),cS.applyMatrix4(n.matrixWorld);const c=t.ray.origin.distanceTo(cS);return c<t.near||c>t.far?null:{distance:c,point:cS.clone(),object:n}}(n,e,t,i,im,rm,sm,lS);if(d){r&&(sS.fromBufferAttribute(r,a),oS.fromBufferAttribute(r,l),aS.fromBufferAttribute(r,c),d.uv=Qs.getInterpolation(lS,im,rm,sm,sS,oS,aS,new fe)),s&&(sS.fromBufferAttribute(s,a),oS.fromBufferAttribute(s,l),aS.fromBufferAttribute(s,c),d.uv1=Qs.getInterpolation(lS,im,rm,sm,sS,oS,aS,new fe),d.uv2=d.uv1),o&&(xB.fromBufferAttribute(o,a),MB.fromBufferAttribute(o,l),CB.fromBufferAttribute(o,c),d.normal=Qs.getInterpolation(lS,im,rm,sm,xB,MB,CB,new N),d.normal.dot(i.direction)>0&&d.normal.multiplyScalar(-1));const h={a,b:l,c,normal:new N,materialIndex:0};Qs.getNormal(im,rm,sm,h.normal),d.face=h}return d}class si extends Nt{constructor(e=1,t=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],c=[],d=[],h=[];let p=0,m=0;function g(b,v,y,w,E,x,C,A,D,O,T){const L=x/D,X=C/O,re=x/2,ae=C/2,H=A/2,J=D+1,j=O+1;let $=0,Q=0;const K=new N;for(let ce=0;ce<j;ce++){const q=ce*X-ae;for(let oe=0;oe<J;oe++)K[b]=(oe*L-re)*w,K[v]=q*E,K[y]=H,c.push(K.x,K.y,K.z),K[b]=0,K[v]=0,K[y]=A>0?1:-1,d.push(K.x,K.y,K.z),h.push(oe/D),h.push(1-ce/O),$+=1}for(let ce=0;ce<O;ce++)for(let q=0;q<D;q++){const Me=p+q+J*(ce+1),we=p+(q+1)+J*(ce+1),ze=p+(q+1)+J*ce;l.push(p+q+J*ce,Me,ze),l.push(Me,we,ze),Q+=6}a.addGroup(m,Q,T),m+=Q,p+=$}g("z","y","x",-1,-1,i,t,e,o,s,0),g("z","y","x",1,-1,i,t,-e,o,s,1),g("x","z","y",1,1,e,i,t,r,o,2),g("x","z","y",1,-1,e,i,-t,r,o,3),g("x","y","z",1,-1,e,t,i,r,s,4),g("x","y","z",-1,-1,e,t,-i,r,s,5),this.setIndex(l),this.setAttribute("position",new Xe(c,3)),this.setAttribute("normal",new Xe(d,3)),this.setAttribute("uv",new Xe(h,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new si(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function om(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=r.clone():e[t][i]=Array.isArray(r)?r.slice():r}}return e}function fs(n){const e={};for(let t=0;t<n.length;t++){const i=om(n[t]);for(const r in i)e[r]=i[r]}return e}function TB(n){return null===n.getRenderTarget()?n.outputColorSpace:En.workingColorSpace}const aJ={clone:om,merge:fs};class fu extends hs{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=om(e.uniforms),this.uniformsGroups=function oJ(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;t.uniforms[r]=o&&o.isTexture?{type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?{type:"c",value:o.getHex()}:o&&o.isVector2?{type:"v2",value:o.toArray()}:o&&o.isVector3?{type:"v3",value:o.toArray()}:o&&o.isVector4?{type:"v4",value:o.toArray()}:o&&o.isMatrix3?{type:"m3",value:o.toArray()}:o&&o.isMatrix4?{type:"m4",value:o.toArray()}:{value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const i={};for(const r in this.extensions)!0===this.extensions[r]&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class P1 extends vi{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new bt,this.projectionMatrix=new bt,this.projectionMatrixInverse=new bt,this.coordinateSystem=zl}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class nr extends P1{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*zp*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*Hd*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*zp*Math.atan(Math.tan(.5*Hd*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,r,s,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*Hd*this.fov)/this.zoom,i=2*t,r=this.aspect*i,s=-.5*r;const o=this.view;if(null!==this.view&&this.view.enabled){const l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*r/l,t-=o.offsetY*i/c,r*=o.width/l,i*=o.height/c}const a=this.filmOffset;0!==a&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class uJ extends vi{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new nr(-90,1,e,t);r.layers=this.layers,this.add(r);const s=new nr(-90,1,e,t);s.layers=this.layers,this.add(s);const o=new nr(-90,1,e,t);o.layers=this.layers,this.add(o);const a=new nr(-90,1,e,t);a.layers=this.layers,this.add(a);const l=new nr(-90,1,e,t);l.layers=this.layers,this.add(l);const c=new nr(-90,1,e,t);c.layers=this.layers,this.add(c)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[i,r,s,o,a,l]=t;for(const c of t)this.remove(c);if(e===zl)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else{if(2001!==e)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1)}for(const c of t)this.add(c),c.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,o,a,l,c,d]=this.children,h=e.getRenderTarget(),p=e.getActiveCubeFace(),m=e.getActiveMipmapLevel(),g=e.xr.enabled;e.xr.enabled=!1;const b=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,r),e.render(t,s),e.setRenderTarget(i,1,r),e.render(t,o),e.setRenderTarget(i,2,r),e.render(t,a),e.setRenderTarget(i,3,r),e.render(t,l),e.setRenderTarget(i,4,r),e.render(t,c),i.texture.generateMipmaps=b,e.setRenderTarget(i,5,r),e.render(t,d),e.setRenderTarget(h,p,m),e.xr.enabled=g,i.texture.needsPMREMUpdate=!0}}class dS extends oa{constructor(e,t,i,r,s,o,a,l,c,d){super(e=void 0!==e?e:[],t=void 0!==t?t:ru,i,r,s,o,a,l,c,d),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class dJ extends zd{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];void 0!==t.encoding&&(Gy("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),t.colorSpace=t.encoding===Ud?ui:""),this.texture=new dS(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:_i}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i_uniforms={tEquirect:{value:null}},i_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",r=new si(5,5,5),s=new fu({name:"CubemapFromEquirect",uniforms:om(i_uniforms),vertexShader:i_vertexShader,fragmentShader:i_fragmentShader,side:1,blending:0});s.uniforms.tEquirect.value=t;const o=new Ce(r,s),a=t.minFilter;return t.minFilter===Vl&&(t.minFilter=_i),new uJ(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,i,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,i,r);e.setRenderTarget(s)}}const N1=new N,hJ=new N,fJ=new Zt;class pu{constructor(e=new N(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=N1.subVectors(i,t).cross(hJ.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(N1),r=this.normal.dot(i);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(i,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||fJ.getNormalMatrix(e),r=this.coplanarPoint(N1).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const $d=new aa,hS=new N;class L1{constructor(e=new pu,t=new pu,i=new pu,r=new pu,s=new pu,o=new pu){this.planes=[e,t,i,r,s,o]}set(e,t,i,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=zl){const i=this.planes,r=e.elements,s=r[0],o=r[1],a=r[2],l=r[3],c=r[4],d=r[5],h=r[6],p=r[7],m=r[8],g=r[9],b=r[10],v=r[11],y=r[12],w=r[13],E=r[14],x=r[15];if(i[0].setComponents(l-s,p-c,v-m,x-y).normalize(),i[1].setComponents(l+s,p+c,v+m,x+y).normalize(),i[2].setComponents(l+o,p+d,v+g,x+w).normalize(),i[3].setComponents(l-o,p-d,v-g,x-w).normalize(),i[4].setComponents(l-a,p-h,v-b,x-E).normalize(),t===zl)i[5].setComponents(l+a,p+h,v+b,x+E).normalize();else{if(2001!==t)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);i[5].setComponents(a,h,b,E).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),$d.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),$d.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere($d)}intersectsSprite(e){return $d.center.set(0,0,0),$d.radius=.7071067811865476,$d.applyMatrix4(e.matrixWorld),this.intersectsSphere($d)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(hS.x=r.normal.x>0?e.max.x:e.min.x,hS.y=r.normal.y>0?e.max.y:e.min.y,hS.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(hS)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function AB(){let n=null,e=!1,t=null,i=null;function r(s,o){t(s,o),i=n.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==t&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function pJ(n,e){const t=e.isWebGL2,i=new WeakMap;return{get:function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),i.get(c)},remove:function a(c){c.isInterleavedBufferAttribute&&(c=c.data);const d=i.get(c);d&&(n.deleteBuffer(d.buffer),i.delete(c))},update:function l(c,d){if(c.isGLBufferAttribute){const p=i.get(c);return void((!p||p.version<c.version)&&i.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version}))}c.isInterleavedBufferAttribute&&(c=c.data);const h=i.get(c);void 0===h?i.set(c,function r(c,d){const h=c.array,p=c.usage,m=n.createBuffer();let g;if(n.bindBuffer(d,m),n.bufferData(d,h,p),c.onUploadCallback(),h instanceof Float32Array)g=n.FLOAT;else if(h instanceof Uint16Array)if(c.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");g=n.HALF_FLOAT}else g=n.UNSIGNED_SHORT;else if(h instanceof Int16Array)g=n.SHORT;else if(h instanceof Uint32Array)g=n.UNSIGNED_INT;else if(h instanceof Int32Array)g=n.INT;else if(h instanceof Int8Array)g=n.BYTE;else if(h instanceof Uint8Array)g=n.UNSIGNED_BYTE;else{if(!(h instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+h);g=n.UNSIGNED_BYTE}return{buffer:m,type:g,bytesPerElement:h.BYTES_PER_ELEMENT,version:c.version}}(c,d)):h.version<c.version&&(function s(c,d,h){const p=d.array,m=d.updateRange;n.bindBuffer(h,c),-1===m.count?n.bufferSubData(h,0,p):(t?n.bufferSubData(h,m.offset*p.BYTES_PER_ELEMENT,p,m.offset,m.count):n.bufferSubData(h,m.offset*p.BYTES_PER_ELEMENT,p.subarray(m.offset,m.offset+m.count)),m.count=-1),d.onUploadCallback()}(h.buffer,c,d),h.version=c.version)}}}class Yy extends Nt{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(i),l=Math.floor(r),c=a+1,d=l+1,h=e/a,p=t/l,m=[],g=[],b=[],v=[];for(let y=0;y<d;y++){const w=y*p-o;for(let E=0;E<c;E++)g.push(E*h-s,-w,0),b.push(0,0,1),v.push(E/a),v.push(1-y/l)}for(let y=0;y<l;y++)for(let w=0;w<a;w++){const x=w+c*(y+1),C=w+1+c*(y+1),A=w+1+c*y;m.push(w+c*y,x,A),m.push(x,C,A)}this.setIndex(m),this.setAttribute("position",new Xe(g,3)),this.setAttribute("normal",new Xe(b,3)),this.setAttribute("uv",new Xe(v,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Yy(e.width,e.height,e.widthSegments,e.heightSegments)}}const $t={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"\nconst mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(\n\tvec3( 0.8224621, 0.177538, 0.0 ),\n\tvec3( 0.0331941, 0.9668058, 0.0 ),\n\tvec3( 0.0170827, 0.0723974, 0.9105199 )\n);\nconst mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.2249401, - 0.2249404, 0.0 ),\n\tvec3( - 0.0420569, 1.0420571, 0.0 ),\n\tvec3( - 0.0196376, - 0.0786361, 1.0982735 )\n);\nvec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );\n}\nvec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );\n}\nvec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn sRGBTransferOETF( value );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tanisotropyV /= material.anisotropy;\n\tmaterial.anisotropy = saturate( material.anisotropy );\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x - tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x + tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal;\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},He={common:{diffuse:{value:new je(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Zt},alphaMap:{value:null},alphaMapTransform:{value:new Zt},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Zt}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Zt}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Zt}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Zt},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Zt},normalScale:{value:new fe(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Zt},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Zt}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Zt}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Zt}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new je(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new je(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Zt},alphaTest:{value:0},uvTransform:{value:new Zt}},sprite:{diffuse:{value:new je(16777215)},opacity:{value:1},center:{value:new fe(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Zt},alphaMap:{value:null},alphaMapTransform:{value:new Zt},alphaTest:{value:0}}},ja={basic:{uniforms:fs([He.common,He.specularmap,He.envmap,He.aomap,He.lightmap,He.fog]),vertexShader:$t.meshbasic_vert,fragmentShader:$t.meshbasic_frag},lambert:{uniforms:fs([He.common,He.specularmap,He.envmap,He.aomap,He.lightmap,He.emissivemap,He.bumpmap,He.normalmap,He.displacementmap,He.fog,He.lights,{emissive:{value:new je(0)}}]),vertexShader:$t.meshlambert_vert,fragmentShader:$t.meshlambert_frag},phong:{uniforms:fs([He.common,He.specularmap,He.envmap,He.aomap,He.lightmap,He.emissivemap,He.bumpmap,He.normalmap,He.displacementmap,He.fog,He.lights,{emissive:{value:new je(0)},specular:{value:new je(1118481)},shininess:{value:30}}]),vertexShader:$t.meshphong_vert,fragmentShader:$t.meshphong_frag},standard:{uniforms:fs([He.common,He.envmap,He.aomap,He.lightmap,He.emissivemap,He.bumpmap,He.normalmap,He.displacementmap,He.roughnessmap,He.metalnessmap,He.fog,He.lights,{emissive:{value:new je(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:$t.meshphysical_vert,fragmentShader:$t.meshphysical_frag},toon:{uniforms:fs([He.common,He.aomap,He.lightmap,He.emissivemap,He.bumpmap,He.normalmap,He.displacementmap,He.gradientmap,He.fog,He.lights,{emissive:{value:new je(0)}}]),vertexShader:$t.meshtoon_vert,fragmentShader:$t.meshtoon_frag},matcap:{uniforms:fs([He.common,He.bumpmap,He.normalmap,He.displacementmap,He.fog,{matcap:{value:null}}]),vertexShader:$t.meshmatcap_vert,fragmentShader:$t.meshmatcap_frag},points:{uniforms:fs([He.points,He.fog]),vertexShader:$t.points_vert,fragmentShader:$t.points_frag},dashed:{uniforms:fs([He.common,He.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:$t.linedashed_vert,fragmentShader:$t.linedashed_frag},depth:{uniforms:fs([He.common,He.displacementmap]),vertexShader:$t.depth_vert,fragmentShader:$t.depth_frag},normal:{uniforms:fs([He.common,He.bumpmap,He.normalmap,He.displacementmap,{opacity:{value:1}}]),vertexShader:$t.meshnormal_vert,fragmentShader:$t.meshnormal_frag},sprite:{uniforms:fs([He.sprite,He.fog]),vertexShader:$t.sprite_vert,fragmentShader:$t.sprite_frag},background:{uniforms:{uvTransform:{value:new Zt},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:$t.background_vert,fragmentShader:$t.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:$t.backgroundCube_vert,fragmentShader:$t.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:$t.cube_vert,fragmentShader:$t.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:$t.equirect_vert,fragmentShader:$t.equirect_frag},distanceRGBA:{uniforms:fs([He.common,He.displacementmap,{referencePosition:{value:new N},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:$t.distanceRGBA_vert,fragmentShader:$t.distanceRGBA_frag},shadow:{uniforms:fs([He.lights,He.fog,{color:{value:new je(0)},opacity:{value:1}}]),vertexShader:$t.shadow_vert,fragmentShader:$t.shadow_frag}};ja.physical={uniforms:fs([ja.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Zt},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Zt},clearcoatNormalScale:{value:new fe(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Zt},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Zt},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Zt},sheen:{value:0},sheenColor:{value:new je(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Zt},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Zt},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Zt},transmissionSamplerSize:{value:new fe},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Zt},attenuationDistance:{value:0},attenuationColor:{value:new je(0)},specularColor:{value:new je(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Zt},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Zt},anisotropyVector:{value:new fe},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Zt}}]),vertexShader:$t.meshphysical_vert,fragmentShader:$t.meshphysical_frag};const fS={r:0,b:0,g:0};function hee(n,e,t,i,r,s,o){const a=new je(0);let c,d,l=!0===s?0:1,h=null,p=0,m=null;function b(v,y){v.getRGB(fS,TB(n)),i.buffers.color.setClear(fS.r,fS.g,fS.b,y,o)}return{getClearColor:function(){return a},setClearColor:function(v,y=1){a.set(v),l=y,b(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(v){l=v,b(a,l)},render:function g(v,y){let w=!1,E=!0===y.isScene?y.background:null;E&&E.isTexture&&(E=(y.backgroundBlurriness>0?t:e).get(E)),null===E?b(a,l):E&&E.isColor&&(b(E,1),w=!0);const x=n.xr.getEnvironmentBlendMode();"additive"===x?i.buffers.color.setClear(0,0,0,1,o):"alpha-blend"===x&&i.buffers.color.setClear(0,0,0,0,o),(n.autoClear||w)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),E&&(E.isCubeTexture||E.mapping===Fy)?(void 0===d&&(d=new Ce(new si(1,1,1),new fu({name:"BackgroundCubeMaterial",uniforms:om(ja.backgroundCube.uniforms),vertexShader:ja.backgroundCube.vertexShader,fragmentShader:ja.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),d.geometry.deleteAttribute("normal"),d.geometry.deleteAttribute("uv"),d.onBeforeRender=function(C,A,D){this.matrixWorld.copyPosition(D.matrixWorld)},Object.defineProperty(d.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(d)),d.material.uniforms.envMap.value=E,d.material.uniforms.flipEnvMap.value=E.isCubeTexture&&!1===E.isRenderTargetTexture?-1:1,d.material.uniforms.backgroundBlurriness.value=y.backgroundBlurriness,d.material.uniforms.backgroundIntensity.value=y.backgroundIntensity,d.material.toneMapped=En.getTransfer(E.colorSpace)!==ei,(h!==E||p!==E.version||m!==n.toneMapping)&&(d.material.needsUpdate=!0,h=E,p=E.version,m=n.toneMapping),d.layers.enableAll(),v.unshift(d,d.geometry,d.material,0,0,null)):E&&E.isTexture&&(void 0===c&&(c=new Ce(new Yy(2,2),new fu({name:"BackgroundMaterial",uniforms:om(ja.background.uniforms),vertexShader:ja.background.vertexShader,fragmentShader:ja.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=E,c.material.uniforms.backgroundIntensity.value=y.backgroundIntensity,c.material.toneMapped=En.getTransfer(E.colorSpace)!==ei,!0===E.matrixAutoUpdate&&E.updateMatrix(),c.material.uniforms.uvTransform.value.copy(E.matrix),(h!==E||p!==E.version||m!==n.toneMapping)&&(c.material.needsUpdate=!0,h=E,p=E.version,m=n.toneMapping),c.layers.enableAll(),v.unshift(c,c.geometry,c.material,0,0,null))}}}function fee(n,e,t,i){const r=n.getParameter(n.MAX_VERTEX_ATTRIBS),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),o=i.isWebGL2||null!==s,a={},l=v(null);let c=l,d=!1;function m(H){return i.isWebGL2?n.bindVertexArray(H):s.bindVertexArrayOES(H)}function g(H){return i.isWebGL2?n.deleteVertexArray(H):s.deleteVertexArrayOES(H)}function v(H){const J=[],j=[],$=[];for(let Q=0;Q<r;Q++)J[Q]=0,j[Q]=0,$[Q]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:J,enabledAttributes:j,attributeDivisors:$,object:H,attributes:{},index:null}}function E(){const H=c.newAttributes;for(let J=0,j=H.length;J<j;J++)H[J]=0}function x(H){C(H,0)}function C(H,J){const $=c.enabledAttributes,Q=c.attributeDivisors;c.newAttributes[H]=1,0===$[H]&&(n.enableVertexAttribArray(H),$[H]=1),Q[H]!==J&&((i.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](H,J),Q[H]=J)}function A(){const H=c.newAttributes,J=c.enabledAttributes;for(let j=0,$=J.length;j<$;j++)J[j]!==H[j]&&(n.disableVertexAttribArray(j),J[j]=0)}function D(H,J,j,$,Q,K,ce){!0===ce?n.vertexAttribIPointer(H,J,j,Q,K):n.vertexAttribPointer(H,J,j,$,Q,K)}function re(){ae(),d=!0,c!==l&&(c=l,m(c.object))}function ae(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function h(H,J,j,$,Q){let K=!1;if(o){const ce=function b(H,J,j){const $=!0===j.wireframe;let Q=a[H.id];void 0===Q&&(Q={},a[H.id]=Q);let K=Q[J.id];void 0===K&&(K={},Q[J.id]=K);let ce=K[$];return void 0===ce&&(ce=v(function p(){return i.isWebGL2?n.createVertexArray():s.createVertexArrayOES()}()),K[$]=ce),ce}($,j,J);c!==ce&&(c=ce,m(c.object)),K=function y(H,J,j,$){const Q=c.attributes,K=J.attributes;let ce=0;const q=j.getAttributes();for(const oe in q)if(q[oe].location>=0){const we=Q[oe];let ze=K[oe];if(void 0===ze&&("instanceMatrix"===oe&&H.instanceMatrix&&(ze=H.instanceMatrix),"instanceColor"===oe&&H.instanceColor&&(ze=H.instanceColor)),void 0===we||we.attribute!==ze||ze&&we.data!==ze.data)return!0;ce++}return c.attributesNum!==ce||c.index!==$}(H,$,j,Q),K&&function w(H,J,j,$){const Q={},K=J.attributes;let ce=0;const q=j.getAttributes();for(const oe in q)if(q[oe].location>=0){let we=K[oe];void 0===we&&("instanceMatrix"===oe&&H.instanceMatrix&&(we=H.instanceMatrix),"instanceColor"===oe&&H.instanceColor&&(we=H.instanceColor));const ze={};ze.attribute=we,we&&we.data&&(ze.data=we.data),Q[oe]=ze,ce++}c.attributes=Q,c.attributesNum=ce,c.index=$}(H,$,j,Q)}else{const ce=!0===J.wireframe;(c.geometry!==$.id||c.program!==j.id||c.wireframe!==ce)&&(c.geometry=$.id,c.program=j.id,c.wireframe=ce,K=!0)}null!==Q&&t.update(Q,n.ELEMENT_ARRAY_BUFFER),(K||d)&&(d=!1,function O(H,J,j,$){if(!1===i.isWebGL2&&(H.isInstancedMesh||$.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;E();const Q=$.attributes,K=j.getAttributes(),ce=J.defaultAttributeValues;for(const q in K){const oe=K[q];if(oe.location>=0){let Me=Q[q];if(void 0===Me&&("instanceMatrix"===q&&H.instanceMatrix&&(Me=H.instanceMatrix),"instanceColor"===q&&H.instanceColor&&(Me=H.instanceColor)),void 0!==Me){const we=Me.normalized,ze=Me.itemSize,Qe=t.get(Me);if(void 0===Qe)continue;const Ge=Qe.buffer,Ye=Qe.type,_t=Qe.bytesPerElement,qt=!0===i.isWebGL2&&(Ye===n.INT||Ye===n.UNSIGNED_INT||1013===Me.gpuType);if(Me.isInterleavedBufferAttribute){const rt=Me.data,z=rt.stride,Ne=Me.offset;if(rt.isInstancedInterleavedBuffer){for(let ye=0;ye<oe.locationSize;ye++)C(oe.location+ye,rt.meshPerAttribute);!0!==H.isInstancedMesh&&void 0===$._maxInstanceCount&&($._maxInstanceCount=rt.meshPerAttribute*rt.count)}else for(let ye=0;ye<oe.locationSize;ye++)x(oe.location+ye);n.bindBuffer(n.ARRAY_BUFFER,Ge);for(let ye=0;ye<oe.locationSize;ye++)D(oe.location+ye,ze/oe.locationSize,Ye,we,z*_t,(Ne+ze/oe.locationSize*ye)*_t,qt)}else{if(Me.isInstancedBufferAttribute){for(let rt=0;rt<oe.locationSize;rt++)C(oe.location+rt,Me.meshPerAttribute);!0!==H.isInstancedMesh&&void 0===$._maxInstanceCount&&($._maxInstanceCount=Me.meshPerAttribute*Me.count)}else for(let rt=0;rt<oe.locationSize;rt++)x(oe.location+rt);n.bindBuffer(n.ARRAY_BUFFER,Ge);for(let rt=0;rt<oe.locationSize;rt++)D(oe.location+rt,ze/oe.locationSize,Ye,we,ze*_t,ze/oe.locationSize*rt*_t,qt)}}else if(void 0!==ce){const we=ce[q];if(void 0!==we)switch(we.length){case 2:n.vertexAttrib2fv(oe.location,we);break;case 3:n.vertexAttrib3fv(oe.location,we);break;case 4:n.vertexAttrib4fv(oe.location,we);break;default:n.vertexAttrib1fv(oe.location,we)}}}}A()}(H,J,j,$),null!==Q&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.get(Q).buffer))},reset:re,resetDefaultState:ae,dispose:function T(){re();for(const H in a){const J=a[H];for(const j in J){const $=J[j];for(const Q in $)g($[Q].object),delete $[Q];delete J[j]}delete a[H]}},releaseStatesOfGeometry:function L(H){if(void 0===a[H.id])return;const J=a[H.id];for(const j in J){const $=J[j];for(const Q in $)g($[Q].object),delete $[Q];delete J[j]}delete a[H.id]},releaseStatesOfProgram:function X(H){for(const J in a){const j=a[J];if(void 0===j[H.id])continue;const $=j[H.id];for(const Q in $)g($[Q].object),delete $[Q];delete j[H.id]}},initAttributes:E,enableAttribute:x,disableUnusedAttributes:A}}function pee(n,e,t,i){const r=i.isWebGL2;let s;this.setMode=function o(c){s=c},this.render=function a(c,d){n.drawArrays(s,c,d),t.update(d,s,1)},this.renderInstances=function l(c,d,h){if(0===h)return;let p,m;if(r)p=n,m="drawArraysInstanced";else if(p=e.get("ANGLE_instanced_arrays"),m="drawArraysInstancedANGLE",null===p)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");p[m](s,c,d,h),t.update(d,s,h)}}function mee(n,e,t){let i;function s(D){if("highp"===D){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";D="mediump"}return"mediump"===D&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&"WebGL2RenderingContext"===n.constructor.name;let a=void 0!==t.precision?t.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const c=o||e.has("WEBGL_draw_buffers"),d=!0===t.logarithmicDepthBuffer,h=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),p=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),m=n.getParameter(n.MAX_TEXTURE_SIZE),g=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),b=n.getParameter(n.MAX_VERTEX_ATTRIBS),v=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),y=n.getParameter(n.MAX_VARYING_VECTORS),w=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),E=p>0,x=o||e.has("OES_texture_float");return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:function r(){if(void 0!==i)return i;if(!0===e.has("EXT_texture_filter_anisotropic")){const D=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(D.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:s,precision:a,logarithmicDepthBuffer:d,maxTextures:h,maxVertexTextures:p,maxTextureSize:m,maxCubemapSize:g,maxAttributes:b,maxVertexUniforms:v,maxVaryings:y,maxFragmentUniforms:w,vertexTextures:E,floatFragmentTextures:x,floatVertexTextures:E&&x,maxSamples:o?n.getParameter(n.MAX_SAMPLES):0}}function gee(n){const e=this;let t=null,i=0,r=!1,s=!1;const o=new pu,a=new Zt,l={value:null,needsUpdate:!1};function d(h,p,m,g){const b=null!==h?h.length:0;let v=null;if(0!==b){if(v=l.value,!0!==g||null===v){const y=m+4*b,w=p.matrixWorldInverse;a.getNormalMatrix(w),(null===v||v.length<y)&&(v=new Float32Array(y));for(let E=0,x=m;E!==b;++E,x+=4)o.copy(h[E]).applyMatrix4(w,a),o.normal.toArray(v,x),v[x+3]=o.constant}l.value=v,l.needsUpdate=!0}return e.numPlanes=b,e.numIntersection=0,v}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(h,p){const m=0!==h.length||p||0!==i||r;return r=p,i=h.length,m},this.beginShadows=function(){s=!0,d(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(h,p){t=d(h,p,0)},this.setState=function(h,p,m){const g=h.clippingPlanes,b=h.clipIntersection,v=h.clipShadows,y=n.get(h);if(!r||null===g||0===g.length||s&&!v)s?d(null):function c(){l.value!==t&&(l.value=t,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}();else{const w=s?0:i,E=4*w;let x=y.clippingState||null;l.value=x,x=d(g,p,E,m);for(let C=0;C!==E;++C)x[C]=t[C];y.clippingState=x,this.numIntersection=b?this.numPlanes:0,this.numPlanes+=w}}}function _ee(n){let e=new WeakMap;function t(o,a){return 303===a?o.mapping=ru:304===a&&(o.mapping=Ld),o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=e.get(a);void 0!==l&&(e.delete(a),l.dispose())}return{get:function i(o){if(o&&o.isTexture&&!1===o.isRenderTargetTexture){const a=o.mapping;if(303===a||304===a){if(e.has(o))return t(e.get(o).texture,o.mapping);{const l=o.image;if(l&&l.height>0){const c=new dJ(l.height/2);return c.fromEquirectangularTexture(n,o),e.set(o,c),o.addEventListener("dispose",r),t(c.texture,o.mapping)}return null}}}return o},dispose:function s(){e=new WeakMap}}}class pS extends P1{constructor(e=-1,t=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,s,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,o=i+e,a=r+t,l=r-t;if(null!==this.view&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,d=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=d*this.view.offsetY,l=a-d*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const DB=[.125,.215,.35,.446,.526,.582],O1=new pS,IB=new je;let F1=null;const Xd=(1+Math.sqrt(5))/2,um=1/Xd,RB=[new N(1,1,1),new N(-1,1,1),new N(1,1,-1),new N(-1,1,-1),new N(0,Xd,um),new N(0,Xd,-um),new N(um,0,Xd),new N(-um,0,Xd),new N(Xd,um,0),new N(-Xd,um,0)];class k1{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){F1=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=LB(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=NB(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(F1),e.scissorTest=!1,mS(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(e.mapping===ru||e.mapping===Ld?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),F1=this._renderer.getRenderTarget();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:_i,minFilter:_i,generateMipmaps:!1,type:By,format:So,colorSpace:Cr,depthBuffer:!1},r=PB(e,t,i);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=PB(e,t,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function yee(n){const e=[],t=[],i=[];let r=n;const s=n-4+1+DB.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let l=1/a;o>n-4?l=DB[o-n+4-1]:0===o&&(l=0),i.push(l);const c=1/(a-2),d=-c,h=1+c,p=[d,d,h,d,h,h,d,d,h,h,d,h],m=6,g=6,b=3,v=2,y=1,w=new Float32Array(b*g*m),E=new Float32Array(v*g*m),x=new Float32Array(y*g*m);for(let A=0;A<m;A++){const D=A%3*2/3-1,O=A>2?0:-1;w.set([D,O,0,D+2/3,O,0,D+2/3,O+1,0,D,O,0,D+2/3,O+1,0,D,O+1,0],b*g*A),E.set(p,v*g*A),x.set([A,A,A,A,A,A],y*g*A)}const C=new Nt;C.setAttribute("position",new ti(w,b)),C.setAttribute("uv",new ti(E,v)),C.setAttribute("faceIndex",new ti(x,y)),e.push(C),r>4&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}(s)),this._blurMaterial=function vee(n,e,t){const i=new Float32Array(20),r=new N(0,1,0);return new fu({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(s,e,t)}return r}_compileMaterial(e){const t=new Ce(this._lodPlanes[0],e);this._renderer.compile(t,O1)}_sceneToCubeUV(e,t,i,r){const a=new nr(90,1,t,i),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],d=this._renderer,h=d.autoClear,p=d.toneMapping;d.getClearColor(IB),d.toneMapping=iu,d.autoClear=!1;const m=new bi({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),g=new Ce(new si,m);let b=!1;const v=e.background;v?v.isColor&&(m.color.copy(v),e.background=null,b=!0):(m.color.copy(IB),b=!0);for(let y=0;y<6;y++){const w=y%3;0===w?(a.up.set(0,l[y],0),a.lookAt(c[y],0,0)):1===w?(a.up.set(0,0,l[y]),a.lookAt(0,c[y],0)):(a.up.set(0,l[y],0),a.lookAt(0,0,c[y]));const E=this._cubeSize;mS(r,w*E,y>2?E:0,E,E),d.setRenderTarget(r),b&&d.render(g,a),d.render(e,a)}g.geometry.dispose(),g.material.dispose(),d.toneMapping=p,d.autoClear=h,e.background=v}_textureToCubeUV(e,t){const i=this._renderer,r=e.mapping===ru||e.mapping===Ld;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=LB()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=NB());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new Ce(this._lodPlanes[0],s);s.uniforms.envMap.value=e;const l=this._cubeSize;mS(t,0,0,3*l,2*l),i.setRenderTarget(t),i.render(o,O1)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]);this._blur(e,r-1,r,s,RB[(r-1)%RB.length])}t.autoClear=i}_blur(e,t,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,o,a){const l=this._renderer,c=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const h=new Ce(this._lodPlanes[r],c),p=c.uniforms,m=this._sizeLods[i]-1,g=isFinite(s)?Math.PI/(2*m):2*Math.PI/39,b=s/g,v=isFinite(s)?1+Math.floor(3*b):20;v>20&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${v} samples when the maximum is set to 20`);const y=[];let w=0;for(let D=0;D<20;++D){const O=D/b,T=Math.exp(-O*O/2);y.push(T),0===D?w+=T:D<v&&(w+=2*T)}for(let D=0;D<y.length;D++)y[D]=y[D]/w;p.envMap.value=e.texture,p.samples.value=v,p.weights.value=y,p.latitudinal.value="latitudinal"===o,a&&(p.poleAxis.value=a);const{_lodMax:E}=this;p.dTheta.value=g,p.mipInt.value=E-i;const x=this._sizeLods[r];mS(t,3*x*(r>E-4?r-E+4:0),4*(this._cubeSize-x),3*x,2*x),l.setRenderTarget(t),l.render(h,O1)}}function PB(n,e,t){const i=new zd(n,e,t);return i.texture.mapping=Fy,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function mS(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function NB(){return new fu({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function LB(){return new fu({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function bee(n){let e=new WeakMap,t=null;function s(a){const l=a.target;l.removeEventListener("dispose",s);const c=e.get(l);void 0!==c&&(e.delete(l),c.dispose())}return{get:function i(a){if(a&&a.isTexture){const l=a.mapping,c=303===l||304===l,d=l===ru||l===Ld;if(c||d){if(a.isRenderTargetTexture&&!0===a.needsPMREMUpdate){a.needsPMREMUpdate=!1;let h=e.get(a);return null===t&&(t=new k1(n)),h=c?t.fromEquirectangular(a,h):t.fromCubemap(a,h),e.set(a,h),h.texture}if(e.has(a))return e.get(a).texture;{const h=a.image;if(c&&h&&h.height>0||d&&h&&function r(a){let l=0;for(let d=0;d<6;d++)void 0!==a[d]&&l++;return 6===l}(h)){null===t&&(t=new k1(n));const p=c?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,p),a.addEventListener("dispose",s),p.texture}return null}}}return a},dispose:function o(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function wee(n){const e={};function t(i){if(void 0!==e[i])return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return null!==t(i)},init:function(i){i.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){const r=t(i);return null===r&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function Eee(n,e,t,i){const r={},s=new WeakMap;function o(h){const p=h.target;null!==p.index&&e.remove(p.index);for(const g in p.attributes)e.remove(p.attributes[g]);for(const g in p.morphAttributes){const b=p.morphAttributes[g];for(let v=0,y=b.length;v<y;v++)e.remove(b[v])}p.removeEventListener("dispose",o),delete r[p.id];const m=s.get(p);m&&(e.remove(m),s.delete(p)),i.releaseStatesOfGeometry(p),!0===p.isInstancedBufferGeometry&&delete p._maxInstanceCount,t.memory.geometries--}function c(h){const p=[],m=h.index,g=h.attributes.position;let b=0;if(null!==m){const w=m.array;b=m.version;for(let E=0,x=w.length;E<x;E+=3){const C=w[E+0],A=w[E+1],D=w[E+2];p.push(C,A,A,D,D,C)}}else{if(void 0===g)return;b=g.version;for(let E=0,x=g.array.length/3-1;E<x;E+=3){const C=E+0,A=E+1,D=E+2;p.push(C,A,A,D,D,C)}}const v=new(rB(p)?wB:bB)(p,1);v.version=b;const y=s.get(h);y&&e.remove(y),s.set(h,v)}return{get:function a(h,p){return!0===r[p.id]||(p.addEventListener("dispose",o),r[p.id]=!0,t.memory.geometries++),p},update:function l(h){const p=h.attributes;for(const g in p)e.update(p[g],n.ARRAY_BUFFER);const m=h.morphAttributes;for(const g in m){const b=m[g];for(let v=0,y=b.length;v<y;v++)e.update(b[v],n.ARRAY_BUFFER)}},getWireframeAttribute:function d(h){const p=s.get(h);if(p){const m=h.index;null!==m&&p.version<m.version&&c(h)}else c(h);return s.get(h)}}}function See(n,e,t,i){const r=i.isWebGL2;let s,a,l;this.setMode=function o(p){s=p},this.setIndex=function c(p){a=p.type,l=p.bytesPerElement},this.render=function d(p,m){n.drawElements(s,m,a,p*l),t.update(m,s,1)},this.renderInstances=function h(p,m,g){if(0===g)return;let b,v;if(r)b=n,v="drawElementsInstanced";else if(b=e.get("ANGLE_instanced_arrays"),v="drawElementsInstancedANGLE",null===b)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");b[v](s,m,a,p*l,g),t.update(m,s,g)}}function xee(n){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function i(s,o,a){switch(t.calls++,o){case n.TRIANGLES:t.triangles+=a*(s/3);break;case n.LINES:t.lines+=a*(s/2);break;case n.LINE_STRIP:t.lines+=a*(s-1);break;case n.LINE_LOOP:t.lines+=a*s;break;case n.POINTS:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o)}}}}function Mee(n,e){return n[0]-e[0]}function Cee(n,e){return Math.abs(e[1])-Math.abs(n[1])}function Tee(n,e,t){const i={},r=new Float32Array(8),s=new WeakMap,o=new Pn,a=[];for(let c=0;c<8;c++)a[c]=[c,0];return{update:function l(c,d,h){const p=c.morphTargetInfluences;if(!0===e.isWebGL2){const m=d.morphAttributes.position||d.morphAttributes.normal||d.morphAttributes.color,g=void 0!==m?m.length:0;let b=s.get(d);if(void 0===b||b.count!==g){let H=function(){re.dispose(),s.delete(d),d.removeEventListener("dispose",H)};void 0!==b&&b.texture.dispose();const w=void 0!==d.morphAttributes.position,E=void 0!==d.morphAttributes.normal,x=void 0!==d.morphAttributes.color,C=d.morphAttributes.position||[],A=d.morphAttributes.normal||[],D=d.morphAttributes.color||[];let O=0;!0===w&&(O=1),!0===E&&(O=2),!0===x&&(O=3);let T=d.attributes.position.count*O,L=1;T>e.maxTextureSize&&(L=Math.ceil(T/e.maxTextureSize),T=e.maxTextureSize);const X=new Float32Array(T*L*4*g),re=new _1(X,T,L,g);re.type=Hl,re.needsUpdate=!0;const ae=4*O;for(let J=0;J<g;J++){const j=C[J],$=A[J],Q=D[J],K=T*L*4*J;for(let ce=0;ce<j.count;ce++){const q=ce*ae;!0===w&&(o.fromBufferAttribute(j,ce),X[K+q+0]=o.x,X[K+q+1]=o.y,X[K+q+2]=o.z,X[K+q+3]=0),!0===E&&(o.fromBufferAttribute($,ce),X[K+q+4]=o.x,X[K+q+5]=o.y,X[K+q+6]=o.z,X[K+q+7]=0),!0===x&&(o.fromBufferAttribute(Q,ce),X[K+q+8]=o.x,X[K+q+9]=o.y,X[K+q+10]=o.z,X[K+q+11]=4===Q.itemSize?o.w:1)}}b={count:g,texture:re,size:new fe(T,L)},s.set(d,b),d.addEventListener("dispose",H)}let v=0;for(let w=0;w<p.length;w++)v+=p[w];const y=d.morphTargetsRelative?1:1-v;h.getUniforms().setValue(n,"morphTargetBaseInfluence",y),h.getUniforms().setValue(n,"morphTargetInfluences",p),h.getUniforms().setValue(n,"morphTargetsTexture",b.texture,t),h.getUniforms().setValue(n,"morphTargetsTextureSize",b.size)}else{const m=void 0===p?0:p.length;let g=i[d.id];if(void 0===g||g.length!==m){g=[];for(let E=0;E<m;E++)g[E]=[E,0];i[d.id]=g}for(let E=0;E<m;E++){const x=g[E];x[0]=E,x[1]=p[E]}g.sort(Cee);for(let E=0;E<8;E++)E<m&&g[E][1]?(a[E][0]=g[E][0],a[E][1]=g[E][1]):(a[E][0]=Number.MAX_SAFE_INTEGER,a[E][1]=0);a.sort(Mee);const b=d.morphAttributes.position,v=d.morphAttributes.normal;let y=0;for(let E=0;E<8;E++){const x=a[E],C=x[0],A=x[1];C!==Number.MAX_SAFE_INTEGER&&A?(b&&d.getAttribute("morphTarget"+E)!==b[C]&&d.setAttribute("morphTarget"+E,b[C]),v&&d.getAttribute("morphNormal"+E)!==v[C]&&d.setAttribute("morphNormal"+E,v[C]),r[E]=A,y+=A):(b&&!0===d.hasAttribute("morphTarget"+E)&&d.deleteAttribute("morphTarget"+E),v&&!0===d.hasAttribute("morphNormal"+E)&&d.deleteAttribute("morphNormal"+E),r[E]=0)}const w=d.morphTargetsRelative?1:1-y;h.getUniforms().setValue(n,"morphTargetBaseInfluence",w),h.getUniforms().setValue(n,"morphTargetInfluences",r)}}}}function Aee(n,e,t,i){let r=new WeakMap;function a(l){const c=l.target;c.removeEventListener("dispose",a),t.remove(c.instanceMatrix),null!==c.instanceColor&&t.remove(c.instanceColor)}return{update:function s(l){const c=i.render.frame,h=e.get(l,l.geometry);if(r.get(h)!==c&&(e.update(h),r.set(h,c)),l.isInstancedMesh&&(!1===l.hasEventListener("dispose",a)&&l.addEventListener("dispose",a),r.get(l)!==c&&(t.update(l.instanceMatrix,n.ARRAY_BUFFER),null!==l.instanceColor&&t.update(l.instanceColor,n.ARRAY_BUFFER),r.set(l,c))),l.isSkinnedMesh){const p=l.skeleton;r.get(p)!==c&&(p.update(),r.set(p,c))}return h},dispose:function o(){r=new WeakMap}}}const OB=new oa,FB=new _1,kB=new cB,UB=new dS,BB=[],VB=[],HB=new Float32Array(16),zB=new Float32Array(9),GB=new Float32Array(4);function dm(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let s=BB[r];if(void 0===s&&(s=new Float32Array(r),BB[r]=s),0!==e){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function ir(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function rr(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function gS(n,e){let t=VB[e];void 0===t&&(t=new Int32Array(e),VB[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function Dee(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function Iee(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ir(t,e))return;n.uniform2fv(this.addr,e),rr(t,e)}}function Ree(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(ir(t,e))return;n.uniform3fv(this.addr,e),rr(t,e)}}function Pee(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ir(t,e))return;n.uniform4fv(this.addr,e),rr(t,e)}}function Nee(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(ir(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),rr(t,e)}else{if(ir(t,i))return;GB.set(i),n.uniformMatrix2fv(this.addr,!1,GB),rr(t,i)}}function Lee(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(ir(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),rr(t,e)}else{if(ir(t,i))return;zB.set(i),n.uniformMatrix3fv(this.addr,!1,zB),rr(t,i)}}function Oee(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(ir(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),rr(t,e)}else{if(ir(t,i))return;HB.set(i),n.uniformMatrix4fv(this.addr,!1,HB),rr(t,i)}}function Fee(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function kee(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ir(t,e))return;n.uniform2iv(this.addr,e),rr(t,e)}}function Uee(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(ir(t,e))return;n.uniform3iv(this.addr,e),rr(t,e)}}function Bee(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ir(t,e))return;n.uniform4iv(this.addr,e),rr(t,e)}}function Vee(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function Hee(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ir(t,e))return;n.uniform2uiv(this.addr,e),rr(t,e)}}function zee(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(ir(t,e))return;n.uniform3uiv(this.addr,e),rr(t,e)}}function Gee(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ir(t,e))return;n.uniform4uiv(this.addr,e),rr(t,e)}}function Wee(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2D(e||OB,r)}function jee(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||kB,r)}function $ee(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||UB,r)}function qee(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||FB,r)}function Yee(n,e){n.uniform1fv(this.addr,e)}function Zee(n,e){const t=dm(e,this.size,2);n.uniform2fv(this.addr,t)}function Kee(n,e){const t=dm(e,this.size,3);n.uniform3fv(this.addr,t)}function Jee(n,e){const t=dm(e,this.size,4);n.uniform4fv(this.addr,t)}function Qee(n,e){const t=dm(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function ete(n,e){const t=dm(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function tte(n,e){const t=dm(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function nte(n,e){n.uniform1iv(this.addr,e)}function ite(n,e){n.uniform2iv(this.addr,e)}function rte(n,e){n.uniform3iv(this.addr,e)}function ste(n,e){n.uniform4iv(this.addr,e)}function ote(n,e){n.uniform1uiv(this.addr,e)}function ate(n,e){n.uniform2uiv(this.addr,e)}function lte(n,e){n.uniform3uiv(this.addr,e)}function cte(n,e){n.uniform4uiv(this.addr,e)}function ute(n,e,t){const i=this.cache,r=e.length,s=gS(t,r);ir(i,s)||(n.uniform1iv(this.addr,s),rr(i,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||OB,s[o])}function dte(n,e,t){const i=this.cache,r=e.length,s=gS(t,r);ir(i,s)||(n.uniform1iv(this.addr,s),rr(i,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||kB,s[o])}function hte(n,e,t){const i=this.cache,r=e.length,s=gS(t,r);ir(i,s)||(n.uniform1iv(this.addr,s),rr(i,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||UB,s[o])}function fte(n,e,t){const i=this.cache,r=e.length,s=gS(t,r);ir(i,s)||(n.uniform1iv(this.addr,s),rr(i,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||FB,s[o])}class mte{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.setValue=function Xee(n){switch(n){case 5126:return Dee;case 35664:return Iee;case 35665:return Ree;case 35666:return Pee;case 35674:return Nee;case 35675:return Lee;case 35676:return Oee;case 5124:case 35670:return Fee;case 35667:case 35671:return kee;case 35668:case 35672:return Uee;case 35669:case 35673:return Bee;case 5125:return Vee;case 36294:return Hee;case 36295:return zee;case 36296:return Gee;case 35678:case 36198:case 36298:case 36306:case 35682:return Wee;case 35679:case 36299:case 36307:return jee;case 35680:case 36300:case 36308:case 36293:return $ee;case 36289:case 36303:case 36311:case 36292:return qee}}(t.type)}}class gte{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.size=t.size,this.setValue=function pte(n){switch(n){case 5126:return Yee;case 35664:return Zee;case 35665:return Kee;case 35666:return Jee;case 35674:return Qee;case 35675:return ete;case 35676:return tte;case 5124:case 35670:return nte;case 35667:case 35671:return ite;case 35668:case 35672:return rte;case 35669:case 35673:return ste;case 5125:return ote;case 36294:return ate;case 36295:return lte;case 36296:return cte;case 35678:case 36198:case 36298:case 36306:case 35682:return ute;case 35679:case 36299:case 36307:return dte;case 35680:case 36300:case 36308:case 36293:return hte;case 36289:case 36303:case 36311:case 36292:return fte}}(t.type)}}class _te{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,t[a.id],i)}}}const B1=/(\w+)(\])?(\[|\.)?/g;function WB(n,e){n.seq.push(e),n.map[e.id]=e}function yte(n,e,t){const i=n.name,r=i.length;for(B1.lastIndex=0;;){const s=B1.exec(i);let a=s[1];const c=s[3];if("]"===s[2]&&(a|=0),void 0===c||"["===c&&B1.lastIndex+2===r){WB(t,void 0===c?new mte(a,n,e):new gte(a,n,e));break}{let h=t.map[a];void 0===h&&(h=new _te(a),WB(t,h)),t=h}}}class _S{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<i;++r){const s=e.getActiveUniform(t,r);yte(s,e.getUniformLocation(t,s.name),this)}}setValue(e,t,i,r){const s=this.map[t];void 0!==s&&s.setValue(e,i,r)}setOptional(e,t,i){const r=t[i];void 0!==r&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let s=0,o=t.length;s!==o;++s){const a=t[s],l=i[a.id];!1!==l.needsUpdate&&a.setValue(e,l.value,r)}}static seqWithValue(e,t){const i=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&i.push(o)}return i}}function jB(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}let vte=0;function $B(n,e,t){const i=n.getShaderParameter(e,n.COMPILE_STATUS),r=n.getShaderInfoLog(e).trim();if(i&&""===r)return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return t.toUpperCase()+"\n\n"+r+"\n\n"+function bte(n,e){const t=n.split("\n"),i=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const a=o+1;i.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return i.join("\n")}(n.getShaderSource(e),o)}return r}function Ete(n,e){const t=function wte(n){const e=En.getPrimaries(En.workingColorSpace),t=En.getPrimaries(n);let i;switch(e===t?i="":e===GE&&t===zE?i="LinearDisplayP3ToLinearSRGB":e===zE&&t===GE&&(i="LinearSRGBToLinearDisplayP3"),n){case Cr:case VE:return[i,"LinearTransferOETF"];case ui:case c1:return[i,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",n),[i,"LinearTransferOETF"]}}(e);return`vec4 ${n}( vec4 value ) { return ${t[0]}( ${t[1]}( value ) ); }`}function Ste(n,e){let t;switch(e){case QZ:t="Linear";break;case eK:t="Reinhard";break;case tK:t="OptimizedCineon";break;case nK:t="ACESFilmic";break;case iK:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function Zy(n){return""!==n}function qB(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function XB(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Tte=/^[ \t]*#include +<([\w\d./]+)>/gm;function V1(n){return n.replace(Tte,Dte)}const Ate=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function Dte(n,e){let t=$t[e];if(void 0===t){const i=Ate.get(e);if(void 0===i)throw new Error("Can not resolve #include <"+e+">");t=$t[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i)}return V1(t)}const Ite=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function YB(n){return n.replace(Ite,Rte)}function Rte(n,e,t,i){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function ZB(n){let e="precision "+n.precision+" float;\nprecision "+n.precision+" int;";return"highp"===n.precision?e+="\n#define HIGH_PRECISION":"mediump"===n.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===n.precision&&(e+="\n#define LOW_PRECISION"),e}function kte(n,e,t,i){const r=n.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=function Pte(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===f3?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===RZ?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===Ul&&(e="SHADOWMAP_TYPE_VSM"),e}(t),c=function Nte(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case ru:case Ld:e="ENVMAP_TYPE_CUBE";break;case Fy:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),d=function Lte(n){let e="ENVMAP_MODE_REFLECTION";return n.envMap&&n.envMapMode===Ld&&(e="ENVMAP_MODE_REFRACTION"),e}(t),h=function Ote(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case OE:e="ENVMAP_BLENDING_MULTIPLY";break;case KZ:e="ENVMAP_BLENDING_MIX";break;case JZ:e="ENVMAP_BLENDING_ADD"}return e}(t),p=function Fte(n){const e=n.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:i,maxMip:t}}(t),m=t.isWebGL2?"":function xte(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.normalMapTangentSpace||n.clearcoatNormalMap||n.flatShading||"physical"===n.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Zy).join("\n")}(t),g=function Mte(n){const e=[];for(const t in n){const i=n[t];!1!==i&&e.push("#define "+t+" "+i)}return e.join("\n")}(s),b=r.createProgram();let v,y,w=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(v=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,g].filter(Zy).join("\n"),v.length>0&&(v+="\n"),y=[m,"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,g].filter(Zy).join("\n"),y.length>0&&(y+="\n")):(v=[ZB(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,g,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+d:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Zy).join("\n"),y=[m,ZB(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,g,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+d:"",t.envMap?"#define "+h:"",p?"#define CUBEUV_TEXEL_WIDTH "+p.texelWidth:"",p?"#define CUBEUV_TEXEL_HEIGHT "+p.texelHeight:"",p?"#define CUBEUV_MAX_MIP "+p.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==iu?"#define TONE_MAPPING":"",t.toneMapping!==iu?$t.tonemapping_pars_fragment:"",t.toneMapping!==iu?Ste("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",$t.colorspace_pars_fragment,Ete("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(Zy).join("\n")),o=V1(o),o=qB(o,t),o=XB(o,t),a=V1(a),a=qB(a,t),a=XB(a,t),o=YB(o),a=YB(a),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(w="#version 300 es\n",v=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+v,y=["#define varying in",t.glslVersion===tB?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===tB?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+y);const x=w+y+a,C=jB(r,r.VERTEX_SHADER,w+v+o),A=jB(r,r.FRAGMENT_SHADER,x);if(r.attachShader(b,C),r.attachShader(b,A),void 0!==t.index0AttributeName?r.bindAttribLocation(b,0,t.index0AttributeName):!0===t.morphTargets&&r.bindAttribLocation(b,0,"position"),r.linkProgram(b),n.debug.checkShaderErrors){const T=r.getProgramInfoLog(b).trim(),L=r.getShaderInfoLog(C).trim(),X=r.getShaderInfoLog(A).trim();let re=!0,ae=!0;if(!1===r.getProgramParameter(b,r.LINK_STATUS))if(re=!1,"function"==typeof n.debug.onShaderError)n.debug.onShaderError(r,b,C,A);else{const H=$B(r,C,"vertex"),J=$B(r,A,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(b,r.VALIDATE_STATUS)+"\n\nProgram Info Log: "+T+"\n"+H+"\n"+J)}else""!==T?console.warn("THREE.WebGLProgram: Program Info Log:",T):(""===L||""===X)&&(ae=!1);ae&&(this.diagnostics={runnable:re,programLog:T,vertexShader:{log:L,prefix:v},fragmentShader:{log:X,prefix:y}})}let D,O;return r.deleteShader(C),r.deleteShader(A),this.getUniforms=function(){return void 0===D&&(D=new _S(r,b)),D},this.getAttributes=function(){return void 0===O&&(O=function Cte(n,e){const t={},i=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const s=n.getActiveAttrib(e,r),o=s.name;let a=1;s.type===n.FLOAT_MAT2&&(a=2),s.type===n.FLOAT_MAT3&&(a=3),s.type===n.FLOAT_MAT4&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}(r,b)),O},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(b),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=vte++,this.cacheKey=e,this.usedTimes=1,this.program=b,this.vertexShader=C,this.fragmentShader=A,this}let Ute=0;class Bte{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.fragmentShader,r=this._getShaderStage(e.vertexShader),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return!1===o.has(r)&&(o.add(r),r.usedTimes++),!1===o.has(s)&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,0===i.usedTimes&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return void 0===i&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return void 0===i&&(i=new Vte(e),t.set(e,i)),i}}class Vte{constructor(e){this.id=Ute++,this.code=e,this.usedTimes=0}}function Hte(n,e,t,i,r,s,o){const a=new x1,l=new Bte,c=[],d=r.isWebGL2,h=r.logarithmicDepthBuffer,p=r.vertexTextures;let m=r.precision;const g={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function b(T){return 0===T?"uv":`uv${T}`}return{getParameters:function v(T,L,X,re,ae){const H=re.fog,J=ae.geometry,$=(T.isMeshStandardMaterial?t:e).get(T.envMap||(T.isMeshStandardMaterial?re.environment:null)),Q=$&&$.mapping===Fy?$.image.height:null,K=g[T.type];null!==T.precision&&(m=r.getMaxPrecision(T.precision),m!==T.precision&&console.warn("THREE.WebGLProgram.getParameters:",T.precision,"not supported, using",m,"instead."));const ce=J.morphAttributes.position||J.morphAttributes.normal||J.morphAttributes.color,q=void 0!==ce?ce.length:0;let Me,we,ze,Qe,oe=0;if(void 0!==J.morphAttributes.position&&(oe=1),void 0!==J.morphAttributes.normal&&(oe=2),void 0!==J.morphAttributes.color&&(oe=3),K){const ii=ja[K];Me=ii.vertexShader,we=ii.fragmentShader}else Me=T.vertexShader,we=T.fragmentShader,l.update(T),ze=l.getVertexShaderID(T),Qe=l.getFragmentShaderID(T);const Ge=n.getRenderTarget(),Ye=!0===ae.isInstancedMesh,_t=!!T.map,rt=!!$,z=!!T.aoMap,Ne=!!T.lightMap,ye=!!T.bumpMap,Ae=!!T.normalMap,Ee=!!T.displacementMap,ot=!!T.emissiveMap,Ze=!!T.metalnessMap,Je=!!T.roughnessMap,wt=T.anisotropy>0,en=T.clearcoat>0,ai=T.iridescence>0,k=T.sheen>0,R=T.transmission>0,ne=wt&&!!T.anisotropyMap,Te=en&&!!T.clearcoatMap,xe=en&&!!T.clearcoatNormalMap,De=en&&!!T.clearcoatRoughnessMap,it=ai&&!!T.iridescenceMap,Ie=ai&&!!T.iridescenceThicknessMap,$e=k&&!!T.sheenColorMap,G=k&&!!T.sheenRoughnessMap,Re=!!T.specularMap,ve=!!T.specularColorMap,St=!!T.specularIntensityMap,at=R&&!!T.transmissionMap,ht=R&&!!T.thicknessMap,V=!!T.alphaMap,We=!!T.extensions,Fe=!!J.attributes.uv1,Se=!!J.attributes.uv2,nt=!!J.attributes.uv3;let Mt=iu;return T.toneMapped&&(null===Ge||!0===Ge.isXRRenderTarget)&&(Mt=n.toneMapping),{isWebGL2:d,shaderID:K,shaderType:T.type,shaderName:T.name,vertexShader:Me,fragmentShader:we,defines:T.defines,customVertexShaderID:ze,customFragmentShaderID:Qe,isRawShaderMaterial:!0===T.isRawShaderMaterial,glslVersion:T.glslVersion,precision:m,instancing:Ye,instancingColor:Ye&&null!==ae.instanceColor,supportsVertexTextures:p,outputColorSpace:null===Ge?n.outputColorSpace:!0===Ge.isXRRenderTarget?Ge.texture.colorSpace:Cr,map:_t,matcap:!!T.matcap,envMap:rt,envMapMode:rt&&$.mapping,envMapCubeUVHeight:Q,aoMap:z,lightMap:Ne,bumpMap:ye,normalMap:Ae,displacementMap:p&&Ee,emissiveMap:ot,normalMapObjectSpace:Ae&&1===T.normalMapType,normalMapTangentSpace:Ae&&0===T.normalMapType,metalnessMap:Ze,roughnessMap:Je,anisotropy:wt,anisotropyMap:ne,clearcoat:en,clearcoatMap:Te,clearcoatNormalMap:xe,clearcoatRoughnessMap:De,iridescence:ai,iridescenceMap:it,iridescenceThicknessMap:Ie,sheen:k,sheenColorMap:$e,sheenRoughnessMap:G,specularMap:Re,specularColorMap:ve,specularIntensityMap:St,transmission:R,transmissionMap:at,thicknessMap:ht,gradientMap:!!T.gradientMap,opaque:!1===T.transparent&&1===T.blending,alphaMap:V,alphaTest:T.alphaTest>0,alphaHash:!!T.alphaHash,combine:T.combine,mapUv:_t&&b(T.map.channel),aoMapUv:z&&b(T.aoMap.channel),lightMapUv:Ne&&b(T.lightMap.channel),bumpMapUv:ye&&b(T.bumpMap.channel),normalMapUv:Ae&&b(T.normalMap.channel),displacementMapUv:Ee&&b(T.displacementMap.channel),emissiveMapUv:ot&&b(T.emissiveMap.channel),metalnessMapUv:Ze&&b(T.metalnessMap.channel),roughnessMapUv:Je&&b(T.roughnessMap.channel),anisotropyMapUv:ne&&b(T.anisotropyMap.channel),clearcoatMapUv:Te&&b(T.clearcoatMap.channel),clearcoatNormalMapUv:xe&&b(T.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:De&&b(T.clearcoatRoughnessMap.channel),iridescenceMapUv:it&&b(T.iridescenceMap.channel),iridescenceThicknessMapUv:Ie&&b(T.iridescenceThicknessMap.channel),sheenColorMapUv:$e&&b(T.sheenColorMap.channel),sheenRoughnessMapUv:G&&b(T.sheenRoughnessMap.channel),specularMapUv:Re&&b(T.specularMap.channel),specularColorMapUv:ve&&b(T.specularColorMap.channel),specularIntensityMapUv:St&&b(T.specularIntensityMap.channel),transmissionMapUv:at&&b(T.transmissionMap.channel),thicknessMapUv:ht&&b(T.thicknessMap.channel),alphaMapUv:V&&b(T.alphaMap.channel),vertexTangents:!!J.attributes.tangent&&(Ae||wt),vertexColors:T.vertexColors,vertexAlphas:!0===T.vertexColors&&!!J.attributes.color&&4===J.attributes.color.itemSize,vertexUv1s:Fe,vertexUv2s:Se,vertexUv3s:nt,pointsUvs:!0===ae.isPoints&&!!J.attributes.uv&&(_t||V),fog:!!H,useFog:!0===T.fog,fogExp2:H&&H.isFogExp2,flatShading:!0===T.flatShading,sizeAttenuation:!0===T.sizeAttenuation,logarithmicDepthBuffer:h,skinning:!0===ae.isSkinnedMesh,morphTargets:void 0!==J.morphAttributes.position,morphNormals:void 0!==J.morphAttributes.normal,morphColors:void 0!==J.morphAttributes.color,morphTargetsCount:q,morphTextureStride:oe,numDirLights:L.directional.length,numPointLights:L.point.length,numSpotLights:L.spot.length,numSpotLightMaps:L.spotLightMap.length,numRectAreaLights:L.rectArea.length,numHemiLights:L.hemi.length,numDirLightShadows:L.directionalShadowMap.length,numPointLightShadows:L.pointShadowMap.length,numSpotLightShadows:L.spotShadowMap.length,numSpotLightShadowsWithMaps:L.numSpotLightShadowsWithMaps,numLightProbes:L.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:T.dithering,shadowMapEnabled:n.shadowMap.enabled&&X.length>0,shadowMapType:n.shadowMap.type,toneMapping:Mt,useLegacyLights:n._useLegacyLights,decodeVideoTexture:_t&&!0===T.map.isVideoTexture&&En.getTransfer(T.map.colorSpace)===ei,premultipliedAlpha:T.premultipliedAlpha,doubleSided:2===T.side,flipSided:1===T.side,useDepthPacking:T.depthPacking>=0,depthPacking:T.depthPacking||0,index0AttributeName:T.index0AttributeName,extensionDerivatives:We&&!0===T.extensions.derivatives,extensionFragDepth:We&&!0===T.extensions.fragDepth,extensionDrawBuffers:We&&!0===T.extensions.drawBuffers,extensionShaderTextureLOD:We&&!0===T.extensions.shaderTextureLOD,rendererExtensionFragDepth:d||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:d||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:d||i.has("EXT_shader_texture_lod"),customProgramCacheKey:T.customProgramCacheKey()}},getProgramCacheKey:function y(T){const L=[];if(T.shaderID?L.push(T.shaderID):(L.push(T.customVertexShaderID),L.push(T.customFragmentShaderID)),void 0!==T.defines)for(const X in T.defines)L.push(X),L.push(T.defines[X]);return!1===T.isRawShaderMaterial&&(function w(T,L){T.push(L.precision),T.push(L.outputColorSpace),T.push(L.envMapMode),T.push(L.envMapCubeUVHeight),T.push(L.mapUv),T.push(L.alphaMapUv),T.push(L.lightMapUv),T.push(L.aoMapUv),T.push(L.bumpMapUv),T.push(L.normalMapUv),T.push(L.displacementMapUv),T.push(L.emissiveMapUv),T.push(L.metalnessMapUv),T.push(L.roughnessMapUv),T.push(L.anisotropyMapUv),T.push(L.clearcoatMapUv),T.push(L.clearcoatNormalMapUv),T.push(L.clearcoatRoughnessMapUv),T.push(L.iridescenceMapUv),T.push(L.iridescenceThicknessMapUv),T.push(L.sheenColorMapUv),T.push(L.sheenRoughnessMapUv),T.push(L.specularMapUv),T.push(L.specularColorMapUv),T.push(L.specularIntensityMapUv),T.push(L.transmissionMapUv),T.push(L.thicknessMapUv),T.push(L.combine),T.push(L.fogExp2),T.push(L.sizeAttenuation),T.push(L.morphTargetsCount),T.push(L.morphAttributeCount),T.push(L.numDirLights),T.push(L.numPointLights),T.push(L.numSpotLights),T.push(L.numSpotLightMaps),T.push(L.numHemiLights),T.push(L.numRectAreaLights),T.push(L.numDirLightShadows),T.push(L.numPointLightShadows),T.push(L.numSpotLightShadows),T.push(L.numSpotLightShadowsWithMaps),T.push(L.numLightProbes),T.push(L.shadowMapType),T.push(L.toneMapping),T.push(L.numClippingPlanes),T.push(L.numClipIntersection),T.push(L.depthPacking)}(L,T),function E(T,L){a.disableAll(),L.isWebGL2&&a.enable(0),L.supportsVertexTextures&&a.enable(1),L.instancing&&a.enable(2),L.instancingColor&&a.enable(3),L.matcap&&a.enable(4),L.envMap&&a.enable(5),L.normalMapObjectSpace&&a.enable(6),L.normalMapTangentSpace&&a.enable(7),L.clearcoat&&a.enable(8),L.iridescence&&a.enable(9),L.alphaTest&&a.enable(10),L.vertexColors&&a.enable(11),L.vertexAlphas&&a.enable(12),L.vertexUv1s&&a.enable(13),L.vertexUv2s&&a.enable(14),L.vertexUv3s&&a.enable(15),L.vertexTangents&&a.enable(16),L.anisotropy&&a.enable(17),T.push(a.mask),a.disableAll(),L.fog&&a.enable(0),L.useFog&&a.enable(1),L.flatShading&&a.enable(2),L.logarithmicDepthBuffer&&a.enable(3),L.skinning&&a.enable(4),L.morphTargets&&a.enable(5),L.morphNormals&&a.enable(6),L.morphColors&&a.enable(7),L.premultipliedAlpha&&a.enable(8),L.shadowMapEnabled&&a.enable(9),L.useLegacyLights&&a.enable(10),L.doubleSided&&a.enable(11),L.flipSided&&a.enable(12),L.useDepthPacking&&a.enable(13),L.dithering&&a.enable(14),L.transmission&&a.enable(15),L.sheen&&a.enable(16),L.opaque&&a.enable(17),L.pointsUvs&&a.enable(18),L.decodeVideoTexture&&a.enable(19),T.push(a.mask)}(L,T),L.push(n.outputColorSpace)),L.push(T.customProgramCacheKey),L.join()},getUniforms:function x(T){const L=g[T.type];let X;return X=L?aJ.clone(ja[L].uniforms):T.uniforms,X},acquireProgram:function C(T,L){let X;for(let re=0,ae=c.length;re<ae;re++){const H=c[re];if(H.cacheKey===L){X=H,++X.usedTimes;break}}return void 0===X&&(X=new kte(n,L,T,s),c.push(X)),X},releaseProgram:function A(T){if(0==--T.usedTimes){const L=c.indexOf(T);c[L]=c[c.length-1],c.pop(),T.destroy()}},releaseShaderCache:function D(T){l.remove(T)},programs:c,dispose:function O(){l.dispose()}}}function zte(){let n=new WeakMap;return{get:function e(s){let o=n.get(s);return void 0===o&&(o={},n.set(s,o)),o},remove:function t(s){n.delete(s)},update:function i(s,o,a){n.get(s)[o]=a},dispose:function r(){n=new WeakMap}}}function Gte(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function KB(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function JB(){const n=[];let e=0;const t=[],i=[],r=[];function o(h,p,m,g,b,v){let y=n[e];return void 0===y?(y={id:h.id,object:h,geometry:p,material:m,groupOrder:g,renderOrder:h.renderOrder,z:b,group:v},n[e]=y):(y.id=h.id,y.object=h,y.geometry=p,y.material=m,y.groupOrder=g,y.renderOrder=h.renderOrder,y.z=b,y.group=v),e++,y}return{opaque:t,transmissive:i,transparent:r,init:function s(){e=0,t.length=0,i.length=0,r.length=0},push:function a(h,p,m,g,b,v){const y=o(h,p,m,g,b,v);m.transmission>0?i.push(y):!0===m.transparent?r.push(y):t.push(y)},unshift:function l(h,p,m,g,b,v){const y=o(h,p,m,g,b,v);m.transmission>0?i.unshift(y):!0===m.transparent?r.unshift(y):t.unshift(y)},finish:function d(){for(let h=e,p=n.length;h<p;h++){const m=n[h];if(null===m.id)break;m.id=null,m.object=null,m.geometry=null,m.material=null,m.group=null}},sort:function c(h,p){t.length>1&&t.sort(h||Gte),i.length>1&&i.sort(p||KB),r.length>1&&r.sort(p||KB)}}}function Wte(){let n=new WeakMap;return{get:function e(i,r){const s=n.get(i);let o;return void 0===s?(o=new JB,n.set(i,[o])):r>=s.length?(o=new JB,s.push(o)):o=s[r],o},dispose:function t(){n=new WeakMap}}}function jte(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new N,color:new je};break;case"SpotLight":t={position:new N,direction:new N,color:new je,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new N,color:new je,distance:0,decay:0};break;case"HemisphereLight":t={direction:new N,skyColor:new je,groundColor:new je};break;case"RectAreaLight":t={color:new je,position:new N,halfWidth:new N,halfHeight:new N}}return n[e.id]=t,t}}}let qte=0;function Xte(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function Yte(n,e){const t=new jte,i=function $te(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new fe};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new fe,shadowCameraNear:1,shadowCameraFar:1e3}}return n[e.id]=t,t}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let d=0;d<9;d++)r.probe.push(new N);const s=new N,o=new bt,a=new bt;return{setup:function l(d,h){let p=0,m=0,g=0;for(let re=0;re<9;re++)r.probe[re].set(0,0,0);let b=0,v=0,y=0,w=0,E=0,x=0,C=0,A=0,D=0,O=0,T=0;d.sort(Xte);const L=!0===h?Math.PI:1;for(let re=0,ae=d.length;re<ae;re++){const H=d[re],J=H.color,j=H.intensity,$=H.distance,Q=H.shadow&&H.shadow.map?H.shadow.map.texture:null;if(H.isAmbientLight)p+=J.r*j*L,m+=J.g*j*L,g+=J.b*j*L;else if(H.isLightProbe){for(let K=0;K<9;K++)r.probe[K].addScaledVector(H.sh.coefficients[K],j);T++}else if(H.isDirectionalLight){const K=t.get(H);if(K.color.copy(H.color).multiplyScalar(H.intensity*L),H.castShadow){const ce=H.shadow,q=i.get(H);q.shadowBias=ce.bias,q.shadowNormalBias=ce.normalBias,q.shadowRadius=ce.radius,q.shadowMapSize=ce.mapSize,r.directionalShadow[b]=q,r.directionalShadowMap[b]=Q,r.directionalShadowMatrix[b]=H.shadow.matrix,x++}r.directional[b]=K,b++}else if(H.isSpotLight){const K=t.get(H);K.position.setFromMatrixPosition(H.matrixWorld),K.color.copy(J).multiplyScalar(j*L),K.distance=$,K.coneCos=Math.cos(H.angle),K.penumbraCos=Math.cos(H.angle*(1-H.penumbra)),K.decay=H.decay,r.spot[y]=K;const ce=H.shadow;if(H.map&&(r.spotLightMap[D]=H.map,D++,ce.updateMatrices(H),H.castShadow&&O++),r.spotLightMatrix[y]=ce.matrix,H.castShadow){const q=i.get(H);q.shadowBias=ce.bias,q.shadowNormalBias=ce.normalBias,q.shadowRadius=ce.radius,q.shadowMapSize=ce.mapSize,r.spotShadow[y]=q,r.spotShadowMap[y]=Q,A++}y++}else if(H.isRectAreaLight){const K=t.get(H);K.color.copy(J).multiplyScalar(j),K.halfWidth.set(.5*H.width,0,0),K.halfHeight.set(0,.5*H.height,0),r.rectArea[w]=K,w++}else if(H.isPointLight){const K=t.get(H);if(K.color.copy(H.color).multiplyScalar(H.intensity*L),K.distance=H.distance,K.decay=H.decay,H.castShadow){const ce=H.shadow,q=i.get(H);q.shadowBias=ce.bias,q.shadowNormalBias=ce.normalBias,q.shadowRadius=ce.radius,q.shadowMapSize=ce.mapSize,q.shadowCameraNear=ce.camera.near,q.shadowCameraFar=ce.camera.far,r.pointShadow[v]=q,r.pointShadowMap[v]=Q,r.pointShadowMatrix[v]=H.shadow.matrix,C++}r.point[v]=K,v++}else if(H.isHemisphereLight){const K=t.get(H);K.skyColor.copy(H.color).multiplyScalar(j*L),K.groundColor.copy(H.groundColor).multiplyScalar(j*L),r.hemi[E]=K,E++}}w>0&&(e.isWebGL2||!0===n.has("OES_texture_float_linear")?(r.rectAreaLTC1=He.LTC_FLOAT_1,r.rectAreaLTC2=He.LTC_FLOAT_2):!0===n.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=He.LTC_HALF_1,r.rectAreaLTC2=He.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=p,r.ambient[1]=m,r.ambient[2]=g;const X=r.hash;(X.directionalLength!==b||X.pointLength!==v||X.spotLength!==y||X.rectAreaLength!==w||X.hemiLength!==E||X.numDirectionalShadows!==x||X.numPointShadows!==C||X.numSpotShadows!==A||X.numSpotMaps!==D||X.numLightProbes!==T)&&(r.directional.length=b,r.spot.length=y,r.rectArea.length=w,r.point.length=v,r.hemi.length=E,r.directionalShadow.length=x,r.directionalShadowMap.length=x,r.pointShadow.length=C,r.pointShadowMap.length=C,r.spotShadow.length=A,r.spotShadowMap.length=A,r.directionalShadowMatrix.length=x,r.pointShadowMatrix.length=C,r.spotLightMatrix.length=A+D-O,r.spotLightMap.length=D,r.numSpotLightShadowsWithMaps=O,r.numLightProbes=T,X.directionalLength=b,X.pointLength=v,X.spotLength=y,X.rectAreaLength=w,X.hemiLength=E,X.numDirectionalShadows=x,X.numPointShadows=C,X.numSpotShadows=A,X.numSpotMaps=D,X.numLightProbes=T,r.version=qte++)},setupView:function c(d,h){let p=0,m=0,g=0,b=0,v=0;const y=h.matrixWorldInverse;for(let w=0,E=d.length;w<E;w++){const x=d[w];if(x.isDirectionalLight){const C=r.directional[p];C.direction.setFromMatrixPosition(x.matrixWorld),s.setFromMatrixPosition(x.target.matrixWorld),C.direction.sub(s),C.direction.transformDirection(y),p++}else if(x.isSpotLight){const C=r.spot[g];C.position.setFromMatrixPosition(x.matrixWorld),C.position.applyMatrix4(y),C.direction.setFromMatrixPosition(x.matrixWorld),s.setFromMatrixPosition(x.target.matrixWorld),C.direction.sub(s),C.direction.transformDirection(y),g++}else if(x.isRectAreaLight){const C=r.rectArea[b];C.position.setFromMatrixPosition(x.matrixWorld),C.position.applyMatrix4(y),a.identity(),o.copy(x.matrixWorld),o.premultiply(y),a.extractRotation(o),C.halfWidth.set(.5*x.width,0,0),C.halfHeight.set(0,.5*x.height,0),C.halfWidth.applyMatrix4(a),C.halfHeight.applyMatrix4(a),b++}else if(x.isPointLight){const C=r.point[m];C.position.setFromMatrixPosition(x.matrixWorld),C.position.applyMatrix4(y),m++}else if(x.isHemisphereLight){const C=r.hemi[v];C.direction.setFromMatrixPosition(x.matrixWorld),C.direction.transformDirection(y),v++}}},state:r}}function QB(n,e){const t=new Yte(n,e),i=[],r=[];return{init:function s(){i.length=0,r.length=0},state:{lightsArray:i,shadowsArray:r,lights:t},setupLights:function l(h){t.setup(i,h)},setupLightsView:function c(h){t.setupView(i,h)},pushLight:function o(h){i.push(h)},pushShadow:function a(h){r.push(h)}}}function Zte(n,e){let t=new WeakMap;return{get:function i(s,o=0){const a=t.get(s);let l;return void 0===a?(l=new QB(n,e),t.set(s,[l])):o>=a.length?(l=new QB(n,e),a.push(l)):l=a[o],l},dispose:function r(){t=new WeakMap}}}class eV extends hs{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class tV extends hs{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function Qte(n,e,t){let i=new L1;const r=new fe,s=new fe,o=new Pn,a=new eV({depthPacking:3201}),l=new tV,c={},d=t.maxTextureSize,h={0:1,1:0,2:2},p=new fu({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new fe},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),m=p.clone();m.defines.HORIZONTAL_PASS=1;const g=new Nt;g.setAttribute("position",new ti(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const b=new Ce(g,p),v=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=f3;let y=this.type;function w(C,A){const D=e.update(b);p.defines.VSM_SAMPLES!==C.blurSamples&&(p.defines.VSM_SAMPLES=C.blurSamples,m.defines.VSM_SAMPLES=C.blurSamples,p.needsUpdate=!0,m.needsUpdate=!0),null===C.mapPass&&(C.mapPass=new zd(r.x,r.y)),p.uniforms.shadow_pass.value=C.map.texture,p.uniforms.resolution.value=C.mapSize,p.uniforms.radius.value=C.radius,n.setRenderTarget(C.mapPass),n.clear(),n.renderBufferDirect(A,null,D,p,b,null),m.uniforms.shadow_pass.value=C.mapPass.texture,m.uniforms.resolution.value=C.mapSize,m.uniforms.radius.value=C.radius,n.setRenderTarget(C.map),n.clear(),n.renderBufferDirect(A,null,D,m,b,null)}function E(C,A,D,O){let T=null;const L=!0===D.isPointLight?C.customDistanceMaterial:C.customDepthMaterial;if(void 0!==L)T=L;else if(T=!0===D.isPointLight?l:a,n.localClippingEnabled&&!0===A.clipShadows&&Array.isArray(A.clippingPlanes)&&0!==A.clippingPlanes.length||A.displacementMap&&0!==A.displacementScale||A.alphaMap&&A.alphaTest>0||A.map&&A.alphaTest>0){const X=T.uuid,re=A.uuid;let ae=c[X];void 0===ae&&(ae={},c[X]=ae);let H=ae[re];void 0===H&&(H=T.clone(),ae[re]=H),T=H}return T.visible=A.visible,T.wireframe=A.wireframe,T.side=O===Ul?null!==A.shadowSide?A.shadowSide:A.side:null!==A.shadowSide?A.shadowSide:h[A.side],T.alphaMap=A.alphaMap,T.alphaTest=A.alphaTest,T.map=A.map,T.clipShadows=A.clipShadows,T.clippingPlanes=A.clippingPlanes,T.clipIntersection=A.clipIntersection,T.displacementMap=A.displacementMap,T.displacementScale=A.displacementScale,T.displacementBias=A.displacementBias,T.wireframeLinewidth=A.wireframeLinewidth,T.linewidth=A.linewidth,!0===D.isPointLight&&!0===T.isMeshDistanceMaterial&&(n.properties.get(T).light=D),T}function x(C,A,D,O,T){if(!1===C.visible)return;if(C.layers.test(A.layers)&&(C.isMesh||C.isLine||C.isPoints)&&(C.castShadow||C.receiveShadow&&T===Ul)&&(!C.frustumCulled||i.intersectsObject(C))){C.modelViewMatrix.multiplyMatrices(D.matrixWorldInverse,C.matrixWorld);const re=e.update(C),ae=C.material;if(Array.isArray(ae)){const H=re.groups;for(let J=0,j=H.length;J<j;J++){const $=H[J],Q=ae[$.materialIndex];if(Q&&Q.visible){const K=E(C,Q,O,T);n.renderBufferDirect(D,null,re,K,C,$)}}}else if(ae.visible){const H=E(C,ae,O,T);n.renderBufferDirect(D,null,re,H,C,null)}}const X=C.children;for(let re=0,ae=X.length;re<ae;re++)x(X[re],A,D,O,T)}this.render=function(C,A,D){if(!1===v.enabled||!1===v.autoUpdate&&!1===v.needsUpdate||0===C.length)return;const O=n.getRenderTarget(),T=n.getActiveCubeFace(),L=n.getActiveMipmapLevel(),X=n.state;X.setBlending(0),X.buffers.color.setClear(1,1,1,1),X.buffers.depth.setTest(!0),X.setScissorTest(!1);const re=y!==Ul&&this.type===Ul,ae=y===Ul&&this.type!==Ul;for(let H=0,J=C.length;H<J;H++){const j=C[H],$=j.shadow;if(void 0===$){console.warn("THREE.WebGLShadowMap:",j,"has no shadow.");continue}if(!1===$.autoUpdate&&!1===$.needsUpdate)continue;r.copy($.mapSize);const Q=$.getFrameExtents();if(r.multiply(Q),s.copy($.mapSize),(r.x>d||r.y>d)&&(r.x>d&&(s.x=Math.floor(d/Q.x),r.x=s.x*Q.x,$.mapSize.x=s.x),r.y>d&&(s.y=Math.floor(d/Q.y),r.y=s.y*Q.y,$.mapSize.y=s.y)),null===$.map||!0===re||!0===ae){const ce=this.type!==Ul?{minFilter:Ni,magFilter:Ni}:{};null!==$.map&&$.map.dispose(),$.map=new zd(r.x,r.y,ce),$.map.texture.name=j.name+".shadowMap",$.camera.updateProjectionMatrix()}n.setRenderTarget($.map),n.clear();const K=$.getViewportCount();for(let ce=0;ce<K;ce++){const q=$.getViewport(ce);o.set(s.x*q.x,s.y*q.y,s.x*q.z,s.y*q.w),X.viewport(o),$.updateMatrices(j,ce),i=$.getFrustum(),x(A,D,$.camera,j,this.type)}!0!==$.isPointLightShadow&&this.type===Ul&&w($,D),$.needsUpdate=!1}y=this.type,v.needsUpdate=!1,n.setRenderTarget(O,T,L)}}function ene(n,e,t){const i=t.isWebGL2,a=new function r(){let V=!1;const Oe=new Pn;let Pe=null;const We=new Pn(0,0,0,0);return{setMask:function(Fe){Pe!==Fe&&!V&&(n.colorMask(Fe,Fe,Fe,Fe),Pe=Fe)},setLocked:function(Fe){V=Fe},setClear:function(Fe,Se,nt,Mt,qi){!0===qi&&(Fe*=Mt,Se*=Mt,nt*=Mt),Oe.set(Fe,Se,nt,Mt),!1===We.equals(Oe)&&(n.clearColor(Fe,Se,nt,Mt),We.copy(Oe))},reset:function(){V=!1,Pe=null,We.set(-1,0,0,0)}}},l=new function s(){let V=!1,Oe=null,Pe=null,We=null;return{setTest:function(Fe){Fe?Ge(n.DEPTH_TEST):Ye(n.DEPTH_TEST)},setMask:function(Fe){Oe!==Fe&&!V&&(n.depthMask(Fe),Oe=Fe)},setFunc:function(Fe){if(Pe!==Fe){switch(Fe){case 0:n.depthFunc(n.NEVER);break;case 1:n.depthFunc(n.ALWAYS);break;case 2:n.depthFunc(n.LESS);break;case 3:default:n.depthFunc(n.LEQUAL);break;case 4:n.depthFunc(n.EQUAL);break;case 5:n.depthFunc(n.GEQUAL);break;case 6:n.depthFunc(n.GREATER);break;case 7:n.depthFunc(n.NOTEQUAL)}Pe=Fe}},setLocked:function(Fe){V=Fe},setClear:function(Fe){We!==Fe&&(n.clearDepth(Fe),We=Fe)},reset:function(){V=!1,Oe=null,Pe=null,We=null}}},c=new function o(){let V=!1,Oe=null,Pe=null,We=null,Fe=null,Se=null,nt=null,Mt=null,qi=null;return{setTest:function(ii){V||(ii?Ge(n.STENCIL_TEST):Ye(n.STENCIL_TEST))},setMask:function(ii){Oe!==ii&&!V&&(n.stencilMask(ii),Oe=ii)},setFunc:function(ii,Ja,gs){(Pe!==ii||We!==Ja||Fe!==gs)&&(n.stencilFunc(ii,Ja,gs),Pe=ii,We=Ja,Fe=gs)},setOp:function(ii,Ja,gs){(Se!==ii||nt!==Ja||Mt!==gs)&&(n.stencilOp(ii,Ja,gs),Se=ii,nt=Ja,Mt=gs)},setLocked:function(ii){V=ii},setClear:function(ii){qi!==ii&&(n.clearStencil(ii),qi=ii)},reset:function(){V=!1,Oe=null,Pe=null,We=null,Fe=null,Se=null,nt=null,Mt=null,qi=null}}},d=new WeakMap,h=new WeakMap;let p={},m={},g=new WeakMap,b=[],v=null,y=!1,w=null,E=null,x=null,C=null,A=null,D=null,O=null,T=!1,L=null,X=null,re=null,ae=null,H=null;const J=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let j=!1,$=0;const Q=n.getParameter(n.VERSION);-1!==Q.indexOf("WebGL")?($=parseFloat(/^WebGL (\d)/.exec(Q)[1]),j=$>=1):-1!==Q.indexOf("OpenGL ES")&&($=parseFloat(/^OpenGL ES (\d)/.exec(Q)[1]),j=$>=2);let K=null,ce={};const q=n.getParameter(n.SCISSOR_BOX),oe=n.getParameter(n.VIEWPORT),Me=(new Pn).fromArray(q),we=(new Pn).fromArray(oe);function ze(V,Oe,Pe,We){const Fe=new Uint8Array(4),Se=n.createTexture();n.bindTexture(V,Se),n.texParameteri(V,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(V,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let nt=0;nt<Pe;nt++)!i||V!==n.TEXTURE_3D&&V!==n.TEXTURE_2D_ARRAY?n.texImage2D(Oe+nt,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,Fe):n.texImage3D(Oe,0,n.RGBA,1,1,We,0,n.RGBA,n.UNSIGNED_BYTE,Fe);return Se}const Qe={};function Ge(V){!0!==p[V]&&(n.enable(V),p[V]=!0)}function Ye(V){!1!==p[V]&&(n.disable(V),p[V]=!1)}Qe[n.TEXTURE_2D]=ze(n.TEXTURE_2D,n.TEXTURE_2D,1),Qe[n.TEXTURE_CUBE_MAP]=ze(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),i&&(Qe[n.TEXTURE_2D_ARRAY]=ze(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),Qe[n.TEXTURE_3D]=ze(n.TEXTURE_3D,n.TEXTURE_3D,1,1)),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),Ge(n.DEPTH_TEST),l.setFunc(3),Ee(!1),ot(1),Ge(n.CULL_FACE),ye(0);const z={100:n.FUNC_ADD,101:n.FUNC_SUBTRACT,102:n.FUNC_REVERSE_SUBTRACT};if(i)z[103]=n.MIN,z[104]=n.MAX;else{const V=e.get("EXT_blend_minmax");null!==V&&(z[103]=V.MIN_EXT,z[104]=V.MAX_EXT)}const Ne={200:n.ZERO,201:n.ONE,202:n.SRC_COLOR,204:n.SRC_ALPHA,210:n.SRC_ALPHA_SATURATE,208:n.DST_COLOR,206:n.DST_ALPHA,203:n.ONE_MINUS_SRC_COLOR,205:n.ONE_MINUS_SRC_ALPHA,209:n.ONE_MINUS_DST_COLOR,207:n.ONE_MINUS_DST_ALPHA};function ye(V,Oe,Pe,We,Fe,Se,nt,Mt){if(0!==V){if(!1===y&&(Ge(n.BLEND),y=!0),5===V)Fe=Fe||Oe,Se=Se||Pe,nt=nt||We,(Oe!==E||Fe!==A)&&(n.blendEquationSeparate(z[Oe],z[Fe]),E=Oe,A=Fe),(Pe!==x||We!==C||Se!==D||nt!==O)&&(n.blendFuncSeparate(Ne[Pe],Ne[We],Ne[Se],Ne[nt]),x=Pe,C=We,D=Se,O=nt),w=V,T=!1;else if(V!==w||Mt!==T){if((100!==E||100!==A)&&(n.blendEquation(n.FUNC_ADD),E=100,A=100),Mt)switch(V){case 1:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case 2:n.blendFunc(n.ONE,n.ONE);break;case 3:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case 4:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",V)}else switch(V){case 1:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case 2:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case 3:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case 4:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",V)}x=null,C=null,D=null,O=null,w=V,T=Mt}}else!0===y&&(Ye(n.BLEND),y=!1)}function Ee(V){L!==V&&(n.frontFace(V?n.CW:n.CCW),L=V)}function ot(V){0!==V?(Ge(n.CULL_FACE),V!==X&&n.cullFace(1===V?n.BACK:2===V?n.FRONT:n.FRONT_AND_BACK)):Ye(n.CULL_FACE),X=V}function Je(V,Oe,Pe){V?(Ge(n.POLYGON_OFFSET_FILL),(ae!==Oe||H!==Pe)&&(n.polygonOffset(Oe,Pe),ae=Oe,H=Pe)):Ye(n.POLYGON_OFFSET_FILL)}return{buffers:{color:a,depth:l,stencil:c},enable:Ge,disable:Ye,bindFramebuffer:function _t(V,Oe){return m[V]!==Oe&&(n.bindFramebuffer(V,Oe),m[V]=Oe,i&&(V===n.DRAW_FRAMEBUFFER&&(m[n.FRAMEBUFFER]=Oe),V===n.FRAMEBUFFER&&(m[n.DRAW_FRAMEBUFFER]=Oe)),!0)},drawBuffers:function qt(V,Oe){let Pe=b,We=!1;if(V)if(Pe=g.get(Oe),void 0===Pe&&(Pe=[],g.set(Oe,Pe)),V.isWebGLMultipleRenderTargets){const Fe=V.texture;if(Pe.length!==Fe.length||Pe[0]!==n.COLOR_ATTACHMENT0){for(let Se=0,nt=Fe.length;Se<nt;Se++)Pe[Se]=n.COLOR_ATTACHMENT0+Se;Pe.length=Fe.length,We=!0}}else Pe[0]!==n.COLOR_ATTACHMENT0&&(Pe[0]=n.COLOR_ATTACHMENT0,We=!0);else Pe[0]!==n.BACK&&(Pe[0]=n.BACK,We=!0);We&&(t.isWebGL2?n.drawBuffers(Pe):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Pe))},useProgram:function rt(V){return v!==V&&(n.useProgram(V),v=V,!0)},setBlending:ye,setMaterial:function Ae(V,Oe){2===V.side?Ye(n.CULL_FACE):Ge(n.CULL_FACE);let Pe=1===V.side;Oe&&(Pe=!Pe),Ee(Pe),1===V.blending&&!1===V.transparent?ye(0):ye(V.blending,V.blendEquation,V.blendSrc,V.blendDst,V.blendEquationAlpha,V.blendSrcAlpha,V.blendDstAlpha,V.premultipliedAlpha),l.setFunc(V.depthFunc),l.setTest(V.depthTest),l.setMask(V.depthWrite),a.setMask(V.colorWrite);const We=V.stencilWrite;c.setTest(We),We&&(c.setMask(V.stencilWriteMask),c.setFunc(V.stencilFunc,V.stencilRef,V.stencilFuncMask),c.setOp(V.stencilFail,V.stencilZFail,V.stencilZPass)),Je(V.polygonOffset,V.polygonOffsetFactor,V.polygonOffsetUnits),!0===V.alphaToCoverage?Ge(n.SAMPLE_ALPHA_TO_COVERAGE):Ye(n.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:Ee,setCullFace:ot,setLineWidth:function Ze(V){V!==re&&(j&&n.lineWidth(V),re=V)},setPolygonOffset:Je,setScissorTest:function wt(V){V?Ge(n.SCISSOR_TEST):Ye(n.SCISSOR_TEST)},activeTexture:function en(V){void 0===V&&(V=n.TEXTURE0+J-1),K!==V&&(n.activeTexture(V),K=V)},bindTexture:function ai(V,Oe,Pe){void 0===Pe&&(Pe=null===K?n.TEXTURE0+J-1:K);let We=ce[Pe];void 0===We&&(We={type:void 0,texture:void 0},ce[Pe]=We),(We.type!==V||We.texture!==Oe)&&(K!==Pe&&(n.activeTexture(Pe),K=Pe),n.bindTexture(V,Oe||Qe[V]),We.type=V,We.texture=Oe)},unbindTexture:function k(){const V=ce[K];void 0!==V&&void 0!==V.type&&(n.bindTexture(V.type,null),V.type=void 0,V.texture=void 0)},compressedTexImage2D:function R(){try{n.compressedTexImage2D.apply(n,arguments)}catch(V){console.error("THREE.WebGLState:",V)}},compressedTexImage3D:function ne(){try{n.compressedTexImage3D.apply(n,arguments)}catch(V){console.error("THREE.WebGLState:",V)}},texImage2D:function G(){try{n.texImage2D.apply(n,arguments)}catch(V){console.error("THREE.WebGLState:",V)}},texImage3D:function Re(){try{n.texImage3D.apply(n,arguments)}catch(V){console.error("THREE.WebGLState:",V)}},updateUBOMapping:function at(V,Oe){let Pe=h.get(Oe);void 0===Pe&&(Pe=new WeakMap,h.set(Oe,Pe));let We=Pe.get(V);void 0===We&&(We=n.getUniformBlockIndex(Oe,V.name),Pe.set(V,We))},uniformBlockBinding:function ht(V,Oe){const We=h.get(Oe).get(V);d.get(Oe)!==We&&(n.uniformBlockBinding(Oe,We,V.__bindingPointIndex),d.set(Oe,We))},texStorage2D:function Ie(){try{n.texStorage2D.apply(n,arguments)}catch(V){console.error("THREE.WebGLState:",V)}},texStorage3D:function $e(){try{n.texStorage3D.apply(n,arguments)}catch(V){console.error("THREE.WebGLState:",V)}},texSubImage2D:function Te(){try{n.texSubImage2D.apply(n,arguments)}catch(V){console.error("THREE.WebGLState:",V)}},texSubImage3D:function xe(){try{n.texSubImage3D.apply(n,arguments)}catch(V){console.error("THREE.WebGLState:",V)}},compressedTexSubImage2D:function De(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(V){console.error("THREE.WebGLState:",V)}},compressedTexSubImage3D:function it(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(V){console.error("THREE.WebGLState:",V)}},scissor:function ve(V){!1===Me.equals(V)&&(n.scissor(V.x,V.y,V.z,V.w),Me.copy(V))},viewport:function St(V){!1===we.equals(V)&&(n.viewport(V.x,V.y,V.z,V.w),we.copy(V))},reset:function st(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),!0===i&&(n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),p={},K=null,ce={},m={},g=new WeakMap,b=[],v=null,y=!1,w=null,E=null,x=null,C=null,A=null,D=null,O=null,T=!1,L=null,X=null,re=null,ae=null,H=null,Me.set(0,0,n.canvas.width,n.canvas.height),we.set(0,0,n.canvas.width,n.canvas.height),a.reset(),l.reset(),c.reset()}}}function tne(n,e,t,i,r,s,o){const a=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,d=r.maxTextureSize,h=r.maxSamples,p=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,m=!(typeof navigator>"u")&&/OculusBrowser/g.test(navigator.userAgent),g=new WeakMap;let b;const v=new WeakMap;let y=!1;try{y=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function w(k,R){return y?new OffscreenCanvas(k,R):zy("canvas")}function E(k,R,ne,Te){let xe=1;if((k.width>Te||k.height>Te)&&(xe=Te/Math.max(k.width,k.height)),xe<1||!0===R){if(typeof HTMLImageElement<"u"&&k instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&k instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&k instanceof ImageBitmap){const De=R?$E:Math.floor,it=De(xe*k.width),Ie=De(xe*k.height);void 0===b&&(b=w(it,Ie));const $e=ne?w(it,Ie):b;return $e.width=it,$e.height=Ie,$e.getContext("2d").drawImage(k,0,0,it,Ie),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+k.width+"x"+k.height+") to ("+it+"x"+Ie+")."),$e}return"data"in k&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+k.width+"x"+k.height+")."),k}return k}function x(k){return f1(k.width)&&f1(k.height)}function A(k,R){return k.generateMipmaps&&R&&k.minFilter!==Ni&&k.minFilter!==_i}function D(k){n.generateMipmap(k)}function O(k,R,ne,Te,xe=!1){if(!1===a)return R;if(null!==k){if(void 0!==n[k])return n[k];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+k+"'")}let De=R;if(R===n.RED&&(ne===n.FLOAT&&(De=n.R32F),ne===n.HALF_FLOAT&&(De=n.R16F),ne===n.UNSIGNED_BYTE&&(De=n.R8)),R===n.RED_INTEGER&&(ne===n.UNSIGNED_BYTE&&(De=n.R8UI),ne===n.UNSIGNED_SHORT&&(De=n.R16UI),ne===n.UNSIGNED_INT&&(De=n.R32UI),ne===n.BYTE&&(De=n.R8I),ne===n.SHORT&&(De=n.R16I),ne===n.INT&&(De=n.R32I)),R===n.RG&&(ne===n.FLOAT&&(De=n.RG32F),ne===n.HALF_FLOAT&&(De=n.RG16F),ne===n.UNSIGNED_BYTE&&(De=n.RG8)),R===n.RGBA){const it=xe?HE:En.getTransfer(Te);ne===n.FLOAT&&(De=n.RGBA32F),ne===n.HALF_FLOAT&&(De=n.RGBA16F),ne===n.UNSIGNED_BYTE&&(De=it===ei?n.SRGB8_ALPHA8:n.RGBA8),ne===n.UNSIGNED_SHORT_4_4_4_4&&(De=n.RGBA4),ne===n.UNSIGNED_SHORT_5_5_5_1&&(De=n.RGB5_A1)}return(De===n.R16F||De===n.R32F||De===n.RG16F||De===n.RG32F||De===n.RGBA16F||De===n.RGBA32F)&&e.get("EXT_color_buffer_float"),De}function T(k,R,ne){return!0===A(k,ne)||k.isFramebufferTexture&&k.minFilter!==Ni&&k.minFilter!==_i?Math.log2(Math.max(R.width,R.height))+1:void 0!==k.mipmaps&&k.mipmaps.length>0?k.mipmaps.length:k.isCompressedTexture&&Array.isArray(k.image)?R.mipmaps.length:1}function L(k){return k===Ni||1004===k||1005===k?n.NEAREST:n.LINEAR}function X(k){const R=k.target;R.removeEventListener("dispose",X),function ae(k){const R=i.get(k);if(void 0===R.__webglInit)return;const ne=k.source,Te=v.get(ne);if(Te){const xe=Te[R.__cacheKey];xe.usedTimes--,0===xe.usedTimes&&H(k),0===Object.keys(Te).length&&v.delete(ne)}i.remove(k)}(R),R.isVideoTexture&&g.delete(R)}function re(k){const R=k.target;R.removeEventListener("dispose",re),function J(k){const R=k.texture,ne=i.get(k),Te=i.get(R);if(void 0!==Te.__webglTexture&&(n.deleteTexture(Te.__webglTexture),o.memory.textures--),k.depthTexture&&k.depthTexture.dispose(),k.isWebGLCubeRenderTarget)for(let xe=0;xe<6;xe++){if(Array.isArray(ne.__webglFramebuffer[xe]))for(let De=0;De<ne.__webglFramebuffer[xe].length;De++)n.deleteFramebuffer(ne.__webglFramebuffer[xe][De]);else n.deleteFramebuffer(ne.__webglFramebuffer[xe]);ne.__webglDepthbuffer&&n.deleteRenderbuffer(ne.__webglDepthbuffer[xe])}else{if(Array.isArray(ne.__webglFramebuffer))for(let xe=0;xe<ne.__webglFramebuffer.length;xe++)n.deleteFramebuffer(ne.__webglFramebuffer[xe]);else n.deleteFramebuffer(ne.__webglFramebuffer);if(ne.__webglDepthbuffer&&n.deleteRenderbuffer(ne.__webglDepthbuffer),ne.__webglMultisampledFramebuffer&&n.deleteFramebuffer(ne.__webglMultisampledFramebuffer),ne.__webglColorRenderbuffer)for(let xe=0;xe<ne.__webglColorRenderbuffer.length;xe++)ne.__webglColorRenderbuffer[xe]&&n.deleteRenderbuffer(ne.__webglColorRenderbuffer[xe]);ne.__webglDepthRenderbuffer&&n.deleteRenderbuffer(ne.__webglDepthRenderbuffer)}if(k.isWebGLMultipleRenderTargets)for(let xe=0,De=R.length;xe<De;xe++){const it=i.get(R[xe]);it.__webglTexture&&(n.deleteTexture(it.__webglTexture),o.memory.textures--),i.remove(R[xe])}i.remove(R),i.remove(k)}(R)}function H(k){const R=i.get(k);n.deleteTexture(R.__webglTexture),delete v.get(k.source)[R.__cacheKey],o.memory.textures--}let j=0;function ce(k,R){const ne=i.get(k);if(k.isVideoTexture&&function en(k){const R=o.render.frame;g.get(k)!==R&&(g.set(k,R),k.update())}(k),!1===k.isRenderTargetTexture&&k.version>0&&ne.__version!==k.version){const Te=k.image;if(null===Te)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==Te.complete)return void _t(ne,k,R);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.bindTexture(n.TEXTURE_2D,ne.__webglTexture,n.TEXTURE0+R)}const we={[Od]:n.REPEAT,[Vr]:n.CLAMP_TO_EDGE,1002:n.MIRRORED_REPEAT},ze={[Ni]:n.NEAREST,1004:n.NEAREST_MIPMAP_NEAREST,1005:n.NEAREST_MIPMAP_LINEAR,[_i]:n.LINEAR,1007:n.LINEAR_MIPMAP_NEAREST,[Vl]:n.LINEAR_MIPMAP_LINEAR},Qe={512:n.NEVER,519:n.ALWAYS,513:n.LESS,515:n.LEQUAL,514:n.EQUAL,518:n.GEQUAL,516:n.GREATER,517:n.NOTEQUAL};function Ge(k,R,ne){if(ne?(n.texParameteri(k,n.TEXTURE_WRAP_S,we[R.wrapS]),n.texParameteri(k,n.TEXTURE_WRAP_T,we[R.wrapT]),(k===n.TEXTURE_3D||k===n.TEXTURE_2D_ARRAY)&&n.texParameteri(k,n.TEXTURE_WRAP_R,we[R.wrapR]),n.texParameteri(k,n.TEXTURE_MAG_FILTER,ze[R.magFilter]),n.texParameteri(k,n.TEXTURE_MIN_FILTER,ze[R.minFilter])):(n.texParameteri(k,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(k,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),(k===n.TEXTURE_3D||k===n.TEXTURE_2D_ARRAY)&&n.texParameteri(k,n.TEXTURE_WRAP_R,n.CLAMP_TO_EDGE),(R.wrapS!==Vr||R.wrapT!==Vr)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(k,n.TEXTURE_MAG_FILTER,L(R.magFilter)),n.texParameteri(k,n.TEXTURE_MIN_FILTER,L(R.minFilter)),R.minFilter!==Ni&&R.minFilter!==_i&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),R.compareFunction&&(n.texParameteri(k,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(k,n.TEXTURE_COMPARE_FUNC,Qe[R.compareFunction])),!0===e.has("EXT_texture_filter_anisotropic")){const Te=e.get("EXT_texture_filter_anisotropic");if(R.magFilter===Ni||1005!==R.minFilter&&R.minFilter!==Vl||R.type===Hl&&!1===e.has("OES_texture_float_linear")||!1===a&&R.type===By&&!1===e.has("OES_texture_half_float_linear"))return;(R.anisotropy>1||i.get(R).__currentAnisotropy)&&(n.texParameterf(k,Te.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(R.anisotropy,r.getMaxAnisotropy())),i.get(R).__currentAnisotropy=R.anisotropy)}}function Ye(k,R){let ne=!1;void 0===k.__webglInit&&(k.__webglInit=!0,R.addEventListener("dispose",X));const Te=R.source;let xe=v.get(Te);void 0===xe&&(xe={},v.set(Te,xe));const De=function K(k){const R=[];return R.push(k.wrapS),R.push(k.wrapT),R.push(k.wrapR||0),R.push(k.magFilter),R.push(k.minFilter),R.push(k.anisotropy),R.push(k.internalFormat),R.push(k.format),R.push(k.type),R.push(k.generateMipmaps),R.push(k.premultiplyAlpha),R.push(k.flipY),R.push(k.unpackAlignment),R.push(k.colorSpace),R.join()}(R);if(De!==k.__cacheKey){void 0===xe[De]&&(xe[De]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,ne=!0),xe[De].usedTimes++;const it=xe[k.__cacheKey];void 0!==it&&(xe[k.__cacheKey].usedTimes--,0===it.usedTimes&&H(R)),k.__cacheKey=De,k.__webglTexture=xe[De].texture}return ne}function _t(k,R,ne){let Te=n.TEXTURE_2D;(R.isDataArrayTexture||R.isCompressedArrayTexture)&&(Te=n.TEXTURE_2D_ARRAY),R.isData3DTexture&&(Te=n.TEXTURE_3D);const xe=Ye(k,R),De=R.source;t.bindTexture(Te,k.__webglTexture,n.TEXTURE0+ne);const it=i.get(De);if(De.version!==it.__version||!0===xe){t.activeTexture(n.TEXTURE0+ne);const Ie=En.getPrimaries(En.workingColorSpace),$e=""===R.colorSpace?null:En.getPrimaries(R.colorSpace),G=""===R.colorSpace||Ie===$e?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,R.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,R.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,R.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,G);const Re=function C(k){return!a&&(k.wrapS!==Vr||k.wrapT!==Vr||k.minFilter!==Ni&&k.minFilter!==_i)}(R)&&!1===x(R.image);let ve=E(R.image,Re,!1,d);ve=ai(R,ve);const St=x(ve)||a,at=s.convert(R.format,R.colorSpace);let V,ht=s.convert(R.type),st=O(R.internalFormat,at,ht,R.colorSpace,R.isVideoTexture);Ge(Te,R,St);const Oe=R.mipmaps,Pe=a&&!0!==R.isVideoTexture,We=void 0===it.__version||!0===xe,Fe=T(R,ve,St);if(R.isDepthTexture)st=n.DEPTH_COMPONENT,a?st=R.type===Hl?n.DEPTH_COMPONENT32F:R.type===ou?n.DEPTH_COMPONENT24:R.type===Fd?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT16:R.type===Hl&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),R.format===kd&&st===n.DEPTH_COMPONENT&&1012!==R.type&&R.type!==ou&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),R.type=ou,ht=s.convert(R.type)),R.format===Up&&st===n.DEPTH_COMPONENT&&(st=n.DEPTH_STENCIL,R.type!==Fd&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),R.type=Fd,ht=s.convert(R.type))),We&&(Pe?t.texStorage2D(n.TEXTURE_2D,1,st,ve.width,ve.height):t.texImage2D(n.TEXTURE_2D,0,st,ve.width,ve.height,0,at,ht,null));else if(R.isDataTexture)if(Oe.length>0&&St){Pe&&We&&t.texStorage2D(n.TEXTURE_2D,Fe,st,Oe[0].width,Oe[0].height);for(let Se=0,nt=Oe.length;Se<nt;Se++)V=Oe[Se],Pe?t.texSubImage2D(n.TEXTURE_2D,Se,0,0,V.width,V.height,at,ht,V.data):t.texImage2D(n.TEXTURE_2D,Se,st,V.width,V.height,0,at,ht,V.data);R.generateMipmaps=!1}else Pe?(We&&t.texStorage2D(n.TEXTURE_2D,Fe,st,ve.width,ve.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,ve.width,ve.height,at,ht,ve.data)):t.texImage2D(n.TEXTURE_2D,0,st,ve.width,ve.height,0,at,ht,ve.data);else if(R.isCompressedTexture)if(R.isCompressedArrayTexture){Pe&&We&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Fe,st,Oe[0].width,Oe[0].height,ve.depth);for(let Se=0,nt=Oe.length;Se<nt;Se++)V=Oe[Se],R.format!==So?null!==at?Pe?t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,Se,0,0,0,V.width,V.height,ve.depth,at,V.data,0,0):t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,Se,st,V.width,V.height,ve.depth,0,V.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Pe?t.texSubImage3D(n.TEXTURE_2D_ARRAY,Se,0,0,0,V.width,V.height,ve.depth,at,ht,V.data):t.texImage3D(n.TEXTURE_2D_ARRAY,Se,st,V.width,V.height,ve.depth,0,at,ht,V.data)}else{Pe&&We&&t.texStorage2D(n.TEXTURE_2D,Fe,st,Oe[0].width,Oe[0].height);for(let Se=0,nt=Oe.length;Se<nt;Se++)V=Oe[Se],R.format!==So?null!==at?Pe?t.compressedTexSubImage2D(n.TEXTURE_2D,Se,0,0,V.width,V.height,at,V.data):t.compressedTexImage2D(n.TEXTURE_2D,Se,st,V.width,V.height,0,V.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Pe?t.texSubImage2D(n.TEXTURE_2D,Se,0,0,V.width,V.height,at,ht,V.data):t.texImage2D(n.TEXTURE_2D,Se,st,V.width,V.height,0,at,ht,V.data)}else if(R.isDataArrayTexture)Pe?(We&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Fe,st,ve.width,ve.height,ve.depth),t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,ve.width,ve.height,ve.depth,at,ht,ve.data)):t.texImage3D(n.TEXTURE_2D_ARRAY,0,st,ve.width,ve.height,ve.depth,0,at,ht,ve.data);else if(R.isData3DTexture)Pe?(We&&t.texStorage3D(n.TEXTURE_3D,Fe,st,ve.width,ve.height,ve.depth),t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,ve.width,ve.height,ve.depth,at,ht,ve.data)):t.texImage3D(n.TEXTURE_3D,0,st,ve.width,ve.height,ve.depth,0,at,ht,ve.data);else if(R.isFramebufferTexture){if(We)if(Pe)t.texStorage2D(n.TEXTURE_2D,Fe,st,ve.width,ve.height);else{let Se=ve.width,nt=ve.height;for(let Mt=0;Mt<Fe;Mt++)t.texImage2D(n.TEXTURE_2D,Mt,st,Se,nt,0,at,ht,null),Se>>=1,nt>>=1}}else if(Oe.length>0&&St){Pe&&We&&t.texStorage2D(n.TEXTURE_2D,Fe,st,Oe[0].width,Oe[0].height);for(let Se=0,nt=Oe.length;Se<nt;Se++)V=Oe[Se],Pe?t.texSubImage2D(n.TEXTURE_2D,Se,0,0,at,ht,V):t.texImage2D(n.TEXTURE_2D,Se,st,at,ht,V);R.generateMipmaps=!1}else Pe?(We&&t.texStorage2D(n.TEXTURE_2D,Fe,st,ve.width,ve.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,at,ht,ve)):t.texImage2D(n.TEXTURE_2D,0,st,at,ht,ve);A(R,St)&&D(Te),it.__version=De.version,R.onUpdate&&R.onUpdate(R)}k.__version=R.version}function rt(k,R,ne,Te,xe,De){const it=s.convert(ne.format,ne.colorSpace),Ie=s.convert(ne.type),$e=O(ne.internalFormat,it,Ie,ne.colorSpace);if(!i.get(R).__hasExternalTextures){const Re=Math.max(1,R.width>>De),ve=Math.max(1,R.height>>De);xe===n.TEXTURE_3D||xe===n.TEXTURE_2D_ARRAY?t.texImage3D(xe,De,$e,Re,ve,R.depth,0,it,Ie,null):t.texImage2D(xe,De,$e,Re,ve,0,it,Ie,null)}t.bindFramebuffer(n.FRAMEBUFFER,k),wt(R)?p.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,Te,xe,i.get(ne).__webglTexture,0,Je(R)):(xe===n.TEXTURE_2D||xe>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&xe<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,Te,xe,i.get(ne).__webglTexture,De),t.bindFramebuffer(n.FRAMEBUFFER,null)}function z(k,R,ne){if(n.bindRenderbuffer(n.RENDERBUFFER,k),R.depthBuffer&&!R.stencilBuffer){let Te=!0===a?n.DEPTH_COMPONENT24:n.DEPTH_COMPONENT16;if(ne||wt(R)){const xe=R.depthTexture;xe&&xe.isDepthTexture&&(xe.type===Hl?Te=n.DEPTH_COMPONENT32F:xe.type===ou&&(Te=n.DEPTH_COMPONENT24));const De=Je(R);wt(R)?p.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,De,Te,R.width,R.height):n.renderbufferStorageMultisample(n.RENDERBUFFER,De,Te,R.width,R.height)}else n.renderbufferStorage(n.RENDERBUFFER,Te,R.width,R.height);n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,k)}else if(R.depthBuffer&&R.stencilBuffer){const Te=Je(R);ne&&!1===wt(R)?n.renderbufferStorageMultisample(n.RENDERBUFFER,Te,n.DEPTH24_STENCIL8,R.width,R.height):wt(R)?p.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Te,n.DEPTH24_STENCIL8,R.width,R.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,R.width,R.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,k)}else{const Te=!0===R.isWebGLMultipleRenderTargets?R.texture:[R.texture];for(let xe=0;xe<Te.length;xe++){const De=Te[xe],it=s.convert(De.format,De.colorSpace),Ie=s.convert(De.type),$e=O(De.internalFormat,it,Ie,De.colorSpace),G=Je(R);ne&&!1===wt(R)?n.renderbufferStorageMultisample(n.RENDERBUFFER,G,$e,R.width,R.height):wt(R)?p.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,G,$e,R.width,R.height):n.renderbufferStorage(n.RENDERBUFFER,$e,R.width,R.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function ye(k){const R=i.get(k),ne=!0===k.isWebGLCubeRenderTarget;if(k.depthTexture&&!R.__autoAllocateDepthBuffer){if(ne)throw new Error("target.depthTexture not supported in Cube render targets");!function Ne(k,R){if(R&&R.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,k),!R.depthTexture||!R.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(R.depthTexture).__webglTexture||R.depthTexture.image.width!==R.width||R.depthTexture.image.height!==R.height)&&(R.depthTexture.image.width=R.width,R.depthTexture.image.height=R.height,R.depthTexture.needsUpdate=!0),ce(R.depthTexture,0);const Te=i.get(R.depthTexture).__webglTexture,xe=Je(R);if(R.depthTexture.format===kd)wt(R)?p.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,Te,0,xe):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,Te,0);else{if(R.depthTexture.format!==Up)throw new Error("Unknown depthTexture format");wt(R)?p.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,Te,0,xe):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,Te,0)}}(R.__webglFramebuffer,k)}else if(ne){R.__webglDepthbuffer=[];for(let Te=0;Te<6;Te++)t.bindFramebuffer(n.FRAMEBUFFER,R.__webglFramebuffer[Te]),R.__webglDepthbuffer[Te]=n.createRenderbuffer(),z(R.__webglDepthbuffer[Te],k,!1)}else t.bindFramebuffer(n.FRAMEBUFFER,R.__webglFramebuffer),R.__webglDepthbuffer=n.createRenderbuffer(),z(R.__webglDepthbuffer,k,!1);t.bindFramebuffer(n.FRAMEBUFFER,null)}function Je(k){return Math.min(h,k.samples)}function wt(k){const R=i.get(k);return a&&k.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==R.__useRenderToTexture}function ai(k,R){const ne=k.colorSpace,Te=k.format,xe=k.type;return!0===k.isCompressedTexture||!0===k.isVideoTexture||1035===k.format||ne!==Cr&&""!==ne&&(En.getTransfer(ne)===ei?!1===a?!0===e.has("EXT_sRGB")&&Te===So?(k.format=1035,k.minFilter=_i,k.generateMipmaps=!1):R=lB.sRGBToLinear(R):(Te!==So||xe!==su)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",ne)),R}this.allocateTextureUnit=function Q(){const k=j;return k>=l&&console.warn("THREE.WebGLTextures: Trying to use "+k+" texture units while this GPU supports only "+l),j+=1,k},this.resetTextureUnits=function $(){j=0},this.setTexture2D=ce,this.setTexture2DArray=function q(k,R){const ne=i.get(k);k.version>0&&ne.__version!==k.version?_t(ne,k,R):t.bindTexture(n.TEXTURE_2D_ARRAY,ne.__webglTexture,n.TEXTURE0+R)},this.setTexture3D=function oe(k,R){const ne=i.get(k);k.version>0&&ne.__version!==k.version?_t(ne,k,R):t.bindTexture(n.TEXTURE_3D,ne.__webglTexture,n.TEXTURE0+R)},this.setTextureCube=function Me(k,R){const ne=i.get(k);k.version>0&&ne.__version!==k.version?function qt(k,R,ne){if(6!==R.image.length)return;const Te=Ye(k,R),xe=R.source;t.bindTexture(n.TEXTURE_CUBE_MAP,k.__webglTexture,n.TEXTURE0+ne);const De=i.get(xe);if(xe.version!==De.__version||!0===Te){t.activeTexture(n.TEXTURE0+ne);const it=En.getPrimaries(En.workingColorSpace),Ie=""===R.colorSpace?null:En.getPrimaries(R.colorSpace),$e=""===R.colorSpace||it===Ie?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,R.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,R.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,R.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,$e);const G=R.isCompressedTexture||R.image[0].isCompressedTexture,Re=R.image[0]&&R.image[0].isDataTexture,ve=[];for(let Se=0;Se<6;Se++)ve[Se]=G||Re?Re?R.image[Se].image:R.image[Se]:E(R.image[Se],!1,!0,c),ve[Se]=ai(R,ve[Se]);const St=ve[0],at=x(St)||a,ht=s.convert(R.format,R.colorSpace),st=s.convert(R.type),V=O(R.internalFormat,ht,st,R.colorSpace),Oe=a&&!0!==R.isVideoTexture,Pe=void 0===De.__version||!0===Te;let Fe,We=T(R,St,at);if(Ge(n.TEXTURE_CUBE_MAP,R,at),G){Oe&&Pe&&t.texStorage2D(n.TEXTURE_CUBE_MAP,We,V,St.width,St.height);for(let Se=0;Se<6;Se++){Fe=ve[Se].mipmaps;for(let nt=0;nt<Fe.length;nt++){const Mt=Fe[nt];R.format!==So?null!==ht?Oe?t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Se,nt,0,0,Mt.width,Mt.height,ht,Mt.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Se,nt,V,Mt.width,Mt.height,0,Mt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Oe?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Se,nt,0,0,Mt.width,Mt.height,ht,st,Mt.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Se,nt,V,Mt.width,Mt.height,0,ht,st,Mt.data)}}}else{Fe=R.mipmaps,Oe&&Pe&&(Fe.length>0&&We++,t.texStorage2D(n.TEXTURE_CUBE_MAP,We,V,ve[0].width,ve[0].height));for(let Se=0;Se<6;Se++)if(Re){Oe?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Se,0,0,0,ve[Se].width,ve[Se].height,ht,st,ve[Se].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Se,0,V,ve[Se].width,ve[Se].height,0,ht,st,ve[Se].data);for(let nt=0;nt<Fe.length;nt++){const qi=Fe[nt].image[Se].image;Oe?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Se,nt+1,0,0,qi.width,qi.height,ht,st,qi.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Se,nt+1,V,qi.width,qi.height,0,ht,st,qi.data)}}else{Oe?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Se,0,0,0,ht,st,ve[Se]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Se,0,V,ht,st,ve[Se]);for(let nt=0;nt<Fe.length;nt++){const Mt=Fe[nt];Oe?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Se,nt+1,0,0,ht,st,Mt.image[Se]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Se,nt+1,V,ht,st,Mt.image[Se])}}}A(R,at)&&D(n.TEXTURE_CUBE_MAP),De.__version=xe.version,R.onUpdate&&R.onUpdate(R)}k.__version=R.version}(ne,k,R):t.bindTexture(n.TEXTURE_CUBE_MAP,ne.__webglTexture,n.TEXTURE0+R)},this.rebindTextures=function Ae(k,R,ne){const Te=i.get(k);void 0!==R&&rt(Te.__webglFramebuffer,k,k.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),void 0!==ne&&ye(k)},this.setupRenderTarget=function Ee(k){const R=k.texture,ne=i.get(k),Te=i.get(R);k.addEventListener("dispose",re),!0!==k.isWebGLMultipleRenderTargets&&(void 0===Te.__webglTexture&&(Te.__webglTexture=n.createTexture()),Te.__version=R.version,o.memory.textures++);const xe=!0===k.isWebGLCubeRenderTarget,De=!0===k.isWebGLMultipleRenderTargets,it=x(k)||a;if(xe){ne.__webglFramebuffer=[];for(let Ie=0;Ie<6;Ie++)if(a&&R.mipmaps&&R.mipmaps.length>0){ne.__webglFramebuffer[Ie]=[];for(let $e=0;$e<R.mipmaps.length;$e++)ne.__webglFramebuffer[Ie][$e]=n.createFramebuffer()}else ne.__webglFramebuffer[Ie]=n.createFramebuffer()}else{if(a&&R.mipmaps&&R.mipmaps.length>0){ne.__webglFramebuffer=[];for(let Ie=0;Ie<R.mipmaps.length;Ie++)ne.__webglFramebuffer[Ie]=n.createFramebuffer()}else ne.__webglFramebuffer=n.createFramebuffer();if(De)if(r.drawBuffers){const Ie=k.texture;for(let $e=0,G=Ie.length;$e<G;$e++){const Re=i.get(Ie[$e]);void 0===Re.__webglTexture&&(Re.__webglTexture=n.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&k.samples>0&&!1===wt(k)){const Ie=De?R:[R];ne.__webglMultisampledFramebuffer=n.createFramebuffer(),ne.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,ne.__webglMultisampledFramebuffer);for(let $e=0;$e<Ie.length;$e++){const G=Ie[$e];ne.__webglColorRenderbuffer[$e]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,ne.__webglColorRenderbuffer[$e]);const Re=s.convert(G.format,G.colorSpace),ve=s.convert(G.type),St=O(G.internalFormat,Re,ve,G.colorSpace,!0===k.isXRRenderTarget),at=Je(k);n.renderbufferStorageMultisample(n.RENDERBUFFER,at,St,k.width,k.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+$e,n.RENDERBUFFER,ne.__webglColorRenderbuffer[$e])}n.bindRenderbuffer(n.RENDERBUFFER,null),k.depthBuffer&&(ne.__webglDepthRenderbuffer=n.createRenderbuffer(),z(ne.__webglDepthRenderbuffer,k,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(xe){t.bindTexture(n.TEXTURE_CUBE_MAP,Te.__webglTexture),Ge(n.TEXTURE_CUBE_MAP,R,it);for(let Ie=0;Ie<6;Ie++)if(a&&R.mipmaps&&R.mipmaps.length>0)for(let $e=0;$e<R.mipmaps.length;$e++)rt(ne.__webglFramebuffer[Ie][$e],k,R,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Ie,$e);else rt(ne.__webglFramebuffer[Ie],k,R,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Ie,0);A(R,it)&&D(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(De){const Ie=k.texture;for(let $e=0,G=Ie.length;$e<G;$e++){const Re=Ie[$e],ve=i.get(Re);t.bindTexture(n.TEXTURE_2D,ve.__webglTexture),Ge(n.TEXTURE_2D,Re,it),rt(ne.__webglFramebuffer,k,Re,n.COLOR_ATTACHMENT0+$e,n.TEXTURE_2D,0),A(Re,it)&&D(n.TEXTURE_2D)}t.unbindTexture()}else{let Ie=n.TEXTURE_2D;if((k.isWebGL3DRenderTarget||k.isWebGLArrayRenderTarget)&&(a?Ie=k.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(Ie,Te.__webglTexture),Ge(Ie,R,it),a&&R.mipmaps&&R.mipmaps.length>0)for(let $e=0;$e<R.mipmaps.length;$e++)rt(ne.__webglFramebuffer[$e],k,R,n.COLOR_ATTACHMENT0,Ie,$e);else rt(ne.__webglFramebuffer,k,R,n.COLOR_ATTACHMENT0,Ie,0);A(R,it)&&D(Ie),t.unbindTexture()}k.depthBuffer&&ye(k)},this.updateRenderTargetMipmap=function ot(k){const R=x(k)||a,ne=!0===k.isWebGLMultipleRenderTargets?k.texture:[k.texture];for(let Te=0,xe=ne.length;Te<xe;Te++){const De=ne[Te];if(A(De,R)){const it=k.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D,Ie=i.get(De).__webglTexture;t.bindTexture(it,Ie),D(it),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function Ze(k){if(a&&k.samples>0&&!1===wt(k)){const R=k.isWebGLMultipleRenderTargets?k.texture:[k.texture],ne=k.width,Te=k.height;let xe=n.COLOR_BUFFER_BIT;const De=[],it=k.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Ie=i.get(k),$e=!0===k.isWebGLMultipleRenderTargets;if($e)for(let G=0;G<R.length;G++)t.bindFramebuffer(n.FRAMEBUFFER,Ie.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+G,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,Ie.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+G,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,Ie.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Ie.__webglFramebuffer);for(let G=0;G<R.length;G++){De.push(n.COLOR_ATTACHMENT0+G),k.depthBuffer&&De.push(it);const Re=void 0!==Ie.__ignoreDepthValues&&Ie.__ignoreDepthValues;if(!1===Re&&(k.depthBuffer&&(xe|=n.DEPTH_BUFFER_BIT),k.stencilBuffer&&(xe|=n.STENCIL_BUFFER_BIT)),$e&&n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,Ie.__webglColorRenderbuffer[G]),!0===Re&&(n.invalidateFramebuffer(n.READ_FRAMEBUFFER,[it]),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[it])),$e){const ve=i.get(R[G]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,ve,0)}n.blitFramebuffer(0,0,ne,Te,0,0,ne,Te,xe,n.NEAREST),m&&n.invalidateFramebuffer(n.READ_FRAMEBUFFER,De)}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),$e)for(let G=0;G<R.length;G++){t.bindFramebuffer(n.FRAMEBUFFER,Ie.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+G,n.RENDERBUFFER,Ie.__webglColorRenderbuffer[G]);const Re=i.get(R[G]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,Ie.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+G,n.TEXTURE_2D,Re,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Ie.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=ye,this.setupFrameBufferTexture=rt,this.useMultisampledRTT=wt}function nne(n,e,t){const i=t.isWebGL2;return{convert:function r(s,o=""){let a;const l=En.getTransfer(o);if(s===su)return n.UNSIGNED_BYTE;if(1017===s)return n.UNSIGNED_SHORT_4_4_4_4;if(1018===s)return n.UNSIGNED_SHORT_5_5_5_1;if(1010===s)return n.BYTE;if(1011===s)return n.SHORT;if(1012===s)return n.UNSIGNED_SHORT;if(1013===s)return n.INT;if(s===ou)return n.UNSIGNED_INT;if(s===Hl)return n.FLOAT;if(s===By)return i?n.HALF_FLOAT:(a=e.get("OES_texture_half_float"),null!==a?a.HALF_FLOAT_OES:null);if(1021===s)return n.ALPHA;if(s===So)return n.RGBA;if(1024===s)return n.LUMINANCE;if(1025===s)return n.LUMINANCE_ALPHA;if(s===kd)return n.DEPTH_COMPONENT;if(s===Up)return n.DEPTH_STENCIL;if(1035===s)return a=e.get("EXT_sRGB"),null!==a?a.SRGB_ALPHA_EXT:null;if(1028===s)return n.RED;if(1029===s)return n.RED_INTEGER;if(1030===s)return n.RG;if(1031===s)return n.RG_INTEGER;if(1033===s)return n.RGBA_INTEGER;if(33776===s||33777===s||33778===s||33779===s)if(l===ei){if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===a)return null;if(33776===s)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(a=e.get("WEBGL_compressed_texture_s3tc"),null===a)return null;if(33776===s)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===s)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===s)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===s)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===s||35841===s||35842===s||35843===s){if(a=e.get("WEBGL_compressed_texture_pvrtc"),null===a)return null;if(35840===s)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===s)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===s)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===s)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===s)return a=e.get("WEBGL_compressed_texture_etc1"),null!==a?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===s||37496===s){if(a=e.get("WEBGL_compressed_texture_etc"),null===a)return null;if(37492===s)return l===ei?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(37496===s)return l===ei?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}if(37808===s||37809===s||37810===s||37811===s||37812===s||37813===s||37814===s||37815===s||37816===s||37817===s||37818===s||37819===s||37820===s||37821===s){if(a=e.get("WEBGL_compressed_texture_astc"),null===a)return null;if(37808===s)return l===ei?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===s)return l===ei?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===s)return l===ei?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===s)return l===ei?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===s)return l===ei?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===s)return l===ei?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===s)return l===ei?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===s)return l===ei?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===s)return l===ei?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===s)return l===ei?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===s)return l===ei?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===s)return l===ei?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===s)return l===ei?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===s)return l===ei?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===s||36494===s||36495===s){if(a=e.get("EXT_texture_compression_bptc"),null===a)return null;if(36492===s)return l===ei?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(36494===s)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(36495===s)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(36283===s||36284===s||36285===s||36286===s){if(a=e.get("EXT_texture_compression_rgtc"),null===a)return null;if(36492===s)return a.COMPRESSED_RED_RGTC1_EXT;if(36284===s)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===s)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===s)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return s===Fd?i?n.UNSIGNED_INT_24_8:(a=e.get("WEBGL_depth_texture"),null!==a?a.UNSIGNED_INT_24_8_WEBGL:null):void 0!==n[s]?n[s]:null}}}class ine extends nr{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class $a extends vi{constructor(){super(),this.isGroup=!0,this.type="Group"}}const rne={type:"move"};class H1{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new $a,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new $a,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new N,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new N),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new $a,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new N,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new N),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,i){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,c=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(c&&e.hand){o=!0;for(const b of e.hand.values()){const v=t.getJointPose(b,i),y=this._getHandJoint(c,b);null!==v&&(y.matrix.fromArray(v.transform.matrix),y.matrix.decompose(y.position,y.rotation,y.scale),y.matrixWorldNeedsUpdate=!0,y.jointRadius=v.radius),y.visible=null!==v}const p=c.joints["index-finger-tip"].position.distanceTo(c.joints["thumb-tip"].position),m=.02,g=.005;c.inputState.pinching&&p>m+g?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&p<=m-g&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==l&&e.gripSpace&&(s=t.getPose(e.gripSpace,i),null!==s&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));null!==a&&(r=t.getPose(e.targetRaySpace,i),null===r&&null!==s&&(r=s),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(rne)))}return null!==a&&(a.visible=null!==r),null!==l&&(l.visible=null!==s),null!==c&&(c.visible=null!==o),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const i=new $a;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}class sne extends oa{constructor(e,t,i,r,s,o,a,l,c,d){if((d=void 0!==d?d:kd)!==kd&&d!==Up)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&d===kd&&(i=ou),void 0===i&&d===Up&&(i=Fd),super(null,r,s,o,a,l,d,i,c),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==a?a:Ni,this.minFilter=void 0!==l?l:Ni,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}class one extends Vd{constructor(e,t){super();const i=this;let r=null,s=1,o=null,a="local-floor",l=1,c=null,d=null,h=null,p=null,m=null,g=null;const b=t.getContextAttributes();let v=null,y=null;const w=[],E=[],x=new nr;x.layers.enable(1),x.viewport=new Pn;const C=new nr;C.layers.enable(2),C.viewport=new Pn;const A=[x,C],D=new ine;D.layers.enable(1),D.layers.enable(2);let O=null,T=null;function L(q){const oe=E.indexOf(q.inputSource);if(-1===oe)return;const Me=w[oe];void 0!==Me&&(Me.update(q.inputSource,q.frame,c||o),Me.dispatchEvent({type:q.type,data:q.inputSource}))}function X(){r.removeEventListener("select",L),r.removeEventListener("selectstart",L),r.removeEventListener("selectend",L),r.removeEventListener("squeeze",L),r.removeEventListener("squeezestart",L),r.removeEventListener("squeezeend",L),r.removeEventListener("end",X),r.removeEventListener("inputsourceschange",re);for(let q=0;q<w.length;q++){const oe=E[q];null!==oe&&(E[q]=null,w[q].disconnect(oe))}O=null,T=null,e.setRenderTarget(v),m=null,p=null,h=null,r=null,y=null,ce.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}function re(q){for(let oe=0;oe<q.removed.length;oe++){const Me=q.removed[oe],we=E.indexOf(Me);we>=0&&(E[we]=null,w[we].disconnect(Me))}for(let oe=0;oe<q.added.length;oe++){const Me=q.added[oe];let we=E.indexOf(Me);if(-1===we){for(let Qe=0;Qe<w.length;Qe++){if(Qe>=E.length){E.push(Me),we=Qe;break}if(null===E[Qe]){E[Qe]=Me,we=Qe;break}}if(-1===we)break}const ze=w[we];ze&&ze.connect(Me)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(q){let oe=w[q];return void 0===oe&&(oe=new H1,w[q]=oe),oe.getTargetRaySpace()},this.getControllerGrip=function(q){let oe=w[q];return void 0===oe&&(oe=new H1,w[q]=oe),oe.getGripSpace()},this.getHand=function(q){let oe=w[q];return void 0===oe&&(oe=new H1,w[q]=oe),oe.getHandSpace()},this.setFramebufferScaleFactor=function(q){s=q,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(q){a=q,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||o},this.setReferenceSpace=function(q){c=q},this.getBaseLayer=function(){return null!==p?p:m},this.getBinding=function(){return h},this.getFrame=function(){return g},this.getSession=function(){return r},this.setSession=function(){var q=Rn(function*(oe){if(r=oe,null!==r){if(v=e.getRenderTarget(),r.addEventListener("select",L),r.addEventListener("selectstart",L),r.addEventListener("selectend",L),r.addEventListener("squeeze",L),r.addEventListener("squeezestart",L),r.addEventListener("squeezeend",L),r.addEventListener("end",X),r.addEventListener("inputsourceschange",re),!0!==b.xrCompatible&&(yield t.makeXRCompatible()),void 0===r.renderState.layers||!1===e.capabilities.isWebGL2)m=new XRWebGLLayer(r,t,{antialias:void 0!==r.renderState.layers||b.antialias,alpha:!0,depth:b.depth,stencil:b.stencil,framebufferScaleFactor:s}),r.updateRenderState({baseLayer:m}),y=new zd(m.framebufferWidth,m.framebufferHeight,{format:So,type:su,colorSpace:e.outputColorSpace,stencilBuffer:b.stencil});else{let Me=null,we=null,ze=null;b.depth&&(ze=b.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,Me=b.stencil?Up:kd,we=b.stencil?Fd:ou);const Qe={colorFormat:t.RGBA8,depthFormat:ze,scaleFactor:s};h=new XRWebGLBinding(r,t),p=h.createProjectionLayer(Qe),r.updateRenderState({layers:[p]}),y=new zd(p.textureWidth,p.textureHeight,{format:So,type:su,depthTexture:new sne(p.textureWidth,p.textureHeight,we,void 0,void 0,void 0,void 0,void 0,void 0,Me),stencilBuffer:b.stencil,colorSpace:e.outputColorSpace,samples:b.antialias?4:0}),e.properties.get(y).__ignoreDepthValues=p.ignoreDepthValues}y.isXRRenderTarget=!0,this.setFoveation(l),c=null,o=yield r.requestReferenceSpace(a),ce.setContext(r),ce.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}});return function(oe){return q.apply(this,arguments)}}(),this.getEnvironmentBlendMode=function(){if(null!==r)return r.environmentBlendMode};const ae=new N,H=new N;function j(q,oe){null===oe?q.matrixWorld.copy(q.matrix):q.matrixWorld.multiplyMatrices(oe.matrixWorld,q.matrix),q.matrixWorldInverse.copy(q.matrixWorld).invert()}this.updateCamera=function(q){if(null===r)return;D.near=C.near=x.near=q.near,D.far=C.far=x.far=q.far,(O!==D.near||T!==D.far)&&(r.updateRenderState({depthNear:D.near,depthFar:D.far}),O=D.near,T=D.far);const oe=q.parent,Me=D.cameras;j(D,oe);for(let we=0;we<Me.length;we++)j(Me[we],oe);2===Me.length?function J(q,oe,Me){ae.setFromMatrixPosition(oe.matrixWorld),H.setFromMatrixPosition(Me.matrixWorld);const we=ae.distanceTo(H),ze=oe.projectionMatrix.elements,Qe=Me.projectionMatrix.elements,Ge=ze[14]/(ze[10]-1),Ye=ze[14]/(ze[10]+1),_t=(ze[9]+1)/ze[5],qt=(ze[9]-1)/ze[5],rt=(ze[8]-1)/ze[0],z=(Qe[8]+1)/Qe[0],Ne=Ge*rt,ye=Ge*z,Ae=we/(-rt+z),Ee=Ae*-rt;oe.matrixWorld.decompose(q.position,q.quaternion,q.scale),q.translateX(Ee),q.translateZ(Ae),q.matrixWorld.compose(q.position,q.quaternion,q.scale),q.matrixWorldInverse.copy(q.matrixWorld).invert();const ot=Ge+Ae,Ze=Ye+Ae;q.projectionMatrix.makePerspective(Ne-Ee,ye+(we-Ee),_t*Ye/Ze*ot,qt*Ye/Ze*ot,ot,Ze),q.projectionMatrixInverse.copy(q.projectionMatrix).invert()}(D,x,C):D.projectionMatrix.copy(x.projectionMatrix),function $(q,oe,Me){null===Me?q.matrix.copy(oe.matrixWorld):(q.matrix.copy(Me.matrixWorld),q.matrix.invert(),q.matrix.multiply(oe.matrixWorld)),q.matrix.decompose(q.position,q.quaternion,q.scale),q.updateMatrixWorld(!0),q.projectionMatrix.copy(oe.projectionMatrix),q.projectionMatrixInverse.copy(oe.projectionMatrixInverse),q.isPerspectiveCamera&&(q.fov=2*zp*Math.atan(1/q.projectionMatrix.elements[5]),q.zoom=1)}(q,D,oe)},this.getCamera=function(){return D},this.getFoveation=function(){if(null!==p||null!==m)return l},this.setFoveation=function(q){l=q,null!==p&&(p.fixedFoveation=q),null!==m&&void 0!==m.fixedFoveation&&(m.fixedFoveation=q)};let Q=null;const ce=new AB;ce.setAnimationLoop(function K(q,oe){if(d=oe.getViewerPose(c||o),g=oe,null!==d){const Me=d.views;null!==m&&(e.setRenderTargetFramebuffer(y,m.framebuffer),e.setRenderTarget(y));let we=!1;Me.length!==D.cameras.length&&(D.cameras.length=0,we=!0);for(let ze=0;ze<Me.length;ze++){const Qe=Me[ze];let Ge=null;if(null!==m)Ge=m.getViewport(Qe);else{const _t=h.getViewSubImage(p,Qe);Ge=_t.viewport,0===ze&&(e.setRenderTargetTextures(y,_t.colorTexture,p.ignoreDepthValues?void 0:_t.depthStencilTexture),e.setRenderTarget(y))}let Ye=A[ze];void 0===Ye&&(Ye=new nr,Ye.layers.enable(ze),Ye.viewport=new Pn,A[ze]=Ye),Ye.matrix.fromArray(Qe.transform.matrix),Ye.matrix.decompose(Ye.position,Ye.quaternion,Ye.scale),Ye.projectionMatrix.fromArray(Qe.projectionMatrix),Ye.projectionMatrixInverse.copy(Ye.projectionMatrix).invert(),Ye.viewport.set(Ge.x,Ge.y,Ge.width,Ge.height),0===ze&&(D.matrix.copy(Ye.matrix),D.matrix.decompose(D.position,D.quaternion,D.scale)),!0===we&&D.cameras.push(Ye)}}for(let Me=0;Me<w.length;Me++){const we=E[Me],ze=w[Me];null!==we&&void 0!==ze&&ze.update(we,oe,c||o)}Q&&Q(q,oe),oe.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:oe}),g=null}),this.setAnimationLoop=function(q){Q=q},this.dispose=function(){}}}function ane(n,e){function t(v,y){!0===v.matrixAutoUpdate&&v.updateMatrix(),y.value.copy(v.matrix)}function s(v,y){v.opacity.value=y.opacity,y.color&&v.diffuse.value.copy(y.color),y.emissive&&v.emissive.value.copy(y.emissive).multiplyScalar(y.emissiveIntensity),y.map&&(v.map.value=y.map,t(y.map,v.mapTransform)),y.alphaMap&&(v.alphaMap.value=y.alphaMap,t(y.alphaMap,v.alphaMapTransform)),y.bumpMap&&(v.bumpMap.value=y.bumpMap,t(y.bumpMap,v.bumpMapTransform),v.bumpScale.value=y.bumpScale,1===y.side&&(v.bumpScale.value*=-1)),y.normalMap&&(v.normalMap.value=y.normalMap,t(y.normalMap,v.normalMapTransform),v.normalScale.value.copy(y.normalScale),1===y.side&&v.normalScale.value.negate()),y.displacementMap&&(v.displacementMap.value=y.displacementMap,t(y.displacementMap,v.displacementMapTransform),v.displacementScale.value=y.displacementScale,v.displacementBias.value=y.displacementBias),y.emissiveMap&&(v.emissiveMap.value=y.emissiveMap,t(y.emissiveMap,v.emissiveMapTransform)),y.specularMap&&(v.specularMap.value=y.specularMap,t(y.specularMap,v.specularMapTransform)),y.alphaTest>0&&(v.alphaTest.value=y.alphaTest);const w=e.get(y).envMap;if(w&&(v.envMap.value=w,v.flipEnvMap.value=w.isCubeTexture&&!1===w.isRenderTargetTexture?-1:1,v.reflectivity.value=y.reflectivity,v.ior.value=y.ior,v.refractionRatio.value=y.refractionRatio),y.lightMap){v.lightMap.value=y.lightMap;const E=!0===n._useLegacyLights?Math.PI:1;v.lightMapIntensity.value=y.lightMapIntensity*E,t(y.lightMap,v.lightMapTransform)}y.aoMap&&(v.aoMap.value=y.aoMap,v.aoMapIntensity.value=y.aoMapIntensity,t(y.aoMap,v.aoMapTransform))}return{refreshFogUniforms:function i(v,y){y.color.getRGB(v.fogColor.value,TB(n)),y.isFog?(v.fogNear.value=y.near,v.fogFar.value=y.far):y.isFogExp2&&(v.fogDensity.value=y.density)},refreshMaterialUniforms:function r(v,y,w,E,x){y.isMeshBasicMaterial||y.isMeshLambertMaterial?s(v,y):y.isMeshToonMaterial?(s(v,y),function h(v,y){y.gradientMap&&(v.gradientMap.value=y.gradientMap)}(v,y)):y.isMeshPhongMaterial?(s(v,y),function d(v,y){v.specular.value.copy(y.specular),v.shininess.value=Math.max(y.shininess,1e-4)}(v,y)):y.isMeshStandardMaterial?(s(v,y),function p(v,y){v.metalness.value=y.metalness,y.metalnessMap&&(v.metalnessMap.value=y.metalnessMap,t(y.metalnessMap,v.metalnessMapTransform)),v.roughness.value=y.roughness,y.roughnessMap&&(v.roughnessMap.value=y.roughnessMap,t(y.roughnessMap,v.roughnessMapTransform)),e.get(y).envMap&&(v.envMapIntensity.value=y.envMapIntensity)}(v,y),y.isMeshPhysicalMaterial&&function m(v,y,w){v.ior.value=y.ior,y.sheen>0&&(v.sheenColor.value.copy(y.sheenColor).multiplyScalar(y.sheen),v.sheenRoughness.value=y.sheenRoughness,y.sheenColorMap&&(v.sheenColorMap.value=y.sheenColorMap,t(y.sheenColorMap,v.sheenColorMapTransform)),y.sheenRoughnessMap&&(v.sheenRoughnessMap.value=y.sheenRoughnessMap,t(y.sheenRoughnessMap,v.sheenRoughnessMapTransform))),y.clearcoat>0&&(v.clearcoat.value=y.clearcoat,v.clearcoatRoughness.value=y.clearcoatRoughness,y.clearcoatMap&&(v.clearcoatMap.value=y.clearcoatMap,t(y.clearcoatMap,v.clearcoatMapTransform)),y.clearcoatRoughnessMap&&(v.clearcoatRoughnessMap.value=y.clearcoatRoughnessMap,t(y.clearcoatRoughnessMap,v.clearcoatRoughnessMapTransform)),y.clearcoatNormalMap&&(v.clearcoatNormalMap.value=y.clearcoatNormalMap,t(y.clearcoatNormalMap,v.clearcoatNormalMapTransform),v.clearcoatNormalScale.value.copy(y.clearcoatNormalScale),1===y.side&&v.clearcoatNormalScale.value.negate())),y.iridescence>0&&(v.iridescence.value=y.iridescence,v.iridescenceIOR.value=y.iridescenceIOR,v.iridescenceThicknessMinimum.value=y.iridescenceThicknessRange[0],v.iridescenceThicknessMaximum.value=y.iridescenceThicknessRange[1],y.iridescenceMap&&(v.iridescenceMap.value=y.iridescenceMap,t(y.iridescenceMap,v.iridescenceMapTransform)),y.iridescenceThicknessMap&&(v.iridescenceThicknessMap.value=y.iridescenceThicknessMap,t(y.iridescenceThicknessMap,v.iridescenceThicknessMapTransform))),y.transmission>0&&(v.transmission.value=y.transmission,v.transmissionSamplerMap.value=w.texture,v.transmissionSamplerSize.value.set(w.width,w.height),y.transmissionMap&&(v.transmissionMap.value=y.transmissionMap,t(y.transmissionMap,v.transmissionMapTransform)),v.thickness.value=y.thickness,y.thicknessMap&&(v.thicknessMap.value=y.thicknessMap,t(y.thicknessMap,v.thicknessMapTransform)),v.attenuationDistance.value=y.attenuationDistance,v.attenuationColor.value.copy(y.attenuationColor)),y.anisotropy>0&&(v.anisotropyVector.value.set(y.anisotropy*Math.cos(y.anisotropyRotation),y.anisotropy*Math.sin(y.anisotropyRotation)),y.anisotropyMap&&(v.anisotropyMap.value=y.anisotropyMap,t(y.anisotropyMap,v.anisotropyMapTransform))),v.specularIntensity.value=y.specularIntensity,v.specularColor.value.copy(y.specularColor),y.specularColorMap&&(v.specularColorMap.value=y.specularColorMap,t(y.specularColorMap,v.specularColorMapTransform)),y.specularIntensityMap&&(v.specularIntensityMap.value=y.specularIntensityMap,t(y.specularIntensityMap,v.specularIntensityMapTransform))}(v,y,x)):y.isMeshMatcapMaterial?(s(v,y),function g(v,y){y.matcap&&(v.matcap.value=y.matcap)}(v,y)):y.isMeshDepthMaterial?s(v,y):y.isMeshDistanceMaterial?(s(v,y),function b(v,y){const w=e.get(y).light;v.referencePosition.value.setFromMatrixPosition(w.matrixWorld),v.nearDistance.value=w.shadow.camera.near,v.farDistance.value=w.shadow.camera.far}(v,y)):y.isMeshNormalMaterial?s(v,y):y.isLineBasicMaterial?(function o(v,y){v.diffuse.value.copy(y.color),v.opacity.value=y.opacity,y.map&&(v.map.value=y.map,t(y.map,v.mapTransform))}(v,y),y.isLineDashedMaterial&&function a(v,y){v.dashSize.value=y.dashSize,v.totalSize.value=y.dashSize+y.gapSize,v.scale.value=y.scale}(v,y)):y.isPointsMaterial?function l(v,y,w,E){v.diffuse.value.copy(y.color),v.opacity.value=y.opacity,v.size.value=y.size*w,v.scale.value=.5*E,y.map&&(v.map.value=y.map,t(y.map,v.uvTransform)),y.alphaMap&&(v.alphaMap.value=y.alphaMap,t(y.alphaMap,v.alphaMapTransform)),y.alphaTest>0&&(v.alphaTest.value=y.alphaTest)}(v,y,w,E):y.isSpriteMaterial?function c(v,y){v.diffuse.value.copy(y.color),v.opacity.value=y.opacity,v.rotation.value=y.rotation,y.map&&(v.map.value=y.map,t(y.map,v.mapTransform)),y.alphaMap&&(v.alphaMap.value=y.alphaMap,t(y.alphaMap,v.alphaMapTransform)),y.alphaTest>0&&(v.alphaTest.value=y.alphaTest)}(v,y):y.isShadowMaterial?(v.color.value.copy(y.color),v.opacity.value=y.opacity):y.isShaderMaterial&&(y.uniformsNeedUpdate=!1)}}}function lne(n,e,t,i){let r={},s={},o=[];const a=t.isWebGL2?n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS):0;function m(w,E,x){const C=w.value;if(void 0===x[E]){if("number"==typeof C)x[E]=C;else{const A=Array.isArray(C)?C:[C],D=[];for(let O=0;O<A.length;O++)D.push(A[O].clone());x[E]=D}return!0}if("number"==typeof C){if(x[E]!==C)return x[E]=C,!0}else{const A=Array.isArray(x[E])?x[E]:[x[E]],D=Array.isArray(C)?C:[C];for(let O=0;O<A.length;O++){const T=A[O];if(!1===T.equals(D[O]))return T.copy(D[O]),!0}}return!1}function b(w){const E={boundary:0,storage:0};return"number"==typeof w?(E.boundary=4,E.storage=4):w.isVector2?(E.boundary=8,E.storage=8):w.isVector3||w.isColor?(E.boundary=16,E.storage=12):w.isVector4?(E.boundary=16,E.storage=16):w.isMatrix3?(E.boundary=48,E.storage=48):w.isMatrix4?(E.boundary=64,E.storage=64):w.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",w),E}function v(w){const E=w.target;E.removeEventListener("dispose",v);const x=o.indexOf(E.__bindingPointIndex);o.splice(x,1),n.deleteBuffer(r[E.id]),delete r[E.id],delete s[E.id]}return{bind:function l(w,E){i.uniformBlockBinding(w,E.program)},update:function c(w,E){let x=r[w.id];void 0===x&&(function g(w){const E=w.uniforms;let x=0;let A=0;for(let D=0,O=E.length;D<O;D++){const T=E[D],L={boundary:0,storage:0},X=Array.isArray(T.value)?T.value:[T.value];for(let re=0,ae=X.length;re<ae;re++){const J=b(X[re]);L.boundary+=J.boundary,L.storage+=J.storage}T.__data=new Float32Array(L.storage/Float32Array.BYTES_PER_ELEMENT),T.__offset=x,D>0&&(A=x%16,0!==A&&16-A-L.boundary<0&&(x+=16-A,T.__offset=x)),x+=L.storage}A=x%16,A>0&&(x+=16-A),w.__size=x,w.__cache={}}(w),x=function d(w){const E=function h(){for(let w=0;w<a;w++)if(-1===o.indexOf(w))return o.push(w),w;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();w.__bindingPointIndex=E;const x=n.createBuffer(),C=w.__size,A=w.usage;return n.bindBuffer(n.UNIFORM_BUFFER,x),n.bufferData(n.UNIFORM_BUFFER,C,A),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,E,x),x}(w),r[w.id]=x,w.addEventListener("dispose",v)),i.updateUBOMapping(w,E.program);const A=e.render.frame;s[w.id]!==A&&(function p(w){const x=w.uniforms,C=w.__cache;n.bindBuffer(n.UNIFORM_BUFFER,r[w.id]);for(let A=0,D=x.length;A<D;A++){const O=x[A];if(!0===m(O,A,C)){const T=O.__offset,L=Array.isArray(O.value)?O.value:[O.value];let X=0;for(let re=0;re<L.length;re++){const ae=L[re],H=b(ae);"number"==typeof ae?(O.__data[0]=ae,n.bufferSubData(n.UNIFORM_BUFFER,T+X,O.__data)):ae.isMatrix3?(O.__data[0]=ae.elements[0],O.__data[1]=ae.elements[1],O.__data[2]=ae.elements[2],O.__data[3]=ae.elements[0],O.__data[4]=ae.elements[3],O.__data[5]=ae.elements[4],O.__data[6]=ae.elements[5],O.__data[7]=ae.elements[0],O.__data[8]=ae.elements[6],O.__data[9]=ae.elements[7],O.__data[10]=ae.elements[8],O.__data[11]=ae.elements[0]):(ae.toArray(O.__data,X),X+=H.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,T,O.__data)}}n.bindBuffer(n.UNIFORM_BUFFER,null)}(w),s[w.id]=A)},dispose:function y(){for(const w in r)n.deleteBuffer(r[w]);o=[],r={},s={}}}}class z1{constructor(e={}){const{canvas:t=GK(),context:i=null,depth:r=!0,stencil:s=!0,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:c=!1,powerPreference:d="default",failIfMajorPerformanceCaveat:h=!1}=e;let p;this.isWebGLRenderer=!0,p=null!==i?i.getContextAttributes().alpha:o;const m=new Uint32Array(4),g=new Int32Array(4);let b=null,v=null;const y=[],w=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=ui,this._useLegacyLights=!1,this.toneMapping=iu,this.toneMappingExposure=1;const E=this;let x=!1,C=0,A=0,D=null,O=-1,T=null;const L=new Pn,X=new Pn;let re=null;const ae=new je(0);let H=0,J=t.width,j=t.height,$=1,Q=null,K=null;const ce=new Pn(0,0,J,j),q=new Pn(0,0,J,j);let oe=!1;const Me=new L1;let we=!1,ze=!1,Qe=null;const Ge=new bt,Ye=new fe,_t=new N,qt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function rt(){return null===D?$:1}let ye,Ae,Ee,ot,Ze,Je,wt,en,ai,k,R,ne,Te,xe,De,it,Ie,$e,G,Re,ve,St,at,ht,z=i;function Ne(F,ee){for(let de=0;de<F.length;de++){const he=t.getContext(F[de],ee);if(null!==he)return he}return null}try{const F={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:d,failIfMajorPerformanceCaveat:h};if("setAttribute"in t&&t.setAttribute("data-engine","three.js r157"),t.addEventListener("webglcontextlost",Oe,!1),t.addEventListener("webglcontextrestored",Pe,!1),t.addEventListener("webglcontextcreationerror",We,!1),null===z){const ee=["webgl2","webgl","experimental-webgl"];if(!0===E.isWebGL1Renderer&&ee.shift(),z=Ne(ee,F),null===z)throw Ne(ee)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&z instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),void 0===z.getShaderPrecisionFormat&&(z.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(F){throw console.error("THREE.WebGLRenderer: "+F.message),F}function st(){ye=new wee(z),Ae=new mee(z,ye,e),ye.init(Ae),St=new nne(z,ye,Ae),Ee=new ene(z,ye,Ae),ot=new xee(z),Ze=new zte,Je=new tne(z,ye,Ee,Ze,Ae,St,ot),wt=new _ee(E),en=new bee(E),ai=new pJ(z,Ae),at=new fee(z,ye,ai,Ae),k=new Eee(z,ai,ot,at),R=new Aee(z,k,ai,ot),G=new Tee(z,Ae,Je),it=new gee(Ze),ne=new Hte(E,wt,en,ye,Ae,at,it),Te=new ane(E,Ze),xe=new Wte,De=new Zte(ye,Ae),$e=new hee(E,wt,en,Ee,R,p,l),Ie=new Qte(E,R,Ae),ht=new lne(z,ot,Ae,Ee),Re=new pee(z,ye,ot,Ae),ve=new See(z,ye,ot,Ae),ot.programs=ne.programs,E.capabilities=Ae,E.extensions=ye,E.properties=Ze,E.renderLists=xe,E.shadowMap=Ie,E.state=Ee,E.info=ot}st();const V=new one(E,z);function Oe(F){F.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),x=!0}function Pe(){console.log("THREE.WebGLRenderer: Context Restored."),x=!1;const F=ot.autoReset,ee=Ie.enabled,de=Ie.autoUpdate,te=Ie.needsUpdate,he=Ie.type;st(),ot.autoReset=F,Ie.enabled=ee,Ie.autoUpdate=de,Ie.needsUpdate=te,Ie.type=he}function We(F){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",F.statusMessage)}function Fe(F){const ee=F.target;ee.removeEventListener("dispose",Fe),function Se(F){(function nt(F){const ee=Ze.get(F).programs;void 0!==ee&&(ee.forEach(function(de){ne.releaseProgram(de)}),F.isShaderMaterial&&ne.releaseShaderCache(F))})(F),Ze.remove(F)}(ee)}this.xr=V,this.getContext=function(){return z},this.getContextAttributes=function(){return z.getContextAttributes()},this.forceContextLoss=function(){const F=ye.get("WEBGL_lose_context");F&&F.loseContext()},this.forceContextRestore=function(){const F=ye.get("WEBGL_lose_context");F&&F.restoreContext()},this.getPixelRatio=function(){return $},this.setPixelRatio=function(F){void 0!==F&&($=F,this.setSize(J,j,!1))},this.getSize=function(F){return F.set(J,j)},this.setSize=function(F,ee,de=!0){V.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(J=F,j=ee,t.width=Math.floor(F*$),t.height=Math.floor(ee*$),!0===de&&(t.style.width=F+"px",t.style.height=ee+"px"),this.setViewport(0,0,F,ee))},this.getDrawingBufferSize=function(F){return F.set(J*$,j*$).floor()},this.setDrawingBufferSize=function(F,ee,de){J=F,j=ee,$=de,t.width=Math.floor(F*de),t.height=Math.floor(ee*de),this.setViewport(0,0,F,ee)},this.getCurrentViewport=function(F){return F.copy(L)},this.getViewport=function(F){return F.copy(ce)},this.setViewport=function(F,ee,de,te){F.isVector4?ce.set(F.x,F.y,F.z,F.w):ce.set(F,ee,de,te),Ee.viewport(L.copy(ce).multiplyScalar($).floor())},this.getScissor=function(F){return F.copy(q)},this.setScissor=function(F,ee,de,te){F.isVector4?q.set(F.x,F.y,F.z,F.w):q.set(F,ee,de,te),Ee.scissor(X.copy(q).multiplyScalar($).floor())},this.getScissorTest=function(){return oe},this.setScissorTest=function(F){Ee.setScissorTest(oe=F)},this.setOpaqueSort=function(F){Q=F},this.setTransparentSort=function(F){K=F},this.getClearColor=function(F){return F.copy($e.getClearColor())},this.setClearColor=function(){$e.setClearColor.apply($e,arguments)},this.getClearAlpha=function(){return $e.getClearAlpha()},this.setClearAlpha=function(){$e.setClearAlpha.apply($e,arguments)},this.clear=function(F=!0,ee=!0,de=!0){let te=0;if(F){let he=!1;if(null!==D){const et=D.texture.format;he=1033===et||1031===et||1029===et}if(he){const et=D.texture.type,yt=et===su||et===ou||1012===et||et===Fd||1017===et||1018===et,Lt=$e.getClearColor(),Ot=$e.getClearAlpha(),tn=Lt.r,Dt=Lt.g,Xt=Lt.b;yt?(m[0]=tn,m[1]=Dt,m[2]=Xt,m[3]=Ot,z.clearBufferuiv(z.COLOR,0,m)):(g[0]=tn,g[1]=Dt,g[2]=Xt,g[3]=Ot,z.clearBufferiv(z.COLOR,0,g))}else te|=z.COLOR_BUFFER_BIT}ee&&(te|=z.DEPTH_BUFFER_BIT),de&&(te|=z.STENCIL_BUFFER_BIT),z.clear(te)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Oe,!1),t.removeEventListener("webglcontextrestored",Pe,!1),t.removeEventListener("webglcontextcreationerror",We,!1),xe.dispose(),De.dispose(),Ze.dispose(),wt.dispose(),en.dispose(),R.dispose(),at.dispose(),ht.dispose(),ne.dispose(),V.dispose(),V.removeEventListener("sessionstart",ii),V.removeEventListener("sessionend",Ja),Qe&&(Qe.dispose(),Qe=null),gs.stop()},this.renderBufferDirect=function(F,ee,de,te,he,et){null===ee&&(ee=qt);const yt=he.isMesh&&he.matrixWorld.determinant()<0,Lt=function vae(F,ee,de,te,he){!0!==ee.isScene&&(ee=qt),Je.resetTextureUnits();const et=ee.fog,Lt=null===D?E.outputColorSpace:!0===D.isXRRenderTarget?D.texture.colorSpace:Cr,Ot=(te.isMeshStandardMaterial?en:wt).get(te.envMap||(te.isMeshStandardMaterial?ee.environment:null)),tn=!0===te.vertexColors&&!!de.attributes.color&&4===de.attributes.color.itemSize,Dt=!!de.attributes.tangent&&(!!te.normalMap||te.anisotropy>0),Xt=!!de.morphAttributes.position,xi=!!de.morphAttributes.normal,Oi=!!de.morphAttributes.color;let Do=iu;te.toneMapped&&(null===D||!0===D.isXRRenderTarget)&&(Do=E.toneMapping);const Ql=de.morphAttributes.position||de.morphAttributes.normal||de.morphAttributes.color,Xi=void 0!==Ql?Ql.length:0,rn=Ze.get(te),iR=v.state.lights;!0!==we||!0!==ze&&F===T||it.setState(te,F,F===T&&te.id===O);let Yi=!1;te.version===rn.__version?(rn.needsLights&&rn.lightsStateVersion!==iR.state.version||rn.outputColorSpace!==Lt||he.isInstancedMesh&&!1===rn.instancing||!he.isInstancedMesh&&!0===rn.instancing||he.isSkinnedMesh&&!1===rn.skinning||!he.isSkinnedMesh&&!0===rn.skinning||he.isInstancedMesh&&!0===rn.instancingColor&&null===he.instanceColor||he.isInstancedMesh&&!1===rn.instancingColor&&null!==he.instanceColor||rn.envMap!==Ot||!0===te.fog&&rn.fog!==et||void 0!==rn.numClippingPlanes&&(rn.numClippingPlanes!==it.numPlanes||rn.numIntersection!==it.numIntersection)||rn.vertexAlphas!==tn||rn.vertexTangents!==Dt||rn.morphTargets!==Xt||rn.morphNormals!==xi||rn.morphColors!==Oi||rn.toneMapping!==Do||!0===Ae.isWebGL2&&rn.morphTargetsCount!==Xi)&&(Yi=!0):(Yi=!0,rn.__version=te.version);let dh=rn.currentProgram;!0===Yi&&(dh=ux(te,ee,he));let Cz=!1,Dv=!1,rR=!1;const _s=dh.getUniforms(),hh=rn.uniforms;if(Ee.useProgram(dh.program)&&(Cz=!0,Dv=!0,rR=!0),te.id!==O&&(O=te.id,Dv=!0),Cz||T!==F){_s.setValue(z,"projectionMatrix",F.projectionMatrix),_s.setValue(z,"viewMatrix",F.matrixWorldInverse);const no=_s.map.cameraPosition;void 0!==no&&no.setValue(z,_t.setFromMatrixPosition(F.matrixWorld)),Ae.logarithmicDepthBuffer&&_s.setValue(z,"logDepthBufFC",2/(Math.log(F.far+1)/Math.LN2)),(te.isMeshPhongMaterial||te.isMeshToonMaterial||te.isMeshLambertMaterial||te.isMeshBasicMaterial||te.isMeshStandardMaterial||te.isShaderMaterial)&&_s.setValue(z,"isOrthographic",!0===F.isOrthographicCamera),T!==F&&(T=F,Dv=!0,rR=!0)}if(he.isSkinnedMesh){_s.setOptional(z,he,"bindMatrix"),_s.setOptional(z,he,"bindMatrixInverse");const no=he.skeleton;no&&(Ae.floatVertexTextures?(null===no.boneTexture&&no.computeBoneTexture(),_s.setValue(z,"boneTexture",no.boneTexture,Je),_s.setValue(z,"boneTextureSize",no.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const sR=de.morphAttributes;if((void 0!==sR.position||void 0!==sR.normal||void 0!==sR.color&&!0===Ae.isWebGL2)&&G.update(he,de,dh),(Dv||rn.receiveShadow!==he.receiveShadow)&&(rn.receiveShadow=he.receiveShadow,_s.setValue(z,"receiveShadow",he.receiveShadow)),te.isMeshGouraudMaterial&&null!==te.envMap&&(hh.envMap.value=Ot,hh.flipEnvMap.value=Ot.isCubeTexture&&!1===Ot.isRenderTargetTexture?-1:1),Dv&&(_s.setValue(z,"toneMappingExposure",E.toneMappingExposure),rn.needsLights&&function bae(F,ee){F.ambientLightColor.needsUpdate=ee,F.lightProbe.needsUpdate=ee,F.directionalLights.needsUpdate=ee,F.directionalLightShadows.needsUpdate=ee,F.pointLights.needsUpdate=ee,F.pointLightShadows.needsUpdate=ee,F.spotLights.needsUpdate=ee,F.spotLightShadows.needsUpdate=ee,F.rectAreaLights.needsUpdate=ee,F.hemisphereLights.needsUpdate=ee}(hh,rR),et&&!0===te.fog&&Te.refreshFogUniforms(hh,et),Te.refreshMaterialUniforms(hh,te,$,j,Qe),_S.upload(z,rn.uniformsList,hh,Je)),te.isShaderMaterial&&!0===te.uniformsNeedUpdate&&(_S.upload(z,rn.uniformsList,hh,Je),te.uniformsNeedUpdate=!1),te.isSpriteMaterial&&_s.setValue(z,"center",he.center),_s.setValue(z,"modelViewMatrix",he.modelViewMatrix),_s.setValue(z,"normalMatrix",he.normalMatrix),_s.setValue(z,"modelMatrix",he.matrixWorld),te.isShaderMaterial||te.isRawShaderMaterial){const no=te.uniformsGroups;for(let oR=0,Eae=no.length;oR<Eae;oR++)if(Ae.isWebGL2){const Tz=no[oR];ht.update(Tz,dh),ht.bind(Tz,dh)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return dh}(F,ee,de,te,he);Ee.setMaterial(te,yt);let Ot=de.index,tn=1;if(!0===te.wireframe){if(Ot=k.getWireframeAttribute(de),void 0===Ot)return;tn=2}const Dt=de.drawRange,Xt=de.attributes.position;let xi=Dt.start*tn,Oi=(Dt.start+Dt.count)*tn;null!==et&&(xi=Math.max(xi,et.start*tn),Oi=Math.min(Oi,(et.start+et.count)*tn)),null!==Ot?(xi=Math.max(xi,0),Oi=Math.min(Oi,Ot.count)):null!=Xt&&(xi=Math.max(xi,0),Oi=Math.min(Oi,Xt.count));const Do=Oi-xi;if(Do<0||Do===1/0)return;at.setup(he,te,Lt,de,Ot);let Ql,Xi=Re;if(null!==Ot&&(Ql=ai.get(Ot),Xi=ve,Xi.setIndex(Ql)),he.isMesh)!0===te.wireframe?(Ee.setLineWidth(te.wireframeLinewidth*rt()),Xi.setMode(z.LINES)):Xi.setMode(z.TRIANGLES);else if(he.isLine){let rn=te.linewidth;void 0===rn&&(rn=1),Ee.setLineWidth(rn*rt()),Xi.setMode(he.isLineSegments?z.LINES:he.isLineLoop?z.LINE_LOOP:z.LINE_STRIP)}else he.isPoints?Xi.setMode(z.POINTS):he.isSprite&&Xi.setMode(z.TRIANGLES);if(he.isInstancedMesh)Xi.renderInstances(xi,Do,he.count);else if(de.isInstancedBufferGeometry){const iR=Math.min(de.instanceCount,void 0!==de._maxInstanceCount?de._maxInstanceCount:1/0);Xi.renderInstances(xi,Do,iR)}else Xi.render(xi,Do)},this.compile=function(F,ee){function de(te,he,et){!0===te.transparent&&2===te.side&&!1===te.forceSinglePass?(te.side=1,te.needsUpdate=!0,ux(te,he,et),te.side=0,te.needsUpdate=!0,ux(te,he,et),te.side=2):ux(te,he,et)}v=De.get(F),v.init(),w.push(v),F.traverseVisible(function(te){te.isLight&&te.layers.test(ee.layers)&&(v.pushLight(te),te.castShadow&&v.pushShadow(te))}),v.setupLights(E._useLegacyLights),F.traverse(function(te){const he=te.material;if(he)if(Array.isArray(he))for(let et=0;et<he.length;et++)de(he[et],F,te);else de(he,F,te)}),w.pop(),v=null};let Mt=null;function ii(){gs.stop()}function Ja(){gs.start()}const gs=new AB;function Ez(F,ee,de,te){if(!1===F.visible)return;if(F.layers.test(ee.layers))if(F.isGroup)de=F.renderOrder;else if(F.isLOD)!0===F.autoUpdate&&F.update(ee);else if(F.isLight)v.pushLight(F),F.castShadow&&v.pushShadow(F);else if(F.isSprite){if(!F.frustumCulled||Me.intersectsSprite(F)){te&&_t.setFromMatrixPosition(F.matrixWorld).applyMatrix4(Ge);const yt=R.update(F),Lt=F.material;Lt.visible&&b.push(F,yt,Lt,de,_t.z,null)}}else if((F.isMesh||F.isLine||F.isPoints)&&(!F.frustumCulled||Me.intersectsObject(F))){const yt=R.update(F),Lt=F.material;if(te&&(void 0!==F.boundingSphere?(null===F.boundingSphere&&F.computeBoundingSphere(),_t.copy(F.boundingSphere.center)):(null===yt.boundingSphere&&yt.computeBoundingSphere(),_t.copy(yt.boundingSphere.center)),_t.applyMatrix4(F.matrixWorld).applyMatrix4(Ge)),Array.isArray(Lt)){const Ot=yt.groups;for(let tn=0,Dt=Ot.length;tn<Dt;tn++){const Xt=Ot[tn],xi=Lt[Xt.materialIndex];xi&&xi.visible&&b.push(F,yt,xi,de,_t.z,Xt)}}else Lt.visible&&b.push(F,yt,Lt,de,_t.z,null)}const et=F.children;for(let yt=0,Lt=et.length;yt<Lt;yt++)Ez(et[yt],ee,de,te)}function Sz(F,ee,de,te){const he=F.opaque,et=F.transmissive,yt=F.transparent;v.setupLightsView(de),!0===we&&it.setGlobalState(E.clippingPlanes,de),et.length>0&&function yae(F,ee,de,te){const he=Ae.isWebGL2;null===Qe&&(Qe=new zd(1,1,{generateMipmaps:!0,type:ye.has("EXT_color_buffer_half_float")?By:su,minFilter:Vl,samples:he?4:0})),E.getDrawingBufferSize(Ye),he?Qe.setSize(Ye.x,Ye.y):Qe.setSize($E(Ye.x),$E(Ye.y));const et=E.getRenderTarget();E.setRenderTarget(Qe),E.getClearColor(ae),H=E.getClearAlpha(),H<1&&E.setClearColor(16777215,.5),E.clear();const yt=E.toneMapping;E.toneMapping=iu,cx(F,de,te),Je.updateMultisampleRenderTarget(Qe),Je.updateRenderTargetMipmap(Qe);let Lt=!1;for(let Ot=0,tn=ee.length;Ot<tn;Ot++){const Dt=ee[Ot],Xt=Dt.object,xi=Dt.geometry,Oi=Dt.material,Do=Dt.group;if(2===Oi.side&&Xt.layers.test(te.layers)){const Ql=Oi.side;Oi.side=1,Oi.needsUpdate=!0,xz(Xt,de,te,xi,Oi,Do),Oi.side=Ql,Oi.needsUpdate=!0,Lt=!0}}!0===Lt&&(Je.updateMultisampleRenderTarget(Qe),Je.updateRenderTargetMipmap(Qe)),E.setRenderTarget(et),E.setClearColor(ae,H),E.toneMapping=yt}(he,et,ee,de),te&&Ee.viewport(L.copy(te)),he.length>0&&cx(he,ee,de),et.length>0&&cx(et,ee,de),yt.length>0&&cx(yt,ee,de),Ee.buffers.depth.setTest(!0),Ee.buffers.depth.setMask(!0),Ee.buffers.color.setMask(!0),Ee.setPolygonOffset(!1)}function cx(F,ee,de){const te=!0===ee.isScene?ee.overrideMaterial:null;for(let he=0,et=F.length;he<et;he++){const yt=F[he],Lt=yt.object,Ot=yt.geometry,tn=null===te?yt.material:te,Dt=yt.group;Lt.layers.test(de.layers)&&xz(Lt,ee,de,Ot,tn,Dt)}}function xz(F,ee,de,te,he,et){F.onBeforeRender(E,ee,de,te,he,et),F.modelViewMatrix.multiplyMatrices(de.matrixWorldInverse,F.matrixWorld),F.normalMatrix.getNormalMatrix(F.modelViewMatrix),he.onBeforeRender(E,ee,de,te,F,et),!0===he.transparent&&2===he.side&&!1===he.forceSinglePass?(he.side=1,he.needsUpdate=!0,E.renderBufferDirect(de,ee,te,he,F,et),he.side=0,he.needsUpdate=!0,E.renderBufferDirect(de,ee,te,he,F,et),he.side=2):E.renderBufferDirect(de,ee,te,he,F,et),F.onAfterRender(E,ee,de,te,he,et)}function ux(F,ee,de){!0!==ee.isScene&&(ee=qt);const te=Ze.get(F),he=v.state.lights,yt=he.state.version,Lt=ne.getParameters(F,he.state,v.state.shadowsArray,ee,de),Ot=ne.getProgramCacheKey(Lt);let tn=te.programs;te.environment=F.isMeshStandardMaterial?ee.environment:null,te.fog=ee.fog,te.envMap=(F.isMeshStandardMaterial?en:wt).get(F.envMap||te.environment),void 0===tn&&(F.addEventListener("dispose",Fe),tn=new Map,te.programs=tn);let Dt=tn.get(Ot);if(void 0!==Dt){if(te.currentProgram===Dt&&te.lightsStateVersion===yt)return Mz(F,Lt),Dt}else Lt.uniforms=ne.getUniforms(F),F.onBuild(de,Lt,E),F.onBeforeCompile(Lt,E),Dt=ne.acquireProgram(Lt,Ot),tn.set(Ot,Dt),te.uniforms=Lt.uniforms;const Xt=te.uniforms;(!F.isShaderMaterial&&!F.isRawShaderMaterial||!0===F.clipping)&&(Xt.clippingPlanes=it.uniform),Mz(F,Lt),te.needsLights=function wae(F){return F.isMeshLambertMaterial||F.isMeshToonMaterial||F.isMeshPhongMaterial||F.isMeshStandardMaterial||F.isShadowMaterial||F.isShaderMaterial&&!0===F.lights}(F),te.lightsStateVersion=yt,te.needsLights&&(Xt.ambientLightColor.value=he.state.ambient,Xt.lightProbe.value=he.state.probe,Xt.directionalLights.value=he.state.directional,Xt.directionalLightShadows.value=he.state.directionalShadow,Xt.spotLights.value=he.state.spot,Xt.spotLightShadows.value=he.state.spotShadow,Xt.rectAreaLights.value=he.state.rectArea,Xt.ltc_1.value=he.state.rectAreaLTC1,Xt.ltc_2.value=he.state.rectAreaLTC2,Xt.pointLights.value=he.state.point,Xt.pointLightShadows.value=he.state.pointShadow,Xt.hemisphereLights.value=he.state.hemi,Xt.directionalShadowMap.value=he.state.directionalShadowMap,Xt.directionalShadowMatrix.value=he.state.directionalShadowMatrix,Xt.spotShadowMap.value=he.state.spotShadowMap,Xt.spotLightMatrix.value=he.state.spotLightMatrix,Xt.spotLightMap.value=he.state.spotLightMap,Xt.pointShadowMap.value=he.state.pointShadowMap,Xt.pointShadowMatrix.value=he.state.pointShadowMatrix);const xi=Dt.getUniforms(),Oi=_S.seqWithValue(xi.seq,Xt);return te.currentProgram=Dt,te.uniformsList=Oi,Dt}function Mz(F,ee){const de=Ze.get(F);de.outputColorSpace=ee.outputColorSpace,de.instancing=ee.instancing,de.instancingColor=ee.instancingColor,de.skinning=ee.skinning,de.morphTargets=ee.morphTargets,de.morphNormals=ee.morphNormals,de.morphColors=ee.morphColors,de.morphTargetsCount=ee.morphTargetsCount,de.numClippingPlanes=ee.numClippingPlanes,de.numIntersection=ee.numClipIntersection,de.vertexAlphas=ee.vertexAlphas,de.vertexTangents=ee.vertexTangents,de.toneMapping=ee.toneMapping}gs.setAnimationLoop(function qi(F){Mt&&Mt(F)}),typeof self<"u"&&gs.setContext(self),this.setAnimationLoop=function(F){Mt=F,V.setAnimationLoop(F),null===F?gs.stop():gs.start()},V.addEventListener("sessionstart",ii),V.addEventListener("sessionend",Ja),this.render=function(F,ee){if(void 0===ee||!0===ee.isCamera){if(!0!==x){if(!0===F.matrixWorldAutoUpdate&&F.updateMatrixWorld(),null===ee.parent&&!0===ee.matrixWorldAutoUpdate&&ee.updateMatrixWorld(),!0===V.enabled&&!0===V.isPresenting&&(!0===V.cameraAutoUpdate&&V.updateCamera(ee),ee=V.getCamera()),!0===F.isScene&&F.onBeforeRender(E,F,ee,D),v=De.get(F,w.length),v.init(),w.push(v),Ge.multiplyMatrices(ee.projectionMatrix,ee.matrixWorldInverse),Me.setFromProjectionMatrix(Ge),ze=this.localClippingEnabled,we=it.init(this.clippingPlanes,ze),b=xe.get(F,y.length),b.init(),y.push(b),Ez(F,ee,0,E.sortObjects),b.finish(),!0===E.sortObjects&&b.sort(Q,K),this.info.render.frame++,!0===we&&it.beginShadows(),Ie.render(v.state.shadowsArray,F,ee),!0===we&&it.endShadows(),!0===this.info.autoReset&&this.info.reset(),$e.render(b,F),v.setupLights(E._useLegacyLights),ee.isArrayCamera){const te=ee.cameras;for(let he=0,et=te.length;he<et;he++){const yt=te[he];Sz(b,F,yt,yt.viewport)}}else Sz(b,F,ee);null!==D&&(Je.updateMultisampleRenderTarget(D),Je.updateRenderTargetMipmap(D)),!0===F.isScene&&F.onAfterRender(E,F,ee),at.resetDefaultState(),O=-1,T=null,w.pop(),v=w.length>0?w[w.length-1]:null,y.pop(),b=y.length>0?y[y.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return C},this.getActiveMipmapLevel=function(){return A},this.getRenderTarget=function(){return D},this.setRenderTargetTextures=function(F,ee,de){Ze.get(F.texture).__webglTexture=ee,Ze.get(F.depthTexture).__webglTexture=de;const te=Ze.get(F);te.__hasExternalTextures=!0,te.__hasExternalTextures&&(te.__autoAllocateDepthBuffer=void 0===de,te.__autoAllocateDepthBuffer||!0===ye.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),te.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(F,ee){const de=Ze.get(F);de.__webglFramebuffer=ee,de.__useDefaultFramebuffer=void 0===ee},this.setRenderTarget=function(F,ee=0,de=0){D=F,C=ee,A=de;let te=!0,he=null,et=!1,yt=!1;if(F){const Ot=Ze.get(F);void 0!==Ot.__useDefaultFramebuffer?(Ee.bindFramebuffer(z.FRAMEBUFFER,null),te=!1):void 0===Ot.__webglFramebuffer?Je.setupRenderTarget(F):Ot.__hasExternalTextures&&Je.rebindTextures(F,Ze.get(F.texture).__webglTexture,Ze.get(F.depthTexture).__webglTexture);const tn=F.texture;(tn.isData3DTexture||tn.isDataArrayTexture||tn.isCompressedArrayTexture)&&(yt=!0);const Dt=Ze.get(F).__webglFramebuffer;F.isWebGLCubeRenderTarget?(he=Array.isArray(Dt[ee])?Dt[ee][de]:Dt[ee],et=!0):he=Ae.isWebGL2&&F.samples>0&&!1===Je.useMultisampledRTT(F)?Ze.get(F).__webglMultisampledFramebuffer:Array.isArray(Dt)?Dt[de]:Dt,L.copy(F.viewport),X.copy(F.scissor),re=F.scissorTest}else L.copy(ce).multiplyScalar($).floor(),X.copy(q).multiplyScalar($).floor(),re=oe;if(Ee.bindFramebuffer(z.FRAMEBUFFER,he)&&Ae.drawBuffers&&te&&Ee.drawBuffers(F,he),Ee.viewport(L),Ee.scissor(X),Ee.setScissorTest(re),et){const Ot=Ze.get(F.texture);z.framebufferTexture2D(z.FRAMEBUFFER,z.COLOR_ATTACHMENT0,z.TEXTURE_CUBE_MAP_POSITIVE_X+ee,Ot.__webglTexture,de)}else if(yt){const Ot=Ze.get(F.texture);z.framebufferTextureLayer(z.FRAMEBUFFER,z.COLOR_ATTACHMENT0,Ot.__webglTexture,de||0,ee||0)}O=-1},this.readRenderTargetPixels=function(F,ee,de,te,he,et,yt){if(!F||!F.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Lt=Ze.get(F).__webglFramebuffer;if(F.isWebGLCubeRenderTarget&&void 0!==yt&&(Lt=Lt[yt]),Lt){Ee.bindFramebuffer(z.FRAMEBUFFER,Lt);try{const Ot=F.texture,tn=Ot.format,Dt=Ot.type;if(tn!==So&&St.convert(tn)!==z.getParameter(z.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const Xt=Dt===By&&(ye.has("EXT_color_buffer_half_float")||Ae.isWebGL2&&ye.has("EXT_color_buffer_float"));if(!(Dt===su||St.convert(Dt)===z.getParameter(z.IMPLEMENTATION_COLOR_READ_TYPE)||Dt===Hl&&(Ae.isWebGL2||ye.has("OES_texture_float")||ye.has("WEBGL_color_buffer_float"))||Xt))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");ee>=0&&ee<=F.width-te&&de>=0&&de<=F.height-he&&z.readPixels(ee,de,te,he,St.convert(tn),St.convert(Dt),et)}finally{const Ot=null!==D?Ze.get(D).__webglFramebuffer:null;Ee.bindFramebuffer(z.FRAMEBUFFER,Ot)}}},this.copyFramebufferToTexture=function(F,ee,de=0){const te=Math.pow(2,-de),he=Math.floor(ee.image.width*te),et=Math.floor(ee.image.height*te);Je.setTexture2D(ee,0),z.copyTexSubImage2D(z.TEXTURE_2D,de,0,0,F.x,F.y,he,et),Ee.unbindTexture()},this.copyTextureToTexture=function(F,ee,de,te=0){const he=ee.image.width,et=ee.image.height,yt=St.convert(de.format),Lt=St.convert(de.type);Je.setTexture2D(de,0),z.pixelStorei(z.UNPACK_FLIP_Y_WEBGL,de.flipY),z.pixelStorei(z.UNPACK_PREMULTIPLY_ALPHA_WEBGL,de.premultiplyAlpha),z.pixelStorei(z.UNPACK_ALIGNMENT,de.unpackAlignment),ee.isDataTexture?z.texSubImage2D(z.TEXTURE_2D,te,F.x,F.y,he,et,yt,Lt,ee.image.data):ee.isCompressedTexture?z.compressedTexSubImage2D(z.TEXTURE_2D,te,F.x,F.y,ee.mipmaps[0].width,ee.mipmaps[0].height,yt,ee.mipmaps[0].data):z.texSubImage2D(z.TEXTURE_2D,te,F.x,F.y,yt,Lt,ee.image),0===te&&de.generateMipmaps&&z.generateMipmap(z.TEXTURE_2D),Ee.unbindTexture()},this.copyTextureToTexture3D=function(F,ee,de,te,he=0){if(E.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const et=F.max.x-F.min.x+1,yt=F.max.y-F.min.y+1,Lt=F.max.z-F.min.z+1,Ot=St.convert(te.format),tn=St.convert(te.type);let Dt;if(te.isData3DTexture)Je.setTexture3D(te,0),Dt=z.TEXTURE_3D;else{if(!te.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");Je.setTexture2DArray(te,0),Dt=z.TEXTURE_2D_ARRAY}z.pixelStorei(z.UNPACK_FLIP_Y_WEBGL,te.flipY),z.pixelStorei(z.UNPACK_PREMULTIPLY_ALPHA_WEBGL,te.premultiplyAlpha),z.pixelStorei(z.UNPACK_ALIGNMENT,te.unpackAlignment);const Xt=z.getParameter(z.UNPACK_ROW_LENGTH),xi=z.getParameter(z.UNPACK_IMAGE_HEIGHT),Oi=z.getParameter(z.UNPACK_SKIP_PIXELS),Do=z.getParameter(z.UNPACK_SKIP_ROWS),Ql=z.getParameter(z.UNPACK_SKIP_IMAGES),Xi=de.isCompressedTexture?de.mipmaps[0]:de.image;z.pixelStorei(z.UNPACK_ROW_LENGTH,Xi.width),z.pixelStorei(z.UNPACK_IMAGE_HEIGHT,Xi.height),z.pixelStorei(z.UNPACK_SKIP_PIXELS,F.min.x),z.pixelStorei(z.UNPACK_SKIP_ROWS,F.min.y),z.pixelStorei(z.UNPACK_SKIP_IMAGES,F.min.z),de.isDataTexture||de.isData3DTexture?z.texSubImage3D(Dt,he,ee.x,ee.y,ee.z,et,yt,Lt,Ot,tn,Xi.data):de.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),z.compressedTexSubImage3D(Dt,he,ee.x,ee.y,ee.z,et,yt,Lt,Ot,Xi.data)):z.texSubImage3D(Dt,he,ee.x,ee.y,ee.z,et,yt,Lt,Ot,tn,Xi),z.pixelStorei(z.UNPACK_ROW_LENGTH,Xt),z.pixelStorei(z.UNPACK_IMAGE_HEIGHT,xi),z.pixelStorei(z.UNPACK_SKIP_PIXELS,Oi),z.pixelStorei(z.UNPACK_SKIP_ROWS,Do),z.pixelStorei(z.UNPACK_SKIP_IMAGES,Ql),0===he&&te.generateMipmaps&&z.generateMipmap(Dt),Ee.unbindTexture()},this.initTexture=function(F){F.isCubeTexture?Je.setTextureCube(F,0):F.isData3DTexture?Je.setTexture3D(F,0):F.isDataArrayTexture||F.isCompressedArrayTexture?Je.setTexture2DArray(F,0):Je.setTexture2D(F,0),Ee.unbindTexture()},this.resetState=function(){C=0,A=0,D=null,Ee.reset(),at.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return zl}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=e===c1?"display-p3":"srgb",t.unpackColorSpace=En.workingColorSpace===VE?"display-p3":"srgb"}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(e){console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!e}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===ui?Ud:3e3}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===Ud?ui:Cr}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}(class cne extends z1{}).prototype.isWebGL1Renderer=!0;class yS extends vi{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t}}class j1{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Ks()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Ks()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Ks()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const ps=new N;class Yd{constructor(e,t,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)ps.fromBufferAttribute(this,t),ps.applyMatrix4(e),this.setXYZ(t,ps.x,ps.y,ps.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)ps.fromBufferAttribute(this,t),ps.applyNormalMatrix(e),this.setXYZ(t,ps.x,ps.y,ps.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)ps.fromBufferAttribute(this,t),ps.transformDirection(e),this.setXYZ(t,ps.x,ps.y,ps.z);return this}setX(e,t){return this.normalized&&(t=Wt(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Wt(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Wt(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Wt(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Is(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Is(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Is(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Is(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=Wt(t,this.array),i=Wt(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Wt(t,this.array),i=Wt(i,this.array),r=Wt(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=Wt(t,this.array),i=Wt(i,this.array),r=Wt(r,this.array),s=Wt(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new ti(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Yd(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}const aV=new N,lV=new Pn,cV=new Pn,hne=new N,uV=new bt,gm=new N,q1=new aa,dV=new bt,X1=new Kp;class hV extends Ce{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new bt,this.bindMatrixInverse=new bt,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;null===this.boundingBox&&(this.boundingBox=new Wa),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)gm.fromBufferAttribute(t,i),this.applyBoneTransform(i,gm),this.boundingBox.expandByPoint(gm)}computeBoundingSphere(){const e=this.geometry;null===this.boundingSphere&&(this.boundingSphere=new aa),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)gm.fromBufferAttribute(t,i),this.applyBoneTransform(i,gm),this.boundingSphere.expandByPoint(gm)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const r=this.matrixWorld;void 0!==this.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),q1.copy(this.boundingSphere),q1.applyMatrix4(r),!1!==e.ray.intersectsSphere(q1)&&(dV.copy(r).invert(),X1.copy(e.ray).applyMatrix4(dV),(null===this.boundingBox||!1!==X1.intersectsBox(this.boundingBox))&&this._computeIntersections(e,t,X1)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Pn,t=this.geometry.attributes.skinWeight;for(let i=0,r=t.count;i<r;i++){e.fromBufferAttribute(t,i);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const i=this.skeleton,r=this.geometry;lV.fromBufferAttribute(r.attributes.skinIndex,e),cV.fromBufferAttribute(r.attributes.skinWeight,e),aV.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=cV.getComponent(s);if(0!==o){const a=lV.getComponent(s);uV.multiplyMatrices(i.bones[a].matrixWorld,i.boneInverses[a]),t.addScaledVector(hne.copy(aV).applyMatrix4(uV),o)}}return t.applyMatrix4(this.bindMatrixInverse)}boneTransform(e,t){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,t)}}class Y1 extends vi{constructor(){super(),this.isBone=!0,this.type="Bone"}}class ev extends oa{constructor(e=null,t=1,i=1,r,s,o,a,l,c=Ni,d=Ni,h,p){super(null,o,a,l,c,d,r,s,h,p),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const fV=new bt,fne=new bt;class SS{constructor(e=[],t=[]){this.uuid=Ks(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new bt)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const i=new bt;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,t=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++)fV.multiplyMatrices(e[s]?e[s].matrixWorld:fne,t[s]),fV.toArray(i,16*s);null!==r&&(r.needsUpdate=!0)}clone(){return new SS(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=iB(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const i=new ev(t,e,e,So,Hl);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const s=e.bones[i];let o=t[s];void 0===o&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new Y1),this.bones.push(o),this.boneInverses.push((new bt).fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,i=this.boneInverses;for(let r=0,s=t.length;r<s;r++)e.bones.push(t[r].uuid),e.boneInverses.push(i[r].toArray());return e}}class tv extends ti{constructor(e,t,i,r=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const _m=new bt,pV=new bt,xS=[],mV=new Wa,pne=new bt,nv=new Ce,iv=new aa;class gV extends Ce{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new tv(new Float32Array(16*i),16),this.instanceColor=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<i;r++)this.setMatrixAt(r,pne)}computeBoundingBox(){const e=this.geometry,t=this.count;null===this.boundingBox&&(this.boundingBox=new Wa),null===e.boundingBox&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,_m),mV.copy(e.boundingBox).applyMatrix4(_m),this.boundingBox.union(mV)}computeBoundingSphere(){const e=this.geometry,t=this.count;null===this.boundingSphere&&(this.boundingSphere=new aa),null===e.boundingSphere&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,_m),iv.copy(e.boundingSphere).applyMatrix4(_m),this.boundingSphere.union(iv)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const i=this.matrixWorld,r=this.count;if(nv.geometry=this.geometry,nv.material=this.material,void 0!==nv.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),iv.copy(this.boundingSphere),iv.applyMatrix4(i),!1!==e.ray.intersectsSphere(iv)))for(let s=0;s<r;s++){this.getMatrixAt(s,_m),pV.multiplyMatrices(i,_m),nv.matrixWorld=pV,nv.raycast(e,xS);for(let o=0,a=xS.length;o<a;o++){const l=xS[o];l.instanceId=s,l.object=this,t.push(l)}xS.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new tv(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class mr extends hs{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new je(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const _V=new N,yV=new N,vV=new bt,Z1=new Kp,MS=new aa;class Gr extends vi{constructor(e=new Nt,t=new mr){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,i=[0];for(let r=1,s=t.count;r<s;r++)_V.fromBufferAttribute(t,r-1),yV.fromBufferAttribute(t,r),i[r]=i[r-1],i[r]+=_V.distanceTo(yV);e.setAttribute("lineDistance",new Xe(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),MS.copy(i.boundingSphere),MS.applyMatrix4(r),MS.radius+=s,!1===e.ray.intersectsSphere(MS))return;vV.copy(r).invert(),Z1.copy(e.ray).applyMatrix4(vV);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=new N,d=new N,h=new N,p=new N,m=this.isLineSegments?2:1,g=i.index,v=i.attributes.position;if(null!==g)for(let E=Math.max(0,o.start),x=Math.min(g.count,o.start+o.count)-1;E<x;E+=m){const C=g.getX(E),A=g.getX(E+1);if(c.fromBufferAttribute(v,C),d.fromBufferAttribute(v,A),Z1.distanceSqToSegment(c,d,p,h)>l)continue;p.applyMatrix4(this.matrixWorld);const O=e.ray.origin.distanceTo(p);O<e.near||O>e.far||t.push({distance:O,point:h.clone().applyMatrix4(this.matrixWorld),index:E,face:null,faceIndex:null,object:this})}else for(let E=Math.max(0,o.start),x=Math.min(v.count,o.start+o.count)-1;E<x;E+=m){if(c.fromBufferAttribute(v,E),d.fromBufferAttribute(v,E+1),Z1.distanceSqToSegment(c,d,p,h)>l)continue;p.applyMatrix4(this.matrixWorld);const A=e.ray.origin.distanceTo(p);A<e.near||A>e.far||t.push({distance:A,point:h.clone().applyMatrix4(this.matrixWorld),index:E,face:null,faceIndex:null,object:this})}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}const bV=new N,wV=new N;class ym extends Gr{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,i=[];for(let r=0,s=t.count;r<s;r+=2)bV.fromBufferAttribute(t,r),wV.fromBufferAttribute(t,r+1),i[r]=0===r?0:i[r-1],i[r+1]=i[r]+bV.distanceTo(wV);e.setAttribute("lineDistance",new Xe(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class EV extends Gr{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class Zd extends hs{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new je(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const SV=new bt,K1=new Kp,CS=new aa,TS=new N;class rv extends vi{constructor(e=new Nt,t=new Zd){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),CS.copy(i.boundingSphere),CS.applyMatrix4(r),CS.radius+=s,!1===e.ray.intersectsSphere(CS))return;SV.copy(r).invert(),K1.copy(e.ray).applyMatrix4(SV);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=i.index,h=i.attributes.position;if(null!==c)for(let g=Math.max(0,o.start),b=Math.min(c.count,o.start+o.count);g<b;g++){const v=c.getX(g);TS.fromBufferAttribute(h,v),xV(TS,v,l,r,e,t,this)}else for(let g=Math.max(0,o.start),b=Math.min(h.count,o.start+o.count);g<b;g++)TS.fromBufferAttribute(h,g),xV(TS,g,l,r,e,t,this)}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function xV(n,e,t,i,r,s,o){const a=K1.distanceSqToPoint(n);if(a<t){const l=new N;K1.closestPointToPoint(n,l),l.applyMatrix4(i);const c=r.ray.origin.distanceTo(l);if(c<r.near||c>r.far)return;s.push({distance:c,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,object:o})}}class sr extends Nt{constructor(e=1,t=1,i=1,r=32,s=1,o=!1,a=0,l=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l};const c=this;r=Math.floor(r),s=Math.floor(s);const d=[],h=[],p=[],m=[];let g=0;const b=[],v=i/2;let y=0;function E(x){const C=g,A=new fe,D=new N;let O=0;const T=!0===x?e:t,L=!0===x?1:-1;for(let re=1;re<=r;re++)h.push(0,v*L,0),p.push(0,L,0),m.push(.5,.5),g++;const X=g;for(let re=0;re<=r;re++){const H=re/r*l+a,J=Math.cos(H),j=Math.sin(H);D.x=T*j,D.y=v*L,D.z=T*J,h.push(D.x,D.y,D.z),p.push(0,L,0),A.x=.5*J+.5,A.y=.5*j*L+.5,m.push(A.x,A.y),g++}for(let re=0;re<r;re++){const ae=C+re,H=X+re;!0===x?d.push(H,H+1,ae):d.push(H+1,H,ae),O+=3}c.addGroup(y,O,!0===x?1:2),y+=O}(function w(){const x=new N,C=new N;let A=0;const D=(t-e)/i;for(let O=0;O<=s;O++){const T=[],L=O/s,X=L*(t-e)+e;for(let re=0;re<=r;re++){const ae=re/r,H=ae*l+a,J=Math.sin(H),j=Math.cos(H);C.x=X*J,C.y=-L*i+v,C.z=X*j,h.push(C.x,C.y,C.z),x.set(J,D,j).normalize(),p.push(x.x,x.y,x.z),m.push(ae,1-L),T.push(g++)}b.push(T)}for(let O=0;O<r;O++)for(let T=0;T<s;T++){const X=b[T+1][O],re=b[T+1][O+1],ae=b[T][O+1];d.push(b[T][O],X,ae),d.push(X,re,ae),A+=6}c.addGroup(y,A,0),y+=A})(),!1===o&&(e>0&&E(!0),t>0&&E(!1)),this.setIndex(d),this.setAttribute("position",new Xe(h,3)),this.setAttribute("normal",new Xe(p,3)),this.setAttribute("uv",new Xe(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new sr(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Kd extends Nt{constructor(e=[],t=[],i=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:r};const s=[],o=[];function l(w,E,x,C){const A=C+1,D=[];for(let O=0;O<=A;O++){D[O]=[];const T=w.clone().lerp(x,O/A),L=E.clone().lerp(x,O/A),X=A-O;for(let re=0;re<=X;re++)D[O][re]=0===re&&O===A?T:T.clone().lerp(L,re/X)}for(let O=0;O<A;O++)for(let T=0;T<2*(A-O)-1;T++){const L=Math.floor(T/2);T%2==0?(p(D[O][L+1]),p(D[O+1][L]),p(D[O][L])):(p(D[O][L+1]),p(D[O+1][L+1]),p(D[O+1][L]))}}function p(w){s.push(w.x,w.y,w.z)}function m(w,E){const x=3*w;E.x=e[x+0],E.y=e[x+1],E.z=e[x+2]}function b(w,E,x,C){C<0&&1===w.x&&(o[E]=w.x-1),0===x.x&&0===x.z&&(o[E]=C/2/Math.PI+.5)}function v(w){return Math.atan2(w.z,-w.x)}function y(w){return Math.atan2(-w.y,Math.sqrt(w.x*w.x+w.z*w.z))}(function a(w){const E=new N,x=new N,C=new N;for(let A=0;A<t.length;A+=3)m(t[A+0],E),m(t[A+1],x),m(t[A+2],C),l(E,x,C,w)})(r),function c(w){const E=new N;for(let x=0;x<s.length;x+=3)E.x=s[x+0],E.y=s[x+1],E.z=s[x+2],E.normalize().multiplyScalar(w),s[x+0]=E.x,s[x+1]=E.y,s[x+2]=E.z}(i),function d(){const w=new N;for(let E=0;E<s.length;E+=3){w.x=s[E+0],w.y=s[E+1],w.z=s[E+2];const x=v(w)/2/Math.PI+.5,C=y(w)/Math.PI+.5;o.push(x,1-C)}(function g(){const w=new N,E=new N,x=new N,C=new N,A=new fe,D=new fe,O=new fe;for(let T=0,L=0;T<s.length;T+=9,L+=6){w.set(s[T+0],s[T+1],s[T+2]),E.set(s[T+3],s[T+4],s[T+5]),x.set(s[T+6],s[T+7],s[T+8]),A.set(o[L+0],o[L+1]),D.set(o[L+2],o[L+3]),O.set(o[L+4],o[L+5]),C.copy(w).add(E).add(x).divideScalar(3);const X=v(C);b(A,L+0,w,X),b(D,L+2,E,X),b(O,L+4,x,X)}})(),function h(){for(let w=0;w<o.length;w+=6){const E=o[w+0],x=o[w+2],C=o[w+4],A=Math.max(E,x,C),D=Math.min(E,x,C);A>.9&&D<.1&&(E<.2&&(o[w+0]+=1),x<.2&&(o[w+2]+=1),C<.2&&(o[w+4]+=1))}}()}(),this.setAttribute("position",new Xe(s,3)),this.setAttribute("normal",new Xe(s.slice(),3)),this.setAttribute("uv",new Xe(o,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Kd(e.vertices,e.indices,e.radius,e.details)}}class mu extends Kd{constructor(e=1,t=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new mu(e.radius,e.detail)}}class wm extends Nt{constructor(e=1,t=32,i=16,r=0,s=2*Math.PI,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));const l=Math.min(o+a,Math.PI);let c=0;const d=[],h=new N,p=new N,m=[],g=[],b=[],v=[];for(let y=0;y<=i;y++){const w=[],E=y/i;let x=0;0===y&&0===o?x=.5/t:y===i&&l===Math.PI&&(x=-.5/t);for(let C=0;C<=t;C++){const A=C/t;h.x=-e*Math.cos(r+A*s)*Math.sin(o+E*a),h.y=e*Math.cos(o+E*a),h.z=e*Math.sin(r+A*s)*Math.sin(o+E*a),g.push(h.x,h.y,h.z),p.copy(h).normalize(),b.push(p.x,p.y,p.z),v.push(A+x,1-E),w.push(c++)}d.push(w)}for(let y=0;y<i;y++)for(let w=0;w<t;w++){const x=d[y][w],C=d[y+1][w],A=d[y+1][w+1];(0!==y||o>0)&&m.push(d[y][w+1],x,A),(y!==i-1||l<Math.PI)&&m.push(x,C,A)}this.setIndex(m),this.setAttribute("position",new Xe(g,3)),this.setAttribute("normal",new Xe(b,3)),this.setAttribute("uv",new Xe(v,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new wm(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class gu extends Nt{constructor(e=1,t=.4,i=12,r=48,s=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:r,arc:s},i=Math.floor(i),r=Math.floor(r);const o=[],a=[],l=[],c=[],d=new N,h=new N,p=new N;for(let m=0;m<=i;m++)for(let g=0;g<=r;g++){const b=g/r*s,v=m/i*Math.PI*2;h.x=(e+t*Math.cos(v))*Math.cos(b),h.y=(e+t*Math.cos(v))*Math.sin(b),h.z=t*Math.sin(v),a.push(h.x,h.y,h.z),d.x=e*Math.cos(b),d.y=e*Math.sin(b),p.subVectors(h,d).normalize(),l.push(p.x,p.y,p.z),c.push(g/r),c.push(m/i)}for(let m=1;m<=i;m++)for(let g=1;g<=r;g++){const v=(r+1)*(m-1)+g-1,y=(r+1)*(m-1)+g,w=(r+1)*m+g;o.push((r+1)*m+g-1,v,w),o.push(v,y,w)}this.setIndex(o),this.setAttribute("position",new Xe(a,3)),this.setAttribute("normal",new Xe(l,3)),this.setAttribute("uv",new Xe(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new gu(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class Em extends hs{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new je(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new je(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new fe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Kl extends Em{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new fe(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return yi(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new je(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new je(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new je(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class BV extends hs{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new je(16777215),this.specular=new je(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new je(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new fe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=OE,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class VV extends hs{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new fe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}function Qd(n,e,t){return!n||!t&&n.constructor===e?n:"number"==typeof e.BYTES_PER_ELEMENT?new e(n):Array.prototype.slice.call(n)}function zV(n){const t=n.length,i=new Array(t);for(let r=0;r!==t;++r)i[r]=r;return i.sort(function e(r,s){return n[r]-n[s]}),i}function _I(n,e,t){const i=n.length,r=new n.constructor(i);for(let s=0,o=0;o!==i;++s){const a=t[s]*e;for(let l=0;l!==e;++l)r[o++]=n[a+l]}return r}function yI(n,e,t,i){let r=1,s=n[0];for(;void 0!==s&&void 0===s[i];)s=n[r++];if(void 0===s)return;let o=s[i];if(void 0!==o)if(Array.isArray(o))do{o=s[i],void 0!==o&&(e.push(s.time),t.push.apply(t,o)),s=n[r++]}while(void 0!==s);else if(void 0!==o.toArray)do{o=s[i],void 0!==o&&(e.push(s.time),o.toArray(t,t.length)),s=n[r++]}while(void 0!==s);else do{o=s[i],void 0!==o&&(e.push(s.time),t.push(o)),s=n[r++]}while(void 0!==s)}class uv{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,r=t[i],s=t[i-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=i+2;;){if(void 0===r){if(e<s)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(s=r,r=t[++i],e<r)break t}o=t.length;break n}if(e>=s)break e;{const a=t[1];e<a&&(i=2,s=a);for(let l=i-2;;){if(void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(i===l)break;if(r=s,s=t[--i-1],e>=s)break t}o=i,i=0}}for(;i<o;){const a=i+o>>>1;e<t[a]?o=a:i=a+1}if(r=t[i],s=t[i-1],void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=i[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class rie extends uv{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(e,t,i){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],l=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case 2401:s=e,a=2*t-i;break;case 2402:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=i}if(void 0===l)switch(this.getSettings_().endingEnd){case 2401:o=e,l=2*i-t;break;case 2402:o=1,l=i+r[1]-r[0];break;default:o=e-1,l=t}const c=.5*(i-t),d=this.valueSize;this._weightPrev=c/(t-a),this._weightNext=c/(l-i),this._offsetPrev=s*d,this._offsetNext=o*d}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,d=this._offsetPrev,h=this._offsetNext,p=this._weightPrev,m=this._weightNext,g=(i-t)/(r-t),b=g*g,v=b*g,y=-p*v+2*p*b-p*g,w=(1+p)*v+(-1.5-2*p)*b+(-.5+p)*g+1,E=(-1-m)*v+(1.5+m)*b+.5*g,x=m*v-m*b;for(let C=0;C!==a;++C)s[C]=y*o[d+C]+w*o[c+C]+E*o[l+C]+x*o[h+C];return s}}class GV extends uv{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,d=(i-t)/(r-t),h=1-d;for(let p=0;p!==a;++p)s[p]=o[c+p]*h+o[l+p]*d;return s}}class sie extends uv{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class Xa{constructor(e,t,i,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Qd(t,this.TimeBufferType),this.values=Qd(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:Qd(e.times,Array),values:Qd(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new sie(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new GV(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new rie(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Vy:t=this.InterpolantFactoryMethodDiscrete;break;case Bp:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Vy;case this.InterpolantFactoryMethodLinear:return Bp;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){const i=this.times,r=i.length;let s=0,o=r-1;for(;s!==r&&i[s]<e;)++s;for(;-1!==o&&i[o]>t;)--o;if(++o,0!==s||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=i.slice(s,o),this.values=this.values.slice(s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;0===s&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=i[a];if("number"==typeof l&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(null!==o&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(void 0!==r&&function HV(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}(r))for(let a=0,l=r.length;a!==l;++a){const c=r[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),i=this.getValueSize(),r=2302===this.getInterpolation(),s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const c=e[a];if(c!==e[a+1]&&(1!==a||c!==e[0]))if(r)l=!0;else{const h=a*i,p=h-i,m=h+i;for(let g=0;g!==i;++g){const b=t[h+g];if(b!==t[p+g]||b!==t[m+g]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const h=a*i,p=o*i;for(let m=0;m!==i;++m)t[p+m]=t[h+m]}++o}}if(s>0){e[o]=e[s];for(let a=s*i,l=o*i,c=0;c!==i;++c)t[l+c]=t[a+c];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*i)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}Xa.prototype.TimeBufferType=Float32Array,Xa.prototype.ValueBufferType=Float32Array,Xa.prototype.DefaultInterpolation=Bp;class Sm extends Xa{}Sm.prototype.ValueTypeName="bool",Sm.prototype.ValueBufferType=Array,Sm.prototype.DefaultInterpolation=Vy,Sm.prototype.InterpolantFactoryMethodLinear=void 0,Sm.prototype.InterpolantFactoryMethodSmooth=void 0;class WV extends Xa{}WV.prototype.ValueTypeName="color";class xm extends Xa{}xm.prototype.ValueTypeName="number";class oie extends uv{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(i-t)/(r-t);let c=e*a;for(let d=c+a;c!==d;c+=4)Bn.slerpFlat(s,0,o,c-a,o,c,l);return s}}class eh extends Xa{InterpolantFactoryMethodLinear(e){return new oie(this.times,this.values,this.getValueSize(),e)}}eh.prototype.ValueTypeName="quaternion",eh.prototype.DefaultInterpolation=Bp,eh.prototype.InterpolantFactoryMethodSmooth=void 0;class Mm extends Xa{}Mm.prototype.ValueTypeName="string",Mm.prototype.ValueBufferType=Array,Mm.prototype.DefaultInterpolation=Vy,Mm.prototype.InterpolantFactoryMethodLinear=void 0,Mm.prototype.InterpolantFactoryMethodSmooth=void 0;class Cm extends Xa{}Cm.prototype.ValueTypeName="vector";class dv{constructor(e,t=-1,i,r=2500){this.name=e,this.tracks=i,this.duration=t,this.blendMode=r,this.uuid=Ks(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,r=1/(e.fps||1);for(let o=0,a=i.length;o!==a;++o)t.push(lie(i[o]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=i.length;s!==o;++s)t.push(Xa.toJSON(i[s]));return r}static CreateFromMorphTargetSequence(e,t,i,r){const s=t.length,o=[];for(let a=0;a<s;a++){let l=[],c=[];l.push((a+s-1)%s,a,(a+1)%s),c.push(0,1,0);const d=zV(l);l=_I(l,1,d),c=_I(c,1,d),!r&&0===l[0]&&(l.push(s),c.push(c[0])),o.push(new xm(".morphTargetInfluences["+t[a].name+"]",l,c).scale(1/i))}return new this(e,-1,o)}static findByName(e,t){let i=e;Array.isArray(e)||(i=e.geometry&&e.geometry.animations||e.animations);for(let r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const c=e[a],d=c.name.match(s);if(d&&d.length>1){const h=d[1];let p=r[h];p||(r[h]=p=[]),p.push(c)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],t,i));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(h,p,m,g,b){if(0!==m.length){const v=[],y=[];yI(m,v,y,g),0!==v.length&&b.push(new h(p,v,y))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let l=e.length||-1;const c=e.hierarchy||[];for(let h=0;h<c.length;h++){const p=c[h].keys;if(p&&0!==p.length)if(p[0].morphTargets){const m={};let g;for(g=0;g<p.length;g++)if(p[g].morphTargets)for(let b=0;b<p[g].morphTargets.length;b++)m[p[g].morphTargets[b]]=-1;for(const b in m){const v=[],y=[];for(let w=0;w!==p[g].morphTargets.length;++w){const E=p[g];v.push(E.time),y.push(E.morphTarget===b?1:0)}r.push(new xm(".morphTargetInfluence["+b+"]",v,y))}l=m.length*o}else{const m=".bones["+t[h].name+"]";i(Cm,m+".position",p,"pos",r),i(eh,m+".quaternion",p,"rot",r),i(Cm,m+".scale",p,"scl",r)}}return 0===r.length?null:new this(s,l,r,a)}resetDuration(){let t=0;for(let i=0,r=this.tracks.length;i!==r;++i){const s=this.tracks[i];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function lie(n){if(void 0===n.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function aie(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return xm;case"vector":case"vector2":case"vector3":case"vector4":return Cm;case"color":return WV;case"quaternion":return eh;case"bool":case"boolean":return Sm;case"string":return Mm}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}(n.type);if(void 0===n.times){const t=[],i=[];yI(n.keys,t,i,"value"),n.times=t,n.values=i}return void 0!==e.parse?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const Tm={enabled:!1,files:{},add:function(n,e){!1!==this.enabled&&(this.files[n]=e)},get:function(n){if(!1!==this.enabled)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class jV{constructor(e,t,i){const r=this;let l,s=!1,o=0,a=0;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(d){a++,!1===s&&void 0!==r.onStart&&r.onStart(d,o,a),s=!0},this.itemEnd=function(d){o++,void 0!==r.onProgress&&r.onProgress(d,o,a),o===a&&(s=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(d){void 0!==r.onError&&r.onError(d)},this.resolveURL=function(d){return l?l(d):d},this.setURLModifier=function(d){return l=d,this},this.addHandler=function(d,h){return c.push(d,h),this},this.removeHandler=function(d){const h=c.indexOf(d);return-1!==h&&c.splice(h,2),this},this.getHandler=function(d){for(let h=0,p=c.length;h<p;h+=2){const m=c[h],g=c[h+1];if(m.global&&(m.lastIndex=0),m.test(d))return g}return null}}}const cie=new jV;let _u=(()=>{class n{constructor(t){this.manager=void 0!==t?t:cie,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,i){const r=this;return new Promise(function(s,o){r.load(t,s,i,o)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}return n.DEFAULT_MATERIAL_NAME="__DEFAULT",n})();const Jl={};class uie extends Error{constructor(e,t){super(e),this.response=t}}class Co extends _u{constructor(e){super(e)}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=Tm.get(e);if(void 0!==s)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(void 0!==Jl[e])return void Jl[e].push({onLoad:t,onProgress:i,onError:r});Jl[e]=[],Jl[e].push({onLoad:t,onProgress:i,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(c=>{if(200===c.status||0===c.status){if(0===c.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||void 0===c.body||void 0===c.body.getReader)return c;const d=Jl[e],h=c.body.getReader(),p=c.headers.get("Content-Length")||c.headers.get("X-File-Size"),m=p?parseInt(p):0,g=0!==m;let b=0;const v=new ReadableStream({start(y){!function w(){h.read().then(({done:E,value:x})=>{if(E)y.close();else{b+=x.byteLength;const C=new ProgressEvent("progress",{lengthComputable:g,loaded:b,total:m});for(let A=0,D=d.length;A<D;A++){const O=d[A];O.onProgress&&O.onProgress(C)}y.enqueue(x),w()}})}()}});return new Response(v)}throw new uie(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`,c)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(d=>(new DOMParser).parseFromString(d,a));case"json":return c.json();default:if(void 0===a)return c.text();{const h=/charset="?([^;"\s]*)"?/i.exec(a),p=h&&h[1]?h[1].toLowerCase():void 0,m=new TextDecoder(p);return c.arrayBuffer().then(g=>m.decode(g))}}}).then(c=>{Tm.add(e,c);const d=Jl[e];delete Jl[e];for(let h=0,p=d.length;h<p;h++){const m=d[h];m.onLoad&&m.onLoad(c)}}).catch(c=>{const d=Jl[e];if(void 0===d)throw this.manager.itemError(e),c;delete Jl[e];for(let h=0,p=d.length;h<p;h++){const m=d[h];m.onError&&m.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class US extends _u{constructor(e){super(e)}load(e,t,i,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Tm.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=zy("img");function l(){d(),Tm.add(e,this),t&&t(this),s.manager.itemEnd(e)}function c(h){d(),r&&r(h),s.manager.itemError(e),s.manager.itemEnd(e)}function d(){a.removeEventListener("load",l,!1),a.removeEventListener("error",c,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",c,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class die extends _u{constructor(e){super(e)}load(e,t,i,r){const s=new dS;s.colorSpace=ui;const o=new US(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function l(c){o.load(e[c],function(d){s.images[c]=d,a++,6===a&&(s.needsUpdate=!0,t&&t(s))},void 0,r)}for(let c=0;c<e.length;++c)l(c);return s}}class $V extends _u{constructor(e){super(e)}load(e,t,i,r){const s=new oa,o=new US(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,void 0!==t&&t(s)},i,r),s}}class vI extends vi{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new je(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}const bI=new bt,qV=new N,XV=new N;class wI{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new fe(512,512),this.map=null,this.mapPass=null,this.matrix=new bt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new L1,this._frameExtents=new fe(1,1),this._viewportCount=1,this._viewports=[new Pn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;qV.setFromMatrixPosition(e.matrixWorld),t.position.copy(qV),XV.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(XV),t.updateMatrixWorld(),bI.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(bI),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(bI)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class fie extends wI{constructor(){super(new nr(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,i=2*zp*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(i!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=i,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class YV extends vI{constructor(e,t,i=0,r=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(vi.DEFAULT_UP),this.updateMatrix(),this.target=new vi,this.distance=i,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new fie}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const ZV=new bt,hv=new N,EI=new N;class pie extends wI{constructor(){super(new nr(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new fe(4,2),this._viewportCount=6,this._viewports=[new Pn(2,1,1,1),new Pn(0,1,1,1),new Pn(3,1,1,1),new Pn(1,1,1,1),new Pn(3,0,1,1),new Pn(1,0,1,1)],this._cubeDirections=[new N(1,0,0),new N(-1,0,0),new N(0,0,1),new N(0,0,-1),new N(0,1,0),new N(0,-1,0)],this._cubeUps=[new N(0,1,0),new N(0,1,0),new N(0,1,0),new N(0,1,0),new N(0,0,1),new N(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),hv.setFromMatrixPosition(e.matrixWorld),i.position.copy(hv),EI.copy(i.position),EI.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(EI),i.updateMatrixWorld(),r.makeTranslation(-hv.x,-hv.y,-hv.z),ZV.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(ZV)}}class SI extends vI{constructor(e,t,i=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new pie}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class mie extends wI{constructor(){super(new pS(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class KV extends vI{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(vi.DEFAULT_UP),this.updateMatrix(),this.target=new vi,this.shadow=new mie}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class fv{static decodeText(e){if(typeof TextDecoder<"u")return(new TextDecoder).decode(e);let t="";for(let i=0,r=e.length;i<r;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class Sie extends _u{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Tm.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a={};a.credentials="anonymous"===this.crossOrigin?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(l){Tm.add(e,l),t&&t(l),s.manager.itemEnd(e)}).catch(function(l){r&&r(l),s.manager.itemError(e),s.manager.itemEnd(e)}),s.manager.itemStart(e)}}const MI="\\[\\]\\.:\\/",Aie=new RegExp("["+MI+"]","g"),CI="[^"+MI+"]",Die="[^"+MI.replace("\\.","")+"]",Lie=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",CI)+/(WCOD+)?/.source.replace("WCOD",Die)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",CI)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",CI)+"$"),Oie=["material","materials","bones","map"];class Fie{constructor(e,t,i){const r=i||Yn.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}let Yn=(()=>{class n{constructor(t,i,r){this.path=i,this.parsedPath=r||n.parseTrackName(i),this.node=n.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,i,r){return t&&t.isAnimationObjectGroup?new n.Composite(t,i,r):new n(t,i,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(Aie,"")}static parseTrackName(t){const i=Lie.exec(t);if(null===i)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},s=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==s&&-1!==s){const o=r.nodeName.substring(s+1);-1!==Oie.indexOf(o)&&(r.nodeName=r.nodeName.substring(0,s),r.objectName=o)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,i){if(void 0===i||""===i||"."===i||-1===i||i===t.name||i===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(i);if(void 0!==r)return r}if(t.children){const r=function(o){for(let a=0;a<o.length;a++){const l=o[a];if(l.name===i||l.uuid===i)return l;const c=r(l.children);if(c)return c}return null},s=r(t.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,i){t[i]=this.targetObject[this.propertyName]}_getValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)t[i++]=r[s]}_getValue_arrayElement(t,i){t[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,i){this.resolvedProperty.toArray(t,i)}_setValue_direct(t,i){this.targetObject[this.propertyName]=t[i]}_setValue_direct_setNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++]}_setValue_array_setNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,i){this.resolvedProperty[this.propertyIndex]=t[i]}_setValue_arrayElement_setNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,i){this.resolvedProperty.fromArray(t,i)}_setValue_fromArray_setNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,i){this.bind(),this.getValue(t,i)}_setValue_unbound(t,i){this.bind(),this.setValue(t,i)}bind(){let t=this.node;const i=this.parsedPath,r=i.objectName,s=i.propertyName;let o=i.propertyIndex;if(t||(t=n.findNode(this.rootNode,i.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(r){let d=i.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let h=0;h<t.length;h++)if(t[h].name===d){d=h;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==d){if(void 0===t[d])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[d]}}const a=t[s];if(void 0===a)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+i.nodeName+"."+s+" but it wasn't found.",t);let l=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?l=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(void 0!==o){if("morphTargetInfluences"===s){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[o]&&(o=t.morphTargetDictionary[o])}c=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=o}else void 0!==a.fromArray&&void 0!==a.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(c=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=s;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return n.Composite=Fie,n})();Yn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Yn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Yn.prototype.GetterByBindingType=[Yn.prototype._getValue_direct,Yn.prototype._getValue_array,Yn.prototype._getValue_arrayElement,Yn.prototype._getValue_toArray],Yn.prototype.SetterByBindingTypeAndVersioning=[[Yn.prototype._setValue_direct,Yn.prototype._setValue_direct_setNeedsUpdate,Yn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Yn.prototype._setValue_array,Yn.prototype._setValue_array_setNeedsUpdate,Yn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Yn.prototype._setValue_arrayElement,Yn.prototype._setValue_arrayElement_setNeedsUpdate,Yn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Yn.prototype._setValue_fromArray,Yn.prototype._setValue_fromArray_setNeedsUpdate,Yn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],new Float32Array(1);class TI{constructor(e,t,i=0,r=1/0){this.ray=new Kp(e,t),this.near=i,this.far=r,this.camera=null,this.layers=new x1,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,i=[]){return AI(e,this,i,t),i.sort(aH),i}intersectObjects(e,t=!0,i=[]){for(let r=0,s=e.length;r<s;r++)AI(e[r],this,i,t);return i.sort(aH),i}}function aH(n,e){return n.distance-e.distance}function AI(n,e,t,i){if(n.layers.test(e.layers)&&n.raycast(e,t),!0===i){const r=n.children;for(let s=0,o=r.length;s<o;s++)AI(r[s],e,t,!0)}}class lH{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(yi(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}class Hie extends ym{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=new Nt;r.setAttribute("position",new Xe(t,3)),r.setAttribute("color",new Xe([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),super(r,new mr({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,t,i){const r=new je,s=this.geometry.attributes.color.array;return r.set(e),r.toArray(s,0),r.toArray(s,3),r.set(t),r.toArray(s,6),r.toArray(s,9),r.set(i),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"157"}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="157");const yH={type:"change"},RI={type:"start"},vH={type:"end"},$S=new Kp,bH=new pu,zie=Math.cos(70*au_DEG2RAD);class wH extends Vd{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new N,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:0,MIDDLE:1,RIGHT:2},this.touches={ONE:0,TWO:2},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return a.phi},this.getAzimuthalAngle=function(){return a.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(G){G.addEventListener("keydown",R),this._domElementKeyEvents=G},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",R),this._domElementKeyEvents=null},this.saveState=function(){i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=function(){i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(yH),i.update(),s=r.NONE},this.update=function(){const G=new N,Re=(new Bn).setFromUnitVectors(e.up,new N(0,1,0)),ve=Re.clone().invert(),St=new N,at=new Bn,ht=new N,st=2*Math.PI;return function(Oe=null){const Pe=i.object.position;G.copy(Pe).sub(i.target),G.applyQuaternion(Re),a.setFromVector3(G),i.autoRotate&&s===r.NONE&&X(function T(G){return null!==G?2*Math.PI/60*i.autoRotateSpeed*G:2*Math.PI/60/60*i.autoRotateSpeed}(Oe)),i.enableDamping?(a.theta+=l.theta*i.dampingFactor,a.phi+=l.phi*i.dampingFactor):(a.theta+=l.theta,a.phi+=l.phi);let We=i.minAzimuthAngle,Fe=i.maxAzimuthAngle;isFinite(We)&&isFinite(Fe)&&(We<-Math.PI?We+=st:We>Math.PI&&(We-=st),Fe<-Math.PI?Fe+=st:Fe>Math.PI&&(Fe-=st),a.theta=We<=Fe?Math.max(We,Math.min(Fe,a.theta)):a.theta>(We+Fe)/2?Math.max(We,a.theta):Math.min(Fe,a.theta)),a.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,a.phi)),a.makeSafe(),!0===i.enableDamping?i.target.addScaledVector(d,i.dampingFactor):i.target.add(d),a.radius=K(i.zoomToCursor&&A||i.object.isOrthographicCamera?a.radius:a.radius*c),G.setFromSpherical(a),G.applyQuaternion(ve),Pe.copy(i.target).add(G),i.object.lookAt(i.target),!0===i.enableDamping?(l.theta*=1-i.dampingFactor,l.phi*=1-i.dampingFactor,d.multiplyScalar(1-i.dampingFactor)):(l.set(0,0,0),d.set(0,0,0));let Se=!1;if(i.zoomToCursor&&A){let nt=null;if(i.object.isPerspectiveCamera){const Mt=G.length();nt=K(Mt*c),i.object.position.addScaledVector(x,Mt-nt),i.object.updateMatrixWorld()}else if(i.object.isOrthographicCamera){const Mt=new N(C.x,C.y,0);Mt.unproject(i.object),i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/c)),i.object.updateProjectionMatrix(),Se=!0;const qi=new N(C.x,C.y,0);qi.unproject(i.object),i.object.position.sub(qi).add(Mt),i.object.updateMatrixWorld(),nt=G.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),i.zoomToCursor=!1;null!==nt&&(this.screenSpacePanning?i.target.set(0,0,-1).transformDirection(i.object.matrix).multiplyScalar(nt).add(i.object.position):($S.origin.copy(i.object.position),$S.direction.set(0,0,-1).transformDirection(i.object.matrix),Math.abs(i.object.up.dot($S.direction))<zie?e.lookAt(i.target):(bH.setFromNormalAndCoplanarPoint(i.object.up,i.target),$S.intersectPlane(bH,i.target))))}else i.object.isOrthographicCamera&&(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/c)),i.object.updateProjectionMatrix(),Se=!0);return c=1,A=!1,!!(Se||St.distanceToSquared(i.object.position)>o||8*(1-at.dot(i.object.quaternion))>o||ht.distanceToSquared(i.target)>0)&&(i.dispatchEvent(yH),St.copy(i.object.position),at.copy(i.object.quaternion),ht.copy(i.target),Se=!1,!0)}}(),this.dispose=function(){i.domElement.removeEventListener("contextmenu",xe),i.domElement.removeEventListener("pointerdown",Ze),i.domElement.removeEventListener("pointercancel",wt),i.domElement.removeEventListener("wheel",k),i.domElement.removeEventListener("pointermove",Je),i.domElement.removeEventListener("pointerup",wt),null!==i._domElementKeyEvents&&(i._domElementKeyEvents.removeEventListener("keydown",R),i._domElementKeyEvents=null)};const i=this,r={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let s=r.NONE;const o=1e-6,a=new lH,l=new lH;let c=1;const d=new N,h=new fe,p=new fe,m=new fe,g=new fe,b=new fe,v=new fe,y=new fe,w=new fe,E=new fe,x=new N,C=new fe;let A=!1;const D=[],O={};function L(){return Math.pow(.95,i.zoomSpeed)}function X(G){l.theta-=G}function re(G){l.phi-=G}const ae=function(){const G=new N;return function(ve,St){G.setFromMatrixColumn(St,0),G.multiplyScalar(-ve),d.add(G)}}(),H=function(){const G=new N;return function(ve,St){!0===i.screenSpacePanning?G.setFromMatrixColumn(St,1):(G.setFromMatrixColumn(St,0),G.crossVectors(i.object.up,G)),G.multiplyScalar(ve),d.add(G)}}(),J=function(){const G=new N;return function(ve,St){const at=i.domElement;if(i.object.isPerspectiveCamera){G.copy(i.object.position).sub(i.target);let st=G.length();st*=Math.tan(i.object.fov/2*Math.PI/180),ae(2*ve*st/at.clientHeight,i.object.matrix),H(2*St*st/at.clientHeight,i.object.matrix)}else i.object.isOrthographicCamera?(ae(ve*(i.object.right-i.object.left)/i.object.zoom/at.clientWidth,i.object.matrix),H(St*(i.object.top-i.object.bottom)/i.object.zoom/at.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}}();function j(G){i.object.isPerspectiveCamera||i.object.isOrthographicCamera?c/=G:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function $(G){i.object.isPerspectiveCamera||i.object.isOrthographicCamera?c*=G:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function Q(G){if(!i.zoomToCursor)return;A=!0;const Re=i.domElement.getBoundingClientRect(),St=G.clientY-Re.top,ht=Re.height;C.x=(G.clientX-Re.left)/Re.width*2-1,C.y=-St/ht*2+1,x.set(C.x,C.y,1).unproject(i.object).sub(i.object.position).normalize()}function K(G){return Math.max(i.minDistance,Math.min(i.maxDistance,G))}function ce(G){h.set(G.clientX,G.clientY)}function oe(G){g.set(G.clientX,G.clientY)}function Ye(){1===D.length?h.set(D[0].pageX,D[0].pageY):h.set(.5*(D[0].pageX+D[1].pageX),.5*(D[0].pageY+D[1].pageY))}function _t(){1===D.length?g.set(D[0].pageX,D[0].pageY):g.set(.5*(D[0].pageX+D[1].pageX),.5*(D[0].pageY+D[1].pageY))}function qt(){const G=D[0].pageX-D[1].pageX,Re=D[0].pageY-D[1].pageY,ve=Math.sqrt(G*G+Re*Re);y.set(0,ve)}function Ne(G){if(1==D.length)p.set(G.pageX,G.pageY);else{const ve=$e(G);p.set(.5*(G.pageX+ve.x),.5*(G.pageY+ve.y))}m.subVectors(p,h).multiplyScalar(i.rotateSpeed);const Re=i.domElement;X(2*Math.PI*m.x/Re.clientHeight),re(2*Math.PI*m.y/Re.clientHeight),h.copy(p)}function ye(G){if(1===D.length)b.set(G.pageX,G.pageY);else{const Re=$e(G);b.set(.5*(G.pageX+Re.x),.5*(G.pageY+Re.y))}v.subVectors(b,g).multiplyScalar(i.panSpeed),J(v.x,v.y),g.copy(b)}function Ae(G){const Re=$e(G),ve=G.pageX-Re.x,St=G.pageY-Re.y,at=Math.sqrt(ve*ve+St*St);w.set(0,at),E.set(0,Math.pow(w.y/y.y,i.zoomSpeed)),j(E.y),y.copy(w)}function Ze(G){!1!==i.enabled&&(0===D.length&&(i.domElement.setPointerCapture(G.pointerId),i.domElement.addEventListener("pointermove",Je),i.domElement.addEventListener("pointerup",wt)),function De(G){D.push(G)}(G),"touch"===G.pointerType?function ne(G){switch(Ie(G),D.length){case 1:switch(i.touches.ONE){case 0:if(!1===i.enableRotate)return;Ye(),s=r.TOUCH_ROTATE;break;case 1:if(!1===i.enablePan)return;_t(),s=r.TOUCH_PAN;break;default:s=r.NONE}break;case 2:switch(i.touches.TWO){case 2:if(!1===i.enableZoom&&!1===i.enablePan)return;(function rt(){i.enableZoom&&qt(),i.enablePan&&_t()})(),s=r.TOUCH_DOLLY_PAN;break;case 3:if(!1===i.enableZoom&&!1===i.enableRotate)return;(function z(){i.enableZoom&&qt(),i.enableRotate&&Ye()})(),s=r.TOUCH_DOLLY_ROTATE;break;default:s=r.NONE}break;default:s=r.NONE}s!==r.NONE&&i.dispatchEvent(RI)}(G):function en(G){let Re;switch(G.button){case 0:Re=i.mouseButtons.LEFT;break;case 1:Re=i.mouseButtons.MIDDLE;break;case 2:Re=i.mouseButtons.RIGHT;break;default:Re=-1}switch(Re){case 1:if(!1===i.enableZoom)return;(function q(G){Q(G),y.set(G.clientX,G.clientY)})(G),s=r.DOLLY;break;case 0:if(G.ctrlKey||G.metaKey||G.shiftKey){if(!1===i.enablePan)return;oe(G),s=r.PAN}else{if(!1===i.enableRotate)return;ce(G),s=r.ROTATE}break;case 2:if(G.ctrlKey||G.metaKey||G.shiftKey){if(!1===i.enableRotate)return;ce(G),s=r.ROTATE}else{if(!1===i.enablePan)return;oe(G),s=r.PAN}break;default:s=r.NONE}s!==r.NONE&&i.dispatchEvent(RI)}(G))}function Je(G){!1!==i.enabled&&("touch"===G.pointerType?function Te(G){switch(Ie(G),s){case r.TOUCH_ROTATE:if(!1===i.enableRotate)return;Ne(G),i.update();break;case r.TOUCH_PAN:if(!1===i.enablePan)return;ye(G),i.update();break;case r.TOUCH_DOLLY_PAN:if(!1===i.enableZoom&&!1===i.enablePan)return;(function Ee(G){i.enableZoom&&Ae(G),i.enablePan&&ye(G)})(G),i.update();break;case r.TOUCH_DOLLY_ROTATE:if(!1===i.enableZoom&&!1===i.enableRotate)return;(function ot(G){i.enableZoom&&Ae(G),i.enableRotate&&Ne(G)})(G),i.update();break;default:s=r.NONE}}(G):function ai(G){switch(s){case r.ROTATE:if(!1===i.enableRotate)return;!function Me(G){p.set(G.clientX,G.clientY),m.subVectors(p,h).multiplyScalar(i.rotateSpeed);const Re=i.domElement;X(2*Math.PI*m.x/Re.clientHeight),re(2*Math.PI*m.y/Re.clientHeight),h.copy(p),i.update()}(G);break;case r.DOLLY:if(!1===i.enableZoom)return;!function we(G){w.set(G.clientX,G.clientY),E.subVectors(w,y),E.y>0?j(L()):E.y<0&&$(L()),y.copy(w),i.update()}(G);break;case r.PAN:if(!1===i.enablePan)return;!function ze(G){b.set(G.clientX,G.clientY),v.subVectors(b,g).multiplyScalar(i.panSpeed),J(v.x,v.y),g.copy(b),i.update()}(G)}}(G))}function wt(G){(function it(G){delete O[G.pointerId];for(let Re=0;Re<D.length;Re++)if(D[Re].pointerId==G.pointerId)return void D.splice(Re,1)})(G),0===D.length&&(i.domElement.releasePointerCapture(G.pointerId),i.domElement.removeEventListener("pointermove",Je),i.domElement.removeEventListener("pointerup",wt)),i.dispatchEvent(vH),s=r.NONE}function k(G){!1===i.enabled||!1===i.enableZoom||s!==r.NONE||(G.preventDefault(),i.dispatchEvent(RI),function Qe(G){Q(G),G.deltaY<0?$(L()):G.deltaY>0&&j(L()),i.update()}(G),i.dispatchEvent(vH))}function R(G){!1===i.enabled||!1===i.enablePan||function Ge(G){let Re=!1;switch(G.code){case i.keys.UP:G.ctrlKey||G.metaKey||G.shiftKey?re(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):J(0,i.keyPanSpeed),Re=!0;break;case i.keys.BOTTOM:G.ctrlKey||G.metaKey||G.shiftKey?re(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):J(0,-i.keyPanSpeed),Re=!0;break;case i.keys.LEFT:G.ctrlKey||G.metaKey||G.shiftKey?X(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):J(i.keyPanSpeed,0),Re=!0;break;case i.keys.RIGHT:G.ctrlKey||G.metaKey||G.shiftKey?X(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):J(-i.keyPanSpeed,0),Re=!0}Re&&(G.preventDefault(),i.update())}(G)}function xe(G){!1!==i.enabled&&G.preventDefault()}function Ie(G){let Re=O[G.pointerId];void 0===Re&&(Re=new fe,O[G.pointerId]=Re),Re.set(G.pageX,G.pageY)}function $e(G){return O[(G.pointerId===D[0].pointerId?D[1]:D[0]).pointerId]}i.domElement.addEventListener("contextmenu",xe),i.domElement.addEventListener("pointerdown",Ze),i.domElement.addEventListener("pointercancel",wt),i.domElement.addEventListener("wheel",k,{passive:!1}),this.update()}}function EH(n,e){if(0===e)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),n;if(2===e||1===e){let t=n.getIndex();if(null===t){const o=[],a=n.getAttribute("position");if(void 0===a)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n;for(let l=0;l<a.count;l++)o.push(l);n.setIndex(o),t=n.getIndex()}const i=t.count-2,r=[];if(2===e)for(let o=1;o<=i;o++)r.push(t.getX(0)),r.push(t.getX(o)),r.push(t.getX(o+1));else for(let o=0;o<i;o++)o%2==0?(r.push(t.getX(o)),r.push(t.getX(o+1)),r.push(t.getX(o+2))):(r.push(t.getX(o+2)),r.push(t.getX(o+1)),r.push(t.getX(o)));r.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=n.clone();return s.setIndex(r),s.clearGroups(),s}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),n}class SH extends _u{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new Xie(t)}),this.register(function(t){return new nre(t)}),this.register(function(t){return new ire(t)}),this.register(function(t){return new rre(t)}),this.register(function(t){return new Zie(t)}),this.register(function(t){return new Kie(t)}),this.register(function(t){return new Jie(t)}),this.register(function(t){return new Qie(t)}),this.register(function(t){return new qie(t)}),this.register(function(t){return new ere(t)}),this.register(function(t){return new Yie(t)}),this.register(function(t){return new tre(t)}),this.register(function(t){return new jie(t)}),this.register(function(t){return new sre(t)}),this.register(function(t){return new ore(t)})}load(e,t,i,r){const s=this;let o;o=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:fv.extractUrlBase(e),this.manager.itemStart(e);const a=function(c){r?r(c):console.error(c),s.manager.itemError(e),s.manager.itemEnd(e)},l=new Co(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(c){try{s.parse(c,o,function(d){t(d),s.manager.itemEnd(e)},a)}catch(d){a(d)}},i,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,r){let s;const o={},a={},l=new TextDecoder;if("string"==typeof e)s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(l.decode(new Uint8Array(e,0,4))===xH){try{o[an.KHR_BINARY_GLTF]=new are(e)}catch(h){return void(r&&r(h))}s=JSON.parse(o[an.KHR_BINARY_GLTF].content)}else s=JSON.parse(l.decode(e));else s=e;if(void 0===s.asset||s.asset.version[0]<2)return void(r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const c=new bre(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});c.fileLoader.setRequestHeader(this.requestHeader);for(let d=0;d<this.pluginCallbacks.length;d++){const h=this.pluginCallbacks[d](c);a[h.name]=h,o[h.name]=!0}if(s.extensionsUsed)for(let d=0;d<s.extensionsUsed.length;++d){const h=s.extensionsUsed[d],p=s.extensionsRequired||[];switch(h){case an.KHR_MATERIALS_UNLIT:o[h]=new $ie;break;case an.KHR_DRACO_MESH_COMPRESSION:o[h]=new lre(s,this.dracoLoader);break;case an.KHR_TEXTURE_TRANSFORM:o[h]=new cre;break;case an.KHR_MESH_QUANTIZATION:o[h]=new ure;break;default:p.indexOf(h)>=0&&void 0===a[h]&&console.warn('THREE.GLTFLoader: Unknown extension "'+h+'".')}}c.setExtensions(o),c.setPlugins(a),c.parse(i,r)}parseAsync(e,t){const i=this;return new Promise(function(r,s){i.parse(e,t,r,s)})}}function Wie(){let n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}const an={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class jie{constructor(e){this.parser=e,this.name=an.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let i=0,r=t.length;i<r;i++){const s=t[i];s.extensions&&s.extensions[this.name]&&void 0!==s.extensions[this.name].light&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,i="light:"+e;let r=t.cache.get(i);if(r)return r;const s=t.json,l=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let c;const d=new je(16777215);void 0!==l.color&&d.setRGB(l.color[0],l.color[1],l.color[2],Cr);const h=void 0!==l.range?l.range:0;switch(l.type){case"directional":c=new KV(d),c.target.position.set(0,0,-1),c.add(c.target);break;case"point":c=new SI(d),c.distance=h;break;case"spot":c=new YV(d),c.distance=h,l.spot=l.spot||{},l.spot.innerConeAngle=void 0!==l.spot.innerConeAngle?l.spot.innerConeAngle:0,l.spot.outerConeAngle=void 0!==l.spot.outerConeAngle?l.spot.outerConeAngle:Math.PI/4,c.angle=l.spot.outerConeAngle,c.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,c.target.position.set(0,0,-1),c.add(c.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return c.position.set(0,0,0),c.decay=2,bu(c,l),void 0!==l.intensity&&(c.intensity=l.intensity),c.name=t.createUniqueName(l.name||"light_"+e),r=Promise.resolve(c),t.cache.add(i,r),r}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){const t=this,i=this.parser,s=i.json.nodes[e],a=(s.extensions&&s.extensions[this.name]||{}).light;return void 0===a?null:this._loadLight(a).then(function(l){return i._getNodeRef(t.cache,a,l)})}}class $ie{constructor(){this.name=an.KHR_MATERIALS_UNLIT}getMaterialType(){return bi}extendParams(e,t,i){const r=[];e.color=new je(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.setRGB(o[0],o[1],o[2],Cr),e.opacity=o[3]}void 0!==s.baseColorTexture&&r.push(i.assignTexture(e,"map",s.baseColorTexture,ui))}return Promise.all(r)}}class qie{constructor(e){this.parser=e,this.name=an.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name].emissiveStrength;return void 0!==s&&(t.emissiveIntensity=s),Promise.resolve()}}class Xie{constructor(e){this.parser=e,this.name=an.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Kl:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];if(void 0!==o.clearcoatFactor&&(t.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&s.push(i.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&s.push(i.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(s.push(i.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){const a=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new fe(a,a)}return Promise.all(s)}}class Yie{constructor(e){this.parser=e,this.name=an.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Kl:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.iridescenceFactor&&(t.iridescence=o.iridescenceFactor),void 0!==o.iridescenceTexture&&s.push(i.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),void 0!==o.iridescenceIor&&(t.iridescenceIOR=o.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==o.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),void 0!==o.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),void 0!==o.iridescenceThicknessTexture&&s.push(i.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}}class Zie{constructor(e){this.parser=e,this.name=an.KHR_MATERIALS_SHEEN}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Kl:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new je(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=r.extensions[this.name];if(void 0!==o.sheenColorFactor){const a=o.sheenColorFactor;t.sheenColor.setRGB(a[0],a[1],a[2],Cr)}return void 0!==o.sheenRoughnessFactor&&(t.sheenRoughness=o.sheenRoughnessFactor),void 0!==o.sheenColorTexture&&s.push(i.assignTexture(t,"sheenColorMap",o.sheenColorTexture,ui)),void 0!==o.sheenRoughnessTexture&&s.push(i.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class Kie{constructor(e){this.parser=e,this.name=an.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Kl:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.transmissionFactor&&(t.transmission=o.transmissionFactor),void 0!==o.transmissionTexture&&s.push(i.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class Jie{constructor(e){this.parser=e,this.name=an.KHR_MATERIALS_VOLUME}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Kl:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.thickness=void 0!==o.thicknessFactor?o.thicknessFactor:0,void 0!==o.thicknessTexture&&s.push(i.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;const a=o.attenuationColor||[1,1,1];return t.attenuationColor=(new je).setRGB(a[0],a[1],a[2],Cr),Promise.all(s)}}class Qie{constructor(e){this.parser=e,this.name=an.KHR_MATERIALS_IOR}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Kl:null}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return t.ior=void 0!==s.ior?s.ior:1.5,Promise.resolve()}}class ere{constructor(e){this.parser=e,this.name=an.KHR_MATERIALS_SPECULAR}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Kl:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.specularIntensity=void 0!==o.specularFactor?o.specularFactor:1,void 0!==o.specularTexture&&s.push(i.assignTexture(t,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return t.specularColor=(new je).setRGB(a[0],a[1],a[2],Cr),void 0!==o.specularColorTexture&&s.push(i.assignTexture(t,"specularColorMap",o.specularColorTexture,ui)),Promise.all(s)}}class tre{constructor(e){this.parser=e,this.name=an.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Kl:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.anisotropyStrength&&(t.anisotropy=o.anisotropyStrength),void 0!==o.anisotropyRotation&&(t.anisotropyRotation=o.anisotropyRotation),void 0!==o.anisotropyTexture&&s.push(i.assignTexture(t,"anisotropyMap",o.anisotropyTexture)),Promise.all(s)}}class nre{constructor(e){this.parser=e,this.name=an.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,i=t.json,r=i.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,o)}}class ire{constructor(e){this.parser=e,this.name=an.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let l=i.textureLoader;if(a.uri){const c=i.options.manager.getHandler(a.uri);null!==c&&(l=c)}return this.detectSupport().then(function(c){if(c)return i.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class rre{constructor(e){this.parser=e,this.name=an.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let l=i.textureLoader;if(a.uri){const c=i.options.manager.getHandler(a.uri);null!==c&&(l=c)}return this.detectSupport().then(function(c){if(c)return i.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class sre{constructor(e){this.name=an.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){const r=i.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(a){const d=r.count,h=r.byteStride,p=new Uint8Array(a,r.byteOffset||0,r.byteLength||0);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(d,h,p,r.mode,r.filter).then(function(m){return m.buffer}):o.ready.then(function(){const m=new ArrayBuffer(d*h);return o.decodeGltfBuffer(new Uint8Array(m),d,h,p,r.mode,r.filter),m})})}return null}}class ore{constructor(e){this.name=an.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,i=t.nodes[e];if(!i.extensions||!i.extensions[this.name]||void 0===i.mesh)return null;const r=t.meshes[i.mesh];for(const c of r.primitives)if(c.mode!==To.TRIANGLES&&c.mode!==To.TRIANGLE_STRIP&&c.mode!==To.TRIANGLE_FAN&&void 0!==c.mode)return null;const o=i.extensions[this.name].attributes,a=[],l={};for(const c in o)a.push(this.parser.getDependency("accessor",o[c]).then(d=>(l[c]=d,l[c])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(c=>{const d=c.pop(),h=d.isGroup?d.children:[d],p=c[0].count,m=[];for(const g of h){const b=new bt,v=new N,y=new Bn,w=new N(1,1,1),E=new gV(g.geometry,g.material,p);for(let x=0;x<p;x++)l.TRANSLATION&&v.fromBufferAttribute(l.TRANSLATION,x),l.ROTATION&&y.fromBufferAttribute(l.ROTATION,x),l.SCALE&&w.fromBufferAttribute(l.SCALE,x),E.setMatrixAt(x,b.compose(v,y,w));for(const x in l)"TRANSLATION"!==x&&"ROTATION"!==x&&"SCALE"!==x&&g.geometry.setAttribute(x,l[x]);vi.prototype.copy.call(E,g),this.parser.assignFinalMaterial(E),m.push(E)}return d.isGroup?(d.clear(),d.add(...m),d):m[0]}))}}const xH="glTF";class are{constructor(e){this.name=an.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12),i=new TextDecoder;if(this.header={magic:i.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==xH)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-12,s=new DataView(e,12);let o=0;for(;o<r;){const a=s.getUint32(o,!0);o+=4;const l=s.getUint32(o,!0);if(o+=4,1313821514===l){const c=new Uint8Array(e,12+o,a);this.content=i.decode(c)}else if(5130562===l){const c=12+o;this.body=e.slice(c,c+a)}o+=a}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class lre{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=an.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const i=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},l={},c={};for(const d in o){const h=OI[d]||d.toLowerCase();a[h]=o[d]}for(const d in e.attributes){const h=OI[d]||d.toLowerCase();if(void 0!==o[d]){const p=i.accessors[e.attributes[d]];c[h]=Am[p.componentType].name,l[h]=!0===p.normalized}}return t.getDependency("bufferView",s).then(function(d){return new Promise(function(h){r.decodeDracoFile(d,function(p){for(const m in p.attributes){const b=l[m];void 0!==b&&(p.attributes[m].normalized=b)}h(p)},a,c)})})}}class cre{constructor(){this.name=an.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(void 0===t.texCoord||t.texCoord===e.channel)&&void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.texCoord&&(e.channel=t.texCoord),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class ure{constructor(){this.name=an.KHR_MESH_QUANTIZATION}}class CH extends uv{constructor(e,t,i,r){super(e,t,i,r)}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let o=0;o!==r;o++)t[o]=i[s+o];return t}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=2*a,c=3*a,d=r-t,h=(i-t)/d,p=h*h,m=p*h,g=e*c,b=g-c,v=-2*m+3*p,y=m-p,w=1-v,E=y-p+h;for(let x=0;x!==a;x++)s[x]=w*o[b+x+a]+E*(o[b+x+l]*d)+v*o[g+x+a]+y*(o[g+x]*d);return s}}const dre=new Bn;class hre extends CH{interpolate_(e,t,i,r){const s=super.interpolate_(e,t,i,r);return dre.fromArray(s).normalize().toArray(s),s}}const To={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Am={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},TH={9728:Ni,9729:_i,9984:1004,9985:1007,9986:1005,9987:Vl},AH={33071:Vr,33648:1002,10497:Od},LI={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},OI={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},vu={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},fre={CUBICSPLINE:void 0,LINEAR:Bp,STEP:Vy};function oh(n,e,t){for(const i in t.extensions)void 0===n[i]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=t.extensions[i])}function bu(n,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(n.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function gre(n,e){if(n.updateMorphTargets(),void 0!==e.weights)for(let t=0,i=e.weights.length;t<i;t++)n.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(n.morphTargetInfluences.length===t.length){n.morphTargetDictionary={};for(let i=0,r=t.length;i<r;i++)n.morphTargetDictionary[t[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function _re(n){let e;const t=n.extensions&&n.extensions[an.KHR_DRACO_MESH_COMPRESSION];if(e=t?"draco:"+t.bufferView+":"+t.indices+":"+kI(t.attributes):n.indices+":"+kI(n.attributes)+":"+n.mode,void 0!==n.targets)for(let i=0,r=n.targets.length;i<r;i++)e+=":"+kI(n.targets[i]);return e}function kI(n){let e="";const t=Object.keys(n).sort();for(let i=0,r=t.length;i<r;i++)e+=t[i]+":"+n[t[i]]+";";return e}function UI(n){switch(n){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const vre=new bt;class bre{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new Wie,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,r=!1,s=-1;typeof navigator<"u"&&(i=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),r=navigator.userAgent.indexOf("Firefox")>-1,s=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),this.textureLoader=typeof createImageBitmap>"u"||i||r&&s<98?new $V(this.options.manager):new Sie(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Co(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const i=this,r=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(o){const a={scene:o[0][r.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:r.asset,parser:i,userData:{}};return oh(s,a,r),bu(a,r),Promise.all(i._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){e(a)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){const o=t[r].joints;for(let a=0,l=o.length;a<l;a++)e[o[a]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const o=e[r];void 0!==o.mesh&&(this._addNodeRef(this.meshCache,o.mesh),void 0!==o.skin&&(i[o.mesh].isSkinnedMesh=!0)),void 0!==o.camera&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;const r=i.clone(),s=(o,a)=>{const l=this.associations.get(o);null!=l&&this.associations.set(a,l);for(const[c,d]of o.children.entries())s(d,a.children[c])};return s(i,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){const r=e(t[i]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const i=[];for(let r=0;r<t.length;r++){const s=e(t[r]);s&&i.push(s)}return i}getDependency(e,t){const i=e+":"+t;let r=this.cache.get(i);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!r)throw new Error("Unknown type: "+e)}this.cache.add(i,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const i=this;t=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map(function(s,o){return i.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],i=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[an.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,o){i.load(fv.resolveURL(t.uri,r.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(i){const s=t.byteOffset||0;return i.slice(s,s+(t.byteLength||0))})}loadAccessor(e){const t=this,i=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse){const o=LI[r.type],l=!0===r.normalized,c=new(0,Am[r.componentType])(r.count*o);return Promise.resolve(new ti(c,o,l))}const s=[];return s.push(void 0!==r.bufferView?this.getDependency("bufferView",r.bufferView):null),void 0!==r.sparse&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(o){const a=o[0],l=LI[r.type],c=Am[r.componentType],d=c.BYTES_PER_ELEMENT,p=r.byteOffset||0,m=void 0!==r.bufferView?i.bufferViews[r.bufferView].byteStride:void 0,g=!0===r.normalized;let b,v;if(m&&m!==d*l){const y=Math.floor(p/m),w="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+y+":"+r.count;let E=t.cache.get(w);E||(b=new c(a,y*m,r.count*m/d),E=new j1(b,m/d),t.cache.add(w,E)),v=new Yd(E,l,p%m/d,g)}else b=null===a?new c(r.count*l):new c(a,p,r.count*l),v=new ti(b,l,g);if(void 0!==r.sparse){const x=r.sparse.values.byteOffset||0,C=new(0,Am[r.sparse.indices.componentType])(o[1],r.sparse.indices.byteOffset||0,r.sparse.count*LI.SCALAR),A=new c(o[2],x,r.sparse.count*l);null!==a&&(v=new ti(v.array.slice(),v.itemSize,v.normalized));for(let D=0,O=C.length;D<O;D++){const T=C[D];if(v.setX(T,A[D*l]),l>=2&&v.setY(T,A[D*l+1]),l>=3&&v.setZ(T,A[D*l+2]),l>=4&&v.setW(T,A[D*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return v})}loadTexture(e){const t=this.json,s=t.textures[e].source,o=t.images[s];let a=this.textureLoader;if(o.uri){const l=this.options.manager.getHandler(o.uri);null!==l&&(a=l)}return this.loadTextureImage(e,s,a)}loadTextureImage(e,t,i){const r=this,s=this.json,o=s.textures[e],a=s.images[t],l=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[l])return this.textureCache[l];const c=this.loadImageSource(t,i).then(function(d){d.flipY=!1,d.name=o.name||a.name||"",""===d.name&&"string"==typeof a.uri&&!1===a.uri.startsWith("data:image/")&&(d.name=a.uri);const p=(s.samplers||{})[o.sampler]||{};return d.magFilter=TH[p.magFilter]||_i,d.minFilter=TH[p.minFilter]||Vl,d.wrapS=AH[p.wrapS]||Od,d.wrapT=AH[p.wrapT]||Od,r.associations.set(d,{textures:e}),d}).catch(function(){return null});return this.textureCache[l]=c,c}loadImageSource(e,t){const r=this.json,s=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(h=>h.clone());const o=r.images[e],a=self.URL||self.webkitURL;let l=o.uri||"",c=!1;if(void 0!==o.bufferView)l=this.getDependency("bufferView",o.bufferView).then(function(h){c=!0;const p=new Blob([h],{type:o.mimeType});return l=a.createObjectURL(p),l});else if(void 0===o.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const d=Promise.resolve(l).then(function(h){return new Promise(function(p,m){let g=p;!0===t.isImageBitmapLoader&&(g=function(b){const v=new oa(b);v.needsUpdate=!0,p(v)}),t.load(fv.resolveURL(h,s.path),g,void 0,m)})}).then(function(h){return!0===c&&a.revokeObjectURL(l),h.userData.mimeType=o.mimeType||function yre(n){return n.search(/\.jpe?g($|\?)/i)>0||0===n.search(/^data\:image\/jpeg/)?"image/jpeg":n.search(/\.webp($|\?)/i)>0||0===n.search(/^data\:image\/webp/)?"image/webp":"image/png"}(o.uri),h}).catch(function(h){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),h});return this.sourceCache[e]=d,d}assignTexture(e,t,i,r){const s=this;return this.getDependency("texture",i.index).then(function(o){if(!o)return null;if(void 0!==i.texCoord&&i.texCoord>0&&((o=o.clone()).channel=i.texCoord),s.extensions[an.KHR_TEXTURE_TRANSFORM]){const a=void 0!==i.extensions?i.extensions[an.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const l=s.associations.get(o);o=s.extensions[an.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),s.associations.set(o,l)}}return void 0!==r&&(o.colorSpace=r),e[t]=o,o})}assignFinalMaterial(e){const t=e.geometry;let i=e.material;const r=void 0===t.attributes.tangent,s=void 0!==t.attributes.color,o=void 0===t.attributes.normal;if(e.isPoints){const a="PointsMaterial:"+i.uuid;let l=this.cache.get(a);l||(l=new Zd,hs.prototype.copy.call(l,i),l.color.copy(i.color),l.map=i.map,l.sizeAttenuation=!1,this.cache.add(a,l)),i=l}else if(e.isLine){const a="LineBasicMaterial:"+i.uuid;let l=this.cache.get(a);l||(l=new mr,hs.prototype.copy.call(l,i),l.color.copy(i.color),l.map=i.map,this.cache.add(a,l)),i=l}if(r||s||o){let a="ClonedMaterial:"+i.uuid+":";r&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=i.clone(),s&&(l.vertexColors=!0),o&&(l.flatShading=!0),r&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(i))),i=l}e.material=i}getMaterialType(){return Em}loadMaterial(e){const t=this,r=this.extensions,s=this.json.materials[e];let o;const a={},c=[];if((s.extensions||{})[an.KHR_MATERIALS_UNLIT]){const h=r[an.KHR_MATERIALS_UNLIT];o=h.getMaterialType(),c.push(h.extendParams(a,s,t))}else{const h=s.pbrMetallicRoughness||{};if(a.color=new je(1,1,1),a.opacity=1,Array.isArray(h.baseColorFactor)){const p=h.baseColorFactor;a.color.setRGB(p[0],p[1],p[2],Cr),a.opacity=p[3]}void 0!==h.baseColorTexture&&c.push(t.assignTexture(a,"map",h.baseColorTexture,ui)),a.metalness=void 0!==h.metallicFactor?h.metallicFactor:1,a.roughness=void 0!==h.roughnessFactor?h.roughnessFactor:1,void 0!==h.metallicRoughnessTexture&&(c.push(t.assignTexture(a,"metalnessMap",h.metallicRoughnessTexture)),c.push(t.assignTexture(a,"roughnessMap",h.metallicRoughnessTexture))),o=this._invokeOne(function(p){return p.getMaterialType&&p.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(p){return p.extendMaterialParams&&p.extendMaterialParams(e,a)})))}!0===s.doubleSided&&(a.side=2);const d=s.alphaMode||"OPAQUE";if("BLEND"===d?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,"MASK"===d&&(a.alphaTest=void 0!==s.alphaCutoff?s.alphaCutoff:.5)),void 0!==s.normalTexture&&o!==bi&&(c.push(t.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new fe(1,1),void 0!==s.normalTexture.scale)){const h=s.normalTexture.scale;a.normalScale.set(h,h)}if(void 0!==s.occlusionTexture&&o!==bi&&(c.push(t.assignTexture(a,"aoMap",s.occlusionTexture)),void 0!==s.occlusionTexture.strength&&(a.aoMapIntensity=s.occlusionTexture.strength)),void 0!==s.emissiveFactor&&o!==bi){const h=s.emissiveFactor;a.emissive=(new je).setRGB(h[0],h[1],h[2],Cr)}return void 0!==s.emissiveTexture&&o!==bi&&c.push(t.assignTexture(a,"emissiveMap",s.emissiveTexture,ui)),Promise.all(c).then(function(){const h=new o(a);return s.name&&(h.name=s.name),bu(h,s),t.associations.set(h,{materials:e}),s.extensions&&oh(r,h,s),h})}createUniqueName(e){const t=Yn.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,i=this.extensions,r=this.primitiveCache;function s(a){return i[an.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(l){return DH(l,a,t)})}const o=[];for(let a=0,l=e.length;a<l;a++){const c=e[a],d=_re(c),h=r[d];if(h)o.push(h.promise);else{let p;p=c.extensions&&c.extensions[an.KHR_DRACO_MESH_COMPRESSION]?s(c):DH(new Nt,c,t),r[d]={primitive:c,promise:p},o.push(p)}}return Promise.all(o)}loadMesh(e){const t=this,r=this.extensions,s=this.json.meshes[e],o=s.primitives,a=[];for(let l=0,c=o.length;l<c;l++){const d=void 0===o[l].material?(void 0===(n=this.cache).DefaultMaterial&&(n.DefaultMaterial=new Em({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:0})),n.DefaultMaterial):this.getDependency("material",o[l].material);a.push(d)}var n;return a.push(t.loadGeometries(o)),Promise.all(a).then(function(l){const c=l.slice(0,l.length-1),d=l[l.length-1],h=[];for(let m=0,g=d.length;m<g;m++){const b=d[m],v=o[m];let y;const w=c[m];if(v.mode===To.TRIANGLES||v.mode===To.TRIANGLE_STRIP||v.mode===To.TRIANGLE_FAN||void 0===v.mode)y=!0===s.isSkinnedMesh?new hV(b,w):new Ce(b,w),!0===y.isSkinnedMesh&&y.normalizeSkinWeights(),v.mode===To.TRIANGLE_STRIP?y.geometry=EH(y.geometry,1):v.mode===To.TRIANGLE_FAN&&(y.geometry=EH(y.geometry,2));else if(v.mode===To.LINES)y=new ym(b,w);else if(v.mode===To.LINE_STRIP)y=new Gr(b,w);else if(v.mode===To.LINE_LOOP)y=new EV(b,w);else{if(v.mode!==To.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+v.mode);y=new rv(b,w)}Object.keys(y.geometry.morphAttributes).length>0&&gre(y,s),y.name=t.createUniqueName(s.name||"mesh_"+e),bu(y,s),v.extensions&&oh(r,y,v),t.assignFinalMaterial(y),h.push(y)}for(let m=0,g=h.length;m<g;m++)t.associations.set(h[m],{meshes:e,primitives:m});if(1===h.length)return s.extensions&&oh(r,h[0],s),h[0];const p=new $a;s.extensions&&oh(r,p,s),t.associations.set(p,{meshes:e});for(let m=0,g=h.length;m<g;m++)p.add(h[m]);return p})}loadCamera(e){let t;const i=this.json.cameras[e],r=i[i.type];if(r)return"perspective"===i.type?t=new nr(au_radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===i.type&&(t=new pS(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),bu(t,i),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],i=[];for(let r=0,s=t.joints.length;r<s;r++)i.push(this._loadNodeShallow(t.joints[r]));return i.push(void 0!==t.inverseBindMatrices?this.getDependency("accessor",t.inverseBindMatrices):null),Promise.all(i).then(function(r){const s=r.pop(),o=r,a=[],l=[];for(let c=0,d=o.length;c<d;c++){const h=o[c];if(h){a.push(h);const p=new bt;null!==s&&p.fromArray(s.array,16*c),l.push(p)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[c])}return new SS(a,l)})}loadAnimation(e){const i=this,r=this.json.animations[e],s=r.name?r.name:"animation_"+e,o=[],a=[],l=[],c=[],d=[];for(let h=0,p=r.channels.length;h<p;h++){const m=r.channels[h],g=r.samplers[m.sampler],b=m.target,y=void 0!==r.parameters?r.parameters[g.input]:g.input,w=void 0!==r.parameters?r.parameters[g.output]:g.output;void 0!==b.node&&(o.push(this.getDependency("node",b.node)),a.push(this.getDependency("accessor",y)),l.push(this.getDependency("accessor",w)),c.push(g),d.push(b))}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l),Promise.all(c),Promise.all(d)]).then(function(h){const p=h[0],m=h[1],g=h[2],b=h[3],v=h[4],y=[];for(let w=0,E=p.length;w<E;w++){const x=p[w],C=m[w],A=g[w],D=b[w],O=v[w];if(void 0===x)continue;x.updateMatrix&&x.updateMatrix();const T=i._createAnimationTracks(x,C,A,D,O);if(T)for(let L=0;L<T.length;L++)y.push(T[L])}return new dv(s,void 0,y)})}createNodeMesh(e){const i=this,r=this.json.nodes[e];return void 0===r.mesh?null:i.getDependency("mesh",r.mesh).then(function(s){const o=i._getNodeRef(i.meshCache,r.mesh,s);return void 0!==r.weights&&o.traverse(function(a){if(a.isMesh)for(let l=0,c=r.weights.length;l<c;l++)a.morphTargetInfluences[l]=r.weights[l]}),o})}loadNode(e){const i=this,r=this.json.nodes[e],s=i._loadNodeShallow(e),o=[],a=r.children||[];for(let c=0,d=a.length;c<d;c++)o.push(i.getDependency("node",a[c]));const l=void 0===r.skin?Promise.resolve(null):i.getDependency("skin",r.skin);return Promise.all([s,Promise.all(o),l]).then(function(c){const d=c[0],h=c[1],p=c[2];null!==p&&d.traverse(function(m){m.isSkinnedMesh&&m.bind(p,vre)});for(let m=0,g=h.length;m<g;m++)d.add(h[m]);return d})}_loadNodeShallow(e){const i=this.extensions,r=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];const s=this.json.nodes[e],o=s.name?r.createUniqueName(s.name):"",a=[],l=r._invokeOne(function(c){return c.createNodeMesh&&c.createNodeMesh(e)});return l&&a.push(l),void 0!==s.camera&&a.push(r.getDependency("camera",s.camera).then(function(c){return r._getNodeRef(r.cameraCache,s.camera,c)})),r._invokeAll(function(c){return c.createNodeAttachment&&c.createNodeAttachment(e)}).forEach(function(c){a.push(c)}),this.nodeCache[e]=Promise.all(a).then(function(c){let d;if(d=!0===s.isBone?new Y1:c.length>1?new $a:1===c.length?c[0]:new vi,d!==c[0])for(let h=0,p=c.length;h<p;h++)d.add(c[h]);if(s.name&&(d.userData.name=s.name,d.name=o),bu(d,s),s.extensions&&oh(i,d,s),void 0!==s.matrix){const h=new bt;h.fromArray(s.matrix),d.applyMatrix4(h)}else void 0!==s.translation&&d.position.fromArray(s.translation),void 0!==s.rotation&&d.quaternion.fromArray(s.rotation),void 0!==s.scale&&d.scale.fromArray(s.scale);return r.associations.has(d)||r.associations.set(d,{}),r.associations.get(d).nodes=e,d}),this.nodeCache[e]}loadScene(e){const t=this.extensions,i=this.json.scenes[e],r=this,s=new $a;i.name&&(s.name=r.createUniqueName(i.name)),bu(s,i),i.extensions&&oh(t,s,i);const o=i.nodes||[],a=[];for(let l=0,c=o.length;l<c;l++)a.push(r.getDependency("node",o[l]));return Promise.all(a).then(function(l){for(let d=0,h=l.length;d<h;d++)s.add(l[d]);return r.associations=(d=>{const h=new Map;for(const[p,m]of r.associations)(p instanceof hs||p instanceof oa)&&h.set(p,m);return d.traverse(p=>{const m=r.associations.get(p);null!=m&&h.set(p,m)}),h})(s),s})}_createAnimationTracks(e,t,i,r,s){const o=[],a=e.name?e.name:e.uuid,l=[];let c;switch(vu[s.path]===vu.weights?e.traverse(function(p){p.morphTargetInfluences&&l.push(p.name?p.name:p.uuid)}):l.push(a),vu[s.path]){case vu.weights:c=xm;break;case vu.rotation:c=eh;break;case vu.position:case vu.scale:c=Cm;break;default:c=1===i.itemSize?xm:Cm}const d=void 0!==r.interpolation?fre[r.interpolation]:Bp,h=this._getArrayFromAccessor(i);for(let p=0,m=l.length;p<m;p++){const g=new c(l[p]+"."+vu[s.path],t.array,h,d);"CUBICSPLINE"===r.interpolation&&this._createCubicSplineTrackInterpolant(g),o.push(g)}return o}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const i=UI(t.constructor),r=new Float32Array(t.length);for(let s=0,o=t.length;s<o;s++)r[s]=t[s]*i;t=r}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(i){return new(this instanceof eh?hre:CH)(this.times,this.values,this.getValueSize()/3,i)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function DH(n,e,t){const i=e.attributes,r=[];function s(o,a){return t.getDependency("accessor",o).then(function(l){n.setAttribute(a,l)})}for(const o in i){const a=OI[o]||o.toLowerCase();a in n.attributes||r.push(s(i[o],a))}if(void 0!==e.indices&&!n.index){const o=t.getDependency("accessor",e.indices).then(function(a){n.setIndex(a)});r.push(o)}return En.workingColorSpace!==Cr&&"COLOR_0"in i&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${En.workingColorSpace}" not supported.`),bu(n,e),function wre(n,e,t){const i=e.attributes,r=new Wa;if(void 0===i.POSITION)return;{const a=t.json.accessors[i.POSITION],l=a.min,c=a.max;if(void 0===l||void 0===c)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(r.set(new N(l[0],l[1],l[2]),new N(c[0],c[1],c[2])),a.normalized){const d=UI(Am[a.componentType]);r.min.multiplyScalar(d),r.max.multiplyScalar(d)}}const s=e.targets;if(void 0!==s){const a=new N,l=new N;for(let c=0,d=s.length;c<d;c++){const h=s[c];if(void 0!==h.POSITION){const p=t.json.accessors[h.POSITION],m=p.min,g=p.max;if(void 0!==m&&void 0!==g){if(l.setX(Math.max(Math.abs(m[0]),Math.abs(g[0]))),l.setY(Math.max(Math.abs(m[1]),Math.abs(g[1]))),l.setZ(Math.max(Math.abs(m[2]),Math.abs(g[2]))),p.normalized){const b=UI(Am[p.componentType]);l.multiplyScalar(b)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(a)}n.boundingBox=r;const o=new aa;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,n.boundingSphere=o}(n,e,t),Promise.all(r).then(function(){return void 0!==e.targets?function mre(n,e,t){let i=!1,r=!1,s=!1;for(let c=0,d=e.length;c<d;c++){const h=e[c];if(void 0!==h.POSITION&&(i=!0),void 0!==h.NORMAL&&(r=!0),void 0!==h.COLOR_0&&(s=!0),i&&r&&s)break}if(!i&&!r&&!s)return Promise.resolve(n);const o=[],a=[],l=[];for(let c=0,d=e.length;c<d;c++){const h=e[c];if(i){const p=void 0!==h.POSITION?t.getDependency("accessor",h.POSITION):n.attributes.position;o.push(p)}if(r){const p=void 0!==h.NORMAL?t.getDependency("accessor",h.NORMAL):n.attributes.normal;a.push(p)}if(s){const p=void 0!==h.COLOR_0?t.getDependency("accessor",h.COLOR_0):n.attributes.color;l.push(p)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(c){const h=c[1],p=c[2];return i&&(n.morphAttributes.position=c[0]),r&&(n.morphAttributes.normal=h),s&&(n.morphAttributes.color=p),n.morphTargetsRelative=!0,n})}(n,e.targets,t):n})}var IH=class{target;name;intersected;wasIntersected=!1;distance;constructor(n,e){this.target=n,this.name=e,this.intersected=!1,this.distance=0}},Ps=class{type;cancelBubble;originalEvent;coords=new fe(0,0);distance=0;intersected=!1;constructor(n,e=null){this.cancelBubble=!1,this.type=n,this.originalEvent=e}stopPropagation(){this.cancelBubble=!0}},Dm=fh(990);class mv{constructor(e,t,i){this.x=e,this.y=t,this.z=i}static FromJson(e){return new mv(e.x,e.y,e.z)}}let RH=(()=>{class n{static createButton(t){const i=document.createElement("button");function s(){i.style.display="",i.style.cursor="auto",i.style.left="calc(50% - 75px)",i.style.width="150px",i.onmouseenter=null,i.onmouseleave=null,i.onclick=null}function l(c){c.style.position="absolute",c.style.bottom="20px",c.style.padding="12px 6px",c.style.border="1px solid #fff",c.style.borderRadius="4px",c.style.background="rgba(0,0,0,0.1)",c.style.color="#fff",c.style.font="normal 13px sans-serif",c.style.textAlign="center",c.style.opacity="0.5",c.style.outline="none",c.style.zIndex="999"}if("xr"in navigator)return i.id="VRButton",i.style.display="none",l(i),navigator.xr.isSessionSupported("immersive-vr").then(function(c){c?function r(){let c=null;function d(m){return h.apply(this,arguments)}function h(){return(h=Rn(function*(m){m.addEventListener("end",p),yield t.xr.setSession(m),i.textContent="EXIT VR",c=m})).apply(this,arguments)}function p(){c.removeEventListener("end",p),i.textContent="ENTER VR",c=null}i.style.display="",i.style.cursor="pointer",i.style.left="calc(50% - 50px)",i.style.width="100px",i.textContent="ENTER VR",i.onmouseenter=function(){i.style.opacity="1.0"},i.onmouseleave=function(){i.style.opacity="0.5"},i.onclick=function(){null===c?navigator.xr.requestSession("immersive-vr",{optionalFeatures:["local-floor","bounded-floor","hand-tracking","layers"]}).then(d):c.end()}}():function o(){s(),i.textContent="VR NOT SUPPORTED"}(),c&&n.xrSessionIsGranted&&i.click()}).catch(function a(c){s(),console.warn("Exception when trying to call xr.isSessionSupported",c),i.textContent="VR NOT ALLOWED"}),i;{const c=document.createElement("a");return!1===window.isSecureContext?(c.href=document.location.href.replace(/^http:/,"https:"),c.innerHTML="WEBXR NEEDS HTTPS"):(c.href="https://immersiveweb.dev/",c.innerHTML="WEBXR NOT AVAILABLE"),c.style.left="calc(50% - 90px)",c.style.width="180px",c.style.textDecoration="none",l(c),c}}static registerSessionGrantedListener(){if("xr"in navigator){if(/WebXRViewer\//i.test(navigator.userAgent))return;navigator.xr.addEventListener("sessiongranted",()=>{n.xrSessionIsGranted=!0})}}}return n.xrSessionIsGranted=!1,n})();RH.registerSessionGrantedListener();var n,Im=Object.freeze({Linear:Object.freeze({None:function(n){return n},In:function(n){return this.None(n)},Out:function(n){return this.None(n)},InOut:function(n){return this.None(n)}}),Quadratic:Object.freeze({In:function(n){return n*n},Out:function(n){return n*(2-n)},InOut:function(n){return(n*=2)<1?.5*n*n:-.5*(--n*(n-2)-1)}}),Cubic:Object.freeze({In:function(n){return n*n*n},Out:function(n){return--n*n*n+1},InOut:function(n){return(n*=2)<1?.5*n*n*n:.5*((n-=2)*n*n+2)}}),Quartic:Object.freeze({In:function(n){return n*n*n*n},Out:function(n){return 1- --n*n*n*n},InOut:function(n){return(n*=2)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2)}}),Quintic:Object.freeze({In:function(n){return n*n*n*n*n},Out:function(n){return--n*n*n*n*n+1},InOut:function(n){return(n*=2)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2)}}),Sinusoidal:Object.freeze({In:function(n){return 1-Math.sin((1-n)*Math.PI/2)},Out:function(n){return Math.sin(n*Math.PI/2)},InOut:function(n){return.5*(1-Math.sin(Math.PI*(.5-n)))}}),Exponential:Object.freeze({In:function(n){return 0===n?0:Math.pow(1024,n-1)},Out:function(n){return 1===n?1:1-Math.pow(2,-10*n)},InOut:function(n){return 0===n?0:1===n?1:(n*=2)<1?.5*Math.pow(1024,n-1):.5*(2-Math.pow(2,-10*(n-1)))}}),Circular:Object.freeze({In:function(n){return 1-Math.sqrt(1-n*n)},Out:function(n){return Math.sqrt(1- --n*n)},InOut:function(n){return(n*=2)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1)}}),Elastic:Object.freeze({In:function(n){return 0===n?0:1===n?1:-Math.pow(2,10*(n-1))*Math.sin(5*(n-1.1)*Math.PI)},Out:function(n){return 0===n?0:1===n?1:Math.pow(2,-10*n)*Math.sin(5*(n-.1)*Math.PI)+1},InOut:function(n){return 0===n?0:1===n?1:(n*=2)<1?-.5*Math.pow(2,10*(n-1))*Math.sin(5*(n-1.1)*Math.PI):.5*Math.pow(2,-10*(n-1))*Math.sin(5*(n-1.1)*Math.PI)+1}}),Back:Object.freeze({In:function(n){var e=1.70158;return 1===n?1:n*n*((e+1)*n-e)},Out:function(n){var e=1.70158;return 0===n?0:--n*n*((e+1)*n+e)+1},InOut:function(n){var e=2.5949095;return(n*=2)<1?n*n*((e+1)*n-e)*.5:.5*((n-=2)*n*((e+1)*n+e)+2)}}),Bounce:Object.freeze({In:function(n){return 1-Im.Bounce.Out(1-n)},Out:function(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},InOut:function(n){return n<.5?.5*Im.Bounce.In(2*n):.5*Im.Bounce.Out(2*n-1)+.5}}),generatePow:function(n){return void 0===n&&(n=4),n=(n=n<Number.EPSILON?Number.EPSILON:n)>1e4?1e4:n,{In:function(e){return Math.pow(e,n)},Out:function(e){return 1-Math.pow(1-e,n)},InOut:function(e){return e<.5?Math.pow(2*e,n)/2:(1-Math.pow(2-2*e,n))/2+.5}}}}),Rm=function(){return performance.now()},PH=function(){function n(){this._tweens={},this._tweensAddedDuringUpdate={}}return n.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map(function(t){return e._tweens[t]})},n.prototype.removeAll=function(){this._tweens={}},n.prototype.add=function(e){this._tweens[e.getId()]=e,this._tweensAddedDuringUpdate[e.getId()]=e},n.prototype.remove=function(e){delete this._tweens[e.getId()],delete this._tweensAddedDuringUpdate[e.getId()]},n.prototype.update=function(e,t){void 0===e&&(e=Rm()),void 0===t&&(t=!1);var i=Object.keys(this._tweens);if(0===i.length)return!1;for(;i.length>0;){this._tweensAddedDuringUpdate={};for(var r=0;r<i.length;r++){var s=this._tweens[i[r]];s&&!1===s.update(e,!t)&&!t&&delete this._tweens[i[r]]}i=Object.keys(this._tweensAddedDuringUpdate)}return!0},n}(),ah={Linear:function(n,e){var t=n.length-1,i=t*e,r=Math.floor(i),s=ah.Utils.Linear;return e<0?s(n[0],n[1],i):e>1?s(n[t],n[t-1],t-i):s(n[r],n[r+1>t?t:r+1],i-r)},Bezier:function(n,e){for(var t=0,i=n.length-1,r=Math.pow,s=ah.Utils.Bernstein,o=0;o<=i;o++)t+=r(1-e,i-o)*r(e,o)*n[o]*s(i,o);return t},CatmullRom:function(n,e){var t=n.length-1,i=t*e,r=Math.floor(i),s=ah.Utils.CatmullRom;return n[0]===n[t]?(e<0&&(r=Math.floor(i=t*(1+e))),s(n[(r-1+t)%t],n[r],n[(r+1)%t],n[(r+2)%t],i-r)):e<0?n[0]-(s(n[0],n[0],n[1],n[1],-i)-n[0]):e>1?n[t]-(s(n[t],n[t],n[t-1],n[t-1],i-t)-n[t]):s(n[r?r-1:0],n[r],n[t<r+1?t:r+1],n[t<r+2?t:r+2],i-r)},Utils:{Linear:function(n,e,t){return(e-n)*t+n},Bernstein:function(n,e){var t=ah.Utils.Factorial;return t(n)/t(e)/t(n-e)},Factorial:(n=[1],function(e){var t=1;if(n[e])return n[e];for(var i=e;i>1;i--)t*=i;return n[e]=t,t}),CatmullRom:function(n,e,t,i,r){var s=.5*(t-n),o=.5*(i-e),a=r*r;return(2*e-2*t+s+o)*(r*a)+(-3*e+3*t-2*s-o)*a+s*r+e}}},BI=function(){function n(){}return n.nextId=function(){return n._nextId++},n._nextId=0,n}(),VI=new PH,qS=function(){function n(e,t){void 0===t&&(t=VI),this._object=e,this._group=t,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=Im.Linear.None,this._interpolationFunction=ah.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=BI.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1}return n.prototype.getId=function(){return this._id},n.prototype.isPlaying=function(){return this._isPlaying},n.prototype.isPaused=function(){return this._isPaused},n.prototype.to=function(e,t){if(void 0===t&&(t=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=t,this},n.prototype.duration=function(e){return void 0===e&&(e=1e3),this._duration=e,this},n.prototype.dynamic=function(e){return void 0===e&&(e=!1),this._isDynamic=e,this},n.prototype.start=function(e,t){if(void 0===e&&(e=Rm()),void 0===t&&(t=!1),this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed)for(var i in this._reversed=!1,this._valuesStartRepeat)this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i];if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||t){if(this._propertiesAreSetUp=!0,!this._isDynamic){var r={};for(var s in this._valuesEnd)r[s]=this._valuesEnd[s];this._valuesEnd=r}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,t)}return this},n.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},n.prototype._setupProperties=function(e,t,i,r,s){for(var o in i){var a=e[o],l=Array.isArray(a),c=l?"array":typeof a,d=!l&&Array.isArray(i[o]);if("undefined"!==c&&"function"!==c){if(d){if(0===(h=i[o]).length)continue;for(var p=[a],m=0,g=h.length;m<g;m+=1){var b=this._handleRelativeValue(a,h[m]);if(isNaN(b)){d=!1,console.warn("Found invalid interpolation list. Skipping.");break}p.push(b)}d&&(i[o]=p)}if("object"!==c&&!l||!a||d)(typeof t[o]>"u"||s)&&(t[o]=a),l||(t[o]*=1),r[o]=d?i[o].slice().reverse():t[o]||0;else{t[o]=l?[]:{};var v=a;for(var y in v)t[o][y]=v[y];r[o]=l?[]:{};var h=i[o];if(!this._isDynamic){var w={};for(var y in h)w[y]=h[y];i[o]=h=w}this._setupProperties(v,t[o],h,r[o],s)}}}},n.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},n.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},n.prototype.pause=function(e){return void 0===e&&(e=Rm()),this._isPaused||!this._isPlaying||(this._isPaused=!0,this._pauseStart=e,this._group&&this._group.remove(this)),this},n.prototype.resume=function(e){return void 0===e&&(e=Rm()),this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this):this},n.prototype.stopChainedTweens=function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop();return this},n.prototype.group=function(e){return void 0===e&&(e=VI),this._group=e,this},n.prototype.delay=function(e){return void 0===e&&(e=0),this._delayTime=e,this},n.prototype.repeat=function(e){return void 0===e&&(e=0),this._initialRepeat=e,this._repeat=e,this},n.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},n.prototype.yoyo=function(e){return void 0===e&&(e=!1),this._yoyo=e,this},n.prototype.easing=function(e){return void 0===e&&(e=Im.Linear.None),this._easingFunction=e,this},n.prototype.interpolation=function(e){return void 0===e&&(e=ah.Linear),this._interpolationFunction=e,this},n.prototype.chain=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._chainedTweens=e,this},n.prototype.onStart=function(e){return this._onStartCallback=e,this},n.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},n.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},n.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},n.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},n.prototype.onStop=function(e){return this._onStopCallback=e,this},n.prototype.update=function(e,t){if(void 0===e&&(e=Rm()),void 0===t&&(t=!0),this._isPaused)return!0;var i,r;if(!this._goToEnd&&!this._isPlaying){if(e>this._startTime+this._duration)return!1;t&&this.start(e,!0)}if(this._goToEnd=!1,e<this._startTime)return!0;!1===this._onStartCallbackFired&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),!1===this._onEveryStartCallbackFired&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0),r=(e-this._startTime)/this._duration;var o=this._easingFunction(r=0===this._duration||r>1?1:r);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,o),this._onUpdateCallback&&this._onUpdateCallback(this._object,r),1===r){if(this._repeat>0){for(i in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat)!this._yoyo&&"string"==typeof this._valuesEnd[i]&&(this._valuesStartRepeat[i]=this._valuesStartRepeat[i]+parseFloat(this._valuesEnd[i])),this._yoyo&&this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i];return this._yoyo&&(this._reversed=!this._reversed),this._startTime=void 0!==this._repeatDelayTime?e+this._repeatDelayTime:e+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var a=0,l=this._chainedTweens.length;a<l;a++)this._chainedTweens[a].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},n.prototype._updateProperties=function(e,t,i,r){for(var s in i)if(void 0!==t[s]){var o=t[s]||0,a=i[s],l=Array.isArray(e[s]),c=Array.isArray(a);!l&&c?e[s]=this._interpolationFunction(a,r):"object"==typeof a&&a?this._updateProperties(e[s],o,a,r):"number"==typeof(a=this._handleRelativeValue(o,a))&&(e[s]=o+(a-o)*r)}},n.prototype._handleRelativeValue=function(e,t){return"string"!=typeof t?t:"+"===t.charAt(0)||"-"===t.charAt(0)?e+parseFloat(t):parseFloat(t)},n.prototype._swapEndStartRepeatValues=function(e){var t=this._valuesStartRepeat[e],i=this._valuesEnd[e];this._valuesStartRepeat[e]="string"==typeof i?this._valuesStartRepeat[e]+parseFloat(i):this._valuesEnd[e],this._valuesEnd[e]=t},n}(),Ya=VI,NH=(Ya.getAll.bind(Ya),Ya.removeAll.bind(Ya),Ya.add.bind(Ya),Ya.remove.bind(Ya),Ya.update.bind(Ya));const Ei={Handedness:Object.freeze({NONE:"none",LEFT:"left",RIGHT:"right"}),ComponentState:Object.freeze({DEFAULT:"default",TOUCHED:"touched",PRESSED:"pressed"}),ComponentProperty:Object.freeze({BUTTON:"button",X_AXIS:"xAxis",Y_AXIS:"yAxis",STATE:"state"}),ComponentType:Object.freeze({TRIGGER:"trigger",SQUEEZE:"squeeze",TOUCHPAD:"touchpad",THUMBSTICK:"thumbstick",BUTTON:"button"}),ButtonTouchThreshold:.05,AxisTouchThreshold:.1,VisualResponseProperty:Object.freeze({TRANSFORM:"transform",VISIBILITY:"visibility"})};function LH(n){return HI.apply(this,arguments)}function HI(){return HI=Rn(function*(n){const e=yield fetch(n);if(e.ok)return e.json();throw new Error(e.statusText)}),HI.apply(this,arguments)}function zI(){return zI=Rn(function*(n){if(!n)throw new Error("No basePath supplied");return yield LH(`${n}/profilesList.json`)}),zI.apply(this,arguments)}function GI(){return GI=Rn(function*(n,e,t=null,i=!0){if(!n)throw new Error("No xrInputSource supplied");if(!e)throw new Error("No basePath supplied");const r=yield function Dre(n){return zI.apply(this,arguments)}(e);let s;if(n.profiles.some(l=>{const c=r[l];return c&&(s={profileId:l,profilePath:`${e}/${c.path}`,deprecated:!!c.deprecated}),!!s}),!s){if(!t)throw new Error("No matching profile name found");const l=r[t];if(!l)throw new Error(`No matching profile name found and default profile "${t}" missing.`);s={profileId:t,profilePath:`${e}/${l.path}`,deprecated:!!l.deprecated}}const o=yield LH(s.profilePath);let a;if(i){let l;if(l="any"===n.handedness?o.layouts[Object.keys(o.layouts)[0]]:o.layouts[n.handedness],!l)throw new Error(`No matching handedness, ${n.handedness}, in profile ${s.profileId}`);l.assetPath&&(a=s.profilePath.replace("profile.json",l.assetPath))}return{profile:o,assetPath:a}}),GI.apply(this,arguments)}const Rre={xAxis:0,yAxis:0,button:0,state:Ei.ComponentState.DEFAULT};class Nre{constructor(e){this.componentProperty=e.componentProperty,this.states=e.states,this.valueNodeName=e.valueNodeName,this.valueNodeProperty=e.valueNodeProperty,this.valueNodeProperty===Ei.VisualResponseProperty.TRANSFORM&&(this.minNodeName=e.minNodeName,this.maxNodeName=e.maxNodeName),this.value=0,this.updateFromComponent(Rre)}updateFromComponent({xAxis:e,yAxis:t,button:i,state:r}){const{normalizedXAxis:s,normalizedYAxis:o}=function Pre(n=0,e=0){let t=n,i=e;if(Math.sqrt(n*n+e*e)>1){const o=Math.atan2(e,n);t=Math.cos(o),i=Math.sin(o)}return{normalizedXAxis:.5*t+.5,normalizedYAxis:.5*i+.5}}(e,t);switch(this.componentProperty){case Ei.ComponentProperty.X_AXIS:this.value=this.states.includes(r)?s:.5;break;case Ei.ComponentProperty.Y_AXIS:this.value=this.states.includes(r)?o:.5;break;case Ei.ComponentProperty.BUTTON:this.value=this.states.includes(r)?i:0;break;case Ei.ComponentProperty.STATE:this.value=this.valueNodeProperty===Ei.VisualResponseProperty.VISIBILITY?this.states.includes(r):this.states.includes(r)?1:0;break;default:throw new Error(`Unexpected visualResponse componentProperty ${this.componentProperty}`)}}}class Lre{constructor(e,t){if(!(e&&t&&t.visualResponses&&t.gamepadIndices&&0!==Object.keys(t.gamepadIndices).length))throw new Error("Invalid arguments supplied");this.id=e,this.type=t.type,this.rootNodeName=t.rootNodeName,this.touchPointNodeName=t.touchPointNodeName,this.visualResponses={},Object.keys(t.visualResponses).forEach(i=>{const r=new Nre(t.visualResponses[i]);this.visualResponses[i]=r}),this.gamepadIndices=Object.assign({},t.gamepadIndices),this.values={state:Ei.ComponentState.DEFAULT,button:void 0!==this.gamepadIndices.button?0:void 0,xAxis:void 0!==this.gamepadIndices.xAxis?0:void 0,yAxis:void 0!==this.gamepadIndices.yAxis?0:void 0}}get data(){return{id:this.id,...this.values}}updateFromGamepad(e){if(this.values.state=Ei.ComponentState.DEFAULT,void 0!==this.gamepadIndices.button&&e.buttons.length>this.gamepadIndices.button){const t=e.buttons[this.gamepadIndices.button];this.values.button=t.value,this.values.button=this.values.button<0?0:this.values.button,this.values.button=this.values.button>1?1:this.values.button,t.pressed||1===this.values.button?this.values.state=Ei.ComponentState.PRESSED:(t.touched||this.values.button>Ei.ButtonTouchThreshold)&&(this.values.state=Ei.ComponentState.TOUCHED)}void 0!==this.gamepadIndices.xAxis&&e.axes.length>this.gamepadIndices.xAxis&&(this.values.xAxis=e.axes[this.gamepadIndices.xAxis],this.values.xAxis=this.values.xAxis<-1?-1:this.values.xAxis,this.values.xAxis=this.values.xAxis>1?1:this.values.xAxis,this.values.state===Ei.ComponentState.DEFAULT&&Math.abs(this.values.xAxis)>Ei.AxisTouchThreshold&&(this.values.state=Ei.ComponentState.TOUCHED)),void 0!==this.gamepadIndices.yAxis&&e.axes.length>this.gamepadIndices.yAxis&&(this.values.yAxis=e.axes[this.gamepadIndices.yAxis],this.values.yAxis=this.values.yAxis<-1?-1:this.values.yAxis,this.values.yAxis=this.values.yAxis>1?1:this.values.yAxis,this.values.state===Ei.ComponentState.DEFAULT&&Math.abs(this.values.yAxis)>Ei.AxisTouchThreshold&&(this.values.state=Ei.ComponentState.TOUCHED)),Object.values(this.visualResponses).forEach(t=>{t.updateFromComponent(this.values)})}}class Ore{constructor(e,t,i){if(!e)throw new Error("No xrInputSource supplied");if(!t)throw new Error("No profile supplied");this.xrInputSource=e,this.assetUrl=i,this.id=t.profileId,this.layoutDescription=t.layouts[e.handedness],this.components={},Object.keys(this.layoutDescription.components).forEach(r=>{this.components[r]=new Lre(r,this.layoutDescription.components[r])}),this.updateFromGamepad()}get gripSpace(){return this.xrInputSource.gripSpace}get targetRaySpace(){return this.xrInputSource.targetRaySpace}get data(){const e=[];return Object.values(this.components).forEach(t=>{e.push(t.data)}),e}updateFromGamepad(){Object.values(this.components).forEach(e=>{e.updateFromGamepad(this.xrInputSource.gamepad)})}}class Ure extends vi{constructor(){super(),this.motionController=null,this.envMap=null}setEnvironmentMap(e){return this.envMap==e||(this.envMap=e,this.traverse(t=>{t.isMesh&&(t.material.envMap=this.envMap,t.material.needsUpdate=!0)})),this}updateMatrixWorld(e){super.updateMatrixWorld(e),this.motionController&&(this.motionController.updateFromGamepad(),Object.values(this.motionController.components).forEach(t=>{Object.values(t.visualResponses).forEach(i=>{const{valueNode:r,minNode:s,maxNode:o,value:a,valueNodeProperty:l}=i;r&&(l===Ei.VisualResponseProperty.VISIBILITY?r.visible=a:l===Ei.VisualResponseProperty.TRANSFORM&&(r.quaternion.slerpQuaternions(s.quaternion,o.quaternion,a),r.position.lerpVectors(s.position,o.position,a)))})}))}}function OH(n,e){(function Bre(n,e){Object.values(n.components).forEach(t=>{const{type:i,touchPointNodeName:r,visualResponses:s}=t;if(i===Ei.ComponentType.TOUCHPAD)if(t.touchPointNode=e.getObjectByName(r),t.touchPointNode){const o=new wm(.001),a=new bi({color:255}),l=new Ce(o,a);t.touchPointNode.add(l)}else console.warn(`Could not find touch dot, ${t.touchPointNodeName}, in touchpad component ${t.id}`);Object.values(s).forEach(o=>{const{valueNodeName:a,minNodeName:l,maxNodeName:c,valueNodeProperty:d}=o;if(d===Ei.VisualResponseProperty.TRANSFORM){if(o.minNode=e.getObjectByName(l),o.maxNode=e.getObjectByName(c),!o.minNode)return void console.warn(`Could not find ${l} in the model`);if(!o.maxNode)return void console.warn(`Could not find ${c} in the model`)}o.valueNode=e.getObjectByName(a),o.valueNode||console.warn(`Could not find ${a} in the model`)})})})(n.motionController,e),n.envMap&&e.traverse(t=>{t.isMesh&&(t.material.envMap=n.envMap,t.material.needsUpdate=!0)}),n.add(e)}class Vre{constructor(e=null){this.gltfLoader=e,this.path="https://cdn.jsdelivr.net/npm/@webxr-input-profiles/assets@1.0/dist/profiles",this._assetCache={},this.gltfLoader||(this.gltfLoader=new SH)}createControllerModel(e){const t=new Ure;let i=null;return e.addEventListener("connected",r=>{const s=r.data;"tracked-pointer"!==s.targetRayMode||!s.gamepad||function Ire(n,e){return GI.apply(this,arguments)}(s,this.path,"generic-trigger").then(({profile:o,assetPath:a})=>{t.motionController=new Ore(s,o,a);const l=this._assetCache[t.motionController.assetUrl];if(l)i=l.scene.clone(),OH(t,i);else{if(!this.gltfLoader)throw new Error("GLTFLoader not set.");this.gltfLoader.setPath(""),this.gltfLoader.load(t.motionController.assetUrl,c=>{this._assetCache[t.motionController.assetUrl]=c,i=c.scene.clone(),OH(t,i)},null,()=>{throw new Error(`Asset ${t.motionController.assetUrl} missing or malformed.`)})}}).catch(o=>{console.warn(o)})}),e.addEventListener("disconnected",()=>{t.motionController=null,t.remove(i),i=null}),t}}let XS=(()=>{class n{constructor(){this.destroy$=new Xr,this.takeUntilDestroy=t=>t.pipe(lU(this.destroy$))}ngOnDestroy(){console.log("UnsubscriberService","ngOnDestroy"),this.destroy$.next(),this.destroy$.complete()}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Ke({token:n,factory:n.\u0275fac})}return n})();class Hre extends yS{constructor(e=null){super();const t=new si;t.deleteAttribute("uv");const i=new Em({side:1}),r=new Em;let s=5;null!==e&&!1===e._useLegacyLights&&(s=900);const o=new SI(16777215,s,28,2);o.position.set(.418,16.199,.3),this.add(o);const a=new Ce(t,i);a.position.set(-.757,13.219,.717),a.scale.set(31.713,28.305,28.591),this.add(a);const l=new Ce(t,r);l.position.set(-10.906,2.009,1.846),l.rotation.set(0,-.195,0),l.scale.set(2.328,7.905,4.651),this.add(l);const c=new Ce(t,r);c.position.set(-5.607,-.754,-.758),c.rotation.set(0,.994,0),c.scale.set(1.97,1.534,3.955),this.add(c);const d=new Ce(t,r);d.position.set(6.167,.857,7.803),d.rotation.set(0,.561,0),d.scale.set(3.927,6.285,3.687),this.add(d);const h=new Ce(t,r);h.position.set(-2.017,.018,6.124),h.rotation.set(0,.333,0),h.scale.set(2.002,4.566,2.064),this.add(h);const p=new Ce(t,r);p.position.set(2.291,-.756,-2.621),p.rotation.set(0,-.286,0),p.scale.set(1.546,1.552,1.496),this.add(p);const m=new Ce(t,r);m.position.set(-2.193,-.369,-5.547),m.rotation.set(0,.516,0),m.scale.set(3.875,3.487,2.986),this.add(m);const g=new Ce(t,Pm(50));g.position.set(-16.116,14.37,8.208),g.scale.set(.1,2.428,2.739),this.add(g);const b=new Ce(t,Pm(50));b.position.set(-16.109,18.021,-8.207),b.scale.set(.1,2.425,2.751),this.add(b);const v=new Ce(t,Pm(17));v.position.set(14.904,12.198,-1.832),v.scale.set(.15,4.265,6.331),this.add(v);const y=new Ce(t,Pm(43));y.position.set(-.462,8.89,14.52),y.scale.set(4.38,5.441,.088),this.add(y);const w=new Ce(t,Pm(20));w.position.set(3.235,11.486,-12.541),w.scale.set(2.5,2,.1),this.add(w);const E=new Ce(t,Pm(100));E.position.set(0,20,0),E.scale.set(1,.1,1),this.add(E)}dispose(){const e=new Set;this.traverse(t=>{t.isMesh&&(e.add(t.geometry),e.add(t.material))});for(const t of e)t.dispose()}}function Pm(n){const e=new bi;return e.color.setScalar(n),e}class zre extends _u{constructor(e){super(e)}load(e,t,i,r){const s=this,o=new Co(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{t(s.parse(a))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}parse(e){function i(c,d,h){for(let p=0,m=c.length;p<m;p++)if(c[p]!==d.getUint8(h+p))return!1;return!0}const l=function a(c){if("string"==typeof c){const d=new Uint8Array(c.length);for(let h=0;h<c.length;h++)d[h]=255&c.charCodeAt(h);return d.buffer||d}return c}(e);return function t(c){const d=new DataView(c);if(84+50*d.getUint32(80,!0)===d.byteLength)return!0;const g=[115,111,108,105,100];for(let b=0;b<5;b++)if(i(g,d,b))return!1;return!0}(l)?function r(c){const d=new DataView(c),h=d.getUint32(80,!0);let p,m,g,v,y,w,E,x,b=!1;for(let X=0;X<70;X++)1129270351==d.getUint32(X,!1)&&82==d.getUint8(X+4)&&61==d.getUint8(X+5)&&(b=!0,v=new Float32Array(3*h*3),y=d.getUint8(X+6)/255,w=d.getUint8(X+7)/255,E=d.getUint8(X+8)/255,x=d.getUint8(X+9)/255);const D=new Nt,O=new Float32Array(3*h*3),T=new Float32Array(3*h*3),L=new je;for(let X=0;X<h;X++){const re=84+50*X,ae=d.getFloat32(re,!0),H=d.getFloat32(re+4,!0),J=d.getFloat32(re+8,!0);if(b){const j=d.getUint16(re+48,!0);32768&j?(p=y,m=w,g=E):(p=(31&j)/31,m=(j>>5&31)/31,g=(j>>10&31)/31)}for(let j=1;j<=3;j++){const $=re+12*j,Q=3*X*3+3*(j-1);O[Q]=d.getFloat32($,!0),O[Q+1]=d.getFloat32($+4,!0),O[Q+2]=d.getFloat32($+8,!0),T[Q]=ae,T[Q+1]=H,T[Q+2]=J,b&&(L.set(p,m,g).convertSRGBToLinear(),v[Q]=L.r,v[Q+1]=L.g,v[Q+2]=L.b)}}return D.setAttribute("position",new ti(O,3)),D.setAttribute("normal",new ti(T,3)),b&&(D.setAttribute("color",new ti(v,3)),D.hasColors=!0,D.alpha=x),D}(l):function s(c){const d=new Nt,h=/solid([\s\S]*?)endsolid/g,p=/facet([\s\S]*?)endfacet/g,m=/solid\s(.+)/;let g=0;const b=/[\s]+([+-]?(?:\d*)(?:\.\d*)?(?:[eE][+-]?\d+)?)/.source,v=new RegExp("vertex"+b+b+b,"g"),y=new RegExp("normal"+b+b+b,"g"),w=[],E=[],x=[],C=new N;let A,D=0,O=0,T=0;for(;null!==(A=h.exec(c));){O=T;const L=A[0],X=null!==(A=m.exec(L))?A[1]:"";for(x.push(X);null!==(A=p.exec(L));){let H=0,J=0;const j=A[0];for(;null!==(A=y.exec(j));)C.x=parseFloat(A[1]),C.y=parseFloat(A[2]),C.z=parseFloat(A[3]),J++;for(;null!==(A=v.exec(j));)w.push(parseFloat(A[1]),parseFloat(A[2]),parseFloat(A[3])),E.push(C.x,C.y,C.z),H++,T++;1!==J&&console.error("THREE.STLLoader: Something isn't right with the normal of face number "+g),3!==H&&console.error("THREE.STLLoader: Something isn't right with the vertices of face number "+g),g++}const re=O,ae=T-O;d.userData.groupNames=x,d.addGroup(re,ae,D),D++}return d.setAttribute("position",new Xe(w,3)),d.setAttribute("normal",new Xe(E,3)),d}(function o(c){return"string"!=typeof c?(new TextDecoder).decode(c):c}(e))}}const Gre=/^[og]\s*(.+)?/,Wre=/^mtllib /,jre=/^usemtl /,$re=/^usemap /,FH=/\s+/,kH=new N,WI=new N,UH=new N,BH=new N,Ao=new N,YS=new je;function qre(){const n={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(e,t){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=e,void(this.object.fromDeclaration=!1!==t);const i=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:!1!==t,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(r,s){const o=this._finalize(!1);o&&(o.inherited||o.groupCount<=0)&&this.materials.splice(o.index,1);const a={index:this.materials.length,name:r||"",mtllib:Array.isArray(s)&&s.length>0?s[s.length-1]:"",smooth:void 0!==o?o.smooth:this.smooth,groupStart:void 0!==o?o.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(l){const c={index:"number"==typeof l?l:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return c.clone=this.clone.bind(c),c}};return this.materials.push(a),a},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(r){const s=this.currentMaterial();if(s&&-1===s.groupEnd&&(s.groupEnd=this.geometry.vertices.length/3,s.groupCount=s.groupEnd-s.groupStart,s.inherited=!1),r&&this.materials.length>1)for(let o=this.materials.length-1;o>=0;o--)this.materials[o].groupCount<=0&&this.materials.splice(o,1);return r&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),s}},i&&i.name&&"function"==typeof i.clone){const r=i.clone(0);r.inherited=!0,this.object.materials.push(r)}this.objects.push(this.object)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(e,t){const i=parseInt(e,10);return 3*(i>=0?i-1:i+t/3)},parseNormalIndex:function(e,t){const i=parseInt(e,10);return 3*(i>=0?i-1:i+t/3)},parseUVIndex:function(e,t){const i=parseInt(e,10);return 2*(i>=0?i-1:i+t/2)},addVertex:function(e,t,i){const r=this.vertices,s=this.object.geometry.vertices;s.push(r[e+0],r[e+1],r[e+2]),s.push(r[t+0],r[t+1],r[t+2]),s.push(r[i+0],r[i+1],r[i+2])},addVertexPoint:function(e){const t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){const t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,i){const r=this.normals,s=this.object.geometry.normals;s.push(r[e+0],r[e+1],r[e+2]),s.push(r[t+0],r[t+1],r[t+2]),s.push(r[i+0],r[i+1],r[i+2])},addFaceNormal:function(e,t,i){const r=this.vertices,s=this.object.geometry.normals;kH.fromArray(r,e),WI.fromArray(r,t),UH.fromArray(r,i),Ao.subVectors(UH,WI),BH.subVectors(kH,WI),Ao.cross(BH),Ao.normalize(),s.push(Ao.x,Ao.y,Ao.z),s.push(Ao.x,Ao.y,Ao.z),s.push(Ao.x,Ao.y,Ao.z)},addColor:function(e,t,i){const r=this.colors,s=this.object.geometry.colors;void 0!==r[e]&&s.push(r[e+0],r[e+1],r[e+2]),void 0!==r[t]&&s.push(r[t+0],r[t+1],r[t+2]),void 0!==r[i]&&s.push(r[i+0],r[i+1],r[i+2])},addUV:function(e,t,i){const r=this.uvs,s=this.object.geometry.uvs;s.push(r[e+0],r[e+1]),s.push(r[t+0],r[t+1]),s.push(r[i+0],r[i+1])},addDefaultUV:function(){const e=this.object.geometry.uvs;e.push(0,0),e.push(0,0),e.push(0,0)},addUVLine:function(e){const t=this.uvs;this.object.geometry.uvs.push(t[e+0],t[e+1])},addFace:function(e,t,i,r,s,o,a,l,c){const d=this.vertices.length;let h=this.parseVertexIndex(e,d),p=this.parseVertexIndex(t,d),m=this.parseVertexIndex(i,d);if(this.addVertex(h,p,m),this.addColor(h,p,m),void 0!==a&&""!==a){const g=this.normals.length;h=this.parseNormalIndex(a,g),p=this.parseNormalIndex(l,g),m=this.parseNormalIndex(c,g),this.addNormal(h,p,m)}else this.addFaceNormal(h,p,m);if(void 0!==r&&""!==r){const g=this.uvs.length;h=this.parseUVIndex(r,g),p=this.parseUVIndex(s,g),m=this.parseUVIndex(o,g),this.addUV(h,p,m),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(e){this.object.geometry.type="Points";const t=this.vertices.length;for(let i=0,r=e.length;i<r;i++){const s=this.parseVertexIndex(e[i],t);this.addVertexPoint(s),this.addColor(s)}},addLineGeometry:function(e,t){this.object.geometry.type="Line";const i=this.vertices.length,r=this.uvs.length;for(let s=0,o=e.length;s<o;s++)this.addVertexLine(this.parseVertexIndex(e[s],i));for(let s=0,o=t.length;s<o;s++)this.addUVLine(this.parseUVIndex(t[s],r))}};return n.startObject("",!1),n}class Xre extends _u{constructor(e){super(e),this.materials=null}load(e,t,i,r){const s=this,o=new Co(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{t(s.parse(a))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}setMaterials(e){return this.materials=e,this}parse(e){const t=new qre;-1!==e.indexOf("\r\n")&&(e=e.replace(/\r\n/g,"\n")),-1!==e.indexOf("\\\n")&&(e=e.replace(/\\\n/g,""));const i=e.split("\n");let r=[];for(let a=0,l=i.length;a<l;a++){const c=i[a].trimStart();if(0===c.length)continue;const d=c.charAt(0);if("#"!==d)if("v"===d){const h=c.split(FH);switch(h[0]){case"v":t.vertices.push(parseFloat(h[1]),parseFloat(h[2]),parseFloat(h[3])),h.length>=7?(YS.setRGB(parseFloat(h[4]),parseFloat(h[5]),parseFloat(h[6])).convertSRGBToLinear(),t.colors.push(YS.r,YS.g,YS.b)):t.colors.push(void 0,void 0,void 0);break;case"vn":t.normals.push(parseFloat(h[1]),parseFloat(h[2]),parseFloat(h[3]));break;case"vt":t.uvs.push(parseFloat(h[1]),parseFloat(h[2]))}}else if("f"===d){const p=c.slice(1).trim().split(FH),m=[];for(let b=0,v=p.length;b<v;b++){const y=p[b];if(y.length>0){const w=y.split("/");m.push(w)}}const g=m[0];for(let b=1,v=m.length-1;b<v;b++){const y=m[b],w=m[b+1];t.addFace(g[0],y[0],w[0],g[1],y[1],w[1],g[2],y[2],w[2])}}else if("l"===d){const h=c.substring(1).trim().split(" ");let p=[];const m=[];if(-1===c.indexOf("/"))p=h;else for(let g=0,b=h.length;g<b;g++){const v=h[g].split("/");""!==v[0]&&p.push(v[0]),""!==v[1]&&m.push(v[1])}t.addLineGeometry(p,m)}else if("p"===d){const p=c.slice(1).trim().split(" ");t.addPointGeometry(p)}else if(null!==(r=Gre.exec(c))){const h=(" "+r[0].slice(1).trim()).slice(1);t.startObject(h)}else if(jre.test(c))t.object.startMaterial(c.substring(7).trim(),t.materialLibraries);else if(Wre.test(c))t.materialLibraries.push(c.substring(7).trim());else if($re.test(c))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if("s"===d){if(r=c.split(" "),r.length>1){const p=r[1].trim().toLowerCase();t.object.smooth="0"!==p&&"off"!==p}else t.object.smooth=!0;const h=t.object.currentMaterial();h&&(h.smooth=t.object.smooth)}else{if("\0"===c)continue;console.warn('THREE.OBJLoader: Unexpected line: "'+c+'"')}}t.finalize();const s=new $a;if(s.materialLibraries=[].concat(t.materialLibraries),1==!(1===t.objects.length&&0===t.objects[0].geometry.vertices.length))for(let a=0,l=t.objects.length;a<l;a++){const c=t.objects[a],d=c.geometry,h=c.materials,p="Line"===d.type,m="Points"===d.type;let g=!1;if(0===d.vertices.length)continue;const b=new Nt;b.setAttribute("position",new Xe(d.vertices,3)),d.normals.length>0&&b.setAttribute("normal",new Xe(d.normals,3)),d.colors.length>0&&(g=!0,b.setAttribute("color",new Xe(d.colors,3))),!0===d.hasUVIndices&&b.setAttribute("uv",new Xe(d.uvs,2));const v=[];for(let w=0,E=h.length;w<E;w++){const x=h[w],C=x.name+"_"+x.smooth+"_"+g;let A=t.materials[C];if(null!==this.materials)if(A=this.materials.create(x.name),!p||!A||A instanceof mr){if(m&&A&&!(A instanceof Zd)){const D=new Zd({size:10,sizeAttenuation:!1});hs.prototype.copy.call(D,A),D.color.copy(A.color),D.map=A.map,A=D}}else{const D=new mr;hs.prototype.copy.call(D,A),D.color.copy(A.color),A=D}void 0===A&&(A=p?new mr:m?new Zd({size:1,sizeAttenuation:!1}):new BV,A.name=x.name,A.flatShading=!x.smooth,A.vertexColors=g,t.materials[C]=A),v.push(A)}let y;if(v.length>1){for(let w=0,E=h.length;w<E;w++){const x=h[w];b.addGroup(x.groupStart,x.groupCount,w)}y=p?new ym(b,v):m?new rv(b,v):new Ce(b,v)}else y=p?new ym(b,v[0]):m?new rv(b,v[0]):new Ce(b,v[0]);y.name=c.name,s.add(y)}else if(t.vertices.length>0){const a=new Zd({size:1,sizeAttenuation:!1}),l=new Nt;l.setAttribute("position",new Xe(t.vertices,3)),t.colors.length>0&&void 0!==t.colors[0]&&(l.setAttribute("color",new Xe(t.colors,3)),a.vertexColors=!0);const c=new rv(l,a);s.add(c)}return s}}const Yre=[0,2e3,1e4,3e4,null];class VH{constructor(e){this._retryDelays=void 0!==e?[...e,null]:Yre}nextRetryDelayInMilliseconds(e){return this._retryDelays[e.previousRetryCount]}}let gv=(()=>{class n{}return n.Authorization="Authorization",n.Cookie="Cookie",n})();class HH{constructor(e,t,i){this.statusCode=e,this.statusText=t,this.content=i}}class ZS{get(e,t){return this.send({...t,method:"GET",url:e})}post(e,t){return this.send({...t,method:"POST",url:e})}delete(e,t){return this.send({...t,method:"DELETE",url:e})}getCookieString(e){return""}}class Zre extends ZS{constructor(e,t){super(),this._innerClient=e,this._accessTokenFactory=t}send(e){var t=this;return Rn(function*(){let i=!0;t._accessTokenFactory&&(!t._accessToken||e.url&&e.url.indexOf("/negotiate?")>0)&&(i=!1,t._accessToken=yield t._accessTokenFactory()),t._setAuthorizationHeader(e);const r=yield t._innerClient.send(e);return i&&401===r.statusCode&&t._accessTokenFactory?(t._accessToken=yield t._accessTokenFactory(),t._setAuthorizationHeader(e),yield t._innerClient.send(e)):r})()}_setAuthorizationHeader(e){e.headers||(e.headers={}),this._accessToken?e.headers[gv.Authorization]=`Bearer ${this._accessToken}`:this._accessTokenFactory&&e.headers[gv.Authorization]&&delete e.headers[gv.Authorization]}getCookieString(e){return this._innerClient.getCookieString(e)}}class Nm extends Error{constructor(e,t){const i=new.target.prototype;super(`${e}: Status code '${t}'`),this.statusCode=t,this.__proto__=i}}class jI extends Error{constructor(e="A timeout occurred."){const t=new.target.prototype;super(e),this.__proto__=t}}class ua extends Error{constructor(e="An abort occurred."){const t=new.target.prototype;super(e),this.__proto__=t}}class Kre extends Error{constructor(e,t){const i=new.target.prototype;super(e),this.transport=t,this.errorType="UnsupportedTransportError",this.__proto__=i}}class Jre extends Error{constructor(e,t){const i=new.target.prototype;super(e),this.transport=t,this.errorType="DisabledTransportError",this.__proto__=i}}class Qre extends Error{constructor(e,t){const i=new.target.prototype;super(e),this.transport=t,this.errorType="FailedToStartTransportError",this.__proto__=i}}class ese extends Error{constructor(e){const t=new.target.prototype;super(e),this.errorType="FailedToNegotiateWithServerError",this.__proto__=t}}class tse extends Error{constructor(e,t){const i=new.target.prototype;super(e),this.innerErrors=t,this.__proto__=i}}var _e=function(n){return n[n.Trace=0]="Trace",n[n.Debug=1]="Debug",n[n.Information=2]="Information",n[n.Warning=3]="Warning",n[n.Error=4]="Error",n[n.Critical=5]="Critical",n[n.None=6]="None",n}(_e||{});class _v{constructor(){}log(e,t){}}_v.instance=new _v;const nse="7.0.12";class gr{static isRequired(e,t){if(null==e)throw new Error(`The '${t}' argument is required.`)}static isNotEmpty(e,t){if(!e||e.match(/^\s*$/))throw new Error(`The '${t}' argument should not be empty.`)}static isIn(e,t,i){if(!(e in t))throw new Error(`Unknown ${i} value: ${e}.`)}}class _r{static get isBrowser(){return"object"==typeof window&&"object"==typeof window.document}static get isWebWorker(){return"object"==typeof self&&"importScripts"in self}static get isReactNative(){return"object"==typeof window&&typeof window.document>"u"}static get isNode(){return!this.isBrowser&&!this.isWebWorker&&!this.isReactNative}}function yv(n,e){let t="";return vv(n)?(t=`Binary data of length ${n.byteLength}`,e&&(t+=`. Content: '${function ise(n){const e=new Uint8Array(n);let t="";return e.forEach(i=>{t+=`0x${i<16?"0":""}${i.toString(16)} `}),t.substr(0,t.length-1)}(n)}'`)):"string"==typeof n&&(t=`String data of length ${n.length}`,e&&(t+=`. Content: '${n}'`)),t}function vv(n){return n&&typeof ArrayBuffer<"u"&&(n instanceof ArrayBuffer||n.constructor&&"ArrayBuffer"===n.constructor.name)}function zH(n,e,t,i,r,s){return $I.apply(this,arguments)}function $I(){return $I=Rn(function*(n,e,t,i,r,s){const o={},[a,l]=Lm();o[a]=l,n.log(_e.Trace,`(${e} transport) sending data. ${yv(r,s.logMessageContent)}.`);const c=vv(r)?"arraybuffer":"text",d=yield t.post(i,{content:r,headers:{...o,...s.headers},responseType:c,timeout:s.timeout,withCredentials:s.withCredentials});n.log(_e.Trace,`(${e} transport) request complete. Response status: ${d.statusCode}.`)}),$I.apply(this,arguments)}class sse{constructor(e,t){this._subject=e,this._observer=t}dispose(){const e=this._subject.observers.indexOf(this._observer);e>-1&&this._subject.observers.splice(e,1),0===this._subject.observers.length&&this._subject.cancelCallback&&this._subject.cancelCallback().catch(t=>{})}}class KS{constructor(e){this._minLevel=e,this.out=console}log(e,t){if(e>=this._minLevel){const i=`[${(new Date).toISOString()}] ${_e[e]}: ${t}`;switch(e){case _e.Critical:case _e.Error:this.out.error(i);break;case _e.Warning:this.out.warn(i);break;case _e.Information:this.out.info(i);break;default:this.out.log(i)}}}}function Lm(){let n="X-SignalR-User-Agent";return _r.isNode&&(n="User-Agent"),[n,ose(nse,ase(),_r.isNode?"NodeJS":"Browser",lse())]}function ose(n,e,t,i){let r="Microsoft SignalR/";const s=n.split(".");return r+=`${s[0]}.${s[1]}`,r+=` (${n}; `,r+=e&&""!==e?`${e}; `:"Unknown OS; ",r+=`${t}`,r+=i?`; ${i}`:"; Unknown Runtime Version",r+=")",r}function ase(){if(!_r.isNode)return"";switch(process.platform){case"win32":return"Windows NT";case"darwin":return"macOS";case"linux":return"Linux";default:return process.platform}}function lse(){if(_r.isNode)return process.versions.node}function GH(n){return n.stack?n.stack:n.message?n.message:`${n}`}class dse extends ZS{constructor(e){if(super(),this._logger=e,typeof fetch>"u"){const t=require;this._jar=new(t("tough-cookie").CookieJar),this._fetchType=t("node-fetch"),this._fetchType=t("fetch-cookie")(this._fetchType,this._jar)}else this._fetchType=fetch.bind(function use(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("could not find global")}());if(typeof AbortController>"u"){const t=require;this._abortControllerType=t("abort-controller")}else this._abortControllerType=AbortController}send(e){var t=this;return Rn(function*(){if(e.abortSignal&&e.abortSignal.aborted)throw new ua;if(!e.method)throw new Error("No method defined.");if(!e.url)throw new Error("No url defined.");const i=new t._abortControllerType;let r;e.abortSignal&&(e.abortSignal.onabort=()=>{i.abort(),r=new ua});let o,s=null;e.timeout&&(s=setTimeout(()=>{i.abort(),t._logger.log(_e.Warning,"Timeout from HTTP request."),r=new jI},e.timeout)),""===e.content&&(e.content=void 0),e.content&&(e.headers=e.headers||{},e.headers["Content-Type"]=vv(e.content)?"application/octet-stream":"text/plain;charset=UTF-8");try{o=yield t._fetchType(e.url,{body:e.content,cache:"no-cache",credentials:!0===e.withCredentials?"include":"same-origin",headers:{"X-Requested-With":"XMLHttpRequest",...e.headers},method:e.method,mode:"cors",redirect:"follow",signal:i.signal})}catch(c){throw r||(t._logger.log(_e.Warning,`Error from HTTP request. ${c}.`),c)}finally{s&&clearTimeout(s),e.abortSignal&&(e.abortSignal.onabort=null)}if(!o.ok){const c=yield WH(o,"text");throw new Nm(c||o.statusText,o.status)}const l=yield WH(o,e.responseType);return new HH(o.status,o.statusText,l)})()}getCookieString(e){let t="";return _r.isNode&&this._jar&&this._jar.getCookies(e,(i,r)=>t=r.join("; ")),t}}function WH(n,e){let t;switch(e){case"arraybuffer":t=n.arrayBuffer();break;case"text":default:t=n.text();break;case"blob":case"document":case"json":throw new Error(`${e} is not supported.`)}return t}class hse extends ZS{constructor(e){super(),this._logger=e}send(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new ua):e.method?e.url?new Promise((t,i)=>{const r=new XMLHttpRequest;r.open(e.method,e.url,!0),r.withCredentials=void 0===e.withCredentials||e.withCredentials,r.setRequestHeader("X-Requested-With","XMLHttpRequest"),""===e.content&&(e.content=void 0),e.content&&(vv(e.content)?r.setRequestHeader("Content-Type","application/octet-stream"):r.setRequestHeader("Content-Type","text/plain;charset=UTF-8"));const s=e.headers;s&&Object.keys(s).forEach(o=>{r.setRequestHeader(o,s[o])}),e.responseType&&(r.responseType=e.responseType),e.abortSignal&&(e.abortSignal.onabort=()=>{r.abort(),i(new ua)}),e.timeout&&(r.timeout=e.timeout),r.onload=()=>{e.abortSignal&&(e.abortSignal.onabort=null),r.status>=200&&r.status<300?t(new HH(r.status,r.statusText,r.response||r.responseText)):i(new Nm(r.response||r.responseText||r.statusText,r.status))},r.onerror=()=>{this._logger.log(_e.Warning,`Error from HTTP request. ${r.status}: ${r.statusText}.`),i(new Nm(r.statusText,r.status))},r.ontimeout=()=>{this._logger.log(_e.Warning,"Timeout from HTTP request."),i(new jI)},r.send(e.content)}):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}}class fse extends ZS{constructor(e){if(super(),typeof fetch<"u"||_r.isNode)this._httpClient=new dse(e);else{if(!(typeof XMLHttpRequest<"u"))throw new Error("No usable HttpClient found.");this._httpClient=new hse(e)}}send(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new ua):e.method?e.url?this._httpClient.send(e):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}getCookieString(e){return this._httpClient.getCookieString(e)}}var Tr=function(n){return n[n.None=0]="None",n[n.WebSockets=1]="WebSockets",n[n.ServerSentEvents=2]="ServerSentEvents",n[n.LongPolling=4]="LongPolling",n}(Tr||{}),ms=function(n){return n[n.Text=1]="Text",n[n.Binary=2]="Binary",n}(ms||{});class pse{constructor(){this._isAborted=!1,this.onabort=null}abort(){this._isAborted||(this._isAborted=!0,this.onabort&&this.onabort())}get signal(){return this}get aborted(){return this._isAborted}}class jH{constructor(e,t,i){this._httpClient=e,this._logger=t,this._pollAbort=new pse,this._options=i,this._running=!1,this.onreceive=null,this.onclose=null}get pollAborted(){return this._pollAbort.aborted}connect(e,t){var i=this;return Rn(function*(){if(gr.isRequired(e,"url"),gr.isRequired(t,"transferFormat"),gr.isIn(t,ms,"transferFormat"),i._url=e,i._logger.log(_e.Trace,"(LongPolling transport) Connecting."),t===ms.Binary&&typeof XMLHttpRequest<"u"&&"string"!=typeof(new XMLHttpRequest).responseType)throw new Error("Binary protocols over XmlHttpRequest not implementing advanced features are not supported.");const[r,s]=Lm(),o={[r]:s,...i._options.headers},a={abortSignal:i._pollAbort.signal,headers:o,timeout:1e5,withCredentials:i._options.withCredentials};t===ms.Binary&&(a.responseType="arraybuffer");const l=`${e}&_=${Date.now()}`;i._logger.log(_e.Trace,`(LongPolling transport) polling: ${l}.`);const c=yield i._httpClient.get(l,a);200!==c.statusCode?(i._logger.log(_e.Error,`(LongPolling transport) Unexpected response code: ${c.statusCode}.`),i._closeError=new Nm(c.statusText||"",c.statusCode),i._running=!1):i._running=!0,i._receiving=i._poll(i._url,a)})()}_poll(e,t){var i=this;return Rn(function*(){try{for(;i._running;)try{const r=`${e}&_=${Date.now()}`;i._logger.log(_e.Trace,`(LongPolling transport) polling: ${r}.`);const s=yield i._httpClient.get(r,t);204===s.statusCode?(i._logger.log(_e.Information,"(LongPolling transport) Poll terminated by server."),i._running=!1):200!==s.statusCode?(i._logger.log(_e.Error,`(LongPolling transport) Unexpected response code: ${s.statusCode}.`),i._closeError=new Nm(s.statusText||"",s.statusCode),i._running=!1):s.content?(i._logger.log(_e.Trace,`(LongPolling transport) data received. ${yv(s.content,i._options.logMessageContent)}.`),i.onreceive&&i.onreceive(s.content)):i._logger.log(_e.Trace,"(LongPolling transport) Poll timed out, reissuing.")}catch(r){i._running?r instanceof jI?i._logger.log(_e.Trace,"(LongPolling transport) Poll timed out, reissuing."):(i._closeError=r,i._running=!1):i._logger.log(_e.Trace,`(LongPolling transport) Poll errored after shutdown: ${r.message}`)}}finally{i._logger.log(_e.Trace,"(LongPolling transport) Polling complete."),i.pollAborted||i._raiseOnClose()}})()}send(e){var t=this;return Rn(function*(){return t._running?zH(t._logger,"LongPolling",t._httpClient,t._url,e,t._options):Promise.reject(new Error("Cannot send until the transport is connected"))})()}stop(){var e=this;return Rn(function*(){e._logger.log(_e.Trace,"(LongPolling transport) Stopping polling."),e._running=!1,e._pollAbort.abort();try{yield e._receiving,e._logger.log(_e.Trace,`(LongPolling transport) sending DELETE request to ${e._url}.`);const t={},[i,r]=Lm();t[i]=r;const s={headers:{...t,...e._options.headers},timeout:e._options.timeout,withCredentials:e._options.withCredentials};yield e._httpClient.delete(e._url,s),e._logger.log(_e.Trace,"(LongPolling transport) DELETE request sent.")}finally{e._logger.log(_e.Trace,"(LongPolling transport) Stop finished."),e._raiseOnClose()}})()}_raiseOnClose(){if(this.onclose){let e="(LongPolling transport) Firing onclose event.";this._closeError&&(e+=" Error: "+this._closeError),this._logger.log(_e.Trace,e),this.onclose(this._closeError)}}}class mse{constructor(e,t,i,r){this._httpClient=e,this._accessToken=t,this._logger=i,this._options=r,this.onreceive=null,this.onclose=null}connect(e,t){var i=this;return Rn(function*(){return gr.isRequired(e,"url"),gr.isRequired(t,"transferFormat"),gr.isIn(t,ms,"transferFormat"),i._logger.log(_e.Trace,"(SSE transport) Connecting."),i._url=e,i._accessToken&&(e+=(e.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(i._accessToken)}`),new Promise((r,s)=>{let a,o=!1;if(t===ms.Text){if(_r.isBrowser||_r.isWebWorker)a=new i._options.EventSource(e,{withCredentials:i._options.withCredentials});else{const l=i._httpClient.getCookieString(e),c={};c.Cookie=l;const[d,h]=Lm();c[d]=h,a=new i._options.EventSource(e,{withCredentials:i._options.withCredentials,headers:{...c,...i._options.headers}})}try{a.onmessage=l=>{if(i.onreceive)try{i._logger.log(_e.Trace,`(SSE transport) data received. ${yv(l.data,i._options.logMessageContent)}.`),i.onreceive(l.data)}catch(c){return void i._close(c)}},a.onerror=l=>{o?i._close():s(new Error("EventSource failed to connect. The connection could not be found on the server, either the connection ID is not present on the server, or a proxy is refusing/buffering the connection. If you have multiple servers check that sticky sessions are enabled."))},a.onopen=()=>{i._logger.log(_e.Information,`SSE connected to ${i._url}`),i._eventSource=a,o=!0,r()}}catch(l){return void s(l)}}else s(new Error("The Server-Sent Events transport only supports the 'Text' transfer format"))})})()}send(e){var t=this;return Rn(function*(){return t._eventSource?zH(t._logger,"SSE",t._httpClient,t._url,e,t._options):Promise.reject(new Error("Cannot send until the transport is connected"))})()}stop(){return this._close(),Promise.resolve()}_close(e){this._eventSource&&(this._eventSource.close(),this._eventSource=void 0,this.onclose&&this.onclose(e))}}class gse{constructor(e,t,i,r,s,o){this._logger=i,this._accessTokenFactory=t,this._logMessageContent=r,this._webSocketConstructor=s,this._httpClient=e,this.onreceive=null,this.onclose=null,this._headers=o}connect(e,t){var i=this;return Rn(function*(){let r;return gr.isRequired(e,"url"),gr.isRequired(t,"transferFormat"),gr.isIn(t,ms,"transferFormat"),i._logger.log(_e.Trace,"(WebSockets transport) Connecting."),i._accessTokenFactory&&(r=yield i._accessTokenFactory()),new Promise((s,o)=>{let a;e=e.replace(/^http/,"ws");const l=i._httpClient.getCookieString(e);let c=!1;if(_r.isNode||_r.isReactNative){const d={},[h,p]=Lm();d[h]=p,r&&(d[gv.Authorization]=`Bearer ${r}`),l&&(d[gv.Cookie]=l),a=new i._webSocketConstructor(e,void 0,{headers:{...d,...i._headers}})}else r&&(e+=(e.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(r)}`);a||(a=new i._webSocketConstructor(e)),t===ms.Binary&&(a.binaryType="arraybuffer"),a.onopen=d=>{i._logger.log(_e.Information,`WebSocket connected to ${e}.`),i._webSocket=a,c=!0,s()},a.onerror=d=>{let h=null;h=typeof ErrorEvent<"u"&&d instanceof ErrorEvent?d.error:"There was an error with the transport",i._logger.log(_e.Information,`(WebSockets transport) ${h}.`)},a.onmessage=d=>{if(i._logger.log(_e.Trace,`(WebSockets transport) data received. ${yv(d.data,i._logMessageContent)}.`),i.onreceive)try{i.onreceive(d.data)}catch(h){return void i._close(h)}},a.onclose=d=>{if(c)i._close(d);else{let h=null;h=typeof ErrorEvent<"u"&&d instanceof ErrorEvent?d.error:"WebSocket failed to connect. The connection could not be found on the server, either the endpoint may not be a SignalR endpoint, the connection ID is not present on the server, or there is a proxy blocking WebSockets. If you have multiple servers check that sticky sessions are enabled.",o(new Error(h))}}})})()}send(e){return this._webSocket&&this._webSocket.readyState===this._webSocketConstructor.OPEN?(this._logger.log(_e.Trace,`(WebSockets transport) sending data. ${yv(e,this._logMessageContent)}.`),this._webSocket.send(e),Promise.resolve()):Promise.reject("WebSocket is not in the OPEN state")}stop(){return this._webSocket&&this._close(void 0),Promise.resolve()}_close(e){this._webSocket&&(this._webSocket.onclose=()=>{},this._webSocket.onmessage=()=>{},this._webSocket.onerror=()=>{},this._webSocket.close(),this._webSocket=void 0),this._logger.log(_e.Trace,"(WebSockets transport) socket closed."),this.onclose&&(!this._isCloseEvent(e)||!1!==e.wasClean&&1e3===e.code?e instanceof Error?this.onclose(e):this.onclose():this.onclose(new Error(`WebSocket closed with status code: ${e.code} (${e.reason||"no reason given"}).`)))}_isCloseEvent(e){return e&&"boolean"==typeof e.wasClean&&"number"==typeof e.code}}class _se{constructor(e,t={}){if(this._stopPromiseResolver=()=>{},this.features={},this._negotiateVersion=1,gr.isRequired(e,"url"),this._logger=function rse(n){return void 0===n?new KS(_e.Information):null===n?_v.instance:void 0!==n.log?n:new KS(n)}(t.logger),this.baseUrl=this._resolveUrl(e),(t=t||{}).logMessageContent=void 0!==t.logMessageContent&&t.logMessageContent,"boolean"!=typeof t.withCredentials&&void 0!==t.withCredentials)throw new Error("withCredentials option was not a 'boolean' or 'undefined' value");t.withCredentials=void 0===t.withCredentials||t.withCredentials,t.timeout=void 0===t.timeout?1e5:t.timeout;let i=null,r=null;if(_r.isNode){const s=require;i=s("ws"),r=s("eventsource")}!_r.isNode&&typeof WebSocket<"u"&&!t.WebSocket?t.WebSocket=WebSocket:_r.isNode&&!t.WebSocket&&i&&(t.WebSocket=i),!_r.isNode&&typeof EventSource<"u"&&!t.EventSource?t.EventSource=EventSource:_r.isNode&&!t.EventSource&&typeof r<"u"&&(t.EventSource=r),this._httpClient=new Zre(t.httpClient||new fse(this._logger),t.accessTokenFactory),this._connectionState="Disconnected",this._connectionStarted=!1,this._options=t,this.onreceive=null,this.onclose=null}start(e){var t=this;return Rn(function*(){if(gr.isIn(e=e||ms.Binary,ms,"transferFormat"),t._logger.log(_e.Debug,`Starting connection with transfer format '${ms[e]}'.`),"Disconnected"!==t._connectionState)return Promise.reject(new Error("Cannot start an HttpConnection that is not in the 'Disconnected' state."));if(t._connectionState="Connecting",t._startInternalPromise=t._startInternal(e),yield t._startInternalPromise,"Disconnecting"===t._connectionState){const i="Failed to start the HttpConnection before stop() was called.";return t._logger.log(_e.Error,i),yield t._stopPromise,Promise.reject(new ua(i))}if("Connected"!==t._connectionState){const i="HttpConnection.startInternal completed gracefully but didn't enter the connection into the connected state!";return t._logger.log(_e.Error,i),Promise.reject(new ua(i))}t._connectionStarted=!0})()}send(e){return"Connected"!==this._connectionState?Promise.reject(new Error("Cannot send data if the connection is not in the 'Connected' State.")):(this._sendQueue||(this._sendQueue=new qI(this.transport)),this._sendQueue.send(e))}stop(e){var t=this;return Rn(function*(){return"Disconnected"===t._connectionState?(t._logger.log(_e.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnected state.`),Promise.resolve()):"Disconnecting"===t._connectionState?(t._logger.log(_e.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnecting state.`),t._stopPromise):(t._connectionState="Disconnecting",t._stopPromise=new Promise(i=>{t._stopPromiseResolver=i}),yield t._stopInternal(e),void(yield t._stopPromise))})()}_stopInternal(e){var t=this;return Rn(function*(){t._stopError=e;try{yield t._startInternalPromise}catch{}if(t.transport){try{yield t.transport.stop()}catch(i){t._logger.log(_e.Error,`HttpConnection.transport.stop() threw error '${i}'.`),t._stopConnection()}t.transport=void 0}else t._logger.log(_e.Debug,"HttpConnection.transport is undefined in HttpConnection.stop() because start() failed.")})()}_startInternal(e){var t=this;return Rn(function*(){let i=t.baseUrl;t._accessTokenFactory=t._options.accessTokenFactory,t._httpClient._accessTokenFactory=t._accessTokenFactory;try{if(t._options.skipNegotiation){if(t._options.transport!==Tr.WebSockets)throw new Error("Negotiation can only be skipped when using the WebSocket transport directly.");t.transport=t._constructTransport(Tr.WebSockets),yield t._startTransport(i,e)}else{let r=null,s=0;do{if(r=yield t._getNegotiationResponse(i),"Disconnecting"===t._connectionState||"Disconnected"===t._connectionState)throw new ua("The connection was stopped during negotiation.");if(r.error)throw new Error(r.error);if(r.ProtocolVersion)throw new Error("Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.");if(r.url&&(i=r.url),r.accessToken){const o=r.accessToken;t._accessTokenFactory=()=>o,t._httpClient._accessToken=o,t._httpClient._accessTokenFactory=void 0}s++}while(r.url&&s<100);if(100===s&&r.url)throw new Error("Negotiate redirection limit exceeded.");yield t._createTransport(i,t._options.transport,r,e)}t.transport instanceof jH&&(t.features.inherentKeepAlive=!0),"Connecting"===t._connectionState&&(t._logger.log(_e.Debug,"The HttpConnection connected successfully."),t._connectionState="Connected")}catch(r){return t._logger.log(_e.Error,"Failed to start the connection: "+r),t._connectionState="Disconnected",t.transport=void 0,t._stopPromiseResolver(),Promise.reject(r)}})()}_getNegotiationResponse(e){var t=this;return Rn(function*(){const i={},[r,s]=Lm();i[r]=s;const o=t._resolveNegotiateUrl(e);t._logger.log(_e.Debug,`Sending negotiation request: ${o}.`);try{const a=yield t._httpClient.post(o,{content:"",headers:{...i,...t._options.headers},timeout:t._options.timeout,withCredentials:t._options.withCredentials});if(200!==a.statusCode)return Promise.reject(new Error(`Unexpected status code returned from negotiate '${a.statusCode}'`));const l=JSON.parse(a.content);return(!l.negotiateVersion||l.negotiateVersion<1)&&(l.connectionToken=l.connectionId),l}catch(a){let l="Failed to complete negotiation with the server: "+a;return a instanceof Nm&&404===a.statusCode&&(l+=" Either this is not a SignalR endpoint or there is a proxy blocking the connection."),t._logger.log(_e.Error,l),Promise.reject(new ese(l))}})()}_createConnectUrl(e,t){return t?e+(-1===e.indexOf("?")?"?":"&")+`id=${t}`:e}_createTransport(e,t,i,r){var s=this;return Rn(function*(){let o=s._createConnectUrl(e,i.connectionToken);if(s._isITransport(t))return s._logger.log(_e.Debug,"Connection was provided an instance of ITransport, using that directly."),s.transport=t,yield s._startTransport(o,r),void(s.connectionId=i.connectionId);const a=[],l=i.availableTransports||[];let c=i;for(const d of l){const h=s._resolveTransportOrError(d,t,r);if(h instanceof Error)a.push(`${d.transport} failed:`),a.push(h);else if(s._isITransport(h)){if(s.transport=h,!c){try{c=yield s._getNegotiationResponse(e)}catch(p){return Promise.reject(p)}o=s._createConnectUrl(e,c.connectionToken)}try{return yield s._startTransport(o,r),void(s.connectionId=c.connectionId)}catch(p){if(s._logger.log(_e.Error,`Failed to start the transport '${d.transport}': ${p}`),c=void 0,a.push(new Qre(`${d.transport} failed: ${p}`,Tr[d.transport])),"Connecting"!==s._connectionState){const m="Failed to select transport before stop() was called.";return s._logger.log(_e.Debug,m),Promise.reject(new ua(m))}}}}return Promise.reject(a.length>0?new tse(`Unable to connect to the server with any of the available transports. ${a.join(" ")}`,a):new Error("None of the transports supported by the client are supported by the server."))})()}_constructTransport(e){switch(e){case Tr.WebSockets:if(!this._options.WebSocket)throw new Error("'WebSocket' is not supported in your environment.");return new gse(this._httpClient,this._accessTokenFactory,this._logger,this._options.logMessageContent,this._options.WebSocket,this._options.headers||{});case Tr.ServerSentEvents:if(!this._options.EventSource)throw new Error("'EventSource' is not supported in your environment.");return new mse(this._httpClient,this._httpClient._accessToken,this._logger,this._options);case Tr.LongPolling:return new jH(this._httpClient,this._logger,this._options);default:throw new Error(`Unknown transport: ${e}.`)}}_startTransport(e,t){return this.transport.onreceive=this.onreceive,this.transport.onclose=i=>this._stopConnection(i),this.transport.connect(e,t)}_resolveTransportOrError(e,t,i){const r=Tr[e.transport];if(null==r)return this._logger.log(_e.Debug,`Skipping transport '${e.transport}' because it is not supported by this client.`),new Error(`Skipping transport '${e.transport}' because it is not supported by this client.`);if(!function yse(n,e){return!n||0!=(e&n)}(t,r))return this._logger.log(_e.Debug,`Skipping transport '${Tr[r]}' because it was disabled by the client.`),new Jre(`'${Tr[r]}' is disabled by the client.`,r);if(!(e.transferFormats.map(o=>ms[o]).indexOf(i)>=0))return this._logger.log(_e.Debug,`Skipping transport '${Tr[r]}' because it does not support the requested transfer format '${ms[i]}'.`),new Error(`'${Tr[r]}' does not support ${ms[i]}.`);if(r===Tr.WebSockets&&!this._options.WebSocket||r===Tr.ServerSentEvents&&!this._options.EventSource)return this._logger.log(_e.Debug,`Skipping transport '${Tr[r]}' because it is not supported in your environment.'`),new Kre(`'${Tr[r]}' is not supported in your environment.`,r);this._logger.log(_e.Debug,`Selecting transport '${Tr[r]}'.`);try{return this._constructTransport(r)}catch(o){return o}}_isITransport(e){return e&&"object"==typeof e&&"connect"in e}_stopConnection(e){if(this._logger.log(_e.Debug,`HttpConnection.stopConnection(${e}) called while in state ${this._connectionState}.`),this.transport=void 0,e=this._stopError||e,this._stopError=void 0,"Disconnected"!==this._connectionState){if("Connecting"===this._connectionState)throw this._logger.log(_e.Warning,`Call to HttpConnection.stopConnection(${e}) was ignored because the connection is still in the connecting state.`),new Error(`HttpConnection.stopConnection(${e}) was called while the connection is still in the connecting state.`);if("Disconnecting"===this._connectionState&&this._stopPromiseResolver(),e?this._logger.log(_e.Error,`Connection disconnected with error '${e}'.`):this._logger.log(_e.Information,"Connection disconnected."),this._sendQueue&&(this._sendQueue.stop().catch(t=>{this._logger.log(_e.Error,`TransportSendQueue.stop() threw error '${t}'.`)}),this._sendQueue=void 0),this.connectionId=void 0,this._connectionState="Disconnected",this._connectionStarted){this._connectionStarted=!1;try{this.onclose&&this.onclose(e)}catch(t){this._logger.log(_e.Error,`HttpConnection.onclose(${e}) threw error '${t}'.`)}}}else this._logger.log(_e.Debug,`Call to HttpConnection.stopConnection(${e}) was ignored because the connection is already in the disconnected state.`)}_resolveUrl(e){if(0===e.lastIndexOf("https://",0)||0===e.lastIndexOf("http://",0))return e;if(!_r.isBrowser)throw new Error(`Cannot resolve '${e}'.`);const t=window.document.createElement("a");return t.href=e,this._logger.log(_e.Information,`Normalizing '${e}' to '${t.href}'.`),t.href}_resolveNegotiateUrl(e){const t=e.indexOf("?");let i=e.substring(0,-1===t?e.length:t);return"/"!==i[i.length-1]&&(i+="/"),i+="negotiate",i+=-1===t?"":e.substring(t),-1===i.indexOf("negotiateVersion")&&(i+=-1===t?"?":"&",i+="negotiateVersion="+this._negotiateVersion),i}}class qI{constructor(e){this._transport=e,this._buffer=[],this._executing=!0,this._sendBufferedData=new JS,this._transportResult=new JS,this._sendLoopPromise=this._sendLoop()}send(e){return this._bufferData(e),this._transportResult||(this._transportResult=new JS),this._transportResult.promise}stop(){return this._executing=!1,this._sendBufferedData.resolve(),this._sendLoopPromise}_bufferData(e){if(this._buffer.length&&typeof this._buffer[0]!=typeof e)throw new Error(`Expected data to be of type ${typeof this._buffer} but was of type ${typeof e}`);this._buffer.push(e),this._sendBufferedData.resolve()}_sendLoop(){var e=this;return Rn(function*(){for(;;){if(yield e._sendBufferedData.promise,!e._executing){e._transportResult&&e._transportResult.reject("Connection stopped.");break}e._sendBufferedData=new JS;const t=e._transportResult;e._transportResult=void 0;const i="string"==typeof e._buffer[0]?e._buffer.join(""):qI._concatBuffers(e._buffer);e._buffer.length=0;try{yield e._transport.send(i),t.resolve()}catch(r){t.reject(r)}}})()}static _concatBuffers(e){const t=e.map(s=>s.byteLength).reduce((s,o)=>s+o),i=new Uint8Array(t);let r=0;for(const s of e)i.set(new Uint8Array(s),r),r+=s.byteLength;return i.buffer}}class JS{constructor(){this.promise=new Promise((e,t)=>[this._resolver,this._rejecter]=[e,t])}resolve(){this._resolver()}reject(e){this._rejecter(e)}}class to{static write(e){return`${e}${to.RecordSeparator}`}static parse(e){if(e[e.length-1]!==to.RecordSeparator)throw new Error("Message is incomplete.");const t=e.split(to.RecordSeparator);return t.pop(),t}}to.RecordSeparatorCode=30,to.RecordSeparator=String.fromCharCode(to.RecordSeparatorCode);class vse{writeHandshakeRequest(e){return to.write(JSON.stringify(e))}parseHandshakeResponse(e){let t,i;if(vv(e)){const a=new Uint8Array(e),l=a.indexOf(to.RecordSeparatorCode);if(-1===l)throw new Error("Message is incomplete.");const c=l+1;t=String.fromCharCode.apply(null,Array.prototype.slice.call(a.slice(0,c))),i=a.byteLength>c?a.slice(c).buffer:null}else{const a=e,l=a.indexOf(to.RecordSeparator);if(-1===l)throw new Error("Message is incomplete.");const c=l+1;t=a.substring(0,c),i=a.length>c?a.substring(c):null}const r=to.parse(t),s=JSON.parse(r[0]);if(s.type)throw new Error("Expected a handshake response from the server.");return[i,s]}}var ni=function(n){return n[n.Invocation=1]="Invocation",n[n.StreamItem=2]="StreamItem",n[n.Completion=3]="Completion",n[n.StreamInvocation=4]="StreamInvocation",n[n.CancelInvocation=5]="CancelInvocation",n[n.Ping=6]="Ping",n[n.Close=7]="Close",n}(ni||{});class bse{constructor(){this.observers=[]}next(e){for(const t of this.observers)t.next(e)}error(e){for(const t of this.observers)t.error&&t.error(e)}complete(){for(const e of this.observers)e.complete&&e.complete()}subscribe(e){return this.observers.push(e),new sse(this,e)}}var Si=function(n){return n.Disconnected="Disconnected",n.Connecting="Connecting",n.Connected="Connected",n.Disconnecting="Disconnecting",n.Reconnecting="Reconnecting",n}(Si||{});class XI{constructor(e,t,i,r){this._nextKeepAlive=0,this._freezeEventListener=()=>{this._logger.log(_e.Warning,"The page is being frozen, this will likely lead to the connection being closed and messages being lost. For more information see the docs at https://docs.microsoft.com/aspnet/core/signalr/javascript-client#bsleep")},gr.isRequired(e,"connection"),gr.isRequired(t,"logger"),gr.isRequired(i,"protocol"),this.serverTimeoutInMilliseconds=3e4,this.keepAliveIntervalInMilliseconds=15e3,this._logger=t,this._protocol=i,this.connection=e,this._reconnectPolicy=r,this._handshakeProtocol=new vse,this.connection.onreceive=s=>this._processIncomingData(s),this.connection.onclose=s=>this._connectionClosed(s),this._callbacks={},this._methods={},this._closedCallbacks=[],this._reconnectingCallbacks=[],this._reconnectedCallbacks=[],this._invocationId=0,this._receivedHandshakeResponse=!1,this._connectionState=Si.Disconnected,this._connectionStarted=!1,this._cachedPingMessage=this._protocol.writeMessage({type:ni.Ping})}static create(e,t,i,r){return new XI(e,t,i,r)}get state(){return this._connectionState}get connectionId(){return this.connection&&this.connection.connectionId||null}get baseUrl(){return this.connection.baseUrl||""}set baseUrl(e){if(this._connectionState!==Si.Disconnected&&this._connectionState!==Si.Reconnecting)throw new Error("The HubConnection must be in the Disconnected or Reconnecting state to change the url.");if(!e)throw new Error("The HubConnection url must be a valid url.");this.connection.baseUrl=e}start(){return this._startPromise=this._startWithStateTransitions(),this._startPromise}_startWithStateTransitions(){var e=this;return Rn(function*(){if(e._connectionState!==Si.Disconnected)return Promise.reject(new Error("Cannot start a HubConnection that is not in the 'Disconnected' state."));e._connectionState=Si.Connecting,e._logger.log(_e.Debug,"Starting HubConnection.");try{yield e._startInternal(),_r.isBrowser&&window.document.addEventListener("freeze",e._freezeEventListener),e._connectionState=Si.Connected,e._connectionStarted=!0,e._logger.log(_e.Debug,"HubConnection connected successfully.")}catch(t){return e._connectionState=Si.Disconnected,e._logger.log(_e.Debug,`HubConnection failed to start successfully because of error '${t}'.`),Promise.reject(t)}})()}_startInternal(){var e=this;return Rn(function*(){e._stopDuringStartError=void 0,e._receivedHandshakeResponse=!1;const t=new Promise((i,r)=>{e._handshakeResolver=i,e._handshakeRejecter=r});yield e.connection.start(e._protocol.transferFormat);try{const i={protocol:e._protocol.name,version:e._protocol.version};if(e._logger.log(_e.Debug,"Sending handshake request."),yield e._sendMessage(e._handshakeProtocol.writeHandshakeRequest(i)),e._logger.log(_e.Information,`Using HubProtocol '${e._protocol.name}'.`),e._cleanupTimeout(),e._resetTimeoutPeriod(),e._resetKeepAliveInterval(),yield t,e._stopDuringStartError)throw e._stopDuringStartError;e.connection.features.inherentKeepAlive||(yield e._sendMessage(e._cachedPingMessage))}catch(i){throw e._logger.log(_e.Debug,`Hub handshake failed with error '${i}' during start(). Stopping HubConnection.`),e._cleanupTimeout(),e._cleanupPingTimer(),yield e.connection.stop(i),i}})()}stop(){var e=this;return Rn(function*(){const t=e._startPromise;e._stopPromise=e._stopInternal(),yield e._stopPromise;try{yield t}catch{}})()}_stopInternal(e){return this._connectionState===Si.Disconnected?(this._logger.log(_e.Debug,`Call to HubConnection.stop(${e}) ignored because it is already in the disconnected state.`),Promise.resolve()):this._connectionState===Si.Disconnecting?(this._logger.log(_e.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnecting state.`),this._stopPromise):(this._connectionState=Si.Disconnecting,this._logger.log(_e.Debug,"Stopping HubConnection."),this._reconnectDelayHandle?(this._logger.log(_e.Debug,"Connection stopped during reconnect delay. Done reconnecting."),clearTimeout(this._reconnectDelayHandle),this._reconnectDelayHandle=void 0,this._completeClose(),Promise.resolve()):(this._cleanupTimeout(),this._cleanupPingTimer(),this._stopDuringStartError=e||new ua("The connection was stopped before the hub handshake could complete."),this.connection.stop(e)))}stream(e,...t){const[i,r]=this._replaceStreamingParams(t),s=this._createStreamInvocation(e,t,r);let o;const a=new bse;return a.cancelCallback=()=>{const l=this._createCancelInvocation(s.invocationId);return delete this._callbacks[s.invocationId],o.then(()=>this._sendWithProtocol(l))},this._callbacks[s.invocationId]=(l,c)=>{c?a.error(c):l&&(l.type===ni.Completion?l.error?a.error(new Error(l.error)):a.complete():a.next(l.item))},o=this._sendWithProtocol(s).catch(l=>{a.error(l),delete this._callbacks[s.invocationId]}),this._launchStreams(i,o),a}_sendMessage(e){return this._resetKeepAliveInterval(),this.connection.send(e)}_sendWithProtocol(e){return this._sendMessage(this._protocol.writeMessage(e))}send(e,...t){const[i,r]=this._replaceStreamingParams(t),s=this._sendWithProtocol(this._createInvocation(e,t,!0,r));return this._launchStreams(i,s),s}invoke(e,...t){const[i,r]=this._replaceStreamingParams(t),s=this._createInvocation(e,t,!1,r);return new Promise((a,l)=>{this._callbacks[s.invocationId]=(d,h)=>{h?l(h):d&&(d.type===ni.Completion?d.error?l(new Error(d.error)):a(d.result):l(new Error(`Unexpected message type: ${d.type}`)))};const c=this._sendWithProtocol(s).catch(d=>{l(d),delete this._callbacks[s.invocationId]});this._launchStreams(i,c)})}on(e,t){!e||!t||(e=e.toLowerCase(),this._methods[e]||(this._methods[e]=[]),-1===this._methods[e].indexOf(t)&&this._methods[e].push(t))}off(e,t){if(!e)return;e=e.toLowerCase();const i=this._methods[e];if(i)if(t){const r=i.indexOf(t);-1!==r&&(i.splice(r,1),0===i.length&&delete this._methods[e])}else delete this._methods[e]}onclose(e){e&&this._closedCallbacks.push(e)}onreconnecting(e){e&&this._reconnectingCallbacks.push(e)}onreconnected(e){e&&this._reconnectedCallbacks.push(e)}_processIncomingData(e){if(this._cleanupTimeout(),this._receivedHandshakeResponse||(e=this._processHandshakeResponse(e),this._receivedHandshakeResponse=!0),e){const t=this._protocol.parseMessages(e,this._logger);for(const i of t)switch(i.type){case ni.Invocation:this._invokeClientMethod(i);break;case ni.StreamItem:case ni.Completion:{const r=this._callbacks[i.invocationId];if(r){i.type===ni.Completion&&delete this._callbacks[i.invocationId];try{r(i)}catch(s){this._logger.log(_e.Error,`Stream callback threw error: ${GH(s)}`)}}break}case ni.Ping:break;case ni.Close:{this._logger.log(_e.Information,"Close message received from server.");const r=i.error?new Error("Server returned an error on close: "+i.error):void 0;!0===i.allowReconnect?this.connection.stop(r):this._stopPromise=this._stopInternal(r);break}default:this._logger.log(_e.Warning,`Invalid message type: ${i.type}.`)}}this._resetTimeoutPeriod()}_processHandshakeResponse(e){let t,i;try{[i,t]=this._handshakeProtocol.parseHandshakeResponse(e)}catch(r){const s="Error parsing handshake response: "+r;this._logger.log(_e.Error,s);const o=new Error(s);throw this._handshakeRejecter(o),o}if(t.error){const r="Server returned handshake error: "+t.error;this._logger.log(_e.Error,r);const s=new Error(r);throw this._handshakeRejecter(s),s}return this._logger.log(_e.Debug,"Server handshake complete."),this._handshakeResolver(),i}_resetKeepAliveInterval(){this.connection.features.inherentKeepAlive||(this._nextKeepAlive=(new Date).getTime()+this.keepAliveIntervalInMilliseconds,this._cleanupPingTimer())}_resetTimeoutPeriod(){var e=this;if(!(this.connection.features&&this.connection.features.inherentKeepAlive||(this._timeoutHandle=setTimeout(()=>this.serverTimeout(),this.serverTimeoutInMilliseconds),void 0!==this._pingServerHandle))){let t=this._nextKeepAlive-(new Date).getTime();t<0&&(t=0),this._pingServerHandle=setTimeout(Rn(function*(){if(e._connectionState===Si.Connected)try{yield e._sendMessage(e._cachedPingMessage)}catch{e._cleanupPingTimer()}}),t)}}serverTimeout(){this.connection.stop(new Error("Server timeout elapsed without receiving a message from the server."))}_invokeClientMethod(e){var t=this;return Rn(function*(){const i=e.target.toLowerCase(),r=t._methods[i];if(!r)return t._logger.log(_e.Warning,`No client method with the name '${i}' found.`),void(e.invocationId&&(t._logger.log(_e.Warning,`No result given for '${i}' method and invocation ID '${e.invocationId}'.`),yield t._sendWithProtocol(t._createCompletionMessage(e.invocationId,"Client didn't provide a result.",null))));const s=r.slice(),o=!!e.invocationId;let a,l,c;for(const d of s)try{const h=a;a=yield d.apply(t,e.arguments),o&&a&&h&&(t._logger.log(_e.Error,`Multiple results provided for '${i}'. Sending error to server.`),c=t._createCompletionMessage(e.invocationId,"Client provided multiple results.",null)),l=void 0}catch(h){l=h,t._logger.log(_e.Error,`A callback for the method '${i}' threw error '${h}'.`)}c?yield t._sendWithProtocol(c):o?(l?c=t._createCompletionMessage(e.invocationId,`${l}`,null):void 0!==a?c=t._createCompletionMessage(e.invocationId,null,a):(t._logger.log(_e.Warning,`No result given for '${i}' method and invocation ID '${e.invocationId}'.`),c=t._createCompletionMessage(e.invocationId,"Client didn't provide a result.",null)),yield t._sendWithProtocol(c)):a&&t._logger.log(_e.Error,`Result given for '${i}' method but server is not expecting a result.`)})()}_connectionClosed(e){this._logger.log(_e.Debug,`HubConnection.connectionClosed(${e}) called while in state ${this._connectionState}.`),this._stopDuringStartError=this._stopDuringStartError||e||new ua("The underlying connection was closed before the hub handshake could complete."),this._handshakeResolver&&this._handshakeResolver(),this._cancelCallbacksWithError(e||new Error("Invocation canceled due to the underlying connection being closed.")),this._cleanupTimeout(),this._cleanupPingTimer(),this._connectionState===Si.Disconnecting?this._completeClose(e):this._connectionState===Si.Connected&&this._reconnectPolicy?this._reconnect(e):this._connectionState===Si.Connected&&this._completeClose(e)}_completeClose(e){if(this._connectionStarted){this._connectionState=Si.Disconnected,this._connectionStarted=!1,_r.isBrowser&&window.document.removeEventListener("freeze",this._freezeEventListener);try{this._closedCallbacks.forEach(t=>t.apply(this,[e]))}catch(t){this._logger.log(_e.Error,`An onclose callback called with error '${e}' threw error '${t}'.`)}}}_reconnect(e){var t=this;return Rn(function*(){const i=Date.now();let r=0,s=void 0!==e?e:new Error("Attempting to reconnect due to a unknown error."),o=t._getNextRetryDelay(r++,0,s);if(null===o)return t._logger.log(_e.Debug,"Connection not reconnecting because the IRetryPolicy returned null on the first reconnect attempt."),void t._completeClose(e);if(t._connectionState=Si.Reconnecting,t._logger.log(_e.Information,e?`Connection reconnecting because of error '${e}'.`:"Connection reconnecting."),0!==t._reconnectingCallbacks.length){try{t._reconnectingCallbacks.forEach(a=>a.apply(t,[e]))}catch(a){t._logger.log(_e.Error,`An onreconnecting callback called with error '${e}' threw error '${a}'.`)}if(t._connectionState!==Si.Reconnecting)return void t._logger.log(_e.Debug,"Connection left the reconnecting state in onreconnecting callback. Done reconnecting.")}for(;null!==o;){if(t._logger.log(_e.Information,`Reconnect attempt number ${r} will start in ${o} ms.`),yield new Promise(a=>{t._reconnectDelayHandle=setTimeout(a,o)}),t._reconnectDelayHandle=void 0,t._connectionState!==Si.Reconnecting)return void t._logger.log(_e.Debug,"Connection left the reconnecting state during reconnect delay. Done reconnecting.");try{if(yield t._startInternal(),t._connectionState=Si.Connected,t._logger.log(_e.Information,"HubConnection reconnected successfully."),0!==t._reconnectedCallbacks.length)try{t._reconnectedCallbacks.forEach(a=>a.apply(t,[t.connection.connectionId]))}catch(a){t._logger.log(_e.Error,`An onreconnected callback called with connectionId '${t.connection.connectionId}; threw error '${a}'.`)}return}catch(a){if(t._logger.log(_e.Information,`Reconnect attempt failed because of error '${a}'.`),t._connectionState!==Si.Reconnecting)return t._logger.log(_e.Debug,`Connection moved to the '${t._connectionState}' from the reconnecting state during reconnect attempt. Done reconnecting.`),void(t._connectionState===Si.Disconnecting&&t._completeClose());s=a instanceof Error?a:new Error(a.toString()),o=t._getNextRetryDelay(r++,Date.now()-i,s)}}t._logger.log(_e.Information,`Reconnect retries have been exhausted after ${Date.now()-i} ms and ${r} failed attempts. Connection disconnecting.`),t._completeClose()})()}_getNextRetryDelay(e,t,i){try{return this._reconnectPolicy.nextRetryDelayInMilliseconds({elapsedMilliseconds:t,previousRetryCount:e,retryReason:i})}catch(r){return this._logger.log(_e.Error,`IRetryPolicy.nextRetryDelayInMilliseconds(${e}, ${t}) threw error '${r}'.`),null}}_cancelCallbacksWithError(e){const t=this._callbacks;this._callbacks={},Object.keys(t).forEach(i=>{const r=t[i];try{r(null,e)}catch(s){this._logger.log(_e.Error,`Stream 'error' callback called with '${e}' threw error: ${GH(s)}`)}})}_cleanupPingTimer(){this._pingServerHandle&&(clearTimeout(this._pingServerHandle),this._pingServerHandle=void 0)}_cleanupTimeout(){this._timeoutHandle&&clearTimeout(this._timeoutHandle)}_createInvocation(e,t,i,r){if(i)return 0!==r.length?{arguments:t,streamIds:r,target:e,type:ni.Invocation}:{arguments:t,target:e,type:ni.Invocation};{const s=this._invocationId;return this._invocationId++,0!==r.length?{arguments:t,invocationId:s.toString(),streamIds:r,target:e,type:ni.Invocation}:{arguments:t,invocationId:s.toString(),target:e,type:ni.Invocation}}}_launchStreams(e,t){if(0!==e.length){t||(t=Promise.resolve());for(const i in e)e[i].subscribe({complete:()=>{t=t.then(()=>this._sendWithProtocol(this._createCompletionMessage(i)))},error:r=>{let s;s=r instanceof Error?r.message:r&&r.toString?r.toString():"Unknown error",t=t.then(()=>this._sendWithProtocol(this._createCompletionMessage(i,s)))},next:r=>{t=t.then(()=>this._sendWithProtocol(this._createStreamItemMessage(i,r)))}})}}_replaceStreamingParams(e){const t=[],i=[];for(let r=0;r<e.length;r++){const s=e[r];if(this._isObservable(s)){const o=this._invocationId;this._invocationId++,t[o]=s,i.push(o.toString()),e.splice(r,1)}}return[t,i]}_isObservable(e){return e&&e.subscribe&&"function"==typeof e.subscribe}_createStreamInvocation(e,t,i){const r=this._invocationId;return this._invocationId++,0!==i.length?{arguments:t,invocationId:r.toString(),streamIds:i,target:e,type:ni.StreamInvocation}:{arguments:t,invocationId:r.toString(),target:e,type:ni.StreamInvocation}}_createCancelInvocation(e){return{invocationId:e,type:ni.CancelInvocation}}_createStreamItemMessage(e,t){return{invocationId:e,item:t,type:ni.StreamItem}}_createCompletionMessage(e,t,i){return t?{error:t,invocationId:e,type:ni.Completion}:{invocationId:e,result:i,type:ni.Completion}}}class xse{constructor(){this.name="json",this.version=1,this.transferFormat=ms.Text}parseMessages(e,t){if("string"!=typeof e)throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!e)return[];null===t&&(t=_v.instance);const i=to.parse(e),r=[];for(const s of i){const o=JSON.parse(s);if("number"!=typeof o.type)throw new Error("Invalid payload.");switch(o.type){case ni.Invocation:this._isInvocationMessage(o);break;case ni.StreamItem:this._isStreamItemMessage(o);break;case ni.Completion:this._isCompletionMessage(o);break;case ni.Ping:case ni.Close:break;default:t.log(_e.Information,"Unknown message type '"+o.type+"' ignored.");continue}r.push(o)}return r}writeMessage(e){return to.write(JSON.stringify(e))}_isInvocationMessage(e){this._assertNotEmptyString(e.target,"Invalid payload for Invocation message."),void 0!==e.invocationId&&this._assertNotEmptyString(e.invocationId,"Invalid payload for Invocation message.")}_isStreamItemMessage(e){if(this._assertNotEmptyString(e.invocationId,"Invalid payload for StreamItem message."),void 0===e.item)throw new Error("Invalid payload for StreamItem message.")}_isCompletionMessage(e){if(e.result&&e.error)throw new Error("Invalid payload for Completion message.");!e.result&&e.error&&this._assertNotEmptyString(e.error,"Invalid payload for Completion message."),this._assertNotEmptyString(e.invocationId,"Invalid payload for Completion message.")}_assertNotEmptyString(e,t){if("string"!=typeof e||""===e)throw new Error(t)}}const Mse={trace:_e.Trace,debug:_e.Debug,info:_e.Information,information:_e.Information,warn:_e.Warning,warning:_e.Warning,error:_e.Error,critical:_e.Critical,none:_e.None};class Tse{configureLogging(e){if(gr.isRequired(e,"logging"),function Ase(n){return void 0!==n.log}(e))this.logger=e;else if("string"==typeof e){const t=function Cse(n){const e=Mse[n.toLowerCase()];if(typeof e<"u")return e;throw new Error(`Unknown log level: ${n}`)}(e);this.logger=new KS(t)}else this.logger=new KS(e);return this}withUrl(e,t){return gr.isRequired(e,"url"),gr.isNotEmpty(e,"url"),this.url=e,this.httpConnectionOptions="object"==typeof t?{...this.httpConnectionOptions,...t}:{...this.httpConnectionOptions,transport:t},this}withHubProtocol(e){return gr.isRequired(e,"protocol"),this.protocol=e,this}withAutomaticReconnect(e){if(this.reconnectPolicy)throw new Error("A reconnectPolicy has already been set.");return this.reconnectPolicy=e?Array.isArray(e)?new VH(e):e:new VH,this}build(){const e=this.httpConnectionOptions||{};if(void 0===e.logger&&(e.logger=this.logger),!this.url)throw new Error("The 'HubConnectionBuilder.withUrl' method must be called before building the connection.");const t=new _se(this.url,e);return XI.create(t,this.logger||_v.instance,this.protocol||new xse,this.reconnectPolicy)}}const bv={appVersion:fh(147).i8,production:!0,serverURL:""};let wv=(()=>{class n{constructor(){}startConnection(t){this.hubConnection=(new Tse).withUrl(bv.serverURL+"/notifications").withAutomaticReconnect().build(),this.hubConnection.start().then(()=>{console.log("Connection started"),this.hubConnection.send("SetConnectionIDUser",t)}).catch(i=>console.log("Error while starting connection: "+i))}executeAction(t,i,r,s,o,a,l){this.hubConnection.send("ExecuteAction",{GameId:t,PlayerId:i,ItemId:r,ActionId:s,DragTargetItemId:o,ClientX:a,ClientY:l})}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Ke({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Om=(()=>{class n{GenerateGuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const i=16*Math.random()|0;return("x"===t?i:3&i|8).toString(16)})}randomIntFromInterval(t,i){return Math.random()*(i-t+1)+t}deepEqual(t,i){const r=Object.keys(t),s=Object.keys(i);if(r.length!==s.length)return!1;for(const o of r){const a=t[o],l=i[o],c=this.isObject(a)&&this.isObject(l);if(c&&!this.deepEqual(a,l)||!c&&a!==l)return!1}return!0}isObject(t){return null!=t&&"object"==typeof t}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Ke({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class QS{}class ex{}class Za{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?"string"==typeof e?this.lazyInit=()=>{this.headers=new Map,e.split("\n").forEach(t=>{const i=t.indexOf(":");if(i>0){const r=t.slice(0,i),s=r.toLowerCase(),o=t.slice(i+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,i)=>{this.setHeaderEntries(i,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,i])=>{this.setHeaderEntries(t,i)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof Za?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new Za;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof Za?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(e.name,t);const r=("a"===e.op?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":const s=e.value;if(s){let o=this.headers.get(t);if(!o)return;o=o.filter(a=>-1===s.indexOf(a)),0===o.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}else this.headers.delete(t),this.normalizedNames.delete(t)}}setHeaderEntries(e,t){const i=(Array.isArray(t)?t:[t]).map(s=>s.toString()),r=e.toLowerCase();this.headers.set(r,i),this.maybeSetNormalizedName(e,r)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class Dse{encodeKey(e){return qH(e)}encodeValue(e){return qH(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const Rse=/%(\d[a-f0-9])/gi,Pse={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function qH(n){return encodeURIComponent(n).replace(Rse,(e,t)=>Pse[t]??e)}function tx(n){return`${n}`}class wu{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new Dse,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function Ise(n,e){const t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(r=>{const s=r.indexOf("="),[o,a]=-1==s?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,s)),e.decodeValue(r.slice(s+1))],l=t.get(o)||[];l.push(a),t.set(o,l)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const i=e.fromObject[t],r=Array.isArray(i)?i.map(tx):[tx(i)];this.map.set(t,r)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(i=>{const r=e[i];Array.isArray(r)?r.forEach(s=>{t.push({param:i,value:s,op:"a"})}):t.push({param:i,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new wu({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(tx(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let i=this.map.get(e.param)||[];const r=i.indexOf(tx(e.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(e.param,i):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class Nse{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function XH(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function YH(n){return typeof Blob<"u"&&n instanceof Blob}function ZH(n){return typeof FormData<"u"&&n instanceof FormData}class Ev{constructor(e,t,i,r){let s;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function Lse(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,s=r):s=i,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new Za),this.context||(this.context=new Nse),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=t;else{const a=t.indexOf("?");this.urlWithParams=t+(-1===a?"?":a<t.length-1?"&":"")+o}}else this.params=new wu,this.urlWithParams=t}serializeBody(){return null===this.body?null:XH(this.body)||YH(this.body)||ZH(this.body)||function Ose(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof wu?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||ZH(this.body)?null:YH(this.body)?this.body.type||null:XH(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof wu?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){const t=e.method||this.method,i=e.url||this.url,r=e.responseType||this.responseType,s=void 0!==e.body?e.body:this.body,o=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,a=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let l=e.headers||this.headers,c=e.params||this.params;const d=e.context??this.context;return void 0!==e.setHeaders&&(l=Object.keys(e.setHeaders).reduce((h,p)=>h.set(p,e.setHeaders[p]),l)),e.setParams&&(c=Object.keys(e.setParams).reduce((h,p)=>h.set(p,e.setParams[p]),c)),new Ev(t,i,s,{params:c,headers:l,context:d,reportProgress:a,responseType:r,withCredentials:o})}}var Fm=function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n}(Fm||{});class YI{constructor(e,t=200,i="OK"){this.headers=e.headers||new Za,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class ZI extends YI{constructor(e={}){super(e),this.type=Fm.ResponseHeader}clone(e={}){return new ZI({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class km extends YI{constructor(e={}){super(e),this.type=Fm.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new km({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class KH extends YI{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function KI(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let JH=(()=>{class n{constructor(t){this.handler=t}request(t,i,r={}){let s;if(t instanceof Ev)s=t;else{let l,c;l=r.headers instanceof Za?r.headers:new Za(r.headers),r.params&&(c=r.params instanceof wu?r.params:new wu({fromObject:r.params})),s=new Ev(t,i,void 0!==r.body?r.body:null,{headers:l,context:r.context,params:c,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const o=pt(s).pipe(Mp(l=>this.handler.handle(l)));if(t instanceof Ev||"events"===r.observe)return o;const a=o.pipe(Ll(l=>l instanceof km));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(Jt(l=>{if(null!==l.body&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return a.pipe(Jt(l=>{if(null!==l.body&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return a.pipe(Jt(l=>{if(null!==l.body&&"string"!=typeof l.body)throw new Error("Response is not a string.");return l.body}));default:return a.pipe(Jt(l=>l.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:(new wu).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,r={}){return this.request("PATCH",t,KI(r,i))}post(t,i,r={}){return this.request("POST",t,KI(r,i))}put(t,i,r={}){return this.request("PUT",t,KI(r,i))}static#e=this.\u0275fac=function(i){return new(i||n)(Le(QS))};static#t=this.\u0275prov=Ke({token:n,factory:n.\u0275fac})}return n})();function tz(n,e){return e(n)}function kse(n,e){return(t,i)=>e.intercept(t,{handle:r=>n(r,i)})}const Bse=new qe(""),Sv=new qe(""),nz=new qe("");function Vse(){let n=null;return(e,t)=>{null===n&&(n=(Ve(Bse,{optional:!0})??[]).reduceRight(kse,tz));const i=Ve(Sw),r=i.add();return n(e,t).pipe(by(()=>i.remove(r)))}}let iz=(()=>{class n extends QS{constructor(t,i){super(),this.backend=t,this.injector=i,this.chain=null,this.pendingTasks=Ve(Sw)}handle(t){if(null===this.chain){const r=Array.from(new Set([...this.injector.get(Sv),...this.injector.get(nz,[])]));this.chain=r.reduceRight((s,o)=>function Use(n,e,t){return(i,r)=>t.runInContext(()=>e(i,s=>n(s,r)))}(s,o,this.injector),tz)}const i=this.pendingTasks.add();return this.chain(t,r=>this.backend.handle(r)).pipe(by(()=>this.pendingTasks.remove(i)))}static#e=this.\u0275fac=function(i){return new(i||n)(Le(ex),Le(ss))};static#t=this.\u0275prov=Ke({token:n,factory:n.\u0275fac})}return n})();const Wse=/^\)\]\}',?\n/;let sz=(()=>{class n{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new se(-2800,!1);const i=this.xhrFactory;return(i.\u0275loadImpl?hi(i.\u0275loadImpl()):pt(null)).pipe(ys(()=>new Sn(s=>{const o=i.build();if(o.open(t.method,t.urlWithParams),t.withCredentials&&(o.withCredentials=!0),t.headers.forEach((b,v)=>o.setRequestHeader(b,v.join(","))),t.headers.has("Accept")||o.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const b=t.detectContentTypeHeader();null!==b&&o.setRequestHeader("Content-Type",b)}if(t.responseType){const b=t.responseType.toLowerCase();o.responseType="json"!==b?b:"text"}const a=t.serializeBody();let l=null;const c=()=>{if(null!==l)return l;const b=o.statusText||"OK",v=new Za(o.getAllResponseHeaders()),y=function jse(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}(o)||t.url;return l=new ZI({headers:v,status:o.status,statusText:b,url:y}),l},d=()=>{let{headers:b,status:v,statusText:y,url:w}=c(),E=null;204!==v&&(E=typeof o.response>"u"?o.responseText:o.response),0===v&&(v=E?200:0);let x=v>=200&&v<300;if("json"===t.responseType&&"string"==typeof E){const C=E;E=E.replace(Wse,"");try{E=""!==E?JSON.parse(E):null}catch(A){E=C,x&&(x=!1,E={error:A,text:E})}}x?(s.next(new km({body:E,headers:b,status:v,statusText:y,url:w||void 0})),s.complete()):s.error(new KH({error:E,headers:b,status:v,statusText:y,url:w||void 0}))},h=b=>{const{url:v}=c(),y=new KH({error:b,status:o.status||0,statusText:o.statusText||"Unknown Error",url:v||void 0});s.error(y)};let p=!1;const m=b=>{p||(s.next(c()),p=!0);let v={type:Fm.DownloadProgress,loaded:b.loaded};b.lengthComputable&&(v.total=b.total),"text"===t.responseType&&o.responseText&&(v.partialText=o.responseText),s.next(v)},g=b=>{let v={type:Fm.UploadProgress,loaded:b.loaded};b.lengthComputable&&(v.total=b.total),s.next(v)};return o.addEventListener("load",d),o.addEventListener("error",h),o.addEventListener("timeout",h),o.addEventListener("abort",h),t.reportProgress&&(o.addEventListener("progress",m),null!==a&&o.upload&&o.upload.addEventListener("progress",g)),o.send(a),s.next({type:Fm.Sent}),()=>{o.removeEventListener("error",h),o.removeEventListener("abort",h),o.removeEventListener("load",d),o.removeEventListener("timeout",h),t.reportProgress&&(o.removeEventListener("progress",m),null!==a&&o.upload&&o.upload.removeEventListener("progress",g)),o.readyState!==o.DONE&&o.abort()}})))}static#e=this.\u0275fac=function(i){return new(i||n)(Le(qF))};static#t=this.\u0275prov=Ke({token:n,factory:n.\u0275fac})}return n})();const JI=new qe("XSRF_ENABLED"),oz=new qe("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),az=new qe("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class lz{}let Xse=(()=>{class n{constructor(t,i,r){this.doc=t,this.platform=i,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=UF(t,this.cookieName),this.lastCookieString=t),this.lastToken}static#e=this.\u0275fac=function(i){return new(i||n)(Le(kr),Le(Oa),Le(oz))};static#t=this.\u0275prov=Ke({token:n,factory:n.\u0275fac})}return n})();function Yse(n,e){const t=n.url.toLowerCase();if(!Ve(JI)||"GET"===n.method||"HEAD"===n.method||t.startsWith("http://")||t.startsWith("https://"))return e(n);const i=Ve(lz).getToken(),r=Ve(az);return null!=i&&!n.headers.has(r)&&(n=n.clone({headers:n.headers.set(r,i)})),e(n)}var Eu=function(n){return n[n.Interceptors=0]="Interceptors",n[n.LegacyInterceptors=1]="LegacyInterceptors",n[n.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",n[n.NoXsrfProtection=3]="NoXsrfProtection",n[n.JsonpSupport=4]="JsonpSupport",n[n.RequestsMadeViaParent=5]="RequestsMadeViaParent",n[n.Fetch=6]="Fetch",n}(Eu||{});function Zse(...n){const e=[JH,sz,iz,{provide:QS,useExisting:iz},{provide:ex,useExisting:sz},{provide:Sv,useValue:Yse,multi:!0},{provide:JI,useValue:!0},{provide:lz,useClass:Xse}];for(const t of n)e.push(...t.\u0275providers);return function b_(n){return{\u0275providers:n}}(e)}const cz=new qe("LEGACY_INTERCEPTOR_FN");function Kse(){return function lh(n,e){return{\u0275kind:n,\u0275providers:e}}(Eu.LegacyInterceptors,[{provide:cz,useFactory:Vse},{provide:Sv,useExisting:cz,multi:!0}])}let Jse=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Fi({type:n});static#n=this.\u0275inj=Ci({providers:[Zse(Kse())]})}return n})(),ix=(()=>{class n{constructor(t){this.http=t,this.baseGameUrl=bv.serverURL+"/api/Game",this.baseUserUrl=bv.serverURL+"/api/User"}login(t){return this.http.post(this.baseUserUrl+"/Login",{name:t})}getGameById(t){return this.http.get(this.baseGameUrl+`/GetGameByID?GameId=${t}`)}getGamesList(){return this.http.get(this.baseGameUrl+"/GetGamesList")}createGame(t,i){return this.http.post(this.baseGameUrl+"/CreateGame",{userId:t,gameType:i})}setupGame(t,i){return this.http.post(this.baseGameUrl+"/SetupGame",{gameId:t,userId:i})}startGame(t){return this.http.post(this.baseGameUrl+"/StartGame",{gameId:t})}deleteGame(t){return this.http.post(this.baseGameUrl+"/DeleteGame",{gameId:t})}executeAction(t,i,r,s,o,a){return this.http.post(this.baseGameUrl+"/ExecuteAction",{GameId:t,PlayerId:i,ActionId:r,ItemId:s,ClientX:o,ClientY:a})}joinGame(t,i,r,s){return this.http.post(this.baseGameUrl+"/JoinGame",{gameId:t,playerId:i,user:r,type:s})}static#e=this.\u0275fac=function(i){return new(i||n)(Le(JH))};static#t=this.\u0275prov=Ke({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const roe=["rendererContainer"];let soe=(()=>{class n{constructor(t,i,r,s,o,a){this.signalRService=t,this.router=i,this.generalService=r,this.activatedRoute=s,this.unsubscriberService=o,this.dalService=a,this.interactionObjects=[],this.objectUnselectedColor="red",this.objectSelectedColor="blue",this.allItems={},this.gameId="",this.onMeshClickFunc=this.MeshClickFunc.bind(this),this.onMeshMouseOverFunc=this.MeshMouseOverFunc.bind(this),this.onMeshMouseOutFunc=this.MeshMouseOutFunc.bind(this)}ngOnInit(){this.gameId=this.activatedRoute.snapshot.paramMap.get("id"),console.log(this.gameId),this.signalRService.hubConnection.off("GameUpdated"),this.signalRService.hubConnection.on("GameUpdated",t=>{console.log("GameUpdated",t),this.updateGame(t)})}ngOnDestroy(){this.signalRService.hubConnection.off("GameUpdated")}ngAfterViewInit(){this.dalService.getGameById(this.gameId).subscribe(t=>{t?(this.gameData=t,this.playerData=this.getPlayerByUserId(this.generalService.User.id),this.initThree()):this.router.navigate([Os.GamesList])})}getPlayerByUserId(t){return(0,Dm.find)(this.gameData.players,i=>i.user?.id==t)}updateGame(t){console.log("updateGame",t),(0,Dm.forEach)(this.allItems,(i,r)=>{i.markForDelete=!0}),this.updateItem(t.table,null),(0,Dm.forEach)(this.allItems,(i,r)=>{i.markForDelete&&(this.removeAction(i),i.mesh?.parent?.remove(i.mesh),delete this.allItems[i.id])})}updateItem(t,i){console.log("updateItem",t,i);let r=this.allItems[t.id];r?(r.markForDelete=!1,r.clickActions=t.clickActions,r.visible=t.visible,r.hoverActions=t.hoverActions,this.updateItemPosition(r,mv.FromJson(t.position)),this.updateItemScale(r,mv.FromJson(t.scale)),this.updateItemRotation(r,mv.FromJson(t.rotation)),(0,Dm.forEach)(t.items,s=>{this.updateItem(s,r.mesh)}),this.handleItemClickActions(r),this.handleItemVisibility(r)):this.createItem(t,i)}updateItemPosition(t,i){console.log("updateItemPosition",t,i),t.position=i,this.generalService.deepEqual(i,t.mesh.position)||new qS(t.mesh.position).to(i,300).start()}updateItemScale(t,i){console.log("updateItemScale",t,i),t.scale=i,this.generalService.deepEqual(i,t.mesh.scale)||new qS(t.mesh.scale).to(i,300).start()}updateItemRotation(t,i){console.log("updateItemRotation",t,i),t.rotation=i,i={x:au_degToRad(i.x),y:au_degToRad(i.y),z:au_degToRad(i.z)},this.generalService.deepEqual(i,{x:t.mesh.rotation.x,y:t.mesh.rotation.y,z:t.mesh.rotation.z})||new qS(t.mesh.rotation).to(i,300).start()}resizeCanvasToDisplaySize(){const t=this.renderer.domElement,i=t.clientWidth,r=t.clientHeight;this.renderer.setSize(i,r,!1),this.camera.aspect=i/r,this.camera.updateProjectionMatrix()}initThree(){this.scene=new yS,this.scene.background=new je(16777215),this.camera=new nr(75,this.rendererContainer.nativeElement.clientWidth/this.rendererContainer.nativeElement.clientHeight,.1,1e3),this.camera.position.set(-1.8,.6,2.7),this.renderer=new z1({antialias:!0}),this.renderer.xr.enabled=!0,this.renderer.setSize(this.rendererContainer.nativeElement.clientWidth,this.rendererContainer.nativeElement.clientHeight),this.rendererContainer.nativeElement.appendChild(this.renderer.domElement),this.orbitControls=new wH(this.camera,this.renderer.domElement),this.orbitControls.addEventListener("change",()=>{this.renderer.render(this.scene,this.camera)}),this.orbitControls.enableZoom=!0,this.orbitControls.update(),this.interactionManager=new class{renderer;camera;domElement;bindEventsOnBodyElement;autoAdd;scene;mouse;supportsPointerEvents;interactiveObjects;closestObject;raycaster;treatTouchEventsAsMouseEvents;constructor(n,e,t,i){this.renderer=n,this.camera=e,this.domElement=t,this.bindEventsOnBodyElement=!(i&&typeof i.bindEventsOnBodyElement<"u")||i.bindEventsOnBodyElement,this.scene=i&&typeof i.scene<"u"?i.scene:null,this.scene&&(this.scene.onBeforeRender=()=>{this.autoAdd&&null!==this.scene&&this.scene.traverse(r=>{this.add(r),r.addEventListener("removed",s=>{this.remove(s.target)})}),this.update()}),this.autoAdd=!!(i&&typeof i.autoAdd<"u")&&i.autoAdd,this.autoAdd&&null===this.scene&&console.error("Attention: Options.scene needs to be set when using options.autoAdd"),this.mouse=new fe(-1,1),this.supportsPointerEvents=!!window.PointerEvent,this.interactiveObjects=[],this.closestObject=null,this.raycaster=new TI,t.addEventListener("click",this.onMouseClick),this.supportsPointerEvents&&(this.bindEventsOnBodyElement?t.ownerDocument.addEventListener("pointermove",this.onDocumentPointerMove):t.addEventListener("pointermove",this.onDocumentPointerMove),t.addEventListener("pointerdown",this.onPointerDown),t.addEventListener("pointerup",this.onPointerUp)),this.bindEventsOnBodyElement?t.ownerDocument.addEventListener("mousemove",this.onDocumentMouseMove):t.addEventListener("mousemove",this.onDocumentMouseMove),t.addEventListener("mousedown",this.onMouseDown),t.addEventListener("mouseup",this.onMouseUp),t.addEventListener("touchstart",this.onTouchStart,{passive:!0}),t.addEventListener("touchmove",this.onTouchMove,{passive:!0}),t.addEventListener("touchend",this.onTouchEnd,{passive:!0}),this.treatTouchEventsAsMouseEvents=!0}dispose=()=>{this.domElement.removeEventListener("click",this.onMouseClick),this.supportsPointerEvents&&(this.bindEventsOnBodyElement?this.domElement.ownerDocument.removeEventListener("pointermove",this.onDocumentPointerMove):this.domElement.removeEventListener("pointermove",this.onDocumentPointerMove),this.domElement.removeEventListener("pointerdown",this.onPointerDown),this.domElement.removeEventListener("pointerup",this.onPointerUp)),this.bindEventsOnBodyElement?this.domElement.ownerDocument.removeEventListener("mousemove",this.onDocumentMouseMove):this.domElement.removeEventListener("mousemove",this.onDocumentMouseMove),this.domElement.removeEventListener("mousedown",this.onMouseDown),this.domElement.removeEventListener("mouseup",this.onMouseUp),this.domElement.removeEventListener("touchstart",this.onTouchStart),this.domElement.removeEventListener("touchmove",this.onTouchMove),this.domElement.removeEventListener("touchend",this.onTouchEnd)};add=(n,e=[])=>{if(n&&!this.interactiveObjects.find(t=>t.target===n))if(e.length>0)e.forEach(t=>{let i=n.getObjectByName(t);if(i){let r=new IH(i,t);this.interactiveObjects.push(r)}});else{let t=new IH(n,n.name);this.interactiveObjects.push(t)}};remove=(n,e=[])=>{!n||(e.length>0?e.forEach(t=>{let i=n.getObjectByName(t);i&&(this.interactiveObjects=this.interactiveObjects.filter(r=>r.target!==i))}):this.interactiveObjects=this.interactiveObjects.filter(t=>t.target!==n))};update=()=>{this.raycaster.setFromCamera(this.mouse,this.camera),this.interactiveObjects.forEach(i=>{i.target&&this.checkIntersection(i)}),this.interactiveObjects.sort(function(i,r){return i.distance-r.distance});let e,t,n=this.interactiveObjects.find(i=>i.intersected)??null;if(n!=this.closestObject){if(this.closestObject){let i=new Ps("mouseout");this.dispatch(this.closestObject,i)}if(n){let i=new Ps("mouseover");this.dispatch(n,i)}this.closestObject=n}this.interactiveObjects.forEach(i=>{!i.intersected&&i.wasIntersected&&(e||(e=new Ps("mouseleave")),this.dispatch(i,e))}),this.interactiveObjects.forEach(i=>{i.intersected&&!i.wasIntersected&&(t||(t=new Ps("mouseenter")),this.dispatch(i,t))})};checkIntersection=n=>{let e=this.raycaster.intersectObjects([n.target],!0);if(n.wasIntersected=n.intersected,e.length>0){let t=e[0].distance;e.forEach(i=>{i.distance<t&&(t=i.distance)}),n.intersected=!0,n.distance=t}else n.intersected=!1};onDocumentMouseMove=n=>{this.mapPositionToPoint(this.mouse,n.clientX,n.clientY);let e=new Ps("mousemove",n);this.interactiveObjects.forEach(t=>{this.dispatch(t,e)})};onDocumentPointerMove=n=>{this.mapPositionToPoint(this.mouse,n.clientX,n.clientY);let e=new Ps("pointermove",n);this.interactiveObjects.forEach(t=>{this.dispatch(t,e)})};onTouchMove=n=>{n.touches.length>0&&this.mapPositionToPoint(this.mouse,n.touches[0].clientX,n.touches[0].clientY);let e=new Ps(this.treatTouchEventsAsMouseEvents?"mousemove":"touchmove",n);this.interactiveObjects.forEach(t=>{this.dispatch(t,e)})};onMouseClick=n=>{this.update();let e=new Ps("click",n);this.interactiveObjects.forEach(t=>{t.intersected&&this.dispatch(t,e)})};onMouseDown=n=>{this.mapPositionToPoint(this.mouse,n.clientX,n.clientY),this.update();let e=new Ps("mousedown",n);this.interactiveObjects.forEach(t=>{t.intersected&&this.dispatch(t,e)})};onPointerDown=n=>{this.mapPositionToPoint(this.mouse,n.clientX,n.clientY),this.update();let e=new Ps("pointerdown",n);this.interactiveObjects.forEach(t=>{t.intersected&&this.dispatch(t,e)})};onTouchStart=n=>{n.touches.length>0&&this.mapPositionToPoint(this.mouse,n.touches[0].clientX,n.touches[0].clientY),this.update();let e=new Ps(this.treatTouchEventsAsMouseEvents?"mousedown":"touchstart",n);this.interactiveObjects.forEach(t=>{t.intersected&&this.dispatch(t,e)})};onMouseUp=n=>{let e=new Ps("mouseup",n);this.interactiveObjects.forEach(t=>{this.dispatch(t,e)})};onPointerUp=n=>{let e=new Ps("pointerup",n);this.interactiveObjects.forEach(t=>{this.dispatch(t,e)})};onTouchEnd=n=>{n.touches.length>0&&this.mapPositionToPoint(this.mouse,n.touches[0].clientX,n.touches[0].clientY),this.update();let e=new Ps(this.treatTouchEventsAsMouseEvents?"mouseup":"touchend",n);this.interactiveObjects.forEach(t=>{this.dispatch(t,e)})};dispatch=(n,e)=>{n.target&&!e.cancelBubble&&(e.coords=this.mouse,e.distance=n.distance,e.intersected=n.intersected,n.target.dispatchEvent(e))};mapPositionToPoint=(n,e,t)=>{let i=this.renderer.domElement.getBoundingClientRect();n.x=(e-i.left)/i.width*2-1,n.y=-(t-i.top)/i.height*2+1}}(this.renderer,this.camera,this.renderer.domElement);const t=new k1(this.renderer);this.scene.environment=t.fromScene(new Hre,0).texture,this.renderer.setAnimationLoop(()=>{this.controllers&&this.controllers.forEach(i=>{this.handleController(i)}),this.orbitControls.update(),this.interactionManager.update(),this.renderer.render(this.scene,this.camera),NH()}),this.gltfLoader=new SH,this.stlLoader=new zre,this.objLoader=new Xre,this.textureLoader=new $V,document.body.appendChild(RH.createButton(this.renderer)),this.controllers=this.buildControllers(),this.controllers.forEach(i=>{i.addEventListener("selectstart",this.onSelectStart),i.addEventListener("selectend",this.onSelectEnd)}),this.loadGame()}onSelectStart(t){console.log("onSelectStart",t)}onSelectEnd(t){console.log("onSelectEnd",t)}buildControllers(){const t=new Vre,i=(new Nt).setFromPoints([new N(0,0,0),new N(0,0,-1)]),r=new Gr(i);r.scale.z=10;const s=[];for(let o=0;o<2;o++){const a=this.renderer.xr.getController(o);a.add(r.clone()),a.userData.selectPressed=!1,a.userData.selectPressedPrev=!1,this.scene.add(a),s.push(a);const l=this.renderer.xr.getControllerGrip(o);l.add(t.createControllerModel(l)),this.scene.add(l)}return s}handleController(t){if(t.userData.selectPressed)if(t.userData.selectPressedPrev){if(this.selectedObject){const i=t.getWorldDirection(new N).multiplyScalar(this.selectedObjectDistance).negate();this.selectedObject.position.copy(t.position.clone().add(i))}}else{t.children[0].scale.z=10;const i=new bt;i.extractRotation(t.matrixWorld);const r=new TI;r.ray.origin.setFromMatrixPosition(t.matrixWorld),r.ray.direction.set(0,0,-1).applyMatrix4(i);const s=r.intersectObjects(this.interactionObjects);s.length>0&&(t.children[0].scale.z=s[0].distance,this.selectedObject=s[0].object,this.selectedObject.material.color=this.objectSelectedColor,this.selectedObjectDistance=this.selectedObject.position.distanceTo(t.position))}else t.userData.selectPressedPrev&&(t.children[0].scale.z=10,null!=this.selectedObject&&(this.selectedObject.material.color=this.objectUnselectedColor,this.selectedObject=null));t.userData.selectPressedPrev=t.userData.selectPressed}createItem(t,i){if(console.log("createItem",t,i),t.asset){const r="\\assets\\games\\"+this.gameData.assets[t.asset].frontURL,s="\\assets\\games\\"+(this.gameData.assets[t.asset].backURL||this.gameData.assets[t.asset].frontURL),o=this.gameData.assets[t.asset].type;"OBJECT"==o&&((r.toLowerCase().endsWith("glb")||r.toLowerCase().endsWith("gltf"))&&this.gltfLoader.load(r,a=>{this.processItem(t,a.scene,i)}),r.toLowerCase().endsWith("stl")&&this.stlLoader.load(r,a=>{const l=new Ce(a);this.processItem(t,l,i)}),r.toLowerCase().endsWith("obj")&&this.objLoader.load(r,a=>{this.processItem(t,a,i)})),"TOKEN"==o&&this.textureLoader.load(r,a=>{let l=a.image.width/a.image.height,c=1,d=1/l;l<1&&(d=1,c=l);var h=[new bi({color:16777215,opacity:.5,transparent:!0}),new bi({color:16777215,opacity:.5,transparent:!0}),new bi({map:a,transparent:!0}),new bi({map:this.textureLoader.load(s),transparent:!0}),new bi({color:16777215,opacity:.5,transparent:!0}),new bi({color:16777215,opacity:.5,transparent:!0})];let p=new Ce(new si(c,c/100,d),h);this.processItem(t,p,i)})}else{const r=new $a;this.processItem(t,r,i)}}processItem(t,i,r){console.log("processItem",t,i,r),i.position.set(t.position.x,t.position.y,t.position.z),i.rotation.set(au_degToRad(t.rotation.x),au_degToRad(t.rotation.y),au_degToRad(t.rotation.z)),i.scale.set(t.scale.x,t.scale.y,t.scale.z),r?r.add(i):this.scene.add(i),i.userData.ItemData=t,t.mesh=i,(0,Dm.forEach)(t.items,s=>{this.createItem(s,i)}),this.handleItemClickActions(t),this.handleItemVisibility(t),this.allItems[t.id]=t}handleItemClickActions(t){console.log("handleItemClickActions",t);let i=null;this.playerData&&(i=t.clickActions[this.playerData.id]||t.clickActions[""]),i?this.addClickAction(t,i):this.removeAction(t)}handleItemVisibility(t){console.log("handleItemVisibility",t);let i=0==(0,Dm.keys)(t.visible).length;this.playerData&&(i=i||1==t.visible[this.playerData.id]),console.log("handleItemVisibility","isVisible",i),t.mesh.visible=i,i||this.removeAction(t)}MeshClickFunc(t){console.log(t),this.playerData&&this.signalRService.executeAction(this.gameData.id,this.playerData.id,t.target.userData.ItemData.id,t.target.userData.ItemData.clickActions[this.playerData.id]||t.target.userData.ItemData.clickActions[""],"",0,0)}MeshMouseOverFunc(t){document.body.style.cursor="pointer",this.orbitControls.enabled=!1}MeshMouseOutFunc(t){document.body.style.cursor="default",this.orbitControls.enabled=!0}addClickAction(t,i){console.log("addClickAction",t,i),this.removeAction(t),t.mesh.addEventListener("click",this.onMeshClickFunc),t.mesh.addEventListener("mouseover",this.onMeshMouseOverFunc),t.mesh.addEventListener("mouseout",this.onMeshMouseOutFunc),this.interactionManager.add(t.mesh)}removeAction(t){console.log("removeAction",t),t.mesh.removeEventListener("click",this.onMeshClickFunc),t.mesh.removeEventListener("click",this.onMeshMouseOverFunc),this.interactionManager.remove(t.mesh)}loadGame(){console.log("loadGame"),this.createItem(this.gameData.table,null)}ngOnChanges(t){}static#e=this.\u0275fac=function(i){return new(i||n)(le(wv),le(Mr),le(Om),le(Fl),le(XS),le(ix))};static#t=this.\u0275cmp=Ki({type:n,selectors:[["app-game-play"]],viewQuery:function(i,r){if(1&i&&OT(roe,7),2&i){let s;pp(s=mp())&&(r.rendererContainer=s.first)}},features:[kn([XS]),Vi],decls:4,vars:0,consts:[[1,"main-div"],[2,"flex-shrink","0"],[2,"flex-grow","1","border","1px dashed red"],["rendererContainer",""]],template:function(i,r){1&i&&(Pt(0,"div",0),Fr(1,"div",1)(2,"div",2,3),At())},styles:[".main-div[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;height:100%;background:yellow}"]})}return n})(),rx=(()=>{class n{constructor(t,i){this.router=t,this.generalService=i}canActivate(){return!!this.generalService.User||(this.router.navigate([Os.Home]),!1)}static#e=this.\u0275fac=function(i){return new(i||n)(Le(Mr),Le(Om))};static#t=this.\u0275prov=Ke({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Wr=(()=>class n{static STARTS_WITH="startsWith";static CONTAINS="contains";static NOT_CONTAINS="notContains";static ENDS_WITH="endsWith";static EQUALS="equals";static NOT_EQUALS="notEquals";static IN="in";static LESS_THAN="lt";static LESS_THAN_OR_EQUAL_TO="lte";static GREATER_THAN="gt";static GREATER_THAN_OR_EQUAL_TO="gte";static BETWEEN="between";static IS="is";static IS_NOT="isNot";static BEFORE="before";static AFTER="after";static DATE_IS="dateIs";static DATE_IS_NOT="dateIsNot";static DATE_BEFORE="dateBefore";static DATE_AFTER="dateAfter"})(),aoe=(()=>{class n{ripple=!1;overlayOptions={};filterMatchModeOptions={text:[Wr.STARTS_WITH,Wr.CONTAINS,Wr.NOT_CONTAINS,Wr.ENDS_WITH,Wr.EQUALS,Wr.NOT_EQUALS],numeric:[Wr.EQUALS,Wr.NOT_EQUALS,Wr.LESS_THAN,Wr.LESS_THAN_OR_EQUAL_TO,Wr.GREATER_THAN,Wr.GREATER_THAN_OR_EQUAL_TO],date:[Wr.DATE_IS,Wr.DATE_IS_NOT,Wr.DATE_BEFORE,Wr.DATE_AFTER]};translation={startsWith:"Starts with",contains:"Contains",notContains:"Not contains",endsWith:"Ends with",equals:"Equals",notEquals:"Not equals",noFilter:"No Filter",lt:"Less than",lte:"Less than or equal to",gt:"Greater than",gte:"Greater than or equal to",is:"Is",isNot:"Is not",before:"Before",after:"After",dateIs:"Date is",dateIsNot:"Date is not",dateBefore:"Date is before",dateAfter:"Date is after",clear:"Clear",apply:"Apply",matchAll:"Match All",matchAny:"Match Any",addRule:"Add Rule",removeRule:"Remove Rule",accept:"Yes",reject:"No",choose:"Choose",upload:"Upload",cancel:"Cancel",pending:"Pending",fileSizeTypes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],chooseYear:"Choose Year",chooseMonth:"Choose Month",chooseDate:"Choose Date",prevDecade:"Previous Decade",nextDecade:"Next Decade",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",prevHour:"Previous Hour",nextHour:"Next Hour",prevMinute:"Previous Minute",nextMinute:"Next Minute",prevSecond:"Previous Second",nextSecond:"Next Second",am:"am",pm:"pm",dateFormat:"mm/dd/yy",firstDayOfWeek:0,today:"Today",weekHeader:"Wk",weak:"Weak",medium:"Medium",strong:"Strong",passwordPrompt:"Enter a password",emptyMessage:"No results found",searchMessage:"{0} results are available",selectionMessage:"{0} items selected",emptySelectionMessage:"No selected item",emptySearchMessage:"No results found",emptyFilterMessage:"No results found",aria:{trueLabel:"True",falseLabel:"False",nullLabel:"Not Selected",star:"1 star",stars:"{star} stars",selectAll:"All items selected",unselectAll:"All items unselected",close:"Close",previous:"Previous",next:"Next",navigation:"Navigation",scrollTop:"Scroll Top",moveTop:"Move Top",moveUp:"Move Up",moveDown:"Move Down",moveBottom:"Move Bottom",moveToTarget:"Move to Target",moveToSource:"Move to Source",moveAllToTarget:"Move All to Target",moveAllToSource:"Move All to Source",pageLabel:"{page}",firstPageLabel:"First Page",lastPageLabel:"Last Page",nextPageLabel:"Next Page",prevPageLabel:"Previous Page",rowsPerPageLabel:"Rows per page",previousPageLabel:"Previous Page",jumpToPageDropdownLabel:"Jump to Page Dropdown",jumpToPageInputLabel:"Jump to Page Input",selectRow:"Row Selected",unselectRow:"Row Unselected",expandRow:"Row Expanded",collapseRow:"Row Collapsed",showFilterMenu:"Show Filter Menu",hideFilterMenu:"Hide Filter Menu",filterOperator:"Filter Operator",filterConstraint:"Filter Constraint",editRow:"Row Edit",saveEdit:"Save Edit",cancelEdit:"Cancel Edit",listView:"List View",gridView:"Grid View",slide:"Slide",slideNumber:"{slideNumber}",zoomImage:"Zoom Image",zoomIn:"Zoom In",zoomOut:"Zoom Out",rotateRight:"Rotate Right",rotateLeft:"Rotate Left"}};zIndex={modal:1100,overlay:1e3,menu:1e3,tooltip:1100};translationSource=new Xr;translationObserver=this.translationSource.asObservable();getTranslation(t){return this.translation[t]}setTranslation(t){this.translation={...this.translation,...t},this.translationSource.next(this.translation)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Ke({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),uz=(()=>{class n{template;type;name;constructor(t){this.template=t}getType(){return this.name}static \u0275fac=function(i){return new(i||n)(le(Va))};static \u0275dir=ft({type:n,selectors:[["","pTemplate",""]],inputs:{type:"type",name:["pTemplate","name"]}})}return n})(),QI=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=Fi({type:n});static \u0275inj=Ci({imports:[bp]})}return n})();class xv{static equals(e,t,i){return i?this.resolveFieldData(e,i)===this.resolveFieldData(t,i):this.equalsByValue(e,t)}static equalsByValue(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var s,o,a,i=Array.isArray(e),r=Array.isArray(t);if(i&&r){if((o=e.length)!=t.length)return!1;for(s=o;0!=s--;)if(!this.equalsByValue(e[s],t[s]))return!1;return!0}if(i!=r)return!1;var l=this.isDate(e),c=this.isDate(t);if(l!=c)return!1;if(l&&c)return e.getTime()==t.getTime();var d=e instanceof RegExp,h=t instanceof RegExp;if(d!=h)return!1;if(d&&h)return e.toString()==t.toString();var p=Object.keys(e);if((o=p.length)!==Object.keys(t).length)return!1;for(s=o;0!=s--;)if(!Object.prototype.hasOwnProperty.call(t,p[s]))return!1;for(s=o;0!=s--;)if(!this.equalsByValue(e[a=p[s]],t[a]))return!1;return!0}return e!=e&&t!=t}static resolveFieldData(e,t){if(e&&t){if(this.isFunction(t))return t(e);if(-1==t.indexOf("."))return e[t];{let i=t.split("."),r=e;for(let s=0,o=i.length;s<o;++s){if(null==r)return null;r=r[i[s]]}return r}}return null}static isFunction(e){return!!(e&&e.constructor&&e.call&&e.apply)}static reorderArray(e,t,i){e&&t!==i&&(i>=e.length&&(i%=e.length,t%=e.length),e.splice(i,0,e.splice(t,1)[0]))}static insertIntoOrderedArray(e,t,i,r){if(i.length>0){let s=!1;for(let o=0;o<i.length;o++)if(this.findIndexInList(i[o],r)>t){i.splice(o,0,e),s=!0;break}s||i.push(e)}else i.push(e)}static findIndexInList(e,t){let i=-1;if(t)for(let r=0;r<t.length;r++)if(t[r]==e){i=r;break}return i}static contains(e,t){if(null!=e&&t&&t.length)for(let i of t)if(this.equals(e,i))return!0;return!1}static removeAccents(e){return e&&e.search(/[\xC0-\xFF]/g)>-1&&(e=e.replace(/[\xC0-\xC5]/g,"A").replace(/[\xC6]/g,"AE").replace(/[\xC7]/g,"C").replace(/[\xC8-\xCB]/g,"E").replace(/[\xCC-\xCF]/g,"I").replace(/[\xD0]/g,"D").replace(/[\xD1]/g,"N").replace(/[\xD2-\xD6\xD8]/g,"O").replace(/[\xD9-\xDC]/g,"U").replace(/[\xDD]/g,"Y").replace(/[\xDE]/g,"P").replace(/[\xE0-\xE5]/g,"a").replace(/[\xE6]/g,"ae").replace(/[\xE7]/g,"c").replace(/[\xE8-\xEB]/g,"e").replace(/[\xEC-\xEF]/g,"i").replace(/[\xF1]/g,"n").replace(/[\xF2-\xF6\xF8]/g,"o").replace(/[\xF9-\xFC]/g,"u").replace(/[\xFE]/g,"p").replace(/[\xFD\xFF]/g,"y")),e}static isDate(e){return"[object Date]"===Object.prototype.toString.call(e)}static isEmpty(e){return null==e||""===e||Array.isArray(e)&&0===e.length||!this.isDate(e)&&"object"==typeof e&&0===Object.keys(e).length}static isNotEmpty(e){return!this.isEmpty(e)}static compare(e,t,i,r=1){let s=-1;const o=this.isEmpty(e),a=this.isEmpty(t);return s=o&&a?0:o?r:a?-r:"string"==typeof e&&"string"==typeof t?e.localeCompare(t,i,{numeric:!0}):e<t?-1:e>t?1:0,s}static sort(e,t,i=1,r,s=1){return(1===s?i:s)*xv.compare(e,t,r,i)}static merge(e,t){if(null!=e||null!=t)return null!=e&&"object"!=typeof e||null!=t&&"object"!=typeof t?null!=e&&"string"!=typeof e||null!=t&&"string"!=typeof t?t||e:[e||"",t||""].join(" "):{...e||{},...t||{}}}static isPrintableCharacter(e=""){return this.isNotEmpty(e)&&1===e.length&&e.match(/\S| /)}static getItemValue(e,...t){return this.isFunction(e)?e(...t):e}static findLastIndex(e,t){let i=-1;if(this.isNotEmpty(e))try{i=e.findLastIndex(t)}catch{i=e.lastIndexOf([...e].reverse().find(t))}return i}static findLast(e,t){let i;if(this.isNotEmpty(e))try{i=e.findLast(t)}catch{i=[...e].reverse().find(t)}return i}}var dz=0;!function coe(){let n=[];const r=s=>s&&parseInt(s.style.zIndex,10)||0}();const uoe=["*"];let hz=(()=>{class n{label;spin=!1;styleClass;role;ariaLabel;ariaHidden;ngOnInit(){this.getAttributes()}getAttributes(){const t=xv.isEmpty(this.label);this.role=t?void 0:"img",this.ariaLabel=t?void 0:this.label,this.ariaHidden=t}getClassNames(){return`p-icon ${this.styleClass?this.styleClass+" ":""}${this.spin?"p-icon-spin":""}`}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=Ki({type:n,selectors:[["ng-component"]],hostAttrs:[1,"p-element","p-icon-wrapper"],inputs:{label:"label",spin:"spin",styleClass:"styleClass"},standalone:!0,features:[J_],ngContentSelectors:uoe,decls:1,vars:0,template:function(i,r){1&i&&(dT(),hT(0))},encapsulation:2,changeDetection:0})}return n})(),fz=(()=>{class n extends hz{pathId;ngOnInit(){this.pathId="url(#"+function loe(n="pn_id_"){return`${n}${++dz}`}()+")"}static \u0275fac=function(){let t;return function(r){return(t||(t=fi(n)))(r||n)}}();static \u0275cmp=Ki({type:n,selectors:[["SpinnerIcon"]],standalone:!0,features:[mn,J_],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M6.99701 14C5.85441 13.999 4.72939 13.7186 3.72012 13.1832C2.71084 12.6478 1.84795 11.8737 1.20673 10.9284C0.565504 9.98305 0.165424 8.89526 0.041387 7.75989C-0.0826496 6.62453 0.073125 5.47607 0.495122 4.4147C0.917119 3.35333 1.59252 2.4113 2.46241 1.67077C3.33229 0.930247 4.37024 0.413729 5.4857 0.166275C6.60117 -0.0811796 7.76026 -0.0520535 8.86188 0.251112C9.9635 0.554278 10.9742 1.12227 11.8057 1.90555C11.915 2.01493 11.9764 2.16319 11.9764 2.31778C11.9764 2.47236 11.915 2.62062 11.8057 2.73C11.7521 2.78503 11.688 2.82877 11.6171 2.85864C11.5463 2.8885 11.4702 2.90389 11.3933 2.90389C11.3165 2.90389 11.2404 2.8885 11.1695 2.85864C11.0987 2.82877 11.0346 2.78503 10.9809 2.73C9.9998 1.81273 8.73246 1.26138 7.39226 1.16876C6.05206 1.07615 4.72086 1.44794 3.62279 2.22152C2.52471 2.99511 1.72683 4.12325 1.36345 5.41602C1.00008 6.70879 1.09342 8.08723 1.62775 9.31926C2.16209 10.5513 3.10478 11.5617 4.29713 12.1803C5.48947 12.7989 6.85865 12.988 8.17414 12.7157C9.48963 12.4435 10.6711 11.7264 11.5196 10.6854C12.3681 9.64432 12.8319 8.34282 12.8328 7C12.8328 6.84529 12.8943 6.69692 13.0038 6.58752C13.1132 6.47812 13.2616 6.41667 13.4164 6.41667C13.5712 6.41667 13.7196 6.47812 13.8291 6.58752C13.9385 6.69692 14 6.84529 14 7C14 8.85651 13.2622 10.637 11.9489 11.9497C10.6356 13.2625 8.85432 14 6.99701 14Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(i,r){1&i&&(cf(),Pt(0,"svg",0)(1,"g"),Fr(2,"path",1),At(),Pt(3,"defs")(4,"clipPath",2),Fr(5,"rect",3),At()()()),2&i&&(Cl(r.getClassNames()),ri("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role),Rt(1),ri("clip-path",r.pathId),Rt(3),vt("id",r.pathId))},encapsulation:2})}return n})(),Ns=(()=>{class n{static zindex=1e3;static calculatedScrollbarWidth=null;static calculatedScrollbarHeight=null;static browser;static addClass(t,i){t&&i&&(t.classList?t.classList.add(i):t.className+=" "+i)}static addMultipleClasses(t,i){if(t&&i)if(t.classList){let r=i.trim().split(" ");for(let s=0;s<r.length;s++)t.classList.add(r[s])}else{let r=i.split(" ");for(let s=0;s<r.length;s++)t.className+=" "+r[s]}}static removeClass(t,i){t&&i&&(t.classList?t.classList.remove(i):t.className=t.className.replace(new RegExp("(^|\\b)"+i.split(" ").join("|")+"(\\b|$)","gi")," "))}static hasClass(t,i){return!(!t||!i)&&(t.classList?t.classList.contains(i):new RegExp("(^| )"+i+"( |$)","gi").test(t.className))}static siblings(t){return Array.prototype.filter.call(t.parentNode.children,function(i){return i!==t})}static find(t,i){return Array.from(t.querySelectorAll(i))}static findSingle(t,i){return this.isElement(t)?t.querySelector(i):null}static index(t){let i=t.parentNode.childNodes,r=0;for(var s=0;s<i.length;s++){if(i[s]==t)return r;1==i[s].nodeType&&r++}return-1}static indexWithinGroup(t,i){let r=t.parentNode?t.parentNode.childNodes:[],s=0;for(var o=0;o<r.length;o++){if(r[o]==t)return s;r[o].attributes&&r[o].attributes[i]&&1==r[o].nodeType&&s++}return-1}static appendOverlay(t,i,r="self"){"self"!==r&&t&&i&&this.appendChild(t,i)}static alignOverlay(t,i,r="self",s=!0){t&&i&&(s&&(t.style.minWidth=`${n.getOuterWidth(i)}px`),"self"===r?this.relativePosition(t,i):this.absolutePosition(t,i))}static relativePosition(t,i){const r=y=>{if(y)return"relative"===getComputedStyle(y).getPropertyValue("position")?y:r(y.parentElement)},s=t.offsetParent?{width:t.offsetWidth,height:t.offsetHeight}:this.getHiddenElementDimensions(t),o=i.offsetHeight,a=i.getBoundingClientRect(),l=this.getWindowScrollTop(),c=this.getWindowScrollLeft(),d=this.getViewport(),p=r(t)?.getBoundingClientRect()||{top:-1*l,left:-1*c};let m,g;a.top+o+s.height>d.height?(m=a.top-p.top-s.height,t.style.transformOrigin="bottom",a.top+m<0&&(m=-1*a.top)):(m=o+a.top-p.top,t.style.transformOrigin="top");const b=a.left+s.width-d.width;g=s.width>d.width?-1*(a.left-p.left):b>0?a.left-p.left-b:a.left-p.left,t.style.top=m+"px",t.style.left=g+"px"}static absolutePosition(t,i){const r=t.offsetParent?{width:t.offsetWidth,height:t.offsetHeight}:this.getHiddenElementDimensions(t),s=r.height,o=r.width,a=i.offsetHeight,l=i.offsetWidth,c=i.getBoundingClientRect(),d=this.getWindowScrollTop(),h=this.getWindowScrollLeft(),p=this.getViewport();let m,g;c.top+a+s>p.height?(m=c.top+d-s,t.style.transformOrigin="bottom",m<0&&(m=d)):(m=a+c.top+d,t.style.transformOrigin="top"),g=c.left+o>p.width?Math.max(0,c.left+h+l-o):c.left+h,t.style.top=m+"px",t.style.left=g+"px"}static getParents(t,i=[]){return null===t.parentNode?i:this.getParents(t.parentNode,i.concat([t.parentNode]))}static getScrollableParents(t){let i=[];if(t){let r=this.getParents(t);const s=/(auto|scroll)/,o=a=>{let l=window.getComputedStyle(a,null);return s.test(l.getPropertyValue("overflow"))||s.test(l.getPropertyValue("overflowX"))||s.test(l.getPropertyValue("overflowY"))};for(let a of r){let l=1===a.nodeType&&a.dataset.scrollselectors;if(l){let c=l.split(",");for(let d of c){let h=this.findSingle(a,d);h&&o(h)&&i.push(h)}}9!==a.nodeType&&o(a)&&i.push(a)}}return i}static getHiddenElementOuterHeight(t){t.style.visibility="hidden",t.style.display="block";let i=t.offsetHeight;return t.style.display="none",t.style.visibility="visible",i}static getHiddenElementOuterWidth(t){t.style.visibility="hidden",t.style.display="block";let i=t.offsetWidth;return t.style.display="none",t.style.visibility="visible",i}static getHiddenElementDimensions(t){let i={};return t.style.visibility="hidden",t.style.display="block",i.width=t.offsetWidth,i.height=t.offsetHeight,t.style.display="none",t.style.visibility="visible",i}static scrollInView(t,i){let r=getComputedStyle(t).getPropertyValue("borderTopWidth"),s=r?parseFloat(r):0,o=getComputedStyle(t).getPropertyValue("paddingTop"),a=o?parseFloat(o):0,l=t.getBoundingClientRect(),d=i.getBoundingClientRect().top+document.body.scrollTop-(l.top+document.body.scrollTop)-s-a,h=t.scrollTop,p=t.clientHeight,m=this.getOuterHeight(i);d<0?t.scrollTop=h+d:d+m>p&&(t.scrollTop=h+d-p+m)}static fadeIn(t,i){t.style.opacity=0;let r=+new Date,s=0,o=function(){s=+t.style.opacity.replace(",",".")+((new Date).getTime()-r)/i,t.style.opacity=s,r=+new Date,+s<1&&(window.requestAnimationFrame&&requestAnimationFrame(o)||setTimeout(o,16))};o()}static fadeOut(t,i){var r=1,a=50/i;let l=setInterval(()=>{(r-=a)<=0&&(r=0,clearInterval(l)),t.style.opacity=r},50)}static getWindowScrollTop(){let t=document.documentElement;return(window.pageYOffset||t.scrollTop)-(t.clientTop||0)}static getWindowScrollLeft(){let t=document.documentElement;return(window.pageXOffset||t.scrollLeft)-(t.clientLeft||0)}static matches(t,i){var r=Element.prototype;return(r.matches||r.webkitMatchesSelector||r.mozMatchesSelector||r.msMatchesSelector||function(o){return-1!==[].indexOf.call(document.querySelectorAll(o),this)}).call(t,i)}static getOuterWidth(t,i){let r=t.offsetWidth;if(i){let s=getComputedStyle(t);r+=parseFloat(s.marginLeft)+parseFloat(s.marginRight)}return r}static getHorizontalPadding(t){let i=getComputedStyle(t);return parseFloat(i.paddingLeft)+parseFloat(i.paddingRight)}static getHorizontalMargin(t){let i=getComputedStyle(t);return parseFloat(i.marginLeft)+parseFloat(i.marginRight)}static innerWidth(t){let i=t.offsetWidth,r=getComputedStyle(t);return i+=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight),i}static width(t){let i=t.offsetWidth,r=getComputedStyle(t);return i-=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight),i}static getInnerHeight(t){let i=t.offsetHeight,r=getComputedStyle(t);return i+=parseFloat(r.paddingTop)+parseFloat(r.paddingBottom),i}static getOuterHeight(t,i){let r=t.offsetHeight;if(i){let s=getComputedStyle(t);r+=parseFloat(s.marginTop)+parseFloat(s.marginBottom)}return r}static getHeight(t){let i=t.offsetHeight,r=getComputedStyle(t);return i-=parseFloat(r.paddingTop)+parseFloat(r.paddingBottom)+parseFloat(r.borderTopWidth)+parseFloat(r.borderBottomWidth),i}static getWidth(t){let i=t.offsetWidth,r=getComputedStyle(t);return i-=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight)+parseFloat(r.borderLeftWidth)+parseFloat(r.borderRightWidth),i}static getViewport(){let t=window,i=document,r=i.documentElement,s=i.getElementsByTagName("body")[0];return{width:t.innerWidth||r.clientWidth||s.clientWidth,height:t.innerHeight||r.clientHeight||s.clientHeight}}static getOffset(t){var i=t.getBoundingClientRect();return{top:i.top+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0),left:i.left+(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0)}}static replaceElementWith(t,i){let r=t.parentNode;if(!r)throw"Can't replace element";return r.replaceChild(i,t)}static getUserAgent(){if(navigator&&this.isClient())return navigator.userAgent}static isIE(){var t=window.navigator.userAgent;return t.indexOf("MSIE ")>0||(t.indexOf("Trident/")>0?(t.indexOf("rv:"),!0):t.indexOf("Edge/")>0)}static isIOS(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream}static isAndroid(){return/(android)/i.test(navigator.userAgent)}static isTouchDevice(){return"ontouchstart"in window||navigator.maxTouchPoints>0}static appendChild(t,i){if(this.isElement(i))i.appendChild(t);else{if(!(i&&i.el&&i.el.nativeElement))throw"Cannot append "+i+" to "+t;i.el.nativeElement.appendChild(t)}}static removeChild(t,i){if(this.isElement(i))i.removeChild(t);else{if(!i.el||!i.el.nativeElement)throw"Cannot remove "+t+" from "+i;i.el.nativeElement.removeChild(t)}}static removeElement(t){"remove"in Element.prototype?t.remove():t.parentNode.removeChild(t)}static isElement(t){return"object"==typeof HTMLElement?t instanceof HTMLElement:t&&"object"==typeof t&&null!==t&&1===t.nodeType&&"string"==typeof t.nodeName}static calculateScrollbarWidth(t){if(t){let i=getComputedStyle(t);return t.offsetWidth-t.clientWidth-parseFloat(i.borderLeftWidth)-parseFloat(i.borderRightWidth)}{if(null!==this.calculatedScrollbarWidth)return this.calculatedScrollbarWidth;let i=document.createElement("div");i.className="p-scrollbar-measure",document.body.appendChild(i);let r=i.offsetWidth-i.clientWidth;return document.body.removeChild(i),this.calculatedScrollbarWidth=r,r}}static calculateScrollbarHeight(){if(null!==this.calculatedScrollbarHeight)return this.calculatedScrollbarHeight;let t=document.createElement("div");t.className="p-scrollbar-measure",document.body.appendChild(t);let i=t.offsetHeight-t.clientHeight;return document.body.removeChild(t),this.calculatedScrollbarWidth=i,i}static invokeElementMethod(t,i,r){t[i].apply(t,r)}static clearSelection(){if(window.getSelection)window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().rangeCount>0&&window.getSelection().getRangeAt(0).getClientRects().length>0&&window.getSelection().removeAllRanges();else if(document.selection&&document.selection.empty)try{document.selection.empty()}catch{}}static getBrowser(){if(!this.browser){let t=this.resolveUserAgent();this.browser={},t.browser&&(this.browser[t.browser]=!0,this.browser.version=t.version),this.browser.chrome?this.browser.webkit=!0:this.browser.webkit&&(this.browser.safari=!0)}return this.browser}static resolveUserAgent(){let t=navigator.userAgent.toLowerCase(),i=/(chrome)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[];return{browser:i[1]||"",version:i[2]||"0"}}static isInteger(t){return Number.isInteger?Number.isInteger(t):"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}static isHidden(t){return!t||null===t.offsetParent}static isVisible(t){return t&&null!=t.offsetParent}static isExist(t){return null!==t&&typeof t<"u"&&t.nodeName&&t.parentNode}static focus(t,i){t&&document.activeElement!==t&&t.focus(i)}static getFocusableElements(t){let i=n.find(t,'button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),\n                [href]:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),\n                input:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]), select:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),\n                textarea:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]), [tabIndex]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),\n                [contenteditable]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]):not(.p-disabled)'),r=[];for(let s of i)(s.offsetWidth||s.offsetHeight||s.getClientRects().length)&&r.push(s);return r}static getNextFocusableElement(t,i=!1){const r=n.getFocusableElements(t);let s=0;if(r&&r.length>0){const o=r.indexOf(r[0].ownerDocument.activeElement);i?s=-1==o||0===o?r.length-1:o-1:-1!=o&&o!==r.length-1&&(s=o+1)}return r[s]}static generateZIndex(){return this.zindex=this.zindex||999,++this.zindex}static getSelection(){return window.getSelection?window.getSelection().toString():document.getSelection?document.getSelection().toString():document.selection?document.selection.createRange().text:null}static getTargetElement(t,i){if(!t)return null;switch(t){case"document":return document;case"window":return window;case"@next":return i?.nextElementSibling;case"@prev":return i?.previousElementSibling;case"@parent":return i?.parentElement;case"@grandparent":return i?.parentElement.parentElement;default:const r=typeof t;if("string"===r)return document.querySelector(t);if("object"===r&&t.hasOwnProperty("nativeElement"))return this.isExist(t.nativeElement)?t.nativeElement:void 0;const o=(a=t)&&a.constructor&&a.call&&a.apply?t():t;return o&&9===o.nodeType||this.isExist(o)?o:null}var a}static isClient(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}static getAttribute(t,i){if(t){const r=t.getAttribute(i);return isNaN(r)?"true"===r||"false"===r?"true"===r:r:+r}}static calculateBodyScrollbarWidth(){return window.innerWidth-document.documentElement.offsetWidth}static blockBodyScroll(t="p-overflow-hidden"){document.body.style.setProperty("--scrollbar-width",this.calculateBodyScrollbarWidth()+"px"),this.addClass(document.body,t)}static unblockBodyScroll(t="p-overflow-hidden"){document.body.style.removeProperty("--scrollbar-width"),this.removeClass(document.body,t)}}return n})(),doe=(()=>{class n{document;platformId;renderer;el;zone;config;constructor(t,i,r,s,o,a){this.document=t,this.platformId=i,this.renderer=r,this.el=s,this.zone=o,this.config=a}animationListener;mouseDownListener;timeout;ngAfterViewInit(){(function i$(n){return n===jF})(this.platformId)&&this.config&&this.config.ripple&&this.zone.runOutsideAngular(()=>{this.create(),this.mouseDownListener=this.renderer.listen(this.el.nativeElement,"mousedown",this.onMouseDown.bind(this))})}onMouseDown(t){let i=this.getInk();if(!i||"none"===this.document.defaultView?.getComputedStyle(i,null).display)return;if(Ns.removeClass(i,"p-ink-active"),!Ns.getHeight(i)&&!Ns.getWidth(i)){let a=Math.max(Ns.getOuterWidth(this.el.nativeElement),Ns.getOuterHeight(this.el.nativeElement));i.style.height=a+"px",i.style.width=a+"px"}let r=Ns.getOffset(this.el.nativeElement),s=t.pageX-r.left+this.document.body.scrollTop-Ns.getWidth(i)/2,o=t.pageY-r.top+this.document.body.scrollLeft-Ns.getHeight(i)/2;this.renderer.setStyle(i,"top",o+"px"),this.renderer.setStyle(i,"left",s+"px"),Ns.addClass(i,"p-ink-active"),this.timeout=setTimeout(()=>{let a=this.getInk();a&&Ns.removeClass(a,"p-ink-active")},401)}getInk(){const t=this.el.nativeElement.children;for(let i=0;i<t.length;i++)if("string"==typeof t[i].className&&-1!==t[i].className.indexOf("p-ink"))return t[i];return null}resetInk(){let t=this.getInk();t&&Ns.removeClass(t,"p-ink-active")}onAnimationEnd(t){this.timeout&&clearTimeout(this.timeout),Ns.removeClass(t.currentTarget,"p-ink-active")}create(){let t=this.renderer.createElement("span");this.renderer.addClass(t,"p-ink"),this.renderer.appendChild(this.el.nativeElement,t),this.renderer.setAttribute(t,"aria-hidden","true"),this.renderer.setAttribute(t,"role","presentation"),this.animationListener||(this.animationListener=this.renderer.listen(t,"animationend",this.onAnimationEnd.bind(this)))}remove(){let t=this.getInk();t&&(this.mouseDownListener&&this.mouseDownListener(),this.animationListener&&this.animationListener(),this.mouseDownListener=null,this.animationListener=null,Ns.removeElement(t))}ngOnDestroy(){this.config&&this.config.ripple&&this.remove()}static \u0275fac=function(i){return new(i||n)(le(kr),le(Oa),le(mi),le(bn),le(Mn),le(aoe,8))};static \u0275dir=ft({type:n,selectors:[["","pRipple",""]],hostAttrs:[1,"p-ripple","p-element"]})}return n})(),hoe=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=Fi({type:n});static \u0275inj=Ci({imports:[bp]})}return n})();function foe(n,e){1&n&&uT(0)}function poe(n,e){if(1&n&&Fr(0,"span",8),2&n){const t=dn(3);Cl("p-button-loading-icon pi-spin "+t.loadingIcon),vt("ngClass",t.iconClass()),ri("aria-hidden",!0)("data-pc-section","loadingicon")}}function moe(n,e){1&n&&Fr(0,"SpinnerIcon",9),2&n&&(vt("styleClass",dn(3).spinnerIconClass())("spin",!0),ri("aria-hidden",!0)("data-pc-section","loadingicon"))}function goe(n,e){if(1&n&&(Gc(0),gn(1,poe,1,5,"span",6),gn(2,moe,1,4,"SpinnerIcon",7),Wc()),2&n){const t=dn(2);Rt(1),vt("ngIf",t.loadingIcon),Rt(1),vt("ngIf",!t.loadingIcon)}}function _oe(n,e){}function yoe(n,e){1&n&&gn(0,_oe,0,0,"ng-template")}function voe(n,e){if(1&n&&(Pt(0,"span",10),gn(1,yoe,1,0,null,1),At()),2&n){const t=dn(2);vt("ngClass",t.iconClass()),ri("aria-hidden",!0)("data-pc-section","loadingicon"),Rt(1),vt("ngTemplateOutlet",t.loadingIconTemplate)}}function boe(n,e){if(1&n&&(Gc(0),gn(1,goe,3,2,"ng-container",2),gn(2,voe,2,4,"span",5),Wc()),2&n){const t=dn();Rt(1),vt("ngIf",!t.loadingIconTemplate),Rt(1),vt("ngIf",t.loadingIconTemplate)}}function woe(n,e){if(1&n&&Fr(0,"span",8),2&n){const t=dn(2);Cl(t.icon),vt("ngClass",t.iconClass()),ri("data-pc-section","icon")}}function Eoe(n,e){}function Soe(n,e){1&n&&gn(0,Eoe,0,0,"ng-template",12),2&n&&vt("ngIf",!dn(3).icon)}function xoe(n,e){if(1&n&&(Pt(0,"span",8),gn(1,Soe,1,1,null,1),At()),2&n){const t=dn(2);vt("ngClass",t.iconClass()),ri("data-pc-section","icon"),Rt(1),vt("ngTemplateOutlet",t.iconTemplate)}}function Moe(n,e){if(1&n&&(Gc(0),gn(1,woe,1,4,"span",6),gn(2,xoe,2,3,"span",11),Wc()),2&n){const t=dn();Rt(1),vt("ngIf",t.icon&&!t.iconTemplate),Rt(1),vt("ngIf",!t.icon&&t.iconTemplate)}}function Coe(n,e){if(1&n&&(Pt(0,"span",13),In(1),At()),2&n){const t=dn();ri("aria-hidden",t.icon&&!t.label)("data-pc-section","label"),Rt(1),Tl(t.label)}}function Toe(n,e){if(1&n&&(Pt(0,"span",8),In(1),At()),2&n){const t=dn();Cl(t.badgeClass),vt("ngClass",t.badgeStyleClass()),ri("data-pc-section","badge"),Rt(1),Tl(t.badge)}}const Aoe=["*"];let eR=(()=>{class n{type="button";iconPos="left";icon;badge;label;disabled;loading=!1;loadingIcon;raised=!1;rounded=!1;text=!1;plain=!1;severity;outlined=!1;link=!1;size;style;styleClass;badgeClass;ariaLabel;onClick=new $n;onFocus=new $n;onBlur=new $n;contentTemplate;loadingIconTemplate;iconTemplate;templates;spinnerIconClass(){return Object.entries(this.iconClass()).filter(([,t])=>!!t).reduce((t,[i])=>t+` ${i}`,"p-button-loading-icon")}iconClass(){return{"p-button-icon":!0,"p-button-icon-left":"left"===this.iconPos&&this.label,"p-button-icon-right":"right"===this.iconPos&&this.label,"p-button-icon-top":"top"===this.iconPos&&this.label,"p-button-icon-bottom":"bottom"===this.iconPos&&this.label}}buttonClass(){return{"p-button p-component":!0,"p-button-icon-only":(this.icon||this.iconTemplate||this.loadingIcon||this.loadingIconTemplate)&&!this.label,"p-button-vertical":("top"===this.iconPos||"bottom"===this.iconPos)&&this.label,"p-disabled":this.disabled||this.loading,"p-button-loading":this.loading,"p-button-loading-label-only":this.loading&&!this.icon&&this.label&&!this.loadingIcon&&"left"===this.iconPos,"p-button-link":this.link,[`p-button-${this.severity}`]:this.severity,"p-button-raised":this.raised,"p-button-rounded":this.rounded,"p-button-text":this.text,"p-button-outlined":this.outlined,"p-button-sm":"small"===this.size,"p-button-lg":"large"===this.size,"p-button-plain":this.plain}}ngAfterContentInit(){this.templates?.forEach(t=>{switch(t.getType()){case"content":default:this.contentTemplate=t.template;break;case"icon":this.iconTemplate=t.template;break;case"loadingicon":this.loadingIconTemplate=t.template}})}badgeStyleClass(){return{"p-badge p-component":!0,"p-badge-no-gutter":this.badge&&1===String(this.badge).length}}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=Ki({type:n,selectors:[["p-button"]],contentQueries:function(i,r,s){if(1&i&&ww(s,uz,4),2&i){let o;pp(o=mp())&&(r.templates=o)}},hostAttrs:[1,"p-element"],hostVars:2,hostBindings:function(i,r){2&i&&j_("p-disabled",r.disabled)},inputs:{type:"type",iconPos:"iconPos",icon:"icon",badge:"badge",label:"label",disabled:"disabled",loading:"loading",loadingIcon:"loadingIcon",raised:"raised",rounded:"rounded",text:"text",plain:"plain",severity:"severity",outlined:"outlined",link:"link",size:"size",style:"style",styleClass:"styleClass",badgeClass:"badgeClass",ariaLabel:"ariaLabel"},outputs:{onClick:"onClick",onFocus:"onFocus",onBlur:"onBlur"},ngContentSelectors:Aoe,decls:7,vars:14,consts:[["pRipple","",3,"ngStyle","disabled","ngClass","click","focus","blur"],[4,"ngTemplateOutlet"],[4,"ngIf"],["class","p-button-label",4,"ngIf"],[3,"ngClass","class",4,"ngIf"],["class","p-button-loading-icon",3,"ngClass",4,"ngIf"],[3,"class","ngClass",4,"ngIf"],[3,"styleClass","spin",4,"ngIf"],[3,"ngClass"],[3,"styleClass","spin"],[1,"p-button-loading-icon",3,"ngClass"],[3,"ngClass",4,"ngIf"],[3,"ngIf"],[1,"p-button-label"]],template:function(i,r){1&i&&(dT(),Pt(0,"button",0),wn("click",function(o){return r.onClick.emit(o)})("focus",function(o){return r.onFocus.emit(o)})("blur",function(o){return r.onBlur.emit(o)}),hT(1),gn(2,foe,1,0,"ng-container",1),gn(3,boe,3,2,"ng-container",2),gn(4,Moe,3,2,"ng-container",2),gn(5,Coe,2,3,"span",3),gn(6,Toe,2,5,"span",4),At()),2&i&&(Cl(r.styleClass),vt("ngStyle",r.style)("disabled",r.disabled||r.loading)("ngClass",r.buttonClass()),ri("type",r.type)("aria-label",r.ariaLabel)("data-pc-name","button")("data-pc-section","root"),Rt(2),vt("ngTemplateOutlet",r.contentTemplate),Rt(1),vt("ngIf",r.loading),Rt(1),vt("ngIf",!r.loading),Rt(1),vt("ngIf",!r.contentTemplate&&r.label),Rt(1),vt("ngIf",!r.contentTemplate&&r.badge))},dependencies:function(){return[Hw,ay,vA,yA,doe,fz]},encapsulation:2,changeDetection:0})}return n})(),Doe=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=Fi({type:n});static \u0275inj=Ci({imports:[bp,hoe,QI,fz,QI]})}return n})(),Ioe=(()=>{class n{constructor(t,i,r,s,o){this.router=t,this.generalService=i,this.signalRService=r,this.activatedRoute=s,this.dalService=o,this.usernameModel="",this.usernameModel=i.User?i.User.name:""}ngAfterViewInit(){}ngOnChanges(t){}ngOnDestroy(){}ngOnInit(){}login(){this.dalService.login(this.usernameModel).subscribe(t=>{this.generalService.User=t,this.signalRService.startConnection(this.generalService.User.id),localStorage.setItem("user",JSON.stringify(t)),this.router.navigate([Os.GamesList])})}static#e=this.\u0275fac=function(i){return new(i||n)(le(Mr),le(Om),le(wv),le(Fl),le(ix))};static#t=this.\u0275cmp=Ki({type:n,selectors:[["app-home-view"]],features:[Vi],decls:5,vars:1,consts:[[3,"ngModel","ngModelChange"],[3,"onClick"]],template:function(i,r){1&i&&(Pt(0,"div"),In(1,"MG X"),At(),Pt(2,"input",0),wn("ngModelChange",function(o){return r.usernameModel=o}),At(),Pt(3,"p-button",1),wn("onClick",function(){return r.login()}),In(4,"Login"),At()),2&i&&(Rt(2),vt("ngModel",r.usernameModel))},dependencies:[oE,Mk,_D,eR]})}return n})();function Roe(n,e){if(1&n){const t=yd();Pt(0,"div",4)(1,"div"),In(2),At(),Pt(3,"div"),In(4),At(),Pt(5,"div"),In(6),At(),Pt(7,"p-button",5),wn("onClick",function(){const s=is(t).$implicit;return Er(dn().setup(s))}),In(8,"settings"),At(),Pt(9,"p-button",6),wn("onClick",function(){const s=is(t).$implicit;return Er(dn().delete(s))}),In(10,"DELETE"),At()()}if(2&n){const t=e.$implicit;Rt(2),dp("",t.name," "),Rt(2),dp("",t.gameStatus," "),Rt(2),dp("",t.gameType," ")}}let Poe=(()=>{class n{constructor(t,i,r,s){this.signalRService=t,this.router=i,this.generalService=r,this.dalService=s,this.games=[]}ngOnInit(){this.user=this.generalService.User,this.updateGamesList(),this.signalRService.hubConnection.on("GamesUpdated",t=>{console.log("GamesUpdated",t),this.updateGamesList()}),this.signalRService.hubConnection.on("GameDeleted",t=>{console.log("GameDeleted",t),this.updateGamesList()})}ngAfterViewInit(){}ngOnChanges(t){}ngOnDestroy(){}updateGamesList(){this.dalService.getGamesList().subscribe(t=>{this.games=t})}createGame(t){this.dalService.createGame(this.user.id,t).subscribe()}setup(t){this.router.navigate([Os.GameSetup,t.id])}delete(t){this.dalService.deleteGame(t.id).subscribe()}static#e=this.\u0275fac=function(i){return new(i||n)(le(wv),le(Mr),le(Om),le(ix))};static#t=this.\u0275cmp=Ki({type:n,selectors:[["app-games-list"]],features:[Vi],decls:13,vars:2,consts:[[2,"font-size","20px"],["class","mg-row-center","style","margin:10px;column-gap: 10px;border: 1px solid black;",4,"ngFor","ngForOf"],[1,"mg-row-center",2,"column-gap","10px"],["severity","secondary",3,"onClick"],[1,"mg-row-center",2,"margin","10px","column-gap","10px","border","1px solid black"],["severity","warning",3,"onClick"],["severity","danger",3,"onClick"]],template:function(i,r){1&i&&(Pt(0,"div")(1,"div",0),In(2,"Hello "),Pt(3,"b"),In(4),At()(),gn(5,Roe,11,3,"div",1),Pt(6,"div",2)(7,"p-button",3),wn("onClick",function(){return r.createGame("TIK_TAK_TOE")}),In(8,"create game TIK_TAK_TOE"),At(),Pt(9,"p-button",3),wn("onClick",function(){return r.createGame("CHESS")}),In(10,"create game CHESS"),At(),Pt(11,"p-button",3),wn("onClick",function(){return r.createGame("DND")}),In(12,"create game DnD"),At()()()),2&i&&(Rt(4),Tl(r.user.name),Rt(1),vt("ngForOf",r.games))},dependencies:[zw,eR]})}return n})();function Noe(n,e){1&n&&Fr(0,"div",9)}function Loe(n,e){if(1&n&&(Pt(0,"span",10),In(1),At()),2&n){const t=dn().$implicit;Rt(1),Tl(t.description)}}function Ooe(n,e){if(1&n&&(Pt(0,"section",11),Fr(1,"ngx-json-viewer",12),At()),2&n){const t=dn().$implicit,i=dn();Rt(1),vt("json",t.value)("expanded",i.expanded)("depth",i.depth)("_currentDepth",i._currentDepth+1)}}const Foe=function(n){return["segment",n]},koe=function(n,e){return{"segment-main":!0,expandable:n,expanded:e}};function Uoe(n,e){if(1&n){const t=yd();Pt(0,"section",2)(1,"section",3),wn("click",function(){const s=is(t).$implicit;return Er(dn().toggle(s))}),gn(2,Noe,1,0,"div",4),Pt(3,"span",5),In(4),At(),Pt(5,"span",6),In(6,": "),At(),gn(7,Loe,2,1,"span",7),At(),gn(8,Ooe,2,4,"section",8),At()}if(2&n){const t=e.$implicit,i=dn();vt("ngClass",aO(6,Foe,"segment-type-"+t.type)),Rt(1),vt("ngClass",lO(8,koe,i.isExpandable(t),t.expanded)),Rt(1),vt("ngIf",i.isExpandable(t)),Rt(2),Tl(t.key),Rt(3),vt("ngIf",!t.expanded||!i.isExpandable(t)),Rt(1),vt("ngIf",t.expanded&&i.isExpandable(t))}}let Boe=(()=>{class n{constructor(){this.expanded=!0,this.depth=-1,this._currentDepth=0,this.segments=[]}ngOnChanges(){this.segments=[],this.json=this.decycle(this.json),"object"==typeof this.json?Object.keys(this.json).forEach(t=>{this.segments.push(this.parseKeyValue(t,this.json[t]))}):this.segments.push(this.parseKeyValue(`(${typeof this.json})`,this.json))}isExpandable(t){return"object"===t.type||"array"===t.type}toggle(t){this.isExpandable(t)&&(t.expanded=!t.expanded)}parseKeyValue(t,i){const r={key:t,value:i,type:void 0,description:""+i,expanded:this.isExpanded()};switch(typeof r.value){case"number":r.type="number";break;case"boolean":r.type="boolean";break;case"function":r.type="function";break;case"string":r.type="string",r.description='"'+r.value+'"';break;case"undefined":r.type="undefined",r.description="undefined";break;case"object":null===r.value?(r.type="null",r.description="null"):Array.isArray(r.value)?(r.type="array",r.description="Array["+r.value.length+"] "+JSON.stringify(r.value)):r.value instanceof Date?r.type="date":(r.type="object",r.description="Object "+JSON.stringify(r.value))}return r}isExpanded(){return this.expanded&&!(this.depth>-1&&this._currentDepth>=this.depth)}decycle(t){const i=new WeakMap;return function r(s,o){let a,l;return"object"!=typeof s||null===s||s instanceof Boolean||s instanceof Date||s instanceof Number||s instanceof RegExp||s instanceof String?s:(a=i.get(s),void 0!==a?{$ref:a}:(i.set(s,o),Array.isArray(s)?(l=[],s.forEach(function(c,d){l[d]=r(c,o+"["+d+"]")})):(l={},Object.keys(s).forEach(function(c){l[c]=r(s[c],o+"["+JSON.stringify(c)+"]")})),l))}(t,"$")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Ki({type:n,selectors:[["ngx-json-viewer"]],inputs:{json:"json",expanded:"expanded",depth:"depth",_currentDepth:"_currentDepth"},features:[Vi],decls:2,vars:1,consts:[[1,"ngx-json-viewer"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],[3,"ngClass","click"],["class","toggler",4,"ngIf"],[1,"segment-key"],[1,"segment-separator"],["class","segment-value",4,"ngIf"],["class","children",4,"ngIf"],[1,"toggler"],[1,"segment-value"],[1,"children"],[3,"json","expanded","depth","_currentDepth"]],template:function(t,i){1&t&&(Pt(0,"section",0),gn(1,Uoe,9,11,"section",1),At()),2&t&&(Rt(1),vt("ngForOf",i.segments))},dependencies:[Hw,zw,ay,n],styles:['@charset "UTF-8";.ngx-json-viewer[_ngcontent-%COMP%]{font-family:var(--ngx-json-font-family, monospace);font-size:var(--ngx-json-font-size, 1em);width:100%;height:100%;overflow:hidden;position:relative}.ngx-json-viewer[_ngcontent-%COMP%]   .segment[_ngcontent-%COMP%]{padding:2px;margin:1px 1px 1px 12px}.ngx-json-viewer[_ngcontent-%COMP%]   .segment[_ngcontent-%COMP%]   .segment-main[_ngcontent-%COMP%]{word-wrap:break-word}.ngx-json-viewer[_ngcontent-%COMP%]   .segment[_ngcontent-%COMP%]   .segment-main[_ngcontent-%COMP%]   .toggler[_ngcontent-%COMP%]{position:absolute;margin-left:-14px;margin-top:3px;font-size:.8em;line-height:1.2em;vertical-align:middle;color:var(--ngx-json-toggler, #787878)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment[_ngcontent-%COMP%]   .segment-main[_ngcontent-%COMP%]   .toggler[_ngcontent-%COMP%]:after{display:inline-block;content:"\\25ba";transition:transform .1s ease-in}.ngx-json-viewer[_ngcontent-%COMP%]   .segment[_ngcontent-%COMP%]   .segment-main[_ngcontent-%COMP%]   .segment-key[_ngcontent-%COMP%]{color:var(--ngx-json-key, #4E187C)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment[_ngcontent-%COMP%]   .segment-main[_ngcontent-%COMP%]   .segment-separator[_ngcontent-%COMP%]{color:var(--ngx-json-separator, #999)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment[_ngcontent-%COMP%]   .segment-main[_ngcontent-%COMP%]   .segment-value[_ngcontent-%COMP%]{color:var(--ngx-json-value, #000)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment[_ngcontent-%COMP%]   .children[_ngcontent-%COMP%]{margin-left:12px}.ngx-json-viewer[_ngcontent-%COMP%]   .segment-type-string[_ngcontent-%COMP%] > .segment-main[_ngcontent-%COMP%] > .segment-value[_ngcontent-%COMP%]{color:var(--ngx-json-string, #FF6B6B)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment-type-number[_ngcontent-%COMP%] > .segment-main[_ngcontent-%COMP%] > .segment-value[_ngcontent-%COMP%]{color:var(--ngx-json-number, #009688)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment-type-boolean[_ngcontent-%COMP%] > .segment-main[_ngcontent-%COMP%] > .segment-value[_ngcontent-%COMP%]{color:var(--ngx-json-boolean, #B938A4)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment-type-date[_ngcontent-%COMP%] > .segment-main[_ngcontent-%COMP%] > .segment-value[_ngcontent-%COMP%]{color:var(--ngx-json-date, #05668D)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment-type-array[_ngcontent-%COMP%] > .segment-main[_ngcontent-%COMP%] > .segment-value[_ngcontent-%COMP%]{color:var(--ngx-json-array, #999)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment-type-object[_ngcontent-%COMP%] > .segment-main[_ngcontent-%COMP%] > .segment-value[_ngcontent-%COMP%]{color:var(--ngx-json-object, #999)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment-type-function[_ngcontent-%COMP%] > .segment-main[_ngcontent-%COMP%] > .segment-value[_ngcontent-%COMP%]{color:var(--ngx-json-function, #999)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment-type-null[_ngcontent-%COMP%] > .segment-main[_ngcontent-%COMP%] > .segment-value[_ngcontent-%COMP%]{color:var(--ngx-json-null, #fff)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment-type-undefined[_ngcontent-%COMP%] > .segment-main[_ngcontent-%COMP%] > .segment-value[_ngcontent-%COMP%]{color:var(--ngx-json-undefined, #fff)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment-type-null[_ngcontent-%COMP%] > .segment-main[_ngcontent-%COMP%] > .segment-value[_ngcontent-%COMP%]{background-color:var(--ngx-json-null-bg, red)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment-type-undefined[_ngcontent-%COMP%] > .segment-main[_ngcontent-%COMP%] > .segment-key[_ngcontent-%COMP%]{color:var(--ngx-json-undefined-key, #999)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment-type-undefined[_ngcontent-%COMP%] > .segment-main[_ngcontent-%COMP%] > .segment-value[_ngcontent-%COMP%]{background-color:var(--ngx-json-undefined-key, #999)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment-type-object[_ngcontent-%COMP%] > .segment-main[_ngcontent-%COMP%], .ngx-json-viewer[_ngcontent-%COMP%]   .segment-type-array[_ngcontent-%COMP%] > .segment-main[_ngcontent-%COMP%]{white-space:nowrap}.ngx-json-viewer[_ngcontent-%COMP%]   .expanded[_ngcontent-%COMP%] > .toggler[_ngcontent-%COMP%]:after{transform:rotate(90deg)}.ngx-json-viewer[_ngcontent-%COMP%]   .expandable[_ngcontent-%COMP%], .ngx-json-viewer[_ngcontent-%COMP%]   .expandable[_ngcontent-%COMP%] > .toggler[_ngcontent-%COMP%]{cursor:pointer}']}),n})(),Voe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Fi({type:n}),n.\u0275inj=Ci({imports:[bp]}),n})();function Hoe(n,e){if(1&n){const t=yd();Pt(0,"div",11)(1,"div",12),In(2),At(),Pt(3,"div")(4,"p-button",10),wn("onClick",function(){const s=is(t).$implicit;return Er(dn(2).join_game(s))}),In(5,"JOIN"),At()(),Pt(6,"div")(7,"p-button",9),wn("onClick",function(){const s=is(t).$implicit;return Er(dn(2).set_ai(s))}),In(8,"AI"),At()(),Pt(9,"div")(10,"p-button",13),wn("onClick",function(){const s=is(t).$implicit;return Er(dn(2).leave(s))}),In(11,"LEAVE"),At()()()}if(2&n){const t=e.$implicit;Rt(2),Tl(t.type)}}function zoe(n,e){if(1&n){const t=yd();Pt(0,"div",1)(1,"div",2),In(2,"Settings"),At(),Pt(3,"div"),Fr(4,"ngx-json-viewer",3),At(),Pt(5,"div",4)(6,"div",5),In(7,"Players"),At(),gn(8,Hoe,12,1,"div",6),At(),Pt(9,"div",7)(10,"p-button",8),wn("onClick",function(){return is(t),Er(dn().setup())}),In(11,"SETUP"),At(),Pt(12,"p-button",9),wn("onClick",function(){return is(t),Er(dn().start())}),In(13,"START"),At(),Pt(14,"p-button",10),wn("onClick",function(){return is(t),Er(dn().open())}),In(15,"OPEN"),At()()()}if(2&n){const t=dn();Rt(4),vt("json",t.gameData)("depth",1),Rt(4),vt("ngForOf",t.gameData.players)}}let Goe=(()=>{class n{constructor(t,i,r,s,o,a){this.signalRService=t,this.router=i,this.unsubscriberService=r,this.activatedRoute=s,this.generalService=o,this.dalService=a,this.gameId=""}ngOnInit(){this.user=this.generalService.User,this.gameId=this.activatedRoute.snapshot.paramMap.get("id"),this.updateGame(),this.signalRService.hubConnection.on("GameUpdated",t=>{console.log("GameUpdated",t),this.gameData=t}),this.signalRService.hubConnection.on("GamesUpdated",t=>{console.log("GamesUpdated",t)}),this.signalRService.hubConnection.on("GameDeleted",t=>{console.log("GameDeleted",t)})}ngOnDestroy(){this.signalRService.hubConnection.off("GameUpdated"),this.signalRService.hubConnection.off("GamesUpdated"),this.signalRService.hubConnection.off("GameDeleted")}updateGame(){this.dalService.getGameById(this.gameId).subscribe(t=>{t?this.gameData=t:this.router.navigate([Os.GamesList])})}ngAfterViewInit(){}ngOnChanges(t){}start(){this.dalService.startGame(this.gameId).subscribe()}leave(t){this.dalService.joinGame(this.gameId,t.id,null,"EMPTY_SEAT").subscribe()}set_ai(t){this.dalService.joinGame(this.gameId,t.id,null,"AI").subscribe()}join_game(t){this.dalService.joinGame(this.gameId,t.id,this.user,"HUMAN").subscribe()}setup(){this.dalService.setupGame(this.gameId,this.user.id).subscribe()}open(){this.router.navigate([Os.GamePlay,this.gameId])}static#e=this.\u0275fac=function(i){return new(i||n)(le(wv),le(Mr),le(XS),le(Fl),le(Om),le(ix))};static#t=this.\u0275cmp=Ki({type:n,selectors:[["app-game-setup"]],features:[kn([XS]),Vi],decls:1,vars:1,consts:[["style","overflow: auto;width: 100%;height: 100%;",4,"ngIf"],[2,"overflow","auto","width","100%","height","100%"],[2,"font-size","20px"],[3,"json","depth"],[1,"mg-col"],[2,"margin-top","20px","font-size","20px"],["class","mg-row-center",4,"ngFor","ngForOf"],[1,"mg-row-center",2,"margin-top","20px"],["severity","secondary",3,"onClick"],["severity","warning",3,"onClick"],["severity","success",3,"onClick"],[1,"mg-row-center"],[2,"width","100px"],["severity","danger",3,"onClick"]],template:function(i,r){1&i&&gn(0,zoe,16,3,"div",0),2&i&&vt("ngIf",r.gameData)},dependencies:[zw,ay,eR,Boe]})}return n})();const ch=new TI,Ls=new N,Su=new N,oi=new Bn,pz={X:new N(1,0,0),Y:new N(0,1,0),Z:new N(0,0,1)},tR={type:"change"},mz={type:"mouseDown"},gz={type:"mouseUp",mode:null},_z={type:"objectChange"};class Woe extends vi{constructor(e,t){super(),void 0===t&&(console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.'),t=document),this.isTransformControls=!0,this.visible=!1,this.domElement=t,this.domElement.style.touchAction="none";const i=new Zoe;this._gizmo=i,this.add(i);const r=new Koe;this._plane=r,this.add(r);const s=this;function o(w,E){let x=E;Object.defineProperty(s,w,{get:function(){return void 0!==x?x:E},set:function(C){x!==C&&(x=C,r[w]=C,i[w]=C,s.dispatchEvent({type:w+"-changed",value:C}),s.dispatchEvent(tR))}}),s[w]=E,r[w]=E,i[w]=E}o("camera",e),o("object",void 0),o("enabled",!0),o("axis",null),o("mode","translate"),o("translationSnap",null),o("rotationSnap",null),o("scaleSnap",null),o("space","world"),o("size",1),o("dragging",!1),o("showX",!0),o("showY",!0),o("showZ",!0);const a=new N,l=new N,c=new Bn,d=new Bn,h=new N,p=new Bn,m=new N,g=new N,b=new N,y=new N;o("worldPosition",a),o("worldPositionStart",l),o("worldQuaternion",c),o("worldQuaternionStart",d),o("cameraPosition",h),o("cameraQuaternion",p),o("pointStart",m),o("pointEnd",g),o("rotationAxis",b),o("rotationAngle",0),o("eye",y),this._offset=new N,this._startNorm=new N,this._endNorm=new N,this._cameraScale=new N,this._parentPosition=new N,this._parentQuaternion=new Bn,this._parentQuaternionInv=new Bn,this._parentScale=new N,this._worldScaleStart=new N,this._worldQuaternionInv=new Bn,this._worldScale=new N,this._positionStart=new N,this._quaternionStart=new Bn,this._scaleStart=new N,this._getPointer=joe.bind(this),this._onPointerDown=qoe.bind(this),this._onPointerHover=$oe.bind(this),this._onPointerMove=Xoe.bind(this),this._onPointerUp=Yoe.bind(this),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointermove",this._onPointerHover),this.domElement.addEventListener("pointerup",this._onPointerUp)}updateMatrixWorld(){void 0!==this.object&&(this.object.updateMatrixWorld(),null===this.object.parent?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this._parentPosition,this._parentQuaternion,this._parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this._worldScale),this._parentQuaternionInv.copy(this._parentQuaternion).invert(),this._worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this._cameraScale),this.camera.isOrthographicCamera?this.camera.getWorldDirection(this.eye).negate():this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld(this)}pointerHover(e){if(void 0===this.object||!0===this.dragging)return;ch.setFromCamera(e,this.camera);const t=nR(this._gizmo.picker[this.mode],ch);this.axis=t?t.object.name:null}pointerDown(e){if(void 0!==this.object&&!0!==this.dragging&&0===e.button&&null!==this.axis){ch.setFromCamera(e,this.camera);const t=nR(this._plane,ch,!0);t&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(t.point).sub(this.worldPositionStart)),this.dragging=!0,mz.mode=this.mode,this.dispatchEvent(mz)}}pointerMove(e){const t=this.axis,i=this.mode,r=this.object;let s=this.space;if("scale"===i?s="local":("E"===t||"XYZE"===t||"XYZ"===t)&&(s="world"),void 0===r||null===t||!1===this.dragging||-1!==e.button)return;ch.setFromCamera(e,this.camera);const o=nR(this._plane,ch,!0);if(o){if(this.pointEnd.copy(o.point).sub(this.worldPositionStart),"translate"===i)this._offset.copy(this.pointEnd).sub(this.pointStart),"local"===s&&"XYZ"!==t&&this._offset.applyQuaternion(this._worldQuaternionInv),-1===t.indexOf("X")&&(this._offset.x=0),-1===t.indexOf("Y")&&(this._offset.y=0),-1===t.indexOf("Z")&&(this._offset.z=0),"local"===s&&"XYZ"!==t?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),r.position.copy(this._offset).add(this._positionStart),this.translationSnap&&("local"===s&&(r.position.applyQuaternion(oi.copy(this._quaternionStart).invert()),-1!==t.search("X")&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.position.applyQuaternion(this._quaternionStart)),"world"===s&&(r.parent&&r.position.add(Ls.setFromMatrixPosition(r.parent.matrixWorld)),-1!==t.search("X")&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.parent&&r.position.sub(Ls.setFromMatrixPosition(r.parent.matrixWorld))));else if("scale"===i){if(-1!==t.search("XYZ")){let a=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(a*=-1),Su.set(a,a,a)}else Ls.copy(this.pointStart),Su.copy(this.pointEnd),Ls.applyQuaternion(this._worldQuaternionInv),Su.applyQuaternion(this._worldQuaternionInv),Su.divide(Ls),-1===t.search("X")&&(Su.x=1),-1===t.search("Y")&&(Su.y=1),-1===t.search("Z")&&(Su.z=1);r.scale.copy(this._scaleStart).multiply(Su),this.scaleSnap&&(-1!==t.search("X")&&(r.scale.x=Math.round(r.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Y")&&(r.scale.y=Math.round(r.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Z")&&(r.scale.z=Math.round(r.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if("rotate"===i){this._offset.copy(this.pointEnd).sub(this.pointStart);const a=20/this.worldPosition.distanceTo(Ls.setFromMatrixPosition(this.camera.matrixWorld));"E"===t?(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this._endNorm.cross(this._startNorm).dot(this.eye)<0?1:-1):"XYZE"===t?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(Ls.copy(this.rotationAxis).cross(this.eye))*a):("X"===t||"Y"===t||"Z"===t)&&(this.rotationAxis.copy(pz[t]),Ls.copy(pz[t]),"local"===s&&Ls.applyQuaternion(this.worldQuaternion),this.rotationAngle=this._offset.dot(Ls.cross(this.eye).normalize())*a),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),"local"===s&&"E"!==t&&"XYZE"!==t?(r.quaternion.copy(this._quaternionStart),r.quaternion.multiply(oi.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),r.quaternion.copy(oi.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),r.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent(tR),this.dispatchEvent(_z)}}pointerUp(e){0===e.button&&(this.dragging&&null!==this.axis&&(gz.mode=this.mode,this.dispatchEvent(gz)),this.dragging=!1,this.axis=null)}dispose(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.traverse(function(e){e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()})}attach(e){return this.object=e,this.visible=!0,this}detach(){return this.object=void 0,this.visible=!1,this.axis=null,this}reset(){this.enabled&&this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent(tR),this.dispatchEvent(_z),this.pointStart.copy(this.pointEnd))}getRaycaster(){return ch}getMode(){return this.mode}setMode(e){this.mode=e}setTranslationSnap(e){this.translationSnap=e}setRotationSnap(e){this.rotationSnap=e}setScaleSnap(e){this.scaleSnap=e}setSize(e){this.size=e}setSpace(e){this.space=e}}function joe(n){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:n.button};{const e=this.domElement.getBoundingClientRect();return{x:(n.clientX-e.left)/e.width*2-1,y:-(n.clientY-e.top)/e.height*2+1,button:n.button}}}function $oe(n){if(this.enabled)switch(n.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(n))}}function qoe(n){this.enabled&&(document.pointerLockElement||this.domElement.setPointerCapture(n.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(n)),this.pointerDown(this._getPointer(n)))}function Xoe(n){this.enabled&&this.pointerMove(this._getPointer(n))}function Yoe(n){this.enabled&&(this.domElement.releasePointerCapture(n.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(n)))}function nR(n,e,t){const i=e.intersectObject(n,!0);for(let r=0;r<i.length;r++)if(i[r].object.visible||t)return i[r];return!1}const sx=new fB,Vn=new N(0,1,0),yz=new N(0,0,0),vz=new bt,ox=new Bn,ax=new Bn,Ka=new N,bz=new bt,Mv=new N(1,0,0),uh=new N(0,1,0),Cv=new N(0,0,1),lx=new N,Tv=new N,Av=new N;class Zoe extends vi{constructor(){super(),this.isTransformControlsGizmo=!0,this.type="TransformControlsGizmo";const e=new bi({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),t=new mr({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),i=e.clone();i.opacity=.15;const r=t.clone();r.opacity=.5;const s=e.clone();s.color.setHex(16711680);const o=e.clone();o.color.setHex(65280);const a=e.clone();a.color.setHex(255);const l=e.clone();l.color.setHex(16711680),l.opacity=.5;const c=e.clone();c.color.setHex(65280),c.opacity=.5;const d=e.clone();d.color.setHex(255),d.opacity=.5;const h=e.clone();h.opacity=.25;const p=e.clone();p.color.setHex(16776960),p.opacity=.25,e.clone().color.setHex(16776960);const g=e.clone();g.color.setHex(7895160);const b=new sr(0,.04,.1,12);b.translate(0,.05,0);const v=new si(.08,.08,.08);v.translate(0,.04,0);const y=new Nt;y.setAttribute("position",new Xe([0,0,0,1,0,0],3));const w=new sr(.0075,.0075,.5,3);function E(J,j){const $=new gu(J,.0075,3,64,j*Math.PI*2);return $.rotateY(Math.PI/2),$.rotateX(Math.PI/2),$}w.translate(0,.25,0);const C={X:[[new Ce(b,s),[.5,0,0],[0,0,-Math.PI/2]],[new Ce(b,s),[-.5,0,0],[0,0,Math.PI/2]],[new Ce(w,s),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new Ce(b,o),[0,.5,0]],[new Ce(b,o),[0,-.5,0],[Math.PI,0,0]],[new Ce(w,o)]],Z:[[new Ce(b,a),[0,0,.5],[Math.PI/2,0,0]],[new Ce(b,a),[0,0,-.5],[-Math.PI/2,0,0]],[new Ce(w,a),null,[Math.PI/2,0,0]]],XYZ:[[new Ce(new mu(.1,0),h.clone()),[0,0,0]]],XY:[[new Ce(new si(.15,.15,.01),d.clone()),[.15,.15,0]]],YZ:[[new Ce(new si(.15,.15,.01),l.clone()),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new Ce(new si(.15,.15,.01),c.clone()),[.15,0,.15],[-Math.PI/2,0,0]]]},A={X:[[new Ce(new sr(.2,0,.6,4),i),[.3,0,0],[0,0,-Math.PI/2]],[new Ce(new sr(.2,0,.6,4),i),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new Ce(new sr(.2,0,.6,4),i),[0,.3,0]],[new Ce(new sr(.2,0,.6,4),i),[0,-.3,0],[0,0,Math.PI]]],Z:[[new Ce(new sr(.2,0,.6,4),i),[0,0,.3],[Math.PI/2,0,0]],[new Ce(new sr(.2,0,.6,4),i),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new Ce(new mu(.2,0),i)]],XY:[[new Ce(new si(.2,.2,.01),i),[.15,.15,0]]],YZ:[[new Ce(new si(.2,.2,.01),i),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new Ce(new si(.2,.2,.01),i),[.15,0,.15],[-Math.PI/2,0,0]]]},D={START:[[new Ce(new mu(.01,2),r),null,null,null,"helper"]],END:[[new Ce(new mu(.01,2),r),null,null,null,"helper"]],DELTA:[[new Gr(function x(){const J=new Nt;return J.setAttribute("position",new Xe([0,0,0,1,1,1],3)),J}(),r),null,null,null,"helper"]],X:[[new Gr(y,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Gr(y,r.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Gr(y,r.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},O={XYZE:[[new Ce(E(.5,1),g),null,[0,Math.PI/2,0]]],X:[[new Ce(E(.5,.5),s)]],Y:[[new Ce(E(.5,.5),o),null,[0,0,-Math.PI/2]]],Z:[[new Ce(E(.5,.5),a),null,[0,Math.PI/2,0]]],E:[[new Ce(E(.75,1),p),null,[0,Math.PI/2,0]]]},T={AXIS:[[new Gr(y,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},L={XYZE:[[new Ce(new wm(.25,10,8),i)]],X:[[new Ce(new gu(.5,.1,4,24),i),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new Ce(new gu(.5,.1,4,24),i),[0,0,0],[Math.PI/2,0,0]]],Z:[[new Ce(new gu(.5,.1,4,24),i),[0,0,0],[0,0,-Math.PI/2]]],E:[[new Ce(new gu(.75,.1,2,24),i)]]},X={X:[[new Ce(v,s),[.5,0,0],[0,0,-Math.PI/2]],[new Ce(w,s),[0,0,0],[0,0,-Math.PI/2]],[new Ce(v,s),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new Ce(v,o),[0,.5,0]],[new Ce(w,o)],[new Ce(v,o),[0,-.5,0],[0,0,Math.PI]]],Z:[[new Ce(v,a),[0,0,.5],[Math.PI/2,0,0]],[new Ce(w,a),[0,0,0],[Math.PI/2,0,0]],[new Ce(v,a),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new Ce(new si(.15,.15,.01),d),[.15,.15,0]]],YZ:[[new Ce(new si(.15,.15,.01),l),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new Ce(new si(.15,.15,.01),c),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new Ce(new si(.1,.1,.1),h.clone())]]},re={X:[[new Ce(new sr(.2,0,.6,4),i),[.3,0,0],[0,0,-Math.PI/2]],[new Ce(new sr(.2,0,.6,4),i),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new Ce(new sr(.2,0,.6,4),i),[0,.3,0]],[new Ce(new sr(.2,0,.6,4),i),[0,-.3,0],[0,0,Math.PI]]],Z:[[new Ce(new sr(.2,0,.6,4),i),[0,0,.3],[Math.PI/2,0,0]],[new Ce(new sr(.2,0,.6,4),i),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new Ce(new si(.2,.2,.01),i),[.15,.15,0]]],YZ:[[new Ce(new si(.2,.2,.01),i),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new Ce(new si(.2,.2,.01),i),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new Ce(new si(.2,.2,.2),i),[0,0,0]]]},ae={X:[[new Gr(y,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Gr(y,r.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Gr(y,r.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function H(J){const j=new vi;for(const $ in J)for(let Q=J[$].length;Q--;){const K=J[$][Q][0].clone(),ce=J[$][Q][1],q=J[$][Q][2],oe=J[$][Q][3],Me=J[$][Q][4];K.name=$,K.tag=Me,ce&&K.position.set(ce[0],ce[1],ce[2]),q&&K.rotation.set(q[0],q[1],q[2]),oe&&K.scale.set(oe[0],oe[1],oe[2]),K.updateMatrix();const we=K.geometry.clone();we.applyMatrix4(K.matrix),K.geometry=we,K.renderOrder=1/0,K.position.set(0,0,0),K.rotation.set(0,0,0),K.scale.set(1,1,1),j.add(K)}return j}this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=H(C)),this.add(this.gizmo.rotate=H(O)),this.add(this.gizmo.scale=H(X)),this.add(this.picker.translate=H(A)),this.add(this.picker.rotate=H(L)),this.add(this.picker.scale=H(re)),this.add(this.helper.translate=H(D)),this.add(this.helper.rotate=H(T)),this.add(this.helper.scale=H(ae)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}updateMatrixWorld(e){const i="local"===("scale"===this.mode?"local":this.space)?this.worldQuaternion:ax;this.gizmo.translate.visible="translate"===this.mode,this.gizmo.rotate.visible="rotate"===this.mode,this.gizmo.scale.visible="scale"===this.mode,this.helper.translate.visible="translate"===this.mode,this.helper.rotate.visible="rotate"===this.mode,this.helper.scale.visible="scale"===this.mode;let r=[];r=r.concat(this.picker[this.mode].children),r=r.concat(this.gizmo[this.mode].children),r=r.concat(this.helper[this.mode].children);for(let s=0;s<r.length;s++){const o=r[s];let a;o.visible=!0,o.rotation.set(0,0,0),o.position.copy(this.worldPosition),a=this.camera.isOrthographicCamera?(this.camera.top-this.camera.bottom)/this.camera.zoom:this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),o.scale.set(1,1,1).multiplyScalar(a*this.size/4),"helper"!==o.tag?(o.quaternion.copy(i),"translate"===this.mode||"scale"===this.mode?("X"===o.name&&Math.abs(Vn.copy(Mv).applyQuaternion(i).dot(this.eye))>.99&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"Y"===o.name&&Math.abs(Vn.copy(uh).applyQuaternion(i).dot(this.eye))>.99&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"Z"===o.name&&Math.abs(Vn.copy(Cv).applyQuaternion(i).dot(this.eye))>.99&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"XY"===o.name&&Math.abs(Vn.copy(Cv).applyQuaternion(i).dot(this.eye))<.2&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"YZ"===o.name&&Math.abs(Vn.copy(Mv).applyQuaternion(i).dot(this.eye))<.2&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"XZ"===o.name&&Math.abs(Vn.copy(uh).applyQuaternion(i).dot(this.eye))<.2&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1)):"rotate"===this.mode&&(ox.copy(i),Vn.copy(this.eye).applyQuaternion(oi.copy(i).invert()),-1!==o.name.search("E")&&o.quaternion.setFromRotationMatrix(vz.lookAt(this.eye,yz,uh)),"X"===o.name&&(oi.setFromAxisAngle(Mv,Math.atan2(-Vn.y,Vn.z)),oi.multiplyQuaternions(ox,oi),o.quaternion.copy(oi)),"Y"===o.name&&(oi.setFromAxisAngle(uh,Math.atan2(Vn.x,Vn.z)),oi.multiplyQuaternions(ox,oi),o.quaternion.copy(oi)),"Z"===o.name&&(oi.setFromAxisAngle(Cv,Math.atan2(Vn.y,Vn.x)),oi.multiplyQuaternions(ox,oi),o.quaternion.copy(oi))),o.visible=o.visible&&(-1===o.name.indexOf("X")||this.showX),o.visible=o.visible&&(-1===o.name.indexOf("Y")||this.showY),o.visible=o.visible&&(-1===o.name.indexOf("Z")||this.showZ),o.visible=o.visible&&(-1===o.name.indexOf("E")||this.showX&&this.showY&&this.showZ),o.material._color=o.material._color||o.material.color.clone(),o.material._opacity=o.material._opacity||o.material.opacity,o.material.color.copy(o.material._color),o.material.opacity=o.material._opacity,this.enabled&&this.axis&&(o.name===this.axis||this.axis.split("").some(function(l){return o.name===l}))&&(o.material.color.setHex(16776960),o.material.opacity=1)):(o.visible=!1,"AXIS"===o.name?(o.visible=!!this.axis,"X"===this.axis&&(oi.setFromEuler(sx.set(0,0,0)),o.quaternion.copy(i).multiply(oi),Math.abs(Vn.copy(Mv).applyQuaternion(i).dot(this.eye))>.9&&(o.visible=!1)),"Y"===this.axis&&(oi.setFromEuler(sx.set(0,0,Math.PI/2)),o.quaternion.copy(i).multiply(oi),Math.abs(Vn.copy(uh).applyQuaternion(i).dot(this.eye))>.9&&(o.visible=!1)),"Z"===this.axis&&(oi.setFromEuler(sx.set(0,Math.PI/2,0)),o.quaternion.copy(i).multiply(oi),Math.abs(Vn.copy(Cv).applyQuaternion(i).dot(this.eye))>.9&&(o.visible=!1)),"XYZE"===this.axis&&(oi.setFromEuler(sx.set(0,Math.PI/2,0)),Vn.copy(this.rotationAxis),o.quaternion.setFromRotationMatrix(vz.lookAt(yz,Vn,uh)),o.quaternion.multiply(oi),o.visible=this.dragging),"E"===this.axis&&(o.visible=!1)):"START"===o.name?(o.position.copy(this.worldPositionStart),o.visible=this.dragging):"END"===o.name?(o.position.copy(this.worldPosition),o.visible=this.dragging):"DELTA"===o.name?(o.position.copy(this.worldPositionStart),o.quaternion.copy(this.worldQuaternionStart),Ls.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),Ls.applyQuaternion(this.worldQuaternionStart.clone().invert()),o.scale.copy(Ls),o.visible=this.dragging):(o.quaternion.copy(i),o.position.copy(this.dragging?this.worldPositionStart:this.worldPosition),this.axis&&(o.visible=-1!==this.axis.search(o.name))))}super.updateMatrixWorld(e)}}class Koe extends Ce{constructor(){super(new Yy(1e5,1e5,2,2),new bi({visible:!1,wireframe:!0,side:2,transparent:!0,opacity:.1,toneMapped:!1})),this.isTransformControlsPlane=!0,this.type="TransformControlsPlane"}updateMatrixWorld(e){let t=this.space;switch(this.position.copy(this.worldPosition),"scale"===this.mode&&(t="local"),lx.copy(Mv).applyQuaternion("local"===t?this.worldQuaternion:ax),Tv.copy(uh).applyQuaternion("local"===t?this.worldQuaternion:ax),Av.copy(Cv).applyQuaternion("local"===t?this.worldQuaternion:ax),Vn.copy(Tv),this.mode){case"translate":case"scale":switch(this.axis){case"X":Vn.copy(this.eye).cross(lx),Ka.copy(lx).cross(Vn);break;case"Y":Vn.copy(this.eye).cross(Tv),Ka.copy(Tv).cross(Vn);break;case"Z":Vn.copy(this.eye).cross(Av),Ka.copy(Av).cross(Vn);break;case"XY":Ka.copy(Av);break;case"YZ":Ka.copy(lx);break;case"XZ":Vn.copy(Av),Ka.copy(Tv);break;case"XYZ":case"E":Ka.set(0,0,0)}break;default:Ka.set(0,0,0)}0===Ka.length()?this.quaternion.copy(this.cameraQuaternion):(bz.lookAt(Ls.set(0,0,0),Ka,Vn),this.quaternion.setFromRotationMatrix(bz)),super.updateMatrixWorld(e)}}let Joe=(()=>{class n{ngAfterViewInit(){const t=new yS;t.add(new Hie(5));const i=new nr(75,window.innerWidth/window.innerHeight,.1,1e3);i.position.z=2;const r=new z1;r.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(r.domElement);const s=new si,o=new VV({transparent:!0}),a=new Ce(s,o);t.add(a);const l=new wH(i,r.domElement),c=new Woe(i,r.domElement);c.attach(a),c.setMode("rotate"),t.add(c),c.addEventListener("dragging-changed",function(g){l.enabled=!g.value}),window.addEventListener("keydown",function(g){switch(g.key){case"g":c.setMode("translate");break;case"r":c.setMode("rotate");break;case"s":c.setMode("scale")}});const d=(new die).load(["img/px_eso0932a.jpg","img/nx_eso0932a.jpg","img/py_eso0932a.jpg","img/ny_eso0932a.jpg","img/pz_eso0932a.jpg","img/nz_eso0932a.jpg"]);function m(){r.render(t,i)}t.background=d,window.addEventListener("resize",function h(){i.aspect=window.innerWidth/window.innerHeight,i.updateProjectionMatrix(),r.setSize(window.innerWidth,window.innerHeight),m()},!1),function p(){requestAnimationFrame(p),m()}()}ngOnChanges(t){}ngOnDestroy(){}ngOnInit(){}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=Ki({type:n,selectors:[["app-editor"]],features:[Vi],decls:0,vars:0,template:function(i,r){}})}return n})();var Os=function(n){return n.Home="home",n.GamesList="games-list",n.GameSetup="game-setup",n.GamePlay="game-play",n.Editor="editor",n}(Os||{});const Qoe=[{path:"",redirectTo:`/${Os.Home}`,pathMatch:"full"},{path:Os.Home,component:Ioe},{path:Os.Editor,component:Joe,canActivate:[rx]},{path:Os.GamesList,component:Poe,canActivate:[rx]},{path:`${Os.GameSetup}/:id`,component:Goe,canActivate:[rx]},{path:`${Os.GamePlay}/:id`,component:soe,canActivate:[rx]},{path:"**",redirectTo:`/${Os.Home}`}];let eae=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Fi({type:n});static#n=this.\u0275inj=Ci({imports:[c3.forRoot(Qoe),c3]})}return n})(),tae=(()=>{class n{constructor(t,i,r){this.generalService=t,this.titleService=i,this.signalRService=r,this.appVersionAttr=bv.appVersion,this.titleService.setTitle("MGx - v"+bv.appVersion);let s=localStorage.getItem("user");try{s=JSON.parse(s),this.generalService.User=s,this.signalRService.startConnection(this.generalService.User.id)}catch{this.generalService.User=void 0}}static#e=this.\u0275fac=function(i){return new(i||n)(le(Om),le(PA),le(wv))};static#t=this.\u0275cmp=Ki({type:n,selectors:[["app-root"]],hostVars:1,hostBindings:function(i,r){2&i&&ri("app-version",r.appVersionAttr)},decls:1,vars:0,template:function(i,r){1&i&&Fr(0,"router-outlet")},dependencies:[VD]})}return n})(),wz=(()=>{class n extends hz{static \u0275fac=function(){let t;return function(r){return(t||(t=fi(n)))(r||n)}}();static \u0275cmp=Ki({type:n,selectors:[["CheckIcon"]],standalone:!0,features:[mn,J_],decls:2,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M4.86199 11.5948C4.78717 11.5923 4.71366 11.5745 4.64596 11.5426C4.57826 11.5107 4.51779 11.4652 4.46827 11.4091L0.753985 7.69483C0.683167 7.64891 0.623706 7.58751 0.580092 7.51525C0.536478 7.44299 0.509851 7.36177 0.502221 7.27771C0.49459 7.19366 0.506156 7.10897 0.536046 7.03004C0.565935 6.95111 0.613367 6.88 0.674759 6.82208C0.736151 6.76416 0.8099 6.72095 0.890436 6.69571C0.970973 6.67046 1.05619 6.66385 1.13966 6.67635C1.22313 6.68886 1.30266 6.72017 1.37226 6.76792C1.44186 6.81567 1.4997 6.8786 1.54141 6.95197L4.86199 10.2503L12.6397 2.49483C12.7444 2.42694 12.8689 2.39617 12.9932 2.40745C13.1174 2.41873 13.2343 2.47141 13.3251 2.55705C13.4159 2.64268 13.4753 2.75632 13.4938 2.87973C13.5123 3.00315 13.4888 3.1292 13.4271 3.23768L5.2557 11.4091C5.20618 11.4652 5.14571 11.5107 5.07801 11.5426C5.01031 11.5745 4.9368 11.5923 4.86199 11.5948Z","fill","currentColor"]],template:function(i,r){1&i&&(cf(),Pt(0,"svg",0),Fr(1,"path",1),At()),2&i&&(Cl(r.getClassNames()),ri("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role))},encapsulation:2})}return n})();const nae=["cb"];function iae(n,e){1&n&&Fr(0,"span",10),2&n&&vt("ngClass",dn(3).checkboxIcon)}function rae(n,e){1&n&&Fr(0,"CheckIcon",11),2&n&&vt("styleClass","p-checkbox-icon")}function sae(n,e){if(1&n&&(Gc(0),gn(1,iae,1,1,"span",8),gn(2,rae,1,1,"CheckIcon",9),Wc()),2&n){const t=dn(2);Rt(1),vt("ngIf",t.checkboxIcon),Rt(1),vt("ngIf",!t.checkboxIcon)}}function oae(n,e){}function aae(n,e){1&n&&gn(0,oae,0,0,"ng-template")}function lae(n,e){if(1&n&&(Pt(0,"span",12),gn(1,aae,1,0,null,13),At()),2&n){const t=dn(2);Rt(1),vt("ngTemplateOutlet",t.checkboxIconTemplate)}}function cae(n,e){if(1&n&&(Gc(0),gn(1,sae,3,2,"ng-container",5),gn(2,lae,2,1,"span",7),Wc()),2&n){const t=dn();Rt(1),vt("ngIf",!t.checkboxIconTemplate),Rt(1),vt("ngIf",t.checkboxIconTemplate)}}const uae=function(n,e,t){return{"p-checkbox-label":!0,"p-checkbox-label-active":n,"p-disabled":e,"p-checkbox-label-focus":t}};function dae(n,e){if(1&n){const t=yd();Pt(0,"label",14),wn("click",function(r){is(t);const s=dn(),o=lT(3);return Er(s.onClick(r,o,!0))}),In(1),At()}if(2&n){const t=dn();Cl(t.labelStyleClass),vt("ngClass",yw(5,uae,t.checked(),t.disabled,t.focused)),ri("for",t.inputId),Rt(1),Tl(t.label)}}const hae=function(n,e,t){return{"p-checkbox p-component":!0,"p-checkbox-checked":n,"p-checkbox-disabled":e,"p-checkbox-focused":t}},fae=function(n,e,t){return{"p-highlight":n,"p-disabled":e,"p-focus":t}},pae={provide:ia,useExisting:fn(()=>mae),multi:!0};let mae=(()=>{class n{cd;value;name;disabled;binary;label;ariaLabelledBy;ariaLabel;tabindex;inputId;style;styleClass;labelStyleClass;formControl;checkboxIcon;readonly;required;trueValue=!0;falseValue=!1;onChange=new $n;inputViewChild;templates;checkboxIconTemplate;model;onModelChange=()=>{};onModelTouched=()=>{};focused=!1;constructor(t){this.cd=t}ngAfterContentInit(){this.templates.forEach(t=>{"icon"===t.getType()&&(this.checkboxIconTemplate=t.template)})}onClick(t,i,r){t.preventDefault(),!this.disabled&&!this.readonly&&(this.updateModel(t),r&&i.focus())}updateModel(t){let i;this.binary?(i=this.checked()?this.falseValue:this.trueValue,this.model=i,this.onModelChange(i)):(i=this.checked()?this.model.filter(r=>!xv.equals(r,this.value)):this.model?[...this.model,this.value]:[this.value],this.onModelChange(i),this.model=i,this.formControl&&this.formControl.setValue(i)),this.onChange.emit({checked:i,originalEvent:t})}handleChange(t){this.readonly||this.updateModel(t)}onFocus(){this.focused=!0}onBlur(){this.focused=!1,this.onModelTouched()}focus(){this.inputViewChild?.nativeElement.focus()}writeValue(t){this.model=t,this.cd.markForCheck()}registerOnChange(t){this.onModelChange=t}registerOnTouched(t){this.onModelTouched=t}setDisabledState(t){this.disabled=t,this.cd.markForCheck()}checked(){return this.binary?this.model===this.trueValue:xv.contains(this.value,this.model)}static \u0275fac=function(i){return new(i||n)(le(iy))};static \u0275cmp=Ki({type:n,selectors:[["p-checkbox"]],contentQueries:function(i,r,s){if(1&i&&ww(s,uz,4),2&i){let o;pp(o=mp())&&(r.templates=o)}},viewQuery:function(i,r){if(1&i&&OT(nae,5),2&i){let s;pp(s=mp())&&(r.inputViewChild=s.first)}},hostAttrs:[1,"p-element"],inputs:{value:"value",name:"name",disabled:"disabled",binary:"binary",label:"label",ariaLabelledBy:"ariaLabelledBy",ariaLabel:"ariaLabel",tabindex:"tabindex",inputId:"inputId",style:"style",styleClass:"styleClass",labelStyleClass:"labelStyleClass",formControl:"formControl",checkboxIcon:"checkboxIcon",readonly:"readonly",required:"required",trueValue:"trueValue",falseValue:"falseValue"},outputs:{onChange:"onChange"},features:[kn([pae])],decls:7,vars:26,consts:[[3,"ngStyle","ngClass"],[1,"p-hidden-accessible"],["type","checkbox",3,"readonly","value","checked","disabled","focus","blur","change"],["cb",""],[1,"p-checkbox-box",3,"ngClass","click"],[4,"ngIf"],[3,"class","ngClass","click",4,"ngIf"],["class","p-checkbox-icon",4,"ngIf"],["class","p-checkbox-icon",3,"ngClass",4,"ngIf"],[3,"styleClass",4,"ngIf"],[1,"p-checkbox-icon",3,"ngClass"],[3,"styleClass"],[1,"p-checkbox-icon"],[4,"ngTemplateOutlet"],[3,"ngClass","click"]],template:function(i,r){if(1&i){const s=yd();Pt(0,"div",0)(1,"div",1)(2,"input",2,3),wn("focus",function(){return r.onFocus()})("blur",function(){return r.onBlur()})("change",function(a){return r.handleChange(a)}),At()(),Pt(4,"div",4),wn("click",function(a){is(s);const l=lT(3);return Er(r.onClick(a,l,!0))}),gn(5,cae,3,2,"ng-container",5),At()(),gn(6,dae,2,9,"label",6)}2&i&&(Cl(r.styleClass),vt("ngStyle",r.style)("ngClass",yw(18,hae,r.checked(),r.disabled,r.focused)),Rt(2),vt("readonly",r.readonly)("value",r.value)("checked",r.checked())("disabled",r.disabled),ri("id",r.inputId)("name",r.name)("tabindex",r.tabindex)("aria-labelledby",r.ariaLabelledBy)("aria-label",r.ariaLabel)("aria-checked",r.checked())("required",r.required),Rt(2),vt("ngClass",yw(22,fae,r.checked(),r.disabled,r.focused)),Rt(1),vt("ngIf",r.checked()),Rt(1),vt("ngIf",r.label))},dependencies:function(){return[Hw,ay,vA,yA,wz]},styles:["@layer primeng{.p-checkbox{display:inline-flex;cursor:pointer;-webkit-user-select:none;user-select:none;vertical-align:bottom;position:relative}.p-checkbox-disabled{cursor:default!important;pointer-events:none}.p-checkbox-box{display:flex;justify-content:center;align-items:center}p-checkbox{display:inline-flex;vertical-align:bottom;align-items:center}.p-checkbox-label{line-height:1}}\n"],encapsulation:2,changeDetection:0})}return n})(),gae=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=Fi({type:n});static \u0275inj=Ci({imports:[bp,wz,QI]})}return n})(),_ae=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=Fi({type:n,bootstrap:[tae]});static#n=this.\u0275inj=Ci({imports:[u2,J7,rX,eae,Doe,gae,Jse,Voe]})}return n})();Y$().bootstrapModule(_ae).catch(n=>console.error(n))},990:function(Fs,ec,fh){var hn;Fs=fh.nmd(Fs),function(){var B,$r="Expected a function",ph="__lodash_hash_undefined__",el="__lodash_placeholder__",Sn=1/0,Lo=9007199254740991,so=4294967295,Nv=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],Hn="[object Arguments]",Zn="[object Array]",Jt="[object Boolean]",tl="[object Date]",rc="[object Error]",yh="[object Function]",Lv="[object GeneratorFunction]",ks="[object Map]",vh="[object Number]",fa="[object Object]",_x="[object Promise]",sc="[object RegExp]",Us="[object Set]",nl="[object String]",bh="[object Symbol]",oc="[object WeakMap]",Cu="[object ArrayBuffer]",ac="[object DataView]",oo="[object Float32Array]",wh="[object Float64Array]",zm="[object Int8Array]",Eh="[object Int16Array]",Gm="[object Int32Array]",Wm="[object Uint8Array]",jm="[object Uint8ClampedArray]",$m="[object Uint16Array]",qm="[object Uint32Array]",bx=/\b__p \+= '';/g,wx=/\b(__p \+=) '' \+/g,Ex=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Ov=/&(?:amp|lt|gt|quot|#39);/g,Fv=/[&<>"']/g,lR=RegExp(Ov.source),kv=RegExp(Fv.source),Uv=/<%-([\s\S]+?)%>/g,Bv=/<%([\s\S]+?)%>/g,Xm=/<%=([\s\S]+?)%>/g,Vv=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Sx=/^\w*$/,Hv=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Sh=/[\\^$.*+?()[\]{}|]/g,zv=RegExp(Sh.source),xh=/^\s+/,Yr=/\s/,xx=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Mx=/\{\n\/\* \[wrapped with (.+)\] \*/,Cx=/,? & /,Tx=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Gv=/[()=,{}\[\]\/\s]/,Ax=/\\(\\)?/g,Dx=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ao=/\w*$/,Ix=/^[-+]0x[0-9a-f]+$/i,Zi=/^0b[01]+$/i,lc=/^\[object .+?Constructor\]$/,lo=/^0o[0-7]+$/i,cR=/^(?:0|[1-9]\d*)$/,Rx=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Mh=/($^)/,Ym=/['\n\r\u2028\u2029\\]/g,Tu="\\ud800-\\udfff",Zm="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",jv="\\u2700-\\u27bf",$v="a-z\\xdf-\\xf6\\xf8-\\xff",Xv="A-Z\\xc0-\\xd6\\xd8-\\xde",hi="\\ufe0e\\ufe0f",Yv="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",pt="["+Tu+"]",Km="["+Yv+"]",cc="["+Zm+"]",ys="\\d+",Fx="["+jv+"]",Zv="["+$v+"]",cn="[^"+Tu+Yv+ys+jv+$v+Xv+"]",uc="\\ud83c[\\udffb-\\udfff]",Ch="[^"+Tu+"]",Jm="(?:\\ud83c[\\udde6-\\uddff]){2}",fn="[\\ud800-\\udbff][\\udc00-\\udfff]",lt="["+Xv+"]",Ah="(?:"+Zv+"|"+cn+")",uR="(?:"+lt+"|"+cn+")",Qm="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",se="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",Du="(?:"+cc+"|"+uc+")?",Et="["+hi+"]?",Kv=Et+Du+"(?:\\u200d(?:"+[Ch,Jm,fn].join("|")+")"+Et+Du+")*",eg="(?:"+[Fx,Jm,fn].join("|")+")"+Kv,Zr="(?:"+[Ch+cc+"?",cc,Jm,fn,pt].join("|")+")",hR=RegExp("['\u2019]","g"),Ux=RegExp(cc,"g"),Jv=RegExp(uc+"(?="+uc+")|"+Zr+Kv,"g"),il=RegExp([lt+"?"+Zv+"+"+Qm+"(?="+[Km,lt,"$"].join("|")+")",uR+"+"+se+"(?="+[Km,lt+Ah,"$"].join("|")+")",lt+"?"+Ah+"+"+Qm,lt+"+"+se,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ys,eg].join("|"),"g"),fR=RegExp("[\\u200d"+Tu+Zm+hi+"]"),pR=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,mR=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],gR=-1,Nn={};Nn[oo]=Nn[wh]=Nn[zm]=Nn[Eh]=Nn[Gm]=Nn[Wm]=Nn[jm]=Nn[$m]=Nn[qm]=!0,Nn[Hn]=Nn[Zn]=Nn[Cu]=Nn[Jt]=Nn[ac]=Nn[tl]=Nn[rc]=Nn[yh]=Nn[ks]=Nn[vh]=Nn[fa]=Nn[sc]=Nn[Us]=Nn[nl]=Nn[oc]=!1;var Ln={};Ln[Hn]=Ln[Zn]=Ln[Cu]=Ln[ac]=Ln[Jt]=Ln[tl]=Ln[oo]=Ln[wh]=Ln[zm]=Ln[Eh]=Ln[Gm]=Ln[ks]=Ln[vh]=Ln[fa]=Ln[sc]=Ln[Us]=Ln[nl]=Ln[bh]=Ln[Wm]=Ln[jm]=Ln[$m]=Ln[qm]=!0,Ln[rc]=Ln[yh]=Ln[oc]=!1;var mt={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},yR=parseFloat,vR=parseInt,Vx="object"==typeof global&&global&&global.Object===Object&&global,Ke="object"==typeof self&&self&&self.Object===Object&&self,or=Vx||Ke||Function("return this")(),Ci=ec&&!ec.nodeType&&ec,pa=Ci&&Fs&&!Fs.nodeType&&Fs,Qv=pa&&pa.exports===Ci,Dh=Qv&&Vx.process,bs=function(){try{return pa&&pa.require&&pa.require("util").types||Dh&&Dh.binding&&Dh.binding("util")}catch{}}(),Iu=bs&&bs.isArrayBuffer,Ru=bs&&bs.isDate,Ih=bs&&bs.isMap,tg=bs&&bs.isRegExp,e0=bs&&bs.isSet,jt=bs&&bs.isTypedArray;function yr(Y,ue,ie){switch(ie.length){case 0:return Y.call(ue);case 1:return Y.call(ue,ie[0]);case 2:return Y.call(ue,ie[0],ie[1]);case 3:return Y.call(ue,ie[0],ie[1],ie[2])}return Y.apply(ue,ie)}function t0(Y,ue,ie,ke){for(var Ct=-1,ln=null==Y?0:Y.length;++Ct<ln;){var Ti=Y[Ct];ue(ke,Ti,ie(Ti),Y)}return ke}function On(Y,ue){for(var ie=-1,ke=null==Y?0:Y.length;++ie<ke&&!1!==ue(Y[ie],ie,Y););return Y}function n0(Y,ue){for(var ie=null==Y?0:Y.length;ie--&&!1!==ue(Y[ie],ie,Y););return Y}function Hx(Y,ue){for(var ie=-1,ke=null==Y?0:Y.length;++ie<ke;)if(!ue(Y[ie],ie,Y))return!1;return!0}function sn(Y,ue){for(var ie=-1,ke=null==Y?0:Y.length,Ct=0,ln=[];++ie<ke;){var Ti=Y[ie];ue(Ti,ie,Y)&&(ln[Ct++]=Ti)}return ln}function ng(Y,ue){return!(null==Y||!Y.length)&&Pu(Y,ue,0)>-1}function r0(Y,ue,ie){for(var ke=-1,Ct=null==Y?0:Y.length;++ke<Ct;)if(ie(ue,Y[ke]))return!0;return!1}function Tn(Y,ue){for(var ie=-1,ke=null==Y?0:Y.length,Ct=Array(ke);++ie<ke;)Ct[ie]=ue(Y[ie],ie,Y);return Ct}function co(Y,ue){for(var ie=-1,ke=ue.length,Ct=Y.length;++ie<ke;)Y[Ct+ie]=ue[ie];return Y}function Rh(Y,ue,ie,ke){var Ct=-1,ln=null==Y?0:Y.length;for(ke&&ln&&(ie=Y[++Ct]);++Ct<ln;)ie=ue(ie,Y[Ct],Ct,Y);return ie}function ig(Y,ue,ie,ke){var Ct=null==Y?0:Y.length;for(ke&&Ct&&(ie=Y[--Ct]);Ct--;)ie=ue(ie,Y[Ct],Ct,Y);return ie}function rg(Y,ue){for(var ie=-1,ke=null==Y?0:Y.length;++ie<ke;)if(ue(Y[ie],ie,Y))return!0;return!1}var sg=ag("length");function zx(Y,ue,ie){var ke;return ie(Y,function(Ct,ln,Ti){if(ue(Ct,ln,Ti))return ke=ln,!1}),ke}function og(Y,ue,ie,ke){for(var Ct=Y.length,ln=ie+(ke?1:-1);ke?ln--:++ln<Ct;)if(ue(Y[ln],ln,Y))return ln;return-1}function Pu(Y,ue,ie){return ue==ue?function ko(Y,ue,ie){for(var ke=ie-1,Ct=Y.length;++ke<Ct;)if(Y[ke]===ue)return ke;return-1}(Y,ue,ie):og(Y,Ph,ie)}function Nu(Y,ue,ie,ke){for(var Ct=ie-1,ln=Y.length;++Ct<ln;)if(ke(Y[Ct],ue))return Ct;return-1}function Ph(Y){return Y!=Y}function Lu(Y,ue){var ie=null==Y?0:Y.length;return ie?ma(Y,ue)/ie:NaN}function ag(Y){return function(ue){return null==ue?B:ue[Y]}}function lg(Y){return function(ue){return null==Y?B:Y[ue]}}function s0(Y,ue,ie,ke,Ct){return Ct(Y,function(ln,Ti,xn){ie=ke?(ke=!1,ln):ue(ie,ln,Ti,xn)}),ie}function ma(Y,ue){for(var ie,ke=-1,Ct=Y.length;++ke<Ct;){var ln=ue(Y[ke]);ln!==B&&(ie=ie===B?ln:ie+ln)}return ie}function cg(Y,ue){for(var ie=-1,ke=Array(Y);++ie<Y;)ke[ie]=ue(ie);return ke}function a0(Y){return Y&&Y.slice(0,Oh(Y)+1).replace(xh,"")}function Le(Y){return function(ue){return Y(ue)}}function Nh(Y,ue){return Tn(ue,function(ie){return Y[ie]})}function Ve(Y,ue){return Y.has(ue)}function Ou(Y,ue){for(var ie=-1,ke=Y.length;++ie<ke&&Pu(ue,Y[ie],0)>-1;);return ie}function Lh(Y,ue){for(var ie=Y.length;ie--&&Pu(ue,Y[ie],0)>-1;);return ie}var Gx=lg({\u00c0:"A",\u00c1:"A",\u00c2:"A",\u00c3:"A",\u00c4:"A",\u00c5:"A",\u00e0:"a",\u00e1:"a",\u00e2:"a",\u00e3:"a",\u00e4:"a",\u00e5:"a",\u00c7:"C",\u00e7:"c",\u00d0:"D",\u00f0:"d",\u00c8:"E",\u00c9:"E",\u00ca:"E",\u00cb:"E",\u00e8:"e",\u00e9:"e",\u00ea:"e",\u00eb:"e",\u00cc:"I",\u00cd:"I",\u00ce:"I",\u00cf:"I",\u00ec:"i",\u00ed:"i",\u00ee:"i",\u00ef:"i",\u00d1:"N",\u00f1:"n",\u00d2:"O",\u00d3:"O",\u00d4:"O",\u00d5:"O",\u00d6:"O",\u00d8:"O",\u00f2:"o",\u00f3:"o",\u00f4:"o",\u00f5:"o",\u00f6:"o",\u00f8:"o",\u00d9:"U",\u00da:"U",\u00db:"U",\u00dc:"U",\u00f9:"u",\u00fa:"u",\u00fb:"u",\u00fc:"u",\u00dd:"Y",\u00fd:"y",\u00ff:"y",\u00c6:"Ae",\u00e6:"ae",\u00de:"Th",\u00fe:"th",\u00df:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010a:"C",\u010c:"C",\u0107:"c",\u0109:"c",\u010b:"c",\u010d:"c",\u010e:"D",\u0110:"D",\u010f:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011a:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011b:"e",\u011c:"G",\u011e:"G",\u0120:"G",\u0122:"G",\u011d:"g",\u011f:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012a:"I",\u012c:"I",\u012e:"I",\u0130:"I",\u0129:"i",\u012b:"i",\u012d:"i",\u012f:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013b:"L",\u013d:"L",\u013f:"L",\u0141:"L",\u013a:"l",\u013c:"l",\u013e:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014a:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014b:"n",\u014c:"O",\u014e:"O",\u0150:"O",\u014d:"o",\u014f:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015a:"S",\u015c:"S",\u015e:"S",\u0160:"S",\u015b:"s",\u015d:"s",\u015f:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016a:"U",\u016c:"U",\u016e:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016b:"u",\u016d:"u",\u016f:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017b:"Z",\u017d:"Z",\u017a:"z",\u017c:"z",\u017e:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017f:"s"}),Wx=lg({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function jx(Y){return"\\"+mt[Y]}function Fo(Y){return fR.test(Y)}function nn(Y){var ue=-1,ie=Array(Y.size);return Y.forEach(function(ke,Ct){ie[++ue]=[Ct,ke]}),ie}function ku(Y,ue){return function(ie){return Y(ue(ie))}}function ho(Y,ue){for(var ie=-1,ke=Y.length,Ct=0,ln=[];++ie<ke;){var Ti=Y[ie];(Ti===ue||Ti===el)&&(Y[ie]=el,ln[Ct++]=ie)}return ln}function dc(Y){var ue=-1,ie=Array(Y.size);return Y.forEach(function(ke){ie[++ue]=ke}),ie}function rl(Y){return Fo(Y)?function u0(Y){for(var ue=Jv.lastIndex=0;Jv.test(Y);)++ue;return ue}(Y):sg(Y)}function Es(Y){return Fo(Y)?function Bu(Y){return Y.match(Jv)||[]}(Y):function bR(Y){return Y.split("")}(Y)}function Oh(Y){for(var ue=Y.length;ue--&&Yr.test(Y.charAt(ue)););return ue}var c0=lg({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),Fh=function Y(ue){var u,ie=(ue=null==ue?or:Fh.defaults(or.Object(),ue,Fh.pick(or,mR))).Array,ke=ue.Date,Ct=ue.Error,ln=ue.Function,Ti=ue.Math,xn=ue.Object,ug=ue.RegExp,$x=ue.String,Kr=ue.TypeError,kh=ie.prototype,hc=xn.prototype,Ki=ue["__core-js_shared__"],Uh=ln.prototype.toString,pn=hc.hasOwnProperty,Xx=0,Fi=(u=/[^.]+$/.exec(Ki&&Ki.keys&&Ki.keys.IE_PROTO||""))?"Symbol(src)_1."+u:"",Bh=hc.toString,f0=Uh.call(xn),ft=or._,Ir=ug("^"+Uh.call(pn).replace(Sh,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Yt=Qv?ue.Buffer:B,zn=ue.Symbol,ki=ue.Uint8Array,sl=Yt?Yt.allocUnsafe:B,ar=ku(xn.getPrototypeOf,xn),dg=xn.create,hg=hc.propertyIsEnumerable,ol=kh.splice,p0=zn?zn.isConcatSpreadable:B,Vu=zn?zn.iterator:B,vn=zn?zn.toStringTag:B,Ue=function(){try{var u=Gs(xn,"defineProperty");return u({},"",{}),u}catch{}}(),It=ue.clearTimeout!==or.clearTimeout&&ue.clearTimeout,Gn=ke&&ke.now!==or.Date.now&&ke.now,Bs=ue.setTimeout!==or.setTimeout&&ue.setTimeout,_a=Ti.ceil,Ai=Ti.floor,ya=xn.getOwnPropertySymbols,li=Yt?Yt.isBuffer:B,Uo=ue.isFinite,fc=kh.join,xt=ku(xn.keys,xn),Kn=Ti.max,Ji=Ti.min,pc=ke.now,ci=ue.parseInt,mc=Ti.random,gc=kh.reverse,Ss=Gs(ue,"DataView"),Bo=Gs(ue,"Map"),Vh=Gs(ue,"Promise"),Jr=Gs(ue,"Set"),Qr=Gs(ue,"WeakMap"),Vo=Gs(xn,"create"),va=Qr&&new Qr,Ft={},ER=Ia(Ss),fg=Ia(Bo),m0=Ia(Vh),fo=Ia(Jr),Hh=Ia(Qr),Ho=zn?zn.prototype:B,zo=Ho?Ho.valueOf:B,Ui=Ho?Ho.toString:B;function I(u){if(Qn(u)&&!Tt(u)&&!(u instanceof kt)){if(u instanceof Rr)return u;if(pn.call(u,"__wrapped__"))return _l(u)}return new Rr(u)}var Di=function(){function u(){}return function(f){if(!jn(f))return{};if(dg)return dg(f);u.prototype=f;var _=new u;return u.prototype=B,_}}();function Bi(){}function Rr(u,f){this.__wrapped__=u,this.__actions__=[],this.__chain__=!!f,this.__index__=0,this.__values__=B}function kt(u){this.__wrapped__=u,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=so,this.__views__=[]}function al(u){var f=-1,_=null==u?0:u.length;for(this.clear();++f<_;){var S=u[f];this.set(S[0],S[1])}}function ba(u){var f=-1,_=null==u?0:u.length;for(this.clear();++f<_;){var S=u[f];this.set(S[0],S[1])}}function wa(u){var f=-1,_=null==u?0:u.length;for(this.clear();++f<_;){var S=u[f];this.set(S[0],S[1])}}function Ea(u){var f=-1,_=null==u?0:u.length;for(this.__data__=new wa;++f<_;)this.add(u[f])}function po(u){var f=this.__data__=new ba(u);this.size=f.size}function Hu(u,f){var _=Tt(u),S=!_&&yl(u),M=!_&&!S&&Pa(u),P=!_&&!S&&!M&&Fc(u),U=_||S||M||P,W=U?cg(u.length,$x):[],Z=W.length;for(var pe in u)(f||pn.call(u,pe))&&(!U||!("length"==pe||M&&("offset"==pe||"parent"==pe)||P&&("buffer"==pe||"byteLength"==pe||"byteOffset"==pe)||yo(pe,Z)))&&W.push(pe);return W}function es(u){var f=u.length;return f?u[tf(0,f-1)]:B}function _0(u,f){return qo(cr(u),xa(f,0,u.length))}function y0(u){return qo(cr(u))}function Gh(u,f,_){(_!==B&&!js(u[f],_)||_===B&&!(f in u))&&mo(u,f,_)}function _c(u,f,_){var S=u[f];(!pn.call(u,f)||!js(S,_)||_===B&&!(f in u))&&mo(u,f,_)}function yc(u,f){for(var _=u.length;_--;)if(js(u[_][0],f))return _;return-1}function v0(u,f,_,S){return ul(u,function(M,P,U){f(S,M,_(M),U)}),S}function Wh(u,f){return u&&zs(f,Gi(f),u)}function mo(u,f,_){"__proto__"==f&&Ue?Ue(u,f,{configurable:!0,enumerable:!0,value:_,writable:!0}):u[f]=_}function jh(u,f){for(var _=-1,S=f.length,M=ie(S),P=null==u;++_<S;)M[_]=P?B:Pb(u,f[_]);return M}function xa(u,f,_){return u==u&&(_!==B&&(u=u<=_?u:_),f!==B&&(u=u>=f?u:f)),u}function vr(u,f,_,S,M,P){var U,W=1&f,Z=2&f,pe=4&f;if(_&&(U=M?_(u,S,M,P):_(u)),U!==B)return U;if(!jn(u))return u;var me=Tt(u);if(me){if(U=function fM(u){var f=u.length,_=new u.constructor(f);return f&&"string"==typeof u[0]&&pn.call(u,"index")&&(_.index=u.index,_.input=u.input),_}(u),!W)return cr(u,U)}else{var be=Ri(u),Be=be==yh||be==Lv;if(Pa(u))return lr(u,W);if(be==fa||be==Hn||Be&&!M){if(U=Z||Be?{}:Ws(u),!W)return Z?function uM(u,f){return zs(u,mf(u),f)}(u,function mg(u,f){return u&&zs(f,hr(f),u)}(U,u)):function Cg(u,f){return zs(u,fl(u),f)}(u,Wh(U,u))}else{if(!Ln[be])return M?u:{};U=function pM(u,f,_){var S=u.constructor;switch(f){case Cu:return Hs(u);case Jt:case tl:return new S(+u);case ac:return function O0(u,f){var _=f?Hs(u.buffer):u.buffer;return new u.constructor(_,u.byteOffset,u.byteLength)}(u,_);case oo:case wh:case zm:case Eh:case Gm:case Wm:case jm:case $m:case qm:return F0(u,_);case ks:return new S;case vh:case nl:return new S(u);case sc:return function Ec(u){var f=new u.constructor(u.source,ao.exec(u));return f.lastIndex=u.lastIndex,f}(u);case Us:return new S;case bh:return function Wo(u){return zo?xn(zo.call(u)):{}}(u)}}(u,be,W)}}P||(P=new po);var tt=P.get(u);if(tt)return tt;P.set(u,U),u_(u)?u.forEach(function(dt){U.add(vr(dt,f,_,dt,u,P))}):Ff(u)&&u.forEach(function(dt,Vt){U.set(Vt,vr(dt,f,_,Vt,u,P))});var Gt=me?B:(pe?Z?Ju:z0:Z?hr:Gi)(u);return On(Gt||u,function(dt,Vt){Gt&&(dt=u[Vt=dt]),_c(U,Vt,vr(dt,f,_,Vt,u,P))}),U}function cl(u,f,_){var S=_.length;if(null==u)return!S;for(u=xn(u);S--;){var M=_[S],U=u[M];if(U===B&&!(M in u)||!(0,f[M])(U))return!1}return!0}function gg(u,f,_){if("function"!=typeof u)throw new Kr($r);return ml(function(){u.apply(B,_)},f)}function $h(u,f,_,S){var M=-1,P=ng,U=!0,W=u.length,Z=[],pe=f.length;if(!W)return Z;_&&(f=Tn(f,Le(_))),S?(P=r0,U=!1):f.length>=200&&(P=Ve,U=!1,f=new Ea(f));e:for(;++M<W;){var me=u[M],be=null==_?me:_(me);if(me=S||0!==me?me:0,U&&be==be){for(var Be=pe;Be--;)if(f[Be]===be)continue e;Z.push(me)}else P(f,be,S)||Z.push(me)}return Z}I.templateSettings={escape:Uv,evaluate:Bv,interpolate:Xm,variable:"",imports:{_:I}},(I.prototype=Bi.prototype).constructor=I,(Rr.prototype=Di(Bi.prototype)).constructor=Rr,(kt.prototype=Di(Bi.prototype)).constructor=kt,al.prototype.clear=function Yx(){this.__data__=Vo?Vo(null):{},this.size=0},al.prototype.delete=function SR(u){var f=this.has(u)&&delete this.__data__[u];return this.size-=f?1:0,f},al.prototype.get=function Zx(u){var f=this.__data__;if(Vo){var _=f[u];return _===ph?B:_}return pn.call(f,u)?f[u]:B},al.prototype.has=function Kx(u){var f=this.__data__;return Vo?f[u]!==B:pn.call(f,u)},al.prototype.set=function xR(u,f){var _=this.__data__;return this.size+=this.has(u)?0:1,_[u]=Vo&&f===B?ph:f,this},ba.prototype.clear=function MR(){this.__data__=[],this.size=0},ba.prototype.delete=function CR(u){var f=this.__data__,_=yc(f,u);return!(_<0||(_==f.length-1?f.pop():ol.call(f,_,1),--this.size,0))},ba.prototype.get=function TR(u){var f=this.__data__,_=yc(f,u);return _<0?B:f[_][1]},ba.prototype.has=function AR(u){return yc(this.__data__,u)>-1},ba.prototype.set=function DR(u,f){var _=this.__data__,S=yc(_,u);return S<0?(++this.size,_.push([u,f])):_[S][1]=f,this},wa.prototype.clear=function IR(){this.size=0,this.__data__={hash:new al,map:new(Bo||ba),string:new al}},wa.prototype.delete=function RR(u){var f=Lg(this,u).delete(u);return this.size-=f?1:0,f},wa.prototype.get=function PR(u){return Lg(this,u).get(u)},wa.prototype.has=function NR(u){return Lg(this,u).has(u)},wa.prototype.set=function g0(u,f){var _=Lg(this,u),S=_.size;return _.set(u,f),this.size+=_.size==S?0:1,this},Ea.prototype.add=Ea.prototype.push=function LR(u){return this.__data__.set(u,ph),this},Ea.prototype.has=function OR(u){return this.__data__.has(u)},po.prototype.clear=function ll(){this.__data__=new ba,this.size=0},po.prototype.delete=function Sa(u){var f=this.__data__,_=f.delete(u);return this.size=f.size,_},po.prototype.get=function FR(u){return this.__data__.get(u)},po.prototype.has=function kR(u){return this.__data__.has(u)},po.prototype.set=function Qi(u,f){var _=this.__data__;if(_ instanceof ba){var S=_.__data__;if(!Bo||S.length<199)return S.push([u,f]),this.size=++_.size,this;_=this.__data__=new wa(S)}return _.set(u,f),this.size=_.size,this};var ul=Tg(Go),Jx=Tg(b0,!0);function Qx(u,f){var _=!0;return ul(u,function(S,M,P){return _=!!f(S,M,P)}),_}function qh(u,f,_){for(var S=-1,M=u.length;++S<M;){var P=u[S],U=f(P);if(null!=U&&(W===B?U==U&&!rs(U):_(U,W)))var W=U,Z=P}return Z}function _g(u,f){var _=[];return ul(u,function(S,M,P){f(S,M,P)&&_.push(S)}),_}function Ii(u,f,_,S,M){var P=-1,U=u.length;for(_||(_=Fg),M||(M=[]);++P<U;){var W=u[P];f>0&&_(W)?f>1?Ii(W,f-1,_,S,M):co(M,W):S||(M[M.length]=W)}return M}var yg=Ag(),Xh=Ag(!0);function Go(u,f){return u&&yg(u,f,Gi)}function b0(u,f){return u&&Xh(u,f,Gi)}function Yh(u,f){return sn(f,function(_){return Ts(u[_])})}function Ma(u,f){for(var _=0,S=(f=_o(f,u)).length;null!=u&&_<S;)u=u[xr(f[_++])];return _&&_==S?u:B}function vg(u,f,_){var S=f(u);return Tt(u)?S:co(S,_(u))}function br(u){return null==u?u===B?"[object Undefined]":"[object Null]":vn&&vn in xn(u)?function hM(u){var f=pn.call(u,vn),_=u[vn];try{u[vn]=B;var S=!0}catch{}var M=Bh.call(u);return S&&(f?u[vn]=_:delete u[vn]),M}(u):function Y0(u){return Bh.call(u)}(u)}function bg(u,f){return u>f}function eM(u,f){return null!=u&&pn.call(u,f)}function w0(u,f){return null!=u&&f in xn(u)}function Zh(u,f,_){for(var S=_?r0:ng,M=u[0].length,P=u.length,U=P,W=ie(P),Z=1/0,pe=[];U--;){var me=u[U];U&&f&&(me=Tn(me,Le(f))),Z=Ji(me.length,Z),W[U]=!_&&(f||M>=120&&me.length>=120)?new Ea(U&&me):B}me=u[0];var be=-1,Be=W[0];e:for(;++be<M&&pe.length<Z;){var tt=me[be],ct=f?f(tt):tt;if(tt=_||0!==tt?tt:0,!(Be?Ve(Be,ct):S(pe,ct,_))){for(U=P;--U;){var Gt=W[U];if(!(Gt?Ve(Gt,ct):S(u[U],ct,_)))continue e}Be&&Be.push(ct),pe.push(tt)}}return pe}function Kh(u,f,_){var S=null==(u=Z0(u,f=_o(f,u)))?u:u[xr(Wn(f))];return null==S?B:yr(S,u,_)}function E0(u){return Qn(u)&&br(u)==Hn}function Gu(u,f,_,S,M){return u===f||(null==u||null==f||!Qn(u)&&!Qn(f)?u!=u&&f!=f:function iM(u,f,_,S,M,P){var U=Tt(u),W=Tt(f),Z=U?Zn:Ri(u),pe=W?Zn:Ri(f),me=(Z=Z==Hn?fa:Z)==fa,be=(pe=pe==Hn?fa:pe)==fa,Be=Z==pe;if(Be&&Pa(u)){if(!Pa(f))return!1;U=!0,me=!1}if(Be&&!me)return P||(P=new po),U||Fc(u)?H0(u,f,_,S,M,P):function Sc(u,f,_,S,M,P,U){switch(_){case ac:if(u.byteLength!=f.byteLength||u.byteOffset!=f.byteOffset)return!1;u=u.buffer,f=f.buffer;case Cu:return!(u.byteLength!=f.byteLength||!P(new ki(u),new ki(f)));case Jt:case tl:case vh:return js(+u,+f);case rc:return u.name==f.name&&u.message==f.message;case sc:case nl:return u==f+"";case ks:var W=nn;case Us:if(W||(W=dc),u.size!=f.size&&!(1&S))return!1;var pe=U.get(u);if(pe)return pe==f;S|=2,U.set(u,f);var me=H0(W(u),W(f),S,M,P,U);return U.delete(u),me;case bh:if(zo)return zo.call(u)==zo.call(f)}return!1}(u,f,Z,_,S,M,P);if(!(1&_)){var tt=me&&pn.call(u,"__wrapped__"),ct=be&&pn.call(f,"__wrapped__");if(tt||ct){var Gt=tt?u.value():u,dt=ct?f.value():f;return P||(P=new po),M(Gt,dt,_,S,P)}}return!!Be&&(P||(P=new po),function Ku(u,f,_,S,M,P){var U=1&_,W=z0(u),Z=W.length;if(Z!=z0(f).length&&!U)return!1;for(var be=Z;be--;){var Be=W[be];if(!(U?Be in f:pn.call(f,Be)))return!1}var tt=P.get(u),ct=P.get(f);if(tt&&ct)return tt==f&&ct==u;var Gt=!0;P.set(u,f),P.set(f,u);for(var dt=U;++be<Z;){var Vt=u[Be=W[be]],Qt=f[Be];if(S)var Wi=U?S(Qt,Vt,Be,f,u,P):S(Vt,Qt,Be,u,f,P);if(!(Wi===B?Vt===Qt||M(Vt,Qt,_,S,P):Wi)){Gt=!1;break}dt||(dt="constructor"==Be)}if(Gt&&!dt){var bn=u.constructor,os=f.constructor;bn!=os&&"constructor"in u&&"constructor"in f&&!("function"==typeof bn&&bn instanceof bn&&"function"==typeof os&&os instanceof os)&&(Gt=!1)}return P.delete(u),P.delete(f),Gt}(u,f,_,S,M,P))}(u,f,_,S,Gu,M))}function Jh(u,f,_,S){var M=_.length,P=M,U=!S;if(null==u)return!P;for(u=xn(u);M--;){var W=_[M];if(U&&W[2]?W[1]!==u[W[0]]:!(W[0]in u))return!1}for(;++M<P;){var Z=(W=_[M])[0],pe=u[Z],me=W[1];if(U&&W[2]){if(pe===B&&!(Z in u))return!1}else{var be=new po;if(S)var Be=S(pe,me,Z,u,f,be);if(!(Be===B?Gu(me,pe,3,S,be):Be))return!1}}return!0}function M0(u){return!(!jn(u)||function j0(u){return!!Fi&&Fi in u}(u))&&(Ts(u)?Ir:lc).test(Ia(u))}function Eg(u){return"function"==typeof u?u:null==u?fr:"object"==typeof u?Tt(u)?C0(u[0],u[1]):wr(u):RC(u)}function Qh(u){if(!Mc(u))return xt(u);var f=[];for(var _ in xn(u))pn.call(u,_)&&"constructor"!=_&&f.push(_);return f}function Wu(u,f){return u<f}function ju(u,f){var _=-1,S=dr(u)?ie(u.length):[];return ul(u,function(M,P,U){S[++_]=f(M,P,U)}),S}function wr(u){var f=Qu(u);return 1==f.length&&f[0][2]?td(f[0][0],f[0][1]):function(_){return _===u||Jh(_,u,f)}}function C0(u,f){return ed(u)&&q0(f)?td(xr(u),f):function(_){var S=Pb(_,u);return S===B&&S===f?Hf(_,u):Gu(f,S,3)}}function $u(u,f,_,S,M){u!==f&&yg(f,function(P,U){if(M||(M=new po),jn(P))!function vc(u,f,_,S,M,P,U){var W=kg(u,_),Z=kg(f,_),pe=U.get(Z);if(pe)Gh(u,_,pe);else{var me=P?P(W,Z,_+"",u,f,U):B,be=me===B;if(be){var Be=Tt(Z),tt=!Be&&Pa(Z),ct=!Be&&!tt&&Fc(Z);me=Z,Be||tt||ct?Tt(W)?me=W:Jn(W)?me=cr(W):tt?(be=!1,me=lr(Z,!0)):ct?(be=!1,me=F0(Z,!0)):me=[]:bl(Z)||yl(Z)?(me=W,yl(W)?me=Db(W):(!jn(W)||Ts(W))&&(me=Ws(Z))):be=!1}be&&(U.set(Z,me),M(me,Z,S,P,U),U.delete(Z)),Gh(u,_,me)}}(u,f,U,_,$u,S,M);else{var W=S?S(kg(u,U),P,U+"",u,f,M):B;W===B&&(W=P),Gh(u,U,W)}},hr)}function Pr(u,f){var _=u.length;if(_)return yo(f+=f<0?_:0,_)?u[f]:B}function T0(u,f,_){f=f.length?Tn(f,function(P){return Tt(P)?function(U){return Ma(U,1===P.length?P[0]:P)}:P}):[fr];var S=-1;return f=Tn(f,Le(ut())),function o0(Y,ue){var ie=Y.length;for(Y.sort(ue);ie--;)Y[ie]=Y[ie].value;return Y}(ju(u,function(P,U,W){return{criteria:Tn(f,function(pe){return pe(P)}),index:++S,value:P}}),function(P,U){return function cM(u,f,_){for(var S=-1,M=u.criteria,P=f.criteria,U=M.length,W=_.length;++S<U;){var Z=Mg(M[S],P[S]);if(Z)return S>=W?Z:Z*("desc"==_[S]?-1:1)}return u.index-f.index}(P,U,_)})}function A0(u,f,_){for(var S=-1,M=f.length,P={};++S<M;){var U=f[S],W=Ma(u,U);_(W,U)&&rf(P,_o(U,u),W)}return P}function ef(u,f,_,S){var M=S?Nu:Pu,P=-1,U=f.length,W=u;for(u===f&&(f=cr(f)),_&&(W=Tn(u,Le(_)));++P<U;)for(var Z=0,pe=f[P],me=_?_(pe):pe;(Z=M(W,me,Z,S))>-1;)W!==u&&ol.call(W,Z,1),ol.call(u,Z,1);return u}function D0(u,f){for(var _=u?f.length:0,S=_-1;_--;){var M=f[_];if(_==S||M!==P){var P=M;yo(M)?ol.call(u,M,1):Kt(u,M)}}return u}function tf(u,f){return u+Ai(mc()*(f-u+1))}function nf(u,f){var _="";if(!u||f<1||f>Lo)return _;do{f%2&&(_+=u),(f=Ai(f/2))&&(u+=u)}while(f);return _}function zt(u,f){return Ug(Cc(u,f,fr),u+"")}function gt(u){return es(El(u))}function R0(u,f){var _=El(u);return qo(_,xa(f,0,_.length))}function rf(u,f,_,S){if(!jn(u))return u;for(var M=-1,P=(f=_o(f,u)).length,U=P-1,W=u;null!=W&&++M<P;){var Z=xr(f[M]),pe=_;if("__proto__"===Z||"constructor"===Z||"prototype"===Z)return u;if(M!=U){var me=W[Z];(pe=S?S(me,Z,W):B)===B&&(pe=jn(me)?me:yo(f[M+1])?[]:{})}_c(W,Z,pe),W=W[Z]}return u}var P0=va?function(u,f){return va.set(u,f),u}:fr,oM=Ue?function(u,f){return Ue(u,"toString",{configurable:!0,enumerable:!1,value:fd(f),writable:!0})}:fr;function aM(u){return qo(El(u))}function ts(u,f,_){var S=-1,M=u.length;f<0&&(f=-f>M?0:M+f),(_=_>M?M:_)<0&&(_+=M),M=f>_?0:_-f>>>0,f>>>=0;for(var P=ie(M);++S<M;)P[S]=u[S+f];return P}function bc(u,f){var _;return ul(u,function(S,M,P){return!(_=f(S,M,P))}),!!_}function sf(u,f,_){var S=0,M=null==u?S:u.length;if("number"==typeof f&&f==f&&M<=2147483647){for(;S<M;){var P=S+M>>>1,U=u[P];null!==U&&!rs(U)&&(_?U<=f:U<f)?S=P+1:M=P}return M}return Sg(u,f,fr,_)}function Sg(u,f,_,S){var M=0,P=null==u?0:u.length;if(0===P)return 0;for(var U=(f=_(f))!=f,W=null===f,Z=rs(f),pe=f===B;M<P;){var me=Ai((M+P)/2),be=_(u[me]),Be=be!==B,tt=null===be,ct=be==be,Gt=rs(be);if(U)var dt=S||ct;else dt=pe?ct&&(S||Be):W?ct&&Be&&(S||!tt):Z?ct&&Be&&!tt&&(S||!Gt):!tt&&!Gt&&(S?be<=f:be<f);dt?M=me+1:P=me}return Ji(P,4294967294)}function N0(u,f){for(var _=-1,S=u.length,M=0,P=[];++_<S;){var U=u[_],W=f?f(U):U;if(!_||!js(W,Z)){var Z=W;P[M++]=0===U?0:U}}return P}function L0(u){return"number"==typeof u?u:rs(u)?NaN:+u}function ns(u){if("string"==typeof u)return u;if(Tt(u))return Tn(u,ns)+"";if(rs(u))return Ui?Ui.call(u):"";var f=u+"";return"0"==f&&1/u==-Sn?"-0":f}function ge(u,f,_){var S=-1,M=ng,P=u.length,U=!0,W=[],Z=W;if(_)U=!1,M=r0;else if(P>=200){var pe=f?null:hf(u);if(pe)return dc(pe);U=!1,M=Ve,Z=new Ea}else Z=f?[]:W;e:for(;++S<P;){var me=u[S],be=f?f(me):me;if(me=_||0!==me?me:0,U&&be==be){for(var Be=Z.length;Be--;)if(Z[Be]===be)continue e;f&&Z.push(be),W.push(me)}else M(Z,be,_)||(Z!==W&&Z.push(be),W.push(me))}return W}function Kt(u,f){return null==(u=Z0(u,f=_o(f,u)))||delete u[xr(Wn(f))]}function is(u,f,_,S){return rf(u,f,_(Ma(u,f)),S)}function Er(u,f,_,S){for(var M=u.length,P=S?M:-1;(S?P--:++P<M)&&f(u[P],P,u););return _?ts(u,S?0:P,S?P+1:M):ts(u,S?P+1:0,S?M:P)}function Hi(u,f){var _=u;return _ instanceof kt&&(_=_.value()),Rh(f,function(S,M){return M.func.apply(M.thisArg,co([S],M.args))},_)}function af(u,f,_){var S=u.length;if(S<2)return S?ge(u[0]):[];for(var M=-1,P=ie(S);++M<S;)for(var U=u[M],W=-1;++W<S;)W!=M&&(P[M]=$h(P[M]||U,u[W],f,_));return ge(Ii(P,1),f,_)}function wc(u,f,_){for(var S=-1,M=u.length,P=f.length,U={};++S<M;)_(U,u[S],S<P?f[S]:B);return U}function xs(u){return Jn(u)?u:[]}function qu(u){return"function"==typeof u?u:fr}function _o(u,f){return Tt(u)?u:ed(u,f)?[u]:gl(on(u))}var lM=zt;function dl(u,f,_){var S=u.length;return _=_===B?S:_,!f&&_>=S?u:ts(u,f,_)}var xg=It||function(u){return or.clearTimeout(u)};function lr(u,f){if(f)return u.slice();var _=u.length,S=sl?sl(_):new u.constructor(_);return u.copy(S),S}function Hs(u){var f=new u.constructor(u.byteLength);return new ki(f).set(new ki(u)),f}function F0(u,f){var _=f?Hs(u.buffer):u.buffer;return new u.constructor(_,u.byteOffset,u.length)}function Mg(u,f){if(u!==f){var _=u!==B,S=null===u,M=u==u,P=rs(u),U=f!==B,W=null===f,Z=f==f,pe=rs(f);if(!W&&!pe&&!P&&u>f||P&&U&&Z&&!W&&!pe||S&&U&&Z||!_&&Z||!M)return 1;if(!S&&!P&&!pe&&u<f||pe&&_&&M&&!S&&!P||W&&_&&M||!U&&M||!Z)return-1}return 0}function k0(u,f,_,S){for(var M=-1,P=u.length,U=_.length,W=-1,Z=f.length,pe=Kn(P-U,0),me=ie(Z+pe),be=!S;++W<Z;)me[W]=f[W];for(;++M<U;)(be||M<P)&&(me[_[M]]=u[M]);for(;pe--;)me[W++]=u[M++];return me}function lf(u,f,_,S){for(var M=-1,P=u.length,U=-1,W=_.length,Z=-1,pe=f.length,me=Kn(P-W,0),be=ie(me+pe),Be=!S;++M<me;)be[M]=u[M];for(var tt=M;++Z<pe;)be[tt+Z]=f[Z];for(;++U<W;)(Be||M<P)&&(be[tt+_[U]]=u[M++]);return be}function cr(u,f){var _=-1,S=u.length;for(f||(f=ie(S));++_<S;)f[_]=u[_];return f}function zs(u,f,_,S){var M=!_;_||(_={});for(var P=-1,U=f.length;++P<U;){var W=f[P],Z=S?S(_[W],u[W],W,_,u):B;Z===B&&(Z=u[W]),M?mo(_,W,Z):_c(_,W,Z)}return _}function Xu(u,f){return function(_,S){var M=Tt(_)?t0:v0,P=f?f():{};return M(_,u,ut(S,2),P)}}function Ta(u){return zt(function(f,_){var S=-1,M=_.length,P=M>1?_[M-1]:B,U=M>2?_[2]:B;for(P=u.length>3&&"function"==typeof P?(M--,P):B,U&&zi(_[0],_[1],U)&&(P=M<3?B:P,M=1),f=xn(f);++S<M;){var W=_[S];W&&u(f,W,S,P)}return f})}function Tg(u,f){return function(_,S){if(null==_)return _;if(!dr(_))return u(_,S);for(var M=_.length,P=f?M:-1,U=xn(_);(f?P--:++P<M)&&!1!==S(U[P],P,U););return _}}function Ag(u){return function(f,_,S){for(var M=-1,P=xn(f),U=S(f),W=U.length;W--;){var Z=U[u?W:++M];if(!1===_(P[Z],Z,P))break}return f}}function Dg(u){return function(f){var _=Fo(f=on(f))?Es(f):B,S=_?_[0]:f.charAt(0),M=_?dl(_,1).join(""):f.slice(1);return S[u]()+M}}function Aa(u){return function(f){return Rh(La(Fb(f).replace(hR,"")),u,"")}}function Yu(u){return function(){var f=arguments;switch(f.length){case 0:return new u;case 1:return new u(f[0]);case 2:return new u(f[0],f[1]);case 3:return new u(f[0],f[1],f[2]);case 4:return new u(f[0],f[1],f[2],f[3]);case 5:return new u(f[0],f[1],f[2],f[3],f[4]);case 6:return new u(f[0],f[1],f[2],f[3],f[4],f[5]);case 7:return new u(f[0],f[1],f[2],f[3],f[4],f[5],f[6])}var _=Di(u.prototype),S=u.apply(_,f);return jn(S)?S:_}}function ur(u){return function(f,_,S){var M=xn(f);if(!dr(f)){var P=ut(_,3);f=Gi(f),_=function(W){return P(M[W],W,M)}}var U=u(f,_,S);return U>-1?M[P?f[U]:U]:B}}function Da(u){return $o(function(f){var _=f.length,S=_,M=Rr.prototype.thru;for(u&&f.reverse();S--;){var P=f[S];if("function"!=typeof P)throw new Kr($r);if(M&&!U&&"wrapper"==pf(P))var U=new Rr([],!0)}for(S=U?S:_;++S<_;){var W=pf(P=f[S]),Z="wrapper"==W?G0(P):B;U=Z&&_f(Z[0])&&424==Z[1]&&!Z[4].length&&1==Z[9]?U[pf(Z[0])].apply(U,Z[3]):1==P.length&&_f(P)?U[W]():U.thru(P)}return function(){var pe=arguments,me=pe[0];if(U&&1==pe.length&&Tt(me))return U.plant(me).value();for(var be=0,Be=_?f[be].apply(this,pe):me;++be<_;)Be=f[be].call(this,Be);return Be}})}function Dn(u,f,_,S,M,P,U,W,Z,pe){var me=128&f,be=1&f,Be=2&f,tt=24&f,ct=512&f,Gt=Be?B:Yu(u);return function dt(){for(var Vt=arguments.length,Qt=ie(Vt),Wi=Vt;Wi--;)Qt[Wi]=arguments[Wi];if(tt)var bn=xc(dt),os=function Fu(Y,ue){for(var ie=Y.length,ke=0;ie--;)Y[ie]===ue&&++ke;return ke}(Qt,bn);if(S&&(Qt=k0(Qt,S,M,tt)),P&&(Qt=lf(Qt,P,U,tt)),Vt-=os,tt&&Vt<pe){var Fn=ho(Qt,bn);return jo(u,f,Dn,dt.placeholder,_,Qt,Fn,W,Z,pe-Vt)}var mi=be?_:this,Zo=Be?mi[u]:u;return Vt=Qt.length,W?Qt=function Sr(u,f){for(var _=u.length,S=Ji(f.length,_),M=cr(u);S--;){var P=f[S];u[S]=yo(P,_)?M[P]:B}return u}(Qt,W):ct&&Vt>1&&Qt.reverse(),me&&Z<Vt&&(Qt.length=Z),this&&this!==or&&this instanceof dt&&(Zo=Gt||Yu(Zo)),Zo.apply(mi,Qt)}}function cf(u,f){return function(_,S){return function nM(u,f,_,S){return Go(u,function(M,P,U){f(S,_(M),P,U)}),S}(_,u,f(S),{})}}function uf(u,f){return function(_,S){var M;if(_===B&&S===B)return f;if(_!==B&&(M=_),S!==B){if(M===B)return S;"string"==typeof _||"string"==typeof S?(_=ns(_),S=ns(S)):(_=L0(_),S=L0(S)),M=u(_,S)}return M}}function Ig(u){return $o(function(f){return f=Tn(f,Le(ut())),zt(function(_){var S=this;return u(f,function(M){return yr(M,S,_)})})})}function df(u,f){var _=(f=f===B?" ":ns(f)).length;if(_<2)return _?nf(f,u):f;var S=nf(f,_a(u/rl(f)));return Fo(f)?dl(Es(S),0,u).join(""):S.slice(0,u)}function Rg(u){return function(f,_,S){return S&&"number"!=typeof S&&zi(f,_,S)&&(_=S=B),f=Xo(f),_===B?(_=f,f=0):_=Xo(_),function I0(u,f,_,S){for(var M=-1,P=Kn(_a((f-u)/(_||1)),0),U=ie(P);P--;)U[S?P:++M]=u,u+=_;return U}(f,_,S=S===B?f<_?1:-1:Xo(S),u)}}function hl(u){return function(f,_){return"string"==typeof f&&"string"==typeof _||(f=Lr(f),_=Lr(_)),u(f,_)}}function jo(u,f,_,S,M,P,U,W,Z,pe){var me=8&f;f|=me?32:64,4&(f&=~(me?64:32))||(f&=-4);var Gt=[u,f,M,me?P:B,me?U:B,me?B:P,me?B:U,W,Z,pe],dt=_.apply(B,Gt);return _f(u)&&fi(dt,Gt),dt.placeholder=S,Bg(dt,u,f)}function Pg(u){var f=Ti[u];return function(_,S){if(_=Lr(_),(S=null==S?0:Ji(Bt(S),292))&&Uo(_)){var M=(on(_)+"e").split("e");return+((M=(on(f(M[0]+"e"+(+M[1]+S)))+"e").split("e"))[0]+"e"+(+M[1]-S))}return f(_)}}var hf=Jr&&1/dc(new Jr([,-0]))[1]==Sn?function(u){return new Jr(u)}:pd;function Zu(u){return function(f){var _=Ri(f);return _==ks?nn(f):_==Us?function l0(Y){var ue=-1,ie=Array(Y.size);return Y.forEach(function(ke){ie[++ue]=[ke,ke]}),ie}(f):function ga(Y,ue){return Tn(ue,function(ie){return[ie,Y[ie]]})}(f,u(f))}}function Ms(u,f,_,S,M,P,U,W){var Z=2&f;if(!Z&&"function"!=typeof u)throw new Kr($r);var pe=S?S.length:0;if(pe||(f&=-97,S=M=B),U=U===B?U:Kn(Bt(U),0),W=W===B?W:Bt(W),pe-=M?M.length:0,64&f){var me=S,be=M;S=M=B}var Be=Z?B:G0(u),tt=[u,f,_,S,M,me,be,P,U,W];if(Be&&function gM(u,f){var _=u[1],S=f[1],M=_|S;if(!(M<131)&&!(128==S&&8==_||128==S&&256==_&&u[7].length<=f[8]||384==S&&f[7].length<=f[8]&&8==_))return u;1&S&&(u[2]=f[2],M|=1&_?0:4);var W=f[3];if(W){var Z=u[3];u[3]=Z?k0(Z,W,f[4]):W,u[4]=Z?ho(u[3],el):f[4]}(W=f[5])&&(u[5]=(Z=u[5])?lf(Z,W,f[6]):W,u[6]=Z?ho(u[5],el):f[6]),(W=f[7])&&(u[7]=W),128&S&&(u[8]=null==u[8]?f[8]:Ji(u[8],f[8])),null==u[9]&&(u[9]=f[9]),u[0]=f[0],u[1]=M}(tt,Be),u=tt[0],f=tt[1],_=tt[2],S=tt[3],M=tt[4],!(W=tt[9]=tt[9]===B?Z?0:u.length:Kn(tt[9]-pe,0))&&24&f&&(f&=-25),f&&1!=f)ct=8==f||16==f?function dM(u,f,_){var S=Yu(u);return function M(){for(var P=arguments.length,U=ie(P),W=P,Z=xc(M);W--;)U[W]=arguments[W];var pe=P<3&&U[0]!==Z&&U[P-1]!==Z?[]:ho(U,Z);return(P-=pe.length)<_?jo(u,f,Dn,M.placeholder,B,U,pe,B,B,_-P):yr(this&&this!==or&&this instanceof M?S:u,this,U)}}(u,f,W):32!=f&&33!=f||M.length?Dn.apply(B,tt):function B0(u,f,_,S){var M=1&f,P=Yu(u);return function U(){for(var W=-1,Z=arguments.length,pe=-1,me=S.length,be=ie(me+Z),Be=this&&this!==or&&this instanceof U?P:u;++pe<me;)be[pe]=S[pe];for(;Z--;)be[pe++]=arguments[++W];return yr(Be,M?_:this,be)}}(u,f,_,S);else var ct=function U0(u,f,_){var S=1&f,M=Yu(u);return function P(){return(this&&this!==or&&this instanceof P?M:u).apply(S?_:this,arguments)}}(u,f,_);return Bg((Be?P0:fi)(ct,tt),u,f)}function ff(u,f,_,S){return u===B||js(u,hc[_])&&!pn.call(S,_)?f:u}function Ng(u,f,_,S,M,P){return jn(u)&&jn(f)&&(P.set(f,u),$u(u,f,B,Ng,P),P.delete(f)),u}function V0(u){return bl(u)?B:u}function H0(u,f,_,S,M,P){var U=1&_,W=u.length,Z=f.length;if(W!=Z&&!(U&&Z>W))return!1;var pe=P.get(u),me=P.get(f);if(pe&&me)return pe==f&&me==u;var be=-1,Be=!0,tt=2&_?new Ea:B;for(P.set(u,f),P.set(f,u);++be<W;){var ct=u[be],Gt=f[be];if(S)var dt=U?S(Gt,ct,be,f,u,P):S(ct,Gt,be,u,f,P);if(dt!==B){if(dt)continue;Be=!1;break}if(tt){if(!rg(f,function(Vt,Qt){if(!Ve(tt,Qt)&&(ct===Vt||M(ct,Vt,_,S,P)))return tt.push(Qt)})){Be=!1;break}}else if(ct!==Gt&&!M(ct,Gt,_,S,P)){Be=!1;break}}return P.delete(u),P.delete(f),Be}function $o(u){return Ug(Cc(u,B,Ac),u+"")}function z0(u){return vg(u,Gi,fl)}function Ju(u){return vg(u,hr,mf)}var G0=va?function(u){return va.get(u)}:pd;function pf(u){for(var f=u.name+"",_=Ft[f],S=pn.call(Ft,f)?_.length:0;S--;){var M=_[S],P=M.func;if(null==P||P==u)return M.name}return f}function xc(u){return(pn.call(I,"placeholder")?I:u).placeholder}function ut(){var u=I.iteratee||x_;return u=u===x_?Eg:u,arguments.length?u(arguments[0],arguments[1]):u}function Lg(u,f){var _=u.__data__;return function mM(u){var f=typeof u;return"string"==f||"number"==f||"symbol"==f||"boolean"==f?"__proto__"!==u:null===u}(f)?_["string"==typeof f?"string":"hash"]:_.map}function Qu(u){for(var f=Gi(u),_=f.length;_--;){var S=f[_],M=u[S];f[_]=[S,M,q0(M)]}return f}function Gs(u,f){var _=function Oo(Y,ue){return null==Y?B:Y[ue]}(u,f);return M0(_)?_:B}var fl=ya?function(u){return null==u?[]:(u=xn(u),sn(ya(u),function(f){return hg.call(u,f)}))}:Zb,mf=ya?function(u){for(var f=[];u;)co(f,fl(u)),u=ar(u);return f}:Zb,Ri=br;function Og(u,f,_){for(var S=-1,M=(f=_o(f,u)).length,P=!1;++S<M;){var U=xr(f[S]);if(!(P=null!=u&&_(u,U)))break;u=u[U]}return P||++S!=M?P:!!(M=null==u?0:u.length)&&od(M)&&yo(U,M)&&(Tt(u)||yl(u))}function Ws(u){return"function"!=typeof u.constructor||Mc(u)?{}:Di(ar(u))}function Fg(u){return Tt(u)||yl(u)||!!(p0&&u&&u[p0])}function yo(u,f){var _=typeof u;return!!(f=f??Lo)&&("number"==_||"symbol"!=_&&cR.test(u))&&u>-1&&u%1==0&&u<f}function zi(u,f,_){if(!jn(_))return!1;var S=typeof f;return!!("number"==S?dr(_)&&yo(f,_.length):"string"==S&&f in _)&&js(_[f],u)}function ed(u,f){if(Tt(u))return!1;var _=typeof u;return!("number"!=_&&"symbol"!=_&&"boolean"!=_&&null!=u&&!rs(u))||Sx.test(u)||!Vv.test(u)||null!=f&&u in xn(f)}function _f(u){var f=pf(u),_=I[f];if("function"!=typeof _||!(f in kt.prototype))return!1;if(u===_)return!0;var S=G0(_);return!!S&&u===S[0]}(Ss&&Ri(new Ss(new ArrayBuffer(1)))!=ac||Bo&&Ri(new Bo)!=ks||Vh&&Ri(Vh.resolve())!=_x||Jr&&Ri(new Jr)!=Us||Qr&&Ri(new Qr)!=oc)&&(Ri=function(u){var f=br(u),_=f==fa?u.constructor:B,S=_?Ia(_):"";if(S)switch(S){case ER:return ac;case fg:return ks;case m0:return _x;case fo:return Us;case Hh:return oc}return f});var $0=Ki?Ts:Kb;function Mc(u){var f=u&&u.constructor;return u===("function"==typeof f&&f.prototype||hc)}function q0(u){return u==u&&!jn(u)}function td(u,f){return function(_){return null!=_&&_[u]===f&&(f!==B||u in xn(_))}}function Cc(u,f,_){return f=Kn(f===B?u.length-1:f,0),function(){for(var S=arguments,M=-1,P=Kn(S.length-f,0),U=ie(P);++M<P;)U[M]=S[f+M];M=-1;for(var W=ie(f+1);++M<f;)W[M]=S[M];return W[f]=_(U),yr(u,this,W)}}function Z0(u,f){return f.length<2?u:Ma(u,ts(f,0,-1))}function kg(u,f){if(("constructor"!==f||"function"!=typeof u[f])&&"__proto__"!=f)return u[f]}var fi=nd(P0),ml=Bs||function(u,f){return or.setTimeout(u,f)},Ug=nd(oM);function Bg(u,f,_){var S=f+"";return Ug(u,function gf(u,f){var _=f.length;if(!_)return u;var S=_-1;return f[S]=(_>1?"& ":"")+f[S],f=f.join(_>2?", ":" "),u.replace(xx,"{\n/* [wrapped with "+f+"] */\n")}(S,function Vg(u,f){return On(Nv,function(_){var S="_."+_[0];f&_[1]&&!ng(u,S)&&u.push(S)}),u.sort()}(function W0(u){var f=u.match(Mx);return f?f[1].split(Cx):[]}(S),_)))}function nd(u){var f=0,_=0;return function(){var S=pc(),M=16-(S-_);if(_=S,M>0){if(++f>=800)return arguments[0]}else f=0;return u.apply(B,arguments)}}function qo(u,f){var _=-1,S=u.length,M=S-1;for(f=f===B?S:f;++_<f;){var P=tf(_,M),U=u[P];u[P]=u[_],u[_]=U}return u.length=f,u}var gl=function pl(u){var f=Rf(u,function(S){return 500===_.size&&_.clear(),S}),_=f.cache;return f}(function(u){var f=[];return 46===u.charCodeAt(0)&&f.push(""),u.replace(Hv,function(_,S,M,P){f.push(M?P.replace(Ax,"$1"):S||_)}),f});function xr(u){if("string"==typeof u||rs(u))return u;var f=u+"";return"0"==f&&1/u==-Sn?"-0":f}function Ia(u){if(null!=u){try{return Uh.call(u)}catch{}try{return u+""}catch{}}return""}function _l(u){if(u instanceof kt)return u.clone();var f=new Rr(u.__wrapped__,u.__chain__);return f.__actions__=cr(u.__actions__),f.__index__=u.__index__,f.__values__=u.__values__,f}var zR=zt(function(u,f){return Jn(u)?$h(u,Ii(f,1,Jn,!0)):[]}),GR=zt(function(u,f){var _=Wn(f);return Jn(_)&&(_=B),Jn(u)?$h(u,Ii(f,1,Jn,!0),ut(_,2)):[]}),WR=zt(function(u,f){var _=Wn(f);return Jn(_)&&(_=B),Jn(u)?$h(u,Ii(f,1,Jn,!0),B,_):[]});function pi(u,f,_){var S=null==u?0:u.length;if(!S)return-1;var M=null==_?0:Bt(_);return M<0&&(M=Kn(S+M,0)),og(u,ut(f,3),M)}function K0(u,f,_){var S=null==u?0:u.length;if(!S)return-1;var M=S-1;return _!==B&&(M=Bt(_),M=_<0?Kn(S+M,0):Ji(M,S-1)),og(u,ut(f,3),M,!0)}function Ac(u){return null!=u&&u.length?Ii(u,1):[]}function Hg(u){return u&&u.length?u[0]:B}var wM=zt(function(u){var f=Tn(u,xs);return f.length&&f[0]===u[0]?Zh(f):[]}),qR=zt(function(u){var f=Wn(u),_=Tn(u,xs);return f===Wn(_)?f=B:_.pop(),_.length&&_[0]===u[0]?Zh(_,ut(f,2)):[]}),EM=zt(function(u){var f=Wn(u),_=Tn(u,xs);return(f="function"==typeof f?f:B)&&_.pop(),_.length&&_[0]===u[0]?Zh(_,B,f):[]});function Wn(u){var f=null==u?0:u.length;return f?u[f-1]:B}var YR=zt(Gg);function Gg(u,f){return u&&u.length&&f&&f.length?ef(u,f):u}var MM=$o(function(u,f){var _=null==u?0:u.length,S=jh(u,f);return D0(u,Tn(f,function(M){return yo(M,_)?+M:M}).sort(Mg)),S});function Wg(u){return null==u?u:gc.call(u)}var Rc=zt(function(u){return ge(Ii(u,1,Jn,!0))}),rd=zt(function(u){var f=Wn(u);return Jn(f)&&(f=B),ge(Ii(u,1,Jn,!0),ut(f,2))}),NM=zt(function(u){var f=Wn(u);return f="function"==typeof f?f:B,ge(Ii(u,1,Jn,!0),B,f)});function tb(u){if(!u||!u.length)return[];var f=0;return u=sn(u,function(_){if(Jn(_))return f=Kn(_.length,f),!0}),cg(f,function(_){return Tn(u,ag(_))})}function nb(u,f){if(!u||!u.length)return[];var _=tb(u);return null==f?_:Tn(_,function(S){return yr(f,B,S)})}var OM=zt(function(u,f){return Jn(u)?$h(u,f):[]}),FM=zt(function(u){return af(sn(u,Jn))}),Sf=zt(function(u){var f=Wn(u);return Jn(f)&&(f=B),af(sn(u,Jn),ut(f,2))}),ib=zt(function(u){var f=Wn(u);return f="function"==typeof f?f:B,af(sn(u,Jn),B,f)}),kM=zt(tb),sb=zt(function(u){var f=u.length,_=f>1?u[f-1]:B;return _="function"==typeof _?(u.pop(),_):B,nb(u,_)});function UM(u){var f=I(u);return f.__chain__=!0,f}function xf(u,f){return f(u)}var qg=$o(function(u){var f=u.length,_=f?u[0]:0,S=this.__wrapped__,M=function(P){return jh(P,u)};return!(f>1||this.__actions__.length)&&S instanceof kt&&yo(_)?((S=S.slice(_,+_+(f?1:0))).__actions__.push({func:xf,args:[M],thisArg:B}),new Rr(S,this.__chain__).thru(function(P){return f&&!P.length&&P.push(B),P})):this.thru(M)}),rP=Xu(function(u,f,_){pn.call(u,_)?++u[_]:mo(u,_,1)}),Cf=ur(pi),ob=ur(K0);function Yg(u,f){return(Tt(u)?On:ul)(u,ut(f,3))}function Zg(u,f){return(Tt(u)?n0:Jx)(u,ut(f,3))}var Tf=Xu(function(u,f,_){pn.call(u,_)?u[_].push(f):mo(u,_,[f])}),Ra=zt(function(u,f,_){var S=-1,M="function"==typeof f,P=dr(u)?ie(u.length):[];return ul(u,function(U){P[++S]=M?yr(f,U,_):Kh(U,f,_)}),P}),HM=Xu(function(u,f,_){mo(u,_,f)});function Df(u,f){return(Tt(u)?Tn:ju)(u,ut(f,3))}var cb=Xu(function(u,f,_){u[_?0:1].push(f)},function(){return[[],[]]}),Jg=zt(function(u,f){if(null==u)return[];var _=f.length;return _>1&&zi(u,f[0],f[1])?f=[]:_>2&&zi(f[0],f[1],f[2])&&(f=[f[0]]),T0(u,Ii(f,1),[])}),sd=Gn||function(){return or.Date.now()};function er(u,f,_){return f=_?B:f,Ms(u,128,B,B,B,B,f=u&&null==f?u.length:f)}function Nc(u,f){var _;if("function"!=typeof f)throw new Kr($r);return u=Bt(u),function(){return--u>0&&(_=f.apply(this,arguments)),u<=1&&(f=B),_}}var If=zt(function(u,f,_){var S=1;if(_.length){var M=ho(_,xc(If));S|=32}return Ms(u,S,f,_,M)}),e_=zt(function(u,f,_){var S=3;if(_.length){var M=ho(_,xc(e_));S|=32}return Ms(f,S,u,_,M)});function hb(u,f,_){var S,M,P,U,W,Z,pe=0,me=!1,be=!1,Be=!0;if("function"!=typeof u)throw new Kr($r);function tt(Fn){var mi=S,Zo=M;return S=M=B,pe=Fn,U=u.apply(Zo,mi)}function dt(Fn){var mi=Fn-Z;return Z===B||mi>=f||mi<0||be&&Fn-pe>=P}function Vt(){var Fn=sd();if(dt(Fn))return Qt(Fn);W=ml(Vt,function Gt(Fn){var Qb=f-(Fn-Z);return be?Ji(Qb,P-(Fn-pe)):Qb}(Fn))}function Qt(Fn){return W=B,Be&&S?tt(Fn):(S=M=B,U)}function os(){var Fn=sd(),mi=dt(Fn);if(S=arguments,M=this,Z=Fn,mi){if(W===B)return function ct(Fn){return pe=Fn,W=ml(Vt,f),me?tt(Fn):U}(Z);if(be)return xg(W),W=ml(Vt,f),tt(Z)}return W===B&&(W=ml(Vt,f)),U}return f=Lr(f)||0,jn(_)&&(me=!!_.leading,P=(be="maxWait"in _)?Kn(Lr(_.maxWait)||0,f):P,Be="trailing"in _?!!_.trailing:Be),os.cancel=function Wi(){W!==B&&xg(W),pe=0,S=Z=M=W=B},os.flush=function bn(){return W===B?U:Qt(sd())},os}var fb=zt(function(u,f){return gg(u,1,f)}),XM=zt(function(u,f,_){return gg(u,Lr(f)||0,_)});function Rf(u,f){if("function"!=typeof u||null!=f&&"function"!=typeof f)throw new Kr($r);var _=function(){var S=arguments,M=f?f.apply(this,S):S[0],P=_.cache;if(P.has(M))return P.get(M);var U=u.apply(this,S);return _.cache=P.set(M,U)||P,U};return _.cache=new(Rf.Cache||wa),_}function Pf(u){if("function"!=typeof u)throw new Kr($r);return function(){var f=arguments;switch(f.length){case 0:return!u.call(this);case 1:return!u.call(this,f[0]);case 2:return!u.call(this,f[0],f[1]);case 3:return!u.call(this,f[0],f[1],f[2])}return!u.apply(this,f)}}Rf.Cache=wa;var i_=lM(function(u,f){var _=(f=1==f.length&&Tt(f[0])?Tn(f[0],Le(ut())):Tn(Ii(f,1),Le(ut()))).length;return zt(function(S){for(var M=-1,P=Ji(S.length,_);++M<P;)S[M]=f[M].call(this,S[M]);return yr(u,this,S)})}),r_=zt(function(u,f){var _=ho(f,xc(r_));return Ms(u,32,B,f,_)}),Lc=zt(function(u,f){var _=ho(f,xc(Lc));return Ms(u,64,B,f,_)}),YM=$o(function(u,f){return Ms(u,256,B,B,B,f)});function js(u,f){return u===f||u!=u&&f!=f}var QM=hl(bg),eC=hl(function(u,f){return u>=f}),yl=E0(function(){return arguments}())?E0:function(u){return Qn(u)&&pn.call(u,"callee")&&!hg.call(u,"callee")},Tt=ie.isArray,Of=Iu?Le(Iu):function Vi(u){return Qn(u)&&br(u)==Cu};function dr(u){return null!=u&&od(u.length)&&!Ts(u)}function Jn(u){return Qn(u)&&dr(u)}var Pa=li||Kb,o_=Ru?Le(Ru):function S0(u){return Qn(u)&&br(u)==tl};function a_(u){if(!Qn(u))return!1;var f=br(u);return f==rc||"[object DOMException]"==f||"string"==typeof u.message&&"string"==typeof u.name&&!bl(u)}function Ts(u){if(!jn(u))return!1;var f=br(u);return f==yh||f==Lv||"[object AsyncFunction]"==f||"[object Proxy]"==f}function Eb(u){return"number"==typeof u&&u==Bt(u)}function od(u){return"number"==typeof u&&u>-1&&u%1==0&&u<=Lo}function jn(u){var f=typeof u;return null!=u&&("object"==f||"function"==f)}function Qn(u){return null!=u&&"object"==typeof u}var Ff=Ih?Le(Ih):function x0(u){return Qn(u)&&Ri(u)==ks};function c_(u){return"number"==typeof u||Qn(u)&&br(u)==vh}function bl(u){if(!Qn(u)||br(u)!=fa)return!1;var f=ar(u);if(null===f)return!0;var _=pn.call(f,"constructor")&&f.constructor;return"function"==typeof _&&_ instanceof _&&Uh.call(_)==f0}var wl=tg?Le(tg):function wg(u){return Qn(u)&&br(u)==sc},u_=e0?Le(e0):function rM(u){return Qn(u)&&Ri(u)==Us};function Bf(u){return"string"==typeof u||!Tt(u)&&Qn(u)&&br(u)==nl}function rs(u){return"symbol"==typeof u||Qn(u)&&br(u)==bh}var Fc=jt?Le(jt):function go(u){return Qn(u)&&od(u.length)&&!!Nn[br(u)]},d_=hl(Wu),kc=hl(function(u,f){return u<=f});function Tb(u){if(!u)return[];if(dr(u))return Bf(u)?Es(u):cr(u);if(Vu&&u[Vu])return function uo(Y){for(var ue,ie=[];!(ue=Y.next()).done;)ie.push(ue.value);return ie}(u[Vu]());var f=Ri(u);return(f==ks?nn:f==Us?dc:El)(u)}function Xo(u){return u?(u=Lr(u))===Sn||u===-Sn?17976931348623157e292*(u<0?-1:1):u==u?u:0:0===u?u:0}function Bt(u){var f=Xo(u),_=f%1;return f==f?_?f-_:f:0}function Ab(u){return u?xa(Bt(u),0,so):0}function Lr(u){if("number"==typeof u)return u;if(rs(u))return NaN;if(jn(u)){var f="function"==typeof u.valueOf?u.valueOf():u;u=jn(f)?f+"":f}if("string"!=typeof u)return 0===u?u:+u;u=a0(u);var _=Zi.test(u);return _||lo.test(u)?vR(u.slice(2),_?2:8):Ix.test(u)?NaN:+u}function Db(u){return zs(u,hr(u))}function on(u){return null==u?"":ns(u)}var h_=Ta(function(u,f){if(Mc(f)||dr(f))zs(f,Gi(f),u);else for(var _ in f)pn.call(f,_)&&_c(u,_,f[_])}),f_=Ta(function(u,f){zs(f,hr(f),u)}),ld=Ta(function(u,f,_,S){zs(f,hr(f),u,S)}),Ib=Ta(function(u,f,_,S){zs(f,Gi(f),u,S)}),Rb=$o(jh),rC=zt(function(u,f){u=xn(u);var _=-1,S=f.length,M=S>2?f[2]:B;for(M&&zi(f[0],f[1],M)&&(S=1);++_<S;)for(var P=f[_],U=hr(P),W=-1,Z=U.length;++W<Z;){var pe=U[W],me=u[pe];(me===B||js(me,hc[pe])&&!pn.call(u,pe))&&(u[pe]=P[pe])}return u}),sC=zt(function(u){return u.push(B,Ng),yr(p_,B,u)});function Pb(u,f,_){var S=null==u?B:Ma(u,f);return S===B?_:S}function Hf(u,f){return null!=u&&Og(u,f,w0)}var cC=cf(function(u,f,_){null!=f&&"function"!=typeof f.toString&&(f=Bh.call(f)),u[f]=_},fd(fr)),uC=cf(function(u,f,_){null!=f&&"function"!=typeof f.toString&&(f=Bh.call(f)),pn.call(u,f)?u[f].push(_):u[f]=[_]},ut),dC=zt(Kh);function Gi(u){return dr(u)?Hu(u):Qh(u)}function hr(u){return dr(u)?Hu(u,!0):function An(u){if(!jn(u))return function X0(u){var f=[];if(null!=u)for(var _ in xn(u))f.push(_);return f}(u);var f=Mc(u),_=[];for(var S in u)"constructor"==S&&(f||!pn.call(u,S))||_.push(S);return _}(u)}var Nb=Ta(function(u,f,_){$u(u,f,_)}),p_=Ta(function(u,f,_,S){$u(u,f,_,S)}),Lb=$o(function(u,f){var _={};if(null==u)return _;var S=!1;f=Tn(f,function(P){return P=_o(P,u),S||(S=P.length>1),P}),zs(u,Ju(u),_),S&&(_=vr(_,7,V0));for(var M=f.length;M--;)Kt(_,f[M]);return _}),dP=$o(function(u,f){return null==u?{}:function sM(u,f){return A0(u,f,function(_,S){return Hf(u,S)})}(u,f)});function hC(u,f){if(null==u)return{};var _=Tn(Ju(u),function(S){return[S]});return f=ut(f),A0(u,_,function(S,M){return f(S,M[0])})}var fC=Zu(Gi),__=Zu(hr);function El(u){return null==u?[]:Nh(u,Gi(u))}var Bc=Aa(function(u,f,_){return f=f.toLowerCase(),u+(_?Ob(f):f)});function Ob(u){return Wf(on(u).toLowerCase())}function Fb(u){return(u=on(u))&&u.replace(Rx,Gx).replace(Ux,"")}var wC=Aa(function(u,f,_){return u+(_?"-":"")+f.toLowerCase()}),EC=Aa(function(u,f,_){return u+(_?" ":"")+f.toLowerCase()}),SC=Dg("toLowerCase"),Vb=Aa(function(u,f,_){return u+(_?"_":"")+f.toLowerCase()}),v_=Aa(function(u,f,_){return u+(_?" ":"")+Wf(f)}),Wb=Aa(function(u,f,_){return u+(_?" ":"")+f.toUpperCase()}),Wf=Dg("toUpperCase");function La(u,f,_){return u=on(u),(f=_?B:f)===B?function ws(Y){return pR.test(Y)}(u)?function d0(Y){return Y.match(il)||[]}(u):function wR(Y){return Y.match(Tx)||[]}(u):u.match(f)||[]}var jb=zt(function(u,f){try{return yr(u,B,f)}catch(_){return a_(_)?_:new Ct(_)}}),S_=$o(function(u,f){return On(f,function(_){_=xr(_),mo(u,_,If(u[_],u))}),u});function fd(u){return function(){return u}}var ss=Da(),qf=Da(!0);function fr(u){return u}function x_(u){return Eg("function"==typeof u?u:vr(u,1))}var Vc=zt(function(u,f){return function(_){return Kh(_,u,f)}}),AC=zt(function(u,f){return function(_){return Kh(u,_,f)}});function M_(u,f,_){var S=Gi(f),M=Yh(f,S);null==_&&(!jn(f)||!M.length&&S.length)&&(_=f,f=u,u=this,M=Yh(f,Gi(f)));var P=!(jn(_)&&"chain"in _&&!_.chain),U=Ts(u);return On(M,function(W){var Z=f[W];u[W]=Z,U&&(u.prototype[W]=function(){var pe=this.__chain__;if(P||pe){var me=u(this.__wrapped__);return(me.__actions__=cr(this.__actions__)).push({func:Z,args:arguments,thisArg:u}),me.__chain__=pe,me}return Z.apply(u,co([this.value()],arguments))})}),u}function pd(){}var IC=Ig(Tn),qb=Ig(Hx),Oa=Ig(rg);function RC(u){return ed(u)?ag(xr(u)):function Ca(u){return function(f){return Ma(f,u)}}(u)}var Yb=Rg(),PC=Rg(!0);function Zb(){return[]}function Kb(){return!1}var D_=uf(function(u,f){return u+f},0),md=Pg("ceil"),Zf=uf(function(u,f){return u/f},1),zc=Pg("floor"),LC=uf(function(u,f){return u*f},1),Jb=Pg("round"),OC=uf(function(u,f){return u-f},0);return I.after=function Qg(u,f){if("function"!=typeof f)throw new Kr($r);return u=Bt(u),function(){if(--u<1)return f.apply(this,arguments)}},I.ary=er,I.assign=h_,I.assignIn=f_,I.assignInWith=ld,I.assignWith=Ib,I.at=Rb,I.before=Nc,I.bind=If,I.bindAll=S_,I.bindKey=e_,I.castArray=function Nf(){if(!arguments.length)return[];var u=arguments[0];return Tt(u)?u:[u]},I.chain=UM,I.chunk=function VR(u,f,_){f=(_?zi(u,f,_):f===B)?1:Kn(Bt(f),0);var S=null==u?0:u.length;if(!S||f<1)return[];for(var M=0,P=0,U=ie(_a(S/f));M<S;)U[P++]=ts(u,M,M+=f);return U},I.compact=function _M(u){for(var f=-1,_=null==u?0:u.length,S=0,M=[];++f<_;){var P=u[f];P&&(M[S++]=P)}return M},I.concat=function HR(){var u=arguments.length;if(!u)return[];for(var f=ie(u-1),_=arguments[0],S=u;S--;)f[S-1]=arguments[S];return co(Tt(_)?cr(_):[_],Ii(f,1))},I.cond=function jf(u){var f=null==u?0:u.length,_=ut();return u=f?Tn(u,function(S){if("function"!=typeof S[1])throw new Kr($r);return[_(S[0]),S[1]]}):[],zt(function(S){for(var M=-1;++M<f;){var P=u[M];if(yr(P[0],this,S))return yr(P[1],this,S)}})},I.conforms=function CC(u){return function zu(u){var f=Gi(u);return function(_){return cl(_,u,f)}}(vr(u,1))},I.constant=fd,I.countBy=rP,I.create=function iC(u,f){var _=Di(u);return null==f?_:Wh(_,f)},I.curry=function db(u,f,_){var S=Ms(u,8,B,B,B,B,B,f=_?B:f);return S.placeholder=db.placeholder,S},I.curryRight=function t_(u,f,_){var S=Ms(u,16,B,B,B,B,B,f=_?B:f);return S.placeholder=t_.placeholder,S},I.debounce=hb,I.defaults=rC,I.defaultsDeep=sC,I.defer=fb,I.delay=XM,I.difference=zR,I.differenceBy=GR,I.differenceWith=WR,I.drop=function jR(u,f,_){var S=null==u?0:u.length;return S?ts(u,(f=_||f===B?1:Bt(f))<0?0:f,S):[]},I.dropRight=function $R(u,f,_){var S=null==u?0:u.length;return S?ts(u,0,(f=S-(f=_||f===B?1:Bt(f)))<0?0:f):[]},I.dropRightWhile=function Tc(u,f){return u&&u.length?Er(u,ut(f,3),!0,!0):[]},I.dropWhile=function yM(u,f){return u&&u.length?Er(u,ut(f,3),!0):[]},I.fill=function vM(u,f,_,S){var M=null==u?0:u.length;return M?(_&&"number"!=typeof _&&zi(u,f,_)&&(_=0,S=M),function UR(u,f,_,S){var M=u.length;for((_=Bt(_))<0&&(_=-_>M?0:M+_),(S=S===B||S>M?M:Bt(S))<0&&(S+=M),S=_>S?0:Ab(S);_<S;)u[_++]=f;return u}(u,f,_,S)):[]},I.filter=function Mf(u,f){return(Tt(u)?sn:_g)(u,ut(f,3))},I.flatMap=function ab(u,f){return Ii(Df(u,f),1)},I.flatMapDeep=function lb(u,f){return Ii(Df(u,f),Sn)},I.flatMapDepth=function Pc(u,f,_){return _=_===B?1:Bt(_),Ii(Df(u,f),_)},I.flatten=Ac,I.flattenDeep=function bM(u){return null!=u&&u.length?Ii(u,Sn):[]},I.flattenDepth=function Cs(u,f){return null!=u&&u.length?Ii(u,f=f===B?1:Bt(f)):[]},I.flip=function pb(u){return Ms(u,512)},I.flow=ss,I.flowRight=qf,I.fromPairs=function Dc(u){for(var f=-1,_=null==u?0:u.length,S={};++f<_;){var M=u[f];S[M[0]]=M[1]}return S},I.functions=function aP(u){return null==u?[]:Yh(u,Gi(u))},I.functionsIn=function lP(u){return null==u?[]:Yh(u,hr(u))},I.groupBy=Tf,I.initial=function id(u){return null!=u&&u.length?ts(u,0,-1):[]},I.intersection=wM,I.intersectionBy=qR,I.intersectionWith=EM,I.invert=cC,I.invertBy=uC,I.invokeMap=Ra,I.iteratee=x_,I.keyBy=HM,I.keys=Gi,I.keysIn=hr,I.map=Df,I.mapKeys=function Yo(u,f){var _={};return f=ut(f,3),Go(u,function(S,M,P){mo(_,f(S,M,P),S)}),_},I.mapValues=function ud(u,f){var _={};return f=ut(f,3),Go(u,function(S,M,P){mo(_,M,f(S,M,P))}),_},I.matches=function TC(u){return wr(vr(u,1))},I.matchesProperty=function $b(u,f){return C0(u,vr(f,1))},I.memoize=Rf,I.merge=Nb,I.mergeWith=p_,I.method=Vc,I.methodOf=AC,I.mixin=M_,I.negate=Pf,I.nthArg=function Xf(u){return u=Bt(u),zt(function(f){return Pr(f,u)})},I.omit=Lb,I.omitBy=function uP(u,f){return hC(u,Pf(ut(f)))},I.once=function n_(u){return Nc(2,u)},I.orderBy=function zM(u,f,_,S){return null==u?[]:(Tt(f)||(f=null==f?[]:[f]),Tt(_=S?B:_)||(_=null==_?[]:[_]),T0(u,f,_))},I.over=IC,I.overArgs=i_,I.overEvery=qb,I.overSome=Oa,I.partial=r_,I.partialRight=Lc,I.partition=cb,I.pick=dP,I.pickBy=hC,I.property=RC,I.propertyOf=function Xb(u){return function(f){return null==u?B:Ma(u,f)}},I.pull=YR,I.pullAll=Gg,I.pullAllBy=function SM(u,f,_){return u&&u.length&&f&&f.length?ef(u,f,ut(_,2)):u},I.pullAllWith=function xM(u,f,_){return u&&u.length&&f&&f.length?ef(u,f,B,_):u},I.pullAt=MM,I.range=Yb,I.rangeRight=PC,I.rearg=YM,I.reject=function WM(u,f){return(Tt(u)?sn:_g)(u,Pf(ut(f,3)))},I.remove=function CM(u,f){var _=[];if(!u||!u.length)return _;var S=-1,M=[],P=u.length;for(f=ut(f,3);++S<P;){var U=u[S];f(U,S,u)&&(_.push(U),M.push(S))}return D0(u,M),_},I.rest=function ZM(u,f){if("function"!=typeof u)throw new Kr($r);return zt(u,f=f===B?f:Bt(f))},I.reverse=Wg,I.sampleSize=function ub(u,f,_){return f=(_?zi(u,f,_):f===B)?1:Bt(f),(Tt(u)?_0:R0)(u,f)},I.set=function g_(u,f,_){return null==u?u:rf(u,f,_)},I.setWith=function hP(u,f,_,S){return S="function"==typeof S?S:B,null==u?u:rf(u,f,_,S)},I.shuffle=function $M(u){return(Tt(u)?y0:aM)(u)},I.slice=function TM(u,f,_){var S=null==u?0:u.length;return S?(_&&"number"!=typeof _&&zi(u,f,_)?(f=0,_=S):(f=null==f?0:Bt(f),_=_===B?S:Bt(_)),ts(u,f,_)):[]},I.sortBy=Jg,I.sortedUniq=function IM(u){return u&&u.length?N0(u):[]},I.sortedUniqBy=function J0(u,f){return u&&u.length?N0(u,ut(f,2)):[]},I.split=function Hb(u,f,_){return _&&"number"!=typeof _&&zi(u,f,_)&&(f=_=B),(_=_===B?so:_>>>0)?(u=on(u))&&("string"==typeof f||null!=f&&!wl(f))&&!(f=ns(f))&&Fo(u)?dl(Es(u),0,_):u.split(f,_):[]},I.spread=function mb(u,f){if("function"!=typeof u)throw new Kr($r);return f=null==f?0:Kn(Bt(f),0),zt(function(_){var S=_[f],M=dl(_,0,f);return S&&co(M,S),yr(u,this,M)})},I.tail=function $g(u){var f=null==u?0:u.length;return f?ts(u,1,f):[]},I.take=function Ef(u,f,_){return u&&u.length?ts(u,0,(f=_||f===B?1:Bt(f))<0?0:f):[]},I.takeRight=function Q0(u,f,_){var S=null==u?0:u.length;return S?ts(u,(f=S-(f=_||f===B?1:Bt(f)))<0?0:f,S):[]},I.takeRightWhile=function RM(u,f){return u&&u.length?Er(u,ut(f,3),!1,!0):[]},I.takeWhile=function PM(u,f){return u&&u.length?Er(u,ut(f,3)):[]},I.tap=function BM(u,f){return f(u),u},I.throttle=function gb(u,f,_){var S=!0,M=!0;if("function"!=typeof u)throw new Kr($r);return jn(_)&&(S="leading"in _?!!_.leading:S,M="trailing"in _?!!_.trailing:M),hb(u,f,{leading:S,maxWait:f,trailing:M})},I.thru=xf,I.toArray=Tb,I.toPairs=fC,I.toPairsIn=__,I.toPath=function Hc(u){return Tt(u)?Tn(u,xr):rs(u)?[u]:cr(gl(on(u)))},I.toPlainObject=Db,I.transform=function pC(u,f,_){var S=Tt(u),M=S||Pa(u)||Fc(u);if(f=ut(f,4),null==_){var P=u&&u.constructor;_=M?S?new P:[]:jn(u)&&Ts(P)?Di(ar(u)):{}}return(M?On:Go)(u,function(U,W,Z){return f(_,U,W,Z)}),_},I.unary=function _b(u){return er(u,1)},I.union=Rc,I.unionBy=rd,I.unionWith=NM,I.uniq=function ZR(u){return u&&u.length?ge(u):[]},I.uniqBy=function eb(u,f){return u&&u.length?ge(u,ut(f,2)):[]},I.uniqWith=function LM(u,f){return f="function"==typeof f?f:B,u&&u.length?ge(u,B,f):[]},I.unset=function mC(u,f){return null==u||Kt(u,f)},I.unzip=tb,I.unzipWith=nb,I.update=function gC(u,f,_){return null==u?u:is(u,f,qu(_))},I.updateWith=function _C(u,f,_,S){return S="function"==typeof S?S:B,null==u?u:is(u,f,qu(_),S)},I.values=El,I.valuesIn=function zf(u){return null==u?[]:Nh(u,hr(u))},I.without=OM,I.words=La,I.wrap=function Oc(u,f){return r_(qu(f),u)},I.xor=FM,I.xorBy=Sf,I.xorWith=ib,I.zip=kM,I.zipObject=function rb(u,f){return wc(u||[],f||[],_c)},I.zipObjectDeep=function KR(u,f){return wc(u||[],f||[],rf)},I.zipWith=sb,I.entries=fC,I.entriesIn=__,I.extend=f_,I.extendWith=ld,M_(I,I),I.add=D_,I.attempt=jb,I.camelCase=Bc,I.capitalize=Ob,I.ceil=md,I.clamp=function yC(u,f,_){return _===B&&(_=f,f=B),_!==B&&(_=(_=Lr(_))==_?_:0),f!==B&&(f=(f=Lr(f))==f?f:0),xa(Lr(u),f,_)},I.clone=function yb(u){return vr(u,4)},I.cloneDeep=function Lf(u){return vr(u,5)},I.cloneDeepWith=function KM(u,f){return vr(u,5,f="function"==typeof f?f:B)},I.cloneWith=function s_(u,f){return vr(u,4,f="function"==typeof f?f:B)},I.conformsTo=function JM(u,f){return null==f||cl(u,f,Gi(f))},I.deburr=Fb,I.defaultTo=function $f(u,f){return null==u||u!=u?f:u},I.divide=Zf,I.endsWith=function kb(u,f,_){u=on(u),f=ns(f);var S=u.length,M=_=_===B?S:xa(Bt(_),0,S);return(_-=f.length)>=0&&u.slice(_,M)==f},I.eq=js,I.escape=function Ub(u){return(u=on(u))&&kv.test(u)?u.replace(Fv,Wx):u},I.escapeRegExp=function bC(u){return(u=on(u))&&zv.test(u)?u.replace(Sh,"\\$&"):u},I.every=function VM(u,f,_){var S=Tt(u)?Hx:Qx;return _&&zi(u,f,_)&&(f=B),S(u,ut(f,3))},I.find=Cf,I.findIndex=pi,I.findKey=function oC(u,f){return zx(u,ut(f,3),Go)},I.findLast=ob,I.findLastIndex=K0,I.findLastKey=function aC(u,f){return zx(u,ut(f,3),b0)},I.floor=zc,I.forEach=Yg,I.forEachRight=Zg,I.forIn=function Na(u,f){return null==u?u:yg(u,ut(f,3),hr)},I.forInRight=function cd(u,f){return null==u?u:Xh(u,ut(f,3),hr)},I.forOwn=function lC(u,f){return u&&Go(u,ut(f,3))},I.forOwnRight=function oP(u,f){return u&&b0(u,ut(f,3))},I.get=Pb,I.gt=QM,I.gte=eC,I.has=function cP(u,f){return null!=u&&Og(u,f,eM)},I.hasIn=Hf,I.head=Hg,I.identity=fr,I.includes=function Af(u,f,_,S){u=dr(u)?u:El(u),_=_&&!S?Bt(_):0;var M=u.length;return _<0&&(_=Kn(M+_,0)),Bf(u)?_<=M&&u.indexOf(f,_)>-1:!!M&&Pu(u,f,_)>-1},I.indexOf=function yf(u,f,_){var S=null==u?0:u.length;if(!S)return-1;var M=null==_?0:Bt(_);return M<0&&(M=Kn(S+M,0)),Pu(u,f,M)},I.inRange=function y_(u,f,_){return f=Xo(f),_===B?(_=f,f=0):_=Xo(_),function tM(u,f,_){return u>=Ji(f,_)&&u<Kn(f,_)}(u=Lr(u),f,_)},I.invoke=dC,I.isArguments=yl,I.isArray=Tt,I.isArrayBuffer=Of,I.isArrayLike=dr,I.isArrayLikeObject=Jn,I.isBoolean=function tC(u){return!0===u||!1===u||Qn(u)&&br(u)==Jt},I.isBuffer=Pa,I.isDate=o_,I.isElement=function vb(u){return Qn(u)&&1===u.nodeType&&!bl(u)},I.isEmpty=function vl(u){if(null==u)return!0;if(dr(u)&&(Tt(u)||"string"==typeof u||"function"==typeof u.splice||Pa(u)||Fc(u)||yl(u)))return!u.length;var f=Ri(u);if(f==ks||f==Us)return!u.size;if(Mc(u))return!Qh(u).length;for(var _ in u)if(pn.call(u,_))return!1;return!0},I.isEqual=function bb(u,f){return Gu(u,f)},I.isEqualWith=function wb(u,f,_){var S=(_="function"==typeof _?_:B)?_(u,f):B;return S===B?Gu(u,f,B,_):!!S},I.isError=a_,I.isFinite=function sP(u){return"number"==typeof u&&Uo(u)},I.isFunction=Ts,I.isInteger=Eb,I.isLength=od,I.isMap=Ff,I.isMatch=function Sb(u,f){return u===f||Jh(u,f,Qu(f))},I.isMatchWith=function kf(u,f,_){return _="function"==typeof _?_:B,Jh(u,f,Qu(f),_)},I.isNaN=function ad(u){return c_(u)&&u!=+u},I.isNative=function xb(u){if($0(u))throw new Ct("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return M0(u)},I.isNil=function Uf(u){return null==u},I.isNull=function l_(u){return null===u},I.isNumber=c_,I.isObject=jn,I.isObjectLike=Qn,I.isPlainObject=bl,I.isRegExp=wl,I.isSafeInteger=function nC(u){return Eb(u)&&u>=-Lo&&u<=Lo},I.isSet=u_,I.isString=Bf,I.isSymbol=rs,I.isTypedArray=Fc,I.isUndefined=function Mb(u){return u===B},I.isWeakMap=function Cb(u){return Qn(u)&&Ri(u)==oc},I.isWeakSet=function Vf(u){return Qn(u)&&"[object WeakSet]"==br(u)},I.join=function XR(u,f){return null==u?"":fc.call(u,f)},I.kebabCase=wC,I.last=Wn,I.lastIndexOf=function zg(u,f,_){var S=null==u?0:u.length;if(!S)return-1;var M=S;return _!==B&&(M=(M=Bt(_))<0?Kn(S+M,0):Ji(M,S-1)),f==f?function Uu(Y,ue,ie){for(var ke=ie+1;ke--;)if(Y[ke]===ue)return ke;return ke}(u,f,M):og(u,Ph,M,!0)},I.lowerCase=EC,I.lowerFirst=SC,I.lt=d_,I.lte=kc,I.max=function I_(u){return u&&u.length?qh(u,fr,bg):B},I.maxBy=function R_(u,f){return u&&u.length?qh(u,ut(f,2),bg):B},I.mean=function Kf(u){return Lu(u,fr)},I.meanBy=function gP(u,f){return Lu(u,ut(f,2))},I.min=function P_(u){return u&&u.length?qh(u,fr,Wu):B},I.minBy=function gd(u,f){return u&&u.length?qh(u,ut(f,2),Wu):B},I.stubArray=Zb,I.stubFalse=Kb,I.stubObject=function Yf(){return{}},I.stubString=function NC(){return""},I.stubTrue=function C_(){return!0},I.multiply=LC,I.nth=function Ic(u,f){return u&&u.length?Pr(u,Bt(f)):B},I.noConflict=function DC(){return or._===this&&(or._=ft),this},I.noop=pd,I.now=sd,I.pad=function Bb(u,f,_){u=on(u);var S=(f=Bt(f))?rl(u):0;if(!f||S>=f)return u;var M=(f-S)/2;return df(Ai(M),_)+u+df(_a(M),_)},I.padEnd=function fP(u,f,_){u=on(u);var S=(f=Bt(f))?rl(u):0;return f&&S<f?u+df(f-S,_):u},I.padStart=function pP(u,f,_){u=on(u);var S=(f=Bt(f))?rl(u):0;return f&&S<f?df(f-S,_)+u:u},I.parseInt=function dd(u,f,_){return _||null==f?f=0:f&&(f=+f),ci(on(u).replace(xh,""),f||0)},I.random=function vC(u,f,_){if(_&&"boolean"!=typeof _&&zi(u,f,_)&&(f=_=B),_===B&&("boolean"==typeof f?(_=f,f=B):"boolean"==typeof u&&(_=u,u=B)),u===B&&f===B?(u=0,f=1):(u=Xo(u),f===B?(f=u,u=0):f=Xo(f)),u>f){var S=u;u=f,f=S}if(_||u%1||f%1){var M=mc();return Ji(u+M*(f-u+yR("1e-"+((M+"").length-1))),f)}return tf(u,f)},I.reduce=function Kg(u,f,_){var S=Tt(u)?Rh:s0,M=arguments.length<3;return S(u,ut(f,4),_,M,ul)},I.reduceRight=function GM(u,f,_){var S=Tt(u)?ig:s0,M=arguments.length<3;return S(u,ut(f,4),_,M,Jx)},I.repeat=function qe(u,f,_){return f=(_?zi(u,f,_):f===B)?1:Bt(f),nf(on(u),f)},I.replace=function hd(){var u=arguments,f=on(u[0]);return u.length<3?f:f.replace(u[1],u[2])},I.result=function m_(u,f,_){var S=-1,M=(f=_o(f,u)).length;for(M||(M=1,u=B);++S<M;){var P=null==u?B:u[xr(f[S])];P===B&&(S=M,P=_),u=Ts(P)?P.call(u):P}return u},I.round=Jb,I.runInContext=Y,I.sample=function jM(u){return(Tt(u)?es:gt)(u)},I.size=function qM(u){if(null==u)return 0;if(dr(u))return Bf(u)?rl(u):u.length;var f=Ri(u);return f==ks||f==Us?u.size:Qh(u).length},I.snakeCase=Vb,I.some=function Nr(u,f,_){var S=Tt(u)?rg:bc;return _&&zi(u,f,_)&&(f=B),S(u,ut(f,3))},I.sortedIndex=function jg(u,f){return sf(u,f)},I.sortedIndexBy=function vf(u,f,_){return Sg(u,f,ut(_,2))},I.sortedIndexOf=function AM(u,f){var _=null==u?0:u.length;if(_){var S=sf(u,f);if(S<_&&js(u[S],f))return S}return-1},I.sortedLastIndex=function bf(u,f){return sf(u,f,!0)},I.sortedLastIndexBy=function DM(u,f,_){return Sg(u,f,ut(_,2),!0)},I.sortedLastIndexOf=function wf(u,f){if(null!=u&&u.length){var S=sf(u,f,!0)-1;if(js(u[S],f))return S}return-1},I.startCase=v_,I.startsWith=function b_(u,f,_){return u=on(u),_=null==_?0:xa(Bt(_),0,u.length),f=ns(f),u.slice(_,_+f.length)==f},I.subtract=OC,I.sum=function FC(u){return u&&u.length?ma(u,fr):0},I.sumBy=function N_(u,f){return u&&u.length?ma(u,ut(f,2)):0},I.template=function xC(u,f,_){var S=I.templateSettings;_&&zi(u,f,_)&&(f=B),u=on(u),f=ld({},f,S,ff);var W,Z,M=ld({},f.imports,S.imports,ff),P=Gi(M),U=Nh(M,P),pe=0,me=f.interpolate||Mh,be="__p += '",Be=ug((f.escape||Mh).source+"|"+me.source+"|"+(me===Xm?Dx:Mh).source+"|"+(f.evaluate||Mh).source+"|$","g"),tt="//# sourceURL="+(pn.call(f,"sourceURL")?(f.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++gR+"]")+"\n";u.replace(Be,function(dt,Vt,Qt,Wi,bn,os){return Qt||(Qt=Wi),be+=u.slice(pe,os).replace(Ym,jx),Vt&&(W=!0,be+="' +\n__e("+Vt+") +\n'"),bn&&(Z=!0,be+="';\n"+bn+";\n__p += '"),Qt&&(be+="' +\n((__t = ("+Qt+")) == null ? '' : __t) +\n'"),pe=os+dt.length,dt}),be+="';\n";var ct=pn.call(f,"variable")&&f.variable;if(ct){if(Gv.test(ct))throw new Ct("Invalid `variable` option passed into `_.template`")}else be="with (obj) {\n"+be+"\n}\n";be=(Z?be.replace(bx,""):be).replace(wx,"$1").replace(Ex,"$1;"),be="function("+(ct||"obj")+") {\n"+(ct?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(W?", __e = _.escape":"")+(Z?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+be+"return __p\n}";var Gt=jb(function(){return ln(P,tt+"return "+be).apply(B,U)});if(Gt.source=be,a_(Gt))throw Gt;return Gt},I.times=function T_(u,f){if((u=Bt(u))<1||u>Lo)return[];var _=so,S=Ji(u,so);f=ut(f),u-=so;for(var M=cg(S,f);++_<u;)f(_);return M},I.toFinite=Xo,I.toInteger=Bt,I.toLength=Ab,I.toLower=function zb(u){return on(u).toLowerCase()},I.toNumber=Lr,I.toSafeInteger=function Uc(u){return u?xa(Bt(u),-Lo,Lo):0===u?u:0},I.toString=on,I.toUpper=function Gb(u){return on(u).toUpperCase()},I.trim=function Gf(u,f,_){if((u=on(u))&&(_||f===B))return a0(u);if(!u||!(f=ns(f)))return u;var S=Es(u),M=Es(f);return dl(S,Ou(S,M),Lh(S,M)+1).join("")},I.trimEnd=function mP(u,f,_){if((u=on(u))&&(_||f===B))return u.slice(0,Oh(u)+1);if(!u||!(f=ns(f)))return u;var S=Es(u);return dl(S,0,Lh(S,Es(f))+1).join("")},I.trimStart=function w_(u,f,_){if((u=on(u))&&(_||f===B))return u.replace(xh,"");if(!u||!(f=ns(f)))return u;var S=Es(u);return dl(S,Ou(S,Es(f))).join("")},I.truncate=function MC(u,f){var _=30,S="...";if(jn(f)){var M="separator"in f?f.separator:M;_="length"in f?Bt(f.length):_,S="omission"in f?ns(f.omission):S}var P=(u=on(u)).length;if(Fo(u)){var U=Es(u);P=U.length}if(_>=P)return u;var W=_-rl(S);if(W<1)return S;var Z=U?dl(U,0,W).join(""):u.slice(0,W);if(M===B)return Z+S;if(U&&(W+=Z.length-W),wl(M)){if(u.slice(W).search(M)){var pe,me=Z;for(M.global||(M=ug(M.source,on(ao.exec(M))+"g")),M.lastIndex=0;pe=M.exec(me);)var be=pe.index;Z=Z.slice(0,be===B?W:be)}}else if(u.indexOf(ns(M),W)!=W){var Be=Z.lastIndexOf(M);Be>-1&&(Z=Z.slice(0,Be))}return Z+S},I.unescape=function E_(u){return(u=on(u))&&lR.test(u)?u.replace(Ov,c0):u},I.uniqueId=function A_(u){var f=++Xx;return on(u)+f},I.upperCase=Wb,I.upperFirst=Wf,I.each=Yg,I.eachRight=Zg,I.first=Hg,M_(I,function(){var u={};return Go(I,function(f,_){pn.call(I.prototype,_)||(u[_]=f)}),u}(),{chain:!1}),I.VERSION="4.17.21",On(["bind","bindKey","curry","curryRight","partial","partialRight"],function(u){I[u].placeholder=I}),On(["drop","take"],function(u,f){kt.prototype[u]=function(_){_=_===B?1:Kn(Bt(_),0);var S=this.__filtered__&&!f?new kt(this):this.clone();return S.__filtered__?S.__takeCount__=Ji(_,S.__takeCount__):S.__views__.push({size:Ji(_,so),type:u+(S.__dir__<0?"Right":"")}),S},kt.prototype[u+"Right"]=function(_){return this.reverse()[u](_).reverse()}}),On(["filter","map","takeWhile"],function(u,f){var _=f+1,S=1==_||3==_;kt.prototype[u]=function(M){var P=this.clone();return P.__iteratees__.push({iteratee:ut(M,3),type:_}),P.__filtered__=P.__filtered__||S,P}}),On(["head","last"],function(u,f){var _="take"+(f?"Right":"");kt.prototype[u]=function(){return this[_](1).value()[0]}}),On(["initial","tail"],function(u,f){var _="drop"+(f?"":"Right");kt.prototype[u]=function(){return this.__filtered__?new kt(this):this[_](1)}}),kt.prototype.compact=function(){return this.filter(fr)},kt.prototype.find=function(u){return this.filter(u).head()},kt.prototype.findLast=function(u){return this.reverse().find(u)},kt.prototype.invokeMap=zt(function(u,f){return"function"==typeof u?new kt(this):this.map(function(_){return Kh(_,u,f)})}),kt.prototype.reject=function(u){return this.filter(Pf(ut(u)))},kt.prototype.slice=function(u,f){u=Bt(u);var _=this;return _.__filtered__&&(u>0||f<0)?new kt(_):(u<0?_=_.takeRight(-u):u&&(_=_.drop(u)),f!==B&&(_=(f=Bt(f))<0?_.dropRight(-f):_.take(f-u)),_)},kt.prototype.takeRightWhile=function(u){return this.reverse().takeWhile(u).reverse()},kt.prototype.toArray=function(){return this.take(so)},Go(kt.prototype,function(u,f){var _=/^(?:filter|find|map|reject)|While$/.test(f),S=/^(?:head|last)$/.test(f),M=I[S?"take"+("last"==f?"Right":""):f],P=S||/^find/.test(f);M&&(I.prototype[f]=function(){var U=this.__wrapped__,W=S?[1]:arguments,Z=U instanceof kt,pe=W[0],me=Z||Tt(U),be=function(Vt){var Qt=M.apply(I,co([Vt],W));return S&&Be?Qt[0]:Qt};me&&_&&"function"==typeof pe&&1!=pe.length&&(Z=me=!1);var Be=this.__chain__,ct=P&&!Be,Gt=Z&&!this.__actions__.length;if(!P&&me){U=Gt?U:new kt(this);var dt=u.apply(U,W);return dt.__actions__.push({func:xf,args:[be],thisArg:B}),new Rr(dt,Be)}return ct&&Gt?u.apply(this,W):(dt=this.thru(be),ct?S?dt.value()[0]:dt.value():dt)})}),On(["pop","push","shift","sort","splice","unshift"],function(u){var f=kh[u],_=/^(?:push|sort|unshift)$/.test(u)?"tap":"thru",S=/^(?:pop|shift)$/.test(u);I.prototype[u]=function(){var M=arguments;if(S&&!this.__chain__){var P=this.value();return f.apply(Tt(P)?P:[],M)}return this[_](function(U){return f.apply(Tt(U)?U:[],M)})}}),Go(kt.prototype,function(u,f){var _=I[f];if(_){var S=_.name+"";pn.call(Ft,S)||(Ft[S]=[]),Ft[S].push({name:f,func:_})}}),Ft[Dn(B,2).name]=[{name:"wrapper",func:B}],kt.prototype.clone=function zh(){var u=new kt(this.__wrapped__);return u.__actions__=cr(this.__actions__),u.__dir__=this.__dir__,u.__filtered__=this.__filtered__,u.__iteratees__=cr(this.__iteratees__),u.__takeCount__=this.__takeCount__,u.__views__=cr(this.__views__),u},kt.prototype.reverse=function Vs(){if(this.__filtered__){var u=new kt(this);u.__dir__=-1,u.__filtered__=!0}else(u=this.clone()).__dir__*=-1;return u},kt.prototype.value=function pg(){var u=this.__wrapped__.value(),f=this.__dir__,_=Tt(u),S=f<0,M=_?u.length:0,P=function BR(u,f,_){for(var S=-1,M=_.length;++S<M;){var P=_[S],U=P.size;switch(P.type){case"drop":u+=U;break;case"dropRight":f-=U;break;case"take":f=Ji(f,u+U);break;case"takeRight":u=Kn(u,f-U)}}return{start:u,end:f}}(0,M,this.__views__),U=P.start,W=P.end,Z=W-U,pe=S?W:U-1,me=this.__iteratees__,be=me.length,Be=0,tt=Ji(Z,this.__takeCount__);if(!_||!S&&M==Z&&tt==Z)return Hi(u,this.__actions__);var ct=[];e:for(;Z--&&Be<tt;){for(var Gt=-1,dt=u[pe+=f];++Gt<be;){var Vt=me[Gt],Wi=Vt.type,bn=(0,Vt.iteratee)(dt);if(2==Wi)dt=bn;else if(!bn){if(1==Wi)continue e;break e}}ct[Be++]=dt}return ct},I.prototype.at=qg,I.prototype.chain=function JR(){return UM(this)},I.prototype.commit=function QR(){return new Rr(this.value(),this.__chain__)},I.prototype.next=function Xg(){this.__values__===B&&(this.__values__=Tb(this.value()));var u=this.__index__>=this.__values__.length;return{done:u,value:u?B:this.__values__[this.__index__++]}},I.prototype.plant=function tP(u){for(var f,_=this;_ instanceof Bi;){var S=_l(_);S.__index__=0,S.__values__=B,f?M.__wrapped__=S:f=S;var M=S;_=_.__wrapped__}return M.__wrapped__=u,f},I.prototype.reverse=function nP(){var u=this.__wrapped__;if(u instanceof kt){var f=u;return this.__actions__.length&&(f=new kt(this)),(f=f.reverse()).__actions__.push({func:xf,args:[Wg],thisArg:B}),new Rr(f,this.__chain__)}return this.thru(Wg)},I.prototype.toJSON=I.prototype.valueOf=I.prototype.value=function iP(){return Hi(this.__wrapped__,this.__actions__)},I.prototype.first=I.prototype.head,Vu&&(I.prototype[Vu]=function eP(){return this}),I}();or._=Fh,(hn=function(){return Fh}.call(ec,fh,ec,Fs))!==B&&(Fs.exports=hn)}.call(this)},147:Fs=>{"use strict";Fs.exports={i8:"0.0.17"}}},Fs=>{Fs(Fs.s=262)}]);