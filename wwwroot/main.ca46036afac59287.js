"use strict";(self.webpackChunkmgx=self.webpackChunkmgx||[]).push([[179],{846:()=>{function Rt(n){return"function"==typeof n}function Tc(n){const t=n(i=>{Error.call(i),i.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const qd=Tc(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function Ac(n,e){if(n){const t=n.indexOf(e);0<=t&&n.splice(t,1)}}class Pi{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:i}=this;if(Rt(i))try{i()}catch(s){e=s instanceof qd?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{sS(s)}catch(o){e=e??[],o instanceof qd?e=[...e,...o.errors]:e.push(o)}}if(e)throw new qd(e)}}add(e){var t;if(e&&e!==this)if(this.closed)sS(e);else{if(e instanceof Pi){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Ac(t,e)}remove(e){const{_finalizers:t}=this;t&&Ac(t,e),e instanceof Pi&&e._removeParent(this)}}Pi.EMPTY=(()=>{const n=new Pi;return n.closed=!0,n})();const iS=Pi.EMPTY;function rS(n){return n instanceof Pi||n&&"closed"in n&&Rt(n.remove)&&Rt(n.add)&&Rt(n.unsubscribe)}function sS(n){Rt(n)?n():n.unsubscribe()}const xo={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Xd={setTimeout(n,e,...t){const{delegate:i}=Xd;return i?.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){const{delegate:e}=Xd;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function oS(n){Xd.setTimeout(()=>{const{onUnhandledError:e}=xo;if(!e)throw n;e(n)})}function lg(){}const eF=cg("C",void 0,void 0);function cg(n,e,t){return{kind:n,value:e,error:t}}let Co=null;function Yd(n){if(xo.useDeprecatedSynchronousErrorHandling){const e=!Co;if(e&&(Co={errorThrown:!1,error:null}),n(),e){const{errorThrown:t,error:i}=Co;if(Co=null,t)throw i}}else n()}class ug extends Pi{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,rS(e)&&e.add(this)):this.destination=aF}static create(e,t,i){return new Dc(e,t,i)}next(e){this.isStopped?hg(function nF(n){return cg("N",n,void 0)}(e),this):this._next(e)}error(e){this.isStopped?hg(function tF(n){return cg("E",void 0,n)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?hg(eF,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const rF=Function.prototype.bind;function dg(n,e){return rF.call(n,e)}class sF{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){Zd(i)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){Zd(i)}else Zd(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Zd(t)}}}class Dc extends ug{constructor(e,t,i){let r;if(super(),Rt(e)||!e)r={next:e??void 0,error:t??void 0,complete:i??void 0};else{let s;this&&xo.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&dg(e.next,s),error:e.error&&dg(e.error,s),complete:e.complete&&dg(e.complete,s)}):r=e}this.destination=new sF(r)}}function Zd(n){xo.useDeprecatedSynchronousErrorHandling?function iF(n){xo.useDeprecatedSynchronousErrorHandling&&Co&&(Co.errorThrown=!0,Co.error=n)}(n):oS(n)}function hg(n,e){const{onStoppedNotification:t}=xo;t&&Xd.setTimeout(()=>t(n,e))}const aF={closed:!0,next:lg,error:function oF(n){throw n},complete:lg},fg="function"==typeof Symbol&&Symbol.observable||"@@observable";function Os(n){return n}function aS(n){return 0===n.length?Os:1===n.length?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}let ln=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){const i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){const s=function uF(n){return n&&n instanceof ug||function cF(n){return n&&Rt(n.next)&&Rt(n.error)&&Rt(n.complete)}(n)&&rS(n)}(t)?t:new Dc(t,i,r);return Yd(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return new(i=lS(i))((r,s)=>{const o=new Dc({next:a=>{try{t(a)}catch(l){s(l),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(t){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(t)}[fg](){return this}pipe(...t){return aS(t)(this)}toPromise(t){return new(t=lS(t))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return n.create=e=>new n(e),n})();function lS(n){var e;return null!==(e=n??xo.Promise)&&void 0!==e?e:Promise}const dF=Tc(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Qi=(()=>{class n extends ln{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const i=new cS(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new dF}next(t){Yd(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(t)}})}error(t){Yd(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){Yd(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:i,isStopped:r,observers:s}=this;return i||r?iS:(this.currentObservers=null,s.push(t),new Pi(()=>{this.currentObservers=null,Ac(s,t)}))}_checkFinalizedStatuses(t){const{hasError:i,thrownError:r,isStopped:s}=this;i?t.error(r):s&&t.complete()}asObservable(){const t=new ln;return t.source=this,t}}return n.create=(e,t)=>new cS(e,t),n})();class cS extends Qi{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===i||i.call(t,e)}error(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===i||i.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,i;return null!==(i=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==i?i:iS}}function uS(n){return Rt(n?.lift)}function wn(n){return e=>{if(uS(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function mn(n,e,t,i,r){return new hF(n,e,t,i,r)}class hF extends ug{constructor(e,t,i,r,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(l){e.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function St(n,e){return wn((t,i)=>{let r=0;t.subscribe(mn(i,s=>{i.next(n.call(e,s,r++))}))})}function Fs(n){return this instanceof Fs?(this.v=n,this):new Fs(n)}function pS(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=n[Symbol.asyncIterator];return e?e.call(n):(n=function yg(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(o){return new Promise(function(a,l){!function r(s,o,a,l){Promise.resolve(l).then(function(c){s({value:c,done:a})},o)}(a,l,(o=n[s](o)).done,o.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const mS=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function gS(n){return Rt(n?.then)}function yS(n){return Rt(n[fg])}function _S(n){return Symbol.asyncIterator&&Rt(n?.[Symbol.asyncIterator])}function vS(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const ES=function LF(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function bS(n){return Rt(n?.[ES])}function SS(n){return function fS(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=t.apply(n,e||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(h){i[h]&&(r[h]=function(f){return new Promise(function(p,y){s.push([h,f,p,y])>1||a(h,f)})})}function a(h,f){try{!function l(h){h.value instanceof Fs?Promise.resolve(h.value.v).then(c,u):d(s[0][2],h)}(i[h](f))}catch(p){d(s[0][3],p)}}function c(h){a("next",h)}function u(h){a("throw",h)}function d(h,f){h(f),s.shift(),s.length&&a(s[0][0],s[0][1])}}(this,arguments,function*(){const t=n.getReader();try{for(;;){const{value:i,done:r}=yield Fs(t.read());if(r)return yield Fs(void 0);yield yield Fs(i)}}finally{t.releaseLock()}})}function wS(n){return Rt(n?.getReader)}function Ni(n){if(n instanceof ln)return n;if(null!=n){if(yS(n))return function OF(n){return new ln(e=>{const t=n[fg]();if(Rt(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(mS(n))return function FF(n){return new ln(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}(n);if(gS(n))return function kF(n){return new ln(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,oS)})}(n);if(_S(n))return MS(n);if(bS(n))return function UF(n){return new ln(e=>{for(const t of n)if(e.next(t),e.closed)return;e.complete()})}(n);if(wS(n))return function BF(n){return MS(SS(n))}(n)}throw vS(n)}function MS(n){return new ln(e=>{(function VF(n,e){var t,i,r,s;return function dS(n,e,t,i){return new(t||(t=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(d){o(d)}}function l(u){try{c(i.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):function r(s){return s instanceof t?s:new t(function(o){o(s)})}(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=pS(n);!(i=yield t.next()).done;)if(e.next(i.value),e.closed)return}catch(o){r={error:o}}finally{try{i&&!i.done&&(s=t.return)&&(yield s.call(t))}finally{if(r)throw r.error}}e.complete()})})(n,e).catch(t=>e.error(t))})}function Qr(n,e,t,i=0,r=!1){const s=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(s),!r)return s}function kn(n,e,t=1/0){return Rt(e)?kn((i,r)=>St((s,o)=>e(i,s,r,o))(Ni(n(i,r))),t):("number"==typeof e&&(t=e),wn((i,r)=>function HF(n,e,t,i,r,s,o,a){const l=[];let c=0,u=0,d=!1;const h=()=>{d&&!l.length&&!c&&e.complete()},f=y=>c<i?p(y):l.push(y),p=y=>{s&&e.next(y),c++;let g=!1;Ni(t(y,u++)).subscribe(mn(e,m=>{r?.(m),s?f(m):e.next(m)},()=>{g=!0},void 0,()=>{if(g)try{for(c--;l.length&&c<i;){const m=l.shift();o?Qr(e,o,()=>p(m)):p(m)}h()}catch(m){e.error(m)}}))};return n.subscribe(mn(e,f,()=>{d=!0,h()})),()=>{a?.()}}(i,r,n,t)))}function wa(n=1/0){return kn(Os,n)}const Dr=new ln(n=>n.complete());function _g(n){return n[n.length-1]}function xS(n){return Rt(_g(n))?n.pop():void 0}function Ic(n){return function GF(n){return n&&Rt(n.schedule)}(_g(n))?n.pop():void 0}function CS(n,e=0){return wn((t,i)=>{t.subscribe(mn(i,r=>Qr(i,n,()=>i.next(r),e),()=>Qr(i,n,()=>i.complete(),e),r=>Qr(i,n,()=>i.error(r),e)))})}function TS(n,e=0){return wn((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function AS(n,e){if(!n)throw new Error("Iterable cannot be null");return new ln(t=>{Qr(t,e,()=>{const i=n[Symbol.asyncIterator]();Qr(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function Mn(n,e){return e?function ZF(n,e){if(null!=n){if(yS(n))return function jF(n,e){return Ni(n).pipe(TS(e),CS(e))}(n,e);if(mS(n))return function qF(n,e){return new ln(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}(n,e);if(gS(n))return function $F(n,e){return Ni(n).pipe(TS(e),CS(e))}(n,e);if(_S(n))return AS(n,e);if(bS(n))return function XF(n,e){return new ln(t=>{let i;return Qr(t,e,()=>{i=n[ES](),Qr(t,e,()=>{let r,s;try{({value:r,done:s}=i.next())}catch(o){return void t.error(o)}s?t.complete():t.next(r)},0,!0)}),()=>Rt(i?.return)&&i.return()})}(n,e);if(wS(n))return function YF(n,e){return AS(SS(n),e)}(n,e)}throw vS(n)}(n,e):Ni(n)}class er extends Qi{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}}function je(...n){return Mn(n,Ic(n))}function DS(n={}){const{connector:e=(()=>new Qi),resetOnError:t=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=n;return s=>{let o,a,l,c=0,u=!1,d=!1;const h=()=>{a?.unsubscribe(),a=void 0},f=()=>{h(),o=l=void 0,u=d=!1},p=()=>{const y=o;f(),y?.unsubscribe()};return wn((y,g)=>{c++,!d&&!u&&h();const m=l=l??e();g.add(()=>{c--,0===c&&!d&&!u&&(a=vg(p,r))}),m.subscribe(g),!o&&c>0&&(o=new Dc({next:v=>m.next(v),error:v=>{d=!0,h(),a=vg(f,t,v),m.error(v)},complete:()=>{u=!0,h(),a=vg(f,i),m.complete()}}),Ni(y).subscribe(o))})(s)}}function vg(n,e,...t){if(!0===e)return void n();if(!1===e)return;const i=new Dc({next:()=>{i.unsubscribe(),n()}});return Ni(e(...t)).subscribe(i)}function pr(n,e){return wn((t,i)=>{let r=null,s=0,o=!1;const a=()=>o&&!r&&i.complete();t.subscribe(mn(i,l=>{r?.unsubscribe();let c=0;const u=s++;Ni(n(l,u)).subscribe(r=mn(i,d=>i.next(e?e(l,d,u,c++):d),()=>{r=null,a()}))},()=>{o=!0,a()}))})}function QF(n,e){return n===e}function At(n){for(let e in n)if(n[e]===At)return e;throw Error("Could not find renamed property on target object.")}function Kd(n,e){for(const t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function xn(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(xn).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function Eg(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const e2=At({__forward_ref__:At});function Lt(n){return n.__forward_ref__=Lt,n.toString=function(){return xn(this())},n}function Ze(n){return bg(n)?n():n}function bg(n){return"function"==typeof n&&n.hasOwnProperty(e2)&&n.__forward_ref__===Lt}function Sg(n){return n&&!!n.\u0275providers}class j extends Error{constructor(e,t){super(function Jd(n,e){return`NG0${Math.abs(n)}${e?": "+e:""}`}(e,t)),this.code=e}}function Qe(n){return"string"==typeof n?n:null==n?"":String(n)}function wg(n,e){throw new j(-201,!1)}function tr(n,e){null==n&&function $e(n,e,t,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${t} ${i} ${e} <=Actual]`))}(e,n,null,"!=")}function Pe(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Un(n){return{providers:n.providers||[],imports:n.imports||[]}}function Qd(n){return RS(n,th)||RS(n,PS)}function RS(n,e){return n.hasOwnProperty(e)?n[e]:null}function eh(n){return n&&(n.hasOwnProperty(Mg)||n.hasOwnProperty(l2))?n[Mg]:null}const th=At({\u0275prov:At}),Mg=At({\u0275inj:At}),PS=At({ngInjectableDef:At}),l2=At({ngInjectorDef:At});var ht=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(ht||{});let xg;function yi(n){const e=xg;return xg=n,e}function LS(n,e,t){const i=Qd(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&ht.Optional?null:void 0!==e?e:void wg(xn(n))}const Ft=globalThis,Rc={},Ig="__NG_DI_FLAG__",nh="ngTempTokenPath",d2=/\n/gm,FS="__source";let Ma;function ks(n){const e=Ma;return Ma=n,e}function p2(n,e=ht.Default){if(void 0===Ma)throw new j(-203,!1);return null===Ma?LS(n,void 0,e):Ma.get(n,e&ht.Optional?null:void 0,e)}function xe(n,e=ht.Default){return(function NS(){return xg}()||p2)(Ze(n),e)}function we(n,e=ht.Default){return xe(n,ih(e))}function ih(n){return typeof n>"u"||"number"==typeof n?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Rg(n){const e=[];for(let t=0;t<n.length;t++){const i=Ze(n[t]);if(Array.isArray(i)){if(0===i.length)throw new j(900,!1);let r,s=ht.Default;for(let o=0;o<i.length;o++){const a=i[o],l=m2(a);"number"==typeof l?-1===l?r=a.token:s|=l:r=a}e.push(xe(r,s))}else e.push(xe(i))}return e}function Pc(n,e){return n[Ig]=e,n.prototype[Ig]=e,n}function m2(n){return n[Ig]}function es(n){return{toString:n}.toString()}var rh=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(rh||{}),nr=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(nr||{});const Ir={},Et=[],sh=At({\u0275cmp:At}),Pg=At({\u0275dir:At}),Ng=At({\u0275pipe:At}),US=At({\u0275mod:At}),ts=At({\u0275fac:At}),Nc=At({__NG_ELEMENT_ID__:At}),BS=At({__NG_ENV_ID__:At});function VS(n,e,t){let i=n.length;for(;;){const r=n.indexOf(e,t);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const s=e.length;if(r+s===i||n.charCodeAt(r+s)<=32)return r}t=r+1}}function Lg(n,e,t){let i=0;for(;i<t.length;){const r=t[i];if("number"==typeof r){if(0!==r)break;i++;const s=t[i++],o=t[i++],a=t[i++];n.setAttribute(e,o,a,s)}else{const s=r,o=t[++i];zS(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),i++}}return i}function HS(n){return 3===n||4===n||6===n}function zS(n){return 64===n.charCodeAt(0)}function Lc(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?t=r:0===t||GS(n,t,r,null,-1===t||2===t?e[++i]:null)}}return n}function GS(n,e,t,i,r){let s=0,o=n.length;if(-1===e)o=-1;else for(;s<n.length;){const a=n[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<n.length;){const a=n[s];if("number"==typeof a)break;if(a===t){if(null===i)return void(null!==r&&(n[s+1]=r));if(i===n[s+1])return void(n[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),null!==i&&n.splice(s++,0,i),null!==r&&n.splice(s++,0,r)}const WS="ng-template";function _2(n,e,t){let i=0,r=!0;for(;i<n.length;){let s=n[i++];if("string"==typeof s&&r){const o=n[i++];if(t&&"class"===s&&-1!==VS(o.toLowerCase(),e,0))return!0}else{if(1===s){for(;i<n.length&&"string"==typeof(s=n[i++]);)if(s.toLowerCase()===e)return!0;return!1}"number"==typeof s&&(r=!1)}}return!1}function jS(n){return 4===n.type&&n.value!==WS}function v2(n,e,t){return e===(4!==n.type||t?n.value:WS)}function E2(n,e,t){let i=4;const r=n.attrs||[],s=function w2(n){for(let e=0;e<n.length;e++)if(HS(n[e]))return e;return n.length}(r);let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&i){if(i=2|1&i,""!==l&&!v2(n,l,t)||""===l&&1===e.length){if(mr(i))return!1;o=!0}}else{const c=8&i?l:e[++a];if(8&i&&null!==n.attrs){if(!_2(n.attrs,c,t)){if(mr(i))return!1;o=!0}continue}const d=b2(8&i?"class":l,r,jS(n),t);if(-1===d){if(mr(i))return!1;o=!0;continue}if(""!==c){let h;h=d>s?"":r[d+1].toLowerCase();const f=8&i?h:null;if(f&&-1!==VS(f,c,0)||2&i&&c!==h){if(mr(i))return!1;o=!0}}}}else{if(!o&&!mr(i)&&!mr(l))return!1;if(o&&mr(l))continue;o=!1,i=l|1&i}}return mr(i)||o}function mr(n){return 0==(1&n)}function b2(n,e,t,i){if(null===e)return-1;let r=0;if(i||!t){let s=!1;for(;r<e.length;){const o=e[r];if(o===n)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function M2(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const i=n[t];if("number"==typeof i)return-1;if(i===e)return t;t++}return-1}(e,n)}function $S(n,e,t=!1){for(let i=0;i<e.length;i++)if(E2(n,e[i],t))return!0;return!1}function x2(n,e){e:for(let t=0;t<e.length;t++){const i=e[t];if(n.length===i.length){for(let r=0;r<n.length;r++)if(n[r]!==i[r])continue e;return!0}}return!1}function qS(n,e){return n?":not("+e.trim()+")":e}function C2(n){let e=n[0],t=1,i=2,r="",s=!1;for(;t<n.length;){let o=n[t];if("string"==typeof o)if(2&i){const a=n[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!mr(o)&&(e+=qS(s,r),r=""),i=o,s=s||!mr(i);t++}return""!==r&&(e+=qS(s,r)),e}function Rr(n){return es(()=>{const e=YS(n),t={...e,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===rh.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||nr.Emulated,styles:n.styles||Et,_:null,schemas:n.schemas||null,tView:null,id:""};ZS(t);const i=n.dependencies;return t.directiveDefs=oh(i,!1),t.pipeDefs=oh(i,!0),t.id=function L2(n){let e=0;const t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(const r of t)e=Math.imul(31,e)+r.charCodeAt(0)<<0;return e+=2147483648,"c"+e}(t),t})}function I2(n){return _t(n)||Bn(n)}function R2(n){return null!==n}function jn(n){return es(()=>({type:n.type,bootstrap:n.bootstrap||Et,declarations:n.declarations||Et,imports:n.imports||Et,exports:n.exports||Et,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function XS(n,e){if(null==n)return Ir;const t={};for(const i in n)if(n.hasOwnProperty(i)){let r=n[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),t[r]=i,e&&(e[r]=s)}return t}function Ge(n){return es(()=>{const e=YS(n);return ZS(e),e})}function _t(n){return n[sh]||null}function Bn(n){return n[Pg]||null}function ti(n){return n[Ng]||null}function Oi(n,e){const t=n[US]||null;if(!t&&!0===e)throw new Error(`Type ${xn(n)} does not have '\u0275mod' property.`);return t}function YS(n){const e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||Ir,exportAs:n.exportAs||null,standalone:!0===n.standalone,signals:!0===n.signals,selectors:n.selectors||Et,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:XS(n.inputs,e),outputs:XS(n.outputs)}}function ZS(n){n.features?.forEach(e=>e(n))}function oh(n,e){if(!n)return null;const t=e?ti:I2;return()=>("function"==typeof n?n():n).map(i=>t(i)).filter(R2)}const Qt=0,be=1,rt=2,$t=3,gr=4,Oc=5,$n=6,Ca=7,cn=8,Us=9,Ta=10,et=11,Fc=12,KS=13,Aa=14,un=15,kc=16,Da=17,Pr=18,Uc=19,JS=20,Bs=21,ns=22,Bc=23,Vc=24,ft=25,Og=1,QS=2,Nr=7,Ia=9,Vn=11;function vi(n){return Array.isArray(n)&&"object"==typeof n[Og]}function ni(n){return Array.isArray(n)&&!0===n[Og]}function Fg(n){return 0!=(4&n.flags)}function Ao(n){return n.componentOffset>-1}function lh(n){return 1==(1&n.flags)}function yr(n){return!!n.template}function kg(n){return 0!=(512&n[rt])}function Do(n,e){return n.hasOwnProperty(ts)?n[ts]:null}let Hn=null,ch=!1;function ir(n){const e=Hn;return Hn=n,e}const nw={version:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{}};function rw(n){if(!zc(n)||n.dirty){if(!n.producerMustRecompute(n)&&!aw(n))return void(n.dirty=!1);n.producerRecomputeValue(n),n.dirty=!1}}function ow(n){n.dirty=!0,function sw(n){if(void 0===n.liveConsumerNode)return;const e=ch;ch=!0;try{for(const t of n.liveConsumerNode)t.dirty||ow(t)}finally{ch=e}}(n),n.consumerMarkedDirty?.(n)}function Bg(n){return n&&(n.nextProducerIndex=0),ir(n)}function Vg(n,e){if(ir(e),n&&void 0!==n.producerNode&&void 0!==n.producerIndexOfThis&&void 0!==n.producerLastReadVersion){if(zc(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)uh(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function aw(n){Ra(n);for(let e=0;e<n.producerNode.length;e++){const t=n.producerNode[e],i=n.producerLastReadVersion[e];if(i!==t.version||(rw(t),i!==t.version))return!0}return!1}function lw(n){if(Ra(n),zc(n))for(let e=0;e<n.producerNode.length;e++)uh(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function uh(n,e){if(function uw(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}(n),Ra(n),1===n.liveConsumerNode.length)for(let i=0;i<n.producerNode.length;i++)uh(n.producerNode[i],n.producerIndexOfThis[i]);const t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){const i=n.liveConsumerIndexOfThis[e],r=n.liveConsumerNode[e];Ra(r),r.producerIndexOfThis[i]=e}}function zc(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function Ra(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}let dw=null;const mw=()=>{},q2=(()=>({...nw,consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:n=>{n.schedule(n.ref)},hasRun:!1,cleanupFn:mw}))();class X2{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function rr(){return gw}function gw(n){return n.type.prototype.ngOnChanges&&(n.setInput=Z2),Y2}function Y2(){const n=_w(this),e=n?.current;if(e){const t=n.previous;if(t===Ir)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function Z2(n,e,t,i){const r=this.declaredInputs[t],s=_w(n)||function K2(n,e){return n[yw]=e}(n,{previous:Ir,current:null}),o=s.current||(s.current={}),a=s.previous,l=a[r];o[r]=new X2(l&&l.currentValue,e,a===Ir),n[i]=e}rr.ngInherit=!0;const yw="__ngSimpleChanges__";function _w(n){return n[yw]||null}const Lr=function(n,e,t){};function kt(n){for(;Array.isArray(n);)n=n[Qt];return n}function dh(n,e){return kt(e[n])}function Ei(n,e){return kt(e[n.index])}function bw(n,e){return n.data[e]}function Fi(n,e){const t=e[n];return vi(t)?t:t[Qt]}function Hs(n,e){return null==e?null:n[e]}function Sw(n){n[Da]=0}function ik(n){1024&n[rt]||(n[rt]|=1024,Mw(n,1))}function ww(n){1024&n[rt]&&(n[rt]&=-1025,Mw(n,-1))}function Mw(n,e){let t=n[$t];if(null===t)return;t[Oc]+=e;let i=t;for(t=t[$t];null!==t&&(1===e&&1===i[Oc]||-1===e&&0===i[Oc]);)t[Oc]+=e,i=t,t=t[$t]}const qe={lFrame:Ow(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function Tw(){return qe.bindingsEnabled}function Na(){return null!==qe.skipHydrationRootTNode}function te(){return qe.lFrame.lView}function vt(){return qe.lFrame.tView}function jg(n){return qe.lFrame.contextLView=n,n[cn]}function $g(n){return qe.lFrame.contextLView=null,n}function zn(){let n=Aw();for(;null!==n&&64===n.type;)n=n.parent;return n}function Aw(){return qe.lFrame.currentTNode}function Or(n,e){const t=qe.lFrame;t.currentTNode=n,t.isParent=e}function qg(){return qe.lFrame.isParent}function Xg(){qe.lFrame.isParent=!1}function La(){return qe.lFrame.bindingIndex++}function rs(n){const e=qe.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function mk(n,e){const t=qe.lFrame;t.bindingIndex=t.bindingRootIndex=n,Yg(e)}function Yg(n){qe.lFrame.currentDirectiveIndex=n}function Pw(){return qe.lFrame.currentQueryIndex}function Kg(n){qe.lFrame.currentQueryIndex=n}function yk(n){const e=n[be];return 2===e.type?e.declTNode:1===e.type?n[$n]:null}function Nw(n,e,t){if(t&ht.SkipSelf){let r=e,s=n;for(;!(r=r.parent,null!==r||t&ht.Host||(r=yk(s),null===r||(s=s[Aa],10&r.type))););if(null===r)return!1;e=r,n=s}const i=qe.lFrame=Lw();return i.currentTNode=e,i.lView=n,!0}function Jg(n){const e=Lw(),t=n[be];qe.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function Lw(){const n=qe.lFrame,e=null===n?null:n.child;return null===e?Ow(n):e}function Ow(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function Fw(){const n=qe.lFrame;return qe.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const kw=Fw;function Qg(){const n=Fw();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function ri(){return qe.lFrame.selectedIndex}function Io(n){qe.lFrame.selectedIndex=n}function Zt(){const n=qe.lFrame;return bw(n.tView,n.selectedIndex)}function ey(){qe.lFrame.currentNamespace="svg"}let Bw=!0;function hh(){return Bw}function zs(n){Bw=n}function fh(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){const s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:u}=s;o&&(n.contentHooks??=[]).push(-t,o),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),l&&(n.viewHooks??=[]).push(-t,l),c&&((n.viewHooks??=[]).push(t,c),(n.viewCheckHooks??=[]).push(t,c)),null!=u&&(n.destroyHooks??=[]).push(t,u)}}function ph(n,e,t){Vw(n,e,3,t)}function mh(n,e,t,i){(3&n[rt])===t&&Vw(n,e,t,i)}function ty(n,e){let t=n[rt];(3&t)===e&&(t&=8191,t+=1,n[rt]=t)}function Vw(n,e,t,i){const s=i??-1,o=e.length-1;let a=0;for(let l=void 0!==i?65535&n[Da]:0;l<o;l++)if("number"==typeof e[l+1]){if(a=e[l],null!=i&&a>=i)break}else e[l]<0&&(n[Da]+=65536),(a<s||-1==s)&&(Mk(n,t,e,l),n[Da]=(4294901760&n[Da])+l+2),l++}function Hw(n,e){Lr(4,n,e);const t=ir(null);try{e.call(n)}finally{ir(t),Lr(5,n,e)}}function Mk(n,e,t,i){const r=t[i]<0,s=t[i+1],a=n[r?-t[i]:t[i]];r?n[rt]>>13<n[Da]>>16&&(3&n[rt])===e&&(n[rt]+=8192,Hw(a,s)):Hw(a,s)}const Oa=-1;class Wc{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function iy(n){return n!==Oa}function jc(n){return 32767&n}function $c(n,e){let t=function Ak(n){return n>>16}(n),i=e;for(;t>0;)i=i[Aa],t--;return i}let ry=!0;function gh(n){const e=ry;return ry=n,e}const zw=255,Gw=5;let Dk=0;const Fr={};function yh(n,e){const t=Ww(n,e);if(-1!==t)return t;const i=e[be];i.firstCreatePass&&(n.injectorIndex=e.length,sy(i.data,n),sy(e,null),sy(i.blueprint,null));const r=_h(n,e),s=n.injectorIndex;if(iy(r)){const o=jc(r),a=$c(r,e),l=a[be].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|l[o+c]}return e[s+8]=r,s}function sy(n,e){n.push(0,0,0,0,0,0,0,0,e)}function Ww(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function _h(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;null!==r;){if(i=Kw(r),null===i)return Oa;if(t++,r=r[Aa],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return Oa}function oy(n,e,t){!function Ik(n,e,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(Nc)&&(i=t[Nc]),null==i&&(i=t[Nc]=Dk++);const r=i&zw;e.data[n+(r>>Gw)]|=1<<r}(n,e,t)}function jw(n,e,t){if(t&ht.Optional||void 0!==n)return n;wg()}function $w(n,e,t,i){if(t&ht.Optional&&void 0===i&&(i=null),!(t&(ht.Self|ht.Host))){const r=n[Us],s=yi(void 0);try{return r?r.get(e,i,t&ht.Optional):LS(e,i,t&ht.Optional)}finally{yi(s)}}return jw(i,0,t)}function qw(n,e,t,i=ht.Default,r){if(null!==n){if(2048&e[rt]&&!(i&ht.Self)){const o=function Fk(n,e,t,i,r){let s=n,o=e;for(;null!==s&&null!==o&&2048&o[rt]&&!(512&o[rt]);){const a=Xw(s,o,t,i|ht.Self,Fr);if(a!==Fr)return a;let l=s.parent;if(!l){const c=o[JS];if(c){const u=c.get(t,Fr,i);if(u!==Fr)return u}l=Kw(o),o=o[Aa]}s=l}return r}(n,e,t,i,Fr);if(o!==Fr)return o}const s=Xw(n,e,t,i,Fr);if(s!==Fr)return s}return $w(e,t,i,r)}function Xw(n,e,t,i,r){const s=function Nk(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(Nc)?n[Nc]:void 0;return"number"==typeof e?e>=0?e&zw:Ok:e}(t);if("function"==typeof s){if(!Nw(e,n,i))return i&ht.Host?jw(r,0,i):$w(e,t,i,r);try{let o;if(o=s(i),null!=o||i&ht.Optional)return o;wg()}finally{kw()}}else if("number"==typeof s){let o=null,a=Ww(n,e),l=Oa,c=i&ht.Host?e[un][$n]:null;for((-1===a||i&ht.SkipSelf)&&(l=-1===a?_h(n,e):e[a+8],l!==Oa&&Zw(i,!1)?(o=e[be],a=jc(l),e=$c(l,e)):a=-1);-1!==a;){const u=e[be];if(Yw(s,a,u.data)){const d=Pk(a,e,t,o,i,c);if(d!==Fr)return d}l=e[a+8],l!==Oa&&Zw(i,e[be].data[a+8]===c)&&Yw(s,a,e)?(o=u,a=jc(l),e=$c(l,e)):a=-1}}return r}function Pk(n,e,t,i,r,s){const o=e[be],a=o.data[n+8],u=vh(a,o,t,null==i?Ao(a)&&ry:i!=o&&0!=(3&a.type),r&ht.Host&&s===a);return null!==u?Ro(e,o,u,a):Fr}function vh(n,e,t,i,r){const s=n.providerIndexes,o=e.data,a=1048575&s,l=n.directiveStart,u=s>>20,h=r?a+u:n.directiveEnd;for(let f=i?a:a+u;f<h;f++){const p=o[f];if(f<l&&t===p||f>=l&&p.type===t)return f}if(r){const f=o[l];if(f&&yr(f)&&f.type===t)return l}return null}function Ro(n,e,t,i){let r=n[t];const s=e.data;if(function xk(n){return n instanceof Wc}(r)){const o=r;o.resolving&&function t2(n,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new j(-200,`Circular dependency in DI detected for ${n}${t}`)}(function Ct(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():Qe(n)}(s[t]));const a=gh(o.canSeeViewProviders);o.resolving=!0;const c=o.injectImpl?yi(o.injectImpl):null;Nw(n,i,ht.Default);try{r=n[t]=o.factory(void 0,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&function wk(n,e,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const o=gw(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}r&&(t.preOrderHooks??=[]).push(0-n,r),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}(t,s[t],e)}finally{null!==c&&yi(c),gh(a),o.resolving=!1,kw()}}return r}function Yw(n,e,t){return!!(t[e+(n>>Gw)]&1<<n)}function Zw(n,e){return!(n&ht.Self||n&ht.Host&&e)}class si{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return qw(this._tNode,this._lView,e,ih(i),t)}}function Ok(){return new si(zn(),te())}function Cn(n){return es(()=>{const e=n.prototype.constructor,t=e[ts]||ay(e),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const s=r[ts]||ay(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function ay(n){return bg(n)?()=>{const e=ay(Ze(n));return e&&e()}:Do(n)}function Kw(n){const e=n[be],t=e.type;return 2===t?e.declTNode:1===t?n[$n]:null}const ka="__parameters__";function Ba(n,e,t){return es(()=>{const i=function ly(n){return function(...t){if(n){const i=n(...t);for(const r in i)this[r]=i[r]}}}(e);function r(...s){if(this instanceof r)return i.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(l,c,u){const d=l.hasOwnProperty(ka)?l[ka]:Object.defineProperty(l,ka,{value:[]})[ka];for(;d.length<=u;)d.push(null);return(d[u]=d[u]||[]).push(o),l}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}function Ha(n,e){n.forEach(t=>Array.isArray(t)?Ha(t,e):e(t))}function Qw(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function bh(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function Yc(n,e){const t=[];for(let i=0;i<n;i++)t.push(e);return t}function ki(n,e,t){let i=za(n,e);return i>=0?n[1|i]=t:(i=~i,function Gk(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(1===r)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;)n[r]=n[r-2],r--;n[e]=t,n[e+1]=i}}(n,i,e,t)),i}function cy(n,e){const t=za(n,e);if(t>=0)return n[1|t]}function za(n,e){return function eM(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){const s=i+(r-i>>1),o=n[s<<t];if(e===o)return s<<t;o>e?r=s:i=s+1}return~(r<<t)}(n,e,1)}const wh=Pc(Ba("Optional"),8),Mh=Pc(Ba("SkipSelf"),4);function Dh(n){return 128==(128&n.flags)}var Gs=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(Gs||{});const uU=/^>|^->|<!--|-->|--!>|<!-$/g,dU=/(<|>)/g,hU="\u200b$1\u200b";const py=new Map;let fU=0;const gy="__ngContext__";function qn(n,e){vi(e)?(n[gy]=e[Uc],function mU(n){py.set(n[Uc],n)}(e)):n[gy]=e}let yy;function _y(n,e){return yy(n,e)}function Jc(n){const e=n[$t];return ni(e)?e[$t]:e}function EM(n){return SM(n[Fc])}function bM(n){return SM(n[gr])}function SM(n){for(;null!==n&&!ni(n);)n=n[gr];return n}function ja(n,e,t,i,r){if(null!=i){let s,o=!1;ni(i)?s=i:vi(i)&&(o=!0,i=i[Qt]);const a=kt(i);0===n&&null!==t?null==r?CM(e,t,a):Po(e,t,a,r||null,!0):1===n&&null!==t?Po(e,t,a,r||null,!0):2===n?function Fh(n,e,t){const i=Lh(n,e);i&&function LU(n,e,t,i){n.removeChild(e,t,i)}(n,i,e,t)}(e,a,o):3===n&&e.destroyNode(a),null!=s&&function kU(n,e,t,i,r){const s=t[Nr];s!==kt(t)&&ja(e,n,i,s,r);for(let a=Vn;a<t.length;a++){const l=t[a];eu(l[be],l,n,e,i,s)}}(e,n,s,t,r)}}function vy(n,e){return n.createComment(function hM(n){return n.replace(uU,e=>e.replace(dU,hU))}(e))}function Ph(n,e,t){return n.createElement(e,t)}function MM(n,e){const t=n[Ia],i=t.indexOf(e);ww(e),t.splice(i,1)}function Nh(n,e){if(n.length<=Vn)return;const t=Vn+e,i=n[t];if(i){const r=i[kc];null!==r&&r!==n&&MM(r,i),e>0&&(n[t-1][gr]=i[gr]);const s=bh(n,Vn+e);!function CU(n,e){eu(n,e,e[et],2,null,null),e[Qt]=null,e[$n]=null}(i[be],i);const o=s[Pr];null!==o&&o.detachView(s[be]),i[$t]=null,i[gr]=null,i[rt]&=-129}return i}function Ey(n,e){if(!(256&e[rt])){const t=e[et];e[Bc]&&lw(e[Bc]),e[Vc]&&lw(e[Vc]),t.destroyNode&&eu(n,e,t,3,null,null),function DU(n){let e=n[Fc];if(!e)return by(n[be],n);for(;e;){let t=null;if(vi(e))t=e[Fc];else{const i=e[Vn];i&&(t=i)}if(!t){for(;e&&!e[gr]&&e!==n;)vi(e)&&by(e[be],e),e=e[$t];null===e&&(e=n),vi(e)&&by(e[be],e),t=e&&e[gr]}e=t}}(e)}}function by(n,e){if(!(256&e[rt])){e[rt]&=-129,e[rt]|=256,function NU(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let i=0;i<t.length;i+=2){const r=e[t[i]];if(!(r instanceof Wc)){const s=t[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],l=s[o+1];Lr(4,a,l);try{l.call(a)}finally{Lr(5,a,l)}}else{Lr(4,r,s);try{s.call(r)}finally{Lr(5,r,s)}}}}}(n,e),function PU(n,e){const t=n.cleanup,i=e[Ca];if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+3];o>=0?i[o]():i[-o].unsubscribe(),s+=2}else t[s].call(i[t[s+1]]);null!==i&&(e[Ca]=null);const r=e[Bs];if(null!==r){e[Bs]=null;for(let s=0;s<r.length;s++)(0,r[s])()}}(n,e),1===e[be].type&&e[et].destroy();const t=e[kc];if(null!==t&&ni(e[$t])){t!==e[$t]&&MM(t,e);const i=e[Pr];null!==i&&i.detachView(n)}!function gU(n){py.delete(n[Uc])}(e)}}function Sy(n,e,t){return function xM(n,e,t){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return t[Qt];{const{componentOffset:r}=i;if(r>-1){const{encapsulation:s}=n.data[i.directiveStart+r];if(s===nr.None||s===nr.Emulated)return null}return Ei(i,t)}}(n,e.parent,t)}function Po(n,e,t,i,r){n.insertBefore(e,t,i,r)}function CM(n,e,t){n.appendChild(e,t)}function TM(n,e,t,i,r){null!==i?Po(n,e,t,i,r):CM(n,e,t)}function Lh(n,e){return n.parentNode(e)}function AM(n,e,t){return IM(n,e,t)}let wy,Ty,IM=function DM(n,e,t){return 40&n.type?Ei(n,t):null};function Oh(n,e,t,i){const r=Sy(n,i,e),s=e[et],a=AM(i.parent||e[$n],i,e);if(null!=r)if(Array.isArray(t))for(let l=0;l<t.length;l++)TM(s,r,t[l],a,!1);else TM(s,r,t,a,!1);void 0!==wy&&wy(s,i,e,t,r)}function Qc(n,e){if(null!==e){const t=e.type;if(3&t)return Ei(e,n);if(4&t)return My(-1,n[e.index]);if(8&t){const i=e.child;if(null!==i)return Qc(n,i);{const r=n[e.index];return ni(r)?My(-1,r):kt(r)}}if(32&t)return _y(e,n)()||kt(n[e.index]);{const i=PM(n,e);return null!==i?Array.isArray(i)?i[0]:Qc(Jc(n[un]),i):Qc(n,e.next)}}return null}function PM(n,e){return null!==e?n[un][$n].projection[e.projection]:null}function My(n,e){const t=Vn+n+1;if(t<e.length){const i=e[t],r=i[be].firstChild;if(null!==r)return Qc(i,r)}return e[Nr]}function xy(n,e,t,i,r,s,o){for(;null!=t;){const a=i[t.index],l=t.type;if(o&&0===e&&(a&&qn(kt(a),i),t.flags|=2),32!=(32&t.flags))if(8&l)xy(n,e,t.child,i,r,s,!1),ja(e,n,r,a,s);else if(32&l){const c=_y(t,i);let u;for(;u=c();)ja(e,n,r,u,s);ja(e,n,r,a,s)}else 16&l?LM(n,e,i,t,r,s):ja(e,n,r,a,s);t=o?t.projectionNext:t.next}}function eu(n,e,t,i,r,s){xy(t,i,n.firstChild,e,r,s,!1)}function LM(n,e,t,i,r,s){const o=t[un],l=o[$n].projection[i.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++)ja(e,n,r,l[c],s);else{let c=l;const u=o[$t];Dh(i)&&(c.flags|=128),xy(n,e,c,u,r,s,!0)}}function OM(n,e,t){""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function FM(n,e,t){const{mergedAttrs:i,classes:r,styles:s}=t;null!==i&&Lg(n,e,i),null!==r&&OM(n,e,r),null!==s&&function BU(n,e,t){n.setAttribute(e,"style",t)}(n,e,s)}class VM{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}function Ws(n){return n instanceof VM?n.changingThisBreaksApplicationSecurity:n}class Ce{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=Pe({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const ru=new Ce("ENVIRONMENT_INITIALIZER"),ZM=new Ce("INJECTOR",-1),KM=new Ce("INJECTOR_DEF_TYPES");class Ny{get(e,t=Rc){if(t===Rc){const i=new Error(`NullInjectorError: No provider for ${xn(e)}!`);throw i.name="NullInjectorError",i}return t}}function h3(...n){return{\u0275providers:JM(0,n),\u0275fromNgModule:!0}}function JM(n,...e){const t=[],i=new Set;let r;const s=o=>{t.push(o)};return Ha(e,o=>{const a=o;Vh(a,s,[],i)&&(r||=[],r.push(a))}),void 0!==r&&QM(r,s),t}function QM(n,e){for(let t=0;t<n.length;t++){const{ngModule:i,providers:r}=n[t];Oy(r,s=>{e(s,i)})}}function Vh(n,e,t,i){if(!(n=Ze(n)))return!1;let r=null,s=eh(n);const o=!s&&_t(n);if(s||o){if(o&&!o.standalone)return!1;r=n}else{const l=n.ngModule;if(s=eh(l),!s)return!1;r=l}const a=i.has(r);if(o){if(a)return!1;if(i.add(r),o.dependencies){const l="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const c of l)Vh(c,e,t,i)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let c;i.add(r);try{Ha(s.imports,u=>{Vh(u,e,t,i)&&(c||=[],c.push(u))})}finally{}void 0!==c&&QM(c,e)}if(!a){const c=Do(r)||(()=>new r);e({provide:r,useFactory:c,deps:Et},r),e({provide:KM,useValue:r,multi:!0},r),e({provide:ru,useValue:()=>xe(r),multi:!0},r)}const l=s.providers;if(null!=l&&!a){const c=n;Oy(l,u=>{e(u,c)})}}}return r!==n&&void 0!==n.providers}function Oy(n,e){for(let t of n)Sg(t)&&(t=t.\u0275providers),Array.isArray(t)?Oy(t,e):e(t)}const f3=At({provide:String,useValue:At});function Fy(n){return null!==n&&"object"==typeof n&&f3 in n}function No(n){return"function"==typeof n}const ky=new Ce("Set Injector scope."),Hh={},m3={};let Uy;function zh(){return void 0===Uy&&(Uy=new Ny),Uy}class Ui{}class Gh extends Ui{get destroyed(){return this._destroyed}constructor(e,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Vy(e,o=>this.processProvider(o)),this.records.set(ZM,Ya(void 0,this)),r.has("environment")&&this.records.set(Ui,Ya(void 0,this));const s=this.records.get(ky);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(KM.multi,Et,ht.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();const e=this._onDestroyHooks;this._onDestroyHooks=[];for(const t of e)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();const t=ks(this),i=yi(void 0);try{return e()}finally{ks(t),yi(i)}}get(e,t=Rc,i=ht.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(BS))return e[BS](this);i=ih(i);const s=ks(this),o=yi(void 0);try{if(!(i&ht.SkipSelf)){let l=this.records.get(e);if(void 0===l){const c=function E3(n){return"function"==typeof n||"object"==typeof n&&n instanceof Ce}(e)&&Qd(e);l=c&&this.injectableDefInScope(c)?Ya(By(e),Hh):null,this.records.set(e,l)}if(null!=l)return this.hydrate(e,l)}return(i&ht.Self?zh():this.parent).get(e,t=i&ht.Optional&&t===Rc?null:t)}catch(a){if("NullInjectorError"===a.name){if((a[nh]=a[nh]||[]).unshift(xn(e)),s)throw a;return function g2(n,e,t,i){const r=n[nh];throw e[FS]&&r.unshift(e[FS]),n.message=function y2(n,e,t,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let r=xn(e);if(Array.isArray(e))r=e.map(xn).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):xn(a)))}r=`{${s.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${n.replace(d2,"\n  ")}`}("\n"+n.message,r,t,i),n.ngTokenPath=r,n[nh]=null,n}(a,e,"R3InjectorError",this.source)}throw a}finally{yi(o),ks(s)}}resolveInjectorInitializers(){const e=ks(this),t=yi(void 0);try{const r=this.get(ru.multi,Et,ht.Self);for(const s of r)s()}finally{ks(e),yi(t)}}toString(){const e=[],t=this.records;for(const i of t.keys())e.push(xn(i));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new j(205,!1)}processProvider(e){let t=No(e=Ze(e))?e:Ze(e&&e.provide);const i=function y3(n){return Fy(n)?Ya(void 0,n.useValue):Ya(nx(n),Hh)}(e);if(No(e)||!0!==e.multi)this.records.get(t);else{let r=this.records.get(t);r||(r=Ya(void 0,Hh,!0),r.factory=()=>Rg(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,i)}hydrate(e,t){return t.value===Hh&&(t.value=m3,t.value=t.factory()),"object"==typeof t.value&&t.value&&function v3(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=Ze(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){const t=this._onDestroyHooks.indexOf(e);-1!==t&&this._onDestroyHooks.splice(t,1)}}function By(n){const e=Qd(n),t=null!==e?e.factory:Do(n);if(null!==t)return t;if(n instanceof Ce)throw new j(204,!1);if(n instanceof Function)return function g3(n){const e=n.length;if(e>0)throw Yc(e,"?"),new j(204,!1);const t=function a2(n){return n&&(n[th]||n[PS])||null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new j(204,!1)}function nx(n,e,t){let i;if(No(n)){const r=Ze(n);return Do(r)||By(r)}if(Fy(n))i=()=>Ze(n.useValue);else if(function tx(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...Rg(n.deps||[]));else if(function ex(n){return!(!n||!n.useExisting)}(n))i=()=>xe(Ze(n.useExisting));else{const r=Ze(n&&(n.useClass||n.provide));if(!function _3(n){return!!n.deps}(n))return Do(r)||By(r);i=()=>new r(...Rg(n.deps))}return i}function Ya(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function Vy(n,e){for(const t of n)Array.isArray(t)?Vy(t,e):t&&Sg(t)?Vy(t.\u0275providers,e):e(t)}const Wh=new Ce("AppId",{providedIn:"root",factory:()=>b3}),b3="ng",ix=new Ce("Platform Initializer"),js=new Ce("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),rx=new Ce("AnimationModuleType"),sx=new Ce("CSP nonce",{providedIn:"root",factory:()=>function qa(){if(void 0!==Ty)return Ty;if(typeof document<"u")return document;throw new j(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let ox=(n,e,t)=>null;function Xy(n,e,t=!1){return ox(n,e,t)}class R3{}class cx{}class N3{resolveComponentFactory(e){throw function P3(n){const e=Error(`No component factory found for ${xn(n)}.`);return e.ngComponent=n,e}(e)}}let Zh=(()=>{class n{static#e=this.NULL=new N3}return n})();function L3(){return Ja(zn(),te())}function Ja(n,e){return new Si(Ei(n,e))}let Si=(()=>{class n{constructor(t){this.nativeElement=t}static#e=this.__NG_ELEMENT_ID__=L3}return n})();function O3(n){return n instanceof Si?n.nativeElement:n}class au{}let kr=(()=>{class n{constructor(){this.destroyNode=null}static#e=this.__NG_ELEMENT_ID__=()=>function F3(){const n=te(),t=Fi(zn().index,n);return(vi(t)?t:n)[et]}()}return n})(),k3=(()=>{class n{static#e=this.\u0275prov=Pe({token:n,providedIn:"root",factory:()=>null})}return n})();class lu{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const U3=new lu("16.2.9"),Ky={};function px(n,e=null,t=null,i){const r=mx(n,e,t,i);return r.resolveInjectorInitializers(),r}function mx(n,e=null,t=null,i,r=new Set){const s=[t||Et,h3(n)];return i=i||("object"==typeof n?void 0:xn(n)),new Gh(s,e||zh(),i||null,r)}let Bi=(()=>{class n{static#e=this.THROW_IF_NOT_FOUND=Rc;static#t=this.NULL=new Ny;static create(t,i){if(Array.isArray(t))return px({name:""},i,t,"");{const r=t.name??"";return px({name:r},t.parent,t.providers,r)}}static#n=this.\u0275prov=Pe({token:n,providedIn:"any",factory:()=>xe(ZM)});static#i=this.__NG_ELEMENT_ID__=-1}return n})();function Qy(n){return n.ngOriginalError}class os{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&Qy(e);for(;t&&Qy(t);)t=Qy(t);return t||null}}function t_(n){return e=>{setTimeout(n,void 0,e)}}const Ut=class j3 extends Qi{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,i){let r=e,s=t||(()=>null),o=i;if(e&&"object"==typeof e){const l=e;r=l.next?.bind(l),s=l.error?.bind(l),o=l.complete?.bind(l)}this.__isAsync&&(s=t_(s),r&&(r=t_(r)),o&&(o=t_(o)));const a=super.subscribe({next:r,error:s,complete:o});return e instanceof Pi&&e.add(a),a}};function yx(...n){}class Dt{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Ut(!1),this.onMicrotaskEmpty=new Ut(!1),this.onStable=new Ut(!1),this.onError=new Ut(!1),typeof Zone>"u")throw new j(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&t,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function $3(){const n="function"==typeof Ft.requestAnimationFrame;let e=Ft[n?"requestAnimationFrame":"setTimeout"],t=Ft[n?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&t){const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i);const r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function Y3(n){const e=()=>{!function X3(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(Ft,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,i_(n),n.isCheckStableRunning=!0,n_(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),i_(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,r,s,o,a)=>{if(function K3(n){return!(!Array.isArray(n)||1!==n.length)&&!0===n[0].data?.__ignore_ng_zone__}(a))return t.invokeTask(r,s,o,a);try{return _x(n),t.invokeTask(r,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||n.shouldCoalesceRunChangeDetection)&&e(),vx(n)}},onInvoke:(t,i,r,s,o,a,l)=>{try{return _x(n),t.invoke(r,s,o,a,l)}finally{n.shouldCoalesceRunChangeDetection&&e(),vx(n)}},onHasTask:(t,i,r,s)=>{t.hasTask(r,s),i===r&&("microTask"==s.change?(n._hasPendingMicrotasks=s.microTask,i_(n),n_(n)):"macroTask"==s.change&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,i,r,s)=>(t.handleError(r,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Dt.isInAngularZone())throw new j(909,!1)}static assertNotInAngularZone(){if(Dt.isInAngularZone())throw new j(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,q3,yx,yx);try{return s.runTask(o,t,i)}finally{s.cancelTask(o)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const q3={};function n_(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function i_(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function _x(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function vx(n){n._nesting--,n_(n)}class Z3{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Ut,this.onMicrotaskEmpty=new Ut,this.onStable=new Ut,this.onError=new Ut}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}}const Ex=new Ce("",{providedIn:"root",factory:bx});function bx(){const n=we(Dt);let e=!0;return function KF(...n){const e=Ic(n),t=function WF(n,e){return"number"==typeof _g(n)?n.pop():e}(n,1/0),i=n;return i.length?1===i.length?Ni(i[0]):wa(t)(Mn(i,e)):Dr}(new ln(r=>{e=n.isStable&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks,n.runOutsideAngular(()=>{r.next(e),r.complete()})}),new ln(r=>{let s;n.runOutsideAngular(()=>{s=n.onStable.subscribe(()=>{Dt.assertNotInAngularZone(),queueMicrotask(()=>{!e&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks&&(e=!0,r.next(!0))})})});const o=n.onUnstable.subscribe(()=>{Dt.assertInAngularZone(),e&&(e=!1,n.runOutsideAngular(()=>{r.next(!1)}))});return()=>{s.unsubscribe(),o.unsubscribe()}}).pipe(DS()))}function as(n){return n instanceof Function?n():n}let r_=(()=>{class n{constructor(){this.renderDepth=0,this.handler=null}begin(){this.handler?.validateBegin(),this.renderDepth++}end(){this.renderDepth--,0===this.renderDepth&&this.handler?.execute()}ngOnDestroy(){this.handler?.destroy(),this.handler=null}static#e=this.\u0275prov=Pe({token:n,providedIn:"root",factory:()=>new n})}return n})();function cu(n){for(;n;){n[rt]|=64;const e=Jc(n);if(kg(n)&&!e)return n;n=e}return null}const Cx=new Ce("",{providedIn:"root",factory:()=>!1});let Jh=null;function Ix(n,e){return n[e]??Nx()}function Rx(n,e){const t=Nx();t.producerNode?.length&&(n[e]=Jh,t.lView=n,Jh=Px())}const aB={...nw,consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{cu(n.lView)},lView:null};function Px(){return Object.create(aB)}function Nx(){return Jh??=Px(),Jh}const it={};function Tt(n){Lx(vt(),te(),ri()+n,!1)}function Lx(n,e,t,i){if(!i)if(3==(3&e[rt])){const s=n.preOrderCheckHooks;null!==s&&ph(e,s,t)}else{const s=n.preOrderHooks;null!==s&&mh(e,s,0,t)}Io(t)}function ne(n,e=ht.Default){const t=te();return null===t?xe(n,e):qw(zn(),t,Ze(n),e)}function Qh(n,e,t,i,r,s,o,a,l,c,u){const d=e.blueprint.slice();return d[Qt]=r,d[rt]=140|i,(null!==c||n&&2048&n[rt])&&(d[rt]|=2048),Sw(d),d[$t]=d[Aa]=n,d[cn]=t,d[Ta]=o||n&&n[Ta],d[et]=a||n&&n[et],d[Us]=l||n&&n[Us]||null,d[$n]=s,d[Uc]=function pU(){return fU++}(),d[ns]=u,d[JS]=c,d[un]=2==e.type?n[un]:d,d}function tl(n,e,t,i,r){let s=n.data[e];if(null===s)s=function s_(n,e,t,i,r){const s=Aw(),o=qg(),l=n.data[e]=function mB(n,e,t,i,r,s){let o=e?e.injectorIndex:-1,a=0;return Na()&&(a|=128),{type:t,index:i,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,i,r);return null===n.firstChild&&(n.firstChild=l),null!==s&&(o?null==s.child&&null!==l.parent&&(s.child=l):null===s.next&&(s.next=l,l.prev=s)),l}(n,e,t,i,r),function pk(){return qe.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=t,s.value=i,s.attrs=r;const o=function Gc(){const n=qe.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return Or(s,!0),s}function uu(n,e,t,i){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function Fx(n,e,t,i,r){const s=Ix(e,Bc),o=ri(),a=2&i;try{Io(-1),a&&e.length>ft&&Lx(n,e,ft,!1),Lr(a?2:0,r);const c=a?s:null,u=Bg(c);try{null!==c&&(c.dirty=!1),t(i,r)}finally{Vg(c,u)}}finally{a&&null===e[Bc]&&Rx(e,Bc),Io(o),Lr(a?3:1,r)}}function o_(n,e,t){if(Fg(e)){const i=ir(null);try{const s=e.directiveEnd;for(let o=e.directiveStart;o<s;o++){const a=n.data[o];a.contentQueries&&a.contentQueries(1,t[o],o)}}finally{ir(i)}}}function a_(n,e,t){Tw()&&(function SB(n,e,t,i){const r=t.directiveStart,s=t.directiveEnd;Ao(t)&&function DB(n,e,t){const i=Ei(e,n),r=kx(t);let o=16;t.signals?o=4096:t.onPush&&(o=64);const a=ef(n,Qh(n,r,null,o,i,e,null,n[Ta].rendererFactory.createRenderer(i,t),null,null,null));n[e.index]=a}(e,t,n.data[r+t.componentOffset]),n.firstCreatePass||yh(t,e),qn(i,e);const o=t.initialInputs;for(let a=r;a<s;a++){const l=n.data[a],c=Ro(e,n,a,t);qn(c,e),null!==o&&IB(0,a-r,c,l,0,o),yr(l)&&(Fi(t.index,e)[cn]=Ro(e,n,a,t))}}(n,e,t,Ei(t,e)),64==(64&t.flags)&&zx(n,e,t))}function l_(n,e,t=Ei){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?t(e,n):n[o];n[r++]=a}}}function kx(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=c_(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function c_(n,e,t,i,r,s,o,a,l,c,u){const d=ft+i,h=d+r,f=function cB(n,e){const t=[];for(let i=0;i<e;i++)t.push(i<n?null:it);return t}(d,h),p="function"==typeof c?c():c;return f[be]={type:n,blueprint:f,template:t,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:p,incompleteFirstPass:!1,ssrId:u}}let Ux=n=>null;function Bx(n,e,t,i){for(let r in n)if(n.hasOwnProperty(r)){t=null===t?{}:t;const s=n[r];null===i?Vx(t,e,r,s):i.hasOwnProperty(r)&&Vx(t,e,i[r],s)}return t}function Vx(n,e,t,i){n.hasOwnProperty(t)?n[t].push(e,i):n[t]=[e,i]}function u_(n,e,t,i){if(Tw()){const r=null===i?null:{"":-1},s=function MB(n,e){const t=n.directiveRegistry;let i=null,r=null;if(t)for(let s=0;s<t.length;s++){const o=t[s];if($S(e,o.selectors,!1))if(i||(i=[]),yr(o))if(null!==o.findHostDirectiveDefs){const a=[];r=r||new Map,o.findHostDirectiveDefs(o,a,r),i.unshift(...a,o),d_(n,e,a.length)}else i.unshift(o),d_(n,e,0);else r=r||new Map,o.findHostDirectiveDefs?.(o,i,r),i.push(o)}return null===i?null:[i,r]}(n,t);let o,a;null===s?o=a=null:[o,a]=s,null!==o&&Hx(n,e,t,o,r,a),r&&function xB(n,e,t){if(e){const i=n.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new j(-301,!1);i.push(e[r],s)}}}(t,i,r)}t.mergedAttrs=Lc(t.mergedAttrs,t.attrs)}function Hx(n,e,t,i,r,s){for(let c=0;c<i.length;c++)oy(yh(t,e),n,i[c].type);!function TB(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}(t,n.data.length,i.length);for(let c=0;c<i.length;c++){const u=i[c];u.providersResolver&&u.providersResolver(u)}let o=!1,a=!1,l=uu(n,e,i.length,null);for(let c=0;c<i.length;c++){const u=i[c];t.mergedAttrs=Lc(t.mergedAttrs,u.hostAttrs),AB(n,t,e,l,u),CB(l,u,r),null!==u.contentQueries&&(t.flags|=4),(null!==u.hostBindings||null!==u.hostAttrs||0!==u.hostVars)&&(t.flags|=64);const d=u.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),l++}!function gB(n,e,t){const r=e.directiveEnd,s=n.data,o=e.attrs,a=[];let l=null,c=null;for(let u=e.directiveStart;u<r;u++){const d=s[u],h=t?t.get(d):null,p=h?h.outputs:null;l=Bx(d.inputs,u,l,h?h.inputs:null),c=Bx(d.outputs,u,c,p);const y=null===l||null===o||jS(e)?null:RB(l,u,o);a.push(y)}null!==l&&(l.hasOwnProperty("class")&&(e.flags|=8),l.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=l,e.outputs=c}(n,t,s)}function zx(n,e,t){const i=t.directiveStart,r=t.directiveEnd,s=t.index,o=function gk(){return qe.lFrame.currentDirectiveIndex}();try{Io(s);for(let a=i;a<r;a++){const l=n.data[a],c=e[a];Yg(a),(null!==l.hostBindings||0!==l.hostVars||null!==l.hostAttrs)&&wB(l,c)}}finally{Io(-1),Yg(o)}}function wB(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function d_(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function CB(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;yr(e)&&(t[""]=n)}}function AB(n,e,t,i,r){n.data[i]=r;const s=r.factory||(r.factory=Do(r.type)),o=new Wc(s,yr(r),ne);n.blueprint[i]=o,t[i]=o,function EB(n,e,t,i,r){const s=r.hostBindings;if(s){let o=n.hostBindingOpCodes;null===o&&(o=n.hostBindingOpCodes=[]);const a=~e.index;(function bB(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(o)!=a&&o.push(a),o.push(t,i,s)}}(n,e,i,uu(n,t,r.hostVars,it),r)}function Ur(n,e,t,i,r,s){const o=Ei(n,e);!function h_(n,e,t,i,r,s,o){if(null==s)n.removeAttribute(e,r,t);else{const a=null==o?Qe(s):o(s,i||"",r);n.setAttribute(e,r,a,t)}}(e[et],o,s,n.value,t,i,r)}function IB(n,e,t,i,r,s){const o=s[e];if(null!==o)for(let a=0;a<o.length;)Gx(i,t,o[a++],o[a++],o[a++])}function Gx(n,e,t,i,r){const s=ir(null);try{const o=n.inputTransforms;null!==o&&o.hasOwnProperty(i)&&(r=o[i].call(e,r)),null!==n.setInput?n.setInput(e,r,t,i):e[i]=r}finally{ir(s)}}function RB(n,e,t){let i=null,r=0;for(;r<t.length;){const s=t[r];if(0!==s)if(5!==s){if("number"==typeof s)break;if(n.hasOwnProperty(s)){null===i&&(i=[]);const o=n[s];for(let a=0;a<o.length;a+=2)if(o[a]===e){i.push(s,o[a+1],t[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function Wx(n,e,t,i){return[n,!0,!1,e,null,0,i,t,null,null,null]}function jx(n,e){const t=n.contentQueries;if(null!==t)for(let i=0;i<t.length;i+=2){const s=t[i+1];if(-1!==s){const o=n.data[s];Kg(t[i]),o.contentQueries(2,e[s],s)}}}function ef(n,e){return n[Fc]?n[KS][gr]=e:n[Fc]=e,n[KS]=e,e}function f_(n,e,t){Kg(0);const i=ir(null);try{e(n,t)}finally{ir(i)}}function $x(n){return n[Ca]||(n[Ca]=[])}function qx(n){return n.cleanup||(n.cleanup=[])}function Yx(n,e){const t=n[Us],i=t?t.get(os,null):null;i&&i.handleError(e)}function p_(n,e,t,i,r){for(let s=0;s<t.length;){const o=t[s++],a=t[s++];Gx(n.data[o],e[o],i,a,r)}}function PB(n,e){const t=Fi(e,n),i=t[be];!function NB(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}(i,t);const r=t[Qt];null!==r&&null===t[ns]&&(t[ns]=Xy(r,t[Us])),m_(i,t,t[cn])}function m_(n,e,t){Jg(e);try{const i=n.viewQuery;null!==i&&f_(1,i,t);const r=n.template;null!==r&&Fx(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&jx(n,e),n.staticViewQueries&&f_(2,n.viewQuery,t);const s=n.components;null!==s&&function LB(n,e){for(let t=0;t<e.length;t++)PB(n,e[t])}(e,s)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[rt]&=-5,Qg()}}let Zx=(()=>{class n{constructor(){this.all=new Set,this.queue=new Map}create(t,i,r){const s=typeof Zone>"u"?null:Zone.current,o=function $2(n,e,t){const i=Object.create(q2);t&&(i.consumerAllowSignalWrites=!0),i.fn=n,i.schedule=e;const r=o=>{i.cleanupFn=o};return i.ref={notify:()=>ow(i),run:()=>{if(i.dirty=!1,i.hasRun&&!aw(i))return;i.hasRun=!0;const o=Bg(i);try{i.cleanupFn(),i.cleanupFn=mw,i.fn(r)}finally{Vg(i,o)}},cleanup:()=>i.cleanupFn()},i.ref}(t,c=>{this.all.has(c)&&this.queue.set(c,s)},r);let a;this.all.add(o),o.notify();const l=()=>{o.cleanup(),a?.(),this.all.delete(o),this.queue.delete(o)};return a=i?.onDestroy(l),{destroy:l}}flush(){if(0!==this.queue.size)for(const[t,i]of this.queue)this.queue.delete(t),i?i.run(()=>t.run()):t.run()}get isQueueEmpty(){return 0===this.queue.size}static#e=this.\u0275prov=Pe({token:n,providedIn:"root",factory:()=>new n})}return n})();function tf(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?r=Eg(r,a):2==s&&(i=Eg(i,a+": "+e[++o]+";"))}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}function du(n,e,t,i,r=!1){for(;null!==t;){const s=e[t.index];null!==s&&i.push(kt(s)),ni(s)&&Kx(s,i);const o=t.type;if(8&o)du(n,e,t.child,i);else if(32&o){const a=_y(t,e);let l;for(;l=a();)i.push(l)}else if(16&o){const a=PM(e,t);if(Array.isArray(a))i.push(...a);else{const l=Jc(e[un]);du(l[be],l,a,i,!0)}}t=r?t.projectionNext:t.next}return i}function Kx(n,e){for(let t=Vn;t<n.length;t++){const i=n[t],r=i[be].firstChild;null!==r&&du(i[be],i,r,e)}n[Nr]!==n[Qt]&&e.push(n[Nr])}function nf(n,e,t,i=!0){const r=e[Ta],s=r.rendererFactory,o=r.afterRenderEventManager;s.begin?.(),o?.begin();try{Jx(n,e,n.template,t)}catch(l){throw i&&Yx(e,l),l}finally{s.end?.(),r.effectManager?.flush(),o?.end()}}function Jx(n,e,t,i){const r=e[rt];if(256!=(256&r)){e[Ta].effectManager?.flush(),Jg(e);try{Sw(e),function Iw(n){return qe.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&Fx(n,e,t,2,i);const o=3==(3&r);if(o){const c=n.preOrderCheckHooks;null!==c&&ph(e,c,null)}else{const c=n.preOrderHooks;null!==c&&mh(e,c,0,null),ty(e,0)}if(function kB(n){for(let e=EM(n);null!==e;e=bM(e)){if(!e[QS])continue;const t=e[Ia];for(let i=0;i<t.length;i++){ik(t[i])}}}(e),Qx(e,2),null!==n.contentQueries&&jx(n,e),o){const c=n.contentCheckHooks;null!==c&&ph(e,c)}else{const c=n.contentHooks;null!==c&&mh(e,c,1),ty(e,1)}!function lB(n,e){const t=n.hostBindingOpCodes;if(null===t)return;const i=Ix(e,Vc);try{for(let r=0;r<t.length;r++){const s=t[r];if(s<0)Io(~s);else{const o=s,a=t[++r],l=t[++r];mk(a,o),i.dirty=!1;const c=Bg(i);try{l(2,e[o])}finally{Vg(i,c)}}}}finally{null===e[Vc]&&Rx(e,Vc),Io(-1)}}(n,e);const a=n.components;null!==a&&tC(e,a,0);const l=n.viewQuery;if(null!==l&&f_(2,l,i),o){const c=n.viewCheckHooks;null!==c&&ph(e,c)}else{const c=n.viewHooks;null!==c&&mh(e,c,2),ty(e,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),e[rt]&=-73,ww(e)}finally{Qg()}}}function Qx(n,e){for(let t=EM(n);null!==t;t=bM(t))for(let i=Vn;i<t.length;i++)eC(t[i],e)}function UB(n,e,t){eC(Fi(e,n),t)}function eC(n,e){if(!function tk(n){return 128==(128&n[rt])}(n))return;const t=n[be],i=n[rt];if(80&i&&0===e||1024&i||2===e)Jx(t,n,t.template,n[cn]);else if(n[Oc]>0){Qx(n,1);const r=t.components;null!==r&&tC(n,r,1)}}function tC(n,e,t){for(let i=0;i<e.length;i++)UB(n,e[i],t)}class hu{get rootNodes(){const e=this._lView,t=e[be];return du(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[cn]}set context(e){this._lView[cn]=e}get destroyed(){return 256==(256&this._lView[rt])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[$t];if(ni(e)){const t=e[8],i=t?t.indexOf(this):-1;i>-1&&(Nh(e,i),bh(t,i))}this._attachedToViewContainer=!1}Ey(this._lView[be],this._lView)}onDestroy(e){!function xw(n,e){if(256==(256&n[rt]))throw new j(911,!1);null===n[Bs]&&(n[Bs]=[]),n[Bs].push(e)}(this._lView,e)}markForCheck(){cu(this._cdRefInjectingView||this._lView)}detach(){this._lView[rt]&=-129}reattach(){this._lView[rt]|=128}detectChanges(){nf(this._lView[be],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new j(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function AU(n,e){eu(n,e,e[et],2,null,null)}(this._lView[be],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new j(902,!1);this._appRef=e}}class BB extends hu{constructor(e){super(e),this._view=e}detectChanges(){const e=this._view;nf(e[be],e,e[cn],!1)}checkNoChanges(){}get context(){return null}}class nC extends Zh{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=_t(e);return new fu(t,this.ngModule)}}function iC(n){const e=[];for(let t in n)n.hasOwnProperty(t)&&e.push({propName:n[t],templateName:t});return e}class HB{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){i=ih(i);const r=this.injector.get(e,Ky,i);return r!==Ky||t===Ky?r:this.parentInjector.get(e,t,i)}}class fu extends cx{get inputs(){const e=this.componentDef,t=e.inputTransforms,i=iC(e.inputs);if(null!==t)for(const r of i)t.hasOwnProperty(r.propName)&&(r.transform=t[r.propName]);return i}get outputs(){return iC(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function T2(n){return n.map(C2).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,i,r){let s=(r=r||this.ngModule)instanceof Ui?r:r?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const o=s?new HB(e,s):e,a=o.get(au,null);if(null===a)throw new j(407,!1);const d={rendererFactory:a,sanitizer:o.get(k3,null),effectManager:o.get(Zx,null),afterRenderEventManager:o.get(r_,null)},h=a.createRenderer(null,this.componentDef),f=this.componentDef.selectors[0][0]||"div",p=i?function uB(n,e,t,i){const s=i.get(Cx,!1)||t===nr.ShadowDom,o=n.selectRootElement(e,s);return function dB(n){Ux(n)}(o),o}(h,i,this.componentDef.encapsulation,o):Ph(h,f,function VB(n){const e=n.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(f)),m=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let v=null;null!==p&&(v=Xy(p,o,!0));const _=c_(0,null,null,1,0,null,null,null,null,null,null),E=Qh(null,_,null,m,null,null,d,h,o,null,v);let S,x;Jg(E);try{const M=this.componentDef;let R,b=null;M.findHostDirectiveDefs?(R=[],b=new Map,M.findHostDirectiveDefs(M,R,b),R.push(M)):R=[M];const C=function GB(n,e){const t=n[be],i=ft;return n[i]=e,tl(t,i,2,"#host",null)}(E,p),U=function WB(n,e,t,i,r,s,o){const a=r[be];!function jB(n,e,t,i){for(const r of n)e.mergedAttrs=Lc(e.mergedAttrs,r.hostAttrs);null!==e.mergedAttrs&&(tf(e,e.mergedAttrs,!0),null!==t&&FM(i,t,e))}(i,n,e,o);let l=null;null!==e&&(l=Xy(e,r[Us]));const c=s.rendererFactory.createRenderer(e,t);let u=16;t.signals?u=4096:t.onPush&&(u=64);const d=Qh(r,kx(t),null,u,r[n.index],n,s,c,null,null,l);return a.firstCreatePass&&d_(a,n,i.length-1),ef(r,d),r[n.index]=d}(C,p,M,R,E,d,h);x=bw(_,ft),p&&function qB(n,e,t,i){if(i)Lg(n,t,["ng-version",U3.full]);else{const{attrs:r,classes:s}=function A2(n){const e=[],t=[];let i=1,r=2;for(;i<n.length;){let s=n[i];if("string"==typeof s)2===r?""!==s&&e.push(s,n[++i]):8===r&&t.push(s);else{if(!mr(r))break;r=s}i++}return{attrs:e,classes:t}}(e.selectors[0]);r&&Lg(n,t,r),s&&s.length>0&&OM(n,t,s.join(" "))}}(h,M,p,i),void 0!==t&&function XB(n,e,t){const i=n.projection=[];for(let r=0;r<e.length;r++){const s=t[r];i.push(null!=s?Array.from(s):null)}}(x,this.ngContentSelectors,t),S=function $B(n,e,t,i,r,s){const o=zn(),a=r[be],l=Ei(o,r);Hx(a,r,o,t,null,i);for(let u=0;u<t.length;u++)qn(Ro(r,a,o.directiveStart+u,o),r);zx(a,r,o),l&&qn(l,r);const c=Ro(r,a,o.directiveStart+o.componentOffset,o);if(n[cn]=r[cn]=c,null!==s)for(const u of s)u(c,e);return o_(a,o,n),c}(U,M,R,b,E,[YB]),m_(_,E,null)}finally{Qg()}return new zB(this.componentType,S,Ja(x,E),E,x)}}class zB extends R3{constructor(e,t,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new BB(r),this.componentType=e}setInput(e,t){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;const s=this._rootLView;p_(s[be],s,r,e,t),this.previousInputValues.set(e,t),cu(Fi(this._tNode.index,s))}}get injector(){return new si(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function YB(){const n=zn();fh(te()[be],n)}function wt(n){let e=function rC(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),t=!0;const i=[n];for(;e;){let r;if(yr(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new j(903,!1);r=e.\u0275dir}if(r){if(t){i.push(r);const o=n;o.inputs=rf(n.inputs),o.inputTransforms=rf(n.inputTransforms),o.declaredInputs=rf(n.declaredInputs),o.outputs=rf(n.outputs);const a=r.hostBindings;a&&QB(n,a);const l=r.viewQuery,c=r.contentQueries;if(l&&KB(n,l),c&&JB(n,c),Kd(n.inputs,r.inputs),Kd(n.declaredInputs,r.declaredInputs),Kd(n.outputs,r.outputs),null!==r.inputTransforms&&(null===o.inputTransforms&&(o.inputTransforms={}),Kd(o.inputTransforms,r.inputTransforms)),yr(r)&&r.data.animation){const u=n.data;u.animation=(u.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(n),a===wt&&(t=!1)}}e=Object.getPrototypeOf(e)}!function ZB(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){const r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=Lc(r.hostAttrs,t=Lc(t,r.hostAttrs))}}(i)}function rf(n){return n===Ir?{}:n===Et?[]:n}function KB(n,e){const t=n.viewQuery;n.viewQuery=t?(i,r)=>{e(i,r),t(i,r)}:e}function JB(n,e){const t=n.contentQueries;n.contentQueries=t?(i,r,s)=>{e(i,r,s),t(i,r,s)}:e}function QB(n,e){const t=n.hostBindings;n.hostBindings=t?(i,r)=>{e(i,r),t(i,r)}:e}function sf(n){return!!g_(n)&&(Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n)}function g_(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function Xn(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function af(n,e,t,i,r){const s=function Lo(n,e,t,i){const r=Xn(n,e,t);return Xn(n,e+1,i)||r}(n,e,t,i);return Xn(n,e+2,r)||s}function Kt(n,e,t,i){const r=te();return Xn(r,La(),e)&&(vt(),Ur(Zt(),r,n,e,t,i)),Kt}function qt(n,e,t,i,r,s,o,a){const l=te(),c=vt(),u=n+ft,d=c.firstCreatePass?function MV(n,e,t,i,r,s,o,a,l){const c=e.consts,u=tl(e,n,4,o||null,Hs(c,a));u_(e,t,u,Hs(c,l)),fh(e,u);const d=u.tView=c_(2,u,i,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c,null);return null!==e.queries&&(e.queries.template(e,u),d.queries=e.queries.embeddedTView(u)),u}(u,c,l,e,t,i,r,s,o):c.data[u];Or(d,!1);const h=bC(c,l,d,n);hh()&&Oh(c,l,h,d),qn(h,l),ef(l,l[u]=Wx(h,l,h,d)),lh(d)&&a_(c,l,d),null!=o&&l_(l,d,a)}let bC=function SC(n,e,t,i){return zs(!0),e[et].createComment("")};function S_(n){return function Pa(n,e){return n[e]}(function fk(){return qe.lFrame.contextLView}(),ft+n)}function ut(n,e,t){const i=te();return Xn(i,La(),e)&&function Vi(n,e,t,i,r,s,o,a){const l=Ei(e,t);let u,c=e.inputs;!a&&null!=c&&(u=c[i])?(p_(n,t,u,i,r),Ao(e)&&function _B(n,e){const t=Fi(e,n);16&t[rt]||(t[rt]|=64)}(t,e.index)):3&e.type&&(i=function yB(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=o?o(r,e.value||"",i):r,s.setProperty(l,i,r))}(vt(),Zt(),i,n,e,i[et],t,!1),ut}function w_(n,e,t,i,r){const o=r?"class":"style";p_(n,t,e.inputs[o],o,i)}function en(n,e,t,i){const r=te(),s=vt(),o=ft+n,a=r[et],l=s.firstCreatePass?function AV(n,e,t,i,r,s){const o=e.consts,l=tl(e,n,2,i,Hs(o,r));return u_(e,t,l,Hs(o,s)),null!==l.attrs&&tf(l,l.attrs,!1),null!==l.mergedAttrs&&tf(l,l.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,l),l}(o,s,r,e,t,i):s.data[o],c=wC(s,r,l,a,e,n);r[o]=c;const u=lh(l);return Or(l,!0),FM(a,c,l),32!=(32&l.flags)&&hh()&&Oh(s,r,c,l),0===function sk(){return qe.lFrame.elementDepthCount}()&&qn(c,r),function ok(){qe.lFrame.elementDepthCount++}(),u&&(a_(s,r,l),o_(s,l,r)),null!==i&&l_(r,l),en}function tn(){let n=zn();qg()?Xg():(n=n.parent,Or(n,!1));const e=n;(function lk(n){return qe.skipHydrationRootTNode===n})(e)&&function hk(){qe.skipHydrationRootTNode=null}(),function ak(){qe.lFrame.elementDepthCount--}();const t=vt();return t.firstCreatePass&&(fh(t,n),Fg(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function Ck(n){return 0!=(8&n.flags)}(e)&&w_(t,e,te(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function Tk(n){return 0!=(16&n.flags)}(e)&&w_(t,e,te(),e.stylesWithoutHost,!1),tn}function Hi(n,e,t,i){return en(n,e,t,i),tn(),Hi}let wC=(n,e,t,i,r,s)=>(zs(!0),Ph(i,r,function Uw(){return qe.lFrame.currentNamespace}()));function $s(n,e,t){const i=te(),r=vt(),s=n+ft,o=r.firstCreatePass?function RV(n,e,t,i,r){const s=e.consts,o=Hs(s,i),a=tl(e,n,8,"ng-container",o);return null!==o&&tf(a,o,!0),u_(e,t,a,Hs(s,r)),null!==e.queries&&e.queries.elementStart(e,a),a}(s,r,i,e,t):r.data[s];Or(o,!0);const a=MC(r,i,o,n);return i[s]=a,hh()&&Oh(r,i,a,o),qn(a,i),lh(o)&&(a_(r,i,o),o_(r,o,i)),null!=t&&l_(i,o),$s}function qs(){let n=zn();const e=vt();return qg()?Xg():(n=n.parent,Or(n,!1)),e.firstCreatePass&&(fh(e,n),Fg(n)&&e.queries.elementEnd(n)),qs}function M_(n,e,t){return $s(n,e,t),qs(),M_}let MC=(n,e,t,i)=>(zs(!0),vy(e[et],""));function x_(){return te()}function _u(n){return!!n&&"function"==typeof n.then}function xC(n){return!!n&&"function"==typeof n.subscribe}function dn(n,e,t,i){const r=te(),s=vt(),o=zn();return function TC(n,e,t,i,r,s,o){const a=lh(i),c=n.firstCreatePass&&qx(n),u=e[cn],d=$x(e);let h=!0;if(3&i.type||o){const y=Ei(i,e),g=o?o(y):y,m=d.length,v=o?E=>o(kt(E[i.index])):i.index;let _=null;if(!o&&a&&(_=function LV(n,e,t,i){const r=n.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===t&&r[s+1]===i){const a=e[Ca],l=r[s+2];return a.length>l?a[l]:null}"string"==typeof o&&(s+=2)}return null}(n,e,r,i.index)),null!==_)(_.__ngLastListenerFn__||_).__ngNextListenerFn__=s,_.__ngLastListenerFn__=s,h=!1;else{s=DC(i,e,u,s,!1);const E=t.listen(g,r,s);d.push(s,E),c&&c.push(r,v,m,m+1)}}else s=DC(i,e,u,s,!1);const f=i.outputs;let p;if(h&&null!==f&&(p=f[r])){const y=p.length;if(y)for(let g=0;g<y;g+=2){const S=e[p[g]][p[g+1]].subscribe(s),x=d.length;d.push(s,S),c&&c.push(r,i.index,x,-(x+1))}}}(s,r,r[et],o,n,e,i),dn}function AC(n,e,t,i){try{return Lr(6,e,t),!1!==t(i)}catch(r){return Yx(n,r),!1}finally{Lr(7,e,t)}}function DC(n,e,t,i,r){return function s(o){if(o===Function)return i;cu(n.componentOffset>-1?Fi(n.index,e):e);let l=AC(e,t,i,o),c=s.__ngNextListenerFn__;for(;c;)l=AC(e,t,c,o)&&l,c=c.__ngNextListenerFn__;return r&&!1===l&&o.preventDefault(),l}}function Rn(n=1){return function _k(n){return(qe.lFrame.contextLView=function vk(n,e){for(;n>0;)e=e[Aa],n--;return e}(n,qe.lFrame.contextLView))[cn]}(n)}function OV(n,e){let t=null;const i=function S2(n){const e=n.attrs;if(null!=e){const t=e.indexOf(5);if(!(1&t))return e[t+1]}return null}(n);for(let r=0;r<e.length;r++){const s=e[r];if("*"!==s){if(null===i?$S(n,s,!0):x2(i,s))return r}else t=r}return t}function C_(n){const e=te()[un][$n];if(!e.projection){const i=e.projection=Yc(n?n.length:1,null),r=i.slice();let s=e.child;for(;null!==s;){const o=n?OV(s,n):0;null!==o&&(r[o]?r[o].projectionNext=s:i[o]=s,r[o]=s),s=s.next}}}function T_(n,e=0,t){const i=te(),r=vt(),s=tl(r,ft+n,16,null,t||null);null===s.projection&&(s.projection=e),Xg(),(!i[ns]||Na())&&32!=(32&s.flags)&&function FU(n,e,t){LM(e[et],0,e,t,Sy(n,t,e),AM(t.parent||e[$n],t,e))}(r,i,s)}function df(n,e){return n<<17|e<<2}function Xs(n){return n>>17&32767}function D_(n){return 2|n}function Oo(n){return(131068&n)>>2}function I_(n,e){return-131069&n|e<<2}function R_(n){return 1|n}function BC(n,e,t,i,r){const s=n[t+1],o=null===e;let a=i?Xs(s):Oo(s),l=!1;for(;0!==a&&(!1===l||o);){const u=n[a+1];HV(n[a],e)&&(l=!0,n[a+1]=i?R_(u):D_(u)),a=i?Xs(u):Oo(u)}l&&(n[t+1]=i?D_(s):R_(s))}function HV(n,e){return null===n||null==e||(Array.isArray(n)?n[1]:n)===e||!(!Array.isArray(n)||"string"!=typeof e)&&za(n,e)>=0}const An={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function VC(n){return n.substring(An.key,An.keyEnd)}function HC(n,e){const t=An.textEnd;return t===e?-1:(e=An.keyEnd=function jV(n,e,t){for(;e<t&&n.charCodeAt(e)>32;)e++;return e}(n,An.key=e,t),dl(n,e,t))}function dl(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function vu(n,e){return function _r(n,e,t,i){const r=te(),s=vt(),o=rs(2);s.firstUpdatePass&&XC(s,n,o,i),e!==it&&Xn(r,o,e)&&ZC(s,s.data[ri()],r,r[et],n,r[o+1]=function nH(n,e){return null==n||""===n||("string"==typeof e?n+=e:"object"==typeof n&&(n=xn(Ws(n)))),n}(e,t),i,o)}(n,e,null,!0),vu}function cs(n){!function vr(n,e,t,i){const r=vt(),s=rs(2);r.firstUpdatePass&&XC(r,null,s,i);const o=te();if(t!==it&&Xn(o,s,t)){const a=r.data[ri()];if(JC(a,i)&&!qC(r,s)){let l=i?a.classesWithoutHost:a.stylesWithoutHost;null!==l&&(t=Eg(l,t||"")),w_(r,a,o,t,i)}else!function tH(n,e,t,i,r,s,o,a){r===it&&(r=Et);let l=0,c=0,u=0<r.length?r[0]:null,d=0<s.length?s[0]:null;for(;null!==u||null!==d;){const h=l<r.length?r[l+1]:void 0,f=c<s.length?s[c+1]:void 0;let y,p=null;u===d?(l+=2,c+=2,h!==f&&(p=d,y=f)):null===d||null!==u&&u<d?(l+=2,p=u):(c+=2,p=d,y=f),null!==p&&ZC(n,e,t,i,p,y,o,a),u=l<r.length?r[l]:null,d=c<s.length?s[c]:null}}(r,a,o,o[et],o[s+1],o[s+1]=function QV(n,e,t){if(null==t||""===t)return Et;const i=[],r=Ws(t);if(Array.isArray(r))for(let s=0;s<r.length;s++)n(i,r[s],!0);else if("object"==typeof r)for(const s in r)r.hasOwnProperty(s)&&n(i,s,r[s]);else"string"==typeof r&&e(i,r);return i}(n,e,t),i,s)}}(eH,Hr,n,!0)}function Hr(n,e){for(let t=function GV(n){return function GC(n){An.key=0,An.keyEnd=0,An.value=0,An.valueEnd=0,An.textEnd=n.length}(n),HC(n,dl(n,0,An.textEnd))}(e);t>=0;t=HC(e,t))ki(n,VC(e),!0)}function qC(n,e){return e>=n.expandoStartIndex}function XC(n,e,t,i){const r=n.data;if(null===r[t+1]){const s=r[ri()],o=qC(n,t);JC(s,i)&&null===e&&!o&&(e=!1),e=function YV(n,e,t,i){const r=function Zg(n){const e=qe.lFrame.currentDirectiveIndex;return-1===e?null:n[e]}(n);let s=i?e.residualClasses:e.residualStyles;if(null===r)0===(i?e.classBindings:e.styleBindings)&&(t=Eu(t=P_(null,n,e,t,i),e.attrs,i),s=null);else{const o=e.directiveStylingLast;if(-1===o||n[o]!==r)if(t=P_(r,n,e,t,i),null===s){let l=function ZV(n,e,t){const i=t?e.classBindings:e.styleBindings;if(0!==Oo(i))return n[Xs(i)]}(n,e,i);void 0!==l&&Array.isArray(l)&&(l=P_(null,n,e,l[1],i),l=Eu(l,e.attrs,i),function KV(n,e,t,i){n[Xs(t?e.classBindings:e.styleBindings)]=i}(n,e,i,l))}else s=function JV(n,e,t){let i;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)i=Eu(i,n[s].hostAttrs,t);return Eu(i,e.attrs,t)}(n,e,i)}return void 0!==s&&(i?e.residualClasses=s:e.residualStyles=s),t}(r,s,e,i),function BV(n,e,t,i,r,s){let o=s?e.classBindings:e.styleBindings,a=Xs(o),l=Oo(o);n[i]=t;let u,c=!1;if(Array.isArray(t)?(u=t[1],(null===u||za(t,u)>0)&&(c=!0)):u=t,r)if(0!==l){const h=Xs(n[a+1]);n[i+1]=df(h,a),0!==h&&(n[h+1]=I_(n[h+1],i)),n[a+1]=function kV(n,e){return 131071&n|e<<17}(n[a+1],i)}else n[i+1]=df(a,0),0!==a&&(n[a+1]=I_(n[a+1],i)),a=i;else n[i+1]=df(l,0),0===a?a=i:n[l+1]=I_(n[l+1],i),l=i;c&&(n[i+1]=D_(n[i+1])),BC(n,u,i,!0),BC(n,u,i,!1),function VV(n,e,t,i,r){const s=r?n.residualClasses:n.residualStyles;null!=s&&"string"==typeof e&&za(s,e)>=0&&(t[i+1]=R_(t[i+1]))}(e,u,n,i,s),o=df(a,l),s?e.classBindings=o:e.styleBindings=o}(r,s,e,t,o,i)}}function P_(n,e,t,i,r){let s=null;const o=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<o&&(s=e[a],i=Eu(i,s.hostAttrs,r),s!==n);)a++;return null!==n&&(t.directiveStylingLast=a),i}function Eu(n,e,t){const i=t?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?r=o:r===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),ki(n,o,!!t||e[++s]))}return void 0===n?null:n}function eH(n,e,t){const i=String(e);""!==i&&!i.includes(" ")&&ki(n,i,t)}function ZC(n,e,t,i,r,s,o,a){if(!(3&e.type))return;const l=n.data,c=l[a+1],u=function UV(n){return 1==(1&n)}(c)?KC(l,e,t,r,Oo(c),o):void 0;hf(u)||(hf(s)||function FV(n){return 2==(2&n)}(c)&&(s=KC(l,null,t,r,a,o)),function UU(n,e,t,i,r){if(e)r?n.addClass(t,i):n.removeClass(t,i);else{let s=-1===i.indexOf("-")?void 0:Gs.DashCase;null==r?n.removeStyle(t,i,s):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),s|=Gs.Important),n.setStyle(t,i,r,s))}}(i,o,dh(ri(),t),r,s))}function KC(n,e,t,i,r,s){const o=null===e;let a;for(;r>0;){const l=n[r],c=Array.isArray(l),u=c?l[1]:l,d=null===u;let h=t[r+1];h===it&&(h=d?Et:void 0);let f=d?cy(h,i):u===i?h:void 0;if(c&&!hf(f)&&(f=cy(l,i)),hf(f)&&(a=f,o))return a;const p=n[r+1];r=o?Xs(p):Oo(p)}if(null!==e){let l=s?e.residualClasses:e.residualStyles;null!=l&&(a=cy(l,i))}return a}function hf(n){return void 0!==n}function JC(n,e){return 0!=(n.flags&(e?8:16))}function zr(n,e=""){const t=te(),i=vt(),r=n+ft,s=i.firstCreatePass?tl(i,r,1,e,null):i.data[r],o=QC(i,t,s,e,n);t[r]=o,hh()&&Oh(i,t,o,s),Or(s,!1)}let QC=(n,e,t,i,r)=>(zs(!0),function Rh(n,e){return n.createText(e)}(e[et],i));function bu(n){return N_("",n,""),bu}function N_(n,e,t){const i=te(),r=function il(n,e,t,i){return Xn(n,La(),t)?e+Qe(t)+i:it}(i,n,e,t);return r!==it&&function ls(n,e,t){const i=dh(e,n);!function wM(n,e,t){n.setValue(e,t)}(n[et],i,t)}(i,ri(),r),N_}const fl="en-US";let bT=fl;function F_(n,e,t,i,r){if(n=Ze(n),Array.isArray(n))for(let s=0;s<n.length;s++)F_(n[s],e,t,i,r);else{const s=vt(),o=te(),a=zn();let l=No(n)?n:Ze(n.provide);const c=nx(n),u=1048575&a.providerIndexes,d=a.directiveStart,h=a.providerIndexes>>20;if(No(n)||!n.multi){const f=new Wc(c,r,ne),p=U_(l,e,r?u:u+h,d);-1===p?(oy(yh(a,o),s,l),k_(s,n,e.length),e.push(l),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(f),o.push(f)):(t[p]=f,o[p]=f)}else{const f=U_(l,e,u+h,d),p=U_(l,e,u,u+h),g=p>=0&&t[p];if(r&&!g||!r&&!(f>=0&&t[f])){oy(yh(a,o),s,l);const m=function wz(n,e,t,i,r){const s=new Wc(n,t,ne);return s.multi=[],s.index=e,s.componentProviders=0,$T(s,r,i&&!t),s}(r?Sz:bz,t.length,r,i,c);!r&&g&&(t[p].providerFactory=m),k_(s,n,e.length,0),e.push(l),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(m),o.push(m)}else k_(s,n,f>-1?f:p,$T(t[r?p:f],c,!r&&i));!r&&i&&g&&t[p].componentProviders++}}}function k_(n,e,t,i){const r=No(e),s=function p3(n){return!!n.useClass}(e);if(r||s){const l=(s?Ze(e.useClass):e).prototype.ngOnDestroy;if(l){const c=n.destroyHooks||(n.destroyHooks=[]);if(!r&&e.multi){const u=c.indexOf(t);-1===u?c.push(t,[i,l]):c[u+1].push(i,l)}else c.push(t,l)}}}function $T(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function U_(n,e,t,i){for(let r=t;r<i;r++)if(e[r]===n)return r;return-1}function bz(n,e,t,i){return B_(this.multi,[])}function Sz(n,e,t,i){const r=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=Ro(t,t[be],this.providerFactory.index,i);s=a.slice(0,o),B_(r,s);for(let l=o;l<a.length;l++)s.push(a[l])}else s=[],B_(r,s);return s}function B_(n,e){for(let t=0;t<n.length;t++)e.push((0,n[t])());return e}function Ht(n,e=[]){return t=>{t.providersResolver=(i,r)=>function Ez(n,e,t){const i=vt();if(i.firstCreatePass){const r=yr(n);F_(t,i.data,i.blueprint,r,!0),F_(e,i.data,i.blueprint,r,!1)}}(i,r?r(n):n,e)}}class ko{}class qT{}class V_ extends ko{constructor(e,t,i){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new nC(this);const r=Oi(e);this._bootstrapComponents=as(r.bootstrap),this._r3Injector=mx(e,t,[{provide:ko,useValue:this},{provide:Zh,useValue:this.componentFactoryResolver},...i],xn(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class H_ extends qT{constructor(e){super(),this.moduleType=e}create(e){return new V_(this.moduleType,e,[])}}class XT extends ko{constructor(e){super(),this.componentFactoryResolver=new nC(this),this.instance=null;const t=new Gh([...e.providers,{provide:ko,useValue:this},{provide:Zh,useValue:this.componentFactoryResolver}],e.parent||zh(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function z_(n,e,t=null){return new XT({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}let Cz=(()=>{class n{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){const i=JM(0,t.type),r=i.length>0?z_([i],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,r)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}static#e=this.\u0275prov=Pe({token:n,providedIn:"environment",factory:()=>new n(xe(Ui))})}return n})();function Tu(n){n.getStandaloneInjector=e=>e.get(Cz).getOrCreateStandaloneInjector(n)}function yf(n,e,t,i,r,s){return function iA(n,e,t,i,r,s,o,a){const l=e+t;return af(n,l,r,s,o)?function Br(n,e,t){return n[e]=t}(n,l+3,a?i.call(a,r,s,o):i(r,s,o)):function Au(n,e){const t=n[e];return t===it?void 0:t}(n,l+3)}(te(),function ii(){const n=qe.lFrame;let e=n.bindingRootIndex;return-1===e&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}(),n,e,t,i,r,s)}function Kz(){return this._results[Symbol.iterator]()}class W_{static#e=Symbol.iterator;get changes(){return this._changes||(this._changes=new Ut)}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=W_.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=Kz)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const i=this;i.dirty=!1;const r=function sr(n){return n.flat(Number.POSITIVE_INFINITY)}(e);(this._changesDetected=!function Hk(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],s=e[i];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}(i._results,r,t))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}function Qz(n,e,t,i=!0){const r=e[be];if(function IU(n,e,t,i){const r=Vn+i,s=t.length;i>0&&(t[r-1][gr]=e),i<s-Vn?(e[gr]=t[r],Qw(t,Vn+i,e)):(t.push(e),e[gr]=null),e[$t]=t;const o=e[kc];null!==o&&t!==o&&function RU(n,e){const t=n[Ia];e[un]!==e[$t][$t][un]&&(n[QS]=!0),null===t?n[Ia]=[e]:t.push(e)}(o,e);const a=e[Pr];null!==a&&a.insertView(n),e[rt]|=128}(r,e,n,t),i){const s=My(t,n),o=e[et],a=Lh(o,n[Nr]);null!==a&&function TU(n,e,t,i,r,s){i[Qt]=r,i[$n]=e,eu(n,i,t,1,r,s)}(r,n[$n],o,e,a,s)}}let Gr=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=n4}return n})();const e4=Gr,t4=class extends e4{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,i){const r=function Jz(n,e,t,i){const r=e.tView,a=Qh(n,r,t,4096&n[rt]?4096:16,null,e,null,null,null,i?.injector??null,i?.hydrationInfo??null);a[kc]=n[e.index];const c=n[Pr];return null!==c&&(a[Pr]=c.createEmbeddedView(r)),m_(r,a,t),a}(this._declarationLView,this._declarationTContainer,e,{injector:t,hydrationInfo:i});return new hu(r)}};function n4(){return _f(zn(),te())}function _f(n,e){return 4&n.type?new t4(e,n,Ja(n,e)):null}let Er=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=l4}return n})();function l4(){return hA(zn(),te())}const c4=Er,uA=class extends c4{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return Ja(this._hostTNode,this._hostLView)}get injector(){return new si(this._hostTNode,this._hostLView)}get parentInjector(){const e=_h(this._hostTNode,this._hostLView);if(iy(e)){const t=$c(e,this._hostLView),i=jc(e);return new si(t[be].data[i+8],t)}return new si(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=dA(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-Vn}createEmbeddedView(e,t,i){let r,s;"number"==typeof i?r=i:null!=i&&(r=i.index,s=i.injector);const a=e.createEmbeddedViewImpl(t||{},s,null);return this.insertImpl(a,r,false),a}createComponent(e,t,i,r,s){const o=e&&!function Xc(n){return"function"==typeof n}(e);let a;if(o)a=t;else{const y=t||{};a=y.index,i=y.injector,r=y.projectableNodes,s=y.environmentInjector||y.ngModuleRef}const l=o?e:new fu(_t(e)),c=i||this.parentInjector;if(!s&&null==l.ngModule){const g=(o?c:this.parentInjector).get(Ui,null);g&&(s=g)}_t(l.componentType??{});const f=l.create(c,r,null,s);return this.insertImpl(f.hostView,a,false),f}insert(e,t){return this.insertImpl(e,t,!1)}insertImpl(e,t,i){const r=e._lView;if(function nk(n){return ni(n[$t])}(r)){const l=this.indexOf(e);if(-1!==l)this.detach(l);else{const c=r[$t],u=new uA(c,c[$n],c[$t]);u.detach(u.indexOf(e))}}const o=this._adjustIndex(t),a=this._lContainer;return Qz(a,r,o,!i),e.attachToViewContainerRef(),Qw(j_(a),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=dA(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=Nh(this._lContainer,t);i&&(bh(j_(this._lContainer),t),Ey(i[be],i))}detach(e){const t=this._adjustIndex(e,-1),i=Nh(this._lContainer,t);return i&&null!=bh(j_(this._lContainer),t)?new hu(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function dA(n){return n[8]}function j_(n){return n[8]||(n[8]=[])}function hA(n,e){let t;const i=e[n.index];return ni(i)?t=i:(t=Wx(i,e,null,n),e[n.index]=t,ef(e,t)),fA(t,e,n,i),new uA(t,n,e)}let fA=function pA(n,e,t,i){if(n[Nr])return;let r;r=8&t.type?kt(i):function u4(n,e){const t=n[et],i=t.createComment(""),r=Ei(e,n);return Po(t,Lh(t,r),i,function OU(n,e){return n.nextSibling(e)}(t,r),!1),i}(e,t),n[Nr]=r};class $_{constructor(e){this.queryList=e,this.matches=null}clone(){return new $_(this.queryList)}setDirty(){this.queryList.setDirty()}}class q_{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let s=0;s<i;s++){const o=t.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new q_(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==vA(e,t).matches&&this.queries[t].setDirty()}}class mA{constructor(e,t,i=null){this.predicate=e,this.flags=t,this.read=i}}class X_{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,s=this.getByIndex(i).embeddedTView(e,r);s&&(s.indexInDeclarationView=i,null!==t?t.push(s):t=[s])}return null!==t?new X_(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class Y_{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new Y_(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(e,t,f4(t,s)),this.matchTNodeWithReadOption(e,t,vh(t,e,s,!1,!1))}else i===Gr?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,vh(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===Si||r===Er||r===Gr&&4&t.type)this.addMatch(t.index,-2);else{const s=vh(t,e,r,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function f4(n,e){const t=n.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1];return null}function m4(n,e,t,i){return-1===t?function p4(n,e){return 11&n.type?Ja(n,e):4&n.type?_f(n,e):null}(e,n):-2===t?function g4(n,e,t){return t===Si?Ja(e,n):t===Gr?_f(e,n):t===Er?hA(e,n):void 0}(n,e,i):Ro(n,n[be],t,e)}function gA(n,e,t,i){const r=e[Pr].queries[i];if(null===r.matches){const s=n.data,o=t.matches,a=[];for(let l=0;l<o.length;l+=2){const c=o[l];a.push(c<0?null:m4(e,s[c],o[l+1],t.metadata.read))}r.matches=a}return r.matches}function Z_(n,e,t,i){const r=n.queries.getByIndex(t),s=r.matches;if(null!==s){const o=gA(n,e,r,t);for(let a=0;a<s.length;a+=2){const l=s[a];if(l>0)i.push(o[a/2]);else{const c=s[a+1],u=e[-l];for(let d=Vn;d<u.length;d++){const h=u[d];h[kc]===h[$t]&&Z_(h[be],h,c,i)}if(null!==u[Ia]){const d=u[Ia];for(let h=0;h<d.length;h++){const f=d[h];Z_(f[be],f,c,i)}}}}}return i}function pl(n){const e=te(),t=vt(),i=Pw();Kg(i+1);const r=vA(t,i);if(n.dirty&&function ek(n){return 4==(4&n[rt])}(e)===(2==(2&r.metadata.flags))){if(null===r.matches)n.reset([]);else{const s=r.crossesNgTemplate?Z_(t,e,i,[]):gA(t,e,r,i);n.reset(s,O3),n.notifyOnChanges()}return!0}return!1}function K_(n,e,t){const i=vt();i.firstCreatePass&&(_A(i,new mA(n,e,t),-1),2==(2&e)&&(i.staticViewQueries=!0)),yA(i,te(),e)}function Ef(n,e,t,i){const r=vt();if(r.firstCreatePass){const s=zn();_A(r,new mA(e,t,i),s.index),function _4(n,e){const t=n.contentQueries||(n.contentQueries=[]);e!==(t.length?t[t.length-1]:-1)&&t.push(n.queries.length-1,e)}(r,n),2==(2&t)&&(r.staticContentQueries=!0)}yA(r,te(),t)}function ml(){return function y4(n,e){return n[Pr].queries[e].queryList}(te(),Pw())}function yA(n,e,t){const i=new W_(4==(4&t));(function pB(n,e,t,i){const r=$x(e);r.push(t),n.firstCreatePass&&qx(n).push(i,r.length-1)})(n,e,i,i.destroy),null===e[Pr]&&(e[Pr]=new q_),e[Pr].queries.push(new $_(i))}function _A(n,e,t){null===n.queries&&(n.queries=new X_),n.queries.track(new Y_(e,t))}function vA(n,e){return n.queries.getByIndex(e)}const iv=new Ce("Application Initializer");let rv=(()=>{class n{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,i)=>{this.resolve=t,this.reject=i}),this.appInits=we(iv,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const t=[];for(const r of this.appInits){const s=r();if(_u(s))t.push(s);else if(xC(s)){const o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});t.push(o)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),FA=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();const us=new Ce("LocaleId",{providedIn:"root",factory:()=>we(us,ht.Optional|ht.SkipSelf)||function V4(){return typeof $localize<"u"&&$localize.locale||fl}()});let Sf=(()=>{class n{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new er(!1)}add(){this.hasPendingTasks.next(!0);const t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class G4{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let kA=(()=>{class n{compileModuleSync(t){return new H_(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const i=this.compileModuleSync(t),s=as(Oi(t).declarations).reduce((o,a)=>{const l=_t(a);return l&&o.push(new fu(l)),o},[]);return new G4(i,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const HA=new Ce(""),Mf=new Ce("");let cv,av=(()=>{class n{constructor(t,i,r){this._ngZone=t,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,cv||(function cG(n){cv=n}(r),r.addToWindow(i)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Dt.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,i,r){return[]}static#e=this.\u0275fac=function(i){return new(i||n)(xe(Dt),xe(lv),xe(Mf))};static#t=this.\u0275prov=Pe({token:n,factory:n.\u0275fac})}return n})(),lv=(()=>{class n{constructor(){this._applications=new Map}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return cv?.findTestabilityInTree(this,t,i)??null}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})(),Ys=null;const zA=new Ce("AllowMultipleToken"),uv=new Ce("PlatformDestroyListeners"),dv=new Ce("appBootstrapListener");class WA{constructor(e,t){this.name=e,this.token=t}}function $A(n,e,t=[]){const i=`Platform: ${e}`,r=new Ce(i);return(s=[])=>{let o=hv();if(!o||o.injector.get(zA,!1)){const a=[...t,...s,{provide:r,useValue:!0}];n?n(a):function hG(n){if(Ys&&!Ys.get(zA,!1))throw new j(400,!1);(function GA(){!function H2(n){dw=n}(()=>{throw new j(600,!1)})})(),Ys=n;const e=n.get(XA);(function jA(n){n.get(ix,null)?.forEach(t=>t())})(n)}(function qA(n=[],e){return Bi.create({name:e,providers:[{provide:ky,useValue:"platform"},{provide:uv,useValue:new Set([()=>Ys=null])},...n]})}(a,i))}return function pG(n){const e=hv();if(!e)throw new j(401,!1);return e}()}}function hv(){return Ys?.get(XA)??null}let XA=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,i){const r=function mG(n="zone.js",e){return"noop"===n?new Z3:"zone.js"===n?new Dt(e):n}(i?.ngZone,function YA(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return r.run(()=>{const s=function xz(n,e,t){return new V_(n,e,t)}(t.moduleType,this.injector,function eD(n){return[{provide:Dt,useFactory:n},{provide:ru,multi:!0,useFactory:()=>{const e=we(yG,{optional:!0});return()=>e.initialize()}},{provide:QA,useFactory:gG},{provide:Ex,useFactory:bx}]}(()=>r)),o=s.injector.get(os,null);return r.runOutsideAngular(()=>{const a=r.onError.subscribe({next:l=>{o.handleError(l)}});s.onDestroy(()=>{xf(this._modules,s),a.unsubscribe()})}),function ZA(n,e,t){try{const i=t();return _u(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}(o,r,()=>{const a=s.injector.get(rv);return a.runInitializers(),a.donePromise.then(()=>(function ST(n){tr(n,"Expected localeId to be defined"),"string"==typeof n&&(bT=n.toLowerCase().replace(/_/g,"-"))}(s.injector.get(us,fl)||fl),this._moduleDoBootstrap(s),s))})})}bootstrapModule(t,i=[]){const r=KA({},i);return function uG(n,e,t){const i=new H_(t);return Promise.resolve(i)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(t){const i=t.injector.get(Uo);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new j(-403,!1);t.instance.ngDoBootstrap(i)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new j(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const t=this._injector.get(uv,null);t&&(t.forEach(i=>i()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static#e=this.\u0275fac=function(i){return new(i||n)(xe(Bi))};static#t=this.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();function KA(n,e){return Array.isArray(e)?e.reduce(KA,n):{...n,...e}}let Uo=(()=>{class n{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=we(QA),this.zoneIsStable=we(Ex),this.componentTypes=[],this.components=[],this.isStable=we(Sf).hasPendingTasks.pipe(pr(t=>t?je(!1):this.zoneIsStable),function JF(n,e=Os){return n=n??QF,wn((t,i)=>{let r,s=!0;t.subscribe(mn(i,o=>{const a=e(o);(s||!n(r,a))&&(s=!1,r=a,i.next(o))}))})}(),DS()),this._injector=we(Ui)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(t,i){const r=t instanceof cx;if(!this._injector.get(rv).done)throw!r&&function xa(n){const e=_t(n)||Bn(n)||ti(n);return null!==e&&e.standalone}(t),new j(405,!1);let o;o=r?t:this._injector.get(Zh).resolveComponentFactory(t),this.componentTypes.push(o.componentType);const a=function dG(n){return n.isBoundToModule}(o)?void 0:this._injector.get(ko),c=o.create(Bi.NULL,[],i||o.selector,a),u=c.location.nativeElement,d=c.injector.get(HA,null);return d?.registerApplication(u),c.onDestroy(()=>{this.detachView(c.hostView),xf(this.components,c),d?.unregisterApplication(u)}),this._loadComponent(c),c}tick(){if(this._runningTick)throw new j(101,!1);try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this.internalErrorHandler(t)}finally{this._runningTick=!1}}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;xf(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);const i=this._injector.get(dv,[]);i.push(...this._bootstrapListeners),i.forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>xf(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new j(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function xf(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const QA=new Ce("",{providedIn:"root",factory:()=>we(os).handleError.bind(void 0)});function gG(){const n=we(Dt),e=we(os);return t=>n.runOutsideAngular(()=>e.handleError(t))}let yG=(()=>{class n{constructor(){this.zone=we(Dt),this.applicationRef=we(Uo)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();let Pu=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=vG}return n})();function vG(n){return function EG(n,e,t){if(Ao(n)&&!t){const i=Fi(n.index,e);return new hu(i,i)}return 47&n.type?new hu(e[un],e):null}(zn(),te(),16==(16&n))}class rD{constructor(){}supports(e){return sf(e)}create(e){return new CG(e)}}const xG=(n,e)=>e;class CG{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||xG}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,s=null;for(;t||i;){const o=!i||t&&t.currentIndex<oD(i,r,s)?t:i,a=oD(o,r,s),l=o.currentIndex;if(o===i)r--,i=i._nextRemoved;else if(t=t._next,null==o.previousIndex)r++;else{s||(s=[]);const c=a-r,u=l-r;if(c!=u){for(let h=0;h<c;h++){const f=h<s.length?s[h]:s[h]=0,p=f+h;u<=p&&p<c&&(s[h]=f+1)}s[o.previousIndex]=u-c}}a!==l&&e(o,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!sf(e))throw new j(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let r,s,o,t=this._itHead,i=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,o,a),i=!0),t=t._next}else r=0,function oV(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{const t=n[Symbol.iterator]();let i;for(;!(i=t.next()).done;)e(i.value)}}(e,a=>{o=this._trackByFn(r,a),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,a,o,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,o,r),i=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,r)):e=this._addAfter(new TG(t,i),s,r),e}_verifyReinsertion(e,t,i,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?e=this._reinsertAfter(s,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,s=e._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){const r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new sD),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,i=e._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new sD),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class TG{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class AG{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){const t=e._prevDup,i=e._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}class sD{constructor(){this.map=new Map}put(e){const t=e.trackById;let i=this.map.get(t);i||(i=new AG,this.map.set(t,i)),i.add(e)}get(e,t){const r=this.map.get(e);return r?r.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function oD(n,e,t){const i=n.previousIndex;if(null===i)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}class aD{constructor(){}supports(e){return e instanceof Map||g_(e)}create(){return new DG}}class DG{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||g_(e)))throw new j(900,!1)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(i,r)=>{if(t&&t.key===r)this._maybeAddToChanges(t,i),this._appendAfter=t,t=t._next;else{const s=this._getOrCreateRecordForKey(r,i);t=this._insertBeforeOrAppend(t,s)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let i=t;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const i=e._prev;return t._next=e,t._prev=i,e._prev=t,i&&(i._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const r=this._records.get(e);this._maybeAddToChanges(r,t);const s=r._prev,o=r._next;return s&&(s._next=o),o&&(o._prev=s),r._next=null,r._prev=null,r}const i=new IG(e);return this._records.set(e,i),i.currentValue=t,this._addToAdditions(i),i}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(i=>t(e[i],i))}}class IG{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function lD(){return new Af([new rD])}let Af=(()=>{class n{static#e=this.\u0275prov=Pe({token:n,providedIn:"root",factory:lD});constructor(t){this.factories=t}static create(t,i){if(null!=i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||lD()),deps:[[n,new Mh,new wh]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(null!=i)return i;throw new j(901,!1)}}return n})();function cD(){return new Nu([new aD])}let Nu=(()=>{class n{static#e=this.\u0275prov=Pe({token:n,providedIn:"root",factory:cD});constructor(t){this.factories=t}static create(t,i){if(i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||cD()),deps:[[n,new Mh,new wh]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(i)return i;throw new j(901,!1)}}return n})();const NG=$A(null,"core",[]);let LG=(()=>{class n{constructor(t){}static#e=this.\u0275fac=function(i){return new(i||n)(xe(Uo))};static#t=this.\u0275mod=jn({type:n});static#n=this.\u0275inj=Un({})}return n})();let _v=null;function Zs(){return _v}class XG{}const Yn=new Ce("DocumentToken");let vv=(()=>{class n{historyGo(t){throw new Error("Not implemented")}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Pe({token:n,factory:function(){return we(ZG)},providedIn:"platform"})}return n})();const YG=new Ce("Location Initialized");let ZG=(()=>{class n extends vv{constructor(){super(),this._doc=we(Yn),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Zs().getBaseHref(this._doc)}onPopState(t){const i=Zs().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=Zs().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,r){this._history.pushState(t,i,r)}replaceState(t,i,r){this._history.replaceState(t,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Pe({token:n,factory:function(){return new n},providedIn:"platform"})}return n})();function Ev(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function _D(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function ds(n){return n&&"?"!==n[0]?"?"+n:n}let Vo=(()=>{class n{historyGo(t){throw new Error("Not implemented")}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Pe({token:n,factory:function(){return we(ED)},providedIn:"root"})}return n})();const vD=new Ce("appBaseHref");let ED=(()=>{class n extends Vo{constructor(t,i){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??we(Yn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return Ev(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+ds(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,s){const o=this.prepareExternalUrl(r+ds(s));this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){const o=this.prepareExternalUrl(r+ds(s));this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static#e=this.\u0275fac=function(i){return new(i||n)(xe(vv),xe(vD,8))};static#t=this.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),KG=(()=>{class n extends Vo{constructor(t,i){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(t){const i=Ev(this._baseHref,t);return i.length>0?"#"+i:i}pushState(t,i,r,s){let o=this.prepareExternalUrl(r+ds(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){let o=this.prepareExternalUrl(r+ds(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static#e=this.\u0275fac=function(i){return new(i||n)(xe(vv),xe(vD,8))};static#t=this.\u0275prov=Pe({token:n,factory:n.\u0275fac})}return n})(),bv=(()=>{class n{constructor(t){this._subject=new Ut,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const i=this._locationStrategy.getBaseHref();this._basePath=function eW(n){if(new RegExp("^(https?:)?//").test(n)){const[,t]=n.split(/\/\/[^\/]+/);return t}return n}(_D(bD(i))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+ds(i))}normalize(t){return n.stripTrailingSlash(function QG(n,e){if(!n||!e.startsWith(n))return e;const t=e.substring(n.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,bD(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+ds(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+ds(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{const i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i,complete:r})}static#e=this.normalizeQueryParams=ds;static#t=this.joinWithSlash=Ev;static#n=this.stripTrailingSlash=_D;static#i=this.\u0275fac=function(i){return new(i||n)(xe(Vo))};static#r=this.\u0275prov=Pe({token:n,factory:function(){return function JG(){return new bv(xe(Vo))}()},providedIn:"root"})}return n})();function bD(n){return n.replace(/\/index.html$/,"")}function ID(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,s]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}const Rv=/\s+/,RD=[];let Pv=(()=>{class n{constructor(t,i,r,s){this._iterableDiffers=t,this._keyValueDiffers=i,this._ngEl=r,this._renderer=s,this.initialClasses=RD,this.stateMap=new Map}set klass(t){this.initialClasses=null!=t?t.trim().split(Rv):RD}set ngClass(t){this.rawClass="string"==typeof t?t.trim().split(Rv):t}ngDoCheck(){for(const i of this.initialClasses)this._updateState(i,!0);const t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(const i of t)this._updateState(i,!0);else if(null!=t)for(const i of Object.keys(t))this._updateState(i,!!t[i]);this._applyStateDiff()}_updateState(t,i){const r=this.stateMap.get(t);void 0!==r?(r.enabled!==i&&(r.changed=!0,r.enabled=i),r.touched=!0):this.stateMap.set(t,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(const t of this.stateMap){const i=t[0],r=t[1];r.changed?(this._toggleClass(i,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),r.touched=!1}}_toggleClass(t,i){(t=t.trim()).length>0&&t.split(Rv).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}static#e=this.\u0275fac=function(i){return new(i||n)(ne(Af),ne(Nu),ne(Si),ne(kr))};static#t=this.\u0275dir=Ge({type:n,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0})}return n})(),Nv=(()=>{class n{constructor(t,i){this._viewContainer=t,this._context=new HW,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){LD("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){LD("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}static#e=this.\u0275fac=function(i){return new(i||n)(ne(Er),ne(Gr))};static#t=this.\u0275dir=Ge({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}return n})();class HW{constructor(){this.$implicit=null,this.ngIf=null}}function LD(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${xn(e)}'.`)}let Fv=(()=>{class n{constructor(t,i,r){this._ngEl=t,this._differs=i,this._renderer=r,this._ngStyle=null,this._differ=null}set ngStyle(t){this._ngStyle=t,!this._differ&&t&&(this._differ=this._differs.find(t).create())}ngDoCheck(){if(this._differ){const t=this._differ.diff(this._ngStyle);t&&this._applyChanges(t)}}_setStyle(t,i){const[r,s]=t.split("."),o=-1===r.indexOf("-")?void 0:Gs.DashCase;null!=i?this._renderer.setStyle(this._ngEl.nativeElement,r,s?`${i}${s}`:i,o):this._renderer.removeStyle(this._ngEl.nativeElement,r,o)}_applyChanges(t){t.forEachRemovedItem(i=>this._setStyle(i.key,null)),t.forEachAddedItem(i=>this._setStyle(i.key,i.currentValue)),t.forEachChangedItem(i=>this._setStyle(i.key,i.currentValue))}static#e=this.\u0275fac=function(i){return new(i||n)(ne(Si),ne(Nu),ne(kr))};static#t=this.\u0275dir=Ge({type:n,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0})}return n})(),kv=(()=>{class n{constructor(t){this._viewContainerRef=t,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(t){if(t.ngTemplateOutlet||t.ngTemplateOutletInjector){const i=this._viewContainerRef;if(this._viewRef&&i.remove(i.indexOf(this._viewRef)),this.ngTemplateOutlet){const{ngTemplateOutlet:r,ngTemplateOutletContext:s,ngTemplateOutletInjector:o}=this;this._viewRef=i.createEmbeddedView(r,s,o?{injector:o}:void 0)}else this._viewRef=null}else this._viewRef&&t.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}static#e=this.\u0275fac=function(i){return new(i||n)(ne(Er))};static#t=this.\u0275dir=Ge({type:n,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[rr]})}return n})(),Fu=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=jn({type:n});static#n=this.\u0275inj=Un({})}return n})();const kD="browser";function UD(n){return"server"===n}let y5=(()=>{class n{static#e=this.\u0275prov=Pe({token:n,providedIn:"root",factory:()=>new _5(xe(Yn),window)})}return n})();class _5{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function v5(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&"function"==typeof n.body.attachShadow){const i=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const s=r.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}r=i.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.supportsScrolling()&&(this.window.history.scrollRestoration=e)}scrollToElement(e){const t=e.getBoundingClientRect(),i=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(i-s[0],r-s[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}class BD{}class z5 extends XG{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class zv extends z5{static makeCurrent(){!function qG(n){_v||(_v=n)}(new zv)}onAndCancel(e,t,i){return e.addEventListener(t,i),()=>{e.removeEventListener(t,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function G5(){return Uu=Uu||document.querySelector("base"),Uu?Uu.getAttribute("href"):null}();return null==t?null:function W5(n){zf=zf||document.createElement("a"),zf.setAttribute("href",n);const e=zf.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){Uu=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return ID(document.cookie,e)}}let zf,Uu=null,$5=(()=>{class n{build(){return new XMLHttpRequest}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Pe({token:n,factory:n.\u0275fac})}return n})();const Gv=new Ce("EventManagerPlugins");let WD=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>{r.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(s=>s.supports(t)),!i)throw new j(5101,!1);return this._eventNameToPlugin.set(t,i),i}static#e=this.\u0275fac=function(i){return new(i||n)(xe(Gv),xe(Dt))};static#t=this.\u0275prov=Pe({token:n,factory:n.\u0275fac})}return n})();class jD{constructor(e){this._doc=e}}const Wv="ng-app-id";let $D=(()=>{class n{constructor(t,i,r,s={}){this.doc=t,this.appId=i,this.nonce=r,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=UD(s),this.resetHostNodes()}addStyles(t){for(const i of t)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(t){for(const i of t)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){const t=this.styleNodesInDOM;t&&(t.forEach(i=>i.remove()),t.clear());for(const i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const i of this.getAllStyles())this.addStyleToHost(t,i)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(const i of this.hostNodes)this.addStyleToHost(i,t)}onStyleRemoved(t){const i=this.styleRef;i.get(t)?.elements?.forEach(r=>r.remove()),i.delete(t)}collectServerRenderedStyles(){const t=this.doc.head?.querySelectorAll(`style[${Wv}="${this.appId}"]`);if(t?.length){const i=new Map;return t.forEach(r=>{null!=r.textContent&&i.set(r.textContent,r)}),i}return null}changeUsageCount(t,i){const r=this.styleRef;if(r.has(t)){const s=r.get(t);return s.usage+=i,s.usage}return r.set(t,{usage:i,elements:[]}),i}getStyleElement(t,i){const r=this.styleNodesInDOM,s=r?.get(i);if(s?.parentNode===t)return r.delete(i),s.removeAttribute(Wv),s;{const o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=i,this.platformIsServer&&o.setAttribute(Wv,this.appId),o}}addStyleToHost(t,i){const r=this.getStyleElement(t,i);t.appendChild(r);const s=this.styleRef,o=s.get(i)?.elements;o?o.push(r):s.set(i,{elements:[r],usage:1})}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}static#e=this.\u0275fac=function(i){return new(i||n)(xe(Yn),xe(Wh),xe(sx,8),xe(js))};static#t=this.\u0275prov=Pe({token:n,factory:n.\u0275fac})}return n})();const jv={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},$v=/%COMP%/g,Z5=new Ce("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function XD(n,e){return e.map(t=>t.replace($v,n))}let qv=(()=>{class n{constructor(t,i,r,s,o,a,l,c=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=a,this.ngZone=l,this.nonce=c,this.rendererByCompId=new Map,this.platformIsServer=UD(a),this.defaultRenderer=new Xv(t,o,l,this.platformIsServer)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===nr.ShadowDom&&(i={...i,encapsulation:nr.Emulated});const r=this.getOrCreateRenderer(t,i);return r instanceof ZD?r.applyToHost(t):r instanceof Yv&&r.applyStyles(),r}getOrCreateRenderer(t,i){const r=this.rendererByCompId;let s=r.get(i.id);if(!s){const o=this.doc,a=this.ngZone,l=this.eventManager,c=this.sharedStylesHost,u=this.removeStylesOnCompDestroy,d=this.platformIsServer;switch(i.encapsulation){case nr.Emulated:s=new ZD(l,c,i,this.appId,u,o,a,d);break;case nr.ShadowDom:return new e8(l,c,t,i,o,a,this.nonce,d);default:s=new Yv(l,c,i,u,o,a,d)}r.set(i.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static#e=this.\u0275fac=function(i){return new(i||n)(xe(WD),xe($D),xe(Wh),xe(Z5),xe(Yn),xe(js),xe(Dt),xe(sx))};static#t=this.\u0275prov=Pe({token:n,factory:n.\u0275fac})}return n})();class Xv{constructor(e,t,i,r){this.eventManager=e,this.doc=t,this.ngZone=i,this.platformIsServer=r,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(jv[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(YD(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(YD(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?this.doc.querySelector(e):e;if(!i)throw new j(-5104,!1);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const s=jv[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=jv[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(Gs.DashCase|Gs.Important)?e.style.setProperty(t,i,r&Gs.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&Gs.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e[t]=i}setValue(e,t){e.nodeValue=t}listen(e,t,i){if("string"==typeof e&&!(e=Zs().getGlobalEventTarget(this.doc,e)))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(i))}decoratePreventDefault(e){return t=>{if("__ngUnwrap__"===t)return e;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))&&t.preventDefault()}}}function YD(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class e8 extends Xv{constructor(e,t,i,r,s,o,a,l){super(e,s,o,l),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const c=XD(r.id,r.styles);for(const u of c){const d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=u,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class Yv extends Xv{constructor(e,t,i,r,s,o,a,l){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r,this.styles=l?XD(l,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class ZD extends Yv{constructor(e,t,i,r,s,o,a,l){const c=r+"-"+i.id;super(e,t,i,s,o,a,l,c),this.contentAttr=function K5(n){return"_ngcontent-%COMP%".replace($v,n)}(c),this.hostAttr=function J5(n){return"_nghost-%COMP%".replace($v,n)}(c)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}let t8=(()=>{class n extends jD{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}static#e=this.\u0275fac=function(i){return new(i||n)(xe(Yn))};static#t=this.\u0275prov=Pe({token:n,factory:n.\u0275fac})}return n})();const KD=["alt","control","meta","shift"],n8={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},i8={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let r8=(()=>{class n extends jD{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,r){const s=n.parseEventName(i),o=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Zs().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=n._normalizeKey(i.pop());let o="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),o="code."),KD.forEach(c=>{const u=i.indexOf(c);u>-1&&(i.splice(u,1),o+=c+".")}),o+=s,0!=i.length||0===s.length)return null;const l={};return l.domEventName=r,l.fullKey=o,l}static matchEventFullKeyCode(t,i){let r=n8[t.key]||t.key,s="";return i.indexOf("code.")>-1&&(r=t.code,s="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),KD.forEach(o=>{o!==r&&(0,i8[o])(t)&&(s+=o+".")}),s+=r,s===i)}static eventCallback(t,i,r){return s=>{n.matchEventFullKeyCode(s,t)&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}static#e=this.\u0275fac=function(i){return new(i||n)(xe(Yn))};static#t=this.\u0275prov=Pe({token:n,factory:n.\u0275fac})}return n})();const l8=$A(NG,"browser",[{provide:js,useValue:kD},{provide:ix,useValue:function s8(){zv.makeCurrent()},multi:!0},{provide:Yn,useFactory:function a8(){return function GU(n){Ty=n}(document),document},deps:[]}]),c8=new Ce(""),eI=[{provide:Mf,useClass:class j5{addToWindow(e){Ft.getAngularTestability=(i,r=!0)=>{const s=e.findTestabilityInTree(i,r);if(null==s)throw new j(5103,!1);return s},Ft.getAllAngularTestabilities=()=>e.getAllTestabilities(),Ft.getAllAngularRootElements=()=>e.getAllRootElements(),Ft.frameworkStabilizers||(Ft.frameworkStabilizers=[]),Ft.frameworkStabilizers.push(i=>{const r=Ft.getAllAngularTestabilities();let s=r.length,o=!1;const a=function(l){o=o||l,s--,0==s&&i(o)};r.forEach(l=>{l.whenStable(a)})})}findTestabilityInTree(e,t,i){return null==t?null:e.getTestability(t)??(i?Zs().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:HA,useClass:av,deps:[Dt,lv,Mf]},{provide:av,useClass:av,deps:[Dt,lv,Mf]}],tI=[{provide:ky,useValue:"root"},{provide:os,useFactory:function o8(){return new os},deps:[]},{provide:Gv,useClass:t8,multi:!0,deps:[Yn,Dt,js]},{provide:Gv,useClass:r8,multi:!0,deps:[Yn]},qv,$D,WD,{provide:au,useExisting:qv},{provide:BD,useClass:$5,deps:[]},[]];let nI=(()=>{class n{constructor(t){}static withServerTransition(t){return{ngModule:n,providers:[{provide:Wh,useValue:t.appId}]}}static#e=this.\u0275fac=function(i){return new(i||n)(xe(c8,12))};static#t=this.\u0275mod=jn({type:n});static#n=this.\u0275inj=Un({providers:[...tI,...eI],imports:[Fu,LG]})}return n})(),iI=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static#e=this.\u0275fac=function(i){return new(i||n)(xe(Yn))};static#t=this.\u0275prov=Pe({token:n,factory:function(i){let r=null;return r=i?new i:function d8(){return new iI(xe(Yn))}(),r},providedIn:"root"})}return n})();typeof window<"u"&&window;class aI{}class g8{}const ps="*";function lI(n,e=null){return{type:2,steps:n,options:e}}function cI(n){return{type:6,styles:n,offset:null}}class Bu{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class uI{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,i=0,r=0;const s=this.players.length;0==s?queueMicrotask(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++t==s&&this._onFinish()}),o.onDestroy(()=>{++i==s&&this._onDestroy()}),o.onStart(()=>{++r==s&&this._onStart()})}),this.totalTime=this.players.reduce((o,a)=>Math.max(o,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,t/i.totalTime):1;i.setPosition(r)})}getPosition(){const e=this.players.reduce((t,i)=>null===t||i.totalTime>t.totalTime?i:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}function dI(n){return new j(3e3,!1)}function Js(n){switch(n.length){case 0:return new Bu;case 1:return n[0];default:return new uI(n)}}function hI(n,e,t=new Map,i=new Map){const r=[],s=[];let o=-1,a=null;if(e.forEach(l=>{const c=l.get("offset"),u=c==o,d=u&&a||new Map;l.forEach((h,f)=>{let p=f,y=h;if("offset"!==f)switch(p=n.normalizePropertyName(p,r),y){case"!":y=t.get(f);break;case ps:y=i.get(f);break;default:y=n.normalizeStyleValue(f,p,y,r)}d.set(p,y)}),u||s.push(d),a=d,o=c}),r.length)throw function B8(n){return new j(3502,!1)}();return s}function Jv(n,e,t,i){switch(e){case"start":n.onStart(()=>i(t&&Qv(t,"start",n)));break;case"done":n.onDone(()=>i(t&&Qv(t,"done",n)));break;case"destroy":n.onDestroy(()=>i(t&&Qv(t,"destroy",n)))}}function Qv(n,e,t){const s=e0(n.element,n.triggerName,n.fromState,n.toState,e||n.phaseName,t.totalTime??n.totalTime,!!t.disabled),o=n._data;return null!=o&&(s._data=o),s}function e0(n,e,t,i,r="",s=0,o){return{element:n,triggerName:e,fromState:t,toState:i,phaseName:r,totalTime:s,disabled:!!o}}function Gi(n,e,t){let i=n.get(e);return i||n.set(e,i=t),i}function fI(n){const e=n.indexOf(":");return[n.substring(1,e),n.slice(e+1)]}const K8=(()=>typeof document>"u"?null:document.documentElement)();function t0(n){const e=n.parentNode||n.host||null;return e===K8?null:e}let Ho=null,pI=!1;function mI(n,e){for(;e;){if(e===n)return!0;e=t0(e)}return!1}function gI(n,e,t){if(t)return Array.from(n.querySelectorAll(e));const i=n.querySelector(e);return i?[i]:[]}let yI=(()=>{class n{validateStyleProperty(t){return function Q8(n){Ho||(Ho=function ej(){return typeof document<"u"?document.body:null}()||{},pI=!!Ho.style&&"WebkitAppearance"in Ho.style);let e=!0;return Ho.style&&!function J8(n){return"ebkit"==n.substring(1,6)}(n)&&(e=n in Ho.style,!e&&pI&&(e="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in Ho.style)),e}(t)}matchesElement(t,i){return!1}containsElement(t,i){return mI(t,i)}getParentElement(t){return t0(t)}query(t,i,r){return gI(t,i,r)}computeStyle(t,i,r){return r||""}animate(t,i,r,s,o,a=[],l){return new Bu(r,s)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Pe({token:n,factory:n.\u0275fac})}return n})(),n0=(()=>{class n{static#e=this.NOOP=new yI}return n})();const tj=1e3,r0="ng-enter",Gf="ng-leave",Wf="ng-trigger",jf=".ng-trigger",vI="ng-animating",s0=".ng-animating";function ms(n){if("number"==typeof n)return n;const e=n.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:o0(parseFloat(e[1]),e[2])}function o0(n,e){return"s"===e?n*tj:n}function $f(n,e,t){return n.hasOwnProperty("duration")?n:function ij(n,e,t){let r,s=0,o="";if("string"==typeof n){const a=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return e.push(dI()),{duration:0,delay:0,easing:""};r=o0(parseFloat(a[1]),a[2]);const l=a[3];null!=l&&(s=o0(parseFloat(l),a[4]));const c=a[5];c&&(o=c)}else r=n;if(!t){let a=!1,l=e.length;r<0&&(e.push(function y8(){return new j(3100,!1)}()),a=!0),s<0&&(e.push(function _8(){return new j(3101,!1)}()),a=!0),a&&e.splice(l,0,dI())}return{duration:r,delay:s,easing:o}}(n,e,t)}function Vu(n,e={}){return Object.keys(n).forEach(t=>{e[t]=n[t]}),e}function EI(n){const e=new Map;return Object.keys(n).forEach(t=>{e.set(t,n[t])}),e}function Qs(n,e=new Map,t){if(t)for(let[i,r]of t)e.set(i,r);for(let[i,r]of n)e.set(i,r);return e}function Wr(n,e,t){e.forEach((i,r)=>{const s=l0(r);t&&!t.has(r)&&t.set(r,n.style[s]),n.style[s]=i})}function zo(n,e){e.forEach((t,i)=>{const r=l0(i);n.style[r]=""})}function Hu(n){return Array.isArray(n)?1==n.length?n[0]:lI(n):n}const a0=new RegExp("{{\\s*(.+?)\\s*}}","g");function SI(n){let e=[];if("string"==typeof n){let t;for(;t=a0.exec(n);)e.push(t[1]);a0.lastIndex=0}return e}function zu(n,e,t){const i=n.toString(),r=i.replace(a0,(s,o)=>{let a=e[o];return null==a&&(t.push(function E8(n){return new j(3003,!1)}()),a=""),a.toString()});return r==i?n:r}function qf(n){const e=[];let t=n.next();for(;!t.done;)e.push(t.value),t=n.next();return e}const oj=/-+([a-z0-9])/g;function l0(n){return n.replace(oj,(...e)=>e[1].toUpperCase())}function Wi(n,e,t){switch(e.type){case 7:return n.visitTrigger(e,t);case 0:return n.visitState(e,t);case 1:return n.visitTransition(e,t);case 2:return n.visitSequence(e,t);case 3:return n.visitGroup(e,t);case 4:return n.visitAnimate(e,t);case 5:return n.visitKeyframes(e,t);case 6:return n.visitStyle(e,t);case 8:return n.visitReference(e,t);case 9:return n.visitAnimateChild(e,t);case 10:return n.visitAnimateRef(e,t);case 11:return n.visitQuery(e,t);case 12:return n.visitStagger(e,t);default:throw function b8(n){return new j(3004,!1)}()}}function wI(n,e){return window.getComputedStyle(n)[e]}const Xf="*";function cj(n,e){const t=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(i=>function uj(n,e,t){if(":"==n[0]){const l=function dj(n,e){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,i)=>parseFloat(i)>parseFloat(t);case":decrement":return(t,i)=>parseFloat(i)<parseFloat(t);default:return e.push(function O8(n){return new j(3016,!1)}()),"* => *"}}(n,t);if("function"==typeof l)return void e.push(l);n=l}const i=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return t.push(function L8(n){return new j(3015,!1)}()),e;const r=i[1],s=i[2],o=i[3];e.push(MI(r,o));"<"==s[0]&&!(r==Xf&&o==Xf)&&e.push(MI(o,r))}(i,t,e)):t.push(n),t}const Yf=new Set(["true","1"]),Zf=new Set(["false","0"]);function MI(n,e){const t=Yf.has(n)||Zf.has(n),i=Yf.has(e)||Zf.has(e);return(r,s)=>{let o=n==Xf||n==r,a=e==Xf||e==s;return!o&&t&&"boolean"==typeof r&&(o=r?Yf.has(n):Zf.has(n)),!a&&i&&"boolean"==typeof s&&(a=s?Yf.has(e):Zf.has(e)),o&&a}}const hj=new RegExp("s*:selfs*,?","g");function c0(n,e,t,i){return new fj(n).build(e,t,i)}class fj{constructor(e){this._driver=e}build(e,t,i){const r=new gj(t);return this._resetContextStyleTimingState(r),Wi(this,Hu(e),r)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles=new Map,e.collectedStyles.set("",new Map),e.currentTime=0}visitTrigger(e,t){let i=t.queryCount=0,r=t.depCount=0;const s=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push(function w8(){return new j(3006,!1)}()),e.definitions.forEach(a=>{if(this._resetContextStyleTimingState(t),0==a.type){const l=a,c=l.name;c.toString().split(/\s*,\s*/).forEach(u=>{l.name=u,s.push(this.visitState(l,t))}),l.name=c}else if(1==a.type){const l=this.visitTransition(a,t);i+=l.queryCount,r+=l.depCount,o.push(l)}else t.errors.push(function M8(){return new j(3007,!1)}())}),{type:7,name:e.name,states:s,transitions:o,queryCount:i,depCount:r,options:null}}visitState(e,t){const i=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(i.containsDynamicStyles){const s=new Set,o=r||{};i.styles.forEach(a=>{a instanceof Map&&a.forEach(l=>{SI(l).forEach(c=>{o.hasOwnProperty(c)||s.add(c)})})}),s.size&&(qf(s.values()),t.errors.push(function x8(n,e){return new j(3008,!1)}()))}return{type:0,name:e.name,style:i,options:r?{params:r}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const i=Wi(this,Hu(e.animation),t);return{type:1,matchers:cj(e.expr,t.errors),animation:i,queryCount:t.queryCount,depCount:t.depCount,options:Go(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(i=>Wi(this,i,t)),options:Go(e.options)}}visitGroup(e,t){const i=t.currentTime;let r=0;const s=e.steps.map(o=>{t.currentTime=i;const a=Wi(this,o,t);return r=Math.max(r,t.currentTime),a});return t.currentTime=r,{type:3,steps:s,options:Go(e.options)}}visitAnimate(e,t){const i=function _j(n,e){if(n.hasOwnProperty("duration"))return n;if("number"==typeof n)return u0($f(n,e).duration,0,"");const t=n;if(t.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=u0(0,0,"");return s.dynamic=!0,s.strValue=t,s}const r=$f(t,e);return u0(r.duration,r.delay,r.easing)}(e.timings,t.errors);t.currentAnimateTimings=i;let r,s=e.styles?e.styles:cI({});if(5==s.type)r=this.visitKeyframes(s,t);else{let o=e.styles,a=!1;if(!o){a=!0;const c={};i.easing&&(c.easing=i.easing),o=cI(c)}t.currentTime+=i.duration+i.delay;const l=this.visitStyle(o,t);l.isEmptyStep=a,r=l}return t.currentAnimateTimings=null,{type:4,timings:i,style:r,options:null}}visitStyle(e,t){const i=this._makeStyleAst(e,t);return this._validateStyleAst(i,t),i}_makeStyleAst(e,t){const i=[],r=Array.isArray(e.styles)?e.styles:[e.styles];for(let a of r)"string"==typeof a?a===ps?i.push(a):t.errors.push(new j(3002,!1)):i.push(EI(a));let s=!1,o=null;return i.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(o=a.get("easing"),a.delete("easing")),!s))for(let l of a.values())if(l.toString().indexOf("{{")>=0){s=!0;break}}),{type:6,styles:i,easing:o,offset:e.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(e,t){const i=t.currentAnimateTimings;let r=t.currentTime,s=t.currentTime;i&&s>0&&(s-=i.duration+i.delay),e.styles.forEach(o=>{"string"!=typeof o&&o.forEach((a,l)=>{const c=t.collectedStyles.get(t.currentQuerySelector),u=c.get(l);let d=!0;u&&(s!=r&&s>=u.startTime&&r<=u.endTime&&(t.errors.push(function T8(n,e,t,i,r){return new j(3010,!1)}()),d=!1),s=u.startTime),d&&c.set(l,{startTime:s,endTime:r}),t.options&&function sj(n,e,t){const i=e.params||{},r=SI(n);r.length&&r.forEach(s=>{i.hasOwnProperty(s)||t.push(function v8(n){return new j(3001,!1)}())})}(a,t.options,t.errors)})})}visitKeyframes(e,t){const i={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function A8(){return new j(3011,!1)}()),i;let s=0;const o=[];let a=!1,l=!1,c=0;const u=e.steps.map(m=>{const v=this._makeStyleAst(m,t);let _=null!=v.offset?v.offset:function yj(n){if("string"==typeof n)return null;let e=null;if(Array.isArray(n))n.forEach(t=>{if(t instanceof Map&&t.has("offset")){const i=t;e=parseFloat(i.get("offset")),i.delete("offset")}});else if(n instanceof Map&&n.has("offset")){const t=n;e=parseFloat(t.get("offset")),t.delete("offset")}return e}(v.styles),E=0;return null!=_&&(s++,E=v.offset=_),l=l||E<0||E>1,a=a||E<c,c=E,o.push(E),v});l&&t.errors.push(function D8(){return new j(3012,!1)}()),a&&t.errors.push(function I8(){return new j(3200,!1)}());const d=e.steps.length;let h=0;s>0&&s<d?t.errors.push(function R8(){return new j(3202,!1)}()):0==s&&(h=1/(d-1));const f=d-1,p=t.currentTime,y=t.currentAnimateTimings,g=y.duration;return u.forEach((m,v)=>{const _=h>0?v==f?1:h*v:o[v],E=_*g;t.currentTime=p+y.delay+E,y.duration=E,this._validateStyleAst(m,t),m.offset=_,i.styles.push(m)}),i}visitReference(e,t){return{type:8,animation:Wi(this,Hu(e.animation),t),options:Go(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:Go(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:Go(e.options)}}visitQuery(e,t){const i=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;const[s,o]=function pj(n){const e=!!n.split(/\s*,\s*/).find(t=>":self"==t);return e&&(n=n.replace(hj,"")),n=n.replace(/@\*/g,jf).replace(/@\w+/g,t=>jf+"-"+t.slice(1)).replace(/:animating/g,s0),[n,e]}(e.selector);t.currentQuerySelector=i.length?i+" "+s:s,Gi(t.collectedStyles,t.currentQuerySelector,new Map);const a=Wi(this,Hu(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=i,{type:11,selector:s,limit:r.limit||0,optional:!!r.optional,includeSelf:o,animation:a,originalSelector:e.selector,options:Go(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function P8(){return new j(3013,!1)}());const i="full"===e.timings?{duration:0,delay:0,easing:"full"}:$f(e.timings,t.errors,!0);return{type:12,animation:Wi(this,Hu(e.animation),t),timings:i,options:null}}}class gj{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function Go(n){return n?(n=Vu(n)).params&&(n.params=function mj(n){return n?Vu(n):null}(n.params)):n={},n}function u0(n,e,t){return{duration:n,delay:e,easing:t}}function d0(n,e,t,i,r,s,o=null,a=!1){return{type:1,element:n,keyframes:e,preStyleProps:t,postStyleProps:i,duration:r,delay:s,totalTime:r+s,easing:o,subTimeline:a}}class Kf{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let i=this._map.get(e);i||this._map.set(e,i=[]),i.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const bj=new RegExp(":enter","g"),wj=new RegExp(":leave","g");function h0(n,e,t,i,r,s=new Map,o=new Map,a,l,c=[]){return(new Mj).buildKeyframes(n,e,t,i,r,s,o,a,l,c)}class Mj{buildKeyframes(e,t,i,r,s,o,a,l,c,u=[]){c=c||new Kf;const d=new f0(e,t,c,r,s,u,[]);d.options=l;const h=l.delay?ms(l.delay):0;d.currentTimeline.delayNextStep(h),d.currentTimeline.setStyles([o],null,d.errors,l),Wi(this,i,d);const f=d.timelines.filter(p=>p.containsAnimation());if(f.length&&a.size){let p;for(let y=f.length-1;y>=0;y--){const g=f[y];if(g.element===t){p=g;break}}p&&!p.allowOnlyTimelineStyles()&&p.setStyles([a],null,d.errors,l)}return f.length?f.map(p=>p.buildKeyframes()):[d0(t,[],[],[],0,h,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const i=t.subInstructions.get(t.element);if(i){const r=t.createSubContext(e.options),s=t.currentTimeline.currentTime,o=this._visitSubInstructions(i,r,r.options);s!=o&&t.transformIntoNewTimeline(o)}t.previousNode=e}visitAnimateRef(e,t){const i=t.createSubContext(e.options);i.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],t,i),this.visitReference(e.animation,i),t.transformIntoNewTimeline(i.currentTimeline.currentTime),t.previousNode=e}_applyAnimationRefDelays(e,t,i){for(const r of e){const s=r?.delay;if(s){const o="number"==typeof s?s:ms(zu(s,r?.params??{},t.errors));i.delayNextStep(o)}}}_visitSubInstructions(e,t,i){let s=t.currentTimeline.currentTime;const o=null!=i.duration?ms(i.duration):null,a=null!=i.delay?ms(i.delay):null;return 0!==o&&e.forEach(l=>{const c=t.appendInstructionToTimeline(l,o,a);s=Math.max(s,c.duration+c.delay)}),s}visitReference(e,t){t.updateOptions(e.options,!0),Wi(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const i=t.subContextCount;let r=t;const s=e.options;if(s&&(s.params||s.delay)&&(r=t.createSubContext(s),r.transformIntoNewTimeline(),null!=s.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=Jf);const o=ms(s.delay);r.delayNextStep(o)}e.steps.length&&(e.steps.forEach(o=>Wi(this,o,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const i=[];let r=t.currentTimeline.currentTime;const s=e.options&&e.options.delay?ms(e.options.delay):0;e.steps.forEach(o=>{const a=t.createSubContext(e.options);s&&a.delayNextStep(s),Wi(this,o,a),r=Math.max(r,a.currentTimeline.currentTime),i.push(a.currentTimeline)}),i.forEach(o=>t.currentTimeline.mergeTimelineCollectedStyles(o)),t.transformIntoNewTimeline(r),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const i=e.strValue;return $f(t.params?zu(i,t.params,t.errors):i,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const i=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;i.delay&&(t.incrementTime(i.delay),r.snapshotCurrentStyles());const s=e.style;5==s.type?this.visitKeyframes(s,t):(t.incrementTime(i.duration),this.visitStyle(s,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const i=t.currentTimeline,r=t.currentAnimateTimings;!r&&i.hasCurrentStyleProperties()&&i.forwardFrame();const s=r&&r.easing||e.easing;e.isEmptyStep?i.applyEmptyStep(s):i.setStyles(e.styles,s,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const i=t.currentAnimateTimings,r=t.currentTimeline.duration,s=i.duration,a=t.createSubContext().currentTimeline;a.easing=i.easing,e.styles.forEach(l=>{a.forwardTime((l.offset||0)*s),a.setStyles(l.styles,l.easing,t.errors,t.options),a.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(r+s),t.previousNode=e}visitQuery(e,t){const i=t.currentTimeline.currentTime,r=e.options||{},s=r.delay?ms(r.delay):0;s&&(6===t.previousNode.type||0==i&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=Jf);let o=i;const a=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!r.optional,t.errors);t.currentQueryTotal=a.length;let l=null;a.forEach((c,u)=>{t.currentQueryIndex=u;const d=t.createSubContext(e.options,c);s&&d.delayNextStep(s),c===t.element&&(l=d.currentTimeline),Wi(this,e.animation,d),d.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,d.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),l&&(t.currentTimeline.mergeTimelineCollectedStyles(l),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const i=t.parentContext,r=t.currentTimeline,s=e.timings,o=Math.abs(s.duration),a=o*(t.currentQueryTotal-1);let l=o*t.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":l=a-l;break;case"full":l=i.currentStaggerTime}const u=t.currentTimeline;l&&u.delayNextStep(l);const d=u.currentTime;Wi(this,e.animation,t),t.previousNode=e,i.currentStaggerTime=r.currentTime-d+(r.startTime-i.currentTimeline.startTime)}}const Jf={};class f0{constructor(e,t,i,r,s,o,a,l){this._driver=e,this.element=t,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=s,this.errors=o,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Jf,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=l||new Qf(this._driver,t,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const i=e;let r=this.options;null!=i.duration&&(r.duration=ms(i.duration)),null!=i.delay&&(r.delay=ms(i.delay));const s=i.params;if(s){let o=r.params;o||(o=this.options.params={}),Object.keys(s).forEach(a=>{(!t||!o.hasOwnProperty(a))&&(o[a]=zu(s[a],o,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const i=e.params={};Object.keys(t).forEach(r=>{i[r]=t[r]})}}return e}createSubContext(e=null,t,i){const r=t||this.element,s=new f0(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(e),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(e){return this.previousNode=Jf,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,i){const r={duration:t??e.duration,delay:this.currentTimeline.currentTime+(i??0)+e.delay,easing:""},s=new xj(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(s),r}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,i,r,s,o){let a=[];if(r&&a.push(this.element),e.length>0){e=(e=e.replace(bj,"."+this._enterClassName)).replace(wj,"."+this._leaveClassName);let c=this._driver.query(this.element,e,1!=i);0!==i&&(c=i<0?c.slice(c.length+i,c.length):c.slice(0,i)),a.push(...c)}return!s&&0==a.length&&o.push(function N8(n){return new j(3014,!1)}()),a}}class Qf{constructor(e,t,i,r){this._driver=e,this.element=t,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new Qf(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,i]of this._globalTimelineStyles)this._backFill.set(t,i||ps),this._currentKeyframe.set(t,ps);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,i,r){t&&this._previousKeyframe.set("easing",t);const s=r&&r.params||{},o=function Cj(n,e){const t=new Map;let i;return n.forEach(r=>{if("*"===r){i=i||e.keys();for(let s of i)t.set(s,ps)}else Qs(r,t)}),t}(e,this._globalTimelineStyles);for(let[a,l]of o){const c=zu(l,s,i);this._pendingStyles.set(a,c),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??ps),this._updateStyle(a,c)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,i)=>{const r=this._styleSummary.get(i);(!r||t.time>r.time)&&this._updateStyle(i,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((a,l)=>{const c=Qs(a,new Map,this._backFill);c.forEach((u,d)=>{"!"===u?e.add(d):u===ps&&t.add(d)}),i||c.set("offset",l/this.duration),r.push(c)});const s=e.size?qf(e.values()):[],o=t.size?qf(t.values()):[];if(i){const a=r[0],l=new Map(a);a.set("offset",0),l.set("offset",1),r=[a,l]}return d0(this.element,r,s,o,this.duration,this.startTime,this.easing,!1)}}class xj extends Qf{constructor(e,t,i,r,s,o,a=!1){super(e,t,o.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=s,this._stretchStartingKeyframe=a,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&t){const s=[],o=i+t,a=t/o,l=Qs(e[0]);l.set("offset",0),s.push(l);const c=Qs(e[0]);c.set("offset",TI(a)),s.push(c);const u=e.length-1;for(let d=1;d<=u;d++){let h=Qs(e[d]);const f=h.get("offset");h.set("offset",TI((t+f*i)/o)),s.push(h)}i=o,t=0,r="",e=s}return d0(this.element,e,this.preStyleProps,this.postStyleProps,i,t,r,!0)}}function TI(n,e=3){const t=Math.pow(10,e-1);return Math.round(n*t)/t}class p0{}const Tj=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class Aj extends p0{normalizePropertyName(e,t){return l0(e)}normalizeStyleValue(e,t,i,r){let s="";const o=i.toString().trim();if(Tj.has(t)&&0!==i&&"0"!==i)if("number"==typeof i)s="px";else{const a=i.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&r.push(function S8(n,e){return new j(3005,!1)}())}return o+s}}function AI(n,e,t,i,r,s,o,a,l,c,u,d,h){return{type:0,element:n,triggerName:e,isRemovalTransition:r,fromState:t,fromStyles:s,toState:i,toStyles:o,timelines:a,queriedElements:l,preStyleProps:c,postStyleProps:u,totalTime:d,errors:h}}const m0={};class DI{constructor(e,t,i){this._triggerName=e,this.ast=t,this._stateStyles=i}match(e,t,i,r){return function Dj(n,e,t,i,r){return n.some(s=>s(e,t,i,r))}(this.ast.matchers,e,t,i,r)}buildStyles(e,t,i){let r=this._stateStyles.get("*");return void 0!==e&&(r=this._stateStyles.get(e?.toString())||r),r?r.buildStyles(t,i):new Map}build(e,t,i,r,s,o,a,l,c,u){const d=[],h=this.ast.options&&this.ast.options.params||m0,p=this.buildStyles(i,a&&a.params||m0,d),y=l&&l.params||m0,g=this.buildStyles(r,y,d),m=new Set,v=new Map,_=new Map,E="void"===r,S={params:Ij(y,h),delay:this.ast.options?.delay},x=u?[]:h0(e,t,this.ast.animation,s,o,p,g,S,c,d);let M=0;if(x.forEach(b=>{M=Math.max(b.duration+b.delay,M)}),d.length)return AI(t,this._triggerName,i,r,E,p,g,[],[],v,_,M,d);x.forEach(b=>{const C=b.element,U=Gi(v,C,new Set);b.preStyleProps.forEach(ee=>U.add(ee));const Y=Gi(_,C,new Set);b.postStyleProps.forEach(ee=>Y.add(ee)),C!==t&&m.add(C)});const R=qf(m.values());return AI(t,this._triggerName,i,r,E,p,g,x,R,v,_,M)}}function Ij(n,e){const t=Vu(e);for(const i in n)n.hasOwnProperty(i)&&null!=n[i]&&(t[i]=n[i]);return t}class Rj{constructor(e,t,i){this.styles=e,this.defaultParams=t,this.normalizer=i}buildStyles(e,t){const i=new Map,r=Vu(this.defaultParams);return Object.keys(e).forEach(s=>{const o=e[s];null!==o&&(r[s]=o)}),this.styles.styles.forEach(s=>{"string"!=typeof s&&s.forEach((o,a)=>{o&&(o=zu(o,r,t));const l=this.normalizer.normalizePropertyName(a,t);o=this.normalizer.normalizeStyleValue(a,l,o,t),i.set(a,o)})}),i}}class Nj{constructor(e,t,i){this.name=e,this.ast=t,this._normalizer=i,this.transitionFactories=[],this.states=new Map,t.states.forEach(r=>{this.states.set(r.name,new Rj(r.style,r.options&&r.options.params||{},i))}),II(this.states,"true","1"),II(this.states,"false","0"),t.transitions.forEach(r=>{this.transitionFactories.push(new DI(e,r,this.states))}),this.fallbackTransition=function Lj(n,e,t){return new DI(n,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,a)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,i,r){return this.transitionFactories.find(o=>o.match(e,t,i,r))||null}matchStyles(e,t,i){return this.fallbackTransition.buildStyles(e,t,i)}}function II(n,e,t){n.has(e)?n.has(t)||n.set(t,n.get(e)):n.has(t)&&n.set(e,n.get(t))}const Oj=new Kf;class Fj{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,t){const i=[],s=c0(this._driver,t,i,[]);if(i.length)throw function V8(n){return new j(3503,!1)}();this._animations.set(e,s)}_buildPlayer(e,t,i){const r=e.element,s=hI(this._normalizer,e.keyframes,t,i);return this._driver.animate(r,s,e.duration,e.delay,e.easing,[],!0)}create(e,t,i={}){const r=[],s=this._animations.get(e);let o;const a=new Map;if(s?(o=h0(this._driver,t,s,r0,Gf,new Map,new Map,i,Oj,r),o.forEach(u=>{const d=Gi(a,u.element,new Map);u.postStyleProps.forEach(h=>d.set(h,null))})):(r.push(function H8(){return new j(3300,!1)}()),o=[]),r.length)throw function z8(n){return new j(3504,!1)}();a.forEach((u,d)=>{u.forEach((h,f)=>{u.set(f,this._driver.computeStyle(d,f,ps))})});const c=Js(o.map(u=>{const d=a.get(u.element);return this._buildPlayer(u,new Map,d)}));return this._playersById.set(e,c),c.onDestroy(()=>this.destroy(e)),this.players.push(c),c}destroy(e){const t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);const i=this.players.indexOf(t);i>=0&&this.players.splice(i,1)}_getPlayer(e){const t=this._playersById.get(e);if(!t)throw function G8(n){return new j(3301,!1)}();return t}listen(e,t,i,r){const s=e0(t,"","","");return Jv(this._getPlayer(e),i,s,r),()=>{}}command(e,t,i,r){if("register"==i)return void this.register(e,r[0]);if("create"==i)return void this.create(e,t,r[0]||{});const s=this._getPlayer(e);switch(i){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}}const RI="ng-animate-queued",g0="ng-animate-disabled",Hj=[],PI={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},zj={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},wr="__ng_removed";class y0{get params(){return this.options.params}constructor(e,t=""){this.namespaceId=t;const i=e&&e.hasOwnProperty("value");if(this.value=function $j(n){return n??null}(i?e.value:e),i){const s=Vu(e);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){const t=e.params;if(t){const i=this.options.params;Object.keys(t).forEach(r=>{null==i[r]&&(i[r]=t[r])})}}}const Gu="void",_0=new y0(Gu);class Gj{constructor(e,t,i){this.id=e,this.hostElement=t,this._engine=i,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,cr(t,this._hostClassName)}listen(e,t,i,r){if(!this._triggers.has(t))throw function W8(n,e){return new j(3302,!1)}();if(null==i||0==i.length)throw function j8(n){return new j(3303,!1)}();if(!function qj(n){return"start"==n||"done"==n}(i))throw function $8(n,e){return new j(3400,!1)}();const s=Gi(this._elementListeners,e,[]),o={name:t,phase:i,callback:r};s.push(o);const a=Gi(this._engine.statesByElement,e,new Map);return a.has(t)||(cr(e,Wf),cr(e,Wf+"-"+t),a.set(t,_0)),()=>{this._engine.afterFlush(()=>{const l=s.indexOf(o);l>=0&&s.splice(l,1),this._triggers.has(t)||a.delete(t)})}}register(e,t){return!this._triggers.has(e)&&(this._triggers.set(e,t),!0)}_getTrigger(e){const t=this._triggers.get(e);if(!t)throw function q8(n){return new j(3401,!1)}();return t}trigger(e,t,i,r=!0){const s=this._getTrigger(t),o=new v0(this.id,t,e);let a=this._engine.statesByElement.get(e);a||(cr(e,Wf),cr(e,Wf+"-"+t),this._engine.statesByElement.set(e,a=new Map));let l=a.get(t);const c=new y0(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&l&&c.absorbOptions(l.options),a.set(t,c),l||(l=_0),c.value!==Gu&&l.value===c.value){if(!function Zj(n,e){const t=Object.keys(n),i=Object.keys(e);if(t.length!=i.length)return!1;for(let r=0;r<t.length;r++){const s=t[r];if(!e.hasOwnProperty(s)||n[s]!==e[s])return!1}return!0}(l.params,c.params)){const y=[],g=s.matchStyles(l.value,l.params,y),m=s.matchStyles(c.value,c.params,y);y.length?this._engine.reportError(y):this._engine.afterFlush(()=>{zo(e,g),Wr(e,m)})}return}const h=Gi(this._engine.playersByElement,e,[]);h.forEach(y=>{y.namespaceId==this.id&&y.triggerName==t&&y.queued&&y.destroy()});let f=s.matchTransition(l.value,c.value,e,c.params),p=!1;if(!f){if(!r)return;f=s.fallbackTransition,p=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:f,fromState:l,toState:c,player:o,isFallbackTransition:p}),p||(cr(e,RI),o.onStart(()=>{El(e,RI)})),o.onDone(()=>{let y=this.players.indexOf(o);y>=0&&this.players.splice(y,1);const g=this._engine.playersByElement.get(e);if(g){let m=g.indexOf(o);m>=0&&g.splice(m,1)}}),this.players.push(o),h.push(o),o}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,i)=>{this._elementListeners.set(i,t.filter(r=>r.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(i=>i.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const i=this._engine.driver.query(e,jf,!0);i.forEach(r=>{if(r[wr])return;const s=this._engine.fetchNamespacesByElement(r);s.size?s.forEach(o=>o.triggerLeaveAnimation(r,t,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(e,t,i,r){const s=this._engine.statesByElement.get(e),o=new Map;if(s){const a=[];if(s.forEach((l,c)=>{if(o.set(c,l.value),this._triggers.has(c)){const u=this.trigger(e,c,Gu,r);u&&a.push(u)}}),a.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,o),i&&Js(a).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),i=this._engine.statesByElement.get(e);if(t&&i){const r=new Set;t.forEach(s=>{const o=s.name;if(r.has(o))return;r.add(o);const l=this._triggers.get(o).fallbackTransition,c=i.get(o)||_0,u=new y0(Gu),d=new v0(this.id,o,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:o,transition:l,fromState:c,toState:u,player:d,isFallbackTransition:!0})})}}removeNode(e,t){const i=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let r=!1;if(i.totalAnimations){const s=i.players.length?i.playersByQueriedElement.get(e):[];if(s&&s.length)r=!0;else{let o=e;for(;o=o.parentNode;)if(i.statesByElement.get(o)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(e),r)i.markElementAsRemoved(this.id,e,!1,t);else{const s=e[wr];(!s||s===PI)&&(i.afterFlush(()=>this.clearElementCache(e)),i.destroyInnerAnimations(e),i._onRemovalComplete(e,t))}}insertNode(e,t){cr(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const s=i.element,o=this._elementListeners.get(s);o&&o.forEach(a=>{if(a.name==i.triggerName){const l=e0(s,i.triggerName,i.fromState.value,i.toState.value);l._data=e,Jv(i.player,a.phase,l,a.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):t.push(i)}),this._queue=[],t.sort((i,r)=>{const s=i.transition.ast.depCount,o=r.transition.ast.depCount;return 0==s||0==o?s-o:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}}class Wj{_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}constructor(e,t,i){this.bodyNode=e,this.driver=t,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,s)=>{}}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(i=>{i.queued&&e.push(i)})}),e}createNamespace(e,t){const i=new Gj(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(i,t):(this.newHostElements.set(t,i),this.collectEnterElement(t)),this._namespaceLookup[e]=i}_balanceNamespaceList(e,t){const i=this._namespaceList,r=this.namespacesByHostElement;if(i.length-1>=0){let o=!1,a=this.driver.getParentElement(t);for(;a;){const l=r.get(a);if(l){const c=i.indexOf(l);i.splice(c+1,0,e),o=!0;break}a=this.driver.getParentElement(a)}o||i.unshift(e)}else i.push(e);return r.set(t,e),e}register(e,t){let i=this._namespaceLookup[e];return i||(i=this.createNamespace(e,t)),i}registerTrigger(e,t,i){let r=this._namespaceLookup[e];r&&r.register(t,i)&&this.totalAnimations++}destroy(e,t){e&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const i=this._fetchNamespace(e);this.namespacesByHostElement.delete(i.hostElement);const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1),i.destroy(t),delete this._namespaceLookup[e]}))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,i=this.statesByElement.get(e);if(i)for(let r of i.values())if(r.namespaceId){const s=this._fetchNamespace(r.namespaceId);s&&t.add(s)}return t}trigger(e,t,i,r){if(ep(t)){const s=this._fetchNamespace(e);if(s)return s.trigger(t,i,r),!0}return!1}insertNode(e,t,i,r){if(!ep(t))return;const s=t[wr];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const o=this.collectedLeaveElements.indexOf(t);o>=0&&this.collectedLeaveElements.splice(o,1)}if(e){const o=this._fetchNamespace(e);o&&o.insertNode(t,i)}r&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),cr(e,g0)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),El(e,g0))}removeNode(e,t,i){if(ep(t)){const r=e?this._fetchNamespace(e):null;r?r.removeNode(t,i):this.markElementAsRemoved(e,t,!1,i);const s=this.namespacesByHostElement.get(t);s&&s.id!==e&&s.removeNode(t,i)}else this._onRemovalComplete(t,i)}markElementAsRemoved(e,t,i,r,s){this.collectedLeaveElements.push(t),t[wr]={namespaceId:e,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:s}}listen(e,t,i,r,s){return ep(t)?this._fetchNamespace(e).listen(t,i,r,s):()=>{}}_buildInstruction(e,t,i,r,s){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,i,r,e.fromState.options,e.toState.options,t,s)}destroyInnerAnimations(e){let t=this.driver.query(e,jf,!0);t.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,s0,!0),t.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return Js(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e[wr];if(t&&t.setForRemoval){if(e[wr]=PI,t.namespaceId){this.destroyInnerAnimations(e);const i=this._fetchNamespace(t.namespaceId);i&&i.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(g0)&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)cr(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{t=this._flushAnimations(i,e)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],t.length?Js(t).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(e){throw function X8(n){return new j(3402,!1)}()}_flushAnimations(e,t){const i=new Kf,r=[],s=new Map,o=[],a=new Map,l=new Map,c=new Map,u=new Set;this.disabledNodes.forEach(F=>{u.add(F);const k=this.driver.query(F,".ng-animate-queued",!0);for(let W=0;W<k.length;W++)u.add(k[W])});const d=this.bodyNode,h=Array.from(this.statesByElement.keys()),f=OI(h,this.collectedEnterElements),p=new Map;let y=0;f.forEach((F,k)=>{const W=r0+y++;p.set(k,W),F.forEach(V=>cr(V,W))});const g=[],m=new Set,v=new Set;for(let F=0;F<this.collectedLeaveElements.length;F++){const k=this.collectedLeaveElements[F],W=k[wr];W&&W.setForRemoval&&(g.push(k),m.add(k),W.hasAnimation?this.driver.query(k,".ng-star-inserted",!0).forEach(V=>m.add(V)):v.add(k))}const _=new Map,E=OI(h,Array.from(m));E.forEach((F,k)=>{const W=Gf+y++;_.set(k,W),F.forEach(V=>cr(V,W))}),e.push(()=>{f.forEach((F,k)=>{const W=p.get(k);F.forEach(V=>El(V,W))}),E.forEach((F,k)=>{const W=_.get(k);F.forEach(V=>El(V,W))}),g.forEach(F=>{this.processLeaveNode(F)})});const S=[],x=[];for(let F=this._namespaceList.length-1;F>=0;F--)this._namespaceList[F].drainQueuedTransitions(t).forEach(W=>{const V=W.player,Z=W.element;if(S.push(V),this.collectedEnterElements.length){const Se=Z[wr];if(Se&&Se.setForMove){if(Se.previousTriggersValues&&Se.previousTriggersValues.has(W.triggerName)){const Ie=Se.previousTriggersValues.get(W.triggerName),Xe=this.statesByElement.get(W.element);if(Xe&&Xe.has(W.triggerName)){const bt=Xe.get(W.triggerName);bt.value=Ie,Xe.set(W.triggerName,bt)}}return void V.destroy()}}const O=!d||!this.driver.containsElement(d,Z),$=_.get(Z),de=p.get(Z),ae=this._buildInstruction(W,i,de,$,O);if(ae.errors&&ae.errors.length)return void x.push(ae);if(O)return V.onStart(()=>zo(Z,ae.fromStyles)),V.onDestroy(()=>Wr(Z,ae.toStyles)),void r.push(V);if(W.isFallbackTransition)return V.onStart(()=>zo(Z,ae.fromStyles)),V.onDestroy(()=>Wr(Z,ae.toStyles)),void r.push(V);const Me=[];ae.timelines.forEach(Se=>{Se.stretchStartingKeyframe=!0,this.disabledNodes.has(Se.element)||Me.push(Se)}),ae.timelines=Me,i.append(Z,ae.timelines),o.push({instruction:ae,player:V,element:Z}),ae.queriedElements.forEach(Se=>Gi(a,Se,[]).push(V)),ae.preStyleProps.forEach((Se,Ie)=>{if(Se.size){let Xe=l.get(Ie);Xe||l.set(Ie,Xe=new Set),Se.forEach((bt,Ve)=>Xe.add(Ve))}}),ae.postStyleProps.forEach((Se,Ie)=>{let Xe=c.get(Ie);Xe||c.set(Ie,Xe=new Set),Se.forEach((bt,Ve)=>Xe.add(Ve))})});if(x.length){const F=[];x.forEach(k=>{F.push(function Y8(n,e){return new j(3505,!1)}())}),S.forEach(k=>k.destroy()),this.reportError(F)}const M=new Map,R=new Map;o.forEach(F=>{const k=F.element;i.has(k)&&(R.set(k,k),this._beforeAnimationBuild(F.player.namespaceId,F.instruction,M))}),r.forEach(F=>{const k=F.element;this._getPreviousPlayers(k,!1,F.namespaceId,F.triggerName,null).forEach(V=>{Gi(M,k,[]).push(V),V.destroy()})});const b=g.filter(F=>kI(F,l,c)),C=new Map;LI(C,this.driver,v,c,ps).forEach(F=>{kI(F,l,c)&&b.push(F)});const Y=new Map;f.forEach((F,k)=>{LI(Y,this.driver,new Set(F),l,"!")}),b.forEach(F=>{const k=C.get(F),W=Y.get(F);C.set(F,new Map([...k?.entries()??[],...W?.entries()??[]]))});const ee=[],L=[],G={};o.forEach(F=>{const{element:k,player:W,instruction:V}=F;if(i.has(k)){if(u.has(k))return W.onDestroy(()=>Wr(k,V.toStyles)),W.disabled=!0,W.overrideTotalTime(V.totalTime),void r.push(W);let Z=G;if(R.size>1){let $=k;const de=[];for(;$=$.parentNode;){const ae=R.get($);if(ae){Z=ae;break}de.push($)}de.forEach(ae=>R.set(ae,Z))}const O=this._buildAnimation(W.namespaceId,V,M,s,Y,C);if(W.setRealPlayer(O),Z===G)ee.push(W);else{const $=this.playersByElement.get(Z);$&&$.length&&(W.parentPlayer=Js($)),r.push(W)}}else zo(k,V.fromStyles),W.onDestroy(()=>Wr(k,V.toStyles)),L.push(W),u.has(k)&&r.push(W)}),L.forEach(F=>{const k=s.get(F.element);if(k&&k.length){const W=Js(k);F.setRealPlayer(W)}}),r.forEach(F=>{F.parentPlayer?F.syncPlayerEvents(F.parentPlayer):F.destroy()});for(let F=0;F<g.length;F++){const k=g[F],W=k[wr];if(El(k,Gf),W&&W.hasAnimation)continue;let V=[];if(a.size){let O=a.get(k);O&&O.length&&V.push(...O);let $=this.driver.query(k,s0,!0);for(let de=0;de<$.length;de++){let ae=a.get($[de]);ae&&ae.length&&V.push(...ae)}}const Z=V.filter(O=>!O.destroyed);Z.length?Xj(this,k,Z):this.processLeaveNode(k)}return g.length=0,ee.forEach(F=>{this.players.push(F),F.onDone(()=>{F.destroy();const k=this.players.indexOf(F);this.players.splice(k,1)}),F.play()}),ee}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,i,r,s){let o=[];if(t){const a=this.playersByQueriedElement.get(e);a&&(o=a)}else{const a=this.playersByElement.get(e);if(a){const l=!s||s==Gu;a.forEach(c=>{c.queued||!l&&c.triggerName!=r||o.push(c)})}}return(i||r)&&(o=o.filter(a=>!(i&&i!=a.namespaceId||r&&r!=a.triggerName))),o}_beforeAnimationBuild(e,t,i){const s=t.element,o=t.isRemovalTransition?void 0:e,a=t.isRemovalTransition?void 0:t.triggerName;for(const l of t.timelines){const c=l.element,u=c!==s,d=Gi(i,c,[]);this._getPreviousPlayers(c,u,o,a,t.toState).forEach(f=>{const p=f.getRealPlayer();p.beforeDestroy&&p.beforeDestroy(),f.destroy(),d.push(f)})}zo(s,t.fromStyles)}_buildAnimation(e,t,i,r,s,o){const a=t.triggerName,l=t.element,c=[],u=new Set,d=new Set,h=t.timelines.map(p=>{const y=p.element;u.add(y);const g=y[wr];if(g&&g.removedBeforeQueried)return new Bu(p.duration,p.delay);const m=y!==l,v=function Yj(n){const e=[];return FI(n,e),e}((i.get(y)||Hj).map(M=>M.getRealPlayer())).filter(M=>!!M.element&&M.element===y),_=s.get(y),E=o.get(y),S=hI(this._normalizer,p.keyframes,_,E),x=this._buildPlayer(p,S,v);if(p.subTimeline&&r&&d.add(y),m){const M=new v0(e,a,y);M.setRealPlayer(x),c.push(M)}return x});c.forEach(p=>{Gi(this.playersByQueriedElement,p.element,[]).push(p),p.onDone(()=>function jj(n,e,t){let i=n.get(e);if(i){if(i.length){const r=i.indexOf(t);i.splice(r,1)}0==i.length&&n.delete(e)}return i}(this.playersByQueriedElement,p.element,p))}),u.forEach(p=>cr(p,vI));const f=Js(h);return f.onDestroy(()=>{u.forEach(p=>El(p,vI)),Wr(l,t.toStyles)}),d.forEach(p=>{Gi(r,p,[]).push(f)}),f}_buildPlayer(e,t,i){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,i):new Bu(e.duration,e.delay)}}class v0{constructor(e,t,i){this.namespaceId=e,this.triggerName=t,this.element=i,this._player=new Bu,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,i)=>{t.forEach(r=>Jv(e,i,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){Gi(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function ep(n){return n&&1===n.nodeType}function NI(n,e){const t=n.style.display;return n.style.display=e??"none",t}function LI(n,e,t,i,r){const s=[];t.forEach(l=>s.push(NI(l)));const o=[];i.forEach((l,c)=>{const u=new Map;l.forEach(d=>{const h=e.computeStyle(c,d,r);u.set(d,h),(!h||0==h.length)&&(c[wr]=zj,o.push(c))}),n.set(c,u)});let a=0;return t.forEach(l=>NI(l,s[a++])),o}function OI(n,e){const t=new Map;if(n.forEach(a=>t.set(a,[])),0==e.length)return t;const r=new Set(e),s=new Map;function o(a){if(!a)return 1;let l=s.get(a);if(l)return l;const c=a.parentNode;return l=t.has(c)?c:r.has(c)?1:o(c),s.set(a,l),l}return e.forEach(a=>{const l=o(a);1!==l&&t.get(l).push(a)}),t}function cr(n,e){n.classList?.add(e)}function El(n,e){n.classList?.remove(e)}function Xj(n,e,t){Js(t).onDone(()=>n.processLeaveNode(e))}function FI(n,e){for(let t=0;t<n.length;t++){const i=n[t];i instanceof uI?FI(i.players,e):e.push(i)}}function kI(n,e,t){const i=t.get(n);if(!i)return!1;let r=e.get(n);return r?i.forEach(s=>r.add(s)):e.set(n,i),t.delete(n),!0}class tp{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(r,s)=>{},this._transitionEngine=new Wj(e,t,i),this._timelineEngine=new Fj(e,t,i),this._transitionEngine.onRemovalComplete=(r,s)=>this.onRemovalComplete(r,s)}registerTrigger(e,t,i,r,s){const o=e+"-"+r;let a=this._triggerCache[o];if(!a){const l=[],u=c0(this._driver,s,l,[]);if(l.length)throw function U8(n,e){return new j(3404,!1)}();a=function Pj(n,e,t){return new Nj(n,e,t)}(r,u,this._normalizer),this._triggerCache[o]=a}this._transitionEngine.registerTrigger(t,r,a)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,i,r){this._transitionEngine.insertNode(e,t,i,r)}onRemove(e,t,i){this._transitionEngine.removeNode(e,t,i)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,i,r){if("@"==i.charAt(0)){const[s,o]=fI(i);this._timelineEngine.command(s,t,o,r)}else this._transitionEngine.trigger(e,t,i,r)}listen(e,t,i,r,s){if("@"==i.charAt(0)){const[o,a]=fI(i);return this._timelineEngine.listen(o,t,a,s)}return this._transitionEngine.listen(e,t,i,r,s)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(e){this._transitionEngine.afterFlushAnimationsDone(e)}}let Jj=(()=>{class n{static#e=this.initialStylesByElement=new WeakMap;constructor(t,i,r){this._element=t,this._startStyles=i,this._endStyles=r,this._state=0;let s=n.initialStylesByElement.get(t);s||n.initialStylesByElement.set(t,s=new Map),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&Wr(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Wr(this._element,this._initialStyles),this._endStyles&&(Wr(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(zo(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(zo(this._element,this._endStyles),this._endStyles=null),Wr(this._element,this._initialStyles),this._state=3)}}return n})();function E0(n){let e=null;return n.forEach((t,i)=>{(function Qj(n){return"display"===n||"position"===n})(i)&&(e=e||new Map,e.set(i,t))}),e}class UI{constructor(e,t,i,r){this.element=e,this.keyframes=t,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){const t=[];return e.forEach(i=>{t.push(Object.fromEntries(i))}),t}_triggerWebAnimation(e,t,i){return e.animate(this._convertKeyframesToObject(t),i)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((i,r)=>{"offset"!==r&&e.set(r,this._finished?i:wI(this.element,r))}),this.currentSnapshot=e}triggerCallback(e){const t="start"===e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class e${validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}matchesElement(e,t){return!1}containsElement(e,t){return mI(e,t)}getParentElement(e){return t0(e)}query(e,t,i){return gI(e,t,i)}computeStyle(e,t,i){return window.getComputedStyle(e)[t]}animate(e,t,i,r,s,o=[]){const l={duration:i,delay:r,fill:0==r?"both":"forwards"};s&&(l.easing=s);const c=new Map,u=o.filter(f=>f instanceof UI);(function aj(n,e){return 0===n||0===e})(i,r)&&u.forEach(f=>{f.currentSnapshot.forEach((p,y)=>c.set(y,p))});let d=function rj(n){return n.length?n[0]instanceof Map?n:n.map(e=>EI(e)):[]}(t).map(f=>Qs(f));d=function lj(n,e,t){if(t.size&&e.length){let i=e[0],r=[];if(t.forEach((s,o)=>{i.has(o)||r.push(o),i.set(o,s)}),r.length)for(let s=1;s<e.length;s++){let o=e[s];r.forEach(a=>o.set(a,wI(n,a)))}}return e}(e,d,c);const h=function Kj(n,e){let t=null,i=null;return Array.isArray(e)&&e.length?(t=E0(e[0]),e.length>1&&(i=E0(e[e.length-1]))):e instanceof Map&&(t=E0(e)),t||i?new Jj(n,t,i):null}(e,d);return new UI(e,d,l,h)}}let t$=(()=>{class n extends aI{constructor(t,i){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(i.body,{id:"0",encapsulation:nr.None,styles:[],data:{animation:[]}})}build(t){const i=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(t)?lI(t):t;return BI(this._renderer,null,i,"register",[r]),new n$(i,this._renderer)}static#e=this.\u0275fac=function(i){return new(i||n)(xe(au),xe(Yn))};static#t=this.\u0275prov=Pe({token:n,factory:n.\u0275fac})}return n})();class n$ extends g8{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new i$(this._id,e,t||{},this._renderer)}}class i${constructor(e,t,i,r){this.id=e,this.element=t,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return BI(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function BI(n,e,t,i,r){return n.setProperty(e,`@@${t}:${i}`,r)}const VI="@.disabled";let r$=(()=>{class n{constructor(t,i,r){this.delegate=t,this.engine=i,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,i.onRemovalComplete=(s,o)=>{const a=o?.parentNode(s);a&&o.removeChild(a,s)}}createRenderer(t,i){const s=this.delegate.createRenderer(t,i);if(!(t&&i&&i.data&&i.data.animation)){let u=this._rendererCache.get(s);return u||(u=new HI("",s,this.engine,()=>this._rendererCache.delete(s)),this._rendererCache.set(s,u)),u}const o=i.id,a=i.id+"-"+this._currentId;this._currentId++,this.engine.register(a,t);const l=u=>{Array.isArray(u)?u.forEach(l):this.engine.registerTrigger(o,a,t,u.name,u)};return i.data.animation.forEach(l),new s$(this,a,s,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(t,i,r){t>=0&&t<this._microtaskId?this._zone.run(()=>i(r)):(0==this._animationCallbacksBuffer.length&&queueMicrotask(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(s=>{const[o,a]=s;o(a)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}static#e=this.\u0275fac=function(i){return new(i||n)(xe(au),xe(tp),xe(Dt))};static#t=this.\u0275prov=Pe({token:n,factory:n.\u0275fac})}return n})();class HI{constructor(e,t,i,r){this.namespaceId=e,this.delegate=t,this.engine=i,this._onDestroy=r}get data(){return this.delegate.data}destroyNode(e){this.delegate.destroyNode?.(e)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,i,r=!0){this.delegate.insertBefore(e,t,i),this.engine.onInsert(this.namespaceId,t,e,r)}removeChild(e,t,i){this.engine.onRemove(this.namespaceId,t,this.delegate)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,i,r){this.delegate.setAttribute(e,t,i,r)}removeAttribute(e,t,i){this.delegate.removeAttribute(e,t,i)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,i,r){this.delegate.setStyle(e,t,i,r)}removeStyle(e,t,i){this.delegate.removeStyle(e,t,i)}setProperty(e,t,i){"@"==t.charAt(0)&&t==VI?this.disableAnimations(e,!!i):this.delegate.setProperty(e,t,i)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,i){return this.delegate.listen(e,t,i)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class s$ extends HI{constructor(e,t,i,r,s){super(t,i,r,s),this.factory=e,this.namespaceId=t}setProperty(e,t,i){"@"==t.charAt(0)?"."==t.charAt(1)&&t==VI?this.disableAnimations(e,i=void 0===i||!!i):this.engine.process(this.namespaceId,e,t.slice(1),i):this.delegate.setProperty(e,t,i)}listen(e,t,i){if("@"==t.charAt(0)){const r=function o$(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(e);let s=t.slice(1),o="";return"@"!=s.charAt(0)&&([s,o]=function a$(n){const e=n.indexOf(".");return[n.substring(0,e),n.slice(e+1)]}(s)),this.engine.listen(this.namespaceId,r,s,o,a=>{this.factory.scheduleListenerCallback(a._data||-1,i,a)})}return this.delegate.listen(e,t,i)}}const zI=[{provide:aI,useClass:t$},{provide:p0,useFactory:function c$(){return new Aj}},{provide:tp,useClass:(()=>{class n extends tp{constructor(t,i,r,s){super(t.body,i,r)}ngOnDestroy(){this.flush()}static#e=this.\u0275fac=function(i){return new(i||n)(xe(Yn),xe(n0),xe(p0),xe(Uo))};static#t=this.\u0275prov=Pe({token:n,factory:n.\u0275fac})}return n})()},{provide:au,useFactory:function u$(n,e,t){return new r$(n,e,t)},deps:[qv,tp,Dt]}],b0=[{provide:n0,useFactory:()=>new e$},{provide:rx,useValue:"BrowserAnimations"},...zI],GI=[{provide:n0,useClass:yI},{provide:rx,useValue:"NoopAnimations"},...zI];let d$=(()=>{class n{static withConfig(t){return{ngModule:n,providers:t.disableAnimations?GI:b0}}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=jn({type:n});static#n=this.\u0275inj=Un({providers:b0,imports:[nI]})}return n})();const{isArray:h$}=Array,{getPrototypeOf:f$,prototype:p$,keys:m$}=Object;function WI(n){if(1===n.length){const e=n[0];if(h$(e))return{args:e,keys:null};if(function g$(n){return n&&"object"==typeof n&&f$(n)===p$}(e)){const t=m$(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}const{isArray:y$}=Array;function jI(n){return St(e=>function _$(n,e){return y$(e)?n(...e):n(e)}(n,e))}function $I(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}let qI=(()=>{class n{constructor(t,i){this._renderer=t,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static#e=this.\u0275fac=function(i){return new(i||n)(ne(kr),ne(Si))};static#t=this.\u0275dir=Ge({type:n})}return n})(),Wo=(()=>{class n extends qI{static#e=this.\u0275fac=function(){let t;return function(r){return(t||(t=Cn(n)))(r||n)}}();static#t=this.\u0275dir=Ge({type:n,features:[wt]})}return n})();const Mr=new Ce("NgValueAccessor"),b$={provide:Mr,useExisting:Lt(()=>ip),multi:!0},w$=new Ce("CompositionEventMode");let ip=(()=>{class n extends qI{constructor(t,i,r){super(t,i),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function S$(){const n=Zs()?Zs().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(t){this.setProperty("value",t??"")}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static#e=this.\u0275fac=function(i){return new(i||n)(ne(kr),ne(Si),ne(w$,8))};static#t=this.\u0275dir=Ge({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,r){1&i&&dn("input",function(o){return r._handleInput(o.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(o){return r._compositionEnd(o.target.value)})},features:[Ht([b$]),wt]})}return n})();const Zn=new Ce("NgValidators"),to=new Ce("NgAsyncValidators");function r1(n){return null!=n}function s1(n){return _u(n)?Mn(n):n}function o1(n){let e={};return n.forEach(t=>{e=null!=t?{...e,...t}:e}),0===Object.keys(e).length?null:e}function a1(n,e){return e.map(t=>t(n))}function l1(n){return n.map(e=>function x$(n){return!n.validate}(e)?e:t=>e.validate(t))}function S0(n){return null!=n?function c1(n){if(!n)return null;const e=n.filter(r1);return 0==e.length?null:function(t){return o1(a1(t,e))}}(l1(n)):null}function w0(n){return null!=n?function u1(n){if(!n)return null;const e=n.filter(r1);return 0==e.length?null:function(t){return function v$(...n){const e=xS(n),{args:t,keys:i}=WI(n),r=new ln(s=>{const{length:o}=t;if(!o)return void s.complete();const a=new Array(o);let l=o,c=o;for(let u=0;u<o;u++){let d=!1;Ni(t[u]).subscribe(mn(s,h=>{d||(d=!0,c--),a[u]=h},()=>l--,void 0,()=>{(!l||!d)&&(c||s.next(i?$I(i,a):a),s.complete())}))}});return e?r.pipe(jI(e)):r}(a1(t,e).map(s1)).pipe(St(o1))}}(l1(n)):null}function d1(n,e){return null===n?[e]:Array.isArray(n)?[...n,e]:[n,e]}function M0(n){return n?Array.isArray(n)?n:[n]:[]}function sp(n,e){return Array.isArray(n)?n.includes(e):n===e}function p1(n,e){const t=M0(e);return M0(n).forEach(r=>{sp(t,r)||t.push(r)}),t}function m1(n,e){return M0(e).filter(t=>!sp(n,t))}class g1{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=S0(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=w0(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class ci extends g1{get formDirective(){return null}get path(){return null}}class no extends g1{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class y1{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let _1=(()=>{class n extends y1{constructor(t){super(t)}static#e=this.\u0275fac=function(i){return new(i||n)(ne(no,2))};static#t=this.\u0275dir=Ge({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,r){2&i&&vu("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[wt]})}return n})();const Wu="VALID",ap="INVALID",bl="PENDING",ju="DISABLED";function lp(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}class S1{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===Wu}get invalid(){return this.status===ap}get pending(){return this.status==bl}get disabled(){return this.status===ju}get enabled(){return this.status!==ju}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(p1(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(p1(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(m1(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(m1(e,this._rawAsyncValidators))}hasValidator(e){return sp(this._rawValidators,e)}hasAsyncValidator(e){return sp(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=bl,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=ju,this.errors=null,this._forEachChild(i=>{i.disable({...e,onlySelf:!0})}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=Wu,this._forEachChild(i=>{i.enable({...e,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Wu||this.status===bl)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?ju:Wu}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=bl,this._hasOwnPendingAsyncValidator=!0;const t=s1(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){let t=e;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((i,r)=>i&&i._find(r),this)}getError(e,t){const i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new Ut,this.statusChanges=new Ut}_calculateStatus(){return this._allControlsDisabled()?ju:this.errors?ap:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(bl)?bl:this._anyControlsHaveStatus(ap)?ap:Wu}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){lp(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=function I$(n){return Array.isArray(n)?S0(n):n||null}(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=function R$(n){return Array.isArray(n)?w0(n):n||null}(this._rawAsyncValidators)}}const Sl=new Ce("CallSetDisabledState",{providedIn:"root",factory:()=>cp}),cp="always";function $u(n,e,t=cp){(function I0(n,e){const t=function h1(n){return n._rawValidators}(n);null!==e.validator?n.setValidators(d1(t,e.validator)):"function"==typeof t&&n.setValidators([t]);const i=function f1(n){return n._rawAsyncValidators}(n);null!==e.asyncValidator?n.setAsyncValidators(d1(i,e.asyncValidator)):"function"==typeof i&&n.setAsyncValidators([i]);const r=()=>n.updateValueAndValidity();hp(e._rawValidators,r),hp(e._rawAsyncValidators,r)})(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||"always"===t)&&e.valueAccessor.setDisabledState?.(n.disabled),function L$(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&w1(n,e)})}(n,e),function F$(n,e){const t=(i,r)=>{e.valueAccessor.writeValue(i),r&&e.viewToModelUpdate(i)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}(n,e),function O$(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&w1(n,e),"submit"!==n.updateOn&&n.markAsTouched()})}(n,e),function N$(n,e){if(e.valueAccessor.setDisabledState){const t=i=>{e.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}(n,e)}function hp(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function w1(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function C1(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}function T1(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}const A1=class extends S1{constructor(e=null,t,i){super(function T0(n){return(lp(n)?n.validators:n)||null}(t),function A0(n,e){return(lp(e)?e.asyncValidators:n)||null}(i,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),lp(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=T1(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){C1(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){C1(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){T1(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}},W$={provide:no,useExisting:Lt(()=>O0)},R1=(()=>Promise.resolve())();let O0=(()=>{class n extends no{constructor(t,i,r,s,o,a){super(),this._changeDetectorRef=o,this.callSetDisabledState=a,this.control=new A1,this._registered=!1,this.name="",this.update=new Ut,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=function N0(n,e){if(!e)return null;let t,i,r;return Array.isArray(e),e.forEach(s=>{s.constructor===ip?t=s:function B$(n){return Object.getPrototypeOf(n.constructor)===Wo}(s)?i=s:r=s}),r||i||t||null}(0,s)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){const i=t.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),function P0(n,e){if(!n.hasOwnProperty("model"))return!1;const t=n.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){$u(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){R1.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){const i=t.isDisabled.currentValue,r=0!==i&&function _l(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}(i);R1.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?function up(n,e){return[...e.path,n]}(t,this._parent):[t]}static#e=this.\u0275fac=function(i){return new(i||n)(ne(ci,9),ne(Zn,10),ne(to,10),ne(Mr,10),ne(Pu,8),ne(Sl,8))};static#t=this.\u0275dir=Ge({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Ht([W$]),wt,rr]})}return n})(),N1=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=jn({type:n});static#n=this.\u0275inj=Un({})}return n})(),m6=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=jn({type:n});static#n=this.\u0275inj=Un({imports:[N1]})}return n})(),y6=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:Sl,useValue:t.callSetDisabledState??cp}]}}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=jn({type:n});static#n=this.\u0275inj=Un({imports:[m6]})}return n})();function z0(...n){const e=Ic(n),t=xS(n),{args:i,keys:r}=WI(n);if(0===i.length)return Mn([],e);const s=new ln(function v6(n,e,t=Os){return i=>{K1(e,()=>{const{length:r}=n,s=new Array(r);let o=r,a=r;for(let l=0;l<r;l++)K1(e,()=>{const c=Mn(n[l],e);let u=!1;c.subscribe(mn(i,d=>{s[l]=d,u||(u=!0,a--),a||i.next(t(s.slice()))},()=>{--o||i.complete()}))},i)},i)}}(i,e,r?o=>$I(r,o):Os));return t?s.pipe(jI(t)):s}function K1(n,e,t){n?Qr(t,n,e):e()}const pp=Tc(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function G0(...n){return function E6(){return wa(1)}()(Mn(n,Ic(n)))}function J1(n){return new ln(e=>{Ni(n()).subscribe(e)})}function Xu(n,e){const t=Rt(n)?n:()=>n,i=r=>r.error(t());return new ln(e?r=>e.schedule(i,0,r):i)}function W0(){return wn((n,e)=>{let t=null;n._refCount++;const i=mn(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const r=n._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});n.subscribe(i),i.closed||(t=n.connect())})}class Q1 extends ln{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,uS(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Pi;const t=this.getSubject();e.add(this.source.subscribe(mn(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Pi.EMPTY)}return e}refCount(){return W0()(this)}}function wl(n){return n<=0?()=>Dr:wn((e,t)=>{let i=0;e.subscribe(mn(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function gs(n,e){return wn((t,i)=>{let r=0;t.subscribe(mn(i,s=>n.call(e,s,r++)&&i.next(s)))})}function mp(n){return wn((e,t)=>{let i=!1;e.subscribe(mn(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function eR(n=S6){return wn((e,t)=>{let i=!1;e.subscribe(mn(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function S6(){return new pp}function $o(n,e){const t=arguments.length>=2;return i=>i.pipe(n?gs((r,s)=>n(r,s,i)):Os,wl(1),t?mp(e):eR(()=>new pp))}function Ml(n,e){return Rt(e)?kn(n,e,1):kn(n,1)}function Kn(n,e,t){const i=Rt(n)||e||t?{next:n,error:e,complete:t}:n;return i?wn((r,s)=>{var o;null===(o=i.subscribe)||void 0===o||o.call(i);let a=!0;r.subscribe(mn(s,l=>{var c;null===(c=i.next)||void 0===c||c.call(i,l),s.next(l)},()=>{var l;a=!1,null===(l=i.complete)||void 0===l||l.call(i),s.complete()},l=>{var c;a=!1,null===(c=i.error)||void 0===c||c.call(i,l),s.error(l)},()=>{var l,c;a&&(null===(l=i.unsubscribe)||void 0===l||l.call(i)),null===(c=i.finalize)||void 0===c||c.call(i)}))}):Os}function qo(n){return wn((e,t)=>{let s,i=null,r=!1;i=e.subscribe(mn(t,void 0,void 0,o=>{s=Ni(n(o,qo(n)(e))),i?(i.unsubscribe(),i=null,s.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,s.subscribe(t))})}function j0(n){return n<=0?()=>Dr:wn((e,t)=>{let i=[];e.subscribe(mn(t,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(const r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function Yu(n){return wn((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}const st="primary",Zu=Symbol("RouteTitle");class A6{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function xl(n){return new A6(n)}function D6(n,e,t){const i=t.path.split("/");if(i.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||i.length<n.length))return null;const r={};for(let s=0;s<i.length;s++){const o=i[s],a=n[s];if(o.startsWith(":"))r[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function jr(n,e){const t=n?Object.keys(n):void 0,i=e?Object.keys(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!tR(n[r],e[r]))return!1;return!0}function tR(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),i=[...e].sort();return t.every((r,s)=>i[s]===r)}return n===e}function nR(n){return n.length>0?n[n.length-1]:null}function io(n){return function _6(n){return!!n&&(n instanceof ln||Rt(n.lift)&&Rt(n.subscribe))}(n)?n:_u(n)?Mn(Promise.resolve(n)):je(n)}const R6={exact:function sR(n,e,t){if(!Xo(n.segments,e.segments)||!gp(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const i in e.children)if(!n.children[i]||!sR(n.children[i],e.children[i],t))return!1;return!0},subset:oR},iR={exact:function P6(n,e){return jr(n,e)},subset:function N6(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>tR(n[t],e[t]))},ignored:()=>!0};function rR(n,e,t){return R6[t.paths](n.root,e.root,t.matrixParams)&&iR[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function oR(n,e,t){return aR(n,e,e.segments,t)}function aR(n,e,t,i){if(n.segments.length>t.length){const r=n.segments.slice(0,t.length);return!(!Xo(r,t)||e.hasChildren()||!gp(r,t,i))}if(n.segments.length===t.length){if(!Xo(n.segments,t)||!gp(n.segments,t,i))return!1;for(const r in e.children)if(!n.children[r]||!oR(n.children[r],e.children[r],i))return!1;return!0}{const r=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!!(Xo(n.segments,r)&&gp(n.segments,r,i)&&n.children[st])&&aR(n.children[st],e,s,i)}}function gp(n,e,t){return e.every((i,r)=>iR[t](n[r].parameters,i.parameters))}class Cl{constructor(e=new It([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=xl(this.queryParams)),this._queryParamMap}toString(){return F6.serialize(this)}}class It{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return yp(this)}}class Ku{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=xl(this.parameters)),this._parameterMap}toString(){return uR(this)}}function Xo(n,e){return n.length===e.length&&n.every((t,i)=>t.path===e[i].path)}let Ju=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Pe({token:n,factory:function(){return new $0},providedIn:"root"})}return n})();class $0{parse(e){const t=new q6(e);return new Cl(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${Qu(e.root,!0)}`,i=function B6(n){const e=Object.keys(n).map(t=>{const i=n[t];return Array.isArray(i)?i.map(r=>`${_p(t)}=${_p(r)}`).join("&"):`${_p(t)}=${_p(i)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${i}${"string"==typeof e.fragment?`#${function k6(n){return encodeURI(n)}(e.fragment)}`:""}`}}const F6=new $0;function yp(n){return n.segments.map(e=>uR(e)).join("/")}function Qu(n,e){if(!n.hasChildren())return yp(n);if(e){const t=n.children[st]?Qu(n.children[st],!1):"",i=[];return Object.entries(n.children).forEach(([r,s])=>{r!==st&&i.push(`${r}:${Qu(s,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}{const t=function O6(n,e){let t=[];return Object.entries(n.children).forEach(([i,r])=>{i===st&&(t=t.concat(e(r,i)))}),Object.entries(n.children).forEach(([i,r])=>{i!==st&&(t=t.concat(e(r,i)))}),t}(n,(i,r)=>r===st?[Qu(n.children[st],!1)]:[`${r}:${Qu(i,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[st]?`${yp(n)}/${t[0]}`:`${yp(n)}/(${t.join("//")})`}}function lR(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function _p(n){return lR(n).replace(/%3B/gi,";")}function q0(n){return lR(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function vp(n){return decodeURIComponent(n)}function cR(n){return vp(n.replace(/\+/g,"%20"))}function uR(n){return`${q0(n.path)}${function U6(n){return Object.keys(n).map(e=>`;${q0(e)}=${q0(n[e])}`).join("")}(n.parameters)}`}const V6=/^[^\/()?;#]+/;function X0(n){const e=n.match(V6);return e?e[0]:""}const H6=/^[^\/()?;=#]+/,G6=/^[^=?&#]+/,j6=/^[^&#]+/;class q6{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new It([],{}):new It([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[st]=new It(e,t)),i}parseSegment(){const e=X0(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new j(4009,!1);return this.capture(e),new Ku(vp(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=function z6(n){const e=n.match(H6);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const r=X0(this.remaining);r&&(i=r,this.capture(i))}e[vp(t)]=vp(i)}parseQueryParam(e){const t=function W6(n){const e=n.match(G6);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const o=function $6(n){const e=n.match(j6);return e?e[0]:""}(this.remaining);o&&(i=o,this.capture(i))}const r=cR(t),s=cR(i);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=X0(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new j(4010,!1);let s;i.indexOf(":")>-1?(s=i.slice(0,i.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=st);const o=this.parseChildren();t[s]=1===Object.keys(o).length?o[st]:new It([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new j(4011,!1)}}function dR(n){return n.segments.length>0?new It([],{[st]:n}):n}function hR(n){const e={};for(const i of Object.keys(n.children)){const s=hR(n.children[i]);if(i===st&&0===s.segments.length&&s.hasChildren())for(const[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[i]=s)}return function X6(n){if(1===n.numberOfChildren&&n.children[st]){const e=n.children[st];return new It(n.segments.concat(e.segments),e.children)}return n}(new It(n.segments,e))}function Yo(n){return n instanceof Cl}function fR(n){let e;const r=dR(function t(s){const o={};for(const l of s.children){const c=t(l);o[l.outlet]=c}const a=new It(s.url,o);return s===n&&(e=a),a}(n.root));return e??r}function pR(n,e,t,i){let r=n;for(;r.parent;)r=r.parent;if(0===e.length)return Y0(r,r,r,t,i);const s=function Z6(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new gR(!0,0,n);let e=0,t=!1;const i=n.reduce((r,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return Object.entries(s.outlets).forEach(([l,c])=>{a[l]="string"==typeof c?c.split("/"):c}),[...r,{outlets:a}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===o?(s.split("/").forEach((a,l)=>{0==l&&"."===a||(0==l&&""===a?t=!0:".."===a?e++:""!=a&&r.push(a))}),r):[...r,s]},[]);return new gR(t,e,i)}(e);if(s.toRoot())return Y0(r,r,new It([],{}),t,i);const o=function K6(n,e,t){if(n.isAbsolute)return new bp(e,!0,0);if(!t)return new bp(e,!1,NaN);if(null===t.parent)return new bp(t,!0,0);const i=Ep(n.commands[0])?0:1;return function J6(n,e,t){let i=n,r=e,s=t;for(;s>r;){if(s-=r,i=i.parent,!i)throw new j(4005,!1);r=i.segments.length}return new bp(i,!1,r-s)}(t,t.segments.length-1+i,n.numberOfDoubleDots)}(s,r,n),a=o.processChildren?td(o.segmentGroup,o.index,s.commands):yR(o.segmentGroup,o.index,s.commands);return Y0(r,o.segmentGroup,a,t,i)}function Ep(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function ed(n){return"object"==typeof n&&null!=n&&n.outlets}function Y0(n,e,t,i,r){let o,s={};i&&Object.entries(i).forEach(([l,c])=>{s[l]=Array.isArray(c)?c.map(u=>`${u}`):`${c}`}),o=n===e?t:mR(n,e,t);const a=dR(hR(o));return new Cl(a,s,r)}function mR(n,e,t){const i={};return Object.entries(n.children).forEach(([r,s])=>{i[r]=s===e?t:mR(s,e,t)}),new It(n.segments,i)}class gR{constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&Ep(i[0]))throw new j(4003,!1);const r=i.find(ed);if(r&&r!==nR(i))throw new j(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class bp{constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}}function yR(n,e,t){if(n||(n=new It([],{})),0===n.segments.length&&n.hasChildren())return td(n,e,t);const i=function e9(n,e,t){let i=0,r=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return s;const o=n.segments[r],a=t[i];if(ed(a))break;const l=`${a}`,c=i<t.length-1?t[i+1]:null;if(r>0&&void 0===l)break;if(l&&c&&"object"==typeof c&&void 0===c.outlets){if(!vR(l,c,o))return s;i+=2}else{if(!vR(l,{},o))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){const s=new It(n.segments.slice(0,i.pathIndex),{});return s.children[st]=new It(n.segments.slice(i.pathIndex),n.children),td(s,0,r)}return i.match&&0===r.length?new It(n.segments,{}):i.match&&!n.hasChildren()?Z0(n,e,t):i.match?td(n,0,r):Z0(n,e,t)}function td(n,e,t){if(0===t.length)return new It(n.segments,{});{const i=function Q6(n){return ed(n[0])?n[0].outlets:{[st]:n}}(t),r={};if(Object.keys(i).some(s=>s!==st)&&n.children[st]&&1===n.numberOfChildren&&0===n.children[st].segments.length){const s=td(n.children[st],e,t);return new It(n.segments,s.children)}return Object.entries(i).forEach(([s,o])=>{"string"==typeof o&&(o=[o]),null!==o&&(r[s]=yR(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{void 0===i[s]&&(r[s]=o)}),new It(n.segments,r)}}function Z0(n,e,t){const i=n.segments.slice(0,e);let r=0;for(;r<t.length;){const s=t[r];if(ed(s)){const l=t9(s.outlets);return new It(i,l)}if(0===r&&Ep(t[0])){i.push(new Ku(n.segments[e].path,_R(t[0]))),r++;continue}const o=ed(s)?s.outlets[st]:`${s}`,a=r<t.length-1?t[r+1]:null;o&&a&&Ep(a)?(i.push(new Ku(o,_R(a))),r+=2):(i.push(new Ku(o,{})),r++)}return new It(i,{})}function t9(n){const e={};return Object.entries(n).forEach(([t,i])=>{"string"==typeof i&&(i=[i]),null!==i&&(e[t]=Z0(new It([],{}),0,i))}),e}function _R(n){const e={};return Object.entries(n).forEach(([t,i])=>e[t]=`${i}`),e}function vR(n,e,t){return n==t.path&&jr(e,t.parameters)}const nd="imperative";class $r{constructor(e,t){this.id=e,this.url=t}}class Sp extends $r{constructor(e,t,i="imperative",r=null){super(e,t),this.type=0,this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class ro extends $r{constructor(e,t,i){super(e,t),this.urlAfterRedirects=i,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class id extends $r{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Tl extends $r{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=16}}class wp extends $r{constructor(e,t,i,r){super(e,t),this.error=i,this.target=r,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class ER extends $r{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class n9 extends $r{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class i9 extends $r{constructor(e,t,i,r,s){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class r9 extends $r{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class s9 extends $r{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class o9{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class a9{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class l9{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class c9{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class u9{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class d9{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class bR{constructor(e,t,i){this.routerEvent=e,this.position=t,this.anchor=i,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class K0{}class J0{constructor(e){this.url=e}}class h9{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new rd,this.attachRef=null}}let rd=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(t,i){const r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){const i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new h9,this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class SR{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=Q0(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){const t=Q0(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=eE(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return eE(e,this._root).map(t=>t.value)}}function Q0(n,e){if(n===e.value)return e;for(const t of e.children){const i=Q0(n,t);if(i)return i}return null}function eE(n,e){if(n===e.value)return[e];for(const t of e.children){const i=eE(n,t);if(i.length)return i.unshift(e),i}return[]}class ys{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function Al(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class wR extends SR{constructor(e,t){super(e),this.snapshot=t,tE(this,e)}toString(){return this.snapshot.toString()}}function MR(n,e){const t=function f9(n,e){const o=new Mp([],{},{},"",{},st,e,null,{});return new CR("",new ys(o,[]))}(0,e),i=new er([new Ku("",{})]),r=new er({}),s=new er({}),o=new er({}),a=new er(""),l=new Dl(i,r,o,a,s,st,e,t.root);return l.snapshot=t.root,new wR(new ys(l,[]),t)}class Dl{constructor(e,t,i,r,s,o,a,l){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(St(c=>c[Zu]))??je(void 0),this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(St(e=>xl(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(St(e=>xl(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function xR(n,e="emptyOnly"){const t=n.pathFromRoot;let i=0;if("always"!==e)for(i=t.length-1;i>=1;){const r=t[i],s=t[i-1];if(r.routeConfig&&""===r.routeConfig.path)i--;else{if(s.component)break;i--}}return function p9(n){return n.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(i))}class Mp{get title(){return this.data?.[Zu]}constructor(e,t,i,r,s,o,a,l,c){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.routeConfig=l,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=xl(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=xl(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class CR extends SR{constructor(e,t){super(t),this.url=e,tE(this,t)}toString(){return TR(this._root)}}function tE(n,e){e.value._routerState=n,e.children.forEach(t=>tE(n,t))}function TR(n){const e=n.children.length>0?` { ${n.children.map(TR).join(", ")} } `:"";return`${n.value}${e}`}function nE(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,jr(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),jr(e.params,t.params)||n.paramsSubject.next(t.params),function I6(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!jr(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.urlSubject.next(t.url),jr(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function iE(n,e){const t=jr(n.params,e.params)&&function L6(n,e){return Xo(n,e)&&n.every((t,i)=>jr(t.parameters,e[i].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||iE(n.parent,e.parent))}let rE=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=st,this.activateEvents=new Ut,this.deactivateEvents=new Ut,this.attachEvents=new Ut,this.detachEvents=new Ut,this.parentContexts=we(rd),this.location=we(Er),this.changeDetector=we(Pu),this.environmentInjector=we(Ui),this.inputBinder=we(xp,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){const{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new j(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new j(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new j(4012,!1);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new j(4013,!1);this._activatedRoute=t;const r=this.location,o=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,l=new m9(t,a,r.injector);this.activated=r.createComponent(o,{index:r.length,injector:l,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275dir=Ge({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[rr]})}return n})();class m9{constructor(e,t,i){this.route=e,this.childContexts=t,this.parent=i}get(e,t){return e===Dl?this.route:e===rd?this.childContexts:this.parent.get(e,t)}}const xp=new Ce("");let AR=(()=>{class n{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){const{activatedRoute:i}=t,r=z0([i.queryParams,i.params,i.data]).pipe(pr(([s,o,a],l)=>(a={...s,...o,...a},0===l?je(a):Promise.resolve(a)))).subscribe(s=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==i||null===i.component)return void this.unsubscribeFromRouteData(t);const o=function $G(n){const e=_t(n);if(!e)return null;const t=new fu(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}(i.component);if(o)for(const{templateName:a}of o.inputs)t.activatedComponentRef.setInput(a,s[a]);else this.unsubscribeFromRouteData(t)});this.outletDataSubscriptions.set(t,r)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Pe({token:n,factory:n.\u0275fac})}return n})();function sd(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const i=t.value;i._futureSnapshot=e.value;const r=function y9(n,e,t){return e.children.map(i=>{for(const r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return sd(n,i,r);return sd(n,i)})}(n,e,t);return new ys(i,r)}{if(n.shouldAttach(e.value)){const s=n.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>sd(n,a)),o}}const i=function _9(n){return new Dl(new er(n.url),new er(n.params),new er(n.queryParams),new er(n.fragment),new er(n.data),n.outlet,n.component,n)}(e.value),r=e.children.map(s=>sd(n,s));return new ys(i,r)}}const sE="ngNavigationCancelingError";function DR(n,e){const{redirectTo:t,navigationBehaviorOptions:i}=Yo(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=IR(!1,0,e);return r.url=t,r.navigationBehaviorOptions=i,r}function IR(n,e,t){const i=new Error("NavigationCancelingError: "+(n||""));return i[sE]=!0,i.cancellationCode=e,t&&(i.url=t),i}function RR(n){return n&&n[sE]}let PR=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=Rr({type:n,selectors:[["ng-component"]],standalone:!0,features:[Tu],decls:1,vars:0,template:function(i,r){1&i&&Hi(0,"router-outlet")},dependencies:[rE],encapsulation:2})}return n})();function oE(n){const e=n.children&&n.children.map(oE),t=e?{...n,children:e}:{...n};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==st&&(t.component=PR),t}function xr(n){return n.outlet||st}function od(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class C9{constructor(e,t,i,r,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=s}activate(e){const t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),nE(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){const r=Al(t);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,r[o],i),delete r[o]}),Object.values(r).forEach(s=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(r===s)if(r.component){const o=i.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,i);else s&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=Al(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);if(i&&i.outlet){const o=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=Al(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(e,t,i){const r=Al(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new d9(s.value.snapshot))}),e.children.length&&this.forwardEvent(new c9(e.value.snapshot))}activateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(nE(r),r===s)if(r.component){const o=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,i);else if(r.component){const o=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),nE(a.route.value),this.activateChildRoutes(e,null,o.children)}else{const a=od(r.snapshot);o.attachRef=null,o.route=r,o.injector=a,o.outlet&&o.outlet.activateWith(r,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,i)}}class NR{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class Cp{constructor(e,t){this.component=e,this.route=t}}function T9(n,e,t){const i=n._root;return ad(i,e?e._root:null,t,[i.value])}function Il(n,e){const t=Symbol(),i=e.get(n,t);return i===t?"function"!=typeof n||function o2(n){return null!==Qd(n)}(n)?e.get(n):n:i}function ad(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=Al(e);return n.children.forEach(o=>{(function D9(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const l=function I9(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!Xo(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Xo(n.url,e.url)||!jr(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!iE(n,e)||!jr(n.queryParams,e.queryParams);default:return!iE(n,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new NR(i)):(s.data=o.data,s._resolvedData=o._resolvedData),ad(n,e,s.component?a?a.children:null:t,i,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new Cp(a.outlet.component,o))}else o&&ld(e,a,r),r.canActivateChecks.push(new NR(i)),ad(n,null,s.component?a?a.children:null:t,i,r)})(o,s[o.value.outlet],t,i.concat([o.value]),r),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>ld(a,t.getContext(o),r)),r}function ld(n,e,t){const i=Al(n),r=n.value;Object.entries(i).forEach(([s,o])=>{ld(o,r.component?e?e.children.getContext(s):null:e,t)}),t.canDeactivateChecks.push(new Cp(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}function cd(n){return"function"==typeof n}function LR(n){return n instanceof pp||"EmptyError"===n?.name}const Tp=Symbol("INITIAL_VALUE");function Rl(){return pr(n=>z0(n.map(e=>e.pipe(wl(1),function b6(...n){const e=Ic(n);return wn((t,i)=>{(e?G0(n,t,e):G0(n,t)).subscribe(i)})}(Tp)))).pipe(St(e=>{for(const t of e)if(!0!==t){if(t===Tp)return Tp;if(!1===t||t instanceof Cl)return t}return!0}),gs(e=>e!==Tp),wl(1)))}function OR(n){return function lF(...n){return aS(n)}(Kn(e=>{if(Yo(e))throw DR(0,e)}),St(e=>!0===e))}class Ap{constructor(e){this.segmentGroup=e||null}}class FR{constructor(e){this.urlTree=e}}function Pl(n){return Xu(new Ap(n))}function kR(n){return Xu(new FR(n))}class Z9{constructor(e,t){this.urlSerializer=e,this.urlTree=t}noMatchError(e){return new j(4002,!1)}lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return je(i);if(r.numberOfChildren>1||!r.children[st])return Xu(new j(4e3,!1));r=r.children[st]}}applyRedirectCommands(e,t,i){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,i)}applyRedirectCreateUrlTree(e,t,i,r){const s=this.createSegmentGroup(e,t.root,i,r);return new Cl(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const i={};return Object.entries(e).forEach(([r,s])=>{if("string"==typeof s&&s.startsWith(":")){const a=s.substring(1);i[r]=t[a]}else i[r]=s}),i}createSegmentGroup(e,t,i,r){const s=this.createSegments(e,t.segments,i,r);let o={};return Object.entries(t.children).forEach(([a,l])=>{o[a]=this.createSegmentGroup(e,l,i,r)}),new It(s,o)}createSegments(e,t,i,r){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,r):this.findOrReturn(s,i))}findPosParam(e,t,i){const r=i[t.path.substring(1)];if(!r)throw new j(4001,!1);return r}findOrReturn(e,t){let i=0;for(const r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}}const aE={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function K9(n,e,t,i,r){const s=lE(n,e,t);return s.matched?(i=function E9(n,e){return n.providers&&!n._injector&&(n._injector=z_(n.providers,e,`Route: ${n.path}`)),n._injector??e}(e,i),function q9(n,e,t,i){const r=e.canMatch;return r&&0!==r.length?je(r.map(o=>{const a=Il(o,n);return io(function F9(n){return n&&cd(n.canMatch)}(a)?a.canMatch(e,t):n.runInContext(()=>a(e,t)))})).pipe(Rl(),OR()):je(!0)}(i,e,t).pipe(St(o=>!0===o?s:{...aE}))):je(s)}function lE(n,e,t){if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?{...aE}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const r=(e.matcher||D6)(t,n,e);if(!r)return{...aE};const s={};Object.entries(r.posParams??{}).forEach(([a,l])=>{s[a]=l.path});const o=r.consumed.length>0?{...s,...r.consumed[r.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:o,positionalParamSegments:r.posParams??{}}}function UR(n,e,t,i){return t.length>0&&function e7(n,e,t){return t.some(i=>Dp(n,e,i)&&xr(i)!==st)}(n,t,i)?{segmentGroup:new It(e,Q9(i,new It(t,n.children))),slicedSegments:[]}:0===t.length&&function t7(n,e,t){return t.some(i=>Dp(n,e,i))}(n,t,i)?{segmentGroup:new It(n.segments,J9(n,0,t,i,n.children)),slicedSegments:t}:{segmentGroup:new It(n.segments,n.children),slicedSegments:t}}function J9(n,e,t,i,r){const s={};for(const o of i)if(Dp(n,t,o)&&!r[xr(o)]){const a=new It([],{});s[xr(o)]=a}return{...r,...s}}function Q9(n,e){const t={};t[st]=e;for(const i of n)if(""===i.path&&xr(i)!==st){const r=new It([],{});t[xr(i)]=r}return t}function Dp(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}class s7{constructor(e,t,i,r,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=i,this.config=r,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.allowRedirects=!0,this.applyRedirects=new Z9(this.urlSerializer,this.urlTree)}noMatchError(e){return new j(4002,!1)}recognize(){const e=UR(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,st).pipe(qo(t=>{if(t instanceof FR)return this.allowRedirects=!1,this.urlTree=t.urlTree,this.match(t.urlTree);throw t instanceof Ap?this.noMatchError(t):t}),St(t=>{const i=new Mp([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},st,this.rootComponentType,null,{}),r=new ys(i,t),s=new CR("",r),o=function Y6(n,e,t=null,i=null){return pR(fR(n),e,t,i)}(i,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e.root,st).pipe(qo(i=>{throw i instanceof Ap?this.noMatchError(i):i}))}inheritParamsAndData(e){const t=e.value,i=xR(t,this.paramsInheritanceStrategy);t.params=Object.freeze(i.params),t.data=Object.freeze(i.data),e.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(e,t,i,r){return 0===i.segments.length&&i.hasChildren()?this.processChildren(e,t,i):this.processSegment(e,t,i,i.segments,r,!0)}processChildren(e,t,i){const r=[];for(const s of Object.keys(i.children))"primary"===s?r.unshift(s):r.push(s);return Mn(r).pipe(Ml(s=>{const o=i.children[s],a=function M9(n,e){const t=n.filter(i=>xr(i)===e);return t.push(...n.filter(i=>xr(i)!==e)),t}(t,s);return this.processSegmentGroup(e,a,o,s)}),function M6(n,e){return wn(function w6(n,e,t,i,r){return(s,o)=>{let a=t,l=e,c=0;s.subscribe(mn(o,u=>{const d=c++;l=a?n(l,u,d):(a=!0,u),i&&o.next(l)},r&&(()=>{a&&o.next(l),o.complete()})))}}(n,e,arguments.length>=2,!0))}((s,o)=>(s.push(...o),s)),mp(null),function x6(n,e){const t=arguments.length>=2;return i=>i.pipe(n?gs((r,s)=>n(r,s,i)):Os,j0(1),t?mp(e):eR(()=>new pp))}(),kn(s=>{if(null===s)return Pl(i);const o=BR(s);return function o7(n){n.sort((e,t)=>e.value.outlet===st?-1:t.value.outlet===st?1:e.value.outlet.localeCompare(t.value.outlet))}(o),je(o)}))}processSegment(e,t,i,r,s,o){return Mn(t).pipe(Ml(a=>this.processSegmentAgainstRoute(a._injector??e,t,a,i,r,s,o).pipe(qo(l=>{if(l instanceof Ap)return je(null);throw l}))),$o(a=>!!a),qo(a=>{if(LR(a))return function i7(n,e,t){return 0===e.length&&!n.children[t]}(i,r,s)?je([]):Pl(i);throw a}))}processSegmentAgainstRoute(e,t,i,r,s,o,a){return function n7(n,e,t,i){return!!(xr(n)===i||i!==st&&Dp(e,t,n))&&("**"===n.path||lE(e,n,t).matched)}(i,r,s,o)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(e,r,i,s,o,a):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,r,t,i,s,o):Pl(r):Pl(r)}expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,i,r,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,i,r){const s=this.applyRedirects.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?kR(s):this.applyRedirects.lineralizeSegments(i,s).pipe(kn(o=>{const a=new It(o,{});return this.processSegment(e,t,a,o,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o){const{matched:a,consumedSegments:l,remainingSegments:c,positionalParamSegments:u}=lE(t,r,s);if(!a)return Pl(t);const d=this.applyRedirects.applyRedirectCommands(l,r.redirectTo,u);return r.redirectTo.startsWith("/")?kR(d):this.applyRedirects.lineralizeSegments(r,d).pipe(kn(h=>this.processSegment(e,i,t,h.concat(c),o,!1)))}matchSegmentAgainstRoute(e,t,i,r,s,o){let a;if("**"===i.path){const l=r.length>0?nR(r).parameters:{};a=je({snapshot:new Mp(r,l,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,VR(i),xr(i),i.component??i._loadedComponent??null,i,HR(i)),consumedSegments:[],remainingSegments:[]}),t.children={}}else a=K9(t,i,r,e).pipe(St(({matched:l,consumedSegments:c,remainingSegments:u,parameters:d})=>l?{snapshot:new Mp(c,d,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,VR(i),xr(i),i.component??i._loadedComponent??null,i,HR(i)),consumedSegments:c,remainingSegments:u}:null));return a.pipe(pr(l=>null===l?Pl(t):this.getChildConfig(e=i._injector??e,i,r).pipe(pr(({routes:c})=>{const u=i._loadedInjector??e,{snapshot:d,consumedSegments:h,remainingSegments:f}=l,{segmentGroup:p,slicedSegments:y}=UR(t,h,f,c);if(0===y.length&&p.hasChildren())return this.processChildren(u,c,p).pipe(St(m=>null===m?null:[new ys(d,m)]));if(0===c.length&&0===y.length)return je([new ys(d,[])]);const g=xr(i)===s;return this.processSegment(u,c,p,y,g?st:s,!0).pipe(St(m=>[new ys(d,m)]))}))))}getChildConfig(e,t,i){return t.children?je({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?je({routes:t._loadedRoutes,injector:t._loadedInjector}):function $9(n,e,t,i){const r=e.canLoad;return void 0===r||0===r.length?je(!0):je(r.map(o=>{const a=Il(o,n);return io(function P9(n){return n&&cd(n.canLoad)}(a)?a.canLoad(e,t):n.runInContext(()=>a(e,t)))})).pipe(Rl(),OR())}(e,t,i).pipe(kn(r=>r?this.configLoader.loadChildren(e,t).pipe(Kn(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):function Y9(n){return Xu(IR(!1,3))}())):je({routes:[],injector:e})}}function a7(n){const e=n.value.routeConfig;return e&&""===e.path}function BR(n){const e=[],t=new Set;for(const i of n){if(!a7(i)){e.push(i);continue}const r=e.find(s=>i.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...i.children),t.add(r)):e.push(i)}for(const i of t){const r=BR(i.children);e.push(new ys(i.value,r))}return e.filter(i=>!t.has(i))}function VR(n){return n.data||{}}function HR(n){return n.resolve||{}}function zR(n){return"string"==typeof n.title||null===n.title}function cE(n){return pr(e=>{const t=n(e);return t?Mn(t).pipe(St(()=>e)):je(e)})}const Nl=new Ce("ROUTES");let uE=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=we(kA)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return je(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const i=io(t.loadComponent()).pipe(St(GR),Kn(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),Yu(()=>{this.componentLoaders.delete(t)})),r=new Q1(i,()=>new Qi).pipe(W0());return this.componentLoaders.set(t,r),r}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return je({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const s=function p7(n,e,t,i){return io(n.loadChildren()).pipe(St(GR),kn(r=>r instanceof qT||Array.isArray(r)?je(r):Mn(e.compileModuleAsync(r))),St(r=>{i&&i(n);let s,o,a=!1;return Array.isArray(r)?(o=r,!0):(s=r.create(t).injector,o=s.get(Nl,[],{optional:!0,self:!0}).flat()),{routes:o.map(oE),injector:s}}))}(i,this.compiler,t,this.onLoadEndListener).pipe(Yu(()=>{this.childrenLoaders.delete(i)})),o=new Q1(s,()=>new Qi).pipe(W0());return this.childrenLoaders.set(i,o),o}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function GR(n){return function m7(n){return n&&"object"==typeof n&&"default"in n}(n)?n.default:n}let Ip=(()=>{class n{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Qi,this.transitionAbortSubject=new Qi,this.configLoader=we(uE),this.environmentInjector=we(Ui),this.urlSerializer=we(Ju),this.rootContexts=we(rd),this.inputBindingEnabled=null!==we(xp,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>je(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=r=>this.events.next(new a9(r)),this.configLoader.onLoadStartListener=r=>this.events.next(new o9(r))}complete(){this.transitions?.complete()}handleNavigationRequest(t){const i=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:i})}setupNavigations(t,i,r){return this.transitions=new er({id:0,currentUrlTree:i,currentRawUrl:i,currentBrowserUrl:i,extractedUrl:t.urlHandlingStrategy.extract(i),urlAfterRedirects:t.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:nd,restoredState:null,currentSnapshot:r.snapshot,targetSnapshot:null,currentRouterState:r,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(gs(s=>0!==s.id),St(s=>({...s,extractedUrl:t.urlHandlingStrategy.extract(s.rawUrl)})),pr(s=>{this.currentTransition=s;let o=!1,a=!1;return je(s).pipe(Kn(l=>{this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),pr(l=>{const c=l.currentBrowserUrl.toString(),u=!t.navigated||l.extractedUrl.toString()!==c||c!==l.currentUrlTree.toString();if(!u&&"reload"!==(l.extras.onSameUrlNavigation??t.onSameUrlNavigation)){const h="";return this.events.next(new Tl(l.id,this.urlSerializer.serialize(l.rawUrl),h,0)),l.resolve(null),Dr}if(t.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return je(l).pipe(pr(h=>{const f=this.transitions?.getValue();return this.events.next(new Sp(h.id,this.urlSerializer.serialize(h.extractedUrl),h.source,h.restoredState)),f!==this.transitions?.getValue()?Dr:Promise.resolve(h)}),function l7(n,e,t,i,r,s){return kn(o=>function r7(n,e,t,i,r,s,o="emptyOnly"){return new s7(n,e,t,i,r,o,s).recognize()}(n,e,t,i,o.extractedUrl,r,s).pipe(St(({state:a,tree:l})=>({...o,targetSnapshot:a,urlAfterRedirects:l}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,t.paramsInheritanceStrategy),Kn(h=>{s.targetSnapshot=h.targetSnapshot,s.urlAfterRedirects=h.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:h.urlAfterRedirects};const f=new ER(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(f)}));if(u&&t.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){const{id:h,extractedUrl:f,source:p,restoredState:y,extras:g}=l,m=new Sp(h,this.urlSerializer.serialize(f),p,y);this.events.next(m);const v=MR(0,this.rootComponentType).snapshot;return this.currentTransition=s={...l,targetSnapshot:v,urlAfterRedirects:f,extras:{...g,skipLocationChange:!1,replaceUrl:!1}},je(s)}{const h="";return this.events.next(new Tl(l.id,this.urlSerializer.serialize(l.extractedUrl),h,1)),l.resolve(null),Dr}}),Kn(l=>{const c=new n9(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(c)}),St(l=>(this.currentTransition=s={...l,guards:T9(l.targetSnapshot,l.currentSnapshot,this.rootContexts)},s)),function U9(n,e){return kn(t=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return 0===o.length&&0===s.length?je({...t,guardsResult:!0}):function B9(n,e,t,i){return Mn(n).pipe(kn(r=>function j9(n,e,t,i,r){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?je(s.map(a=>{const l=od(e)??r,c=Il(a,l);return io(function O9(n){return n&&cd(n.canDeactivate)}(c)?c.canDeactivate(n,e,t,i):l.runInContext(()=>c(n,e,t,i))).pipe($o())})).pipe(Rl()):je(!0)}(r.component,r.route,t,e,i)),$o(r=>!0!==r,!0))}(o,i,r,n).pipe(kn(a=>a&&function R9(n){return"boolean"==typeof n}(a)?function V9(n,e,t,i){return Mn(e).pipe(Ml(r=>G0(function z9(n,e){return null!==n&&e&&e(new l9(n)),je(!0)}(r.route.parent,i),function H9(n,e){return null!==n&&e&&e(new u9(n)),je(!0)}(r.route,i),function W9(n,e,t){const i=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function A9(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(o)).filter(o=>null!==o).map(o=>J1(()=>je(o.guards.map(l=>{const c=od(o.node)??t,u=Il(l,c);return io(function L9(n){return n&&cd(n.canActivateChild)}(u)?u.canActivateChild(i,n):c.runInContext(()=>u(i,n))).pipe($o())})).pipe(Rl())));return je(s).pipe(Rl())}(n,r.path,t),function G9(n,e,t){const i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||0===i.length)return je(!0);const r=i.map(s=>J1(()=>{const o=od(e)??t,a=Il(s,o);return io(function N9(n){return n&&cd(n.canActivate)}(a)?a.canActivate(e,n):o.runInContext(()=>a(e,n))).pipe($o())}));return je(r).pipe(Rl())}(n,r.route,t))),$o(r=>!0!==r,!0))}(i,s,n,e):je(a)),St(a=>({...t,guardsResult:a})))})}(this.environmentInjector,l=>this.events.next(l)),Kn(l=>{if(s.guardsResult=l.guardsResult,Yo(l.guardsResult))throw DR(0,l.guardsResult);const c=new i9(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(c)}),gs(l=>!!l.guardsResult||(this.cancelNavigationTransition(l,"",3),!1)),cE(l=>{if(l.guards.canActivateChecks.length)return je(l).pipe(Kn(c=>{const u=new r9(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(u)}),pr(c=>{let u=!1;return je(c).pipe(function c7(n,e){return kn(t=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return je(t);let s=0;return Mn(r).pipe(Ml(o=>function u7(n,e,t,i){const r=n.routeConfig,s=n._resolve;return void 0!==r?.title&&!zR(r)&&(s[Zu]=r.title),function d7(n,e,t,i){const r=function h7(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===r.length)return je({});const s={};return Mn(r).pipe(kn(o=>function f7(n,e,t,i){const r=od(e)??i,s=Il(n,r);return io(s.resolve?s.resolve(e,t):r.runInContext(()=>s(e,t)))}(n[o],e,t,i).pipe($o(),Kn(a=>{s[o]=a}))),j0(1),function C6(n){return St(()=>n)}(s),qo(o=>LR(o)?Dr:Xu(o)))}(s,n,e,i).pipe(St(o=>(n._resolvedData=o,n.data=xR(n,t).resolve,r&&zR(r)&&(n.data[Zu]=r.title),null)))}(o.route,i,n,e)),Kn(()=>s++),j0(1),kn(o=>s===r.length?je(t):Dr))})}(t.paramsInheritanceStrategy,this.environmentInjector),Kn({next:()=>u=!0,complete:()=>{u||this.cancelNavigationTransition(c,"",2)}}))}),Kn(c=>{const u=new s9(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(u)}))}),cE(l=>{const c=u=>{const d=[];u.routeConfig?.loadComponent&&!u.routeConfig._loadedComponent&&d.push(this.configLoader.loadComponent(u.routeConfig).pipe(Kn(h=>{u.component=h}),St(()=>{})));for(const h of u.children)d.push(...c(h));return d};return z0(c(l.targetSnapshot.root)).pipe(mp(),wl(1))}),cE(()=>this.afterPreactivation()),St(l=>{const c=function g9(n,e,t){const i=sd(n,e._root,t?t._root:void 0);return new wR(i,e)}(t.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=s={...l,targetRouterState:c},s}),Kn(()=>{this.events.next(new K0)}),((n,e,t,i)=>St(r=>(new C9(e,r.targetRouterState,r.currentRouterState,t,i).activate(n),r)))(this.rootContexts,t.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),wl(1),Kn({next:l=>{o=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new ro(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),t.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{o=!0}}),function T6(n){return wn((e,t)=>{Ni(n).subscribe(mn(t,()=>t.complete(),lg)),!t.closed&&e.subscribe(t)})}(this.transitionAbortSubject.pipe(Kn(l=>{throw l}))),Yu(()=>{o||a||this.cancelNavigationTransition(s,"",1),this.currentNavigation?.id===s.id&&(this.currentNavigation=null)}),qo(l=>{if(a=!0,RR(l))this.events.next(new id(s.id,this.urlSerializer.serialize(s.extractedUrl),l.message,l.cancellationCode)),function v9(n){return RR(n)&&Yo(n.url)}(l)?this.events.next(new J0(l.url)):s.resolve(!1);else{this.events.next(new wp(s.id,this.urlSerializer.serialize(s.extractedUrl),l,s.targetSnapshot??void 0));try{s.resolve(t.errorHandler(l))}catch(c){s.reject(c)}}return Dr}))}))}cancelNavigationTransition(t,i,r){const s=new id(t.id,this.urlSerializer.serialize(t.extractedUrl),i,r);this.events.next(s),t.resolve(!1)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function WR(n){return n!==nd}let jR=(()=>{class n{buildTitle(t){let i,r=t.root;for(;void 0!==r;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(s=>s.outlet===st);return i}getResolvedTitleForRoute(t){return t.data[Zu]}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Pe({token:n,factory:function(){return we(g7)},providedIn:"root"})}return n})(),g7=(()=>{class n extends jR{constructor(t){super(),this.title=t}updateTitle(t){const i=this.buildTitle(t);void 0!==i&&this.title.setTitle(i)}static#e=this.\u0275fac=function(i){return new(i||n)(xe(iI))};static#t=this.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),y7=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Pe({token:n,factory:function(){return we(v7)},providedIn:"root"})}return n})();class _7{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let v7=(()=>{class n extends _7{static#e=this.\u0275fac=function(){let t;return function(r){return(t||(t=Cn(n)))(r||n)}}();static#t=this.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const Rp=new Ce("",{providedIn:"root",factory:()=>({})});let E7=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Pe({token:n,factory:function(){return we(b7)},providedIn:"root"})}return n})(),b7=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var ud=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(ud||{});function $R(n,e){n.events.pipe(gs(t=>t instanceof ro||t instanceof id||t instanceof wp||t instanceof Tl),St(t=>t instanceof ro||t instanceof Tl?ud.COMPLETE:t instanceof id&&(0===t.code||1===t.code)?ud.REDIRECTING:ud.FAILED),gs(t=>t!==ud.REDIRECTING),wl(1)).subscribe(()=>{e()})}function S7(n){throw n}function w7(n,e,t){return e.parse("/")}const M7={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},x7={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let xi=(()=>{class n{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.location.getState()?.\u0275routerPageId??this.currentPageId}get events(){return this._events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=we(FA),this.isNgZoneEnabled=!1,this._events=new Qi,this.options=we(Rp,{optional:!0})||{},this.pendingTasks=we(Sf),this.errorHandler=this.options.errorHandler||S7,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||w7,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=we(E7),this.routeReuseStrategy=we(y7),this.titleStrategy=we(jR),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=we(Nl,{optional:!0})?.flat()??[],this.navigationTransitions=we(Ip),this.urlSerializer=we(Ju),this.location=we(bv),this.componentInputBindingEnabled=!!we(xp,{optional:!0}),this.eventsSubscription=new Pi,this.isNgZoneEnabled=we(Dt)instanceof Dt&&Dt.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new Cl,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=MR(0,null),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe(t=>{this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const t=this.navigationTransitions.events.subscribe(i=>{try{const{currentTransition:r}=this.navigationTransitions;if(null===r)return void(qR(i)&&this._events.next(i));if(i instanceof Sp)WR(r.source)&&(this.browserUrlTree=r.extractedUrl);else if(i instanceof Tl)this.rawUrlTree=r.rawUrl;else if(i instanceof ER){if("eager"===this.urlUpdateStrategy){if(!r.extras.skipLocationChange){const s=this.urlHandlingStrategy.merge(r.urlAfterRedirects,r.rawUrl);this.setBrowserUrl(s,r)}this.browserUrlTree=r.urlAfterRedirects}}else if(i instanceof K0)this.currentUrlTree=r.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(r.urlAfterRedirects,r.rawUrl),this.routerState=r.targetRouterState,"deferred"===this.urlUpdateStrategy&&(r.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,r),this.browserUrlTree=r.urlAfterRedirects);else if(i instanceof id)0!==i.code&&1!==i.code&&(this.navigated=!0),(3===i.code||2===i.code)&&this.restoreHistory(r);else if(i instanceof J0){const s=this.urlHandlingStrategy.merge(i.url,r.currentRawUrl),o={skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||WR(r.source)};this.scheduleNavigation(s,nd,null,o,{resolve:r.resolve,reject:r.reject,promise:r.promise})}i instanceof wp&&this.restoreHistory(r,!0),i instanceof ro&&(this.navigated=!0),qR(i)&&this._events.next(i)}catch(r){this.navigationTransitions.transitionAbortSubject.next(r)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const t=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),nd,t)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const i="popstate"===t.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{this.navigateToSyncWithBrowser(t.url,i,t.state)},0)}))}navigateToSyncWithBrowser(t,i,r){const s={replaceUrl:!0},o=r?.navigationId?r:null;if(r){const l={...r};delete l.navigationId,delete l.\u0275routerPageId,0!==Object.keys(l).length&&(s.state=l)}const a=this.parseUrl(t);this.scheduleNavigation(a,i,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(oE),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,i={}){const{relativeTo:r,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:l}=i,c=l?this.currentUrlTree.fragment:o;let d,u=null;switch(a){case"merge":u={...this.currentUrlTree.queryParams,...s};break;case"preserve":u=this.currentUrlTree.queryParams;break;default:u=s||null}null!==u&&(u=this.removeEmptyProps(u));try{d=fR(r?r.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof t[0]||!t[0].startsWith("/"))&&(t=[]),d=this.currentUrlTree.root}return pR(d,t,u,c??null)}navigateByUrl(t,i={skipLocationChange:!1}){const r=Yo(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,nd,null,i)}navigate(t,i={skipLocationChange:!1}){return function C7(n){for(let e=0;e<n.length;e++)if(null==n[e])throw new j(4008,!1)}(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let i;try{i=this.urlSerializer.parse(t)}catch(r){i=this.malformedUriErrorHandler(r,this.urlSerializer,t)}return i}isActive(t,i){let r;if(r=!0===i?{...M7}:!1===i?{...x7}:i,Yo(t))return rR(this.currentUrlTree,t,r);const s=this.parseUrl(t);return rR(this.currentUrlTree,s,r)}removeEmptyProps(t){return Object.keys(t).reduce((i,r)=>{const s=t[r];return null!=s&&(i[r]=s),i},{})}scheduleNavigation(t,i,r,s,o){if(this.disposed)return Promise.resolve(!1);let a,l,c;o?(a=o.resolve,l=o.reject,c=o.promise):c=new Promise((d,h)=>{a=d,l=h});const u=this.pendingTasks.add();return $R(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(u))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,currentBrowserUrl:this.browserUrlTree,rawUrl:t,extras:s,resolve:a,reject:l,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(d=>Promise.reject(d))}setBrowserUrl(t,i){const r=this.urlSerializer.serialize(t);if(this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl){const o={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId)};this.location.replaceState(r,"",o)}else{const s={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId+1)};this.location.go(r,"",s)}}restoreHistory(t,i=!1){if("computed"===this.canceledNavigationResolution){const s=this.currentPageId-this.browserPageId;0!==s?this.location.historyGo(s):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===s&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function qR(n){return!(n instanceof K0||n instanceof J0)}class XR{}let D7=(()=>{class n{constructor(t,i,r,s,o){this.router=t,this.injector=r,this.preloadingStrategy=s,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(gs(t=>t instanceof ro),Ml(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,i){const r=[];for(const s of i){s.providers&&!s._injector&&(s._injector=z_(s.providers,t,`Route: ${s.path}`));const o=s._injector??t,a=s._loadedInjector??o;(s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent)&&r.push(this.preloadConfig(o,s)),(s.children||s._loadedRoutes)&&r.push(this.processRoutes(a,s.children??s._loadedRoutes))}return Mn(r).pipe(wa())}preloadConfig(t,i){return this.preloadingStrategy.preload(i,()=>{let r;r=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(t,i):je(null);const s=r.pipe(kn(o=>null===o?je(void 0):(i._loadedRoutes=o.routes,i._loadedInjector=o.injector,this.processRoutes(o.injector??t,o.routes))));return i.loadComponent&&!i._loadedComponent?Mn([s,this.loader.loadComponent(i)]).pipe(wa()):s})}static#e=this.\u0275fac=function(i){return new(i||n)(xe(xi),xe(kA),xe(Ui),xe(XR),xe(uE))};static#t=this.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const hE=new Ce("");let YR=(()=>{class n{constructor(t,i,r,s,o={}){this.urlSerializer=t,this.transitions=i,this.viewportScroller=r,this.zone=s,this.options=o,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},o.scrollPositionRestoration=o.scrollPositionRestoration||"disabled",o.anchorScrolling=o.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof Sp?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof ro?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof Tl&&0===t.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof bR&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new bR(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static#e=this.\u0275fac=function(i){!function Ox(){throw new Error("invalid")}()};static#t=this.\u0275prov=Pe({token:n,factory:n.\u0275fac})}return n})();function _s(n,e){return{\u0275kind:n,\u0275providers:e}}function KR(){const n=we(Bi);return e=>{const t=n.get(Uo);if(e!==t.components[0])return;const i=n.get(xi),r=n.get(JR);1===n.get(fE)&&i.initialNavigation(),n.get(QR,null,ht.Optional)?.setUpPreloading(),n.get(hE,null,ht.Optional)?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}const JR=new Ce("",{factory:()=>new Qi}),fE=new Ce("",{providedIn:"root",factory:()=>1}),QR=new Ce("");function N7(n){return _s(0,[{provide:QR,useExisting:D7},{provide:XR,useExisting:n}])}const eP=new Ce("ROUTER_FORROOT_GUARD"),O7=[bv,{provide:Ju,useClass:$0},xi,rd,{provide:Dl,useFactory:function ZR(n){return n.routerState.root},deps:[xi]},uE,[]];function F7(){return new WA("Router",xi)}let tP=(()=>{class n{constructor(t){}static forRoot(t,i){return{ngModule:n,providers:[O7,[],{provide:Nl,multi:!0,useValue:t},{provide:eP,useFactory:V7,deps:[[xi,new wh,new Mh]]},{provide:Rp,useValue:i||{}},i?.useHash?{provide:Vo,useClass:KG}:{provide:Vo,useClass:ED},{provide:hE,useFactory:()=>{const n=we(y5),e=we(Dt),t=we(Rp),i=we(Ip),r=we(Ju);return t.scrollOffset&&n.setOffset(t.scrollOffset),new YR(r,i,n,e,t)}},i?.preloadingStrategy?N7(i.preloadingStrategy).\u0275providers:[],{provide:WA,multi:!0,useFactory:F7},i?.initialNavigation?H7(i):[],i?.bindToComponentInputs?_s(8,[AR,{provide:xp,useExisting:AR}]).\u0275providers:[],[{provide:nP,useFactory:KR},{provide:dv,multi:!0,useExisting:nP}]]}}static forChild(t){return{ngModule:n,providers:[{provide:Nl,multi:!0,useValue:t}]}}static#e=this.\u0275fac=function(i){return new(i||n)(xe(eP,8))};static#t=this.\u0275mod=jn({type:n});static#n=this.\u0275inj=Un({})}return n})();function V7(n){return"guarded"}function H7(n){return["disabled"===n.initialNavigation?_s(3,[{provide:iv,multi:!0,useFactory:()=>{const e=we(xi);return()=>{e.setUpLocationChangeListener()}}},{provide:fE,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?_s(2,[{provide:fE,useValue:0},{provide:iv,multi:!0,deps:[Bi],useFactory:e=>{const t=e.get(YG,Promise.resolve());return()=>t.then(()=>new Promise(i=>{const r=e.get(xi),s=e.get(JR);$R(r,()=>{i(!0)}),e.get(Ip).afterPreactivation=()=>(i(!0),s.closed?je(void 0):s),r.initialNavigation()}))}}]).\u0275providers:[]]}const nP=new Ce("");function iP(n,e,t,i,r,s,o){try{var a=n[s](o),l=a.value}catch(c){return void t(c)}a.done?e(l):Promise.resolve(l).then(i,r)}function Xt(n){return function(){var e=this,t=arguments;return new Promise(function(i,r){var s=n.apply(e,t);function o(l){iP(s,i,r,o,a,"next",l)}function a(l){iP(s,i,r,o,a,"throw",l)}o(void 0)})}}const sP=1,j7=2,vs=3,Pp=0,dq=1,hq=2,ao=0,fq=1,pq=2,mq=3,gq=4,yq=5,lo=301,Zo=302,dd=306,ui=1001,yn=1003,_n=1006,Ko=1008,co=1009,uo=1014,bs=1015,hd=1016,Jo=1020,ur=1023,Qo=1026,Ul=1027,ea=3001,Pn="srgb",Ss="srgb-linear",CE="display-p3",Hp="display-p3-linear",zp="linear",zt="srgb",Gp="rec709",Wp="p3",qP="300 es",ws=2e3;class na{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const r=this._listeners[e];if(void 0!==r){const s=r.indexOf(t);-1!==s&&r.splice(s,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const i=this._listeners[e.type];if(void 0!==i){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const Jn=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];const ia=Math.PI/180,Hl=180/Math.PI;function ji(){const n=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(Jn[255&n]+Jn[n>>8&255]+Jn[n>>16&255]+Jn[n>>24&255]+"-"+Jn[255&e]+Jn[e>>8&255]+"-"+Jn[e>>16&15|64]+Jn[e>>24&255]+"-"+Jn[63&t|128]+Jn[t>>8&255]+"-"+Jn[t>>16&255]+Jn[t>>24&255]+Jn[255&i]+Jn[i>>8&255]+Jn[i>>16&255]+Jn[i>>24&255]).toLowerCase()}function rn(n,e,t){return Math.max(e,Math.min(t,n))}function DE(n,e){return(n%e+e)%e}function fd(n,e,t){return(1-t)*n+t*e}function IE(n){return 0==(n&n-1)&&0!==n}function qp(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function Ti(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function at(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(4294967295*n);case Uint16Array:return Math.round(65535*n);case Uint8Array:return Math.round(255*n);case Int32Array:return Math.round(2147483647*n);case Int16Array:return Math.round(32767*n);case Int8Array:return Math.round(127*n);default:throw new Error("Invalid component type.")}}const ZP_DEG2RAD=ia,ZP_randInt=function Xq(n,e){return n+Math.floor(Math.random()*(e-n+1))};class K{constructor(e=0,t=0){K.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(rn(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class dt{constructor(e,t,i,r,s,o,a,l,c){dt.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,i,r,s,o,a,l,c)}set(e,t,i,r,s,o,a,l,c){const u=this.elements;return u[0]=e,u[1]=r,u[2]=a,u[3]=t,u[4]=s,u[5]=l,u[6]=i,u[7]=o,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[3],l=i[6],c=i[1],u=i[4],d=i[7],h=i[2],f=i[5],p=i[8],y=r[0],g=r[3],m=r[6],v=r[1],_=r[4],E=r[7],S=r[2],x=r[5],M=r[8];return s[0]=o*y+a*v+l*S,s[3]=o*g+a*_+l*x,s[6]=o*m+a*E+l*M,s[1]=c*y+u*v+d*S,s[4]=c*g+u*_+d*x,s[7]=c*m+u*E+d*M,s[2]=h*y+f*v+p*S,s[5]=h*g+f*_+p*x,s[8]=h*m+f*E+p*M,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8];return t*o*u-t*a*c-i*s*u+i*a*l+r*s*c-r*o*l}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],d=u*o-a*c,h=a*l-u*s,f=c*s-o*l,p=t*d+i*h+r*f;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const y=1/p;return e[0]=d*y,e[1]=(r*c-u*i)*y,e[2]=(a*i-r*o)*y,e[3]=h*y,e[4]=(u*t-r*l)*y,e[5]=(r*s-a*t)*y,e[6]=f*y,e[7]=(i*l-c*t)*y,e[8]=(o*t-i*s)*y,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(i*l,i*c,-i*(l*o+c*a)+o+e,-r*c,r*l,-r*(-c*o+l*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(RE.makeScale(e,t)),this}rotate(e){return this.premultiply(RE.makeRotation(-e)),this}translate(e,t){return this.premultiply(RE.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const RE=new dt;function KP(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function pd(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function nX(){const n=pd("canvas");return n.style.display="block",n}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const JP={};function md(n){n in JP||(JP[n]=!0,console.warn(n))}const QP=(new dt).set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),eN=(new dt).set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),Xp={[Ss]:{transfer:zp,primaries:Gp,toReference:n=>n,fromReference:n=>n},[Pn]:{transfer:zt,primaries:Gp,toReference:n=>n.convertSRGBToLinear(),fromReference:n=>n.convertLinearToSRGB()},[Hp]:{transfer:zp,primaries:Wp,toReference:n=>n.applyMatrix3(eN),fromReference:n=>n.applyMatrix3(QP)},[CE]:{transfer:zt,primaries:Wp,toReference:n=>n.convertSRGBToLinear().applyMatrix3(eN),fromReference:n=>n.applyMatrix3(QP).convertLinearToSRGB()}},iX=new Set([Ss,Hp]),Pt={enabled:!0,_workingColorSpace:Ss,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(n){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!n},get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(n){if(!iX.has(n))throw new Error(`Unsupported working color space, "${n}".`);this._workingColorSpace=n},convert:function(n,e,t){return!1!==this.enabled&&e!==t&&e&&t?(0,Xp[t].fromReference)((0,Xp[e].toReference)(n)):n},fromWorkingColorSpace:function(n,e){return this.convert(n,this._workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this._workingColorSpace)},getPrimaries:function(n){return Xp[n].primaries},getTransfer:function(n){return""===n?zp:Xp[n].transfer}};function Gl(n){return n<.04045?.0773993808*n:Math.pow(.9478672986*n+.0521327014,2.4)}function PE(n){return n<.0031308?12.92*n:1.055*Math.pow(n,.41666)-.055}let Wl;class tN{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===Wl&&(Wl=pd("canvas")),Wl.width=e.width,Wl.height=e.height;const i=Wl.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=Wl}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=pd("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=255*Gl(s[o]/255);return i.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t[i]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*Gl(t[i]/255)):Gl(t[i]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let rX=0;class jl{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:rX++}),this.uuid=ji(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(null!==r){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)s.push(NE(r[o].isDataTexture?r[o].image:r[o]))}else s=NE(r);i.url=s}return t||(e.images[this.uuid]=i),i}}function NE(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?tN.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let sX=0,ho=(()=>{class n extends na{constructor(t=n.DEFAULT_IMAGE,i=n.DEFAULT_MAPPING,r=ui,s=ui,o=_n,a=Ko,l=ur,c=co,u=n.DEFAULT_ANISOTROPY,d=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:sX++}),this.uuid=ji(),this.name="",this.source=new jl(t),this.mipmaps=[],this.mapping=i,this.channel=0,this.wrapS=r,this.wrapT=s,this.magFilter=o,this.minFilter=a,this.anisotropy=u,this.format=l,this.internalFormat=null,this.type=c,this.offset=new K(0,0),this.repeat=new K(1,1),this.center=new K(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new dt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,"string"==typeof d?this.colorSpace=d:(md("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=d===ea?Pn:""),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const i=void 0===t||"string"==typeof t;if(!i&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),i||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case 1e3:t.x=t.x-Math.floor(t.x);break;case ui:t.x=t.x<0?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case 1e3:t.y=t.y-Math.floor(t.y);break;case ui:t.y=t.y<0?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return md("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===Pn?ea:3e3}set encoding(t){md("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=t===ea?Pn:""}}return n.DEFAULT_IMAGE=null,n.DEFAULT_MAPPING=300,n.DEFAULT_ANISOTROPY=1,n})();class Nt{constructor(e=0,t=0,i=0,r=1){Nt.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*i+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,s;const l=e.elements,c=l[0],u=l[4],d=l[8],h=l[1],f=l[5],p=l[9],y=l[2],g=l[6],m=l[10];if(Math.abs(u-h)<.01&&Math.abs(d-y)<.01&&Math.abs(p-g)<.01){if(Math.abs(u+h)<.1&&Math.abs(d+y)<.1&&Math.abs(p+g)<.1&&Math.abs(c+f+m-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const _=(c+1)/2,E=(f+1)/2,S=(m+1)/2,x=(u+h)/4,M=(d+y)/4,R=(p+g)/4;return _>E&&_>S?_<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(_),r=x/i,s=M/i):E>S?E<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(E),i=x/r,s=R/r):S<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(S),i=M/s,r=R/s),this.set(i,r,s,t),this}let v=Math.sqrt((g-p)*(g-p)+(d-y)*(d-y)+(h-u)*(h-u));return Math.abs(v)<.001&&(v=1),this.x=(g-p)/v,this.y=(d-y)/v,this.z=(h-u)/v,this.w=Math.acos((c+f+m-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class oX extends na{constructor(e=1,t=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Nt(0,0,e,t),this.scissorTest=!1,this.viewport=new Nt(0,0,e,t);const r={width:e,height:t,depth:1};void 0!==i.encoding&&(md("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),i.colorSpace=i.encoding===ea?Pn:""),i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:_n,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},i),this.texture=new ho(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps,this.texture.internalFormat=i.internalFormat,this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.depthTexture=i.depthTexture,this.samples=i.samples}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new jl(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class ra extends oX{constructor(e=1,t=1,i={}){super(e,t,i),this.isWebGLRenderTarget=!0}}class LE extends ho{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=yn,this.minFilter=yn,this.wrapR=ui,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class nN extends ho{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=yn,this.minFilter=yn,this.wrapR=ui,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class di{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,s,o,a){let l=i[r+0],c=i[r+1],u=i[r+2],d=i[r+3];const h=s[o+0],f=s[o+1],p=s[o+2],y=s[o+3];if(0===a)return e[t+0]=l,e[t+1]=c,e[t+2]=u,void(e[t+3]=d);if(1===a)return e[t+0]=h,e[t+1]=f,e[t+2]=p,void(e[t+3]=y);if(d!==y||l!==h||c!==f||u!==p){let g=1-a;const m=l*h+c*f+u*p+d*y,v=m>=0?1:-1,_=1-m*m;if(_>Number.EPSILON){const S=Math.sqrt(_),x=Math.atan2(S,m*v);g=Math.sin(g*x)/S,a=Math.sin(a*x)/S}const E=a*v;if(l=l*g+h*E,c=c*g+f*E,u=u*g+p*E,d=d*g+y*E,g===1-a){const S=1/Math.sqrt(l*l+c*c+u*u+d*d);l*=S,c*=S,u*=S,d*=S}}e[t]=l,e[t+1]=c,e[t+2]=u,e[t+3]=d}static multiplyQuaternionsFlat(e,t,i,r,s,o){const a=i[r],l=i[r+1],c=i[r+2],u=i[r+3],d=s[o],h=s[o+1],f=s[o+2],p=s[o+3];return e[t]=a*p+u*d+l*f-c*h,e[t+1]=l*p+u*h+c*d-a*f,e[t+2]=c*p+u*f+a*h-l*d,e[t+3]=u*p-a*d-l*h-c*f,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,c=a(i/2),u=a(r/2),d=a(s/2),h=l(i/2),f=l(r/2),p=l(s/2);switch(o){case"XYZ":this._x=h*u*d+c*f*p,this._y=c*f*d-h*u*p,this._z=c*u*p+h*f*d,this._w=c*u*d-h*f*p;break;case"YXZ":this._x=h*u*d+c*f*p,this._y=c*f*d-h*u*p,this._z=c*u*p-h*f*d,this._w=c*u*d+h*f*p;break;case"ZXY":this._x=h*u*d-c*f*p,this._y=c*f*d+h*u*p,this._z=c*u*p+h*f*d,this._w=c*u*d-h*f*p;break;case"ZYX":this._x=h*u*d-c*f*p,this._y=c*f*d+h*u*p,this._z=c*u*p-h*f*d,this._w=c*u*d+h*f*p;break;case"YZX":this._x=h*u*d+c*f*p,this._y=c*f*d+h*u*p,this._z=c*u*p-h*f*d,this._w=c*u*d-h*f*p;break;case"XZY":this._x=h*u*d-c*f*p,this._y=c*f*d-h*u*p,this._z=c*u*p+h*f*d,this._w=c*u*d+h*f*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],s=t[8],o=t[1],a=t[5],l=t[9],c=t[2],u=t[6],d=t[10],h=i+a+d;if(h>0){const f=.5/Math.sqrt(h+1);this._w=.25/f,this._x=(u-l)*f,this._y=(s-c)*f,this._z=(o-r)*f}else if(i>a&&i>d){const f=2*Math.sqrt(1+i-a-d);this._w=(u-l)/f,this._x=.25*f,this._y=(r+o)/f,this._z=(s+c)/f}else if(a>d){const f=2*Math.sqrt(1+a-i-d);this._w=(s-c)/f,this._x=(r+o)/f,this._y=.25*f,this._z=(l+u)/f}else{const f=2*Math.sqrt(1+d-i-a);this._w=(o-r)/f,this._x=(s+c)/f,this._y=(l+u)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(rn(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(0===i)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,s=e._z,o=e._w,a=t._x,l=t._y,c=t._z,u=t._w;return this._x=i*u+o*a+r*c-s*l,this._y=r*u+o*l+s*a-i*c,this._z=s*u+o*c+i*l-r*a,this._w=o*u-i*a-r*l-s*c,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const i=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const f=1-t;return this._w=f*o+t*this._w,this._x=f*i+t*this._x,this._y=f*r+t*this._y,this._z=f*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const c=Math.sqrt(l),u=Math.atan2(c,a),d=Math.sin((1-t)*u)/c,h=Math.sin(t*u)/c;return this._w=o*d+this._w*h,this._x=i*d+this._x*h,this._y=r*d+this._y*h,this._z=s*d+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(r),i*Math.sin(s),i*Math.cos(s),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class T{constructor(e=0,t=0,i=0){T.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return void 0===i&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(iN.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(iN.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*r,this.y=s[1]*t+s[4]*i+s[7]*r,this.z=s[2]*t+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=l*t+o*r-a*i,u=l*i+a*t-s*r,d=l*r+s*i-o*t,h=-s*t-o*i-a*r;return this.x=c*l+h*-s+u*-a-d*-o,this.y=u*l+h*-o+d*-s-c*-a,this.z=d*l+h*-a+c*-o-u*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r,this.y=s[1]*t+s[5]*i+s[9]*r,this.z=s[2]*t+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=r*l-s*a,this.y=s*o-i*l,this.z=i*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return OE.copy(this).projectOnVector(e),this.sub(OE)}reflect(e){return this.sub(OE.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(rn(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const OE=new T,iN=new di;class Ms{constructor(e=new T(1/0,1/0,1/0),t=new T(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(Cs.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(Cs.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=Cs.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){if(e.updateWorldMatrix(!1,!1),void 0!==e.boundingBox)null===e.boundingBox&&e.computeBoundingBox(),$l.copy(e.boundingBox),$l.applyMatrix4(e.matrixWorld),this.union($l);else{const r=e.geometry;if(void 0!==r)if(t&&void 0!==r.attributes&&void 0!==r.attributes.position){const s=r.attributes.position;for(let o=0,a=s.count;o<a;o++)Cs.fromBufferAttribute(s,o).applyMatrix4(e.matrixWorld),this.expandByPoint(Cs)}else null===r.boundingBox&&r.computeBoundingBox(),$l.copy(r.boundingBox),$l.applyMatrix4(e.matrixWorld),this.union($l)}const i=e.children;for(let r=0,s=i.length;r<s;r++)this.expandByObject(i[r],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Cs),Cs.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(gd),Yp.subVectors(this.max,gd),ql.subVectors(e.a,gd),Xl.subVectors(e.b,gd),Yl.subVectors(e.c,gd),fo.subVectors(Xl,ql),po.subVectors(Yl,Xl),sa.subVectors(ql,Yl);let t=[0,-fo.z,fo.y,0,-po.z,po.y,0,-sa.z,sa.y,fo.z,0,-fo.x,po.z,0,-po.x,sa.z,0,-sa.x,-fo.y,fo.x,0,-po.y,po.x,0,-sa.y,sa.x,0];return!(!FE(t,ql,Xl,Yl,Yp)||(t=[1,0,0,0,1,0,0,0,1],!FE(t,ql,Xl,Yl,Yp)))&&(Zp.crossVectors(fo,po),t=[Zp.x,Zp.y,Zp.z],FE(t,ql,Xl,Yl,Yp))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Cs).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(Cs).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(xs[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),xs[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),xs[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),xs[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),xs[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),xs[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),xs[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),xs[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(xs)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const xs=[new T,new T,new T,new T,new T,new T,new T,new T],Cs=new T,$l=new Ms,ql=new T,Xl=new T,Yl=new T,fo=new T,po=new T,sa=new T,gd=new T,Yp=new T,Zp=new T,oa=new T;function FE(n,e,t,i,r){for(let s=0,o=n.length-3;s<=o;s+=3){oa.fromArray(n,s);const a=r.x*Math.abs(oa.x)+r.y*Math.abs(oa.y)+r.z*Math.abs(oa.z),l=e.dot(oa),c=t.dot(oa),u=i.dot(oa);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>a)return!1}return!0}const aX=new Ms,yd=new T,kE=new T;class qr{constructor(e=new T,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;void 0!==t?i.copy(t):aX.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;yd.subVectors(e,this.center);const t=yd.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=.5*(i-this.radius);this.center.addScaledVector(yd,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(kE.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(yd.copy(e.center).add(kE)),this.expandByPoint(yd.copy(e.center).sub(kE))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Ts=new T,UE=new T,Kp=new T,mo=new T,BE=new T,Jp=new T,VE=new T;class Zl{constructor(e=new T,t=new T(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Ts)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Ts.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Ts.copy(this.origin).addScaledVector(this.direction,t),Ts.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){UE.copy(e).add(t).multiplyScalar(.5),Kp.copy(t).sub(e).normalize(),mo.copy(this.origin).sub(UE);const s=.5*e.distanceTo(t),o=-this.direction.dot(Kp),a=mo.dot(this.direction),l=-mo.dot(Kp),c=mo.lengthSq(),u=Math.abs(1-o*o);let d,h,f,p;if(u>0)if(d=o*l-a,h=o*a-l,p=s*u,d>=0)if(h>=-p)if(h<=p){const y=1/u;d*=y,h*=y,f=d*(d+o*h+2*a)+h*(o*d+h+2*l)+c}else h=s,d=Math.max(0,-(o*h+a)),f=-d*d+h*(h+2*l)+c;else h=-s,d=Math.max(0,-(o*h+a)),f=-d*d+h*(h+2*l)+c;else h<=-p?(d=Math.max(0,-(-o*s+a)),h=d>0?-s:Math.min(Math.max(-s,-l),s),f=-d*d+h*(h+2*l)+c):h<=p?(d=0,h=Math.min(Math.max(-s,-l),s),f=h*(h+2*l)+c):(d=Math.max(0,-(o*s+a)),h=d>0?s:Math.min(Math.max(-s,-l),s),f=-d*d+h*(h+2*l)+c);else h=o>0?-s:s,d=Math.max(0,-(o*h+a)),f=-d*d+h*(h+2*l)+c;return i&&i.copy(this.origin).addScaledVector(this.direction,d),r&&r.copy(UE).addScaledVector(Kp,h),f}intersectSphere(e,t){Ts.subVectors(e.center,this.origin);const i=Ts.dot(this.direction),r=Ts.dot(Ts)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=i-o,l=i+o;return l<0?null:this.at(a<0?l:a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return null===i?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,s,o,a,l;const c=1/this.direction.x,u=1/this.direction.y,d=1/this.direction.z,h=this.origin;return c>=0?(i=(e.min.x-h.x)*c,r=(e.max.x-h.x)*c):(i=(e.max.x-h.x)*c,r=(e.min.x-h.x)*c),u>=0?(s=(e.min.y-h.y)*u,o=(e.max.y-h.y)*u):(s=(e.max.y-h.y)*u,o=(e.min.y-h.y)*u),i>o||s>r||((s>i||isNaN(i))&&(i=s),(o<r||isNaN(r))&&(r=o),d>=0?(a=(e.min.z-h.z)*d,l=(e.max.z-h.z)*d):(a=(e.max.z-h.z)*d,l=(e.min.z-h.z)*d),i>l||a>r)||((a>i||i!=i)&&(i=a),(l<r||r!=r)&&(r=l),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return null!==this.intersectBox(e,Ts)}intersectTriangle(e,t,i,r,s){BE.subVectors(t,e),Jp.subVectors(i,e),VE.crossVectors(BE,Jp);let a,o=this.direction.dot(VE);if(o>0){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}mo.subVectors(this.origin,e);const l=a*this.direction.dot(Jp.crossVectors(mo,Jp));if(l<0)return null;const c=a*this.direction.dot(BE.cross(mo));if(c<0||l+c>o)return null;const u=-a*mo.dot(VE);return u<0?null:this.at(u/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class ot{constructor(e,t,i,r,s,o,a,l,c,u,d,h,f,p,y,g){ot.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,i,r,s,o,a,l,c,u,d,h,f,p,y,g)}set(e,t,i,r,s,o,a,l,c,u,d,h,f,p,y,g){const m=this.elements;return m[0]=e,m[4]=t,m[8]=i,m[12]=r,m[1]=s,m[5]=o,m[9]=a,m[13]=l,m[2]=c,m[6]=u,m[10]=d,m[14]=h,m[3]=f,m[7]=p,m[11]=y,m[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new ot).fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/Kl.setFromMatrixColumn(e,0).length(),s=1/Kl.setFromMatrixColumn(e,1).length(),o=1/Kl.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),l=Math.cos(r),c=Math.sin(r),u=Math.cos(s),d=Math.sin(s);if("XYZ"===e.order){const h=o*u,f=o*d,p=a*u,y=a*d;t[0]=l*u,t[4]=-l*d,t[8]=c,t[1]=f+p*c,t[5]=h-y*c,t[9]=-a*l,t[2]=y-h*c,t[6]=p+f*c,t[10]=o*l}else if("YXZ"===e.order){const h=l*u,f=l*d,p=c*u,y=c*d;t[0]=h+y*a,t[4]=p*a-f,t[8]=o*c,t[1]=o*d,t[5]=o*u,t[9]=-a,t[2]=f*a-p,t[6]=y+h*a,t[10]=o*l}else if("ZXY"===e.order){const h=l*u,f=l*d,p=c*u,y=c*d;t[0]=h-y*a,t[4]=-o*d,t[8]=p+f*a,t[1]=f+p*a,t[5]=o*u,t[9]=y-h*a,t[2]=-o*c,t[6]=a,t[10]=o*l}else if("ZYX"===e.order){const h=o*u,f=o*d,p=a*u,y=a*d;t[0]=l*u,t[4]=p*c-f,t[8]=h*c+y,t[1]=l*d,t[5]=y*c+h,t[9]=f*c-p,t[2]=-c,t[6]=a*l,t[10]=o*l}else if("YZX"===e.order){const h=o*l,f=o*c,p=a*l,y=a*c;t[0]=l*u,t[4]=y-h*d,t[8]=p*d+f,t[1]=d,t[5]=o*u,t[9]=-a*u,t[2]=-c*u,t[6]=f*d+p,t[10]=h-y*d}else if("XZY"===e.order){const h=o*l,f=o*c,p=a*l,y=a*c;t[0]=l*u,t[4]=-d,t[8]=c*u,t[1]=h*d+y,t[5]=o*u,t[9]=f*d-p,t[2]=p*d-f,t[6]=a*u,t[10]=y*d+h}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(lX,e,cX)}lookAt(e,t,i){const r=this.elements;return $i.subVectors(e,t),0===$i.lengthSq()&&($i.z=1),$i.normalize(),go.crossVectors(i,$i),0===go.lengthSq()&&(1===Math.abs(i.z)?$i.x+=1e-4:$i.z+=1e-4,$i.normalize(),go.crossVectors(i,$i)),go.normalize(),Qp.crossVectors($i,go),r[0]=go.x,r[4]=Qp.x,r[8]=$i.x,r[1]=go.y,r[5]=Qp.y,r[9]=$i.y,r[2]=go.z,r[6]=Qp.z,r[10]=$i.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[4],l=i[8],c=i[12],u=i[1],d=i[5],h=i[9],f=i[13],p=i[2],y=i[6],g=i[10],m=i[14],v=i[3],_=i[7],E=i[11],S=i[15],x=r[0],M=r[4],R=r[8],b=r[12],C=r[1],U=r[5],Y=r[9],ee=r[13],L=r[2],G=r[6],F=r[10],k=r[14],W=r[3],V=r[7],Z=r[11],O=r[15];return s[0]=o*x+a*C+l*L+c*W,s[4]=o*M+a*U+l*G+c*V,s[8]=o*R+a*Y+l*F+c*Z,s[12]=o*b+a*ee+l*k+c*O,s[1]=u*x+d*C+h*L+f*W,s[5]=u*M+d*U+h*G+f*V,s[9]=u*R+d*Y+h*F+f*Z,s[13]=u*b+d*ee+h*k+f*O,s[2]=p*x+y*C+g*L+m*W,s[6]=p*M+y*U+g*G+m*V,s[10]=p*R+y*Y+g*F+m*Z,s[14]=p*b+y*ee+g*k+m*O,s[3]=v*x+_*C+E*L+S*W,s[7]=v*M+_*U+E*G+S*V,s[11]=v*R+_*Y+E*F+S*Z,s[15]=v*b+_*ee+E*k+S*O,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],u=e[2],d=e[6],h=e[10],f=e[14];return e[3]*(+s*l*d-r*c*d-s*a*h+i*c*h+r*a*f-i*l*f)+e[7]*(+t*l*f-t*c*h+s*o*h-r*o*f+r*c*u-s*l*u)+e[11]*(+t*c*d-t*a*f-s*o*d+i*o*f+s*a*u-i*c*u)+e[15]*(-r*a*u-t*l*d+t*a*h+r*o*d-i*o*h+i*l*u)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],d=e[9],h=e[10],f=e[11],p=e[12],y=e[13],g=e[14],m=e[15],v=d*g*c-y*h*c+y*l*f-a*g*f-d*l*m+a*h*m,_=p*h*c-u*g*c-p*l*f+o*g*f+u*l*m-o*h*m,E=u*y*c-p*d*c+p*a*f-o*y*f-u*a*m+o*d*m,S=p*d*l-u*y*l-p*a*h+o*y*h+u*a*g-o*d*g,x=t*v+i*_+r*E+s*S;if(0===x)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const M=1/x;return e[0]=v*M,e[1]=(y*h*s-d*g*s-y*r*f+i*g*f+d*r*m-i*h*m)*M,e[2]=(a*g*s-y*l*s+y*r*c-i*g*c-a*r*m+i*l*m)*M,e[3]=(d*l*s-a*h*s-d*r*c+i*h*c+a*r*f-i*l*f)*M,e[4]=_*M,e[5]=(u*g*s-p*h*s+p*r*f-t*g*f-u*r*m+t*h*m)*M,e[6]=(p*l*s-o*g*s-p*r*c+t*g*c+o*r*m-t*l*m)*M,e[7]=(o*h*s-u*l*s+u*r*c-t*h*c-o*r*f+t*l*f)*M,e[8]=E*M,e[9]=(p*d*s-u*y*s-p*i*f+t*y*f+u*i*m-t*d*m)*M,e[10]=(o*y*s-p*a*s+p*i*c-t*y*c-o*i*m+t*a*m)*M,e[11]=(u*a*s-o*d*s-u*i*c+t*d*c+o*i*f-t*a*f)*M,e[12]=S*M,e[13]=(u*y*r-p*d*r+p*i*h-t*y*h-u*i*g+t*d*g)*M,e[14]=(p*a*r-o*y*r-p*i*l+t*y*l+o*i*g-t*a*g)*M,e[15]=(o*d*r-u*a*r+u*i*l-t*d*l-o*i*h+t*a*h)*M,this}scale(e){const t=this.elements,i=e.x,r=e.y,s=e.z;return t[0]*=i,t[4]*=r,t[8]*=s,t[1]*=i,t[5]*=r,t[9]*=s,t[2]*=i,t[6]*=r,t[10]*=s,t[3]*=i,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),s=1-i,o=e.x,a=e.y,l=e.z,c=s*o,u=s*a;return this.set(c*o+i,c*a-r*l,c*l+r*a,0,c*a+r*l,u*a+i,u*l-r*o,0,c*l-r*a,u*l+r*o,s*l*l+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,c=s+s,u=o+o,d=a+a,h=s*c,f=s*u,p=s*d,y=o*u,g=o*d,m=a*d,v=l*c,_=l*u,E=l*d,S=i.x,x=i.y,M=i.z;return r[0]=(1-(y+m))*S,r[1]=(f+E)*S,r[2]=(p-_)*S,r[3]=0,r[4]=(f-E)*x,r[5]=(1-(h+m))*x,r[6]=(g+v)*x,r[7]=0,r[8]=(p+_)*M,r[9]=(g-v)*M,r[10]=(1-(h+y))*M,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let s=Kl.set(r[0],r[1],r[2]).length();const o=Kl.set(r[4],r[5],r[6]).length(),a=Kl.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],Cr.copy(this);const c=1/s,u=1/o,d=1/a;return Cr.elements[0]*=c,Cr.elements[1]*=c,Cr.elements[2]*=c,Cr.elements[4]*=u,Cr.elements[5]*=u,Cr.elements[6]*=u,Cr.elements[8]*=d,Cr.elements[9]*=d,Cr.elements[10]*=d,t.setFromRotationMatrix(Cr),i.x=s,i.y=o,i.z=a,this}makePerspective(e,t,i,r,s,o,a=ws){const l=this.elements,c=2*s/(t-e),u=2*s/(i-r),d=(t+e)/(t-e),h=(i+r)/(i-r);let f,p;if(a===ws)f=-(o+s)/(o-s),p=-2*o*s/(o-s);else{if(2001!==a)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);f=-o/(o-s),p=-o*s/(o-s)}return l[0]=c,l[4]=0,l[8]=d,l[12]=0,l[1]=0,l[5]=u,l[9]=h,l[13]=0,l[2]=0,l[6]=0,l[10]=f,l[14]=p,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,i,r,s,o,a=ws){const l=this.elements,c=1/(t-e),u=1/(i-r),d=1/(o-s),h=(t+e)*c,f=(i+r)*u;let p,y;if(a===ws)p=(o+s)*d,y=-2*d;else{if(2001!==a)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);p=s*d,y=-1*d}return l[0]=2*c,l[4]=0,l[8]=0,l[12]=-h,l[1]=0,l[5]=2*u,l[9]=0,l[13]=-f,l[2]=0,l[6]=0,l[10]=y,l[14]=-p,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const Kl=new T,Cr=new ot,lX=new T(0,0,0),cX=new T(1,1,1),go=new T,Qp=new T,$i=new T,rN=new ot,sN=new di;let uX=(()=>{class n{constructor(t=0,i=0,r=0,s=n.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=i,this._z=r,this._order=s}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,i,r,s=this._order){return this._x=t,this._y=i,this._z=r,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,i=this._order,r=!0){const s=t.elements,o=s[0],a=s[4],l=s[8],c=s[1],u=s[5],d=s[9],h=s[2],f=s[6],p=s[10];switch(i){case"XYZ":this._y=Math.asin(rn(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-d,p),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(f,u),this._z=0);break;case"YXZ":this._x=Math.asin(-rn(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(l,p),this._z=Math.atan2(c,u)):(this._y=Math.atan2(-h,o),this._z=0);break;case"ZXY":this._x=Math.asin(rn(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-h,p),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(c,o));break;case"ZYX":this._y=Math.asin(-rn(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(f,p),this._z=Math.atan2(c,o)):(this._x=0,this._z=Math.atan2(-a,u));break;case"YZX":this._z=Math.asin(rn(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-d,u),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(l,p));break;case"XZY":this._z=Math.asin(-rn(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(f,u),this._y=Math.atan2(l,o)):(this._x=Math.atan2(-d,p),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,!0===r&&this._onChangeCallback(),this}setFromQuaternion(t,i,r){return rN.makeRotationFromQuaternion(t),this.setFromRotationMatrix(rN,i,r)}setFromVector3(t,i=this._order){return this.set(t.x,t.y,t.z,i)}reorder(t){return sN.setFromEuler(this),this.setFromQuaternion(sN,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],i=0){return t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return n.DEFAULT_ORDER="XYZ",n})();class HE{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let dX=0;const oN=new T,Jl=new di,As=new ot,em=new T,_d=new T,hX=new T,fX=new di,aN=new T(1,0,0),lN=new T(0,1,0),cN=new T(0,0,1),pX={type:"added"},mX={type:"removed"};let qi=(()=>{class n extends na{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:dX++}),this.uuid=ji(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=n.DEFAULT_UP.clone();const t=new T,i=new uX,r=new di,s=new T(1,1,1);i._onChange(function o(){r.setFromEuler(i,!1)}),r._onChange(function a(){i.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new ot},normalMatrix:{value:new dt}}),this.matrix=new ot,this.matrixWorld=new ot,this.matrixAutoUpdate=n.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new HE,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,i){this.quaternion.setFromAxisAngle(t,i)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,i){return Jl.setFromAxisAngle(t,i),this.quaternion.multiply(Jl),this}rotateOnWorldAxis(t,i){return Jl.setFromAxisAngle(t,i),this.quaternion.premultiply(Jl),this}rotateX(t){return this.rotateOnAxis(aN,t)}rotateY(t){return this.rotateOnAxis(lN,t)}rotateZ(t){return this.rotateOnAxis(cN,t)}translateOnAxis(t,i){return oN.copy(t).applyQuaternion(this.quaternion),this.position.add(oN.multiplyScalar(i)),this}translateX(t){return this.translateOnAxis(aN,t)}translateY(t){return this.translateOnAxis(lN,t)}translateZ(t){return this.translateOnAxis(cN,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(As.copy(this.matrixWorld).invert())}lookAt(t,i,r){t.isVector3?em.copy(t):em.set(t,i,r);const s=this.parent;this.updateWorldMatrix(!0,!1),_d.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?As.lookAt(_d,em,this.up):As.lookAt(em,_d,this.up),this.quaternion.setFromRotationMatrix(As),s&&(As.extractRotation(s.matrixWorld),Jl.setFromRotationMatrix(As),this.quaternion.premultiply(Jl.invert()))}add(t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(pX)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const i=this.children.indexOf(t);return-1!==i&&(t.parent=null,this.children.splice(i,1),t.dispatchEvent(mX)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),As.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),As.multiply(t.parent.matrixWorld)),t.applyMatrix4(As),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,i){if(this[t]===i)return this;for(let r=0,s=this.children.length;r<s;r++){const a=this.children[r].getObjectByProperty(t,i);if(void 0!==a)return a}}getObjectsByProperty(t,i){let r=[];this[t]===i&&r.push(this);for(let s=0,o=this.children.length;s<o;s++){const a=this.children[s].getObjectsByProperty(t,i);a.length>0&&(r=r.concat(a))}return r}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_d,t,hX),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_d,fX,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return t.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(t){t(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].traverseVisible(t)}traverseAncestors(t){const i=this.parent;null!==i&&(t(i),i.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const i=this.children;for(let r=0,s=i.length;r<s;r++){const o=i[r];(!0===o.matrixWorldAutoUpdate||!0===t)&&o.updateMatrixWorld(t)}}updateWorldMatrix(t,i){const r=this.parent;if(!0===t&&null!==r&&!0===r.matrixWorldAutoUpdate&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===i){const s=this.children;for(let o=0,a=s.length;o<a;o++){const l=s[o];!0===l.matrixWorldAutoUpdate&&l.updateWorldMatrix(!1,!0)}}}toJSON(t){const i=void 0===t||"string"==typeof t,r={};i&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const s={};function o(l,c){return void 0===l[c.uuid]&&(l[c.uuid]=c.toJSON(t)),c.uuid}if(s.uuid=this.uuid,s.type=this.type,""!==this.name&&(s.name=this.name),!0===this.castShadow&&(s.castShadow=!0),!0===this.receiveShadow&&(s.receiveShadow=!0),!1===this.visible&&(s.visible=!1),!1===this.frustumCulled&&(s.frustumCulled=!1),0!==this.renderOrder&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(s.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(s.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=o(t.geometries,this.geometry);const l=this.geometry.parameters;if(void 0!==l&&void 0!==l.shapes){const c=l.shapes;if(Array.isArray(c))for(let u=0,d=c.length;u<d;u++)o(t.shapes,c[u]);else o(t.shapes,c)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(o(t.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const l=[];for(let c=0,u=this.material.length;c<u;c++)l.push(o(t.materials,this.material[c]));s.material=l}else s.material=o(t.materials,this.material);if(this.children.length>0){s.children=[];for(let l=0;l<this.children.length;l++)s.children.push(this.children[l].toJSON(t).object)}if(this.animations.length>0){s.animations=[];for(let l=0;l<this.animations.length;l++)s.animations.push(o(t.animations,this.animations[l]))}if(i){const l=a(t.geometries),c=a(t.materials),u=a(t.textures),d=a(t.images),h=a(t.shapes),f=a(t.skeletons),p=a(t.animations),y=a(t.nodes);l.length>0&&(r.geometries=l),c.length>0&&(r.materials=c),u.length>0&&(r.textures=u),d.length>0&&(r.images=d),h.length>0&&(r.shapes=h),f.length>0&&(r.skeletons=f),p.length>0&&(r.animations=p),y.length>0&&(r.nodes=y)}return r.object=s,r;function a(l){const c=[];for(const u in l){const d=l[u];delete d.metadata,c.push(d)}return c}}clone(t){return(new this.constructor).copy(this,t)}copy(t,i=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),!0===i)for(let r=0;r<t.children.length;r++)this.add(t.children[r].clone());return this}}return n.DEFAULT_UP=new T(0,1,0),n.DEFAULT_MATRIX_AUTO_UPDATE=!0,n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,n})();const Tr=new T,Ds=new T,zE=new T,Is=new T,Ql=new T,ec=new T,uN=new T,GE=new T,WE=new T,jE=new T;let tm=!1;class Xi{constructor(e=new T,t=new T,i=new T){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),Tr.subVectors(e,t),r.cross(Tr);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,i,r,s){Tr.subVectors(r,t),Ds.subVectors(i,t),zE.subVectors(e,t);const o=Tr.dot(Tr),a=Tr.dot(Ds),l=Tr.dot(zE),c=Ds.dot(Ds),u=Ds.dot(zE),d=o*c-a*a;if(0===d)return s.set(-2,-1,-1);const h=1/d,f=(c*l-a*u)*h,p=(o*u-a*l)*h;return s.set(1-f-p,p,f)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,Is),Is.x>=0&&Is.y>=0&&Is.x+Is.y<=1}static getUV(e,t,i,r,s,o,a,l){return!1===tm&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),tm=!0),this.getInterpolation(e,t,i,r,s,o,a,l)}static getInterpolation(e,t,i,r,s,o,a,l){return this.getBarycoord(e,t,i,r,Is),l.setScalar(0),l.addScaledVector(s,Is.x),l.addScaledVector(o,Is.y),l.addScaledVector(a,Is.z),l}static isFrontFacing(e,t,i,r){return Tr.subVectors(i,t),Ds.subVectors(e,t),Tr.cross(Ds).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Tr.subVectors(this.c,this.b),Ds.subVectors(this.a,this.b),.5*Tr.cross(Ds).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Xi.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Xi.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,r,s){return!1===tm&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),tm=!0),Xi.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}getInterpolation(e,t,i,r,s){return Xi.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}containsPoint(e){return Xi.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Xi.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,s=this.c;let o,a;Ql.subVectors(r,i),ec.subVectors(s,i),GE.subVectors(e,i);const l=Ql.dot(GE),c=ec.dot(GE);if(l<=0&&c<=0)return t.copy(i);WE.subVectors(e,r);const u=Ql.dot(WE),d=ec.dot(WE);if(u>=0&&d<=u)return t.copy(r);const h=l*d-u*c;if(h<=0&&l>=0&&u<=0)return o=l/(l-u),t.copy(i).addScaledVector(Ql,o);jE.subVectors(e,s);const f=Ql.dot(jE),p=ec.dot(jE);if(p>=0&&f<=p)return t.copy(s);const y=f*c-l*p;if(y<=0&&c>=0&&p<=0)return a=c/(c-p),t.copy(i).addScaledVector(ec,a);const g=u*p-f*d;if(g<=0&&d-u>=0&&f-p>=0)return uN.subVectors(s,r),a=(d-u)/(d-u+(f-p)),t.copy(r).addScaledVector(uN,a);const m=1/(g+y+h);return o=y*m,a=h*m,t.copy(i).addScaledVector(Ql,o).addScaledVector(ec,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let gX=0;class vd extends na{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:gX++}),this.uuid=ji(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const i=e[t];if(void 0===i){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i:console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`)}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),void 0!==this.sheen&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(i.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(i.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(i.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(i.combine=this.combine)),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(i.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(i.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(i.size=this.size),null!==this.shadowSide&&(i.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(i.blending=this.blending),0!==this.side&&(i.side=this.side),!0===this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=!0),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.alphaHash&&(i.alphaHash=!0),!0===this.alphaToCoverage&&(i.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=!0),!0===this.forceSinglePass&&(i.forceSinglePass=!0),!0===this.wireframe&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(i.flatShading=!0),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),!1===this.fog&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData),t){const s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(null!==t){const r=t.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=t[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}const dN={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},yo={h:0,s:0,l:0},nm={h:0,s:0,l:0};function $E(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+6*(e-n)*t:t<.5?e:t<2/3?n+6*(e-n)*(2/3-t):n}class Ae{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(void 0===t&&void 0===i){const r=e;r&&r.isColor?this.copy(r):"number"==typeof r?this.setHex(r):"string"==typeof r&&this.setStyle(r)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Pn){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,Pt.toWorkingColorSpace(this,t),this}setRGB(e,t,i,r=Pt.workingColorSpace){return this.r=e,this.g=t,this.b=i,Pt.toWorkingColorSpace(this,r),this}setHSL(e,t,i,r=Pt.workingColorSpace){if(e=DE(e,1),t=rn(t,0,1),i=rn(i,0,1),0===t)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+t):i+t-i*t,o=2*i-s;this.r=$E(o,s,e+1/3),this.g=$E(o,s,e),this.b=$E(o,s,e-1/3)}return Pt.toWorkingColorSpace(this,r),this}setStyle(e,t=Pn){function i(s){void 0!==s&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const a=r[2];switch(r[1]){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(3===o)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(6===o)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Pn){const i=dN[e.toLowerCase()];return void 0!==i?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Gl(e.r),this.g=Gl(e.g),this.b=Gl(e.b),this}copyLinearToSRGB(e){return this.r=PE(e.r),this.g=PE(e.g),this.b=PE(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Pn){return Pt.fromWorkingColorSpace(Qn.copy(this),e),65536*Math.round(rn(255*Qn.r,0,255))+256*Math.round(rn(255*Qn.g,0,255))+Math.round(rn(255*Qn.b,0,255))}getHexString(e=Pn){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Pt.workingColorSpace){Pt.fromWorkingColorSpace(Qn.copy(this),t);const i=Qn.r,r=Qn.g,s=Qn.b,o=Math.max(i,r,s),a=Math.min(i,r,s);let l,c;const u=(a+o)/2;if(a===o)l=0,c=0;else{const d=o-a;switch(c=u<=.5?d/(o+a):d/(2-o-a),o){case i:l=(r-s)/d+(r<s?6:0);break;case r:l=(s-i)/d+2;break;case s:l=(i-r)/d+4}l/=6}return e.h=l,e.s=c,e.l=u,e}getRGB(e,t=Pt.workingColorSpace){return Pt.fromWorkingColorSpace(Qn.copy(this),t),e.r=Qn.r,e.g=Qn.g,e.b=Qn.b,e}getStyle(e=Pn){Pt.fromWorkingColorSpace(Qn.copy(this),e);const t=Qn.r,i=Qn.g,r=Qn.b;return e!==Pn?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(255*t)},${Math.round(255*i)},${Math.round(255*r)})`}offsetHSL(e,t,i){return this.getHSL(yo),this.setHSL(yo.h+e,yo.s+t,yo.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(yo),e.getHSL(nm);const i=fd(yo.h,nm.h,t),r=fd(yo.s,nm.s,t),s=fd(yo.l,nm.l,t);return this.setHSL(i,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,i=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*i+s[6]*r,this.g=s[1]*t+s[4]*i+s[7]*r,this.b=s[2]*t+s[5]*i+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Qn=new Ae;Ae.NAMES=dN;class _o extends vd{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Ae(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Pp,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const vn=new T,im=new K;class Nn{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=i,this.usage=35044,this.updateRange={offset:0,count:-1},this.gpuType=bs,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,i=this.count;t<i;t++)im.fromBufferAttribute(this,t),im.applyMatrix3(e),this.setXY(t,im.x,im.y);else if(3===this.itemSize)for(let t=0,i=this.count;t<i;t++)vn.fromBufferAttribute(this,t),vn.applyMatrix3(e),this.setXYZ(t,vn.x,vn.y,vn.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)vn.fromBufferAttribute(this,t),vn.applyMatrix4(e),this.setXYZ(t,vn.x,vn.y,vn.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)vn.fromBufferAttribute(this,t),vn.applyNormalMatrix(e),this.setXYZ(t,vn.x,vn.y,vn.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)vn.fromBufferAttribute(this,t),vn.transformDirection(e),this.setXYZ(t,vn.x,vn.y,vn.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=Ti(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=at(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Ti(t,this.array)),t}setX(e,t){return this.normalized&&(t=at(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Ti(t,this.array)),t}setY(e,t){return this.normalized&&(t=at(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Ti(t,this.array)),t}setZ(e,t){return this.normalized&&(t=at(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Ti(t,this.array)),t}setW(e,t){return this.normalized&&(t=at(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=at(t,this.array),i=at(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=at(t,this.array),i=at(i,this.array),r=at(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=at(t,this.array),i=at(i,this.array),r=at(r,this.array),s=at(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}}class hN extends Nn{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class fN extends Nn{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class Ne extends Nn{constructor(e,t,i){super(new Float32Array(e),t,i)}}let _X=0;const hr=new ot,qE=new qi,tc=new T,Yi=new Ms,bd=new Ms,Ln=new T;class pt extends na{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:_X++}),this.uuid=ji(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(KP(e)?fN:hN)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(void 0!==i){const s=(new dt).getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return hr.makeRotationFromQuaternion(e),this.applyMatrix4(hr),this}rotateX(e){return hr.makeRotationX(e),this.applyMatrix4(hr),this}rotateY(e){return hr.makeRotationY(e),this.applyMatrix4(hr),this}rotateZ(e){return hr.makeRotationZ(e),this.applyMatrix4(hr),this}translate(e,t,i){return hr.makeTranslation(e,t,i),this.applyMatrix4(hr),this}scale(e,t,i){return hr.makeScale(e,t,i),this.applyMatrix4(hr),this}lookAt(e){return qE.lookAt(e),qE.updateMatrix(),this.applyMatrix4(qE.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(tc).negate(),this.translate(tc.x,tc.y,tc.z),this}setFromPoints(e){const t=[];for(let i=0,r=e.length;i<r;i++){const s=e[i];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new Ne(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Ms);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new T(-1/0,-1/0,-1/0),new T(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++)Yi.setFromBufferAttribute(t[i]),this.morphTargetsRelative?(Ln.addVectors(this.boundingBox.min,Yi.min),this.boundingBox.expandByPoint(Ln),Ln.addVectors(this.boundingBox.max,Yi.max),this.boundingBox.expandByPoint(Ln)):(this.boundingBox.expandByPoint(Yi.min),this.boundingBox.expandByPoint(Yi.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new qr);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new T,1/0);if(e){const i=this.boundingSphere.center;if(Yi.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++)bd.setFromBufferAttribute(t[s]),this.morphTargetsRelative?(Ln.addVectors(Yi.min,bd.min),Yi.expandByPoint(Ln),Ln.addVectors(Yi.max,bd.max),Yi.expandByPoint(Ln)):(Yi.expandByPoint(bd.min),Yi.expandByPoint(bd.max));Yi.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)Ln.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(Ln));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let c=0,u=a.count;c<u;c++)Ln.fromBufferAttribute(a,c),l&&(tc.fromBufferAttribute(e,c),Ln.add(tc)),r=Math.max(r,i.distanceToSquared(Ln))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const i=e.array,r=t.position.array,s=t.normal.array,o=t.uv.array,a=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new Nn(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,c=[],u=[];for(let C=0;C<a;C++)c[C]=new T,u[C]=new T;const d=new T,h=new T,f=new T,p=new K,y=new K,g=new K,m=new T,v=new T;function _(C,U,Y){d.fromArray(r,3*C),h.fromArray(r,3*U),f.fromArray(r,3*Y),p.fromArray(o,2*C),y.fromArray(o,2*U),g.fromArray(o,2*Y),h.sub(d),f.sub(d),y.sub(p),g.sub(p);const ee=1/(y.x*g.y-g.x*y.y);isFinite(ee)&&(m.copy(h).multiplyScalar(g.y).addScaledVector(f,-y.y).multiplyScalar(ee),v.copy(f).multiplyScalar(y.x).addScaledVector(h,-g.x).multiplyScalar(ee),c[C].add(m),c[U].add(m),c[Y].add(m),u[C].add(v),u[U].add(v),u[Y].add(v))}let E=this.groups;0===E.length&&(E=[{start:0,count:i.length}]);for(let C=0,U=E.length;C<U;++C){const Y=E[C],ee=Y.start;for(let G=ee,F=ee+Y.count;G<F;G+=3)_(i[G+0],i[G+1],i[G+2])}const S=new T,x=new T,M=new T,R=new T;function b(C){M.fromArray(s,3*C),R.copy(M);const U=c[C];S.copy(U),S.sub(M.multiplyScalar(M.dot(U))).normalize(),x.crossVectors(R,U);const ee=x.dot(u[C])<0?-1:1;l[4*C]=S.x,l[4*C+1]=S.y,l[4*C+2]=S.z,l[4*C+3]=ee}for(let C=0,U=E.length;C<U;++C){const Y=E[C],ee=Y.start;for(let G=ee,F=ee+Y.count;G<F;G+=3)b(i[G+0]),b(i[G+1]),b(i[G+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let i=this.getAttribute("normal");if(void 0===i)i=new Nn(new Float32Array(3*t.count),3),this.setAttribute("normal",i);else for(let h=0,f=i.count;h<f;h++)i.setXYZ(h,0,0,0);const r=new T,s=new T,o=new T,a=new T,l=new T,c=new T,u=new T,d=new T;if(e)for(let h=0,f=e.count;h<f;h+=3){const p=e.getX(h+0),y=e.getX(h+1),g=e.getX(h+2);r.fromBufferAttribute(t,p),s.fromBufferAttribute(t,y),o.fromBufferAttribute(t,g),u.subVectors(o,s),d.subVectors(r,s),u.cross(d),a.fromBufferAttribute(i,p),l.fromBufferAttribute(i,y),c.fromBufferAttribute(i,g),a.add(u),l.add(u),c.add(u),i.setXYZ(p,a.x,a.y,a.z),i.setXYZ(y,l.x,l.y,l.z),i.setXYZ(g,c.x,c.y,c.z)}else for(let h=0,f=t.count;h<f;h+=3)r.fromBufferAttribute(t,h+0),s.fromBufferAttribute(t,h+1),o.fromBufferAttribute(t,h+2),u.subVectors(o,s),d.subVectors(r,s),u.cross(d),i.setXYZ(h+0,u.x,u.y,u.z),i.setXYZ(h+1,u.x,u.y,u.z),i.setXYZ(h+2,u.x,u.y,u.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)Ln.fromBufferAttribute(e,t),Ln.normalize(),e.setXYZ(t,Ln.x,Ln.y,Ln.z)}toNonIndexed(){function e(a,l){const c=a.array,u=a.itemSize,d=a.normalized,h=new c.constructor(l.length*u);let f=0,p=0;for(let y=0,g=l.length;y<g;y++){f=a.isInterleavedBufferAttribute?l[y]*a.data.stride+a.offset:l[y]*u;for(let m=0;m<u;m++)h[p++]=c[f++]}return new Nn(h,u,d)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new pt,i=this.index.array,r=this.attributes;for(const a in r){const c=e(r[a],i);t.setAttribute(a,c)}const s=this.morphAttributes;for(const a in s){const l=[],c=s[a];for(let u=0,d=c.length;u<d;u++){const f=e(c[u],i);l.push(f)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const c=o[a];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const l=this.parameters;for(const c in l)void 0!==l[c]&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const l in i)e.data.attributes[l]=i[l].toJSON(e.data);const r={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],u=[];for(let d=0,h=c.length;d<h;d++)u.push(c[d].toJSON(e.data));u.length>0&&(r[l]=u,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return null!==a&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;null!==i&&this.setIndex(i.clone(t));const r=e.attributes;for(const c in r)this.setAttribute(c,r[c].clone(t));const s=e.morphAttributes;for(const c in s){const u=[],d=s[c];for(let h=0,f=d.length;h<f;h++)u.push(d[h].clone(t));this.morphAttributes[c]=u}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let c=0,u=o.length;c<u;c++){const d=o[c];this.addGroup(d.start,d.count,d.materialIndex)}const a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());const l=e.boundingSphere;return null!==l&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const pN=new ot,aa=new Zl,rm=new qr,mN=new T,nc=new T,ic=new T,rc=new T,XE=new T,sm=new T,om=new K,am=new K,lm=new K,gN=new T,yN=new T,_N=new T,cm=new T,um=new T;class Di extends qi{constructor(e=new pt,t=new _o){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){const i=this.geometry,s=i.morphAttributes.position,o=i.morphTargetsRelative;t.fromBufferAttribute(i.attributes.position,e);const a=this.morphTargetInfluences;if(s&&a){sm.set(0,0,0);for(let l=0,c=s.length;l<c;l++){const u=a[l];0!==u&&(XE.fromBufferAttribute(s[l],e),sm.addScaledVector(o?XE:XE.sub(t),u))}t.add(sm)}return t}raycast(e,t){const i=this.geometry,s=this.matrixWorld;void 0!==this.material&&(null===i.boundingSphere&&i.computeBoundingSphere(),rm.copy(i.boundingSphere),rm.applyMatrix4(s),aa.copy(e.ray).recast(e.near),(!1!==rm.containsPoint(aa.origin)||!(null===aa.intersectSphere(rm,mN)||aa.origin.distanceToSquared(mN)>(e.far-e.near)**2))&&(pN.copy(s).invert(),aa.copy(e.ray).applyMatrix4(pN),(null===i.boundingBox||!1!==aa.intersectsBox(i.boundingBox))&&this._computeIntersections(e,t,aa)))}_computeIntersections(e,t,i){let r;const s=this.geometry,o=this.material,a=s.index,l=s.attributes.position,c=s.attributes.uv,u=s.attributes.uv1,d=s.attributes.normal,h=s.groups,f=s.drawRange;if(null!==a)if(Array.isArray(o))for(let p=0,y=h.length;p<y;p++){const g=h[p],m=o[g.materialIndex];for(let E=Math.max(g.start,f.start),S=Math.min(a.count,Math.min(g.start+g.count,f.start+f.count));E<S;E+=3)r=dm(this,m,e,i,c,u,d,a.getX(E),a.getX(E+1),a.getX(E+2)),r&&(r.faceIndex=Math.floor(E/3),r.face.materialIndex=g.materialIndex,t.push(r))}else for(let g=Math.max(0,f.start),m=Math.min(a.count,f.start+f.count);g<m;g+=3)r=dm(this,o,e,i,c,u,d,a.getX(g),a.getX(g+1),a.getX(g+2)),r&&(r.faceIndex=Math.floor(g/3),t.push(r));else if(void 0!==l)if(Array.isArray(o))for(let p=0,y=h.length;p<y;p++){const g=h[p],m=o[g.materialIndex];for(let E=Math.max(g.start,f.start),S=Math.min(l.count,Math.min(g.start+g.count,f.start+f.count));E<S;E+=3)r=dm(this,m,e,i,c,u,d,E,E+1,E+2),r&&(r.faceIndex=Math.floor(E/3),r.face.materialIndex=g.materialIndex,t.push(r))}else for(let g=Math.max(0,f.start),m=Math.min(l.count,f.start+f.count);g<m;g+=3)r=dm(this,o,e,i,c,u,d,g,g+1,g+2),r&&(r.faceIndex=Math.floor(g/3),t.push(r))}}function dm(n,e,t,i,r,s,o,a,l,c){n.getVertexPosition(a,nc),n.getVertexPosition(l,ic),n.getVertexPosition(c,rc);const u=function vX(n,e,t,i,r,s,o,a){let l;if(l=1===e.side?i.intersectTriangle(o,s,r,!0,a):i.intersectTriangle(r,s,o,0===e.side,a),null===l)return null;um.copy(a),um.applyMatrix4(n.matrixWorld);const c=t.ray.origin.distanceTo(um);return c<t.near||c>t.far?null:{distance:c,point:um.clone(),object:n}}(n,e,t,i,nc,ic,rc,cm);if(u){r&&(om.fromBufferAttribute(r,a),am.fromBufferAttribute(r,l),lm.fromBufferAttribute(r,c),u.uv=Xi.getInterpolation(cm,nc,ic,rc,om,am,lm,new K)),s&&(om.fromBufferAttribute(s,a),am.fromBufferAttribute(s,l),lm.fromBufferAttribute(s,c),u.uv1=Xi.getInterpolation(cm,nc,ic,rc,om,am,lm,new K),u.uv2=u.uv1),o&&(gN.fromBufferAttribute(o,a),yN.fromBufferAttribute(o,l),_N.fromBufferAttribute(o,c),u.normal=Xi.getInterpolation(cm,nc,ic,rc,gN,yN,_N,new T),u.normal.dot(i.direction)>0&&u.normal.multiplyScalar(-1));const d={a,b:l,c,normal:new T,materialIndex:0};Xi.getNormal(nc,ic,rc,d.normal),u.face=d}return u}class la extends pt{constructor(e=1,t=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],c=[],u=[],d=[];let h=0,f=0;function p(y,g,m,v,_,E,S,x,M,R,b){const C=E/M,U=S/R,Y=E/2,ee=S/2,L=x/2,G=M+1,F=R+1;let k=0,W=0;const V=new T;for(let Z=0;Z<F;Z++){const O=Z*U-ee;for(let $=0;$<G;$++)V[y]=($*C-Y)*v,V[g]=O*_,V[m]=L,c.push(V.x,V.y,V.z),V[y]=0,V[g]=0,V[m]=x>0?1:-1,u.push(V.x,V.y,V.z),d.push($/M),d.push(1-Z/R),k+=1}for(let Z=0;Z<R;Z++)for(let O=0;O<M;O++){const de=h+O+G*(Z+1),ae=h+(O+1)+G*(Z+1),Me=h+(O+1)+G*Z;l.push(h+O+G*Z,de,Me),l.push(de,ae,Me),W+=6}a.addGroup(f,W,b),f+=W,h+=k}p("z","y","x",-1,-1,i,t,e,o,s,0),p("z","y","x",1,-1,i,t,-e,o,s,1),p("x","z","y",1,1,e,i,t,r,o,2),p("x","z","y",1,-1,e,i,-t,r,o,3),p("x","y","z",1,-1,e,t,i,r,s,4),p("x","y","z",-1,-1,e,t,-i,r,s,5),this.setIndex(l),this.setAttribute("position",new Ne(c,3)),this.setAttribute("normal",new Ne(u,3)),this.setAttribute("uv",new Ne(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new la(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function sc(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=r.clone():e[t][i]=Array.isArray(r)?r.slice():r}}return e}function hi(n){const e={};for(let t=0;t<n.length;t++){const i=sc(n[t]);for(const r in i)e[r]=i[r]}return e}function vN(n){return null===n.getRenderTarget()?n.outputColorSpace:Pt.workingColorSpace}const bX={clone:sc,merge:hi};class vo extends vd{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=sc(e.uniforms),this.uniformsGroups=function EX(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;t.uniforms[r]=o&&o.isTexture?{type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?{type:"c",value:o.getHex()}:o&&o.isVector2?{type:"v2",value:o.toArray()}:o&&o.isVector3?{type:"v3",value:o.toArray()}:o&&o.isVector4?{type:"v4",value:o.toArray()}:o&&o.isMatrix3?{type:"m3",value:o.toArray()}:o&&o.isMatrix4?{type:"m4",value:o.toArray()}:{value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const i={};for(const r in this.extensions)!0===this.extensions[r]&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class YE extends qi{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new ot,this.projectionMatrix=new ot,this.projectionMatrixInverse=new ot,this.coordinateSystem=ws}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class Gn extends YE{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*Hl*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*ia*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*Hl*Math.atan(Math.tan(.5*ia*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,r,s,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*ia*this.fov)/this.zoom,i=2*t,r=this.aspect*i,s=-.5*r;const o=this.view;if(null!==this.view&&this.view.enabled){const l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*r/l,t-=o.offsetY*i/c,r*=o.width/l,i*=o.height/c}const a=this.filmOffset;0!==a&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class MX extends qi{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new Gn(-90,1,e,t);r.layers=this.layers,this.add(r);const s=new Gn(-90,1,e,t);s.layers=this.layers,this.add(s);const o=new Gn(-90,1,e,t);o.layers=this.layers,this.add(o);const a=new Gn(-90,1,e,t);a.layers=this.layers,this.add(a);const l=new Gn(-90,1,e,t);l.layers=this.layers,this.add(l);const c=new Gn(-90,1,e,t);c.layers=this.layers,this.add(c)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[i,r,s,o,a,l]=t;for(const c of t)this.remove(c);if(e===ws)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else{if(2001!==e)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1)}for(const c of t)this.add(c),c.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,o,a,l,c,u]=this.children,d=e.getRenderTarget(),h=e.getActiveCubeFace(),f=e.getActiveMipmapLevel(),p=e.xr.enabled;e.xr.enabled=!1;const y=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,r),e.render(t,s),e.setRenderTarget(i,1,r),e.render(t,o),e.setRenderTarget(i,2,r),e.render(t,a),e.setRenderTarget(i,3,r),e.render(t,l),e.setRenderTarget(i,4,r),e.render(t,c),i.texture.generateMipmaps=y,e.setRenderTarget(i,5,r),e.render(t,u),e.setRenderTarget(d,h,f),e.xr.enabled=p,i.texture.needsPMREMUpdate=!0}}class hm extends ho{constructor(e,t,i,r,s,o,a,l,c,u){super(e=void 0!==e?e:[],t=void 0!==t?t:lo,i,r,s,o,a,l,c,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class xX extends ra{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];void 0!==t.encoding&&(md("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),t.colorSpace=t.encoding===ea?Pn:""),this.texture=new hm(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:_n}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i_uniforms={tEquirect:{value:null}},i_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",r=new la(5,5,5),s=new vo({name:"CubemapFromEquirect",uniforms:sc(i_uniforms),vertexShader:i_vertexShader,fragmentShader:i_fragmentShader,side:1,blending:0});s.uniforms.tEquirect.value=t;const o=new Di(r,s),a=t.minFilter;return t.minFilter===Ko&&(t.minFilter=_n),new MX(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,i,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,i,r);e.setRenderTarget(s)}}const ZE=new T,CX=new T,TX=new dt;class Eo{constructor(e=new T(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=ZE.subVectors(i,t).cross(CX.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(ZE),r=this.normal.dot(i);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(i,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||TX.getNormalMatrix(e),r=this.coplanarPoint(ZE).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const ca=new qr,fm=new T;class KE{constructor(e=new Eo,t=new Eo,i=new Eo,r=new Eo,s=new Eo,o=new Eo){this.planes=[e,t,i,r,s,o]}set(e,t,i,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=ws){const i=this.planes,r=e.elements,s=r[0],o=r[1],a=r[2],l=r[3],c=r[4],u=r[5],d=r[6],h=r[7],f=r[8],p=r[9],y=r[10],g=r[11],m=r[12],v=r[13],_=r[14],E=r[15];if(i[0].setComponents(l-s,h-c,g-f,E-m).normalize(),i[1].setComponents(l+s,h+c,g+f,E+m).normalize(),i[2].setComponents(l+o,h+u,g+p,E+v).normalize(),i[3].setComponents(l-o,h-u,g-p,E-v).normalize(),i[4].setComponents(l-a,h-d,g-y,E-_).normalize(),t===ws)i[5].setComponents(l+a,h+d,g+y,E+_).normalize();else{if(2001!==t)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);i[5].setComponents(a,d,y,_).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),ca.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),ca.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(ca)}intersectsSprite(e){return ca.center.set(0,0,0),ca.radius=.7071067811865476,ca.applyMatrix4(e.matrixWorld),this.intersectsSphere(ca)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(fm.x=r.normal.x>0?e.max.x:e.min.x,fm.y=r.normal.y>0?e.max.y:e.min.y,fm.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(fm)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function EN(){let n=null,e=!1,t=null,i=null;function r(s,o){t(s,o),i=n.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==t&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function AX(n,e){const t=e.isWebGL2,i=new WeakMap;return{get:function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),i.get(c)},remove:function a(c){c.isInterleavedBufferAttribute&&(c=c.data);const u=i.get(c);u&&(n.deleteBuffer(u.buffer),i.delete(c))},update:function l(c,u){if(c.isGLBufferAttribute){const h=i.get(c);return void((!h||h.version<c.version)&&i.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version}))}c.isInterleavedBufferAttribute&&(c=c.data);const d=i.get(c);void 0===d?i.set(c,function r(c,u){const d=c.array,h=c.usage,f=n.createBuffer();let p;if(n.bindBuffer(u,f),n.bufferData(u,d,h),c.onUploadCallback(),d instanceof Float32Array)p=n.FLOAT;else if(d instanceof Uint16Array)if(c.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");p=n.HALF_FLOAT}else p=n.UNSIGNED_SHORT;else if(d instanceof Int16Array)p=n.SHORT;else if(d instanceof Uint32Array)p=n.UNSIGNED_INT;else if(d instanceof Int32Array)p=n.INT;else if(d instanceof Int8Array)p=n.BYTE;else if(d instanceof Uint8Array)p=n.UNSIGNED_BYTE;else{if(!(d instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+d);p=n.UNSIGNED_BYTE}return{buffer:f,type:p,bytesPerElement:d.BYTES_PER_ELEMENT,version:c.version}}(c,u)):d.version<c.version&&(function s(c,u,d){const h=u.array,f=u.updateRange;n.bindBuffer(d,c),-1===f.count?n.bufferSubData(d,0,h):(t?n.bufferSubData(d,f.offset*h.BYTES_PER_ELEMENT,h,f.offset,f.count):n.bufferSubData(d,f.offset*h.BYTES_PER_ELEMENT,h.subarray(f.offset,f.offset+f.count)),f.count=-1),u.onUploadCallback()}(d.buffer,c,u),d.version=c.version)}}}class pm extends pt{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(i),l=Math.floor(r),c=a+1,u=l+1,d=e/a,h=t/l,f=[],p=[],y=[],g=[];for(let m=0;m<u;m++){const v=m*h-o;for(let _=0;_<c;_++)p.push(_*d-s,-v,0),y.push(0,0,1),g.push(_/a),g.push(1-m/l)}for(let m=0;m<l;m++)for(let v=0;v<a;v++){const E=v+c*(m+1),S=v+1+c*(m+1),x=v+1+c*m;f.push(v+c*m,E,x),f.push(E,S,x)}this.setIndex(f),this.setAttribute("position",new Ne(p,3)),this.setAttribute("normal",new Ne(y,3)),this.setAttribute("uv",new Ne(g,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new pm(e.width,e.height,e.widthSegments,e.heightSegments)}}const lt={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"\nconst mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(\n\tvec3( 0.8224621, 0.177538, 0.0 ),\n\tvec3( 0.0331941, 0.9668058, 0.0 ),\n\tvec3( 0.0170827, 0.0723974, 0.9105199 )\n);\nconst mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.2249401, - 0.2249404, 0.0 ),\n\tvec3( - 0.0420569, 1.0420571, 0.0 ),\n\tvec3( - 0.0196376, - 0.0786361, 1.0982735 )\n);\nvec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );\n}\nvec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );\n}\nvec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn sRGBTransferOETF( value );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tanisotropyV /= material.anisotropy;\n\tmaterial.anisotropy = saturate( material.anisotropy );\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x - tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x + tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal;\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},_e={common:{diffuse:{value:new Ae(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new dt},alphaMap:{value:null},alphaMapTransform:{value:new dt},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new dt}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new dt}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new dt}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new dt},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new dt},normalScale:{value:new K(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new dt},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new dt}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new dt}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new dt}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ae(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ae(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new dt},alphaTest:{value:0},uvTransform:{value:new dt}},sprite:{diffuse:{value:new Ae(16777215)},opacity:{value:1},center:{value:new K(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new dt},alphaMap:{value:null},alphaMapTransform:{value:new dt},alphaTest:{value:0}}},Xr={basic:{uniforms:hi([_e.common,_e.specularmap,_e.envmap,_e.aomap,_e.lightmap,_e.fog]),vertexShader:lt.meshbasic_vert,fragmentShader:lt.meshbasic_frag},lambert:{uniforms:hi([_e.common,_e.specularmap,_e.envmap,_e.aomap,_e.lightmap,_e.emissivemap,_e.bumpmap,_e.normalmap,_e.displacementmap,_e.fog,_e.lights,{emissive:{value:new Ae(0)}}]),vertexShader:lt.meshlambert_vert,fragmentShader:lt.meshlambert_frag},phong:{uniforms:hi([_e.common,_e.specularmap,_e.envmap,_e.aomap,_e.lightmap,_e.emissivemap,_e.bumpmap,_e.normalmap,_e.displacementmap,_e.fog,_e.lights,{emissive:{value:new Ae(0)},specular:{value:new Ae(1118481)},shininess:{value:30}}]),vertexShader:lt.meshphong_vert,fragmentShader:lt.meshphong_frag},standard:{uniforms:hi([_e.common,_e.envmap,_e.aomap,_e.lightmap,_e.emissivemap,_e.bumpmap,_e.normalmap,_e.displacementmap,_e.roughnessmap,_e.metalnessmap,_e.fog,_e.lights,{emissive:{value:new Ae(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:lt.meshphysical_vert,fragmentShader:lt.meshphysical_frag},toon:{uniforms:hi([_e.common,_e.aomap,_e.lightmap,_e.emissivemap,_e.bumpmap,_e.normalmap,_e.displacementmap,_e.gradientmap,_e.fog,_e.lights,{emissive:{value:new Ae(0)}}]),vertexShader:lt.meshtoon_vert,fragmentShader:lt.meshtoon_frag},matcap:{uniforms:hi([_e.common,_e.bumpmap,_e.normalmap,_e.displacementmap,_e.fog,{matcap:{value:null}}]),vertexShader:lt.meshmatcap_vert,fragmentShader:lt.meshmatcap_frag},points:{uniforms:hi([_e.points,_e.fog]),vertexShader:lt.points_vert,fragmentShader:lt.points_frag},dashed:{uniforms:hi([_e.common,_e.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:lt.linedashed_vert,fragmentShader:lt.linedashed_frag},depth:{uniforms:hi([_e.common,_e.displacementmap]),vertexShader:lt.depth_vert,fragmentShader:lt.depth_frag},normal:{uniforms:hi([_e.common,_e.bumpmap,_e.normalmap,_e.displacementmap,{opacity:{value:1}}]),vertexShader:lt.meshnormal_vert,fragmentShader:lt.meshnormal_frag},sprite:{uniforms:hi([_e.sprite,_e.fog]),vertexShader:lt.sprite_vert,fragmentShader:lt.sprite_frag},background:{uniforms:{uvTransform:{value:new dt},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:lt.background_vert,fragmentShader:lt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:lt.backgroundCube_vert,fragmentShader:lt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:lt.cube_vert,fragmentShader:lt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:lt.equirect_vert,fragmentShader:lt.equirect_frag},distanceRGBA:{uniforms:hi([_e.common,_e.displacementmap,{referencePosition:{value:new T},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:lt.distanceRGBA_vert,fragmentShader:lt.distanceRGBA_frag},shadow:{uniforms:hi([_e.lights,_e.fog,{color:{value:new Ae(0)},opacity:{value:1}}]),vertexShader:lt.shadow_vert,fragmentShader:lt.shadow_frag}};Xr.physical={uniforms:hi([Xr.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new dt},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new dt},clearcoatNormalScale:{value:new K(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new dt},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new dt},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new dt},sheen:{value:0},sheenColor:{value:new Ae(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new dt},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new dt},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new dt},transmissionSamplerSize:{value:new K},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new dt},attenuationDistance:{value:0},attenuationColor:{value:new Ae(0)},specularColor:{value:new Ae(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new dt},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new dt},anisotropyVector:{value:new K},anisotropyMap:{value:null},anisotropyMapTransform:{value:new dt}}]),vertexShader:lt.meshphysical_vert,fragmentShader:lt.meshphysical_frag};const mm={r:0,b:0,g:0};function CZ(n,e,t,i,r,s,o){const a=new Ae(0);let c,u,l=!0===s?0:1,d=null,h=0,f=null;function y(g,m){g.getRGB(mm,vN(n)),i.buffers.color.setClear(mm.r,mm.g,mm.b,m,o)}return{getClearColor:function(){return a},setClearColor:function(g,m=1){a.set(g),l=m,y(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(g){l=g,y(a,l)},render:function p(g,m){let v=!1,_=!0===m.isScene?m.background:null;_&&_.isTexture&&(_=(m.backgroundBlurriness>0?t:e).get(_)),null===_?y(a,l):_&&_.isColor&&(y(_,1),v=!0);const E=n.xr.getEnvironmentBlendMode();"additive"===E?i.buffers.color.setClear(0,0,0,1,o):"alpha-blend"===E&&i.buffers.color.setClear(0,0,0,0,o),(n.autoClear||v)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),_&&(_.isCubeTexture||_.mapping===dd)?(void 0===u&&(u=new Di(new la(1,1,1),new vo({name:"BackgroundCubeMaterial",uniforms:sc(Xr.backgroundCube.uniforms),vertexShader:Xr.backgroundCube.vertexShader,fragmentShader:Xr.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(S,x,M){this.matrixWorld.copyPosition(M.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(u)),u.material.uniforms.envMap.value=_,u.material.uniforms.flipEnvMap.value=_.isCubeTexture&&!1===_.isRenderTargetTexture?-1:1,u.material.uniforms.backgroundBlurriness.value=m.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=m.backgroundIntensity,u.material.toneMapped=Pt.getTransfer(_.colorSpace)!==zt,(d!==_||h!==_.version||f!==n.toneMapping)&&(u.material.needsUpdate=!0,d=_,h=_.version,f=n.toneMapping),u.layers.enableAll(),g.unshift(u,u.geometry,u.material,0,0,null)):_&&_.isTexture&&(void 0===c&&(c=new Di(new pm(2,2),new vo({name:"BackgroundMaterial",uniforms:sc(Xr.background.uniforms),vertexShader:Xr.background.vertexShader,fragmentShader:Xr.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=_,c.material.uniforms.backgroundIntensity.value=m.backgroundIntensity,c.material.toneMapped=Pt.getTransfer(_.colorSpace)!==zt,!0===_.matrixAutoUpdate&&_.updateMatrix(),c.material.uniforms.uvTransform.value.copy(_.matrix),(d!==_||h!==_.version||f!==n.toneMapping)&&(c.material.needsUpdate=!0,d=_,h=_.version,f=n.toneMapping),c.layers.enableAll(),g.unshift(c,c.geometry,c.material,0,0,null))}}}function TZ(n,e,t,i){const r=n.getParameter(n.MAX_VERTEX_ATTRIBS),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),o=i.isWebGL2||null!==s,a={},l=g(null);let c=l,u=!1;function f(L){return i.isWebGL2?n.bindVertexArray(L):s.bindVertexArrayOES(L)}function p(L){return i.isWebGL2?n.deleteVertexArray(L):s.deleteVertexArrayOES(L)}function g(L){const G=[],F=[],k=[];for(let W=0;W<r;W++)G[W]=0,F[W]=0,k[W]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:G,enabledAttributes:F,attributeDivisors:k,object:L,attributes:{},index:null}}function _(){const L=c.newAttributes;for(let G=0,F=L.length;G<F;G++)L[G]=0}function E(L){S(L,0)}function S(L,G){const k=c.enabledAttributes,W=c.attributeDivisors;c.newAttributes[L]=1,0===k[L]&&(n.enableVertexAttribArray(L),k[L]=1),W[L]!==G&&((i.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](L,G),W[L]=G)}function x(){const L=c.newAttributes,G=c.enabledAttributes;for(let F=0,k=G.length;F<k;F++)G[F]!==L[F]&&(n.disableVertexAttribArray(F),G[F]=0)}function M(L,G,F,k,W,V,Z){!0===Z?n.vertexAttribIPointer(L,G,F,W,V):n.vertexAttribPointer(L,G,F,k,W,V)}function Y(){ee(),u=!0,c!==l&&(c=l,f(c.object))}function ee(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function d(L,G,F,k,W){let V=!1;if(o){const Z=function y(L,G,F){const k=!0===F.wireframe;let W=a[L.id];void 0===W&&(W={},a[L.id]=W);let V=W[G.id];void 0===V&&(V={},W[G.id]=V);let Z=V[k];return void 0===Z&&(Z=g(function h(){return i.isWebGL2?n.createVertexArray():s.createVertexArrayOES()}()),V[k]=Z),Z}(k,F,G);c!==Z&&(c=Z,f(c.object)),V=function m(L,G,F,k){const W=c.attributes,V=G.attributes;let Z=0;const O=F.getAttributes();for(const $ in O)if(O[$].location>=0){const ae=W[$];let Me=V[$];if(void 0===Me&&("instanceMatrix"===$&&L.instanceMatrix&&(Me=L.instanceMatrix),"instanceColor"===$&&L.instanceColor&&(Me=L.instanceColor)),void 0===ae||ae.attribute!==Me||Me&&ae.data!==Me.data)return!0;Z++}return c.attributesNum!==Z||c.index!==k}(L,k,F,W),V&&function v(L,G,F,k){const W={},V=G.attributes;let Z=0;const O=F.getAttributes();for(const $ in O)if(O[$].location>=0){let ae=V[$];void 0===ae&&("instanceMatrix"===$&&L.instanceMatrix&&(ae=L.instanceMatrix),"instanceColor"===$&&L.instanceColor&&(ae=L.instanceColor));const Me={};Me.attribute=ae,ae&&ae.data&&(Me.data=ae.data),W[$]=Me,Z++}c.attributes=W,c.attributesNum=Z,c.index=k}(L,k,F,W)}else{const Z=!0===G.wireframe;(c.geometry!==k.id||c.program!==F.id||c.wireframe!==Z)&&(c.geometry=k.id,c.program=F.id,c.wireframe=Z,V=!0)}null!==W&&t.update(W,n.ELEMENT_ARRAY_BUFFER),(V||u)&&(u=!1,function R(L,G,F,k){if(!1===i.isWebGL2&&(L.isInstancedMesh||k.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;_();const W=k.attributes,V=F.getAttributes(),Z=G.defaultAttributeValues;for(const O in V){const $=V[O];if($.location>=0){let de=W[O];if(void 0===de&&("instanceMatrix"===O&&L.instanceMatrix&&(de=L.instanceMatrix),"instanceColor"===O&&L.instanceColor&&(de=L.instanceColor)),void 0!==de){const ae=de.normalized,Me=de.itemSize,Be=t.get(de);if(void 0===Be)continue;const Se=Be.buffer,Ie=Be.type,Xe=Be.bytesPerElement,bt=!0===i.isWebGL2&&(Ie===n.INT||Ie===n.UNSIGNED_INT||1013===de.gpuType);if(de.isInterleavedBufferAttribute){const Ve=de.data,P=Ve.stride,me=de.offset;if(Ve.isInstancedInterleavedBuffer){for(let Q=0;Q<$.locationSize;Q++)S($.location+Q,Ve.meshPerAttribute);!0!==L.isInstancedMesh&&void 0===k._maxInstanceCount&&(k._maxInstanceCount=Ve.meshPerAttribute*Ve.count)}else for(let Q=0;Q<$.locationSize;Q++)E($.location+Q);n.bindBuffer(n.ARRAY_BUFFER,Se);for(let Q=0;Q<$.locationSize;Q++)M($.location+Q,Me/$.locationSize,Ie,ae,P*Xe,(me+Me/$.locationSize*Q)*Xe,bt)}else{if(de.isInstancedBufferAttribute){for(let Ve=0;Ve<$.locationSize;Ve++)S($.location+Ve,de.meshPerAttribute);!0!==L.isInstancedMesh&&void 0===k._maxInstanceCount&&(k._maxInstanceCount=de.meshPerAttribute*de.count)}else for(let Ve=0;Ve<$.locationSize;Ve++)E($.location+Ve);n.bindBuffer(n.ARRAY_BUFFER,Se);for(let Ve=0;Ve<$.locationSize;Ve++)M($.location+Ve,Me/$.locationSize,Ie,ae,Me*Xe,Me/$.locationSize*Ve*Xe,bt)}}else if(void 0!==Z){const ae=Z[O];if(void 0!==ae)switch(ae.length){case 2:n.vertexAttrib2fv($.location,ae);break;case 3:n.vertexAttrib3fv($.location,ae);break;case 4:n.vertexAttrib4fv($.location,ae);break;default:n.vertexAttrib1fv($.location,ae)}}}}x()}(L,G,F,k),null!==W&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.get(W).buffer))},reset:Y,resetDefaultState:ee,dispose:function b(){Y();for(const L in a){const G=a[L];for(const F in G){const k=G[F];for(const W in k)p(k[W].object),delete k[W];delete G[F]}delete a[L]}},releaseStatesOfGeometry:function C(L){if(void 0===a[L.id])return;const G=a[L.id];for(const F in G){const k=G[F];for(const W in k)p(k[W].object),delete k[W];delete G[F]}delete a[L.id]},releaseStatesOfProgram:function U(L){for(const G in a){const F=a[G];if(void 0===F[L.id])continue;const k=F[L.id];for(const W in k)p(k[W].object),delete k[W];delete F[L.id]}},initAttributes:_,enableAttribute:E,disableUnusedAttributes:x}}function AZ(n,e,t,i){const r=i.isWebGL2;let s;this.setMode=function o(c){s=c},this.render=function a(c,u){n.drawArrays(s,c,u),t.update(u,s,1)},this.renderInstances=function l(c,u,d){if(0===d)return;let h,f;if(r)h=n,f="drawArraysInstanced";else if(h=e.get("ANGLE_instanced_arrays"),f="drawArraysInstancedANGLE",null===h)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");h[f](s,c,u,d),t.update(u,s,d)}}function DZ(n,e,t){let i;function s(M){if("highp"===M){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";M="mediump"}return"mediump"===M&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&"WebGL2RenderingContext"===n.constructor.name;let a=void 0!==t.precision?t.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const c=o||e.has("WEBGL_draw_buffers"),u=!0===t.logarithmicDepthBuffer,d=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),h=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),f=n.getParameter(n.MAX_TEXTURE_SIZE),p=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),y=n.getParameter(n.MAX_VERTEX_ATTRIBS),g=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),m=n.getParameter(n.MAX_VARYING_VECTORS),v=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),_=h>0,E=o||e.has("OES_texture_float");return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:function r(){if(void 0!==i)return i;if(!0===e.has("EXT_texture_filter_anisotropic")){const M=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(M.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:s,precision:a,logarithmicDepthBuffer:u,maxTextures:d,maxVertexTextures:h,maxTextureSize:f,maxCubemapSize:p,maxAttributes:y,maxVertexUniforms:g,maxVaryings:m,maxFragmentUniforms:v,vertexTextures:_,floatFragmentTextures:E,floatVertexTextures:_&&E,maxSamples:o?n.getParameter(n.MAX_SAMPLES):0}}function IZ(n){const e=this;let t=null,i=0,r=!1,s=!1;const o=new Eo,a=new dt,l={value:null,needsUpdate:!1};function u(d,h,f,p){const y=null!==d?d.length:0;let g=null;if(0!==y){if(g=l.value,!0!==p||null===g){const m=f+4*y,v=h.matrixWorldInverse;a.getNormalMatrix(v),(null===g||g.length<m)&&(g=new Float32Array(m));for(let _=0,E=f;_!==y;++_,E+=4)o.copy(d[_]).applyMatrix4(v,a),o.normal.toArray(g,E),g[E+3]=o.constant}l.value=g,l.needsUpdate=!0}return e.numPlanes=y,e.numIntersection=0,g}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(d,h){const f=0!==d.length||h||0!==i||r;return r=h,i=d.length,f},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(d,h){t=u(d,h,0)},this.setState=function(d,h,f){const p=d.clippingPlanes,y=d.clipIntersection,g=d.clipShadows,m=n.get(d);if(!r||null===p||0===p.length||s&&!g)s?u(null):function c(){l.value!==t&&(l.value=t,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}();else{const v=s?0:i,_=4*v;let E=m.clippingState||null;l.value=E,E=u(p,h,_,f);for(let S=0;S!==_;++S)E[S]=t[S];m.clippingState=E,this.numIntersection=y?this.numPlanes:0,this.numPlanes+=v}}}function RZ(n){let e=new WeakMap;function t(o,a){return 303===a?o.mapping=lo:304===a&&(o.mapping=Zo),o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=e.get(a);void 0!==l&&(e.delete(a),l.dispose())}return{get:function i(o){if(o&&o.isTexture&&!1===o.isRenderTargetTexture){const a=o.mapping;if(303===a||304===a){if(e.has(o))return t(e.get(o).texture,o.mapping);{const l=o.image;if(l&&l.height>0){const c=new xX(l.height/2);return c.fromEquirectangularTexture(n,o),e.set(o,c),o.addEventListener("dispose",r),t(c.texture,o.mapping)}return null}}}return o},dispose:function s(){e=new WeakMap}}}class JE extends YE{constructor(e=-1,t=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,s,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,o=i+e,a=r+t,l=r-t;if(null!==this.view&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=u*this.view.offsetY,l=a-u*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const bN=[.125,.215,.35,.446,.526,.582],QE=new JE,SN=new Ae;let eb=null;const da=(1+Math.sqrt(5))/2,cc=1/da,wN=[new T(1,1,1),new T(-1,1,1),new T(1,1,-1),new T(-1,1,-1),new T(0,da,cc),new T(0,da,-cc),new T(cc,0,da),new T(-cc,0,da),new T(da,cc,0),new T(-da,cc,0)];class MN{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){eb=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=TN(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=CN(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(eb),e.scissorTest=!1,gm(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(e.mapping===lo||e.mapping===Zo?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),eb=this._renderer.getRenderTarget();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:_n,minFilter:_n,generateMipmaps:!1,type:hd,format:ur,colorSpace:Ss,depthBuffer:!1},r=xN(e,t,i);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=xN(e,t,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function PZ(n){const e=[],t=[],i=[];let r=n;const s=n-4+1+bN.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let l=1/a;o>n-4?l=bN[o-n+4-1]:0===o&&(l=0),i.push(l);const c=1/(a-2),u=-c,d=1+c,h=[u,u,d,u,d,d,u,u,d,d,u,d],f=6,p=6,y=3,g=2,m=1,v=new Float32Array(y*p*f),_=new Float32Array(g*p*f),E=new Float32Array(m*p*f);for(let x=0;x<f;x++){const M=x%3*2/3-1,R=x>2?0:-1;v.set([M,R,0,M+2/3,R,0,M+2/3,R+1,0,M,R,0,M+2/3,R+1,0,M,R+1,0],y*p*x),_.set(h,g*p*x),E.set([x,x,x,x,x,x],m*p*x)}const S=new pt;S.setAttribute("position",new Nn(v,y)),S.setAttribute("uv",new Nn(_,g)),S.setAttribute("faceIndex",new Nn(E,m)),e.push(S),r>4&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}(s)),this._blurMaterial=function NZ(n,e,t){const i=new Float32Array(20),r=new T(0,1,0);return new vo({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(s,e,t)}return r}_compileMaterial(e){const t=new Di(this._lodPlanes[0],e);this._renderer.compile(t,QE)}_sceneToCubeUV(e,t,i,r){const a=new Gn(90,1,t,i),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],u=this._renderer,d=u.autoClear,h=u.toneMapping;u.getClearColor(SN),u.toneMapping=ao,u.autoClear=!1;const f=new _o({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),p=new Di(new la,f);let y=!1;const g=e.background;g?g.isColor&&(f.color.copy(g),e.background=null,y=!0):(f.color.copy(SN),y=!0);for(let m=0;m<6;m++){const v=m%3;0===v?(a.up.set(0,l[m],0),a.lookAt(c[m],0,0)):1===v?(a.up.set(0,0,l[m]),a.lookAt(0,c[m],0)):(a.up.set(0,l[m],0),a.lookAt(0,0,c[m]));const _=this._cubeSize;gm(r,v*_,m>2?_:0,_,_),u.setRenderTarget(r),y&&u.render(p,a),u.render(e,a)}p.geometry.dispose(),p.material.dispose(),u.toneMapping=h,u.autoClear=d,e.background=g}_textureToCubeUV(e,t){const i=this._renderer,r=e.mapping===lo||e.mapping===Zo;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=TN()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=CN());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new Di(this._lodPlanes[0],s);s.uniforms.envMap.value=e;const l=this._cubeSize;gm(t,0,0,3*l,2*l),i.setRenderTarget(t),i.render(o,QE)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]);this._blur(e,r-1,r,s,wN[(r-1)%wN.length])}t.autoClear=i}_blur(e,t,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,o,a){const l=this._renderer,c=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const d=new Di(this._lodPlanes[r],c),h=c.uniforms,f=this._sizeLods[i]-1,p=isFinite(s)?Math.PI/(2*f):2*Math.PI/39,y=s/p,g=isFinite(s)?1+Math.floor(3*y):20;g>20&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${g} samples when the maximum is set to 20`);const m=[];let v=0;for(let M=0;M<20;++M){const R=M/y,b=Math.exp(-R*R/2);m.push(b),0===M?v+=b:M<g&&(v+=2*b)}for(let M=0;M<m.length;M++)m[M]=m[M]/v;h.envMap.value=e.texture,h.samples.value=g,h.weights.value=m,h.latitudinal.value="latitudinal"===o,a&&(h.poleAxis.value=a);const{_lodMax:_}=this;h.dTheta.value=p,h.mipInt.value=_-i;const E=this._sizeLods[r];gm(t,3*E*(r>_-4?r-_+4:0),4*(this._cubeSize-E),3*E,2*E),l.setRenderTarget(t),l.render(d,QE)}}function xN(n,e,t){const i=new ra(n,e,t);return i.texture.mapping=dd,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function gm(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function CN(){return new vo({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function TN(){return new vo({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function LZ(n){let e=new WeakMap,t=null;function s(a){const l=a.target;l.removeEventListener("dispose",s);const c=e.get(l);void 0!==c&&(e.delete(l),c.dispose())}return{get:function i(a){if(a&&a.isTexture){const l=a.mapping,c=303===l||304===l,u=l===lo||l===Zo;if(c||u){if(a.isRenderTargetTexture&&!0===a.needsPMREMUpdate){a.needsPMREMUpdate=!1;let d=e.get(a);return null===t&&(t=new MN(n)),d=c?t.fromEquirectangular(a,d):t.fromCubemap(a,d),e.set(a,d),d.texture}if(e.has(a))return e.get(a).texture;{const d=a.image;if(c&&d&&d.height>0||u&&d&&function r(a){let l=0;for(let u=0;u<6;u++)void 0!==a[u]&&l++;return 6===l}(d)){null===t&&(t=new MN(n));const h=c?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,h),a.addEventListener("dispose",s),h.texture}return null}}}return a},dispose:function o(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function OZ(n){const e={};function t(i){if(void 0!==e[i])return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return null!==t(i)},init:function(i){i.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){const r=t(i);return null===r&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function FZ(n,e,t,i){const r={},s=new WeakMap;function o(d){const h=d.target;null!==h.index&&e.remove(h.index);for(const p in h.attributes)e.remove(h.attributes[p]);for(const p in h.morphAttributes){const y=h.morphAttributes[p];for(let g=0,m=y.length;g<m;g++)e.remove(y[g])}h.removeEventListener("dispose",o),delete r[h.id];const f=s.get(h);f&&(e.remove(f),s.delete(h)),i.releaseStatesOfGeometry(h),!0===h.isInstancedBufferGeometry&&delete h._maxInstanceCount,t.memory.geometries--}function c(d){const h=[],f=d.index,p=d.attributes.position;let y=0;if(null!==f){const v=f.array;y=f.version;for(let _=0,E=v.length;_<E;_+=3){const S=v[_+0],x=v[_+1],M=v[_+2];h.push(S,x,x,M,M,S)}}else{if(void 0===p)return;y=p.version;for(let _=0,E=p.array.length/3-1;_<E;_+=3){const S=_+0,x=_+1,M=_+2;h.push(S,x,x,M,M,S)}}const g=new(KP(h)?fN:hN)(h,1);g.version=y;const m=s.get(d);m&&e.remove(m),s.set(d,g)}return{get:function a(d,h){return!0===r[h.id]||(h.addEventListener("dispose",o),r[h.id]=!0,t.memory.geometries++),h},update:function l(d){const h=d.attributes;for(const p in h)e.update(h[p],n.ARRAY_BUFFER);const f=d.morphAttributes;for(const p in f){const y=f[p];for(let g=0,m=y.length;g<m;g++)e.update(y[g],n.ARRAY_BUFFER)}},getWireframeAttribute:function u(d){const h=s.get(d);if(h){const f=d.index;null!==f&&h.version<f.version&&c(d)}else c(d);return s.get(d)}}}function kZ(n,e,t,i){const r=i.isWebGL2;let s,a,l;this.setMode=function o(h){s=h},this.setIndex=function c(h){a=h.type,l=h.bytesPerElement},this.render=function u(h,f){n.drawElements(s,f,a,h*l),t.update(f,s,1)},this.renderInstances=function d(h,f,p){if(0===p)return;let y,g;if(r)y=n,g="drawElementsInstanced";else if(y=e.get("ANGLE_instanced_arrays"),g="drawElementsInstancedANGLE",null===y)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");y[g](s,f,a,h*l,p),t.update(f,s,p)}}function UZ(n){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function i(s,o,a){switch(t.calls++,o){case n.TRIANGLES:t.triangles+=a*(s/3);break;case n.LINES:t.lines+=a*(s/2);break;case n.LINE_STRIP:t.lines+=a*(s-1);break;case n.LINE_LOOP:t.lines+=a*s;break;case n.POINTS:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o)}}}}function BZ(n,e){return n[0]-e[0]}function VZ(n,e){return Math.abs(e[1])-Math.abs(n[1])}function HZ(n,e,t){const i={},r=new Float32Array(8),s=new WeakMap,o=new Nt,a=[];for(let c=0;c<8;c++)a[c]=[c,0];return{update:function l(c,u,d){const h=c.morphTargetInfluences;if(!0===e.isWebGL2){const f=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,p=void 0!==f?f.length:0;let y=s.get(u);if(void 0===y||y.count!==p){let L=function(){Y.dispose(),s.delete(u),u.removeEventListener("dispose",L)};void 0!==y&&y.texture.dispose();const v=void 0!==u.morphAttributes.position,_=void 0!==u.morphAttributes.normal,E=void 0!==u.morphAttributes.color,S=u.morphAttributes.position||[],x=u.morphAttributes.normal||[],M=u.morphAttributes.color||[];let R=0;!0===v&&(R=1),!0===_&&(R=2),!0===E&&(R=3);let b=u.attributes.position.count*R,C=1;b>e.maxTextureSize&&(C=Math.ceil(b/e.maxTextureSize),b=e.maxTextureSize);const U=new Float32Array(b*C*4*p),Y=new LE(U,b,C,p);Y.type=bs,Y.needsUpdate=!0;const ee=4*R;for(let G=0;G<p;G++){const F=S[G],k=x[G],W=M[G],V=b*C*4*G;for(let Z=0;Z<F.count;Z++){const O=Z*ee;!0===v&&(o.fromBufferAttribute(F,Z),U[V+O+0]=o.x,U[V+O+1]=o.y,U[V+O+2]=o.z,U[V+O+3]=0),!0===_&&(o.fromBufferAttribute(k,Z),U[V+O+4]=o.x,U[V+O+5]=o.y,U[V+O+6]=o.z,U[V+O+7]=0),!0===E&&(o.fromBufferAttribute(W,Z),U[V+O+8]=o.x,U[V+O+9]=o.y,U[V+O+10]=o.z,U[V+O+11]=4===W.itemSize?o.w:1)}}y={count:p,texture:Y,size:new K(b,C)},s.set(u,y),u.addEventListener("dispose",L)}let g=0;for(let v=0;v<h.length;v++)g+=h[v];const m=u.morphTargetsRelative?1:1-g;d.getUniforms().setValue(n,"morphTargetBaseInfluence",m),d.getUniforms().setValue(n,"morphTargetInfluences",h),d.getUniforms().setValue(n,"morphTargetsTexture",y.texture,t),d.getUniforms().setValue(n,"morphTargetsTextureSize",y.size)}else{const f=void 0===h?0:h.length;let p=i[u.id];if(void 0===p||p.length!==f){p=[];for(let _=0;_<f;_++)p[_]=[_,0];i[u.id]=p}for(let _=0;_<f;_++){const E=p[_];E[0]=_,E[1]=h[_]}p.sort(VZ);for(let _=0;_<8;_++)_<f&&p[_][1]?(a[_][0]=p[_][0],a[_][1]=p[_][1]):(a[_][0]=Number.MAX_SAFE_INTEGER,a[_][1]=0);a.sort(BZ);const y=u.morphAttributes.position,g=u.morphAttributes.normal;let m=0;for(let _=0;_<8;_++){const E=a[_],S=E[0],x=E[1];S!==Number.MAX_SAFE_INTEGER&&x?(y&&u.getAttribute("morphTarget"+_)!==y[S]&&u.setAttribute("morphTarget"+_,y[S]),g&&u.getAttribute("morphNormal"+_)!==g[S]&&u.setAttribute("morphNormal"+_,g[S]),r[_]=x,m+=x):(y&&!0===u.hasAttribute("morphTarget"+_)&&u.deleteAttribute("morphTarget"+_),g&&!0===u.hasAttribute("morphNormal"+_)&&u.deleteAttribute("morphNormal"+_),r[_]=0)}const v=u.morphTargetsRelative?1:1-m;d.getUniforms().setValue(n,"morphTargetBaseInfluence",v),d.getUniforms().setValue(n,"morphTargetInfluences",r)}}}}function zZ(n,e,t,i){let r=new WeakMap;function a(l){const c=l.target;c.removeEventListener("dispose",a),t.remove(c.instanceMatrix),null!==c.instanceColor&&t.remove(c.instanceColor)}return{update:function s(l){const c=i.render.frame,d=e.get(l,l.geometry);if(r.get(d)!==c&&(e.update(d),r.set(d,c)),l.isInstancedMesh&&(!1===l.hasEventListener("dispose",a)&&l.addEventListener("dispose",a),r.get(l)!==c&&(t.update(l.instanceMatrix,n.ARRAY_BUFFER),null!==l.instanceColor&&t.update(l.instanceColor,n.ARRAY_BUFFER),r.set(l,c))),l.isSkinnedMesh){const h=l.skeleton;r.get(h)!==c&&(h.update(),r.set(h,c))}return d},dispose:function o(){r=new WeakMap}}}const AN=new ho,DN=new LE,IN=new nN,RN=new hm,PN=[],NN=[],LN=new Float32Array(16),ON=new Float32Array(9),FN=new Float32Array(4);function uc(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let s=PN[r];if(void 0===s&&(s=new Float32Array(r),PN[r]=s),0!==e){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function Dn(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function In(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function ym(n,e){let t=NN[e];void 0===t&&(t=new Int32Array(e),NN[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function GZ(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function WZ(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Dn(t,e))return;n.uniform2fv(this.addr,e),In(t,e)}}function jZ(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Dn(t,e))return;n.uniform3fv(this.addr,e),In(t,e)}}function $Z(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Dn(t,e))return;n.uniform4fv(this.addr,e),In(t,e)}}function qZ(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(Dn(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),In(t,e)}else{if(Dn(t,i))return;FN.set(i),n.uniformMatrix2fv(this.addr,!1,FN),In(t,i)}}function XZ(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(Dn(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),In(t,e)}else{if(Dn(t,i))return;ON.set(i),n.uniformMatrix3fv(this.addr,!1,ON),In(t,i)}}function YZ(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(Dn(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),In(t,e)}else{if(Dn(t,i))return;LN.set(i),n.uniformMatrix4fv(this.addr,!1,LN),In(t,i)}}function ZZ(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function KZ(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Dn(t,e))return;n.uniform2iv(this.addr,e),In(t,e)}}function JZ(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Dn(t,e))return;n.uniform3iv(this.addr,e),In(t,e)}}function QZ(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Dn(t,e))return;n.uniform4iv(this.addr,e),In(t,e)}}function eK(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function tK(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Dn(t,e))return;n.uniform2uiv(this.addr,e),In(t,e)}}function nK(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Dn(t,e))return;n.uniform3uiv(this.addr,e),In(t,e)}}function iK(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Dn(t,e))return;n.uniform4uiv(this.addr,e),In(t,e)}}function rK(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2D(e||AN,r)}function sK(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||IN,r)}function oK(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||RN,r)}function aK(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||DN,r)}function cK(n,e){n.uniform1fv(this.addr,e)}function uK(n,e){const t=uc(e,this.size,2);n.uniform2fv(this.addr,t)}function dK(n,e){const t=uc(e,this.size,3);n.uniform3fv(this.addr,t)}function hK(n,e){const t=uc(e,this.size,4);n.uniform4fv(this.addr,t)}function fK(n,e){const t=uc(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function pK(n,e){const t=uc(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function mK(n,e){const t=uc(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function gK(n,e){n.uniform1iv(this.addr,e)}function yK(n,e){n.uniform2iv(this.addr,e)}function _K(n,e){n.uniform3iv(this.addr,e)}function vK(n,e){n.uniform4iv(this.addr,e)}function EK(n,e){n.uniform1uiv(this.addr,e)}function bK(n,e){n.uniform2uiv(this.addr,e)}function SK(n,e){n.uniform3uiv(this.addr,e)}function wK(n,e){n.uniform4uiv(this.addr,e)}function MK(n,e,t){const i=this.cache,r=e.length,s=ym(t,r);Dn(i,s)||(n.uniform1iv(this.addr,s),In(i,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||AN,s[o])}function xK(n,e,t){const i=this.cache,r=e.length,s=ym(t,r);Dn(i,s)||(n.uniform1iv(this.addr,s),In(i,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||IN,s[o])}function CK(n,e,t){const i=this.cache,r=e.length,s=ym(t,r);Dn(i,s)||(n.uniform1iv(this.addr,s),In(i,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||RN,s[o])}function TK(n,e,t){const i=this.cache,r=e.length,s=ym(t,r);Dn(i,s)||(n.uniform1iv(this.addr,s),In(i,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||DN,s[o])}class DK{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.setValue=function lK(n){switch(n){case 5126:return GZ;case 35664:return WZ;case 35665:return jZ;case 35666:return $Z;case 35674:return qZ;case 35675:return XZ;case 35676:return YZ;case 5124:case 35670:return ZZ;case 35667:case 35671:return KZ;case 35668:case 35672:return JZ;case 35669:case 35673:return QZ;case 5125:return eK;case 36294:return tK;case 36295:return nK;case 36296:return iK;case 35678:case 36198:case 36298:case 36306:case 35682:return rK;case 35679:case 36299:case 36307:return sK;case 35680:case 36300:case 36308:case 36293:return oK;case 36289:case 36303:case 36311:case 36292:return aK}}(t.type)}}class IK{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.size=t.size,this.setValue=function AK(n){switch(n){case 5126:return cK;case 35664:return uK;case 35665:return dK;case 35666:return hK;case 35674:return fK;case 35675:return pK;case 35676:return mK;case 5124:case 35670:return gK;case 35667:case 35671:return yK;case 35668:case 35672:return _K;case 35669:case 35673:return vK;case 5125:return EK;case 36294:return bK;case 36295:return SK;case 36296:return wK;case 35678:case 36198:case 36298:case 36306:case 35682:return MK;case 35679:case 36299:case 36307:return xK;case 35680:case 36300:case 36308:case 36293:return CK;case 36289:case 36303:case 36311:case 36292:return TK}}(t.type)}}class RK{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,t[a.id],i)}}}const nb=/(\w+)(\])?(\[|\.)?/g;function kN(n,e){n.seq.push(e),n.map[e.id]=e}function PK(n,e,t){const i=n.name,r=i.length;for(nb.lastIndex=0;;){const s=nb.exec(i);let a=s[1];const c=s[3];if("]"===s[2]&&(a|=0),void 0===c||"["===c&&nb.lastIndex+2===r){kN(t,void 0===c?new DK(a,n,e):new IK(a,n,e));break}{let d=t.map[a];void 0===d&&(d=new RK(a),kN(t,d)),t=d}}}class _m{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<i;++r){const s=e.getActiveUniform(t,r);PK(s,e.getUniformLocation(t,s.name),this)}}setValue(e,t,i,r){const s=this.map[t];void 0!==s&&s.setValue(e,i,r)}setOptional(e,t,i){const r=t[i];void 0!==r&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let s=0,o=t.length;s!==o;++s){const a=t[s],l=i[a.id];!1!==l.needsUpdate&&a.setValue(e,l.value,r)}}static seqWithValue(e,t){const i=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&i.push(o)}return i}}function UN(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}let NK=0;function BN(n,e,t){const i=n.getShaderParameter(e,n.COMPILE_STATUS),r=n.getShaderInfoLog(e).trim();if(i&&""===r)return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return t.toUpperCase()+"\n\n"+r+"\n\n"+function LK(n,e){const t=n.split("\n"),i=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const a=o+1;i.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return i.join("\n")}(n.getShaderSource(e),o)}return r}function FK(n,e){const t=function OK(n){const e=Pt.getPrimaries(Pt.workingColorSpace),t=Pt.getPrimaries(n);let i;switch(e===t?i="":e===Wp&&t===Gp?i="LinearDisplayP3ToLinearSRGB":e===Gp&&t===Wp&&(i="LinearSRGBToLinearDisplayP3"),n){case Ss:case Hp:return[i,"LinearTransferOETF"];case Pn:case CE:return[i,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",n),[i,"LinearTransferOETF"]}}(e);return`vec4 ${n}( vec4 value ) { return ${t[0]}( ${t[1]}( value ) ); }`}function kK(n,e){let t;switch(e){case fq:t="Linear";break;case pq:t="Reinhard";break;case mq:t="OptimizedCineon";break;case gq:t="ACESFilmic";break;case yq:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function Sd(n){return""!==n}function VN(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function HN(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const HK=/^[ \t]*#include +<([\w\d./]+)>/gm;function ib(n){return n.replace(HK,GK)}const zK=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function GK(n,e){let t=lt[e];if(void 0===t){const i=zK.get(e);if(void 0===i)throw new Error("Can not resolve #include <"+e+">");t=lt[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i)}return ib(t)}const WK=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function zN(n){return n.replace(WK,jK)}function jK(n,e,t,i){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function GN(n){let e="precision "+n.precision+" float;\nprecision "+n.precision+" int;";return"highp"===n.precision?e+="\n#define HIGH_PRECISION":"mediump"===n.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===n.precision&&(e+="\n#define LOW_PRECISION"),e}function KK(n,e,t,i){const r=n.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=function $K(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===sP?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===j7?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===vs&&(e="SHADOWMAP_TYPE_VSM"),e}(t),c=function qK(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case lo:case Zo:e="ENVMAP_TYPE_CUBE";break;case dd:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),u=function XK(n){let e="ENVMAP_MODE_REFLECTION";return n.envMap&&n.envMapMode===Zo&&(e="ENVMAP_MODE_REFRACTION"),e}(t),d=function YK(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case Pp:e="ENVMAP_BLENDING_MULTIPLY";break;case dq:e="ENVMAP_BLENDING_MIX";break;case hq:e="ENVMAP_BLENDING_ADD"}return e}(t),h=function ZK(n){const e=n.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:i,maxMip:t}}(t),f=t.isWebGL2?"":function UK(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.normalMapTangentSpace||n.clearcoatNormalMap||n.flatShading||"physical"===n.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Sd).join("\n")}(t),p=function BK(n){const e=[];for(const t in n){const i=n[t];!1!==i&&e.push("#define "+t+" "+i)}return e.join("\n")}(s),y=r.createProgram();let g,m,v=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(g=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p].filter(Sd).join("\n"),g.length>0&&(g+="\n"),m=[f,"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p].filter(Sd).join("\n"),m.length>0&&(m+="\n")):(g=[GN(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Sd).join("\n"),m=[f,GN(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+u:"",t.envMap?"#define "+d:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==ao?"#define TONE_MAPPING":"",t.toneMapping!==ao?lt.tonemapping_pars_fragment:"",t.toneMapping!==ao?kK("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",lt.colorspace_pars_fragment,FK("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(Sd).join("\n")),o=ib(o),o=VN(o,t),o=HN(o,t),a=ib(a),a=VN(a,t),a=HN(a,t),o=zN(o),a=zN(a),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(v="#version 300 es\n",g=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+g,m=["#define varying in",t.glslVersion===qP?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===qP?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+m);const E=v+m+a,S=UN(r,r.VERTEX_SHADER,v+g+o),x=UN(r,r.FRAGMENT_SHADER,E);if(r.attachShader(y,S),r.attachShader(y,x),void 0!==t.index0AttributeName?r.bindAttribLocation(y,0,t.index0AttributeName):!0===t.morphTargets&&r.bindAttribLocation(y,0,"position"),r.linkProgram(y),n.debug.checkShaderErrors){const b=r.getProgramInfoLog(y).trim(),C=r.getShaderInfoLog(S).trim(),U=r.getShaderInfoLog(x).trim();let Y=!0,ee=!0;if(!1===r.getProgramParameter(y,r.LINK_STATUS))if(Y=!1,"function"==typeof n.debug.onShaderError)n.debug.onShaderError(r,y,S,x);else{const L=BN(r,S,"vertex"),G=BN(r,x,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(y,r.VALIDATE_STATUS)+"\n\nProgram Info Log: "+b+"\n"+L+"\n"+G)}else""!==b?console.warn("THREE.WebGLProgram: Program Info Log:",b):(""===C||""===U)&&(ee=!1);ee&&(this.diagnostics={runnable:Y,programLog:b,vertexShader:{log:C,prefix:g},fragmentShader:{log:U,prefix:m}})}let M,R;return r.deleteShader(S),r.deleteShader(x),this.getUniforms=function(){return void 0===M&&(M=new _m(r,y)),M},this.getAttributes=function(){return void 0===R&&(R=function VK(n,e){const t={},i=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const s=n.getActiveAttrib(e,r),o=s.name;let a=1;s.type===n.FLOAT_MAT2&&(a=2),s.type===n.FLOAT_MAT3&&(a=3),s.type===n.FLOAT_MAT4&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}(r,y)),R},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(y),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=NK++,this.cacheKey=e,this.usedTimes=1,this.program=y,this.vertexShader=S,this.fragmentShader=x,this}let JK=0;class QK{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.fragmentShader,r=this._getShaderStage(e.vertexShader),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return!1===o.has(r)&&(o.add(r),r.usedTimes++),!1===o.has(s)&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,0===i.usedTimes&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return void 0===i&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return void 0===i&&(i=new eJ(e),t.set(e,i)),i}}class eJ{constructor(e){this.id=JK++,this.code=e,this.usedTimes=0}}function tJ(n,e,t,i,r,s,o){const a=new HE,l=new QK,c=[],u=r.isWebGL2,d=r.logarithmicDepthBuffer,h=r.vertexTextures;let f=r.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function y(b){return 0===b?"uv":`uv${b}`}return{getParameters:function g(b,C,U,Y,ee){const L=Y.fog,G=ee.geometry,k=(b.isMeshStandardMaterial?t:e).get(b.envMap||(b.isMeshStandardMaterial?Y.environment:null)),W=k&&k.mapping===dd?k.image.height:null,V=p[b.type];null!==b.precision&&(f=r.getMaxPrecision(b.precision),f!==b.precision&&console.warn("THREE.WebGLProgram.getParameters:",b.precision,"not supported, using",f,"instead."));const Z=G.morphAttributes.position||G.morphAttributes.normal||G.morphAttributes.color,O=void 0!==Z?Z.length:0;let de,ae,Me,Be,$=0;if(void 0!==G.morphAttributes.position&&($=1),void 0!==G.morphAttributes.normal&&($=2),void 0!==G.morphAttributes.color&&($=3),V){const jt=Xr[V];de=jt.vertexShader,ae=jt.fragmentShader}else de=b.vertexShader,ae=b.fragmentShader,l.update(b),Me=l.getVertexShaderID(b),Be=l.getFragmentShaderID(b);const Se=n.getRenderTarget(),Ie=!0===ee.isInstancedMesh,Xe=!!b.map,Ve=!!k,P=!!b.aoMap,me=!!b.lightMap,Q=!!b.bumpMap,ce=!!b.normalMap,re=!!b.displacementMap,ke=!!b.emissiveMap,Te=!!b.metalnessMap,De=!!b.roughnessMap,We=b.anisotropy>0,mt=b.clearcoat>0,Yt=b.iridescence>0,D=b.sheen>0,w=b.transmission>0,z=We&&!!b.anisotropyMap,le=mt&&!!b.clearcoatMap,oe=mt&&!!b.clearcoatNormalMap,ue=mt&&!!b.clearcoatRoughnessMap,Oe=Yt&&!!b.iridescenceMap,he=Yt&&!!b.iridescenceThicknessMap,Ee=D&&!!b.sheenColorMap,N=D&&!!b.sheenRoughnessMap,fe=!!b.specularMap,ie=!!b.specularColorMap,Ye=!!b.specularIntensityMap,Ue=w&&!!b.transmissionMap,He=w&&!!b.thicknessMap,I=!!b.alphaMap,ve=!!b.extensions,ye=!!G.attributes.uv1,se=!!G.attributes.uv2,Le=!!G.attributes.uv3;let Ke=ao;return b.toneMapped&&(null===Se||!0===Se.isXRRenderTarget)&&(Ke=n.toneMapping),{isWebGL2:u,shaderID:V,shaderType:b.type,shaderName:b.name,vertexShader:de,fragmentShader:ae,defines:b.defines,customVertexShaderID:Me,customFragmentShaderID:Be,isRawShaderMaterial:!0===b.isRawShaderMaterial,glslVersion:b.glslVersion,precision:f,instancing:Ie,instancingColor:Ie&&null!==ee.instanceColor,supportsVertexTextures:h,outputColorSpace:null===Se?n.outputColorSpace:!0===Se.isXRRenderTarget?Se.texture.colorSpace:Ss,map:Xe,matcap:!!b.matcap,envMap:Ve,envMapMode:Ve&&k.mapping,envMapCubeUVHeight:W,aoMap:P,lightMap:me,bumpMap:Q,normalMap:ce,displacementMap:h&&re,emissiveMap:ke,normalMapObjectSpace:ce&&1===b.normalMapType,normalMapTangentSpace:ce&&0===b.normalMapType,metalnessMap:Te,roughnessMap:De,anisotropy:We,anisotropyMap:z,clearcoat:mt,clearcoatMap:le,clearcoatNormalMap:oe,clearcoatRoughnessMap:ue,iridescence:Yt,iridescenceMap:Oe,iridescenceThicknessMap:he,sheen:D,sheenColorMap:Ee,sheenRoughnessMap:N,specularMap:fe,specularColorMap:ie,specularIntensityMap:Ye,transmission:w,transmissionMap:Ue,thicknessMap:He,gradientMap:!!b.gradientMap,opaque:!1===b.transparent&&1===b.blending,alphaMap:I,alphaTest:b.alphaTest>0,alphaHash:!!b.alphaHash,combine:b.combine,mapUv:Xe&&y(b.map.channel),aoMapUv:P&&y(b.aoMap.channel),lightMapUv:me&&y(b.lightMap.channel),bumpMapUv:Q&&y(b.bumpMap.channel),normalMapUv:ce&&y(b.normalMap.channel),displacementMapUv:re&&y(b.displacementMap.channel),emissiveMapUv:ke&&y(b.emissiveMap.channel),metalnessMapUv:Te&&y(b.metalnessMap.channel),roughnessMapUv:De&&y(b.roughnessMap.channel),anisotropyMapUv:z&&y(b.anisotropyMap.channel),clearcoatMapUv:le&&y(b.clearcoatMap.channel),clearcoatNormalMapUv:oe&&y(b.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:ue&&y(b.clearcoatRoughnessMap.channel),iridescenceMapUv:Oe&&y(b.iridescenceMap.channel),iridescenceThicknessMapUv:he&&y(b.iridescenceThicknessMap.channel),sheenColorMapUv:Ee&&y(b.sheenColorMap.channel),sheenRoughnessMapUv:N&&y(b.sheenRoughnessMap.channel),specularMapUv:fe&&y(b.specularMap.channel),specularColorMapUv:ie&&y(b.specularColorMap.channel),specularIntensityMapUv:Ye&&y(b.specularIntensityMap.channel),transmissionMapUv:Ue&&y(b.transmissionMap.channel),thicknessMapUv:He&&y(b.thicknessMap.channel),alphaMapUv:I&&y(b.alphaMap.channel),vertexTangents:!!G.attributes.tangent&&(ce||We),vertexColors:b.vertexColors,vertexAlphas:!0===b.vertexColors&&!!G.attributes.color&&4===G.attributes.color.itemSize,vertexUv1s:ye,vertexUv2s:se,vertexUv3s:Le,pointsUvs:!0===ee.isPoints&&!!G.attributes.uv&&(Xe||I),fog:!!L,useFog:!0===b.fog,fogExp2:L&&L.isFogExp2,flatShading:!0===b.flatShading,sizeAttenuation:!0===b.sizeAttenuation,logarithmicDepthBuffer:d,skinning:!0===ee.isSkinnedMesh,morphTargets:void 0!==G.morphAttributes.position,morphNormals:void 0!==G.morphAttributes.normal,morphColors:void 0!==G.morphAttributes.color,morphTargetsCount:O,morphTextureStride:$,numDirLights:C.directional.length,numPointLights:C.point.length,numSpotLights:C.spot.length,numSpotLightMaps:C.spotLightMap.length,numRectAreaLights:C.rectArea.length,numHemiLights:C.hemi.length,numDirLightShadows:C.directionalShadowMap.length,numPointLightShadows:C.pointShadowMap.length,numSpotLightShadows:C.spotShadowMap.length,numSpotLightShadowsWithMaps:C.numSpotLightShadowsWithMaps,numLightProbes:C.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:b.dithering,shadowMapEnabled:n.shadowMap.enabled&&U.length>0,shadowMapType:n.shadowMap.type,toneMapping:Ke,useLegacyLights:n._useLegacyLights,decodeVideoTexture:Xe&&!0===b.map.isVideoTexture&&Pt.getTransfer(b.map.colorSpace)===zt,premultipliedAlpha:b.premultipliedAlpha,doubleSided:2===b.side,flipSided:1===b.side,useDepthPacking:b.depthPacking>=0,depthPacking:b.depthPacking||0,index0AttributeName:b.index0AttributeName,extensionDerivatives:ve&&!0===b.extensions.derivatives,extensionFragDepth:ve&&!0===b.extensions.fragDepth,extensionDrawBuffers:ve&&!0===b.extensions.drawBuffers,extensionShaderTextureLOD:ve&&!0===b.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||i.has("EXT_shader_texture_lod"),customProgramCacheKey:b.customProgramCacheKey()}},getProgramCacheKey:function m(b){const C=[];if(b.shaderID?C.push(b.shaderID):(C.push(b.customVertexShaderID),C.push(b.customFragmentShaderID)),void 0!==b.defines)for(const U in b.defines)C.push(U),C.push(b.defines[U]);return!1===b.isRawShaderMaterial&&(function v(b,C){b.push(C.precision),b.push(C.outputColorSpace),b.push(C.envMapMode),b.push(C.envMapCubeUVHeight),b.push(C.mapUv),b.push(C.alphaMapUv),b.push(C.lightMapUv),b.push(C.aoMapUv),b.push(C.bumpMapUv),b.push(C.normalMapUv),b.push(C.displacementMapUv),b.push(C.emissiveMapUv),b.push(C.metalnessMapUv),b.push(C.roughnessMapUv),b.push(C.anisotropyMapUv),b.push(C.clearcoatMapUv),b.push(C.clearcoatNormalMapUv),b.push(C.clearcoatRoughnessMapUv),b.push(C.iridescenceMapUv),b.push(C.iridescenceThicknessMapUv),b.push(C.sheenColorMapUv),b.push(C.sheenRoughnessMapUv),b.push(C.specularMapUv),b.push(C.specularColorMapUv),b.push(C.specularIntensityMapUv),b.push(C.transmissionMapUv),b.push(C.thicknessMapUv),b.push(C.combine),b.push(C.fogExp2),b.push(C.sizeAttenuation),b.push(C.morphTargetsCount),b.push(C.morphAttributeCount),b.push(C.numDirLights),b.push(C.numPointLights),b.push(C.numSpotLights),b.push(C.numSpotLightMaps),b.push(C.numHemiLights),b.push(C.numRectAreaLights),b.push(C.numDirLightShadows),b.push(C.numPointLightShadows),b.push(C.numSpotLightShadows),b.push(C.numSpotLightShadowsWithMaps),b.push(C.numLightProbes),b.push(C.shadowMapType),b.push(C.toneMapping),b.push(C.numClippingPlanes),b.push(C.numClipIntersection),b.push(C.depthPacking)}(C,b),function _(b,C){a.disableAll(),C.isWebGL2&&a.enable(0),C.supportsVertexTextures&&a.enable(1),C.instancing&&a.enable(2),C.instancingColor&&a.enable(3),C.matcap&&a.enable(4),C.envMap&&a.enable(5),C.normalMapObjectSpace&&a.enable(6),C.normalMapTangentSpace&&a.enable(7),C.clearcoat&&a.enable(8),C.iridescence&&a.enable(9),C.alphaTest&&a.enable(10),C.vertexColors&&a.enable(11),C.vertexAlphas&&a.enable(12),C.vertexUv1s&&a.enable(13),C.vertexUv2s&&a.enable(14),C.vertexUv3s&&a.enable(15),C.vertexTangents&&a.enable(16),C.anisotropy&&a.enable(17),b.push(a.mask),a.disableAll(),C.fog&&a.enable(0),C.useFog&&a.enable(1),C.flatShading&&a.enable(2),C.logarithmicDepthBuffer&&a.enable(3),C.skinning&&a.enable(4),C.morphTargets&&a.enable(5),C.morphNormals&&a.enable(6),C.morphColors&&a.enable(7),C.premultipliedAlpha&&a.enable(8),C.shadowMapEnabled&&a.enable(9),C.useLegacyLights&&a.enable(10),C.doubleSided&&a.enable(11),C.flipSided&&a.enable(12),C.useDepthPacking&&a.enable(13),C.dithering&&a.enable(14),C.transmission&&a.enable(15),C.sheen&&a.enable(16),C.opaque&&a.enable(17),C.pointsUvs&&a.enable(18),C.decodeVideoTexture&&a.enable(19),b.push(a.mask)}(C,b),C.push(n.outputColorSpace)),C.push(b.customProgramCacheKey),C.join()},getUniforms:function E(b){const C=p[b.type];let U;return U=C?bX.clone(Xr[C].uniforms):b.uniforms,U},acquireProgram:function S(b,C){let U;for(let Y=0,ee=c.length;Y<ee;Y++){const L=c[Y];if(L.cacheKey===C){U=L,++U.usedTimes;break}}return void 0===U&&(U=new KK(n,C,b,s),c.push(U)),U},releaseProgram:function x(b){if(0==--b.usedTimes){const C=c.indexOf(b);c[C]=c[c.length-1],c.pop(),b.destroy()}},releaseShaderCache:function M(b){l.remove(b)},programs:c,dispose:function R(){l.dispose()}}}function nJ(){let n=new WeakMap;return{get:function e(s){let o=n.get(s);return void 0===o&&(o={},n.set(s,o)),o},remove:function t(s){n.delete(s)},update:function i(s,o,a){n.get(s)[o]=a},dispose:function r(){n=new WeakMap}}}function iJ(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function WN(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function jN(){const n=[];let e=0;const t=[],i=[],r=[];function o(d,h,f,p,y,g){let m=n[e];return void 0===m?(m={id:d.id,object:d,geometry:h,material:f,groupOrder:p,renderOrder:d.renderOrder,z:y,group:g},n[e]=m):(m.id=d.id,m.object=d,m.geometry=h,m.material=f,m.groupOrder=p,m.renderOrder=d.renderOrder,m.z=y,m.group=g),e++,m}return{opaque:t,transmissive:i,transparent:r,init:function s(){e=0,t.length=0,i.length=0,r.length=0},push:function a(d,h,f,p,y,g){const m=o(d,h,f,p,y,g);f.transmission>0?i.push(m):!0===f.transparent?r.push(m):t.push(m)},unshift:function l(d,h,f,p,y,g){const m=o(d,h,f,p,y,g);f.transmission>0?i.unshift(m):!0===f.transparent?r.unshift(m):t.unshift(m)},finish:function u(){for(let d=e,h=n.length;d<h;d++){const f=n[d];if(null===f.id)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}},sort:function c(d,h){t.length>1&&t.sort(d||iJ),i.length>1&&i.sort(h||WN),r.length>1&&r.sort(h||WN)}}}function rJ(){let n=new WeakMap;return{get:function e(i,r){const s=n.get(i);let o;return void 0===s?(o=new jN,n.set(i,[o])):r>=s.length?(o=new jN,s.push(o)):o=s[r],o},dispose:function t(){n=new WeakMap}}}function sJ(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new T,color:new Ae};break;case"SpotLight":t={position:new T,direction:new T,color:new Ae,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new T,color:new Ae,distance:0,decay:0};break;case"HemisphereLight":t={direction:new T,skyColor:new Ae,groundColor:new Ae};break;case"RectAreaLight":t={color:new Ae,position:new T,halfWidth:new T,halfHeight:new T}}return n[e.id]=t,t}}}let aJ=0;function lJ(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function cJ(n,e){const t=new sJ,i=function oJ(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new K};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new K,shadowCameraNear:1,shadowCameraFar:1e3}}return n[e.id]=t,t}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let u=0;u<9;u++)r.probe.push(new T);const s=new T,o=new ot,a=new ot;return{setup:function l(u,d){let h=0,f=0,p=0;for(let Y=0;Y<9;Y++)r.probe[Y].set(0,0,0);let y=0,g=0,m=0,v=0,_=0,E=0,S=0,x=0,M=0,R=0,b=0;u.sort(lJ);const C=!0===d?Math.PI:1;for(let Y=0,ee=u.length;Y<ee;Y++){const L=u[Y],G=L.color,F=L.intensity,k=L.distance,W=L.shadow&&L.shadow.map?L.shadow.map.texture:null;if(L.isAmbientLight)h+=G.r*F*C,f+=G.g*F*C,p+=G.b*F*C;else if(L.isLightProbe){for(let V=0;V<9;V++)r.probe[V].addScaledVector(L.sh.coefficients[V],F);b++}else if(L.isDirectionalLight){const V=t.get(L);if(V.color.copy(L.color).multiplyScalar(L.intensity*C),L.castShadow){const Z=L.shadow,O=i.get(L);O.shadowBias=Z.bias,O.shadowNormalBias=Z.normalBias,O.shadowRadius=Z.radius,O.shadowMapSize=Z.mapSize,r.directionalShadow[y]=O,r.directionalShadowMap[y]=W,r.directionalShadowMatrix[y]=L.shadow.matrix,E++}r.directional[y]=V,y++}else if(L.isSpotLight){const V=t.get(L);V.position.setFromMatrixPosition(L.matrixWorld),V.color.copy(G).multiplyScalar(F*C),V.distance=k,V.coneCos=Math.cos(L.angle),V.penumbraCos=Math.cos(L.angle*(1-L.penumbra)),V.decay=L.decay,r.spot[m]=V;const Z=L.shadow;if(L.map&&(r.spotLightMap[M]=L.map,M++,Z.updateMatrices(L),L.castShadow&&R++),r.spotLightMatrix[m]=Z.matrix,L.castShadow){const O=i.get(L);O.shadowBias=Z.bias,O.shadowNormalBias=Z.normalBias,O.shadowRadius=Z.radius,O.shadowMapSize=Z.mapSize,r.spotShadow[m]=O,r.spotShadowMap[m]=W,x++}m++}else if(L.isRectAreaLight){const V=t.get(L);V.color.copy(G).multiplyScalar(F),V.halfWidth.set(.5*L.width,0,0),V.halfHeight.set(0,.5*L.height,0),r.rectArea[v]=V,v++}else if(L.isPointLight){const V=t.get(L);if(V.color.copy(L.color).multiplyScalar(L.intensity*C),V.distance=L.distance,V.decay=L.decay,L.castShadow){const Z=L.shadow,O=i.get(L);O.shadowBias=Z.bias,O.shadowNormalBias=Z.normalBias,O.shadowRadius=Z.radius,O.shadowMapSize=Z.mapSize,O.shadowCameraNear=Z.camera.near,O.shadowCameraFar=Z.camera.far,r.pointShadow[g]=O,r.pointShadowMap[g]=W,r.pointShadowMatrix[g]=L.shadow.matrix,S++}r.point[g]=V,g++}else if(L.isHemisphereLight){const V=t.get(L);V.skyColor.copy(L.color).multiplyScalar(F*C),V.groundColor.copy(L.groundColor).multiplyScalar(F*C),r.hemi[_]=V,_++}}v>0&&(e.isWebGL2||!0===n.has("OES_texture_float_linear")?(r.rectAreaLTC1=_e.LTC_FLOAT_1,r.rectAreaLTC2=_e.LTC_FLOAT_2):!0===n.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=_e.LTC_HALF_1,r.rectAreaLTC2=_e.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=h,r.ambient[1]=f,r.ambient[2]=p;const U=r.hash;(U.directionalLength!==y||U.pointLength!==g||U.spotLength!==m||U.rectAreaLength!==v||U.hemiLength!==_||U.numDirectionalShadows!==E||U.numPointShadows!==S||U.numSpotShadows!==x||U.numSpotMaps!==M||U.numLightProbes!==b)&&(r.directional.length=y,r.spot.length=m,r.rectArea.length=v,r.point.length=g,r.hemi.length=_,r.directionalShadow.length=E,r.directionalShadowMap.length=E,r.pointShadow.length=S,r.pointShadowMap.length=S,r.spotShadow.length=x,r.spotShadowMap.length=x,r.directionalShadowMatrix.length=E,r.pointShadowMatrix.length=S,r.spotLightMatrix.length=x+M-R,r.spotLightMap.length=M,r.numSpotLightShadowsWithMaps=R,r.numLightProbes=b,U.directionalLength=y,U.pointLength=g,U.spotLength=m,U.rectAreaLength=v,U.hemiLength=_,U.numDirectionalShadows=E,U.numPointShadows=S,U.numSpotShadows=x,U.numSpotMaps=M,U.numLightProbes=b,r.version=aJ++)},setupView:function c(u,d){let h=0,f=0,p=0,y=0,g=0;const m=d.matrixWorldInverse;for(let v=0,_=u.length;v<_;v++){const E=u[v];if(E.isDirectionalLight){const S=r.directional[h];S.direction.setFromMatrixPosition(E.matrixWorld),s.setFromMatrixPosition(E.target.matrixWorld),S.direction.sub(s),S.direction.transformDirection(m),h++}else if(E.isSpotLight){const S=r.spot[p];S.position.setFromMatrixPosition(E.matrixWorld),S.position.applyMatrix4(m),S.direction.setFromMatrixPosition(E.matrixWorld),s.setFromMatrixPosition(E.target.matrixWorld),S.direction.sub(s),S.direction.transformDirection(m),p++}else if(E.isRectAreaLight){const S=r.rectArea[y];S.position.setFromMatrixPosition(E.matrixWorld),S.position.applyMatrix4(m),a.identity(),o.copy(E.matrixWorld),o.premultiply(m),a.extractRotation(o),S.halfWidth.set(.5*E.width,0,0),S.halfHeight.set(0,.5*E.height,0),S.halfWidth.applyMatrix4(a),S.halfHeight.applyMatrix4(a),y++}else if(E.isPointLight){const S=r.point[f];S.position.setFromMatrixPosition(E.matrixWorld),S.position.applyMatrix4(m),f++}else if(E.isHemisphereLight){const S=r.hemi[g];S.direction.setFromMatrixPosition(E.matrixWorld),S.direction.transformDirection(m),g++}}},state:r}}function $N(n,e){const t=new cJ(n,e),i=[],r=[];return{init:function s(){i.length=0,r.length=0},state:{lightsArray:i,shadowsArray:r,lights:t},setupLights:function l(d){t.setup(i,d)},setupLightsView:function c(d){t.setupView(i,d)},pushLight:function o(d){i.push(d)},pushShadow:function a(d){r.push(d)}}}function uJ(n,e){let t=new WeakMap;return{get:function i(s,o=0){const a=t.get(s);let l;return void 0===a?(l=new $N(n,e),t.set(s,[l])):o>=a.length?(l=new $N(n,e),a.push(l)):l=a[o],l},dispose:function r(){t=new WeakMap}}}class qN extends vd{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class XN extends vd{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function fJ(n,e,t){let i=new KE;const r=new K,s=new K,o=new Nt,a=new qN({depthPacking:3201}),l=new XN,c={},u=t.maxTextureSize,d={0:1,1:0,2:2},h=new vo({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new K},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),f=h.clone();f.defines.HORIZONTAL_PASS=1;const p=new pt;p.setAttribute("position",new Nn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const y=new Di(p,h),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=sP;let m=this.type;function v(S,x){const M=e.update(y);h.defines.VSM_SAMPLES!==S.blurSamples&&(h.defines.VSM_SAMPLES=S.blurSamples,f.defines.VSM_SAMPLES=S.blurSamples,h.needsUpdate=!0,f.needsUpdate=!0),null===S.mapPass&&(S.mapPass=new ra(r.x,r.y)),h.uniforms.shadow_pass.value=S.map.texture,h.uniforms.resolution.value=S.mapSize,h.uniforms.radius.value=S.radius,n.setRenderTarget(S.mapPass),n.clear(),n.renderBufferDirect(x,null,M,h,y,null),f.uniforms.shadow_pass.value=S.mapPass.texture,f.uniforms.resolution.value=S.mapSize,f.uniforms.radius.value=S.radius,n.setRenderTarget(S.map),n.clear(),n.renderBufferDirect(x,null,M,f,y,null)}function _(S,x,M,R){let b=null;const C=!0===M.isPointLight?S.customDistanceMaterial:S.customDepthMaterial;if(void 0!==C)b=C;else if(b=!0===M.isPointLight?l:a,n.localClippingEnabled&&!0===x.clipShadows&&Array.isArray(x.clippingPlanes)&&0!==x.clippingPlanes.length||x.displacementMap&&0!==x.displacementScale||x.alphaMap&&x.alphaTest>0||x.map&&x.alphaTest>0){const U=b.uuid,Y=x.uuid;let ee=c[U];void 0===ee&&(ee={},c[U]=ee);let L=ee[Y];void 0===L&&(L=b.clone(),ee[Y]=L),b=L}return b.visible=x.visible,b.wireframe=x.wireframe,b.side=R===vs?null!==x.shadowSide?x.shadowSide:x.side:null!==x.shadowSide?x.shadowSide:d[x.side],b.alphaMap=x.alphaMap,b.alphaTest=x.alphaTest,b.map=x.map,b.clipShadows=x.clipShadows,b.clippingPlanes=x.clippingPlanes,b.clipIntersection=x.clipIntersection,b.displacementMap=x.displacementMap,b.displacementScale=x.displacementScale,b.displacementBias=x.displacementBias,b.wireframeLinewidth=x.wireframeLinewidth,b.linewidth=x.linewidth,!0===M.isPointLight&&!0===b.isMeshDistanceMaterial&&(n.properties.get(b).light=M),b}function E(S,x,M,R,b){if(!1===S.visible)return;if(S.layers.test(x.layers)&&(S.isMesh||S.isLine||S.isPoints)&&(S.castShadow||S.receiveShadow&&b===vs)&&(!S.frustumCulled||i.intersectsObject(S))){S.modelViewMatrix.multiplyMatrices(M.matrixWorldInverse,S.matrixWorld);const Y=e.update(S),ee=S.material;if(Array.isArray(ee)){const L=Y.groups;for(let G=0,F=L.length;G<F;G++){const k=L[G],W=ee[k.materialIndex];if(W&&W.visible){const V=_(S,W,R,b);n.renderBufferDirect(M,null,Y,V,S,k)}}}else if(ee.visible){const L=_(S,ee,R,b);n.renderBufferDirect(M,null,Y,L,S,null)}}const U=S.children;for(let Y=0,ee=U.length;Y<ee;Y++)E(U[Y],x,M,R,b)}this.render=function(S,x,M){if(!1===g.enabled||!1===g.autoUpdate&&!1===g.needsUpdate||0===S.length)return;const R=n.getRenderTarget(),b=n.getActiveCubeFace(),C=n.getActiveMipmapLevel(),U=n.state;U.setBlending(0),U.buffers.color.setClear(1,1,1,1),U.buffers.depth.setTest(!0),U.setScissorTest(!1);const Y=m!==vs&&this.type===vs,ee=m===vs&&this.type!==vs;for(let L=0,G=S.length;L<G;L++){const F=S[L],k=F.shadow;if(void 0===k){console.warn("THREE.WebGLShadowMap:",F,"has no shadow.");continue}if(!1===k.autoUpdate&&!1===k.needsUpdate)continue;r.copy(k.mapSize);const W=k.getFrameExtents();if(r.multiply(W),s.copy(k.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/W.x),r.x=s.x*W.x,k.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/W.y),r.y=s.y*W.y,k.mapSize.y=s.y)),null===k.map||!0===Y||!0===ee){const Z=this.type!==vs?{minFilter:yn,magFilter:yn}:{};null!==k.map&&k.map.dispose(),k.map=new ra(r.x,r.y,Z),k.map.texture.name=F.name+".shadowMap",k.camera.updateProjectionMatrix()}n.setRenderTarget(k.map),n.clear();const V=k.getViewportCount();for(let Z=0;Z<V;Z++){const O=k.getViewport(Z);o.set(s.x*O.x,s.y*O.y,s.x*O.z,s.y*O.w),U.viewport(o),k.updateMatrices(F,Z),i=k.getFrustum(),E(x,M,k.camera,F,this.type)}!0!==k.isPointLightShadow&&this.type===vs&&v(k,M),k.needsUpdate=!1}m=this.type,g.needsUpdate=!1,n.setRenderTarget(R,b,C)}}function pJ(n,e,t){const i=t.isWebGL2,a=new function r(){let I=!1;const ge=new Nt;let pe=null;const ve=new Nt(0,0,0,0);return{setMask:function(ye){pe!==ye&&!I&&(n.colorMask(ye,ye,ye,ye),pe=ye)},setLocked:function(ye){I=ye},setClear:function(ye,se,Le,Ke,En){!0===En&&(ye*=Ke,se*=Ke,Le*=Ke),ge.set(ye,se,Le,Ke),!1===ve.equals(ge)&&(n.clearColor(ye,se,Le,Ke),ve.copy(ge))},reset:function(){I=!1,pe=null,ve.set(-1,0,0,0)}}},l=new function s(){let I=!1,ge=null,pe=null,ve=null;return{setTest:function(ye){ye?Se(n.DEPTH_TEST):Ie(n.DEPTH_TEST)},setMask:function(ye){ge!==ye&&!I&&(n.depthMask(ye),ge=ye)},setFunc:function(ye){if(pe!==ye){switch(ye){case 0:n.depthFunc(n.NEVER);break;case 1:n.depthFunc(n.ALWAYS);break;case 2:n.depthFunc(n.LESS);break;case 3:default:n.depthFunc(n.LEQUAL);break;case 4:n.depthFunc(n.EQUAL);break;case 5:n.depthFunc(n.GEQUAL);break;case 6:n.depthFunc(n.GREATER);break;case 7:n.depthFunc(n.NOTEQUAL)}pe=ye}},setLocked:function(ye){I=ye},setClear:function(ye){ve!==ye&&(n.clearDepth(ye),ve=ye)},reset:function(){I=!1,ge=null,pe=null,ve=null}}},c=new function o(){let I=!1,ge=null,pe=null,ve=null,ye=null,se=null,Le=null,Ke=null,En=null;return{setTest:function(jt){I||(jt?Se(n.STENCIL_TEST):Ie(n.STENCIL_TEST))},setMask:function(jt){ge!==jt&&!I&&(n.stencilMask(jt),ge=jt)},setFunc:function(jt,Jr,mi){(pe!==jt||ve!==Jr||ye!==mi)&&(n.stencilFunc(jt,Jr,mi),pe=jt,ve=Jr,ye=mi)},setOp:function(jt,Jr,mi){(se!==jt||Le!==Jr||Ke!==mi)&&(n.stencilOp(jt,Jr,mi),se=jt,Le=Jr,Ke=mi)},setLocked:function(jt){I=jt},setClear:function(jt){En!==jt&&(n.clearStencil(jt),En=jt)},reset:function(){I=!1,ge=null,pe=null,ve=null,ye=null,se=null,Le=null,Ke=null,En=null}}},u=new WeakMap,d=new WeakMap;let h={},f={},p=new WeakMap,y=[],g=null,m=!1,v=null,_=null,E=null,S=null,x=null,M=null,R=null,b=!1,C=null,U=null,Y=null,ee=null,L=null;const G=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let F=!1,k=0;const W=n.getParameter(n.VERSION);-1!==W.indexOf("WebGL")?(k=parseFloat(/^WebGL (\d)/.exec(W)[1]),F=k>=1):-1!==W.indexOf("OpenGL ES")&&(k=parseFloat(/^OpenGL ES (\d)/.exec(W)[1]),F=k>=2);let V=null,Z={};const O=n.getParameter(n.SCISSOR_BOX),$=n.getParameter(n.VIEWPORT),de=(new Nt).fromArray(O),ae=(new Nt).fromArray($);function Me(I,ge,pe,ve){const ye=new Uint8Array(4),se=n.createTexture();n.bindTexture(I,se),n.texParameteri(I,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(I,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let Le=0;Le<pe;Le++)!i||I!==n.TEXTURE_3D&&I!==n.TEXTURE_2D_ARRAY?n.texImage2D(ge+Le,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,ye):n.texImage3D(ge,0,n.RGBA,1,1,ve,0,n.RGBA,n.UNSIGNED_BYTE,ye);return se}const Be={};function Se(I){!0!==h[I]&&(n.enable(I),h[I]=!0)}function Ie(I){!1!==h[I]&&(n.disable(I),h[I]=!1)}Be[n.TEXTURE_2D]=Me(n.TEXTURE_2D,n.TEXTURE_2D,1),Be[n.TEXTURE_CUBE_MAP]=Me(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),i&&(Be[n.TEXTURE_2D_ARRAY]=Me(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),Be[n.TEXTURE_3D]=Me(n.TEXTURE_3D,n.TEXTURE_3D,1,1)),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),Se(n.DEPTH_TEST),l.setFunc(3),re(!1),ke(1),Se(n.CULL_FACE),Q(0);const P={100:n.FUNC_ADD,101:n.FUNC_SUBTRACT,102:n.FUNC_REVERSE_SUBTRACT};if(i)P[103]=n.MIN,P[104]=n.MAX;else{const I=e.get("EXT_blend_minmax");null!==I&&(P[103]=I.MIN_EXT,P[104]=I.MAX_EXT)}const me={200:n.ZERO,201:n.ONE,202:n.SRC_COLOR,204:n.SRC_ALPHA,210:n.SRC_ALPHA_SATURATE,208:n.DST_COLOR,206:n.DST_ALPHA,203:n.ONE_MINUS_SRC_COLOR,205:n.ONE_MINUS_SRC_ALPHA,209:n.ONE_MINUS_DST_COLOR,207:n.ONE_MINUS_DST_ALPHA};function Q(I,ge,pe,ve,ye,se,Le,Ke){if(0!==I){if(!1===m&&(Se(n.BLEND),m=!0),5===I)ye=ye||ge,se=se||pe,Le=Le||ve,(ge!==_||ye!==x)&&(n.blendEquationSeparate(P[ge],P[ye]),_=ge,x=ye),(pe!==E||ve!==S||se!==M||Le!==R)&&(n.blendFuncSeparate(me[pe],me[ve],me[se],me[Le]),E=pe,S=ve,M=se,R=Le),v=I,b=!1;else if(I!==v||Ke!==b){if((100!==_||100!==x)&&(n.blendEquation(n.FUNC_ADD),_=100,x=100),Ke)switch(I){case 1:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case 2:n.blendFunc(n.ONE,n.ONE);break;case 3:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case 4:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",I)}else switch(I){case 1:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case 2:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case 3:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case 4:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",I)}E=null,S=null,M=null,R=null,v=I,b=Ke}}else!0===m&&(Ie(n.BLEND),m=!1)}function re(I){C!==I&&(n.frontFace(I?n.CW:n.CCW),C=I)}function ke(I){0!==I?(Se(n.CULL_FACE),I!==U&&n.cullFace(1===I?n.BACK:2===I?n.FRONT:n.FRONT_AND_BACK)):Ie(n.CULL_FACE),U=I}function De(I,ge,pe){I?(Se(n.POLYGON_OFFSET_FILL),(ee!==ge||L!==pe)&&(n.polygonOffset(ge,pe),ee=ge,L=pe)):Ie(n.POLYGON_OFFSET_FILL)}return{buffers:{color:a,depth:l,stencil:c},enable:Se,disable:Ie,bindFramebuffer:function Xe(I,ge){return f[I]!==ge&&(n.bindFramebuffer(I,ge),f[I]=ge,i&&(I===n.DRAW_FRAMEBUFFER&&(f[n.FRAMEBUFFER]=ge),I===n.FRAMEBUFFER&&(f[n.DRAW_FRAMEBUFFER]=ge)),!0)},drawBuffers:function bt(I,ge){let pe=y,ve=!1;if(I)if(pe=p.get(ge),void 0===pe&&(pe=[],p.set(ge,pe)),I.isWebGLMultipleRenderTargets){const ye=I.texture;if(pe.length!==ye.length||pe[0]!==n.COLOR_ATTACHMENT0){for(let se=0,Le=ye.length;se<Le;se++)pe[se]=n.COLOR_ATTACHMENT0+se;pe.length=ye.length,ve=!0}}else pe[0]!==n.COLOR_ATTACHMENT0&&(pe[0]=n.COLOR_ATTACHMENT0,ve=!0);else pe[0]!==n.BACK&&(pe[0]=n.BACK,ve=!0);ve&&(t.isWebGL2?n.drawBuffers(pe):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(pe))},useProgram:function Ve(I){return g!==I&&(n.useProgram(I),g=I,!0)},setBlending:Q,setMaterial:function ce(I,ge){2===I.side?Ie(n.CULL_FACE):Se(n.CULL_FACE);let pe=1===I.side;ge&&(pe=!pe),re(pe),1===I.blending&&!1===I.transparent?Q(0):Q(I.blending,I.blendEquation,I.blendSrc,I.blendDst,I.blendEquationAlpha,I.blendSrcAlpha,I.blendDstAlpha,I.premultipliedAlpha),l.setFunc(I.depthFunc),l.setTest(I.depthTest),l.setMask(I.depthWrite),a.setMask(I.colorWrite);const ve=I.stencilWrite;c.setTest(ve),ve&&(c.setMask(I.stencilWriteMask),c.setFunc(I.stencilFunc,I.stencilRef,I.stencilFuncMask),c.setOp(I.stencilFail,I.stencilZFail,I.stencilZPass)),De(I.polygonOffset,I.polygonOffsetFactor,I.polygonOffsetUnits),!0===I.alphaToCoverage?Se(n.SAMPLE_ALPHA_TO_COVERAGE):Ie(n.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:re,setCullFace:ke,setLineWidth:function Te(I){I!==Y&&(F&&n.lineWidth(I),Y=I)},setPolygonOffset:De,setScissorTest:function We(I){I?Se(n.SCISSOR_TEST):Ie(n.SCISSOR_TEST)},activeTexture:function mt(I){void 0===I&&(I=n.TEXTURE0+G-1),V!==I&&(n.activeTexture(I),V=I)},bindTexture:function Yt(I,ge,pe){void 0===pe&&(pe=null===V?n.TEXTURE0+G-1:V);let ve=Z[pe];void 0===ve&&(ve={type:void 0,texture:void 0},Z[pe]=ve),(ve.type!==I||ve.texture!==ge)&&(V!==pe&&(n.activeTexture(pe),V=pe),n.bindTexture(I,ge||Be[I]),ve.type=I,ve.texture=ge)},unbindTexture:function D(){const I=Z[V];void 0!==I&&void 0!==I.type&&(n.bindTexture(I.type,null),I.type=void 0,I.texture=void 0)},compressedTexImage2D:function w(){try{n.compressedTexImage2D.apply(n,arguments)}catch(I){console.error("THREE.WebGLState:",I)}},compressedTexImage3D:function z(){try{n.compressedTexImage3D.apply(n,arguments)}catch(I){console.error("THREE.WebGLState:",I)}},texImage2D:function N(){try{n.texImage2D.apply(n,arguments)}catch(I){console.error("THREE.WebGLState:",I)}},texImage3D:function fe(){try{n.texImage3D.apply(n,arguments)}catch(I){console.error("THREE.WebGLState:",I)}},updateUBOMapping:function Ue(I,ge){let pe=d.get(ge);void 0===pe&&(pe=new WeakMap,d.set(ge,pe));let ve=pe.get(I);void 0===ve&&(ve=n.getUniformBlockIndex(ge,I.name),pe.set(I,ve))},uniformBlockBinding:function He(I,ge){const ve=d.get(ge).get(I);u.get(ge)!==ve&&(n.uniformBlockBinding(ge,ve,I.__bindingPointIndex),u.set(ge,ve))},texStorage2D:function he(){try{n.texStorage2D.apply(n,arguments)}catch(I){console.error("THREE.WebGLState:",I)}},texStorage3D:function Ee(){try{n.texStorage3D.apply(n,arguments)}catch(I){console.error("THREE.WebGLState:",I)}},texSubImage2D:function le(){try{n.texSubImage2D.apply(n,arguments)}catch(I){console.error("THREE.WebGLState:",I)}},texSubImage3D:function oe(){try{n.texSubImage3D.apply(n,arguments)}catch(I){console.error("THREE.WebGLState:",I)}},compressedTexSubImage2D:function ue(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(I){console.error("THREE.WebGLState:",I)}},compressedTexSubImage3D:function Oe(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(I){console.error("THREE.WebGLState:",I)}},scissor:function ie(I){!1===de.equals(I)&&(n.scissor(I.x,I.y,I.z,I.w),de.copy(I))},viewport:function Ye(I){!1===ae.equals(I)&&(n.viewport(I.x,I.y,I.z,I.w),ae.copy(I))},reset:function Fe(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),!0===i&&(n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),h={},V=null,Z={},f={},p=new WeakMap,y=[],g=null,m=!1,v=null,_=null,E=null,S=null,x=null,M=null,R=null,b=!1,C=null,U=null,Y=null,ee=null,L=null,de.set(0,0,n.canvas.width,n.canvas.height),ae.set(0,0,n.canvas.width,n.canvas.height),a.reset(),l.reset(),c.reset()}}}function mJ(n,e,t,i,r,s,o){const a=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,u=r.maxTextureSize,d=r.maxSamples,h=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,f=!(typeof navigator>"u")&&/OculusBrowser/g.test(navigator.userAgent),p=new WeakMap;let y;const g=new WeakMap;let m=!1;try{m=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function v(D,w){return m?new OffscreenCanvas(D,w):pd("canvas")}function _(D,w,z,le){let oe=1;if((D.width>le||D.height>le)&&(oe=le/Math.max(D.width,D.height)),oe<1||!0===w){if(typeof HTMLImageElement<"u"&&D instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&D instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&D instanceof ImageBitmap){const ue=w?qp:Math.floor,Oe=ue(oe*D.width),he=ue(oe*D.height);void 0===y&&(y=v(Oe,he));const Ee=z?v(Oe,he):y;return Ee.width=Oe,Ee.height=he,Ee.getContext("2d").drawImage(D,0,0,Oe,he),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+D.width+"x"+D.height+") to ("+Oe+"x"+he+")."),Ee}return"data"in D&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+D.width+"x"+D.height+")."),D}return D}function E(D){return IE(D.width)&&IE(D.height)}function x(D,w){return D.generateMipmaps&&w&&D.minFilter!==yn&&D.minFilter!==_n}function M(D){n.generateMipmap(D)}function R(D,w,z,le,oe=!1){if(!1===a)return w;if(null!==D){if(void 0!==n[D])return n[D];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+D+"'")}let ue=w;if(w===n.RED&&(z===n.FLOAT&&(ue=n.R32F),z===n.HALF_FLOAT&&(ue=n.R16F),z===n.UNSIGNED_BYTE&&(ue=n.R8)),w===n.RED_INTEGER&&(z===n.UNSIGNED_BYTE&&(ue=n.R8UI),z===n.UNSIGNED_SHORT&&(ue=n.R16UI),z===n.UNSIGNED_INT&&(ue=n.R32UI),z===n.BYTE&&(ue=n.R8I),z===n.SHORT&&(ue=n.R16I),z===n.INT&&(ue=n.R32I)),w===n.RG&&(z===n.FLOAT&&(ue=n.RG32F),z===n.HALF_FLOAT&&(ue=n.RG16F),z===n.UNSIGNED_BYTE&&(ue=n.RG8)),w===n.RGBA){const Oe=oe?zp:Pt.getTransfer(le);z===n.FLOAT&&(ue=n.RGBA32F),z===n.HALF_FLOAT&&(ue=n.RGBA16F),z===n.UNSIGNED_BYTE&&(ue=Oe===zt?n.SRGB8_ALPHA8:n.RGBA8),z===n.UNSIGNED_SHORT_4_4_4_4&&(ue=n.RGBA4),z===n.UNSIGNED_SHORT_5_5_5_1&&(ue=n.RGB5_A1)}return(ue===n.R16F||ue===n.R32F||ue===n.RG16F||ue===n.RG32F||ue===n.RGBA16F||ue===n.RGBA32F)&&e.get("EXT_color_buffer_float"),ue}function b(D,w,z){return!0===x(D,z)||D.isFramebufferTexture&&D.minFilter!==yn&&D.minFilter!==_n?Math.log2(Math.max(w.width,w.height))+1:void 0!==D.mipmaps&&D.mipmaps.length>0?D.mipmaps.length:D.isCompressedTexture&&Array.isArray(D.image)?w.mipmaps.length:1}function C(D){return D===yn||1004===D||1005===D?n.NEAREST:n.LINEAR}function U(D){const w=D.target;w.removeEventListener("dispose",U),function ee(D){const w=i.get(D);if(void 0===w.__webglInit)return;const z=D.source,le=g.get(z);if(le){const oe=le[w.__cacheKey];oe.usedTimes--,0===oe.usedTimes&&L(D),0===Object.keys(le).length&&g.delete(z)}i.remove(D)}(w),w.isVideoTexture&&p.delete(w)}function Y(D){const w=D.target;w.removeEventListener("dispose",Y),function G(D){const w=D.texture,z=i.get(D),le=i.get(w);if(void 0!==le.__webglTexture&&(n.deleteTexture(le.__webglTexture),o.memory.textures--),D.depthTexture&&D.depthTexture.dispose(),D.isWebGLCubeRenderTarget)for(let oe=0;oe<6;oe++){if(Array.isArray(z.__webglFramebuffer[oe]))for(let ue=0;ue<z.__webglFramebuffer[oe].length;ue++)n.deleteFramebuffer(z.__webglFramebuffer[oe][ue]);else n.deleteFramebuffer(z.__webglFramebuffer[oe]);z.__webglDepthbuffer&&n.deleteRenderbuffer(z.__webglDepthbuffer[oe])}else{if(Array.isArray(z.__webglFramebuffer))for(let oe=0;oe<z.__webglFramebuffer.length;oe++)n.deleteFramebuffer(z.__webglFramebuffer[oe]);else n.deleteFramebuffer(z.__webglFramebuffer);if(z.__webglDepthbuffer&&n.deleteRenderbuffer(z.__webglDepthbuffer),z.__webglMultisampledFramebuffer&&n.deleteFramebuffer(z.__webglMultisampledFramebuffer),z.__webglColorRenderbuffer)for(let oe=0;oe<z.__webglColorRenderbuffer.length;oe++)z.__webglColorRenderbuffer[oe]&&n.deleteRenderbuffer(z.__webglColorRenderbuffer[oe]);z.__webglDepthRenderbuffer&&n.deleteRenderbuffer(z.__webglDepthRenderbuffer)}if(D.isWebGLMultipleRenderTargets)for(let oe=0,ue=w.length;oe<ue;oe++){const Oe=i.get(w[oe]);Oe.__webglTexture&&(n.deleteTexture(Oe.__webglTexture),o.memory.textures--),i.remove(w[oe])}i.remove(w),i.remove(D)}(w)}function L(D){const w=i.get(D);n.deleteTexture(w.__webglTexture),delete g.get(D.source)[w.__cacheKey],o.memory.textures--}let F=0;function Z(D,w){const z=i.get(D);if(D.isVideoTexture&&function mt(D){const w=o.render.frame;p.get(D)!==w&&(p.set(D,w),D.update())}(D),!1===D.isRenderTargetTexture&&D.version>0&&z.__version!==D.version){const le=D.image;if(null===le)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==le.complete)return void Xe(z,D,w);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.bindTexture(n.TEXTURE_2D,z.__webglTexture,n.TEXTURE0+w)}const ae={1e3:n.REPEAT,[ui]:n.CLAMP_TO_EDGE,1002:n.MIRRORED_REPEAT},Me={[yn]:n.NEAREST,1004:n.NEAREST_MIPMAP_NEAREST,1005:n.NEAREST_MIPMAP_LINEAR,[_n]:n.LINEAR,1007:n.LINEAR_MIPMAP_NEAREST,[Ko]:n.LINEAR_MIPMAP_LINEAR},Be={512:n.NEVER,519:n.ALWAYS,513:n.LESS,515:n.LEQUAL,514:n.EQUAL,518:n.GEQUAL,516:n.GREATER,517:n.NOTEQUAL};function Se(D,w,z){if(z?(n.texParameteri(D,n.TEXTURE_WRAP_S,ae[w.wrapS]),n.texParameteri(D,n.TEXTURE_WRAP_T,ae[w.wrapT]),(D===n.TEXTURE_3D||D===n.TEXTURE_2D_ARRAY)&&n.texParameteri(D,n.TEXTURE_WRAP_R,ae[w.wrapR]),n.texParameteri(D,n.TEXTURE_MAG_FILTER,Me[w.magFilter]),n.texParameteri(D,n.TEXTURE_MIN_FILTER,Me[w.minFilter])):(n.texParameteri(D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),(D===n.TEXTURE_3D||D===n.TEXTURE_2D_ARRAY)&&n.texParameteri(D,n.TEXTURE_WRAP_R,n.CLAMP_TO_EDGE),(w.wrapS!==ui||w.wrapT!==ui)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(D,n.TEXTURE_MAG_FILTER,C(w.magFilter)),n.texParameteri(D,n.TEXTURE_MIN_FILTER,C(w.minFilter)),w.minFilter!==yn&&w.minFilter!==_n&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),w.compareFunction&&(n.texParameteri(D,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(D,n.TEXTURE_COMPARE_FUNC,Be[w.compareFunction])),!0===e.has("EXT_texture_filter_anisotropic")){const le=e.get("EXT_texture_filter_anisotropic");if(w.magFilter===yn||1005!==w.minFilter&&w.minFilter!==Ko||w.type===bs&&!1===e.has("OES_texture_float_linear")||!1===a&&w.type===hd&&!1===e.has("OES_texture_half_float_linear"))return;(w.anisotropy>1||i.get(w).__currentAnisotropy)&&(n.texParameterf(D,le.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(w.anisotropy,r.getMaxAnisotropy())),i.get(w).__currentAnisotropy=w.anisotropy)}}function Ie(D,w){let z=!1;void 0===D.__webglInit&&(D.__webglInit=!0,w.addEventListener("dispose",U));const le=w.source;let oe=g.get(le);void 0===oe&&(oe={},g.set(le,oe));const ue=function V(D){const w=[];return w.push(D.wrapS),w.push(D.wrapT),w.push(D.wrapR||0),w.push(D.magFilter),w.push(D.minFilter),w.push(D.anisotropy),w.push(D.internalFormat),w.push(D.format),w.push(D.type),w.push(D.generateMipmaps),w.push(D.premultiplyAlpha),w.push(D.flipY),w.push(D.unpackAlignment),w.push(D.colorSpace),w.join()}(w);if(ue!==D.__cacheKey){void 0===oe[ue]&&(oe[ue]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,z=!0),oe[ue].usedTimes++;const Oe=oe[D.__cacheKey];void 0!==Oe&&(oe[D.__cacheKey].usedTimes--,0===Oe.usedTimes&&L(w)),D.__cacheKey=ue,D.__webglTexture=oe[ue].texture}return z}function Xe(D,w,z){let le=n.TEXTURE_2D;(w.isDataArrayTexture||w.isCompressedArrayTexture)&&(le=n.TEXTURE_2D_ARRAY),w.isData3DTexture&&(le=n.TEXTURE_3D);const oe=Ie(D,w),ue=w.source;t.bindTexture(le,D.__webglTexture,n.TEXTURE0+z);const Oe=i.get(ue);if(ue.version!==Oe.__version||!0===oe){t.activeTexture(n.TEXTURE0+z);const he=Pt.getPrimaries(Pt.workingColorSpace),Ee=""===w.colorSpace?null:Pt.getPrimaries(w.colorSpace),N=""===w.colorSpace||he===Ee?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,w.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,w.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,w.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,N);const fe=function S(D){return!a&&(D.wrapS!==ui||D.wrapT!==ui||D.minFilter!==yn&&D.minFilter!==_n)}(w)&&!1===E(w.image);let ie=_(w.image,fe,!1,u);ie=Yt(w,ie);const Ye=E(ie)||a,Ue=s.convert(w.format,w.colorSpace);let I,He=s.convert(w.type),Fe=R(w.internalFormat,Ue,He,w.colorSpace,w.isVideoTexture);Se(le,w,Ye);const ge=w.mipmaps,pe=a&&!0!==w.isVideoTexture,ve=void 0===Oe.__version||!0===oe,ye=b(w,ie,Ye);if(w.isDepthTexture)Fe=n.DEPTH_COMPONENT,a?Fe=w.type===bs?n.DEPTH_COMPONENT32F:w.type===uo?n.DEPTH_COMPONENT24:w.type===Jo?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT16:w.type===bs&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),w.format===Qo&&Fe===n.DEPTH_COMPONENT&&1012!==w.type&&w.type!==uo&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),w.type=uo,He=s.convert(w.type)),w.format===Ul&&Fe===n.DEPTH_COMPONENT&&(Fe=n.DEPTH_STENCIL,w.type!==Jo&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),w.type=Jo,He=s.convert(w.type))),ve&&(pe?t.texStorage2D(n.TEXTURE_2D,1,Fe,ie.width,ie.height):t.texImage2D(n.TEXTURE_2D,0,Fe,ie.width,ie.height,0,Ue,He,null));else if(w.isDataTexture)if(ge.length>0&&Ye){pe&&ve&&t.texStorage2D(n.TEXTURE_2D,ye,Fe,ge[0].width,ge[0].height);for(let se=0,Le=ge.length;se<Le;se++)I=ge[se],pe?t.texSubImage2D(n.TEXTURE_2D,se,0,0,I.width,I.height,Ue,He,I.data):t.texImage2D(n.TEXTURE_2D,se,Fe,I.width,I.height,0,Ue,He,I.data);w.generateMipmaps=!1}else pe?(ve&&t.texStorage2D(n.TEXTURE_2D,ye,Fe,ie.width,ie.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,ie.width,ie.height,Ue,He,ie.data)):t.texImage2D(n.TEXTURE_2D,0,Fe,ie.width,ie.height,0,Ue,He,ie.data);else if(w.isCompressedTexture)if(w.isCompressedArrayTexture){pe&&ve&&t.texStorage3D(n.TEXTURE_2D_ARRAY,ye,Fe,ge[0].width,ge[0].height,ie.depth);for(let se=0,Le=ge.length;se<Le;se++)I=ge[se],w.format!==ur?null!==Ue?pe?t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,se,0,0,0,I.width,I.height,ie.depth,Ue,I.data,0,0):t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,se,Fe,I.width,I.height,ie.depth,0,I.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):pe?t.texSubImage3D(n.TEXTURE_2D_ARRAY,se,0,0,0,I.width,I.height,ie.depth,Ue,He,I.data):t.texImage3D(n.TEXTURE_2D_ARRAY,se,Fe,I.width,I.height,ie.depth,0,Ue,He,I.data)}else{pe&&ve&&t.texStorage2D(n.TEXTURE_2D,ye,Fe,ge[0].width,ge[0].height);for(let se=0,Le=ge.length;se<Le;se++)I=ge[se],w.format!==ur?null!==Ue?pe?t.compressedTexSubImage2D(n.TEXTURE_2D,se,0,0,I.width,I.height,Ue,I.data):t.compressedTexImage2D(n.TEXTURE_2D,se,Fe,I.width,I.height,0,I.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):pe?t.texSubImage2D(n.TEXTURE_2D,se,0,0,I.width,I.height,Ue,He,I.data):t.texImage2D(n.TEXTURE_2D,se,Fe,I.width,I.height,0,Ue,He,I.data)}else if(w.isDataArrayTexture)pe?(ve&&t.texStorage3D(n.TEXTURE_2D_ARRAY,ye,Fe,ie.width,ie.height,ie.depth),t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,ie.width,ie.height,ie.depth,Ue,He,ie.data)):t.texImage3D(n.TEXTURE_2D_ARRAY,0,Fe,ie.width,ie.height,ie.depth,0,Ue,He,ie.data);else if(w.isData3DTexture)pe?(ve&&t.texStorage3D(n.TEXTURE_3D,ye,Fe,ie.width,ie.height,ie.depth),t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,ie.width,ie.height,ie.depth,Ue,He,ie.data)):t.texImage3D(n.TEXTURE_3D,0,Fe,ie.width,ie.height,ie.depth,0,Ue,He,ie.data);else if(w.isFramebufferTexture){if(ve)if(pe)t.texStorage2D(n.TEXTURE_2D,ye,Fe,ie.width,ie.height);else{let se=ie.width,Le=ie.height;for(let Ke=0;Ke<ye;Ke++)t.texImage2D(n.TEXTURE_2D,Ke,Fe,se,Le,0,Ue,He,null),se>>=1,Le>>=1}}else if(ge.length>0&&Ye){pe&&ve&&t.texStorage2D(n.TEXTURE_2D,ye,Fe,ge[0].width,ge[0].height);for(let se=0,Le=ge.length;se<Le;se++)I=ge[se],pe?t.texSubImage2D(n.TEXTURE_2D,se,0,0,Ue,He,I):t.texImage2D(n.TEXTURE_2D,se,Fe,Ue,He,I);w.generateMipmaps=!1}else pe?(ve&&t.texStorage2D(n.TEXTURE_2D,ye,Fe,ie.width,ie.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,Ue,He,ie)):t.texImage2D(n.TEXTURE_2D,0,Fe,Ue,He,ie);x(w,Ye)&&M(le),Oe.__version=ue.version,w.onUpdate&&w.onUpdate(w)}D.__version=w.version}function Ve(D,w,z,le,oe,ue){const Oe=s.convert(z.format,z.colorSpace),he=s.convert(z.type),Ee=R(z.internalFormat,Oe,he,z.colorSpace);if(!i.get(w).__hasExternalTextures){const fe=Math.max(1,w.width>>ue),ie=Math.max(1,w.height>>ue);oe===n.TEXTURE_3D||oe===n.TEXTURE_2D_ARRAY?t.texImage3D(oe,ue,Ee,fe,ie,w.depth,0,Oe,he,null):t.texImage2D(oe,ue,Ee,fe,ie,0,Oe,he,null)}t.bindFramebuffer(n.FRAMEBUFFER,D),We(w)?h.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,le,oe,i.get(z).__webglTexture,0,De(w)):(oe===n.TEXTURE_2D||oe>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&oe<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,le,oe,i.get(z).__webglTexture,ue),t.bindFramebuffer(n.FRAMEBUFFER,null)}function P(D,w,z){if(n.bindRenderbuffer(n.RENDERBUFFER,D),w.depthBuffer&&!w.stencilBuffer){let le=!0===a?n.DEPTH_COMPONENT24:n.DEPTH_COMPONENT16;if(z||We(w)){const oe=w.depthTexture;oe&&oe.isDepthTexture&&(oe.type===bs?le=n.DEPTH_COMPONENT32F:oe.type===uo&&(le=n.DEPTH_COMPONENT24));const ue=De(w);We(w)?h.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,ue,le,w.width,w.height):n.renderbufferStorageMultisample(n.RENDERBUFFER,ue,le,w.width,w.height)}else n.renderbufferStorage(n.RENDERBUFFER,le,w.width,w.height);n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,D)}else if(w.depthBuffer&&w.stencilBuffer){const le=De(w);z&&!1===We(w)?n.renderbufferStorageMultisample(n.RENDERBUFFER,le,n.DEPTH24_STENCIL8,w.width,w.height):We(w)?h.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,le,n.DEPTH24_STENCIL8,w.width,w.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,w.width,w.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,D)}else{const le=!0===w.isWebGLMultipleRenderTargets?w.texture:[w.texture];for(let oe=0;oe<le.length;oe++){const ue=le[oe],Oe=s.convert(ue.format,ue.colorSpace),he=s.convert(ue.type),Ee=R(ue.internalFormat,Oe,he,ue.colorSpace),N=De(w);z&&!1===We(w)?n.renderbufferStorageMultisample(n.RENDERBUFFER,N,Ee,w.width,w.height):We(w)?h.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,N,Ee,w.width,w.height):n.renderbufferStorage(n.RENDERBUFFER,Ee,w.width,w.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function Q(D){const w=i.get(D),z=!0===D.isWebGLCubeRenderTarget;if(D.depthTexture&&!w.__autoAllocateDepthBuffer){if(z)throw new Error("target.depthTexture not supported in Cube render targets");!function me(D,w){if(w&&w.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,D),!w.depthTexture||!w.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(w.depthTexture).__webglTexture||w.depthTexture.image.width!==w.width||w.depthTexture.image.height!==w.height)&&(w.depthTexture.image.width=w.width,w.depthTexture.image.height=w.height,w.depthTexture.needsUpdate=!0),Z(w.depthTexture,0);const le=i.get(w.depthTexture).__webglTexture,oe=De(w);if(w.depthTexture.format===Qo)We(w)?h.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,le,0,oe):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,le,0);else{if(w.depthTexture.format!==Ul)throw new Error("Unknown depthTexture format");We(w)?h.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,le,0,oe):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,le,0)}}(w.__webglFramebuffer,D)}else if(z){w.__webglDepthbuffer=[];for(let le=0;le<6;le++)t.bindFramebuffer(n.FRAMEBUFFER,w.__webglFramebuffer[le]),w.__webglDepthbuffer[le]=n.createRenderbuffer(),P(w.__webglDepthbuffer[le],D,!1)}else t.bindFramebuffer(n.FRAMEBUFFER,w.__webglFramebuffer),w.__webglDepthbuffer=n.createRenderbuffer(),P(w.__webglDepthbuffer,D,!1);t.bindFramebuffer(n.FRAMEBUFFER,null)}function De(D){return Math.min(d,D.samples)}function We(D){const w=i.get(D);return a&&D.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==w.__useRenderToTexture}function Yt(D,w){const z=D.colorSpace,le=D.format,oe=D.type;return!0===D.isCompressedTexture||!0===D.isVideoTexture||1035===D.format||z!==Ss&&""!==z&&(Pt.getTransfer(z)===zt?!1===a?!0===e.has("EXT_sRGB")&&le===ur?(D.format=1035,D.minFilter=_n,D.generateMipmaps=!1):w=tN.sRGBToLinear(w):(le!==ur||oe!==co)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",z)),w}this.allocateTextureUnit=function W(){const D=F;return D>=l&&console.warn("THREE.WebGLTextures: Trying to use "+D+" texture units while this GPU supports only "+l),F+=1,D},this.resetTextureUnits=function k(){F=0},this.setTexture2D=Z,this.setTexture2DArray=function O(D,w){const z=i.get(D);D.version>0&&z.__version!==D.version?Xe(z,D,w):t.bindTexture(n.TEXTURE_2D_ARRAY,z.__webglTexture,n.TEXTURE0+w)},this.setTexture3D=function $(D,w){const z=i.get(D);D.version>0&&z.__version!==D.version?Xe(z,D,w):t.bindTexture(n.TEXTURE_3D,z.__webglTexture,n.TEXTURE0+w)},this.setTextureCube=function de(D,w){const z=i.get(D);D.version>0&&z.__version!==D.version?function bt(D,w,z){if(6!==w.image.length)return;const le=Ie(D,w),oe=w.source;t.bindTexture(n.TEXTURE_CUBE_MAP,D.__webglTexture,n.TEXTURE0+z);const ue=i.get(oe);if(oe.version!==ue.__version||!0===le){t.activeTexture(n.TEXTURE0+z);const Oe=Pt.getPrimaries(Pt.workingColorSpace),he=""===w.colorSpace?null:Pt.getPrimaries(w.colorSpace),Ee=""===w.colorSpace||Oe===he?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,w.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,w.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,w.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ee);const N=w.isCompressedTexture||w.image[0].isCompressedTexture,fe=w.image[0]&&w.image[0].isDataTexture,ie=[];for(let se=0;se<6;se++)ie[se]=N||fe?fe?w.image[se].image:w.image[se]:_(w.image[se],!1,!0,c),ie[se]=Yt(w,ie[se]);const Ye=ie[0],Ue=E(Ye)||a,He=s.convert(w.format,w.colorSpace),Fe=s.convert(w.type),I=R(w.internalFormat,He,Fe,w.colorSpace),ge=a&&!0!==w.isVideoTexture,pe=void 0===ue.__version||!0===le;let ye,ve=b(w,Ye,Ue);if(Se(n.TEXTURE_CUBE_MAP,w,Ue),N){ge&&pe&&t.texStorage2D(n.TEXTURE_CUBE_MAP,ve,I,Ye.width,Ye.height);for(let se=0;se<6;se++){ye=ie[se].mipmaps;for(let Le=0;Le<ye.length;Le++){const Ke=ye[Le];w.format!==ur?null!==He?ge?t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+se,Le,0,0,Ke.width,Ke.height,He,Ke.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+se,Le,I,Ke.width,Ke.height,0,Ke.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):ge?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+se,Le,0,0,Ke.width,Ke.height,He,Fe,Ke.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+se,Le,I,Ke.width,Ke.height,0,He,Fe,Ke.data)}}}else{ye=w.mipmaps,ge&&pe&&(ye.length>0&&ve++,t.texStorage2D(n.TEXTURE_CUBE_MAP,ve,I,ie[0].width,ie[0].height));for(let se=0;se<6;se++)if(fe){ge?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+se,0,0,0,ie[se].width,ie[se].height,He,Fe,ie[se].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+se,0,I,ie[se].width,ie[se].height,0,He,Fe,ie[se].data);for(let Le=0;Le<ye.length;Le++){const En=ye[Le].image[se].image;ge?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+se,Le+1,0,0,En.width,En.height,He,Fe,En.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+se,Le+1,I,En.width,En.height,0,He,Fe,En.data)}}else{ge?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+se,0,0,0,He,Fe,ie[se]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+se,0,I,He,Fe,ie[se]);for(let Le=0;Le<ye.length;Le++){const Ke=ye[Le];ge?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+se,Le+1,0,0,He,Fe,Ke.image[se]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+se,Le+1,I,He,Fe,Ke.image[se])}}}x(w,Ue)&&M(n.TEXTURE_CUBE_MAP),ue.__version=oe.version,w.onUpdate&&w.onUpdate(w)}D.__version=w.version}(z,D,w):t.bindTexture(n.TEXTURE_CUBE_MAP,z.__webglTexture,n.TEXTURE0+w)},this.rebindTextures=function ce(D,w,z){const le=i.get(D);void 0!==w&&Ve(le.__webglFramebuffer,D,D.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),void 0!==z&&Q(D)},this.setupRenderTarget=function re(D){const w=D.texture,z=i.get(D),le=i.get(w);D.addEventListener("dispose",Y),!0!==D.isWebGLMultipleRenderTargets&&(void 0===le.__webglTexture&&(le.__webglTexture=n.createTexture()),le.__version=w.version,o.memory.textures++);const oe=!0===D.isWebGLCubeRenderTarget,ue=!0===D.isWebGLMultipleRenderTargets,Oe=E(D)||a;if(oe){z.__webglFramebuffer=[];for(let he=0;he<6;he++)if(a&&w.mipmaps&&w.mipmaps.length>0){z.__webglFramebuffer[he]=[];for(let Ee=0;Ee<w.mipmaps.length;Ee++)z.__webglFramebuffer[he][Ee]=n.createFramebuffer()}else z.__webglFramebuffer[he]=n.createFramebuffer()}else{if(a&&w.mipmaps&&w.mipmaps.length>0){z.__webglFramebuffer=[];for(let he=0;he<w.mipmaps.length;he++)z.__webglFramebuffer[he]=n.createFramebuffer()}else z.__webglFramebuffer=n.createFramebuffer();if(ue)if(r.drawBuffers){const he=D.texture;for(let Ee=0,N=he.length;Ee<N;Ee++){const fe=i.get(he[Ee]);void 0===fe.__webglTexture&&(fe.__webglTexture=n.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&D.samples>0&&!1===We(D)){const he=ue?w:[w];z.__webglMultisampledFramebuffer=n.createFramebuffer(),z.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,z.__webglMultisampledFramebuffer);for(let Ee=0;Ee<he.length;Ee++){const N=he[Ee];z.__webglColorRenderbuffer[Ee]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,z.__webglColorRenderbuffer[Ee]);const fe=s.convert(N.format,N.colorSpace),ie=s.convert(N.type),Ye=R(N.internalFormat,fe,ie,N.colorSpace,!0===D.isXRRenderTarget),Ue=De(D);n.renderbufferStorageMultisample(n.RENDERBUFFER,Ue,Ye,D.width,D.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ee,n.RENDERBUFFER,z.__webglColorRenderbuffer[Ee])}n.bindRenderbuffer(n.RENDERBUFFER,null),D.depthBuffer&&(z.__webglDepthRenderbuffer=n.createRenderbuffer(),P(z.__webglDepthRenderbuffer,D,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(oe){t.bindTexture(n.TEXTURE_CUBE_MAP,le.__webglTexture),Se(n.TEXTURE_CUBE_MAP,w,Oe);for(let he=0;he<6;he++)if(a&&w.mipmaps&&w.mipmaps.length>0)for(let Ee=0;Ee<w.mipmaps.length;Ee++)Ve(z.__webglFramebuffer[he][Ee],D,w,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+he,Ee);else Ve(z.__webglFramebuffer[he],D,w,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+he,0);x(w,Oe)&&M(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(ue){const he=D.texture;for(let Ee=0,N=he.length;Ee<N;Ee++){const fe=he[Ee],ie=i.get(fe);t.bindTexture(n.TEXTURE_2D,ie.__webglTexture),Se(n.TEXTURE_2D,fe,Oe),Ve(z.__webglFramebuffer,D,fe,n.COLOR_ATTACHMENT0+Ee,n.TEXTURE_2D,0),x(fe,Oe)&&M(n.TEXTURE_2D)}t.unbindTexture()}else{let he=n.TEXTURE_2D;if((D.isWebGL3DRenderTarget||D.isWebGLArrayRenderTarget)&&(a?he=D.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(he,le.__webglTexture),Se(he,w,Oe),a&&w.mipmaps&&w.mipmaps.length>0)for(let Ee=0;Ee<w.mipmaps.length;Ee++)Ve(z.__webglFramebuffer[Ee],D,w,n.COLOR_ATTACHMENT0,he,Ee);else Ve(z.__webglFramebuffer,D,w,n.COLOR_ATTACHMENT0,he,0);x(w,Oe)&&M(he),t.unbindTexture()}D.depthBuffer&&Q(D)},this.updateRenderTargetMipmap=function ke(D){const w=E(D)||a,z=!0===D.isWebGLMultipleRenderTargets?D.texture:[D.texture];for(let le=0,oe=z.length;le<oe;le++){const ue=z[le];if(x(ue,w)){const Oe=D.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D,he=i.get(ue).__webglTexture;t.bindTexture(Oe,he),M(Oe),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function Te(D){if(a&&D.samples>0&&!1===We(D)){const w=D.isWebGLMultipleRenderTargets?D.texture:[D.texture],z=D.width,le=D.height;let oe=n.COLOR_BUFFER_BIT;const ue=[],Oe=D.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,he=i.get(D),Ee=!0===D.isWebGLMultipleRenderTargets;if(Ee)for(let N=0;N<w.length;N++)t.bindFramebuffer(n.FRAMEBUFFER,he.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+N,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,he.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+N,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,he.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,he.__webglFramebuffer);for(let N=0;N<w.length;N++){ue.push(n.COLOR_ATTACHMENT0+N),D.depthBuffer&&ue.push(Oe);const fe=void 0!==he.__ignoreDepthValues&&he.__ignoreDepthValues;if(!1===fe&&(D.depthBuffer&&(oe|=n.DEPTH_BUFFER_BIT),D.stencilBuffer&&(oe|=n.STENCIL_BUFFER_BIT)),Ee&&n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,he.__webglColorRenderbuffer[N]),!0===fe&&(n.invalidateFramebuffer(n.READ_FRAMEBUFFER,[Oe]),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[Oe])),Ee){const ie=i.get(w[N]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,ie,0)}n.blitFramebuffer(0,0,z,le,0,0,z,le,oe,n.NEAREST),f&&n.invalidateFramebuffer(n.READ_FRAMEBUFFER,ue)}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),Ee)for(let N=0;N<w.length;N++){t.bindFramebuffer(n.FRAMEBUFFER,he.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+N,n.RENDERBUFFER,he.__webglColorRenderbuffer[N]);const fe=i.get(w[N]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,he.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+N,n.TEXTURE_2D,fe,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,he.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=Q,this.setupFrameBufferTexture=Ve,this.useMultisampledRTT=We}function gJ(n,e,t){const i=t.isWebGL2;return{convert:function r(s,o=""){let a;const l=Pt.getTransfer(o);if(s===co)return n.UNSIGNED_BYTE;if(1017===s)return n.UNSIGNED_SHORT_4_4_4_4;if(1018===s)return n.UNSIGNED_SHORT_5_5_5_1;if(1010===s)return n.BYTE;if(1011===s)return n.SHORT;if(1012===s)return n.UNSIGNED_SHORT;if(1013===s)return n.INT;if(s===uo)return n.UNSIGNED_INT;if(s===bs)return n.FLOAT;if(s===hd)return i?n.HALF_FLOAT:(a=e.get("OES_texture_half_float"),null!==a?a.HALF_FLOAT_OES:null);if(1021===s)return n.ALPHA;if(s===ur)return n.RGBA;if(1024===s)return n.LUMINANCE;if(1025===s)return n.LUMINANCE_ALPHA;if(s===Qo)return n.DEPTH_COMPONENT;if(s===Ul)return n.DEPTH_STENCIL;if(1035===s)return a=e.get("EXT_sRGB"),null!==a?a.SRGB_ALPHA_EXT:null;if(1028===s)return n.RED;if(1029===s)return n.RED_INTEGER;if(1030===s)return n.RG;if(1031===s)return n.RG_INTEGER;if(1033===s)return n.RGBA_INTEGER;if(33776===s||33777===s||33778===s||33779===s)if(l===zt){if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===a)return null;if(33776===s)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(a=e.get("WEBGL_compressed_texture_s3tc"),null===a)return null;if(33776===s)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===s)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===s)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===s)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===s||35841===s||35842===s||35843===s){if(a=e.get("WEBGL_compressed_texture_pvrtc"),null===a)return null;if(35840===s)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===s)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===s)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===s)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===s)return a=e.get("WEBGL_compressed_texture_etc1"),null!==a?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===s||37496===s){if(a=e.get("WEBGL_compressed_texture_etc"),null===a)return null;if(37492===s)return l===zt?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(37496===s)return l===zt?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}if(37808===s||37809===s||37810===s||37811===s||37812===s||37813===s||37814===s||37815===s||37816===s||37817===s||37818===s||37819===s||37820===s||37821===s){if(a=e.get("WEBGL_compressed_texture_astc"),null===a)return null;if(37808===s)return l===zt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===s)return l===zt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===s)return l===zt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===s)return l===zt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===s)return l===zt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===s)return l===zt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===s)return l===zt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===s)return l===zt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===s)return l===zt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===s)return l===zt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===s)return l===zt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===s)return l===zt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===s)return l===zt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===s)return l===zt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===s||36494===s||36495===s){if(a=e.get("EXT_texture_compression_bptc"),null===a)return null;if(36492===s)return l===zt?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(36494===s)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(36495===s)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(36283===s||36284===s||36285===s||36286===s){if(a=e.get("EXT_texture_compression_rgtc"),null===a)return null;if(36492===s)return a.COMPRESSED_RED_RGTC1_EXT;if(36284===s)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===s)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===s)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return s===Jo?i?n.UNSIGNED_INT_24_8:(a=e.get("WEBGL_depth_texture"),null!==a?a.UNSIGNED_INT_24_8_WEBGL:null):void 0!==n[s]?n[s]:null}}}class yJ extends Gn{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class wd extends qi{constructor(){super(),this.isGroup=!0,this.type="Group"}}const _J={type:"move"};class rb{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new wd,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new wd,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new T,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new T),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new wd,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new T,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new T),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,i){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,c=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(c&&e.hand){o=!0;for(const y of e.hand.values()){const g=t.getJointPose(y,i),m=this._getHandJoint(c,y);null!==g&&(m.matrix.fromArray(g.transform.matrix),m.matrix.decompose(m.position,m.rotation,m.scale),m.matrixWorldNeedsUpdate=!0,m.jointRadius=g.radius),m.visible=null!==g}const h=c.joints["index-finger-tip"].position.distanceTo(c.joints["thumb-tip"].position),f=.02,p=.005;c.inputState.pinching&&h>f+p?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&h<=f-p&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==l&&e.gripSpace&&(s=t.getPose(e.gripSpace,i),null!==s&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));null!==a&&(r=t.getPose(e.targetRaySpace,i),null===r&&null!==s&&(r=s),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(_J)))}return null!==a&&(a.visible=null!==r),null!==l&&(l.visible=null!==s),null!==c&&(c.visible=null!==o),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const i=new wd;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}class vJ extends ho{constructor(e,t,i,r,s,o,a,l,c,u){if((u=void 0!==u?u:Qo)!==Qo&&u!==Ul)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&u===Qo&&(i=uo),void 0===i&&u===Ul&&(i=Jo),super(null,r,s,o,a,l,u,i,c),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==a?a:yn,this.minFilter=void 0!==l?l:yn,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}class EJ extends na{constructor(e,t){super();const i=this;let r=null,s=1,o=null,a="local-floor",l=1,c=null,u=null,d=null,h=null,f=null,p=null;const y=t.getContextAttributes();let g=null,m=null;const v=[],_=[],E=new Gn;E.layers.enable(1),E.viewport=new Nt;const S=new Gn;S.layers.enable(2),S.viewport=new Nt;const x=[E,S],M=new yJ;M.layers.enable(1),M.layers.enable(2);let R=null,b=null;function C(O){const $=_.indexOf(O.inputSource);if(-1===$)return;const de=v[$];void 0!==de&&(de.update(O.inputSource,O.frame,c||o),de.dispatchEvent({type:O.type,data:O.inputSource}))}function U(){r.removeEventListener("select",C),r.removeEventListener("selectstart",C),r.removeEventListener("selectend",C),r.removeEventListener("squeeze",C),r.removeEventListener("squeezestart",C),r.removeEventListener("squeezeend",C),r.removeEventListener("end",U),r.removeEventListener("inputsourceschange",Y);for(let O=0;O<v.length;O++){const $=_[O];null!==$&&(_[O]=null,v[O].disconnect($))}R=null,b=null,e.setRenderTarget(g),f=null,h=null,d=null,r=null,m=null,Z.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}function Y(O){for(let $=0;$<O.removed.length;$++){const de=O.removed[$],ae=_.indexOf(de);ae>=0&&(_[ae]=null,v[ae].disconnect(de))}for(let $=0;$<O.added.length;$++){const de=O.added[$];let ae=_.indexOf(de);if(-1===ae){for(let Be=0;Be<v.length;Be++){if(Be>=_.length){_.push(de),ae=Be;break}if(null===_[Be]){_[Be]=de,ae=Be;break}}if(-1===ae)break}const Me=v[ae];Me&&Me.connect(de)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(O){let $=v[O];return void 0===$&&($=new rb,v[O]=$),$.getTargetRaySpace()},this.getControllerGrip=function(O){let $=v[O];return void 0===$&&($=new rb,v[O]=$),$.getGripSpace()},this.getHand=function(O){let $=v[O];return void 0===$&&($=new rb,v[O]=$),$.getHandSpace()},this.setFramebufferScaleFactor=function(O){s=O,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(O){a=O,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||o},this.setReferenceSpace=function(O){c=O},this.getBaseLayer=function(){return null!==h?h:f},this.getBinding=function(){return d},this.getFrame=function(){return p},this.getSession=function(){return r},this.setSession=function(){var O=Xt(function*($){if(r=$,null!==r){if(g=e.getRenderTarget(),r.addEventListener("select",C),r.addEventListener("selectstart",C),r.addEventListener("selectend",C),r.addEventListener("squeeze",C),r.addEventListener("squeezestart",C),r.addEventListener("squeezeend",C),r.addEventListener("end",U),r.addEventListener("inputsourceschange",Y),!0!==y.xrCompatible&&(yield t.makeXRCompatible()),void 0===r.renderState.layers||!1===e.capabilities.isWebGL2)f=new XRWebGLLayer(r,t,{antialias:void 0!==r.renderState.layers||y.antialias,alpha:!0,depth:y.depth,stencil:y.stencil,framebufferScaleFactor:s}),r.updateRenderState({baseLayer:f}),m=new ra(f.framebufferWidth,f.framebufferHeight,{format:ur,type:co,colorSpace:e.outputColorSpace,stencilBuffer:y.stencil});else{let de=null,ae=null,Me=null;y.depth&&(Me=y.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,de=y.stencil?Ul:Qo,ae=y.stencil?Jo:uo);const Be={colorFormat:t.RGBA8,depthFormat:Me,scaleFactor:s};d=new XRWebGLBinding(r,t),h=d.createProjectionLayer(Be),r.updateRenderState({layers:[h]}),m=new ra(h.textureWidth,h.textureHeight,{format:ur,type:co,depthTexture:new vJ(h.textureWidth,h.textureHeight,ae,void 0,void 0,void 0,void 0,void 0,void 0,de),stencilBuffer:y.stencil,colorSpace:e.outputColorSpace,samples:y.antialias?4:0}),e.properties.get(m).__ignoreDepthValues=h.ignoreDepthValues}m.isXRRenderTarget=!0,this.setFoveation(l),c=null,o=yield r.requestReferenceSpace(a),Z.setContext(r),Z.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}});return function($){return O.apply(this,arguments)}}(),this.getEnvironmentBlendMode=function(){if(null!==r)return r.environmentBlendMode};const ee=new T,L=new T;function F(O,$){null===$?O.matrixWorld.copy(O.matrix):O.matrixWorld.multiplyMatrices($.matrixWorld,O.matrix),O.matrixWorldInverse.copy(O.matrixWorld).invert()}this.updateCamera=function(O){if(null===r)return;M.near=S.near=E.near=O.near,M.far=S.far=E.far=O.far,(R!==M.near||b!==M.far)&&(r.updateRenderState({depthNear:M.near,depthFar:M.far}),R=M.near,b=M.far);const $=O.parent,de=M.cameras;F(M,$);for(let ae=0;ae<de.length;ae++)F(de[ae],$);2===de.length?function G(O,$,de){ee.setFromMatrixPosition($.matrixWorld),L.setFromMatrixPosition(de.matrixWorld);const ae=ee.distanceTo(L),Me=$.projectionMatrix.elements,Be=de.projectionMatrix.elements,Se=Me[14]/(Me[10]-1),Ie=Me[14]/(Me[10]+1),Xe=(Me[9]+1)/Me[5],bt=(Me[9]-1)/Me[5],Ve=(Me[8]-1)/Me[0],P=(Be[8]+1)/Be[0],me=Se*Ve,Q=Se*P,ce=ae/(-Ve+P),re=ce*-Ve;$.matrixWorld.decompose(O.position,O.quaternion,O.scale),O.translateX(re),O.translateZ(ce),O.matrixWorld.compose(O.position,O.quaternion,O.scale),O.matrixWorldInverse.copy(O.matrixWorld).invert();const ke=Se+ce,Te=Ie+ce;O.projectionMatrix.makePerspective(me-re,Q+(ae-re),Xe*Ie/Te*ke,bt*Ie/Te*ke,ke,Te),O.projectionMatrixInverse.copy(O.projectionMatrix).invert()}(M,E,S):M.projectionMatrix.copy(E.projectionMatrix),function k(O,$,de){null===de?O.matrix.copy($.matrixWorld):(O.matrix.copy(de.matrixWorld),O.matrix.invert(),O.matrix.multiply($.matrixWorld)),O.matrix.decompose(O.position,O.quaternion,O.scale),O.updateMatrixWorld(!0),O.projectionMatrix.copy($.projectionMatrix),O.projectionMatrixInverse.copy($.projectionMatrixInverse),O.isPerspectiveCamera&&(O.fov=2*Hl*Math.atan(1/O.projectionMatrix.elements[5]),O.zoom=1)}(O,M,$)},this.getCamera=function(){return M},this.getFoveation=function(){if(null!==h||null!==f)return l},this.setFoveation=function(O){l=O,null!==h&&(h.fixedFoveation=O),null!==f&&void 0!==f.fixedFoveation&&(f.fixedFoveation=O)};let W=null;const Z=new EN;Z.setAnimationLoop(function V(O,$){if(u=$.getViewerPose(c||o),p=$,null!==u){const de=u.views;null!==f&&(e.setRenderTargetFramebuffer(m,f.framebuffer),e.setRenderTarget(m));let ae=!1;de.length!==M.cameras.length&&(M.cameras.length=0,ae=!0);for(let Me=0;Me<de.length;Me++){const Be=de[Me];let Se=null;if(null!==f)Se=f.getViewport(Be);else{const Xe=d.getViewSubImage(h,Be);Se=Xe.viewport,0===Me&&(e.setRenderTargetTextures(m,Xe.colorTexture,h.ignoreDepthValues?void 0:Xe.depthStencilTexture),e.setRenderTarget(m))}let Ie=x[Me];void 0===Ie&&(Ie=new Gn,Ie.layers.enable(Me),Ie.viewport=new Nt,x[Me]=Ie),Ie.matrix.fromArray(Be.transform.matrix),Ie.matrix.decompose(Ie.position,Ie.quaternion,Ie.scale),Ie.projectionMatrix.fromArray(Be.projectionMatrix),Ie.projectionMatrixInverse.copy(Ie.projectionMatrix).invert(),Ie.viewport.set(Se.x,Se.y,Se.width,Se.height),0===Me&&(M.matrix.copy(Ie.matrix),M.matrix.decompose(M.position,M.quaternion,M.scale)),!0===ae&&M.cameras.push(Ie)}}for(let de=0;de<v.length;de++){const ae=_[de],Me=v[de];null!==ae&&void 0!==Me&&Me.update(ae,$,c||o)}W&&W(O,$),$.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:$}),p=null}),this.setAnimationLoop=function(O){W=O},this.dispose=function(){}}}function bJ(n,e){function t(g,m){!0===g.matrixAutoUpdate&&g.updateMatrix(),m.value.copy(g.matrix)}function s(g,m){g.opacity.value=m.opacity,m.color&&g.diffuse.value.copy(m.color),m.emissive&&g.emissive.value.copy(m.emissive).multiplyScalar(m.emissiveIntensity),m.map&&(g.map.value=m.map,t(m.map,g.mapTransform)),m.alphaMap&&(g.alphaMap.value=m.alphaMap,t(m.alphaMap,g.alphaMapTransform)),m.bumpMap&&(g.bumpMap.value=m.bumpMap,t(m.bumpMap,g.bumpMapTransform),g.bumpScale.value=m.bumpScale,1===m.side&&(g.bumpScale.value*=-1)),m.normalMap&&(g.normalMap.value=m.normalMap,t(m.normalMap,g.normalMapTransform),g.normalScale.value.copy(m.normalScale),1===m.side&&g.normalScale.value.negate()),m.displacementMap&&(g.displacementMap.value=m.displacementMap,t(m.displacementMap,g.displacementMapTransform),g.displacementScale.value=m.displacementScale,g.displacementBias.value=m.displacementBias),m.emissiveMap&&(g.emissiveMap.value=m.emissiveMap,t(m.emissiveMap,g.emissiveMapTransform)),m.specularMap&&(g.specularMap.value=m.specularMap,t(m.specularMap,g.specularMapTransform)),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest);const v=e.get(m).envMap;if(v&&(g.envMap.value=v,g.flipEnvMap.value=v.isCubeTexture&&!1===v.isRenderTargetTexture?-1:1,g.reflectivity.value=m.reflectivity,g.ior.value=m.ior,g.refractionRatio.value=m.refractionRatio),m.lightMap){g.lightMap.value=m.lightMap;const _=!0===n._useLegacyLights?Math.PI:1;g.lightMapIntensity.value=m.lightMapIntensity*_,t(m.lightMap,g.lightMapTransform)}m.aoMap&&(g.aoMap.value=m.aoMap,g.aoMapIntensity.value=m.aoMapIntensity,t(m.aoMap,g.aoMapTransform))}return{refreshFogUniforms:function i(g,m){m.color.getRGB(g.fogColor.value,vN(n)),m.isFog?(g.fogNear.value=m.near,g.fogFar.value=m.far):m.isFogExp2&&(g.fogDensity.value=m.density)},refreshMaterialUniforms:function r(g,m,v,_,E){m.isMeshBasicMaterial||m.isMeshLambertMaterial?s(g,m):m.isMeshToonMaterial?(s(g,m),function d(g,m){m.gradientMap&&(g.gradientMap.value=m.gradientMap)}(g,m)):m.isMeshPhongMaterial?(s(g,m),function u(g,m){g.specular.value.copy(m.specular),g.shininess.value=Math.max(m.shininess,1e-4)}(g,m)):m.isMeshStandardMaterial?(s(g,m),function h(g,m){g.metalness.value=m.metalness,m.metalnessMap&&(g.metalnessMap.value=m.metalnessMap,t(m.metalnessMap,g.metalnessMapTransform)),g.roughness.value=m.roughness,m.roughnessMap&&(g.roughnessMap.value=m.roughnessMap,t(m.roughnessMap,g.roughnessMapTransform)),e.get(m).envMap&&(g.envMapIntensity.value=m.envMapIntensity)}(g,m),m.isMeshPhysicalMaterial&&function f(g,m,v){g.ior.value=m.ior,m.sheen>0&&(g.sheenColor.value.copy(m.sheenColor).multiplyScalar(m.sheen),g.sheenRoughness.value=m.sheenRoughness,m.sheenColorMap&&(g.sheenColorMap.value=m.sheenColorMap,t(m.sheenColorMap,g.sheenColorMapTransform)),m.sheenRoughnessMap&&(g.sheenRoughnessMap.value=m.sheenRoughnessMap,t(m.sheenRoughnessMap,g.sheenRoughnessMapTransform))),m.clearcoat>0&&(g.clearcoat.value=m.clearcoat,g.clearcoatRoughness.value=m.clearcoatRoughness,m.clearcoatMap&&(g.clearcoatMap.value=m.clearcoatMap,t(m.clearcoatMap,g.clearcoatMapTransform)),m.clearcoatRoughnessMap&&(g.clearcoatRoughnessMap.value=m.clearcoatRoughnessMap,t(m.clearcoatRoughnessMap,g.clearcoatRoughnessMapTransform)),m.clearcoatNormalMap&&(g.clearcoatNormalMap.value=m.clearcoatNormalMap,t(m.clearcoatNormalMap,g.clearcoatNormalMapTransform),g.clearcoatNormalScale.value.copy(m.clearcoatNormalScale),1===m.side&&g.clearcoatNormalScale.value.negate())),m.iridescence>0&&(g.iridescence.value=m.iridescence,g.iridescenceIOR.value=m.iridescenceIOR,g.iridescenceThicknessMinimum.value=m.iridescenceThicknessRange[0],g.iridescenceThicknessMaximum.value=m.iridescenceThicknessRange[1],m.iridescenceMap&&(g.iridescenceMap.value=m.iridescenceMap,t(m.iridescenceMap,g.iridescenceMapTransform)),m.iridescenceThicknessMap&&(g.iridescenceThicknessMap.value=m.iridescenceThicknessMap,t(m.iridescenceThicknessMap,g.iridescenceThicknessMapTransform))),m.transmission>0&&(g.transmission.value=m.transmission,g.transmissionSamplerMap.value=v.texture,g.transmissionSamplerSize.value.set(v.width,v.height),m.transmissionMap&&(g.transmissionMap.value=m.transmissionMap,t(m.transmissionMap,g.transmissionMapTransform)),g.thickness.value=m.thickness,m.thicknessMap&&(g.thicknessMap.value=m.thicknessMap,t(m.thicknessMap,g.thicknessMapTransform)),g.attenuationDistance.value=m.attenuationDistance,g.attenuationColor.value.copy(m.attenuationColor)),m.anisotropy>0&&(g.anisotropyVector.value.set(m.anisotropy*Math.cos(m.anisotropyRotation),m.anisotropy*Math.sin(m.anisotropyRotation)),m.anisotropyMap&&(g.anisotropyMap.value=m.anisotropyMap,t(m.anisotropyMap,g.anisotropyMapTransform))),g.specularIntensity.value=m.specularIntensity,g.specularColor.value.copy(m.specularColor),m.specularColorMap&&(g.specularColorMap.value=m.specularColorMap,t(m.specularColorMap,g.specularColorMapTransform)),m.specularIntensityMap&&(g.specularIntensityMap.value=m.specularIntensityMap,t(m.specularIntensityMap,g.specularIntensityMapTransform))}(g,m,E)):m.isMeshMatcapMaterial?(s(g,m),function p(g,m){m.matcap&&(g.matcap.value=m.matcap)}(g,m)):m.isMeshDepthMaterial?s(g,m):m.isMeshDistanceMaterial?(s(g,m),function y(g,m){const v=e.get(m).light;g.referencePosition.value.setFromMatrixPosition(v.matrixWorld),g.nearDistance.value=v.shadow.camera.near,g.farDistance.value=v.shadow.camera.far}(g,m)):m.isMeshNormalMaterial?s(g,m):m.isLineBasicMaterial?(function o(g,m){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,m.map&&(g.map.value=m.map,t(m.map,g.mapTransform))}(g,m),m.isLineDashedMaterial&&function a(g,m){g.dashSize.value=m.dashSize,g.totalSize.value=m.dashSize+m.gapSize,g.scale.value=m.scale}(g,m)):m.isPointsMaterial?function l(g,m,v,_){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,g.size.value=m.size*v,g.scale.value=.5*_,m.map&&(g.map.value=m.map,t(m.map,g.uvTransform)),m.alphaMap&&(g.alphaMap.value=m.alphaMap,t(m.alphaMap,g.alphaMapTransform)),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest)}(g,m,v,_):m.isSpriteMaterial?function c(g,m){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,g.rotation.value=m.rotation,m.map&&(g.map.value=m.map,t(m.map,g.mapTransform)),m.alphaMap&&(g.alphaMap.value=m.alphaMap,t(m.alphaMap,g.alphaMapTransform)),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest)}(g,m):m.isShadowMaterial?(g.color.value.copy(m.color),g.opacity.value=m.opacity):m.isShaderMaterial&&(m.uniformsNeedUpdate=!1)}}}function SJ(n,e,t,i){let r={},s={},o=[];const a=t.isWebGL2?n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS):0;function f(v,_,E){const S=v.value;if(void 0===E[_]){if("number"==typeof S)E[_]=S;else{const x=Array.isArray(S)?S:[S],M=[];for(let R=0;R<x.length;R++)M.push(x[R].clone());E[_]=M}return!0}if("number"==typeof S){if(E[_]!==S)return E[_]=S,!0}else{const x=Array.isArray(E[_])?E[_]:[E[_]],M=Array.isArray(S)?S:[S];for(let R=0;R<x.length;R++){const b=x[R];if(!1===b.equals(M[R]))return b.copy(M[R]),!0}}return!1}function y(v){const _={boundary:0,storage:0};return"number"==typeof v?(_.boundary=4,_.storage=4):v.isVector2?(_.boundary=8,_.storage=8):v.isVector3||v.isColor?(_.boundary=16,_.storage=12):v.isVector4?(_.boundary=16,_.storage=16):v.isMatrix3?(_.boundary=48,_.storage=48):v.isMatrix4?(_.boundary=64,_.storage=64):v.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",v),_}function g(v){const _=v.target;_.removeEventListener("dispose",g);const E=o.indexOf(_.__bindingPointIndex);o.splice(E,1),n.deleteBuffer(r[_.id]),delete r[_.id],delete s[_.id]}return{bind:function l(v,_){i.uniformBlockBinding(v,_.program)},update:function c(v,_){let E=r[v.id];void 0===E&&(function p(v){const _=v.uniforms;let E=0;let x=0;for(let M=0,R=_.length;M<R;M++){const b=_[M],C={boundary:0,storage:0},U=Array.isArray(b.value)?b.value:[b.value];for(let Y=0,ee=U.length;Y<ee;Y++){const G=y(U[Y]);C.boundary+=G.boundary,C.storage+=G.storage}b.__data=new Float32Array(C.storage/Float32Array.BYTES_PER_ELEMENT),b.__offset=E,M>0&&(x=E%16,0!==x&&16-x-C.boundary<0&&(E+=16-x,b.__offset=E)),E+=C.storage}x=E%16,x>0&&(E+=16-x),v.__size=E,v.__cache={}}(v),E=function u(v){const _=function d(){for(let v=0;v<a;v++)if(-1===o.indexOf(v))return o.push(v),v;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();v.__bindingPointIndex=_;const E=n.createBuffer(),S=v.__size,x=v.usage;return n.bindBuffer(n.UNIFORM_BUFFER,E),n.bufferData(n.UNIFORM_BUFFER,S,x),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,_,E),E}(v),r[v.id]=E,v.addEventListener("dispose",g)),i.updateUBOMapping(v,_.program);const x=e.render.frame;s[v.id]!==x&&(function h(v){const E=v.uniforms,S=v.__cache;n.bindBuffer(n.UNIFORM_BUFFER,r[v.id]);for(let x=0,M=E.length;x<M;x++){const R=E[x];if(!0===f(R,x,S)){const b=R.__offset,C=Array.isArray(R.value)?R.value:[R.value];let U=0;for(let Y=0;Y<C.length;Y++){const ee=C[Y],L=y(ee);"number"==typeof ee?(R.__data[0]=ee,n.bufferSubData(n.UNIFORM_BUFFER,b+U,R.__data)):ee.isMatrix3?(R.__data[0]=ee.elements[0],R.__data[1]=ee.elements[1],R.__data[2]=ee.elements[2],R.__data[3]=ee.elements[0],R.__data[4]=ee.elements[3],R.__data[5]=ee.elements[4],R.__data[6]=ee.elements[5],R.__data[7]=ee.elements[0],R.__data[8]=ee.elements[6],R.__data[9]=ee.elements[7],R.__data[10]=ee.elements[8],R.__data[11]=ee.elements[0]):(ee.toArray(R.__data,U),U+=L.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,b,R.__data)}}n.bindBuffer(n.UNIFORM_BUFFER,null)}(v),s[v.id]=x)},dispose:function m(){for(const v in r)n.deleteBuffer(r[v]);o=[],r={},s={}}}}class YN{constructor(e={}){const{canvas:t=nX(),context:i=null,depth:r=!0,stencil:s=!0,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:c=!1,powerPreference:u="default",failIfMajorPerformanceCaveat:d=!1}=e;let h;this.isWebGLRenderer=!0,h=null!==i?i.getContextAttributes().alpha:o;const f=new Uint32Array(4),p=new Int32Array(4);let y=null,g=null;const m=[],v=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=Pn,this._useLegacyLights=!1,this.toneMapping=ao,this.toneMappingExposure=1;const _=this;let E=!1,S=0,x=0,M=null,R=-1,b=null;const C=new Nt,U=new Nt;let Y=null;const ee=new Ae(0);let L=0,G=t.width,F=t.height,k=1,W=null,V=null;const Z=new Nt(0,0,G,F),O=new Nt(0,0,G,F);let $=!1;const de=new KE;let ae=!1,Me=!1,Be=null;const Se=new ot,Ie=new K,Xe=new T,bt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Ve(){return null===M?k:1}let Q,ce,re,ke,Te,De,We,mt,Yt,D,w,z,le,oe,ue,Oe,he,Ee,N,fe,ie,Ye,Ue,He,P=i;function me(A,B){for(let q=0;q<A.length;q++){const X=t.getContext(A[q],B);if(null!==X)return X}return null}try{const A={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:u,failIfMajorPerformanceCaveat:d};if("setAttribute"in t&&t.setAttribute("data-engine","three.js r157"),t.addEventListener("webglcontextlost",ge,!1),t.addEventListener("webglcontextrestored",pe,!1),t.addEventListener("webglcontextcreationerror",ve,!1),null===P){const B=["webgl2","webgl","experimental-webgl"];if(!0===_.isWebGL1Renderer&&B.shift(),P=me(B,A),null===P)throw me(B)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&P instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),void 0===P.getShaderPrecisionFormat&&(P.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(A){throw console.error("THREE.WebGLRenderer: "+A.message),A}function Fe(){Q=new OZ(P),ce=new DZ(P,Q,e),Q.init(ce),Ye=new gJ(P,Q,ce),re=new pJ(P,Q,ce),ke=new UZ(P),Te=new nJ,De=new mJ(P,Q,re,Te,ce,Ye,ke),We=new RZ(_),mt=new LZ(_),Yt=new AX(P,ce),Ue=new TZ(P,Q,Yt,ce),D=new FZ(P,Yt,ke,Ue),w=new zZ(P,D,Yt,ke),N=new HZ(P,ce,De),Oe=new IZ(Te),z=new tJ(_,We,mt,Q,ce,Ue,Oe),le=new bJ(_,Te),oe=new rJ,ue=new uJ(Q,ce),Ee=new CZ(_,We,mt,re,w,h,l),he=new fJ(_,w,ce),He=new SJ(P,ke,ce,re),fe=new AZ(P,Q,ke,ce),ie=new kZ(P,Q,ke,ce),ke.programs=z.programs,_.capabilities=ce,_.extensions=Q,_.properties=Te,_.renderLists=oe,_.shadowMap=he,_.state=re,_.info=ke}Fe();const I=new EJ(_,P);function ge(A){A.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),E=!0}function pe(){console.log("THREE.WebGLRenderer: Context Restored."),E=!1;const A=ke.autoReset,B=he.enabled,q=he.autoUpdate,H=he.needsUpdate,X=he.type;Fe(),ke.autoReset=A,he.enabled=B,he.autoUpdate=q,he.needsUpdate=H,he.type=X}function ve(A){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",A.statusMessage)}function ye(A){const B=A.target;B.removeEventListener("dispose",ye),function se(A){(function Le(A){const B=Te.get(A).programs;void 0!==B&&(B.forEach(function(q){z.releaseProgram(q)}),A.isShaderMaterial&&z.releaseShaderCache(A))})(A),Te.remove(A)}(B)}this.xr=I,this.getContext=function(){return P},this.getContextAttributes=function(){return P.getContextAttributes()},this.forceContextLoss=function(){const A=Q.get("WEBGL_lose_context");A&&A.loseContext()},this.forceContextRestore=function(){const A=Q.get("WEBGL_lose_context");A&&A.restoreContext()},this.getPixelRatio=function(){return k},this.setPixelRatio=function(A){void 0!==A&&(k=A,this.setSize(G,F,!1))},this.getSize=function(A){return A.set(G,F)},this.setSize=function(A,B,q=!0){I.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(G=A,F=B,t.width=Math.floor(A*k),t.height=Math.floor(B*k),!0===q&&(t.style.width=A+"px",t.style.height=B+"px"),this.setViewport(0,0,A,B))},this.getDrawingBufferSize=function(A){return A.set(G*k,F*k).floor()},this.setDrawingBufferSize=function(A,B,q){G=A,F=B,k=q,t.width=Math.floor(A*q),t.height=Math.floor(B*q),this.setViewport(0,0,A,B)},this.getCurrentViewport=function(A){return A.copy(C)},this.getViewport=function(A){return A.copy(Z)},this.setViewport=function(A,B,q,H){A.isVector4?Z.set(A.x,A.y,A.z,A.w):Z.set(A,B,q,H),re.viewport(C.copy(Z).multiplyScalar(k).floor())},this.getScissor=function(A){return A.copy(O)},this.setScissor=function(A,B,q,H){A.isVector4?O.set(A.x,A.y,A.z,A.w):O.set(A,B,q,H),re.scissor(U.copy(O).multiplyScalar(k).floor())},this.getScissorTest=function(){return $},this.setScissorTest=function(A){re.setScissorTest($=A)},this.setOpaqueSort=function(A){W=A},this.setTransparentSort=function(A){V=A},this.getClearColor=function(A){return A.copy(Ee.getClearColor())},this.setClearColor=function(){Ee.setClearColor.apply(Ee,arguments)},this.getClearAlpha=function(){return Ee.getClearAlpha()},this.setClearAlpha=function(){Ee.setClearAlpha.apply(Ee,arguments)},this.clear=function(A=!0,B=!0,q=!0){let H=0;if(A){let X=!1;if(null!==M){const Re=M.texture.format;X=1033===Re||1031===Re||1029===Re}if(X){const Re=M.texture.type,ze=Re===co||Re===uo||1012===Re||Re===Jo||1017===Re||1018===Re,tt=Ee.getClearColor(),nt=Ee.getClearAlpha(),gt=tt.r,Je=tt.g,ct=tt.b;ze?(f[0]=gt,f[1]=Je,f[2]=ct,f[3]=nt,P.clearBufferuiv(P.COLOR,0,f)):(p[0]=gt,p[1]=Je,p[2]=ct,p[3]=nt,P.clearBufferiv(P.COLOR,0,p))}else H|=P.COLOR_BUFFER_BIT}B&&(H|=P.DEPTH_BUFFER_BIT),q&&(H|=P.STENCIL_BUFFER_BIT),P.clear(H)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",ge,!1),t.removeEventListener("webglcontextrestored",pe,!1),t.removeEventListener("webglcontextcreationerror",ve,!1),oe.dispose(),ue.dispose(),Te.dispose(),We.dispose(),mt.dispose(),w.dispose(),Ue.dispose(),He.dispose(),z.dispose(),I.dispose(),I.removeEventListener("sessionstart",jt),I.removeEventListener("sessionend",Jr),Be&&(Be.dispose(),Be=null),mi.stop()},this.renderBufferDirect=function(A,B,q,H,X,Re){null===B&&(B=bt);const ze=X.isMesh&&X.matrixWorld.determinant()<0,tt=function mne(A,B,q,H,X){!0!==B.isScene&&(B=bt),De.resetTextureUnits();const Re=B.fog,tt=null===M?_.outputColorSpace:!0===M.isXRRenderTarget?M.texture.colorSpace:Ss,nt=(H.isMeshStandardMaterial?mt:We).get(H.envMap||(H.isMeshStandardMaterial?B.environment:null)),gt=!0===H.vertexColors&&!!q.attributes.color&&4===q.attributes.color.itemSize,Je=!!q.attributes.tangent&&(!!H.normalMap||H.anisotropy>0),ct=!!q.morphAttributes.position,an=!!q.morphAttributes.normal,pn=!!q.morphAttributes.color;let fr=ao;H.toneMapped&&(null===M||!0===M.isXRRenderTarget)&&(fr=_.toneMapping);const Ls=q.morphAttributes.position||q.morphAttributes.normal||q.morphAttributes.color,bn=void 0!==Ls?Ls.length:0,yt=Te.get(H),Qb=g.state.lights;!0!==ae||!0!==Me&&A===b||Oe.setState(H,A,A===b&&H.id===R);let Sn=!1;H.version===yt.__version?(yt.needsLights&&yt.lightsStateVersion!==Qb.state.version||yt.outputColorSpace!==tt||X.isInstancedMesh&&!1===yt.instancing||!X.isInstancedMesh&&!0===yt.instancing||X.isSkinnedMesh&&!1===yt.skinning||!X.isSkinnedMesh&&!0===yt.skinning||X.isInstancedMesh&&!0===yt.instancingColor&&null===X.instanceColor||X.isInstancedMesh&&!1===yt.instancingColor&&null!==X.instanceColor||yt.envMap!==nt||!0===H.fog&&yt.fog!==Re||void 0!==yt.numClippingPlanes&&(yt.numClippingPlanes!==Oe.numPlanes||yt.numIntersection!==Oe.numIntersection)||yt.vertexAlphas!==gt||yt.vertexTangents!==Je||yt.morphTargets!==ct||yt.morphNormals!==an||yt.morphColors!==pn||yt.toneMapping!==fr||!0===ce.isWebGL2&&yt.morphTargetsCount!==bn)&&(Sn=!0):(Sn=!0,yt.__version=H.version);let ba=yt.currentProgram;!0===Sn&&(ba=ag(H,B,X));let JO=!1,$d=!1,eS=!1;const gi=ba.getUniforms(),Sa=yt.uniforms;if(re.useProgram(ba.program)&&(JO=!0,$d=!0,eS=!0),H.id!==R&&(R=H.id,$d=!0),JO||b!==A){gi.setValue(P,"projectionMatrix",A.projectionMatrix),gi.setValue(P,"viewMatrix",A.matrixWorldInverse);const Ji=gi.map.cameraPosition;void 0!==Ji&&Ji.setValue(P,Xe.setFromMatrixPosition(A.matrixWorld)),ce.logarithmicDepthBuffer&&gi.setValue(P,"logDepthBufFC",2/(Math.log(A.far+1)/Math.LN2)),(H.isMeshPhongMaterial||H.isMeshToonMaterial||H.isMeshLambertMaterial||H.isMeshBasicMaterial||H.isMeshStandardMaterial||H.isShaderMaterial)&&gi.setValue(P,"isOrthographic",!0===A.isOrthographicCamera),b!==A&&(b=A,$d=!0,eS=!0)}if(X.isSkinnedMesh){gi.setOptional(P,X,"bindMatrix"),gi.setOptional(P,X,"bindMatrixInverse");const Ji=X.skeleton;Ji&&(ce.floatVertexTextures?(null===Ji.boneTexture&&Ji.computeBoneTexture(),gi.setValue(P,"boneTexture",Ji.boneTexture,De),gi.setValue(P,"boneTextureSize",Ji.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const tS=q.morphAttributes;if((void 0!==tS.position||void 0!==tS.normal||void 0!==tS.color&&!0===ce.isWebGL2)&&N.update(X,q,ba),($d||yt.receiveShadow!==X.receiveShadow)&&(yt.receiveShadow=X.receiveShadow,gi.setValue(P,"receiveShadow",X.receiveShadow)),H.isMeshGouraudMaterial&&null!==H.envMap&&(Sa.envMap.value=nt,Sa.flipEnvMap.value=nt.isCubeTexture&&!1===nt.isRenderTargetTexture?-1:1),$d&&(gi.setValue(P,"toneMappingExposure",_.toneMappingExposure),yt.needsLights&&function gne(A,B){A.ambientLightColor.needsUpdate=B,A.lightProbe.needsUpdate=B,A.directionalLights.needsUpdate=B,A.directionalLightShadows.needsUpdate=B,A.pointLights.needsUpdate=B,A.pointLightShadows.needsUpdate=B,A.spotLights.needsUpdate=B,A.spotLightShadows.needsUpdate=B,A.rectAreaLights.needsUpdate=B,A.hemisphereLights.needsUpdate=B}(Sa,eS),Re&&!0===H.fog&&le.refreshFogUniforms(Sa,Re),le.refreshMaterialUniforms(Sa,H,k,F,Be),_m.upload(P,yt.uniformsList,Sa,De)),H.isShaderMaterial&&!0===H.uniformsNeedUpdate&&(_m.upload(P,yt.uniformsList,Sa,De),H.uniformsNeedUpdate=!1),H.isSpriteMaterial&&gi.setValue(P,"center",X.center),gi.setValue(P,"modelViewMatrix",X.modelViewMatrix),gi.setValue(P,"normalMatrix",X.normalMatrix),gi.setValue(P,"modelMatrix",X.matrixWorld),H.isShaderMaterial||H.isRawShaderMaterial){const Ji=H.uniformsGroups;for(let nS=0,_ne=Ji.length;nS<_ne;nS++)if(ce.isWebGL2){const QO=Ji[nS];He.update(QO,ba),He.bind(QO,ba)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return ba}(A,B,q,H,X);re.setMaterial(H,ze);let nt=q.index,gt=1;if(!0===H.wireframe){if(nt=D.getWireframeAttribute(q),void 0===nt)return;gt=2}const Je=q.drawRange,ct=q.attributes.position;let an=Je.start*gt,pn=(Je.start+Je.count)*gt;null!==Re&&(an=Math.max(an,Re.start*gt),pn=Math.min(pn,(Re.start+Re.count)*gt)),null!==nt?(an=Math.max(an,0),pn=Math.min(pn,nt.count)):null!=ct&&(an=Math.max(an,0),pn=Math.min(pn,ct.count));const fr=pn-an;if(fr<0||fr===1/0)return;Ue.setup(X,H,tt,q,nt);let Ls,bn=fe;if(null!==nt&&(Ls=Yt.get(nt),bn=ie,bn.setIndex(Ls)),X.isMesh)!0===H.wireframe?(re.setLineWidth(H.wireframeLinewidth*Ve()),bn.setMode(P.LINES)):bn.setMode(P.TRIANGLES);else if(X.isLine){let yt=H.linewidth;void 0===yt&&(yt=1),re.setLineWidth(yt*Ve()),bn.setMode(X.isLineSegments?P.LINES:X.isLineLoop?P.LINE_LOOP:P.LINE_STRIP)}else X.isPoints?bn.setMode(P.POINTS):X.isSprite&&bn.setMode(P.TRIANGLES);if(X.isInstancedMesh)bn.renderInstances(an,fr,X.count);else if(q.isInstancedBufferGeometry){const Qb=Math.min(q.instanceCount,void 0!==q._maxInstanceCount?q._maxInstanceCount:1/0);bn.renderInstances(an,fr,Qb)}else bn.render(an,fr)},this.compile=function(A,B){function q(H,X,Re){!0===H.transparent&&2===H.side&&!1===H.forceSinglePass?(H.side=1,H.needsUpdate=!0,ag(H,X,Re),H.side=0,H.needsUpdate=!0,ag(H,X,Re),H.side=2):ag(H,X,Re)}g=ue.get(A),g.init(),v.push(g),A.traverseVisible(function(H){H.isLight&&H.layers.test(B.layers)&&(g.pushLight(H),H.castShadow&&g.pushShadow(H))}),g.setupLights(_._useLegacyLights),A.traverse(function(H){const X=H.material;if(X)if(Array.isArray(X))for(let Re=0;Re<X.length;Re++)q(X[Re],A,H);else q(X,A,H)}),v.pop(),g=null};let Ke=null;function jt(){mi.stop()}function Jr(){mi.start()}const mi=new EN;function XO(A,B,q,H){if(!1===A.visible)return;if(A.layers.test(B.layers))if(A.isGroup)q=A.renderOrder;else if(A.isLOD)!0===A.autoUpdate&&A.update(B);else if(A.isLight)g.pushLight(A),A.castShadow&&g.pushShadow(A);else if(A.isSprite){if(!A.frustumCulled||de.intersectsSprite(A)){H&&Xe.setFromMatrixPosition(A.matrixWorld).applyMatrix4(Se);const ze=w.update(A),tt=A.material;tt.visible&&y.push(A,ze,tt,q,Xe.z,null)}}else if((A.isMesh||A.isLine||A.isPoints)&&(!A.frustumCulled||de.intersectsObject(A))){const ze=w.update(A),tt=A.material;if(H&&(void 0!==A.boundingSphere?(null===A.boundingSphere&&A.computeBoundingSphere(),Xe.copy(A.boundingSphere.center)):(null===ze.boundingSphere&&ze.computeBoundingSphere(),Xe.copy(ze.boundingSphere.center)),Xe.applyMatrix4(A.matrixWorld).applyMatrix4(Se)),Array.isArray(tt)){const nt=ze.groups;for(let gt=0,Je=nt.length;gt<Je;gt++){const ct=nt[gt],an=tt[ct.materialIndex];an&&an.visible&&y.push(A,ze,an,q,Xe.z,ct)}}else tt.visible&&y.push(A,ze,tt,q,Xe.z,null)}const Re=A.children;for(let ze=0,tt=Re.length;ze<tt;ze++)XO(Re[ze],B,q,H)}function YO(A,B,q,H){const X=A.opaque,Re=A.transmissive,ze=A.transparent;g.setupLightsView(q),!0===ae&&Oe.setGlobalState(_.clippingPlanes,q),Re.length>0&&function pne(A,B,q,H){const X=ce.isWebGL2;null===Be&&(Be=new ra(1,1,{generateMipmaps:!0,type:Q.has("EXT_color_buffer_half_float")?hd:co,minFilter:Ko,samples:X?4:0})),_.getDrawingBufferSize(Ie),X?Be.setSize(Ie.x,Ie.y):Be.setSize(qp(Ie.x),qp(Ie.y));const Re=_.getRenderTarget();_.setRenderTarget(Be),_.getClearColor(ee),L=_.getClearAlpha(),L<1&&_.setClearColor(16777215,.5),_.clear();const ze=_.toneMapping;_.toneMapping=ao,og(A,q,H),De.updateMultisampleRenderTarget(Be),De.updateRenderTargetMipmap(Be);let tt=!1;for(let nt=0,gt=B.length;nt<gt;nt++){const Je=B[nt],ct=Je.object,an=Je.geometry,pn=Je.material,fr=Je.group;if(2===pn.side&&ct.layers.test(H.layers)){const Ls=pn.side;pn.side=1,pn.needsUpdate=!0,ZO(ct,q,H,an,pn,fr),pn.side=Ls,pn.needsUpdate=!0,tt=!0}}!0===tt&&(De.updateMultisampleRenderTarget(Be),De.updateRenderTargetMipmap(Be)),_.setRenderTarget(Re),_.setClearColor(ee,L),_.toneMapping=ze}(X,Re,B,q),H&&re.viewport(C.copy(H)),X.length>0&&og(X,B,q),Re.length>0&&og(Re,B,q),ze.length>0&&og(ze,B,q),re.buffers.depth.setTest(!0),re.buffers.depth.setMask(!0),re.buffers.color.setMask(!0),re.setPolygonOffset(!1)}function og(A,B,q){const H=!0===B.isScene?B.overrideMaterial:null;for(let X=0,Re=A.length;X<Re;X++){const ze=A[X],tt=ze.object,nt=ze.geometry,gt=null===H?ze.material:H,Je=ze.group;tt.layers.test(q.layers)&&ZO(tt,B,q,nt,gt,Je)}}function ZO(A,B,q,H,X,Re){A.onBeforeRender(_,B,q,H,X,Re),A.modelViewMatrix.multiplyMatrices(q.matrixWorldInverse,A.matrixWorld),A.normalMatrix.getNormalMatrix(A.modelViewMatrix),X.onBeforeRender(_,B,q,H,A,Re),!0===X.transparent&&2===X.side&&!1===X.forceSinglePass?(X.side=1,X.needsUpdate=!0,_.renderBufferDirect(q,B,H,X,A,Re),X.side=0,X.needsUpdate=!0,_.renderBufferDirect(q,B,H,X,A,Re),X.side=2):_.renderBufferDirect(q,B,H,X,A,Re),A.onAfterRender(_,B,q,H,X,Re)}function ag(A,B,q){!0!==B.isScene&&(B=bt);const H=Te.get(A),X=g.state.lights,ze=X.state.version,tt=z.getParameters(A,X.state,g.state.shadowsArray,B,q),nt=z.getProgramCacheKey(tt);let gt=H.programs;H.environment=A.isMeshStandardMaterial?B.environment:null,H.fog=B.fog,H.envMap=(A.isMeshStandardMaterial?mt:We).get(A.envMap||H.environment),void 0===gt&&(A.addEventListener("dispose",ye),gt=new Map,H.programs=gt);let Je=gt.get(nt);if(void 0!==Je){if(H.currentProgram===Je&&H.lightsStateVersion===ze)return KO(A,tt),Je}else tt.uniforms=z.getUniforms(A),A.onBuild(q,tt,_),A.onBeforeCompile(tt,_),Je=z.acquireProgram(tt,nt),gt.set(nt,Je),H.uniforms=tt.uniforms;const ct=H.uniforms;(!A.isShaderMaterial&&!A.isRawShaderMaterial||!0===A.clipping)&&(ct.clippingPlanes=Oe.uniform),KO(A,tt),H.needsLights=function yne(A){return A.isMeshLambertMaterial||A.isMeshToonMaterial||A.isMeshPhongMaterial||A.isMeshStandardMaterial||A.isShadowMaterial||A.isShaderMaterial&&!0===A.lights}(A),H.lightsStateVersion=ze,H.needsLights&&(ct.ambientLightColor.value=X.state.ambient,ct.lightProbe.value=X.state.probe,ct.directionalLights.value=X.state.directional,ct.directionalLightShadows.value=X.state.directionalShadow,ct.spotLights.value=X.state.spot,ct.spotLightShadows.value=X.state.spotShadow,ct.rectAreaLights.value=X.state.rectArea,ct.ltc_1.value=X.state.rectAreaLTC1,ct.ltc_2.value=X.state.rectAreaLTC2,ct.pointLights.value=X.state.point,ct.pointLightShadows.value=X.state.pointShadow,ct.hemisphereLights.value=X.state.hemi,ct.directionalShadowMap.value=X.state.directionalShadowMap,ct.directionalShadowMatrix.value=X.state.directionalShadowMatrix,ct.spotShadowMap.value=X.state.spotShadowMap,ct.spotLightMatrix.value=X.state.spotLightMatrix,ct.spotLightMap.value=X.state.spotLightMap,ct.pointShadowMap.value=X.state.pointShadowMap,ct.pointShadowMatrix.value=X.state.pointShadowMatrix);const an=Je.getUniforms(),pn=_m.seqWithValue(an.seq,ct);return H.currentProgram=Je,H.uniformsList=pn,Je}function KO(A,B){const q=Te.get(A);q.outputColorSpace=B.outputColorSpace,q.instancing=B.instancing,q.instancingColor=B.instancingColor,q.skinning=B.skinning,q.morphTargets=B.morphTargets,q.morphNormals=B.morphNormals,q.morphColors=B.morphColors,q.morphTargetsCount=B.morphTargetsCount,q.numClippingPlanes=B.numClippingPlanes,q.numIntersection=B.numClipIntersection,q.vertexAlphas=B.vertexAlphas,q.vertexTangents=B.vertexTangents,q.toneMapping=B.toneMapping}mi.setAnimationLoop(function En(A){Ke&&Ke(A)}),typeof self<"u"&&mi.setContext(self),this.setAnimationLoop=function(A){Ke=A,I.setAnimationLoop(A),null===A?mi.stop():mi.start()},I.addEventListener("sessionstart",jt),I.addEventListener("sessionend",Jr),this.render=function(A,B){if(void 0===B||!0===B.isCamera){if(!0!==E){if(!0===A.matrixWorldAutoUpdate&&A.updateMatrixWorld(),null===B.parent&&!0===B.matrixWorldAutoUpdate&&B.updateMatrixWorld(),!0===I.enabled&&!0===I.isPresenting&&(!0===I.cameraAutoUpdate&&I.updateCamera(B),B=I.getCamera()),!0===A.isScene&&A.onBeforeRender(_,A,B,M),g=ue.get(A,v.length),g.init(),v.push(g),Se.multiplyMatrices(B.projectionMatrix,B.matrixWorldInverse),de.setFromProjectionMatrix(Se),Me=this.localClippingEnabled,ae=Oe.init(this.clippingPlanes,Me),y=oe.get(A,m.length),y.init(),m.push(y),XO(A,B,0,_.sortObjects),y.finish(),!0===_.sortObjects&&y.sort(W,V),this.info.render.frame++,!0===ae&&Oe.beginShadows(),he.render(g.state.shadowsArray,A,B),!0===ae&&Oe.endShadows(),!0===this.info.autoReset&&this.info.reset(),Ee.render(y,A),g.setupLights(_._useLegacyLights),B.isArrayCamera){const H=B.cameras;for(let X=0,Re=H.length;X<Re;X++){const ze=H[X];YO(y,A,ze,ze.viewport)}}else YO(y,A,B);null!==M&&(De.updateMultisampleRenderTarget(M),De.updateRenderTargetMipmap(M)),!0===A.isScene&&A.onAfterRender(_,A,B),Ue.resetDefaultState(),R=-1,b=null,v.pop(),g=v.length>0?v[v.length-1]:null,m.pop(),y=m.length>0?m[m.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return S},this.getActiveMipmapLevel=function(){return x},this.getRenderTarget=function(){return M},this.setRenderTargetTextures=function(A,B,q){Te.get(A.texture).__webglTexture=B,Te.get(A.depthTexture).__webglTexture=q;const H=Te.get(A);H.__hasExternalTextures=!0,H.__hasExternalTextures&&(H.__autoAllocateDepthBuffer=void 0===q,H.__autoAllocateDepthBuffer||!0===Q.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),H.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(A,B){const q=Te.get(A);q.__webglFramebuffer=B,q.__useDefaultFramebuffer=void 0===B},this.setRenderTarget=function(A,B=0,q=0){M=A,S=B,x=q;let H=!0,X=null,Re=!1,ze=!1;if(A){const nt=Te.get(A);void 0!==nt.__useDefaultFramebuffer?(re.bindFramebuffer(P.FRAMEBUFFER,null),H=!1):void 0===nt.__webglFramebuffer?De.setupRenderTarget(A):nt.__hasExternalTextures&&De.rebindTextures(A,Te.get(A.texture).__webglTexture,Te.get(A.depthTexture).__webglTexture);const gt=A.texture;(gt.isData3DTexture||gt.isDataArrayTexture||gt.isCompressedArrayTexture)&&(ze=!0);const Je=Te.get(A).__webglFramebuffer;A.isWebGLCubeRenderTarget?(X=Array.isArray(Je[B])?Je[B][q]:Je[B],Re=!0):X=ce.isWebGL2&&A.samples>0&&!1===De.useMultisampledRTT(A)?Te.get(A).__webglMultisampledFramebuffer:Array.isArray(Je)?Je[q]:Je,C.copy(A.viewport),U.copy(A.scissor),Y=A.scissorTest}else C.copy(Z).multiplyScalar(k).floor(),U.copy(O).multiplyScalar(k).floor(),Y=$;if(re.bindFramebuffer(P.FRAMEBUFFER,X)&&ce.drawBuffers&&H&&re.drawBuffers(A,X),re.viewport(C),re.scissor(U),re.setScissorTest(Y),Re){const nt=Te.get(A.texture);P.framebufferTexture2D(P.FRAMEBUFFER,P.COLOR_ATTACHMENT0,P.TEXTURE_CUBE_MAP_POSITIVE_X+B,nt.__webglTexture,q)}else if(ze){const nt=Te.get(A.texture);P.framebufferTextureLayer(P.FRAMEBUFFER,P.COLOR_ATTACHMENT0,nt.__webglTexture,q||0,B||0)}R=-1},this.readRenderTargetPixels=function(A,B,q,H,X,Re,ze){if(!A||!A.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let tt=Te.get(A).__webglFramebuffer;if(A.isWebGLCubeRenderTarget&&void 0!==ze&&(tt=tt[ze]),tt){re.bindFramebuffer(P.FRAMEBUFFER,tt);try{const nt=A.texture,gt=nt.format,Je=nt.type;if(gt!==ur&&Ye.convert(gt)!==P.getParameter(P.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const ct=Je===hd&&(Q.has("EXT_color_buffer_half_float")||ce.isWebGL2&&Q.has("EXT_color_buffer_float"));if(!(Je===co||Ye.convert(Je)===P.getParameter(P.IMPLEMENTATION_COLOR_READ_TYPE)||Je===bs&&(ce.isWebGL2||Q.has("OES_texture_float")||Q.has("WEBGL_color_buffer_float"))||ct))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");B>=0&&B<=A.width-H&&q>=0&&q<=A.height-X&&P.readPixels(B,q,H,X,Ye.convert(gt),Ye.convert(Je),Re)}finally{const nt=null!==M?Te.get(M).__webglFramebuffer:null;re.bindFramebuffer(P.FRAMEBUFFER,nt)}}},this.copyFramebufferToTexture=function(A,B,q=0){const H=Math.pow(2,-q),X=Math.floor(B.image.width*H),Re=Math.floor(B.image.height*H);De.setTexture2D(B,0),P.copyTexSubImage2D(P.TEXTURE_2D,q,0,0,A.x,A.y,X,Re),re.unbindTexture()},this.copyTextureToTexture=function(A,B,q,H=0){const X=B.image.width,Re=B.image.height,ze=Ye.convert(q.format),tt=Ye.convert(q.type);De.setTexture2D(q,0),P.pixelStorei(P.UNPACK_FLIP_Y_WEBGL,q.flipY),P.pixelStorei(P.UNPACK_PREMULTIPLY_ALPHA_WEBGL,q.premultiplyAlpha),P.pixelStorei(P.UNPACK_ALIGNMENT,q.unpackAlignment),B.isDataTexture?P.texSubImage2D(P.TEXTURE_2D,H,A.x,A.y,X,Re,ze,tt,B.image.data):B.isCompressedTexture?P.compressedTexSubImage2D(P.TEXTURE_2D,H,A.x,A.y,B.mipmaps[0].width,B.mipmaps[0].height,ze,B.mipmaps[0].data):P.texSubImage2D(P.TEXTURE_2D,H,A.x,A.y,ze,tt,B.image),0===H&&q.generateMipmaps&&P.generateMipmap(P.TEXTURE_2D),re.unbindTexture()},this.copyTextureToTexture3D=function(A,B,q,H,X=0){if(_.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const Re=A.max.x-A.min.x+1,ze=A.max.y-A.min.y+1,tt=A.max.z-A.min.z+1,nt=Ye.convert(H.format),gt=Ye.convert(H.type);let Je;if(H.isData3DTexture)De.setTexture3D(H,0),Je=P.TEXTURE_3D;else{if(!H.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");De.setTexture2DArray(H,0),Je=P.TEXTURE_2D_ARRAY}P.pixelStorei(P.UNPACK_FLIP_Y_WEBGL,H.flipY),P.pixelStorei(P.UNPACK_PREMULTIPLY_ALPHA_WEBGL,H.premultiplyAlpha),P.pixelStorei(P.UNPACK_ALIGNMENT,H.unpackAlignment);const ct=P.getParameter(P.UNPACK_ROW_LENGTH),an=P.getParameter(P.UNPACK_IMAGE_HEIGHT),pn=P.getParameter(P.UNPACK_SKIP_PIXELS),fr=P.getParameter(P.UNPACK_SKIP_ROWS),Ls=P.getParameter(P.UNPACK_SKIP_IMAGES),bn=q.isCompressedTexture?q.mipmaps[0]:q.image;P.pixelStorei(P.UNPACK_ROW_LENGTH,bn.width),P.pixelStorei(P.UNPACK_IMAGE_HEIGHT,bn.height),P.pixelStorei(P.UNPACK_SKIP_PIXELS,A.min.x),P.pixelStorei(P.UNPACK_SKIP_ROWS,A.min.y),P.pixelStorei(P.UNPACK_SKIP_IMAGES,A.min.z),q.isDataTexture||q.isData3DTexture?P.texSubImage3D(Je,X,B.x,B.y,B.z,Re,ze,tt,nt,gt,bn.data):q.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),P.compressedTexSubImage3D(Je,X,B.x,B.y,B.z,Re,ze,tt,nt,bn.data)):P.texSubImage3D(Je,X,B.x,B.y,B.z,Re,ze,tt,nt,gt,bn),P.pixelStorei(P.UNPACK_ROW_LENGTH,ct),P.pixelStorei(P.UNPACK_IMAGE_HEIGHT,an),P.pixelStorei(P.UNPACK_SKIP_PIXELS,pn),P.pixelStorei(P.UNPACK_SKIP_ROWS,fr),P.pixelStorei(P.UNPACK_SKIP_IMAGES,Ls),0===X&&H.generateMipmaps&&P.generateMipmap(Je),re.unbindTexture()},this.initTexture=function(A){A.isCubeTexture?De.setTextureCube(A,0):A.isData3DTexture?De.setTexture3D(A,0):A.isDataArrayTexture||A.isCompressedArrayTexture?De.setTexture2DArray(A,0):De.setTexture2D(A,0),re.unbindTexture()},this.resetState=function(){S=0,x=0,M=null,re.reset(),Ue.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return ws}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=e===CE?"display-p3":"srgb",t.unpackColorSpace=Pt.workingColorSpace===Hp?"display-p3":"srgb"}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(e){console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!e}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===Pn?ea:3e3}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===ea?Pn:Ss}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}(class wJ extends YN{}).prototype.isWebGL1Renderer=!0;class ZN extends qi{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t}}function pa(n,e,t){return!n||!t&&n.constructor===e?n:"number"==typeof e.BYTES_PER_ELEMENT?new e(n):Array.prototype.slice.call(n)}class Vm{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,r=t[i],s=t[i-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=i+2;;){if(void 0===r){if(e<s)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(s=r,r=t[++i],e<r)break t}o=t.length;break n}if(e>=s)break e;{const a=t[1];e<a&&(i=2,s=a);for(let l=i-2;;){if(void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(i===l)break;if(r=s,s=t[--i-1],e>=s)break t}o=i,i=0}}for(;i<o;){const a=i+o>>>1;e<t[a]?o=a:i=a+1}if(r=t[i],s=t[i-1],void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=i[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class CQ extends Vm{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(e,t,i){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],l=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case 2401:s=e,a=2*t-i;break;case 2402:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=i}if(void 0===l)switch(this.getSettings_().endingEnd){case 2401:o=e,l=2*i-t;break;case 2402:o=1,l=i+r[1]-r[0];break;default:o=e-1,l=t}const c=.5*(i-t),u=this.valueSize;this._weightPrev=c/(t-a),this._weightNext=c/(l-i),this._offsetPrev=s*u,this._offsetNext=o*u}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=this._offsetPrev,d=this._offsetNext,h=this._weightPrev,f=this._weightNext,p=(i-t)/(r-t),y=p*p,g=y*p,m=-h*g+2*h*y-h*p,v=(1+h)*g+(-1.5-2*h)*y+(-.5+h)*p+1,_=(-1-f)*g+(1.5+f)*y+.5*p,E=f*g-f*y;for(let S=0;S!==a;++S)s[S]=m*o[u+S]+v*o[c+S]+_*o[l+S]+E*o[d+S];return s}}class kL extends Vm{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=(i-t)/(r-t),d=1-u;for(let h=0;h!==a;++h)s[h]=o[c+h]*d+o[l+h]*u;return s}}class TQ extends Vm{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class Zr{constructor(e,t,i,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=pa(t,this.TimeBufferType),this.values=pa(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:pa(e.times,Array),values:pa(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new TQ(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new kL(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new CQ(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case 2300:t=this.InterpolantFactoryMethodDiscrete;break;case 2301:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){const i=this.times,r=i.length;let s=0,o=r-1;for(;s!==r&&i[s]<e;)++s;for(;-1!==o&&i[o]>t;)--o;if(++o,0!==s||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=i.slice(s,o),this.values=this.values.slice(s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;0===s&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=i[a];if("number"==typeof l&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(null!==o&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(void 0!==r&&function OL(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}(r))for(let a=0,l=r.length;a!==l;++a){const c=r[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),i=this.getValueSize(),r=2302===this.getInterpolation(),s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const c=e[a];if(c!==e[a+1]&&(1!==a||c!==e[0]))if(r)l=!0;else{const d=a*i,h=d-i,f=d+i;for(let p=0;p!==i;++p){const y=t[d+p];if(y!==t[h+p]||y!==t[f+p]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const d=a*i,h=o*i;for(let f=0;f!==i;++f)t[h+f]=t[d+f]}++o}}if(s>0){e[o]=e[s];for(let a=s*i,l=o*i,c=0;c!==i;++c)t[l+c]=t[a+c];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*i)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}Zr.prototype.TimeBufferType=Float32Array,Zr.prototype.ValueBufferType=Float32Array,Zr.prototype.DefaultInterpolation=2301;class Ec extends Zr{}Ec.prototype.ValueTypeName="bool",Ec.prototype.ValueBufferType=Array,Ec.prototype.DefaultInterpolation=2300,Ec.prototype.InterpolantFactoryMethodLinear=void 0,Ec.prototype.InterpolantFactoryMethodSmooth=void 0;(class UL extends Zr{}).prototype.ValueTypeName="color";(class Hm extends Zr{}).prototype.ValueTypeName="number";class AQ extends Vm{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(i-t)/(r-t);let c=e*a;for(let u=c+a;c!==u;c+=4)di.slerpFlat(s,0,o,c-a,o,c,l);return s}}class kd extends Zr{InterpolantFactoryMethodLinear(e){return new AQ(this.times,this.values,this.getValueSize(),e)}}kd.prototype.ValueTypeName="quaternion",kd.prototype.DefaultInterpolation=2301,kd.prototype.InterpolantFactoryMethodSmooth=void 0;class bc extends Zr{}bc.prototype.ValueTypeName="string",bc.prototype.ValueBufferType=Array,bc.prototype.DefaultInterpolation=2300,bc.prototype.InterpolantFactoryMethodLinear=void 0,bc.prototype.InterpolantFactoryMethodSmooth=void 0;(class zm extends Zr{}).prototype.ValueTypeName="vector";class PQ extends qi{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Ae(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}class GL extends PQ{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}const Ub="\\[\\]\\.:\\/",ZQ=new RegExp("["+Ub+"]","g"),Bb="[^"+Ub+"]",KQ="[^"+Ub.replace("\\.","")+"]",nee=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",Bb)+/(WCOD+)?/.source.replace("WCOD",KQ)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Bb)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Bb)+"$"),iee=["material","materials","bones","map"];class ree{constructor(e,t,i){const r=i||Gt.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}let Gt=(()=>{class n{constructor(t,i,r){this.path=i,this.parsedPath=r||n.parseTrackName(i),this.node=n.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,i,r){return t&&t.isAnimationObjectGroup?new n.Composite(t,i,r):new n(t,i,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(ZQ,"")}static parseTrackName(t){const i=nee.exec(t);if(null===i)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},s=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==s&&-1!==s){const o=r.nodeName.substring(s+1);-1!==iee.indexOf(o)&&(r.nodeName=r.nodeName.substring(0,s),r.objectName=o)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,i){if(void 0===i||""===i||"."===i||-1===i||i===t.name||i===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(i);if(void 0!==r)return r}if(t.children){const r=function(o){for(let a=0;a<o.length;a++){const l=o[a];if(l.name===i||l.uuid===i)return l;const c=r(l.children);if(c)return c}return null},s=r(t.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,i){t[i]=this.targetObject[this.propertyName]}_getValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)t[i++]=r[s]}_getValue_arrayElement(t,i){t[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,i){this.resolvedProperty.toArray(t,i)}_setValue_direct(t,i){this.targetObject[this.propertyName]=t[i]}_setValue_direct_setNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++]}_setValue_array_setNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,i){this.resolvedProperty[this.propertyIndex]=t[i]}_setValue_arrayElement_setNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,i){this.resolvedProperty.fromArray(t,i)}_setValue_fromArray_setNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,i){this.bind(),this.getValue(t,i)}_setValue_unbound(t,i){this.bind(),this.setValue(t,i)}bind(){let t=this.node;const i=this.parsedPath,r=i.objectName,s=i.propertyName;let o=i.propertyIndex;if(t||(t=n.findNode(this.rootNode,i.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(r){let u=i.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let d=0;d<t.length;d++)if(t[d].name===u){u=d;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==u){if(void 0===t[u])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[u]}}const a=t[s];if(void 0===a)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+i.nodeName+"."+s+" but it wasn't found.",t);let l=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?l=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(void 0!==o){if("morphTargetInfluences"===s){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[o]&&(o=t.morphTargetDictionary[o])}c=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=o}else void 0!==a.fromArray&&void 0!==a.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(c=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=s;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return n.Composite=ree,n})();Gt.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Gt.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Gt.prototype.GetterByBindingType=[Gt.prototype._getValue_direct,Gt.prototype._getValue_array,Gt.prototype._getValue_arrayElement,Gt.prototype._getValue_toArray],Gt.prototype.SetterByBindingTypeAndVersioning=[[Gt.prototype._setValue_direct,Gt.prototype._setValue_direct_setNeedsUpdate,Gt.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Gt.prototype._setValue_array,Gt.prototype._setValue_array_setNeedsUpdate,Gt.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Gt.prototype._setValue_arrayElement,Gt.prototype._setValue_arrayElement_setNeedsUpdate,Gt.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Gt.prototype._setValue_fromArray,Gt.prototype._setValue_fromArray_setNeedsUpdate,Gt.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],new Float32Array(1);class lee{constructor(e,t,i=0,r=1/0){this.ray=new Zl(e,t),this.near=i,this.far=r,this.camera=null,this.layers=new HE,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,i=[]){return Vb(e,this,i,t),i.sort(eO),i}intersectObjects(e,t=!0,i=[]){for(let r=0,s=e.length;r<s;r++)Vb(e[r],this,i,t);return i.sort(eO),i}}function eO(n,e){return n.distance-e.distance}function Vb(n,e,t,i){if(n.layers.test(e.layers)&&n.raycast(e,t),!0===i){const r=n.children;for(let s=0,o=r.length;s<o;s++)Vb(r[s],e,t,!0)}}class tO{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(rn(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"157"}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="157");const dO={type:"change"},Gb={type:"start"},hO={type:"end"},Jm=new Zl,fO=new Eo,uee=Math.cos(70*ZP_DEG2RAD);class dee extends na{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new T,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:0,MIDDLE:1,RIGHT:2},this.touches={ONE:0,TWO:2},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return a.phi},this.getAzimuthalAngle=function(){return a.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(N){N.addEventListener("keydown",w),this._domElementKeyEvents=N},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",w),this._domElementKeyEvents=null},this.saveState=function(){i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=function(){i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(dO),i.update(),s=r.NONE},this.update=function(){const N=new T,fe=(new di).setFromUnitVectors(e.up,new T(0,1,0)),ie=fe.clone().invert(),Ye=new T,Ue=new di,He=new T,Fe=2*Math.PI;return function(ge=null){const pe=i.object.position;N.copy(pe).sub(i.target),N.applyQuaternion(fe),a.setFromVector3(N),i.autoRotate&&s===r.NONE&&U(function b(N){return null!==N?2*Math.PI/60*i.autoRotateSpeed*N:2*Math.PI/60/60*i.autoRotateSpeed}(ge)),i.enableDamping?(a.theta+=l.theta*i.dampingFactor,a.phi+=l.phi*i.dampingFactor):(a.theta+=l.theta,a.phi+=l.phi);let ve=i.minAzimuthAngle,ye=i.maxAzimuthAngle;isFinite(ve)&&isFinite(ye)&&(ve<-Math.PI?ve+=Fe:ve>Math.PI&&(ve-=Fe),ye<-Math.PI?ye+=Fe:ye>Math.PI&&(ye-=Fe),a.theta=ve<=ye?Math.max(ve,Math.min(ye,a.theta)):a.theta>(ve+ye)/2?Math.max(ve,a.theta):Math.min(ye,a.theta)),a.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,a.phi)),a.makeSafe(),!0===i.enableDamping?i.target.addScaledVector(u,i.dampingFactor):i.target.add(u),a.radius=V(i.zoomToCursor&&x||i.object.isOrthographicCamera?a.radius:a.radius*c),N.setFromSpherical(a),N.applyQuaternion(ie),pe.copy(i.target).add(N),i.object.lookAt(i.target),!0===i.enableDamping?(l.theta*=1-i.dampingFactor,l.phi*=1-i.dampingFactor,u.multiplyScalar(1-i.dampingFactor)):(l.set(0,0,0),u.set(0,0,0));let se=!1;if(i.zoomToCursor&&x){let Le=null;if(i.object.isPerspectiveCamera){const Ke=N.length();Le=V(Ke*c),i.object.position.addScaledVector(E,Ke-Le),i.object.updateMatrixWorld()}else if(i.object.isOrthographicCamera){const Ke=new T(S.x,S.y,0);Ke.unproject(i.object),i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/c)),i.object.updateProjectionMatrix(),se=!0;const En=new T(S.x,S.y,0);En.unproject(i.object),i.object.position.sub(En).add(Ke),i.object.updateMatrixWorld(),Le=N.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),i.zoomToCursor=!1;null!==Le&&(this.screenSpacePanning?i.target.set(0,0,-1).transformDirection(i.object.matrix).multiplyScalar(Le).add(i.object.position):(Jm.origin.copy(i.object.position),Jm.direction.set(0,0,-1).transformDirection(i.object.matrix),Math.abs(i.object.up.dot(Jm.direction))<uee?e.lookAt(i.target):(fO.setFromNormalAndCoplanarPoint(i.object.up,i.target),Jm.intersectPlane(fO,i.target))))}else i.object.isOrthographicCamera&&(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/c)),i.object.updateProjectionMatrix(),se=!0);return c=1,x=!1,!!(se||Ye.distanceToSquared(i.object.position)>o||8*(1-Ue.dot(i.object.quaternion))>o||He.distanceToSquared(i.target)>0)&&(i.dispatchEvent(dO),Ye.copy(i.object.position),Ue.copy(i.object.quaternion),He.copy(i.target),se=!1,!0)}}(),this.dispose=function(){i.domElement.removeEventListener("contextmenu",oe),i.domElement.removeEventListener("pointerdown",Te),i.domElement.removeEventListener("pointercancel",We),i.domElement.removeEventListener("wheel",D),i.domElement.removeEventListener("pointermove",De),i.domElement.removeEventListener("pointerup",We),null!==i._domElementKeyEvents&&(i._domElementKeyEvents.removeEventListener("keydown",w),i._domElementKeyEvents=null)};const i=this,r={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let s=r.NONE;const o=1e-6,a=new tO,l=new tO;let c=1;const u=new T,d=new K,h=new K,f=new K,p=new K,y=new K,g=new K,m=new K,v=new K,_=new K,E=new T,S=new K;let x=!1;const M=[],R={};function C(){return Math.pow(.95,i.zoomSpeed)}function U(N){l.theta-=N}function Y(N){l.phi-=N}const ee=function(){const N=new T;return function(ie,Ye){N.setFromMatrixColumn(Ye,0),N.multiplyScalar(-ie),u.add(N)}}(),L=function(){const N=new T;return function(ie,Ye){!0===i.screenSpacePanning?N.setFromMatrixColumn(Ye,1):(N.setFromMatrixColumn(Ye,0),N.crossVectors(i.object.up,N)),N.multiplyScalar(ie),u.add(N)}}(),G=function(){const N=new T;return function(ie,Ye){const Ue=i.domElement;if(i.object.isPerspectiveCamera){N.copy(i.object.position).sub(i.target);let Fe=N.length();Fe*=Math.tan(i.object.fov/2*Math.PI/180),ee(2*ie*Fe/Ue.clientHeight,i.object.matrix),L(2*Ye*Fe/Ue.clientHeight,i.object.matrix)}else i.object.isOrthographicCamera?(ee(ie*(i.object.right-i.object.left)/i.object.zoom/Ue.clientWidth,i.object.matrix),L(Ye*(i.object.top-i.object.bottom)/i.object.zoom/Ue.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}}();function F(N){i.object.isPerspectiveCamera||i.object.isOrthographicCamera?c/=N:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function k(N){i.object.isPerspectiveCamera||i.object.isOrthographicCamera?c*=N:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function W(N){if(!i.zoomToCursor)return;x=!0;const fe=i.domElement.getBoundingClientRect(),Ye=N.clientY-fe.top,He=fe.height;S.x=(N.clientX-fe.left)/fe.width*2-1,S.y=-Ye/He*2+1,E.set(S.x,S.y,1).unproject(i.object).sub(i.object.position).normalize()}function V(N){return Math.max(i.minDistance,Math.min(i.maxDistance,N))}function Z(N){d.set(N.clientX,N.clientY)}function $(N){p.set(N.clientX,N.clientY)}function Ie(){1===M.length?d.set(M[0].pageX,M[0].pageY):d.set(.5*(M[0].pageX+M[1].pageX),.5*(M[0].pageY+M[1].pageY))}function Xe(){1===M.length?p.set(M[0].pageX,M[0].pageY):p.set(.5*(M[0].pageX+M[1].pageX),.5*(M[0].pageY+M[1].pageY))}function bt(){const N=M[0].pageX-M[1].pageX,fe=M[0].pageY-M[1].pageY,ie=Math.sqrt(N*N+fe*fe);m.set(0,ie)}function me(N){if(1==M.length)h.set(N.pageX,N.pageY);else{const ie=Ee(N);h.set(.5*(N.pageX+ie.x),.5*(N.pageY+ie.y))}f.subVectors(h,d).multiplyScalar(i.rotateSpeed);const fe=i.domElement;U(2*Math.PI*f.x/fe.clientHeight),Y(2*Math.PI*f.y/fe.clientHeight),d.copy(h)}function Q(N){if(1===M.length)y.set(N.pageX,N.pageY);else{const fe=Ee(N);y.set(.5*(N.pageX+fe.x),.5*(N.pageY+fe.y))}g.subVectors(y,p).multiplyScalar(i.panSpeed),G(g.x,g.y),p.copy(y)}function ce(N){const fe=Ee(N),ie=N.pageX-fe.x,Ye=N.pageY-fe.y,Ue=Math.sqrt(ie*ie+Ye*Ye);v.set(0,Ue),_.set(0,Math.pow(v.y/m.y,i.zoomSpeed)),F(_.y),m.copy(v)}function Te(N){!1!==i.enabled&&(0===M.length&&(i.domElement.setPointerCapture(N.pointerId),i.domElement.addEventListener("pointermove",De),i.domElement.addEventListener("pointerup",We)),function ue(N){M.push(N)}(N),"touch"===N.pointerType?function z(N){switch(he(N),M.length){case 1:switch(i.touches.ONE){case 0:if(!1===i.enableRotate)return;Ie(),s=r.TOUCH_ROTATE;break;case 1:if(!1===i.enablePan)return;Xe(),s=r.TOUCH_PAN;break;default:s=r.NONE}break;case 2:switch(i.touches.TWO){case 2:if(!1===i.enableZoom&&!1===i.enablePan)return;(function Ve(){i.enableZoom&&bt(),i.enablePan&&Xe()})(),s=r.TOUCH_DOLLY_PAN;break;case 3:if(!1===i.enableZoom&&!1===i.enableRotate)return;(function P(){i.enableZoom&&bt(),i.enableRotate&&Ie()})(),s=r.TOUCH_DOLLY_ROTATE;break;default:s=r.NONE}break;default:s=r.NONE}s!==r.NONE&&i.dispatchEvent(Gb)}(N):function mt(N){let fe;switch(N.button){case 0:fe=i.mouseButtons.LEFT;break;case 1:fe=i.mouseButtons.MIDDLE;break;case 2:fe=i.mouseButtons.RIGHT;break;default:fe=-1}switch(fe){case 1:if(!1===i.enableZoom)return;(function O(N){W(N),m.set(N.clientX,N.clientY)})(N),s=r.DOLLY;break;case 0:if(N.ctrlKey||N.metaKey||N.shiftKey){if(!1===i.enablePan)return;$(N),s=r.PAN}else{if(!1===i.enableRotate)return;Z(N),s=r.ROTATE}break;case 2:if(N.ctrlKey||N.metaKey||N.shiftKey){if(!1===i.enableRotate)return;Z(N),s=r.ROTATE}else{if(!1===i.enablePan)return;$(N),s=r.PAN}break;default:s=r.NONE}s!==r.NONE&&i.dispatchEvent(Gb)}(N))}function De(N){!1!==i.enabled&&("touch"===N.pointerType?function le(N){switch(he(N),s){case r.TOUCH_ROTATE:if(!1===i.enableRotate)return;me(N),i.update();break;case r.TOUCH_PAN:if(!1===i.enablePan)return;Q(N),i.update();break;case r.TOUCH_DOLLY_PAN:if(!1===i.enableZoom&&!1===i.enablePan)return;(function re(N){i.enableZoom&&ce(N),i.enablePan&&Q(N)})(N),i.update();break;case r.TOUCH_DOLLY_ROTATE:if(!1===i.enableZoom&&!1===i.enableRotate)return;(function ke(N){i.enableZoom&&ce(N),i.enableRotate&&me(N)})(N),i.update();break;default:s=r.NONE}}(N):function Yt(N){switch(s){case r.ROTATE:if(!1===i.enableRotate)return;!function de(N){h.set(N.clientX,N.clientY),f.subVectors(h,d).multiplyScalar(i.rotateSpeed);const fe=i.domElement;U(2*Math.PI*f.x/fe.clientHeight),Y(2*Math.PI*f.y/fe.clientHeight),d.copy(h),i.update()}(N);break;case r.DOLLY:if(!1===i.enableZoom)return;!function ae(N){v.set(N.clientX,N.clientY),_.subVectors(v,m),_.y>0?F(C()):_.y<0&&k(C()),m.copy(v),i.update()}(N);break;case r.PAN:if(!1===i.enablePan)return;!function Me(N){y.set(N.clientX,N.clientY),g.subVectors(y,p).multiplyScalar(i.panSpeed),G(g.x,g.y),p.copy(y),i.update()}(N)}}(N))}function We(N){(function Oe(N){delete R[N.pointerId];for(let fe=0;fe<M.length;fe++)if(M[fe].pointerId==N.pointerId)return void M.splice(fe,1)})(N),0===M.length&&(i.domElement.releasePointerCapture(N.pointerId),i.domElement.removeEventListener("pointermove",De),i.domElement.removeEventListener("pointerup",We)),i.dispatchEvent(hO),s=r.NONE}function D(N){!1===i.enabled||!1===i.enableZoom||s!==r.NONE||(N.preventDefault(),i.dispatchEvent(Gb),function Be(N){W(N),N.deltaY<0?k(C()):N.deltaY>0&&F(C()),i.update()}(N),i.dispatchEvent(hO))}function w(N){!1===i.enabled||!1===i.enablePan||function Se(N){let fe=!1;switch(N.code){case i.keys.UP:N.ctrlKey||N.metaKey||N.shiftKey?Y(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):G(0,i.keyPanSpeed),fe=!0;break;case i.keys.BOTTOM:N.ctrlKey||N.metaKey||N.shiftKey?Y(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):G(0,-i.keyPanSpeed),fe=!0;break;case i.keys.LEFT:N.ctrlKey||N.metaKey||N.shiftKey?U(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):G(i.keyPanSpeed,0),fe=!0;break;case i.keys.RIGHT:N.ctrlKey||N.metaKey||N.shiftKey?U(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):G(-i.keyPanSpeed,0),fe=!0}fe&&(N.preventDefault(),i.update())}(N)}function oe(N){!1!==i.enabled&&N.preventDefault()}function he(N){let fe=R[N.pointerId];void 0===fe&&(fe=new K,R[N.pointerId]=fe),fe.set(N.pageX,N.pageY)}function Ee(N){return R[(N.pointerId===M[0].pointerId?M[1]:M[0]).pointerId]}i.domElement.addEventListener("contextmenu",oe),i.domElement.addEventListener("pointerdown",Te),i.domElement.addEventListener("pointercancel",We),i.domElement.addEventListener("wheel",D,{passive:!1}),this.update()}}var pO=class{target;name;intersected;wasIntersected=!1;distance;constructor(n,e){this.target=n,this.name=e,this.intersected=!1,this.distance=0}},Ii=class{type;cancelBubble;originalEvent;coords=new K(0,0);distance=0;intersected=!1;constructor(n,e=null){this.cancelBubble=!1,this.type=n,this.originalEvent=e}stopPropagation(){this.cancelBubble=!0}};const fee=[0,2e3,1e4,3e4,null];class mO{constructor(e){this._retryDelays=void 0!==e?[...e,null]:fee}nextRetryDelayInMilliseconds(e){return this._retryDelays[e.previousRetryCount]}}let Bd=(()=>{class n{}return n.Authorization="Authorization",n.Cookie="Cookie",n})();class gO{constructor(e,t,i){this.statusCode=e,this.statusText=t,this.content=i}}class Qm{get(e,t){return this.send({...t,method:"GET",url:e})}post(e,t){return this.send({...t,method:"POST",url:e})}delete(e,t){return this.send({...t,method:"DELETE",url:e})}getCookieString(e){return""}}class pee extends Qm{constructor(e,t){super(),this._innerClient=e,this._accessTokenFactory=t}send(e){var t=this;return Xt(function*(){let i=!0;t._accessTokenFactory&&(!t._accessToken||e.url&&e.url.indexOf("/negotiate?")>0)&&(i=!1,t._accessToken=yield t._accessTokenFactory()),t._setAuthorizationHeader(e);const r=yield t._innerClient.send(e);return i&&401===r.statusCode&&t._accessTokenFactory?(t._accessToken=yield t._accessTokenFactory(),t._setAuthorizationHeader(e),yield t._innerClient.send(e)):r})()}_setAuthorizationHeader(e){e.headers||(e.headers={}),this._accessToken?e.headers[Bd.Authorization]=`Bearer ${this._accessToken}`:this._accessTokenFactory&&e.headers[Bd.Authorization]&&delete e.headers[Bd.Authorization]}getCookieString(e){return this._innerClient.getCookieString(e)}}class wc extends Error{constructor(e,t){const i=new.target.prototype;super(`${e}: Status code '${t}'`),this.statusCode=t,this.__proto__=i}}class Wb extends Error{constructor(e="A timeout occurred."){const t=new.target.prototype;super(e),this.__proto__=t}}class Ar extends Error{constructor(e="An abort occurred."){const t=new.target.prototype;super(e),this.__proto__=t}}class mee extends Error{constructor(e,t){const i=new.target.prototype;super(e),this.transport=t,this.errorType="UnsupportedTransportError",this.__proto__=i}}class gee extends Error{constructor(e,t){const i=new.target.prototype;super(e),this.transport=t,this.errorType="DisabledTransportError",this.__proto__=i}}class yee extends Error{constructor(e,t){const i=new.target.prototype;super(e),this.transport=t,this.errorType="FailedToStartTransportError",this.__proto__=i}}class _ee extends Error{constructor(e){const t=new.target.prototype;super(e),this.errorType="FailedToNegotiateWithServerError",this.__proto__=t}}class vee extends Error{constructor(e,t){const i=new.target.prototype;super(e),this.innerErrors=t,this.__proto__=i}}var J=function(n){return n[n.Trace=0]="Trace",n[n.Debug=1]="Debug",n[n.Information=2]="Information",n[n.Warning=3]="Warning",n[n.Error=4]="Error",n[n.Critical=5]="Critical",n[n.None=6]="None",n}(J||{});class Vd{constructor(){}log(e,t){}}Vd.instance=new Vd;const Eee="7.0.12";class On{static isRequired(e,t){if(null==e)throw new Error(`The '${t}' argument is required.`)}static isNotEmpty(e,t){if(!e||e.match(/^\s*$/))throw new Error(`The '${t}' argument should not be empty.`)}static isIn(e,t,i){if(!(e in t))throw new Error(`Unknown ${i} value: ${e}.`)}}class Fn{static get isBrowser(){return"object"==typeof window&&"object"==typeof window.document}static get isWebWorker(){return"object"==typeof self&&"importScripts"in self}static get isReactNative(){return"object"==typeof window&&typeof window.document>"u"}static get isNode(){return!this.isBrowser&&!this.isWebWorker&&!this.isReactNative}}function Hd(n,e){let t="";return zd(n)?(t=`Binary data of length ${n.byteLength}`,e&&(t+=`. Content: '${function bee(n){const e=new Uint8Array(n);let t="";return e.forEach(i=>{t+=`0x${i<16?"0":""}${i.toString(16)} `}),t.substr(0,t.length-1)}(n)}'`)):"string"==typeof n&&(t=`String data of length ${n.length}`,e&&(t+=`. Content: '${n}'`)),t}function zd(n){return n&&typeof ArrayBuffer<"u"&&(n instanceof ArrayBuffer||n.constructor&&"ArrayBuffer"===n.constructor.name)}function yO(n,e,t,i,r,s){return jb.apply(this,arguments)}function jb(){return(jb=Xt(function*(n,e,t,i,r,s){const o={},[a,l]=Mc();o[a]=l,n.log(J.Trace,`(${e} transport) sending data. ${Hd(r,s.logMessageContent)}.`);const c=zd(r)?"arraybuffer":"text",u=yield t.post(i,{content:r,headers:{...o,...s.headers},responseType:c,timeout:s.timeout,withCredentials:s.withCredentials});n.log(J.Trace,`(${e} transport) request complete. Response status: ${u.statusCode}.`)})).apply(this,arguments)}class wee{constructor(e,t){this._subject=e,this._observer=t}dispose(){const e=this._subject.observers.indexOf(this._observer);e>-1&&this._subject.observers.splice(e,1),0===this._subject.observers.length&&this._subject.cancelCallback&&this._subject.cancelCallback().catch(t=>{})}}class eg{constructor(e){this._minLevel=e,this.out=console}log(e,t){if(e>=this._minLevel){const i=`[${(new Date).toISOString()}] ${J[e]}: ${t}`;switch(e){case J.Critical:case J.Error:this.out.error(i);break;case J.Warning:this.out.warn(i);break;case J.Information:this.out.info(i);break;default:this.out.log(i)}}}}function Mc(){let n="X-SignalR-User-Agent";return Fn.isNode&&(n="User-Agent"),[n,Mee(Eee,xee(),Fn.isNode?"NodeJS":"Browser",Cee())]}function Mee(n,e,t,i){let r="Microsoft SignalR/";const s=n.split(".");return r+=`${s[0]}.${s[1]}`,r+=` (${n}; `,r+=e&&""!==e?`${e}; `:"Unknown OS; ",r+=`${t}`,r+=i?`; ${i}`:"; Unknown Runtime Version",r+=")",r}function xee(){if(!Fn.isNode)return"";switch(process.platform){case"win32":return"Windows NT";case"darwin":return"macOS";case"linux":return"Linux";default:return process.platform}}function Cee(){if(Fn.isNode)return process.versions.node}function _O(n){return n.stack?n.stack:n.message?n.message:`${n}`}class Dee extends Qm{constructor(e){if(super(),this._logger=e,typeof fetch>"u"){const t=require;this._jar=new(t("tough-cookie").CookieJar),this._fetchType=t("node-fetch"),this._fetchType=t("fetch-cookie")(this._fetchType,this._jar)}else this._fetchType=fetch.bind(function Aee(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("could not find global")}());if(typeof AbortController>"u"){const t=require;this._abortControllerType=t("abort-controller")}else this._abortControllerType=AbortController}send(e){var t=this;return Xt(function*(){if(e.abortSignal&&e.abortSignal.aborted)throw new Ar;if(!e.method)throw new Error("No method defined.");if(!e.url)throw new Error("No url defined.");const i=new t._abortControllerType;let r;e.abortSignal&&(e.abortSignal.onabort=()=>{i.abort(),r=new Ar});let o,s=null;e.timeout&&(s=setTimeout(()=>{i.abort(),t._logger.log(J.Warning,"Timeout from HTTP request."),r=new Wb},e.timeout)),""===e.content&&(e.content=void 0),e.content&&(e.headers=e.headers||{},e.headers["Content-Type"]=zd(e.content)?"application/octet-stream":"text/plain;charset=UTF-8");try{o=yield t._fetchType(e.url,{body:e.content,cache:"no-cache",credentials:!0===e.withCredentials?"include":"same-origin",headers:{"X-Requested-With":"XMLHttpRequest",...e.headers},method:e.method,mode:"cors",redirect:"follow",signal:i.signal})}catch(c){throw r||(t._logger.log(J.Warning,`Error from HTTP request. ${c}.`),c)}finally{s&&clearTimeout(s),e.abortSignal&&(e.abortSignal.onabort=null)}if(!o.ok){const c=yield vO(o,"text");throw new wc(c||o.statusText,o.status)}const l=yield vO(o,e.responseType);return new gO(o.status,o.statusText,l)})()}getCookieString(e){let t="";return Fn.isNode&&this._jar&&this._jar.getCookies(e,(i,r)=>t=r.join("; ")),t}}function vO(n,e){let t;switch(e){case"arraybuffer":t=n.arrayBuffer();break;case"text":default:t=n.text();break;case"blob":case"document":case"json":throw new Error(`${e} is not supported.`)}return t}class Iee extends Qm{constructor(e){super(),this._logger=e}send(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new Ar):e.method?e.url?new Promise((t,i)=>{const r=new XMLHttpRequest;r.open(e.method,e.url,!0),r.withCredentials=void 0===e.withCredentials||e.withCredentials,r.setRequestHeader("X-Requested-With","XMLHttpRequest"),""===e.content&&(e.content=void 0),e.content&&(zd(e.content)?r.setRequestHeader("Content-Type","application/octet-stream"):r.setRequestHeader("Content-Type","text/plain;charset=UTF-8"));const s=e.headers;s&&Object.keys(s).forEach(o=>{r.setRequestHeader(o,s[o])}),e.responseType&&(r.responseType=e.responseType),e.abortSignal&&(e.abortSignal.onabort=()=>{r.abort(),i(new Ar)}),e.timeout&&(r.timeout=e.timeout),r.onload=()=>{e.abortSignal&&(e.abortSignal.onabort=null),r.status>=200&&r.status<300?t(new gO(r.status,r.statusText,r.response||r.responseText)):i(new wc(r.response||r.responseText||r.statusText,r.status))},r.onerror=()=>{this._logger.log(J.Warning,`Error from HTTP request. ${r.status}: ${r.statusText}.`),i(new wc(r.statusText,r.status))},r.ontimeout=()=>{this._logger.log(J.Warning,"Timeout from HTTP request."),i(new Wb)},r.send(e.content)}):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}}class Ree extends Qm{constructor(e){if(super(),typeof fetch<"u"||Fn.isNode)this._httpClient=new Dee(e);else{if(!(typeof XMLHttpRequest<"u"))throw new Error("No usable HttpClient found.");this._httpClient=new Iee(e)}}send(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new Ar):e.method?e.url?this._httpClient.send(e):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}getCookieString(e){return this._httpClient.getCookieString(e)}}var Wn=function(n){return n[n.None=0]="None",n[n.WebSockets=1]="WebSockets",n[n.ServerSentEvents=2]="ServerSentEvents",n[n.LongPolling=4]="LongPolling",n}(Wn||{}),pi=function(n){return n[n.Text=1]="Text",n[n.Binary=2]="Binary",n}(pi||{});class Pee{constructor(){this._isAborted=!1,this.onabort=null}abort(){this._isAborted||(this._isAborted=!0,this.onabort&&this.onabort())}get signal(){return this}get aborted(){return this._isAborted}}class EO{constructor(e,t,i){this._httpClient=e,this._logger=t,this._pollAbort=new Pee,this._options=i,this._running=!1,this.onreceive=null,this.onclose=null}get pollAborted(){return this._pollAbort.aborted}connect(e,t){var i=this;return Xt(function*(){if(On.isRequired(e,"url"),On.isRequired(t,"transferFormat"),On.isIn(t,pi,"transferFormat"),i._url=e,i._logger.log(J.Trace,"(LongPolling transport) Connecting."),t===pi.Binary&&typeof XMLHttpRequest<"u"&&"string"!=typeof(new XMLHttpRequest).responseType)throw new Error("Binary protocols over XmlHttpRequest not implementing advanced features are not supported.");const[r,s]=Mc(),o={[r]:s,...i._options.headers},a={abortSignal:i._pollAbort.signal,headers:o,timeout:1e5,withCredentials:i._options.withCredentials};t===pi.Binary&&(a.responseType="arraybuffer");const l=`${e}&_=${Date.now()}`;i._logger.log(J.Trace,`(LongPolling transport) polling: ${l}.`);const c=yield i._httpClient.get(l,a);200!==c.statusCode?(i._logger.log(J.Error,`(LongPolling transport) Unexpected response code: ${c.statusCode}.`),i._closeError=new wc(c.statusText||"",c.statusCode),i._running=!1):i._running=!0,i._receiving=i._poll(i._url,a)})()}_poll(e,t){var i=this;return Xt(function*(){try{for(;i._running;)try{const r=`${e}&_=${Date.now()}`;i._logger.log(J.Trace,`(LongPolling transport) polling: ${r}.`);const s=yield i._httpClient.get(r,t);204===s.statusCode?(i._logger.log(J.Information,"(LongPolling transport) Poll terminated by server."),i._running=!1):200!==s.statusCode?(i._logger.log(J.Error,`(LongPolling transport) Unexpected response code: ${s.statusCode}.`),i._closeError=new wc(s.statusText||"",s.statusCode),i._running=!1):s.content?(i._logger.log(J.Trace,`(LongPolling transport) data received. ${Hd(s.content,i._options.logMessageContent)}.`),i.onreceive&&i.onreceive(s.content)):i._logger.log(J.Trace,"(LongPolling transport) Poll timed out, reissuing.")}catch(r){i._running?r instanceof Wb?i._logger.log(J.Trace,"(LongPolling transport) Poll timed out, reissuing."):(i._closeError=r,i._running=!1):i._logger.log(J.Trace,`(LongPolling transport) Poll errored after shutdown: ${r.message}`)}}finally{i._logger.log(J.Trace,"(LongPolling transport) Polling complete."),i.pollAborted||i._raiseOnClose()}})()}send(e){var t=this;return Xt(function*(){return t._running?yO(t._logger,"LongPolling",t._httpClient,t._url,e,t._options):Promise.reject(new Error("Cannot send until the transport is connected"))})()}stop(){var e=this;return Xt(function*(){e._logger.log(J.Trace,"(LongPolling transport) Stopping polling."),e._running=!1,e._pollAbort.abort();try{yield e._receiving,e._logger.log(J.Trace,`(LongPolling transport) sending DELETE request to ${e._url}.`);const t={},[i,r]=Mc();t[i]=r;const s={headers:{...t,...e._options.headers},timeout:e._options.timeout,withCredentials:e._options.withCredentials};yield e._httpClient.delete(e._url,s),e._logger.log(J.Trace,"(LongPolling transport) DELETE request sent.")}finally{e._logger.log(J.Trace,"(LongPolling transport) Stop finished."),e._raiseOnClose()}})()}_raiseOnClose(){if(this.onclose){let e="(LongPolling transport) Firing onclose event.";this._closeError&&(e+=" Error: "+this._closeError),this._logger.log(J.Trace,e),this.onclose(this._closeError)}}}class Nee{constructor(e,t,i,r){this._httpClient=e,this._accessToken=t,this._logger=i,this._options=r,this.onreceive=null,this.onclose=null}connect(e,t){var i=this;return Xt(function*(){return On.isRequired(e,"url"),On.isRequired(t,"transferFormat"),On.isIn(t,pi,"transferFormat"),i._logger.log(J.Trace,"(SSE transport) Connecting."),i._url=e,i._accessToken&&(e+=(e.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(i._accessToken)}`),new Promise((r,s)=>{let a,o=!1;if(t===pi.Text){if(Fn.isBrowser||Fn.isWebWorker)a=new i._options.EventSource(e,{withCredentials:i._options.withCredentials});else{const l=i._httpClient.getCookieString(e),c={};c.Cookie=l;const[u,d]=Mc();c[u]=d,a=new i._options.EventSource(e,{withCredentials:i._options.withCredentials,headers:{...c,...i._options.headers}})}try{a.onmessage=l=>{if(i.onreceive)try{i._logger.log(J.Trace,`(SSE transport) data received. ${Hd(l.data,i._options.logMessageContent)}.`),i.onreceive(l.data)}catch(c){return void i._close(c)}},a.onerror=l=>{o?i._close():s(new Error("EventSource failed to connect. The connection could not be found on the server, either the connection ID is not present on the server, or a proxy is refusing/buffering the connection. If you have multiple servers check that sticky sessions are enabled."))},a.onopen=()=>{i._logger.log(J.Information,`SSE connected to ${i._url}`),i._eventSource=a,o=!0,r()}}catch(l){return void s(l)}}else s(new Error("The Server-Sent Events transport only supports the 'Text' transfer format"))})})()}send(e){var t=this;return Xt(function*(){return t._eventSource?yO(t._logger,"SSE",t._httpClient,t._url,e,t._options):Promise.reject(new Error("Cannot send until the transport is connected"))})()}stop(){return this._close(),Promise.resolve()}_close(e){this._eventSource&&(this._eventSource.close(),this._eventSource=void 0,this.onclose&&this.onclose(e))}}class Lee{constructor(e,t,i,r,s,o){this._logger=i,this._accessTokenFactory=t,this._logMessageContent=r,this._webSocketConstructor=s,this._httpClient=e,this.onreceive=null,this.onclose=null,this._headers=o}connect(e,t){var i=this;return Xt(function*(){let r;return On.isRequired(e,"url"),On.isRequired(t,"transferFormat"),On.isIn(t,pi,"transferFormat"),i._logger.log(J.Trace,"(WebSockets transport) Connecting."),i._accessTokenFactory&&(r=yield i._accessTokenFactory()),new Promise((s,o)=>{let a;e=e.replace(/^http/,"ws");const l=i._httpClient.getCookieString(e);let c=!1;if(Fn.isNode||Fn.isReactNative){const u={},[d,h]=Mc();u[d]=h,r&&(u[Bd.Authorization]=`Bearer ${r}`),l&&(u[Bd.Cookie]=l),a=new i._webSocketConstructor(e,void 0,{headers:{...u,...i._headers}})}else r&&(e+=(e.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(r)}`);a||(a=new i._webSocketConstructor(e)),t===pi.Binary&&(a.binaryType="arraybuffer"),a.onopen=u=>{i._logger.log(J.Information,`WebSocket connected to ${e}.`),i._webSocket=a,c=!0,s()},a.onerror=u=>{let d=null;d=typeof ErrorEvent<"u"&&u instanceof ErrorEvent?u.error:"There was an error with the transport",i._logger.log(J.Information,`(WebSockets transport) ${d}.`)},a.onmessage=u=>{if(i._logger.log(J.Trace,`(WebSockets transport) data received. ${Hd(u.data,i._logMessageContent)}.`),i.onreceive)try{i.onreceive(u.data)}catch(d){return void i._close(d)}},a.onclose=u=>{if(c)i._close(u);else{let d=null;d=typeof ErrorEvent<"u"&&u instanceof ErrorEvent?u.error:"WebSocket failed to connect. The connection could not be found on the server, either the endpoint may not be a SignalR endpoint, the connection ID is not present on the server, or there is a proxy blocking WebSockets. If you have multiple servers check that sticky sessions are enabled.",o(new Error(d))}}})})()}send(e){return this._webSocket&&this._webSocket.readyState===this._webSocketConstructor.OPEN?(this._logger.log(J.Trace,`(WebSockets transport) sending data. ${Hd(e,this._logMessageContent)}.`),this._webSocket.send(e),Promise.resolve()):Promise.reject("WebSocket is not in the OPEN state")}stop(){return this._webSocket&&this._close(void 0),Promise.resolve()}_close(e){this._webSocket&&(this._webSocket.onclose=()=>{},this._webSocket.onmessage=()=>{},this._webSocket.onerror=()=>{},this._webSocket.close(),this._webSocket=void 0),this._logger.log(J.Trace,"(WebSockets transport) socket closed."),this.onclose&&(!this._isCloseEvent(e)||!1!==e.wasClean&&1e3===e.code?e instanceof Error?this.onclose(e):this.onclose():this.onclose(new Error(`WebSocket closed with status code: ${e.code} (${e.reason||"no reason given"}).`)))}_isCloseEvent(e){return e&&"boolean"==typeof e.wasClean&&"number"==typeof e.code}}class Oee{constructor(e,t={}){if(this._stopPromiseResolver=()=>{},this.features={},this._negotiateVersion=1,On.isRequired(e,"url"),this._logger=function See(n){return void 0===n?new eg(J.Information):null===n?Vd.instance:void 0!==n.log?n:new eg(n)}(t.logger),this.baseUrl=this._resolveUrl(e),(t=t||{}).logMessageContent=void 0!==t.logMessageContent&&t.logMessageContent,"boolean"!=typeof t.withCredentials&&void 0!==t.withCredentials)throw new Error("withCredentials option was not a 'boolean' or 'undefined' value");t.withCredentials=void 0===t.withCredentials||t.withCredentials,t.timeout=void 0===t.timeout?1e5:t.timeout;let i=null,r=null;if(Fn.isNode){const s=require;i=s("ws"),r=s("eventsource")}!Fn.isNode&&typeof WebSocket<"u"&&!t.WebSocket?t.WebSocket=WebSocket:Fn.isNode&&!t.WebSocket&&i&&(t.WebSocket=i),!Fn.isNode&&typeof EventSource<"u"&&!t.EventSource?t.EventSource=EventSource:Fn.isNode&&!t.EventSource&&typeof r<"u"&&(t.EventSource=r),this._httpClient=new pee(t.httpClient||new Ree(this._logger),t.accessTokenFactory),this._connectionState="Disconnected",this._connectionStarted=!1,this._options=t,this.onreceive=null,this.onclose=null}start(e){var t=this;return Xt(function*(){if(On.isIn(e=e||pi.Binary,pi,"transferFormat"),t._logger.log(J.Debug,`Starting connection with transfer format '${pi[e]}'.`),"Disconnected"!==t._connectionState)return Promise.reject(new Error("Cannot start an HttpConnection that is not in the 'Disconnected' state."));if(t._connectionState="Connecting",t._startInternalPromise=t._startInternal(e),yield t._startInternalPromise,"Disconnecting"===t._connectionState){const i="Failed to start the HttpConnection before stop() was called.";return t._logger.log(J.Error,i),yield t._stopPromise,Promise.reject(new Ar(i))}if("Connected"!==t._connectionState){const i="HttpConnection.startInternal completed gracefully but didn't enter the connection into the connected state!";return t._logger.log(J.Error,i),Promise.reject(new Ar(i))}t._connectionStarted=!0})()}send(e){return"Connected"!==this._connectionState?Promise.reject(new Error("Cannot send data if the connection is not in the 'Connected' State.")):(this._sendQueue||(this._sendQueue=new $b(this.transport)),this._sendQueue.send(e))}stop(e){var t=this;return Xt(function*(){return"Disconnected"===t._connectionState?(t._logger.log(J.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnected state.`),Promise.resolve()):"Disconnecting"===t._connectionState?(t._logger.log(J.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnecting state.`),t._stopPromise):(t._connectionState="Disconnecting",t._stopPromise=new Promise(i=>{t._stopPromiseResolver=i}),yield t._stopInternal(e),void(yield t._stopPromise))})()}_stopInternal(e){var t=this;return Xt(function*(){t._stopError=e;try{yield t._startInternalPromise}catch{}if(t.transport){try{yield t.transport.stop()}catch(i){t._logger.log(J.Error,`HttpConnection.transport.stop() threw error '${i}'.`),t._stopConnection()}t.transport=void 0}else t._logger.log(J.Debug,"HttpConnection.transport is undefined in HttpConnection.stop() because start() failed.")})()}_startInternal(e){var t=this;return Xt(function*(){let i=t.baseUrl;t._accessTokenFactory=t._options.accessTokenFactory,t._httpClient._accessTokenFactory=t._accessTokenFactory;try{if(t._options.skipNegotiation){if(t._options.transport!==Wn.WebSockets)throw new Error("Negotiation can only be skipped when using the WebSocket transport directly.");t.transport=t._constructTransport(Wn.WebSockets),yield t._startTransport(i,e)}else{let r=null,s=0;do{if(r=yield t._getNegotiationResponse(i),"Disconnecting"===t._connectionState||"Disconnected"===t._connectionState)throw new Ar("The connection was stopped during negotiation.");if(r.error)throw new Error(r.error);if(r.ProtocolVersion)throw new Error("Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.");if(r.url&&(i=r.url),r.accessToken){const o=r.accessToken;t._accessTokenFactory=()=>o,t._httpClient._accessToken=o,t._httpClient._accessTokenFactory=void 0}s++}while(r.url&&s<100);if(100===s&&r.url)throw new Error("Negotiate redirection limit exceeded.");yield t._createTransport(i,t._options.transport,r,e)}t.transport instanceof EO&&(t.features.inherentKeepAlive=!0),"Connecting"===t._connectionState&&(t._logger.log(J.Debug,"The HttpConnection connected successfully."),t._connectionState="Connected")}catch(r){return t._logger.log(J.Error,"Failed to start the connection: "+r),t._connectionState="Disconnected",t.transport=void 0,t._stopPromiseResolver(),Promise.reject(r)}})()}_getNegotiationResponse(e){var t=this;return Xt(function*(){const i={},[r,s]=Mc();i[r]=s;const o=t._resolveNegotiateUrl(e);t._logger.log(J.Debug,`Sending negotiation request: ${o}.`);try{const a=yield t._httpClient.post(o,{content:"",headers:{...i,...t._options.headers},timeout:t._options.timeout,withCredentials:t._options.withCredentials});if(200!==a.statusCode)return Promise.reject(new Error(`Unexpected status code returned from negotiate '${a.statusCode}'`));const l=JSON.parse(a.content);return(!l.negotiateVersion||l.negotiateVersion<1)&&(l.connectionToken=l.connectionId),l}catch(a){let l="Failed to complete negotiation with the server: "+a;return a instanceof wc&&404===a.statusCode&&(l+=" Either this is not a SignalR endpoint or there is a proxy blocking the connection."),t._logger.log(J.Error,l),Promise.reject(new _ee(l))}})()}_createConnectUrl(e,t){return t?e+(-1===e.indexOf("?")?"?":"&")+`id=${t}`:e}_createTransport(e,t,i,r){var s=this;return Xt(function*(){let o=s._createConnectUrl(e,i.connectionToken);if(s._isITransport(t))return s._logger.log(J.Debug,"Connection was provided an instance of ITransport, using that directly."),s.transport=t,yield s._startTransport(o,r),void(s.connectionId=i.connectionId);const a=[],l=i.availableTransports||[];let c=i;for(const u of l){const d=s._resolveTransportOrError(u,t,r);if(d instanceof Error)a.push(`${u.transport} failed:`),a.push(d);else if(s._isITransport(d)){if(s.transport=d,!c){try{c=yield s._getNegotiationResponse(e)}catch(h){return Promise.reject(h)}o=s._createConnectUrl(e,c.connectionToken)}try{return yield s._startTransport(o,r),void(s.connectionId=c.connectionId)}catch(h){if(s._logger.log(J.Error,`Failed to start the transport '${u.transport}': ${h}`),c=void 0,a.push(new yee(`${u.transport} failed: ${h}`,Wn[u.transport])),"Connecting"!==s._connectionState){const f="Failed to select transport before stop() was called.";return s._logger.log(J.Debug,f),Promise.reject(new Ar(f))}}}}return Promise.reject(a.length>0?new vee(`Unable to connect to the server with any of the available transports. ${a.join(" ")}`,a):new Error("None of the transports supported by the client are supported by the server."))})()}_constructTransport(e){switch(e){case Wn.WebSockets:if(!this._options.WebSocket)throw new Error("'WebSocket' is not supported in your environment.");return new Lee(this._httpClient,this._accessTokenFactory,this._logger,this._options.logMessageContent,this._options.WebSocket,this._options.headers||{});case Wn.ServerSentEvents:if(!this._options.EventSource)throw new Error("'EventSource' is not supported in your environment.");return new Nee(this._httpClient,this._httpClient._accessToken,this._logger,this._options);case Wn.LongPolling:return new EO(this._httpClient,this._logger,this._options);default:throw new Error(`Unknown transport: ${e}.`)}}_startTransport(e,t){return this.transport.onreceive=this.onreceive,this.transport.onclose=i=>this._stopConnection(i),this.transport.connect(e,t)}_resolveTransportOrError(e,t,i){const r=Wn[e.transport];if(null==r)return this._logger.log(J.Debug,`Skipping transport '${e.transport}' because it is not supported by this client.`),new Error(`Skipping transport '${e.transport}' because it is not supported by this client.`);if(!function Fee(n,e){return!n||0!=(e&n)}(t,r))return this._logger.log(J.Debug,`Skipping transport '${Wn[r]}' because it was disabled by the client.`),new gee(`'${Wn[r]}' is disabled by the client.`,r);if(!(e.transferFormats.map(o=>pi[o]).indexOf(i)>=0))return this._logger.log(J.Debug,`Skipping transport '${Wn[r]}' because it does not support the requested transfer format '${pi[i]}'.`),new Error(`'${Wn[r]}' does not support ${pi[i]}.`);if(r===Wn.WebSockets&&!this._options.WebSocket||r===Wn.ServerSentEvents&&!this._options.EventSource)return this._logger.log(J.Debug,`Skipping transport '${Wn[r]}' because it is not supported in your environment.'`),new mee(`'${Wn[r]}' is not supported in your environment.`,r);this._logger.log(J.Debug,`Selecting transport '${Wn[r]}'.`);try{return this._constructTransport(r)}catch(o){return o}}_isITransport(e){return e&&"object"==typeof e&&"connect"in e}_stopConnection(e){if(this._logger.log(J.Debug,`HttpConnection.stopConnection(${e}) called while in state ${this._connectionState}.`),this.transport=void 0,e=this._stopError||e,this._stopError=void 0,"Disconnected"!==this._connectionState){if("Connecting"===this._connectionState)throw this._logger.log(J.Warning,`Call to HttpConnection.stopConnection(${e}) was ignored because the connection is still in the connecting state.`),new Error(`HttpConnection.stopConnection(${e}) was called while the connection is still in the connecting state.`);if("Disconnecting"===this._connectionState&&this._stopPromiseResolver(),e?this._logger.log(J.Error,`Connection disconnected with error '${e}'.`):this._logger.log(J.Information,"Connection disconnected."),this._sendQueue&&(this._sendQueue.stop().catch(t=>{this._logger.log(J.Error,`TransportSendQueue.stop() threw error '${t}'.`)}),this._sendQueue=void 0),this.connectionId=void 0,this._connectionState="Disconnected",this._connectionStarted){this._connectionStarted=!1;try{this.onclose&&this.onclose(e)}catch(t){this._logger.log(J.Error,`HttpConnection.onclose(${e}) threw error '${t}'.`)}}}else this._logger.log(J.Debug,`Call to HttpConnection.stopConnection(${e}) was ignored because the connection is already in the disconnected state.`)}_resolveUrl(e){if(0===e.lastIndexOf("https://",0)||0===e.lastIndexOf("http://",0))return e;if(!Fn.isBrowser)throw new Error(`Cannot resolve '${e}'.`);const t=window.document.createElement("a");return t.href=e,this._logger.log(J.Information,`Normalizing '${e}' to '${t.href}'.`),t.href}_resolveNegotiateUrl(e){const t=e.indexOf("?");let i=e.substring(0,-1===t?e.length:t);return"/"!==i[i.length-1]&&(i+="/"),i+="negotiate",i+=-1===t?"":e.substring(t),-1===i.indexOf("negotiateVersion")&&(i+=-1===t?"?":"&",i+="negotiateVersion="+this._negotiateVersion),i}}class $b{constructor(e){this._transport=e,this._buffer=[],this._executing=!0,this._sendBufferedData=new tg,this._transportResult=new tg,this._sendLoopPromise=this._sendLoop()}send(e){return this._bufferData(e),this._transportResult||(this._transportResult=new tg),this._transportResult.promise}stop(){return this._executing=!1,this._sendBufferedData.resolve(),this._sendLoopPromise}_bufferData(e){if(this._buffer.length&&typeof this._buffer[0]!=typeof e)throw new Error(`Expected data to be of type ${typeof this._buffer} but was of type ${typeof e}`);this._buffer.push(e),this._sendBufferedData.resolve()}_sendLoop(){var e=this;return Xt(function*(){for(;;){if(yield e._sendBufferedData.promise,!e._executing){e._transportResult&&e._transportResult.reject("Connection stopped.");break}e._sendBufferedData=new tg;const t=e._transportResult;e._transportResult=void 0;const i="string"==typeof e._buffer[0]?e._buffer.join(""):$b._concatBuffers(e._buffer);e._buffer.length=0;try{yield e._transport.send(i),t.resolve()}catch(r){t.reject(r)}}})()}static _concatBuffers(e){const t=e.map(s=>s.byteLength).reduce((s,o)=>s+o),i=new Uint8Array(t);let r=0;for(const s of e)i.set(new Uint8Array(s),r),r+=s.byteLength;return i.buffer}}class tg{constructor(){this.promise=new Promise((e,t)=>[this._resolver,this._rejecter]=[e,t])}resolve(){this._resolver()}reject(e){this._rejecter(e)}}class Ki{static write(e){return`${e}${Ki.RecordSeparator}`}static parse(e){if(e[e.length-1]!==Ki.RecordSeparator)throw new Error("Message is incomplete.");const t=e.split(Ki.RecordSeparator);return t.pop(),t}}Ki.RecordSeparatorCode=30,Ki.RecordSeparator=String.fromCharCode(Ki.RecordSeparatorCode);class kee{writeHandshakeRequest(e){return Ki.write(JSON.stringify(e))}parseHandshakeResponse(e){let t,i;if(zd(e)){const a=new Uint8Array(e),l=a.indexOf(Ki.RecordSeparatorCode);if(-1===l)throw new Error("Message is incomplete.");const c=l+1;t=String.fromCharCode.apply(null,Array.prototype.slice.call(a.slice(0,c))),i=a.byteLength>c?a.slice(c).buffer:null}else{const a=e,l=a.indexOf(Ki.RecordSeparator);if(-1===l)throw new Error("Message is incomplete.");const c=l+1;t=a.substring(0,c),i=a.length>c?a.substring(c):null}const r=Ki.parse(t),s=JSON.parse(r[0]);if(s.type)throw new Error("Expected a handshake response from the server.");return[i,s]}}var Wt=function(n){return n[n.Invocation=1]="Invocation",n[n.StreamItem=2]="StreamItem",n[n.Completion=3]="Completion",n[n.StreamInvocation=4]="StreamInvocation",n[n.CancelInvocation=5]="CancelInvocation",n[n.Ping=6]="Ping",n[n.Close=7]="Close",n}(Wt||{});class Uee{constructor(){this.observers=[]}next(e){for(const t of this.observers)t.next(e)}error(e){for(const t of this.observers)t.error&&t.error(e)}complete(){for(const e of this.observers)e.complete&&e.complete()}subscribe(e){return this.observers.push(e),new wee(this,e)}}var on=function(n){return n.Disconnected="Disconnected",n.Connecting="Connecting",n.Connected="Connected",n.Disconnecting="Disconnecting",n.Reconnecting="Reconnecting",n}(on||{});class qb{constructor(e,t,i,r){this._nextKeepAlive=0,this._freezeEventListener=()=>{this._logger.log(J.Warning,"The page is being frozen, this will likely lead to the connection being closed and messages being lost. For more information see the docs at https://docs.microsoft.com/aspnet/core/signalr/javascript-client#bsleep")},On.isRequired(e,"connection"),On.isRequired(t,"logger"),On.isRequired(i,"protocol"),this.serverTimeoutInMilliseconds=3e4,this.keepAliveIntervalInMilliseconds=15e3,this._logger=t,this._protocol=i,this.connection=e,this._reconnectPolicy=r,this._handshakeProtocol=new kee,this.connection.onreceive=s=>this._processIncomingData(s),this.connection.onclose=s=>this._connectionClosed(s),this._callbacks={},this._methods={},this._closedCallbacks=[],this._reconnectingCallbacks=[],this._reconnectedCallbacks=[],this._invocationId=0,this._receivedHandshakeResponse=!1,this._connectionState=on.Disconnected,this._connectionStarted=!1,this._cachedPingMessage=this._protocol.writeMessage({type:Wt.Ping})}static create(e,t,i,r){return new qb(e,t,i,r)}get state(){return this._connectionState}get connectionId(){return this.connection&&this.connection.connectionId||null}get baseUrl(){return this.connection.baseUrl||""}set baseUrl(e){if(this._connectionState!==on.Disconnected&&this._connectionState!==on.Reconnecting)throw new Error("The HubConnection must be in the Disconnected or Reconnecting state to change the url.");if(!e)throw new Error("The HubConnection url must be a valid url.");this.connection.baseUrl=e}start(){return this._startPromise=this._startWithStateTransitions(),this._startPromise}_startWithStateTransitions(){var e=this;return Xt(function*(){if(e._connectionState!==on.Disconnected)return Promise.reject(new Error("Cannot start a HubConnection that is not in the 'Disconnected' state."));e._connectionState=on.Connecting,e._logger.log(J.Debug,"Starting HubConnection.");try{yield e._startInternal(),Fn.isBrowser&&window.document.addEventListener("freeze",e._freezeEventListener),e._connectionState=on.Connected,e._connectionStarted=!0,e._logger.log(J.Debug,"HubConnection connected successfully.")}catch(t){return e._connectionState=on.Disconnected,e._logger.log(J.Debug,`HubConnection failed to start successfully because of error '${t}'.`),Promise.reject(t)}})()}_startInternal(){var e=this;return Xt(function*(){e._stopDuringStartError=void 0,e._receivedHandshakeResponse=!1;const t=new Promise((i,r)=>{e._handshakeResolver=i,e._handshakeRejecter=r});yield e.connection.start(e._protocol.transferFormat);try{const i={protocol:e._protocol.name,version:e._protocol.version};if(e._logger.log(J.Debug,"Sending handshake request."),yield e._sendMessage(e._handshakeProtocol.writeHandshakeRequest(i)),e._logger.log(J.Information,`Using HubProtocol '${e._protocol.name}'.`),e._cleanupTimeout(),e._resetTimeoutPeriod(),e._resetKeepAliveInterval(),yield t,e._stopDuringStartError)throw e._stopDuringStartError;e.connection.features.inherentKeepAlive||(yield e._sendMessage(e._cachedPingMessage))}catch(i){throw e._logger.log(J.Debug,`Hub handshake failed with error '${i}' during start(). Stopping HubConnection.`),e._cleanupTimeout(),e._cleanupPingTimer(),yield e.connection.stop(i),i}})()}stop(){var e=this;return Xt(function*(){const t=e._startPromise;e._stopPromise=e._stopInternal(),yield e._stopPromise;try{yield t}catch{}})()}_stopInternal(e){return this._connectionState===on.Disconnected?(this._logger.log(J.Debug,`Call to HubConnection.stop(${e}) ignored because it is already in the disconnected state.`),Promise.resolve()):this._connectionState===on.Disconnecting?(this._logger.log(J.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnecting state.`),this._stopPromise):(this._connectionState=on.Disconnecting,this._logger.log(J.Debug,"Stopping HubConnection."),this._reconnectDelayHandle?(this._logger.log(J.Debug,"Connection stopped during reconnect delay. Done reconnecting."),clearTimeout(this._reconnectDelayHandle),this._reconnectDelayHandle=void 0,this._completeClose(),Promise.resolve()):(this._cleanupTimeout(),this._cleanupPingTimer(),this._stopDuringStartError=e||new Ar("The connection was stopped before the hub handshake could complete."),this.connection.stop(e)))}stream(e,...t){const[i,r]=this._replaceStreamingParams(t),s=this._createStreamInvocation(e,t,r);let o;const a=new Uee;return a.cancelCallback=()=>{const l=this._createCancelInvocation(s.invocationId);return delete this._callbacks[s.invocationId],o.then(()=>this._sendWithProtocol(l))},this._callbacks[s.invocationId]=(l,c)=>{c?a.error(c):l&&(l.type===Wt.Completion?l.error?a.error(new Error(l.error)):a.complete():a.next(l.item))},o=this._sendWithProtocol(s).catch(l=>{a.error(l),delete this._callbacks[s.invocationId]}),this._launchStreams(i,o),a}_sendMessage(e){return this._resetKeepAliveInterval(),this.connection.send(e)}_sendWithProtocol(e){return this._sendMessage(this._protocol.writeMessage(e))}send(e,...t){const[i,r]=this._replaceStreamingParams(t),s=this._sendWithProtocol(this._createInvocation(e,t,!0,r));return this._launchStreams(i,s),s}invoke(e,...t){const[i,r]=this._replaceStreamingParams(t),s=this._createInvocation(e,t,!1,r);return new Promise((a,l)=>{this._callbacks[s.invocationId]=(u,d)=>{d?l(d):u&&(u.type===Wt.Completion?u.error?l(new Error(u.error)):a(u.result):l(new Error(`Unexpected message type: ${u.type}`)))};const c=this._sendWithProtocol(s).catch(u=>{l(u),delete this._callbacks[s.invocationId]});this._launchStreams(i,c)})}on(e,t){!e||!t||(e=e.toLowerCase(),this._methods[e]||(this._methods[e]=[]),-1===this._methods[e].indexOf(t)&&this._methods[e].push(t))}off(e,t){if(!e)return;e=e.toLowerCase();const i=this._methods[e];if(i)if(t){const r=i.indexOf(t);-1!==r&&(i.splice(r,1),0===i.length&&delete this._methods[e])}else delete this._methods[e]}onclose(e){e&&this._closedCallbacks.push(e)}onreconnecting(e){e&&this._reconnectingCallbacks.push(e)}onreconnected(e){e&&this._reconnectedCallbacks.push(e)}_processIncomingData(e){if(this._cleanupTimeout(),this._receivedHandshakeResponse||(e=this._processHandshakeResponse(e),this._receivedHandshakeResponse=!0),e){const t=this._protocol.parseMessages(e,this._logger);for(const i of t)switch(i.type){case Wt.Invocation:this._invokeClientMethod(i);break;case Wt.StreamItem:case Wt.Completion:{const r=this._callbacks[i.invocationId];if(r){i.type===Wt.Completion&&delete this._callbacks[i.invocationId];try{r(i)}catch(s){this._logger.log(J.Error,`Stream callback threw error: ${_O(s)}`)}}break}case Wt.Ping:break;case Wt.Close:{this._logger.log(J.Information,"Close message received from server.");const r=i.error?new Error("Server returned an error on close: "+i.error):void 0;!0===i.allowReconnect?this.connection.stop(r):this._stopPromise=this._stopInternal(r);break}default:this._logger.log(J.Warning,`Invalid message type: ${i.type}.`)}}this._resetTimeoutPeriod()}_processHandshakeResponse(e){let t,i;try{[i,t]=this._handshakeProtocol.parseHandshakeResponse(e)}catch(r){const s="Error parsing handshake response: "+r;this._logger.log(J.Error,s);const o=new Error(s);throw this._handshakeRejecter(o),o}if(t.error){const r="Server returned handshake error: "+t.error;this._logger.log(J.Error,r);const s=new Error(r);throw this._handshakeRejecter(s),s}return this._logger.log(J.Debug,"Server handshake complete."),this._handshakeResolver(),i}_resetKeepAliveInterval(){this.connection.features.inherentKeepAlive||(this._nextKeepAlive=(new Date).getTime()+this.keepAliveIntervalInMilliseconds,this._cleanupPingTimer())}_resetTimeoutPeriod(){var e=this;if(!(this.connection.features&&this.connection.features.inherentKeepAlive||(this._timeoutHandle=setTimeout(()=>this.serverTimeout(),this.serverTimeoutInMilliseconds),void 0!==this._pingServerHandle))){let t=this._nextKeepAlive-(new Date).getTime();t<0&&(t=0),this._pingServerHandle=setTimeout(Xt(function*(){if(e._connectionState===on.Connected)try{yield e._sendMessage(e._cachedPingMessage)}catch{e._cleanupPingTimer()}}),t)}}serverTimeout(){this.connection.stop(new Error("Server timeout elapsed without receiving a message from the server."))}_invokeClientMethod(e){var t=this;return Xt(function*(){const i=e.target.toLowerCase(),r=t._methods[i];if(!r)return t._logger.log(J.Warning,`No client method with the name '${i}' found.`),void(e.invocationId&&(t._logger.log(J.Warning,`No result given for '${i}' method and invocation ID '${e.invocationId}'.`),yield t._sendWithProtocol(t._createCompletionMessage(e.invocationId,"Client didn't provide a result.",null))));const s=r.slice(),o=!!e.invocationId;let a,l,c;for(const u of s)try{const d=a;a=yield u.apply(t,e.arguments),o&&a&&d&&(t._logger.log(J.Error,`Multiple results provided for '${i}'. Sending error to server.`),c=t._createCompletionMessage(e.invocationId,"Client provided multiple results.",null)),l=void 0}catch(d){l=d,t._logger.log(J.Error,`A callback for the method '${i}' threw error '${d}'.`)}c?yield t._sendWithProtocol(c):o?(l?c=t._createCompletionMessage(e.invocationId,`${l}`,null):void 0!==a?c=t._createCompletionMessage(e.invocationId,null,a):(t._logger.log(J.Warning,`No result given for '${i}' method and invocation ID '${e.invocationId}'.`),c=t._createCompletionMessage(e.invocationId,"Client didn't provide a result.",null)),yield t._sendWithProtocol(c)):a&&t._logger.log(J.Error,`Result given for '${i}' method but server is not expecting a result.`)})()}_connectionClosed(e){this._logger.log(J.Debug,`HubConnection.connectionClosed(${e}) called while in state ${this._connectionState}.`),this._stopDuringStartError=this._stopDuringStartError||e||new Ar("The underlying connection was closed before the hub handshake could complete."),this._handshakeResolver&&this._handshakeResolver(),this._cancelCallbacksWithError(e||new Error("Invocation canceled due to the underlying connection being closed.")),this._cleanupTimeout(),this._cleanupPingTimer(),this._connectionState===on.Disconnecting?this._completeClose(e):this._connectionState===on.Connected&&this._reconnectPolicy?this._reconnect(e):this._connectionState===on.Connected&&this._completeClose(e)}_completeClose(e){if(this._connectionStarted){this._connectionState=on.Disconnected,this._connectionStarted=!1,Fn.isBrowser&&window.document.removeEventListener("freeze",this._freezeEventListener);try{this._closedCallbacks.forEach(t=>t.apply(this,[e]))}catch(t){this._logger.log(J.Error,`An onclose callback called with error '${e}' threw error '${t}'.`)}}}_reconnect(e){var t=this;return Xt(function*(){const i=Date.now();let r=0,s=void 0!==e?e:new Error("Attempting to reconnect due to a unknown error."),o=t._getNextRetryDelay(r++,0,s);if(null===o)return t._logger.log(J.Debug,"Connection not reconnecting because the IRetryPolicy returned null on the first reconnect attempt."),void t._completeClose(e);if(t._connectionState=on.Reconnecting,t._logger.log(J.Information,e?`Connection reconnecting because of error '${e}'.`:"Connection reconnecting."),0!==t._reconnectingCallbacks.length){try{t._reconnectingCallbacks.forEach(a=>a.apply(t,[e]))}catch(a){t._logger.log(J.Error,`An onreconnecting callback called with error '${e}' threw error '${a}'.`)}if(t._connectionState!==on.Reconnecting)return void t._logger.log(J.Debug,"Connection left the reconnecting state in onreconnecting callback. Done reconnecting.")}for(;null!==o;){if(t._logger.log(J.Information,`Reconnect attempt number ${r} will start in ${o} ms.`),yield new Promise(a=>{t._reconnectDelayHandle=setTimeout(a,o)}),t._reconnectDelayHandle=void 0,t._connectionState!==on.Reconnecting)return void t._logger.log(J.Debug,"Connection left the reconnecting state during reconnect delay. Done reconnecting.");try{if(yield t._startInternal(),t._connectionState=on.Connected,t._logger.log(J.Information,"HubConnection reconnected successfully."),0!==t._reconnectedCallbacks.length)try{t._reconnectedCallbacks.forEach(a=>a.apply(t,[t.connection.connectionId]))}catch(a){t._logger.log(J.Error,`An onreconnected callback called with connectionId '${t.connection.connectionId}; threw error '${a}'.`)}return}catch(a){if(t._logger.log(J.Information,`Reconnect attempt failed because of error '${a}'.`),t._connectionState!==on.Reconnecting)return t._logger.log(J.Debug,`Connection moved to the '${t._connectionState}' from the reconnecting state during reconnect attempt. Done reconnecting.`),void(t._connectionState===on.Disconnecting&&t._completeClose());s=a instanceof Error?a:new Error(a.toString()),o=t._getNextRetryDelay(r++,Date.now()-i,s)}}t._logger.log(J.Information,`Reconnect retries have been exhausted after ${Date.now()-i} ms and ${r} failed attempts. Connection disconnecting.`),t._completeClose()})()}_getNextRetryDelay(e,t,i){try{return this._reconnectPolicy.nextRetryDelayInMilliseconds({elapsedMilliseconds:t,previousRetryCount:e,retryReason:i})}catch(r){return this._logger.log(J.Error,`IRetryPolicy.nextRetryDelayInMilliseconds(${e}, ${t}) threw error '${r}'.`),null}}_cancelCallbacksWithError(e){const t=this._callbacks;this._callbacks={},Object.keys(t).forEach(i=>{const r=t[i];try{r(null,e)}catch(s){this._logger.log(J.Error,`Stream 'error' callback called with '${e}' threw error: ${_O(s)}`)}})}_cleanupPingTimer(){this._pingServerHandle&&(clearTimeout(this._pingServerHandle),this._pingServerHandle=void 0)}_cleanupTimeout(){this._timeoutHandle&&clearTimeout(this._timeoutHandle)}_createInvocation(e,t,i,r){if(i)return 0!==r.length?{arguments:t,streamIds:r,target:e,type:Wt.Invocation}:{arguments:t,target:e,type:Wt.Invocation};{const s=this._invocationId;return this._invocationId++,0!==r.length?{arguments:t,invocationId:s.toString(),streamIds:r,target:e,type:Wt.Invocation}:{arguments:t,invocationId:s.toString(),target:e,type:Wt.Invocation}}}_launchStreams(e,t){if(0!==e.length){t||(t=Promise.resolve());for(const i in e)e[i].subscribe({complete:()=>{t=t.then(()=>this._sendWithProtocol(this._createCompletionMessage(i)))},error:r=>{let s;s=r instanceof Error?r.message:r&&r.toString?r.toString():"Unknown error",t=t.then(()=>this._sendWithProtocol(this._createCompletionMessage(i,s)))},next:r=>{t=t.then(()=>this._sendWithProtocol(this._createStreamItemMessage(i,r)))}})}}_replaceStreamingParams(e){const t=[],i=[];for(let r=0;r<e.length;r++){const s=e[r];if(this._isObservable(s)){const o=this._invocationId;this._invocationId++,t[o]=s,i.push(o.toString()),e.splice(r,1)}}return[t,i]}_isObservable(e){return e&&e.subscribe&&"function"==typeof e.subscribe}_createStreamInvocation(e,t,i){const r=this._invocationId;return this._invocationId++,0!==i.length?{arguments:t,invocationId:r.toString(),streamIds:i,target:e,type:Wt.StreamInvocation}:{arguments:t,invocationId:r.toString(),target:e,type:Wt.StreamInvocation}}_createCancelInvocation(e){return{invocationId:e,type:Wt.CancelInvocation}}_createStreamItemMessage(e,t){return{invocationId:e,item:t,type:Wt.StreamItem}}_createCompletionMessage(e,t,i){return t?{error:t,invocationId:e,type:Wt.Completion}:{invocationId:e,result:i,type:Wt.Completion}}}class zee{constructor(){this.name="json",this.version=1,this.transferFormat=pi.Text}parseMessages(e,t){if("string"!=typeof e)throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!e)return[];null===t&&(t=Vd.instance);const i=Ki.parse(e),r=[];for(const s of i){const o=JSON.parse(s);if("number"!=typeof o.type)throw new Error("Invalid payload.");switch(o.type){case Wt.Invocation:this._isInvocationMessage(o);break;case Wt.StreamItem:this._isStreamItemMessage(o);break;case Wt.Completion:this._isCompletionMessage(o);break;case Wt.Ping:case Wt.Close:break;default:t.log(J.Information,"Unknown message type '"+o.type+"' ignored.");continue}r.push(o)}return r}writeMessage(e){return Ki.write(JSON.stringify(e))}_isInvocationMessage(e){this._assertNotEmptyString(e.target,"Invalid payload for Invocation message."),void 0!==e.invocationId&&this._assertNotEmptyString(e.invocationId,"Invalid payload for Invocation message.")}_isStreamItemMessage(e){if(this._assertNotEmptyString(e.invocationId,"Invalid payload for StreamItem message."),void 0===e.item)throw new Error("Invalid payload for StreamItem message.")}_isCompletionMessage(e){if(e.result&&e.error)throw new Error("Invalid payload for Completion message.");!e.result&&e.error&&this._assertNotEmptyString(e.error,"Invalid payload for Completion message."),this._assertNotEmptyString(e.invocationId,"Invalid payload for Completion message.")}_assertNotEmptyString(e,t){if("string"!=typeof e||""===e)throw new Error(t)}}const Gee={trace:J.Trace,debug:J.Debug,info:J.Information,information:J.Information,warn:J.Warning,warning:J.Warning,error:J.Error,critical:J.Critical,none:J.None};class jee{configureLogging(e){if(On.isRequired(e,"logging"),function $ee(n){return void 0!==n.log}(e))this.logger=e;else if("string"==typeof e){const t=function Wee(n){const e=Gee[n.toLowerCase()];if(typeof e<"u")return e;throw new Error(`Unknown log level: ${n}`)}(e);this.logger=new eg(t)}else this.logger=new eg(e);return this}withUrl(e,t){return On.isRequired(e,"url"),On.isNotEmpty(e,"url"),this.url=e,this.httpConnectionOptions="object"==typeof t?{...this.httpConnectionOptions,...t}:{...this.httpConnectionOptions,transport:t},this}withHubProtocol(e){return On.isRequired(e,"protocol"),this.protocol=e,this}withAutomaticReconnect(e){if(this.reconnectPolicy)throw new Error("A reconnectPolicy has already been set.");return this.reconnectPolicy=e?Array.isArray(e)?new mO(e):e:new mO,this}build(){const e=this.httpConnectionOptions||{};if(void 0===e.logger&&(e.logger=this.logger),!this.url)throw new Error("The 'HubConnectionBuilder.withUrl' method must be called before building the connection.");const t=new Oee(this.url,e);return qb.create(t,this.logger||Vd.instance,this.protocol||new zee,this.reconnectPolicy)}}let qee=(()=>{class n{constructor(){}startConnection(){this.hubConnection=(new jee).withUrl("/notifications").withAutomaticReconnect().build(),this.hubConnection.start().then(()=>{console.log("Connection started"),this.hubConnection.send("SetConnectionIDUser",123)}).catch(t=>console.log("Error while starting connection: "+t))}testSendXXX1(){this.hubConnection.send("XXX1",123,"abc")}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class ng{}class ig{}class Kr{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?"string"==typeof e?this.lazyInit=()=>{this.headers=new Map,e.split("\n").forEach(t=>{const i=t.indexOf(":");if(i>0){const r=t.slice(0,i),s=r.toLowerCase(),o=t.slice(i+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,i)=>{this.setHeaderEntries(i,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,i])=>{this.setHeaderEntries(t,i)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof Kr?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new Kr;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof Kr?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(e.name,t);const r=("a"===e.op?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":const s=e.value;if(s){let o=this.headers.get(t);if(!o)return;o=o.filter(a=>-1===s.indexOf(a)),0===o.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}else this.headers.delete(t),this.normalizedNames.delete(t)}}setHeaderEntries(e,t){const i=(Array.isArray(t)?t:[t]).map(s=>s.toString()),r=e.toLowerCase();this.headers.set(r,i),this.maybeSetNormalizedName(e,r)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class Xee{encodeKey(e){return wO(e)}encodeValue(e){return wO(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const Zee=/%(\d[a-f0-9])/gi,Kee={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function wO(n){return encodeURIComponent(n).replace(Zee,(e,t)=>Kee[t]??e)}function rg(n){return`${n}`}class wo{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new Xee,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function Yee(n,e){const t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(r=>{const s=r.indexOf("="),[o,a]=-1==s?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,s)),e.decodeValue(r.slice(s+1))],l=t.get(o)||[];l.push(a),t.set(o,l)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const i=e.fromObject[t],r=Array.isArray(i)?i.map(rg):[rg(i)];this.map.set(t,r)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(i=>{const r=e[i];Array.isArray(r)?r.forEach(s=>{t.push({param:i,value:s,op:"a"})}):t.push({param:i,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new wo({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(rg(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let i=this.map.get(e.param)||[];const r=i.indexOf(rg(e.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(e.param,i):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class Jee{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function MO(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function xO(n){return typeof Blob<"u"&&n instanceof Blob}function CO(n){return typeof FormData<"u"&&n instanceof FormData}class Gd{constructor(e,t,i,r){let s;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function Qee(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,s=r):s=i,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new Kr),this.context||(this.context=new Jee),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=t;else{const a=t.indexOf("?");this.urlWithParams=t+(-1===a?"?":a<t.length-1?"&":"")+o}}else this.params=new wo,this.urlWithParams=t}serializeBody(){return null===this.body?null:MO(this.body)||xO(this.body)||CO(this.body)||function ete(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof wo?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||CO(this.body)?null:xO(this.body)?this.body.type||null:MO(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof wo?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){const t=e.method||this.method,i=e.url||this.url,r=e.responseType||this.responseType,s=void 0!==e.body?e.body:this.body,o=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,a=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let l=e.headers||this.headers,c=e.params||this.params;const u=e.context??this.context;return void 0!==e.setHeaders&&(l=Object.keys(e.setHeaders).reduce((d,h)=>d.set(h,e.setHeaders[h]),l)),e.setParams&&(c=Object.keys(e.setParams).reduce((d,h)=>d.set(h,e.setParams[h]),c)),new Gd(t,i,s,{params:c,headers:l,context:u,reportProgress:a,responseType:r,withCredentials:o})}}var xc=function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n}(xc||{});class Xb{constructor(e,t=200,i="OK"){this.headers=e.headers||new Kr,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class Yb extends Xb{constructor(e={}){super(e),this.type=xc.ResponseHeader}clone(e={}){return new Yb({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class Cc extends Xb{constructor(e={}){super(e),this.type=xc.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new Cc({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class TO extends Xb{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function Zb(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let AO=(()=>{class n{constructor(t){this.handler=t}request(t,i,r={}){let s;if(t instanceof Gd)s=t;else{let l,c;l=r.headers instanceof Kr?r.headers:new Kr(r.headers),r.params&&(c=r.params instanceof wo?r.params:new wo({fromObject:r.params})),s=new Gd(t,i,void 0!==r.body?r.body:null,{headers:l,context:r.context,params:c,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const o=je(s).pipe(Ml(l=>this.handler.handle(l)));if(t instanceof Gd||"events"===r.observe)return o;const a=o.pipe(gs(l=>l instanceof Cc));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(St(l=>{if(null!==l.body&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return a.pipe(St(l=>{if(null!==l.body&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return a.pipe(St(l=>{if(null!==l.body&&"string"!=typeof l.body)throw new Error("Response is not a string.");return l.body}));default:return a.pipe(St(l=>l.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:(new wo).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,r={}){return this.request("PATCH",t,Zb(r,i))}post(t,i,r={}){return this.request("POST",t,Zb(r,i))}put(t,i,r={}){return this.request("PUT",t,Zb(r,i))}static#e=this.\u0275fac=function(i){return new(i||n)(xe(ng))};static#t=this.\u0275prov=Pe({token:n,factory:n.\u0275fac})}return n})();function RO(n,e){return e(n)}function nte(n,e){return(t,i)=>e.intercept(t,{handle:r=>n(r,i)})}const rte=new Ce(""),Wd=new Ce(""),PO=new Ce("");function ste(){let n=null;return(e,t)=>{null===n&&(n=(we(rte,{optional:!0})??[]).reduceRight(nte,RO));const i=we(Sf),r=i.add();return n(e,t).pipe(Yu(()=>i.remove(r)))}}let NO=(()=>{class n extends ng{constructor(t,i){super(),this.backend=t,this.injector=i,this.chain=null,this.pendingTasks=we(Sf)}handle(t){if(null===this.chain){const r=Array.from(new Set([...this.injector.get(Wd),...this.injector.get(PO,[])]));this.chain=r.reduceRight((s,o)=>function ite(n,e,t){return(i,r)=>t.runInContext(()=>e(i,s=>n(s,r)))}(s,o,this.injector),RO)}const i=this.pendingTasks.add();return this.chain(t,r=>this.backend.handle(r)).pipe(Yu(()=>this.pendingTasks.remove(i)))}static#e=this.\u0275fac=function(i){return new(i||n)(xe(ig),xe(Ui))};static#t=this.\u0275prov=Pe({token:n,factory:n.\u0275fac})}return n})();const cte=/^\)\]\}',?\n/;let OO=(()=>{class n{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new j(-2800,!1);const i=this.xhrFactory;return(i.\u0275loadImpl?Mn(i.\u0275loadImpl()):je(null)).pipe(pr(()=>new ln(s=>{const o=i.build();if(o.open(t.method,t.urlWithParams),t.withCredentials&&(o.withCredentials=!0),t.headers.forEach((y,g)=>o.setRequestHeader(y,g.join(","))),t.headers.has("Accept")||o.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const y=t.detectContentTypeHeader();null!==y&&o.setRequestHeader("Content-Type",y)}if(t.responseType){const y=t.responseType.toLowerCase();o.responseType="json"!==y?y:"text"}const a=t.serializeBody();let l=null;const c=()=>{if(null!==l)return l;const y=o.statusText||"OK",g=new Kr(o.getAllResponseHeaders()),m=function ute(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}(o)||t.url;return l=new Yb({headers:g,status:o.status,statusText:y,url:m}),l},u=()=>{let{headers:y,status:g,statusText:m,url:v}=c(),_=null;204!==g&&(_=typeof o.response>"u"?o.responseText:o.response),0===g&&(g=_?200:0);let E=g>=200&&g<300;if("json"===t.responseType&&"string"==typeof _){const S=_;_=_.replace(cte,"");try{_=""!==_?JSON.parse(_):null}catch(x){_=S,E&&(E=!1,_={error:x,text:_})}}E?(s.next(new Cc({body:_,headers:y,status:g,statusText:m,url:v||void 0})),s.complete()):s.error(new TO({error:_,headers:y,status:g,statusText:m,url:v||void 0}))},d=y=>{const{url:g}=c(),m=new TO({error:y,status:o.status||0,statusText:o.statusText||"Unknown Error",url:g||void 0});s.error(m)};let h=!1;const f=y=>{h||(s.next(c()),h=!0);let g={type:xc.DownloadProgress,loaded:y.loaded};y.lengthComputable&&(g.total=y.total),"text"===t.responseType&&o.responseText&&(g.partialText=o.responseText),s.next(g)},p=y=>{let g={type:xc.UploadProgress,loaded:y.loaded};y.lengthComputable&&(g.total=y.total),s.next(g)};return o.addEventListener("load",u),o.addEventListener("error",d),o.addEventListener("timeout",d),o.addEventListener("abort",d),t.reportProgress&&(o.addEventListener("progress",f),null!==a&&o.upload&&o.upload.addEventListener("progress",p)),o.send(a),s.next({type:xc.Sent}),()=>{o.removeEventListener("error",d),o.removeEventListener("abort",d),o.removeEventListener("load",u),o.removeEventListener("timeout",d),t.reportProgress&&(o.removeEventListener("progress",f),null!==a&&o.upload&&o.upload.removeEventListener("progress",p)),o.readyState!==o.DONE&&o.abort()}})))}static#e=this.\u0275fac=function(i){return new(i||n)(xe(BD))};static#t=this.\u0275prov=Pe({token:n,factory:n.\u0275fac})}return n})();const Kb=new Ce("XSRF_ENABLED"),FO=new Ce("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),kO=new Ce("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class UO{}let fte=(()=>{class n{constructor(t,i,r){this.doc=t,this.platform=i,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=ID(t,this.cookieName),this.lastCookieString=t),this.lastToken}static#e=this.\u0275fac=function(i){return new(i||n)(xe(Yn),xe(js),xe(FO))};static#t=this.\u0275prov=Pe({token:n,factory:n.\u0275fac})}return n})();function pte(n,e){const t=n.url.toLowerCase();if(!we(Kb)||"GET"===n.method||"HEAD"===n.method||t.startsWith("http://")||t.startsWith("https://"))return e(n);const i=we(UO).getToken(),r=we(kO);return null!=i&&!n.headers.has(r)&&(n=n.clone({headers:n.headers.set(r,i)})),e(n)}var Mo=function(n){return n[n.Interceptors=0]="Interceptors",n[n.LegacyInterceptors=1]="LegacyInterceptors",n[n.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",n[n.NoXsrfProtection=3]="NoXsrfProtection",n[n.JsonpSupport=4]="JsonpSupport",n[n.RequestsMadeViaParent=5]="RequestsMadeViaParent",n[n.Fetch=6]="Fetch",n}(Mo||{});function mte(...n){const e=[AO,OO,NO,{provide:ng,useExisting:NO},{provide:ig,useExisting:OO},{provide:Wd,useValue:pte,multi:!0},{provide:Kb,useValue:!0},{provide:UO,useClass:fte}];for(const t of n)e.push(...t.\u0275providers);return function Ly(n){return{\u0275providers:n}}(e)}const BO=new Ce("LEGACY_INTERCEPTOR_FN");function gte(){return function Ea(n,e){return{\u0275kind:n,\u0275providers:e}}(Mo.LegacyInterceptors,[{provide:BO,useFactory:ste},{provide:Wd,useExisting:BO,multi:!0}])}let yte=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=jn({type:n});static#n=this.\u0275inj=Un({providers:[mte(gte())]})}return n})(),wte=(()=>{class n{constructor(t){this.http=t,this.baseUrl="/api/Game"}getGameById(t){return this.http.get(this.baseUrl+`/GetGameByID?gameId=${t}`)}static#e=this.\u0275fac=function(i){return new(i||n)(xe(AO))};static#t=this.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),ei=(()=>class n{static STARTS_WITH="startsWith";static CONTAINS="contains";static NOT_CONTAINS="notContains";static ENDS_WITH="endsWith";static EQUALS="equals";static NOT_EQUALS="notEquals";static IN="in";static LESS_THAN="lt";static LESS_THAN_OR_EQUAL_TO="lte";static GREATER_THAN="gt";static GREATER_THAN_OR_EQUAL_TO="gte";static BETWEEN="between";static IS="is";static IS_NOT="isNot";static BEFORE="before";static AFTER="after";static DATE_IS="dateIs";static DATE_IS_NOT="dateIsNot";static DATE_BEFORE="dateBefore";static DATE_AFTER="dateAfter"})(),xte=(()=>{class n{ripple=!1;overlayOptions={};filterMatchModeOptions={text:[ei.STARTS_WITH,ei.CONTAINS,ei.NOT_CONTAINS,ei.ENDS_WITH,ei.EQUALS,ei.NOT_EQUALS],numeric:[ei.EQUALS,ei.NOT_EQUALS,ei.LESS_THAN,ei.LESS_THAN_OR_EQUAL_TO,ei.GREATER_THAN,ei.GREATER_THAN_OR_EQUAL_TO],date:[ei.DATE_IS,ei.DATE_IS_NOT,ei.DATE_BEFORE,ei.DATE_AFTER]};translation={startsWith:"Starts with",contains:"Contains",notContains:"Not contains",endsWith:"Ends with",equals:"Equals",notEquals:"Not equals",noFilter:"No Filter",lt:"Less than",lte:"Less than or equal to",gt:"Greater than",gte:"Greater than or equal to",is:"Is",isNot:"Is not",before:"Before",after:"After",dateIs:"Date is",dateIsNot:"Date is not",dateBefore:"Date is before",dateAfter:"Date is after",clear:"Clear",apply:"Apply",matchAll:"Match All",matchAny:"Match Any",addRule:"Add Rule",removeRule:"Remove Rule",accept:"Yes",reject:"No",choose:"Choose",upload:"Upload",cancel:"Cancel",pending:"Pending",fileSizeTypes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],chooseYear:"Choose Year",chooseMonth:"Choose Month",chooseDate:"Choose Date",prevDecade:"Previous Decade",nextDecade:"Next Decade",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",prevHour:"Previous Hour",nextHour:"Next Hour",prevMinute:"Previous Minute",nextMinute:"Next Minute",prevSecond:"Previous Second",nextSecond:"Next Second",am:"am",pm:"pm",dateFormat:"mm/dd/yy",firstDayOfWeek:0,today:"Today",weekHeader:"Wk",weak:"Weak",medium:"Medium",strong:"Strong",passwordPrompt:"Enter a password",emptyMessage:"No results found",searchMessage:"{0} results are available",selectionMessage:"{0} items selected",emptySelectionMessage:"No selected item",emptySearchMessage:"No results found",emptyFilterMessage:"No results found",aria:{trueLabel:"True",falseLabel:"False",nullLabel:"Not Selected",star:"1 star",stars:"{star} stars",selectAll:"All items selected",unselectAll:"All items unselected",close:"Close",previous:"Previous",next:"Next",navigation:"Navigation",scrollTop:"Scroll Top",moveTop:"Move Top",moveUp:"Move Up",moveDown:"Move Down",moveBottom:"Move Bottom",moveToTarget:"Move to Target",moveToSource:"Move to Source",moveAllToTarget:"Move All to Target",moveAllToSource:"Move All to Source",pageLabel:"{page}",firstPageLabel:"First Page",lastPageLabel:"Last Page",nextPageLabel:"Next Page",prevPageLabel:"Previous Page",rowsPerPageLabel:"Rows per page",previousPageLabel:"Previous Page",jumpToPageDropdownLabel:"Jump to Page Dropdown",jumpToPageInputLabel:"Jump to Page Input",selectRow:"Row Selected",unselectRow:"Row Unselected",expandRow:"Row Expanded",collapseRow:"Row Collapsed",showFilterMenu:"Show Filter Menu",hideFilterMenu:"Hide Filter Menu",filterOperator:"Filter Operator",filterConstraint:"Filter Constraint",editRow:"Row Edit",saveEdit:"Save Edit",cancelEdit:"Cancel Edit",listView:"List View",gridView:"Grid View",slide:"Slide",slideNumber:"{slideNumber}",zoomImage:"Zoom Image",zoomIn:"Zoom In",zoomOut:"Zoom Out",rotateRight:"Rotate Right",rotateLeft:"Rotate Left"}};zIndex={modal:1100,overlay:1e3,menu:1e3,tooltip:1100};translationSource=new Qi;translationObserver=this.translationSource.asObservable();getTranslation(t){return this.translation[t]}setTranslation(t){this.translation={...this.translation,...t},this.translationSource.next(this.translation)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),VO=(()=>{class n{template;type;name;constructor(t){this.template=t}getType(){return this.name}static \u0275fac=function(i){return new(i||n)(ne(Gr))};static \u0275dir=Ge({type:n,selectors:[["","pTemplate",""]],inputs:{type:"type",name:["pTemplate","name"]}})}return n})(),Jb=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=jn({type:n});static \u0275inj=Un({imports:[Fu]})}return n})();class jd{static equals(e,t,i){return i?this.resolveFieldData(e,i)===this.resolveFieldData(t,i):this.equalsByValue(e,t)}static equalsByValue(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var s,o,a,i=Array.isArray(e),r=Array.isArray(t);if(i&&r){if((o=e.length)!=t.length)return!1;for(s=o;0!=s--;)if(!this.equalsByValue(e[s],t[s]))return!1;return!0}if(i!=r)return!1;var l=this.isDate(e),c=this.isDate(t);if(l!=c)return!1;if(l&&c)return e.getTime()==t.getTime();var u=e instanceof RegExp,d=t instanceof RegExp;if(u!=d)return!1;if(u&&d)return e.toString()==t.toString();var h=Object.keys(e);if((o=h.length)!==Object.keys(t).length)return!1;for(s=o;0!=s--;)if(!Object.prototype.hasOwnProperty.call(t,h[s]))return!1;for(s=o;0!=s--;)if(!this.equalsByValue(e[a=h[s]],t[a]))return!1;return!0}return e!=e&&t!=t}static resolveFieldData(e,t){if(e&&t){if(this.isFunction(t))return t(e);if(-1==t.indexOf("."))return e[t];{let i=t.split("."),r=e;for(let s=0,o=i.length;s<o;++s){if(null==r)return null;r=r[i[s]]}return r}}return null}static isFunction(e){return!!(e&&e.constructor&&e.call&&e.apply)}static reorderArray(e,t,i){e&&t!==i&&(i>=e.length&&(i%=e.length,t%=e.length),e.splice(i,0,e.splice(t,1)[0]))}static insertIntoOrderedArray(e,t,i,r){if(i.length>0){let s=!1;for(let o=0;o<i.length;o++)if(this.findIndexInList(i[o],r)>t){i.splice(o,0,e),s=!0;break}s||i.push(e)}else i.push(e)}static findIndexInList(e,t){let i=-1;if(t)for(let r=0;r<t.length;r++)if(t[r]==e){i=r;break}return i}static contains(e,t){if(null!=e&&t&&t.length)for(let i of t)if(this.equals(e,i))return!0;return!1}static removeAccents(e){return e&&e.search(/[\xC0-\xFF]/g)>-1&&(e=e.replace(/[\xC0-\xC5]/g,"A").replace(/[\xC6]/g,"AE").replace(/[\xC7]/g,"C").replace(/[\xC8-\xCB]/g,"E").replace(/[\xCC-\xCF]/g,"I").replace(/[\xD0]/g,"D").replace(/[\xD1]/g,"N").replace(/[\xD2-\xD6\xD8]/g,"O").replace(/[\xD9-\xDC]/g,"U").replace(/[\xDD]/g,"Y").replace(/[\xDE]/g,"P").replace(/[\xE0-\xE5]/g,"a").replace(/[\xE6]/g,"ae").replace(/[\xE7]/g,"c").replace(/[\xE8-\xEB]/g,"e").replace(/[\xEC-\xEF]/g,"i").replace(/[\xF1]/g,"n").replace(/[\xF2-\xF6\xF8]/g,"o").replace(/[\xF9-\xFC]/g,"u").replace(/[\xFE]/g,"p").replace(/[\xFD\xFF]/g,"y")),e}static isDate(e){return"[object Date]"===Object.prototype.toString.call(e)}static isEmpty(e){return null==e||""===e||Array.isArray(e)&&0===e.length||!this.isDate(e)&&"object"==typeof e&&0===Object.keys(e).length}static isNotEmpty(e){return!this.isEmpty(e)}static compare(e,t,i,r=1){let s=-1;const o=this.isEmpty(e),a=this.isEmpty(t);return s=o&&a?0:o?r:a?-r:"string"==typeof e&&"string"==typeof t?e.localeCompare(t,i,{numeric:!0}):e<t?-1:e>t?1:0,s}static sort(e,t,i=1,r,s=1){return(1===s?i:s)*jd.compare(e,t,r,i)}static merge(e,t){if(null!=e||null!=t)return null!=e&&"object"!=typeof e||null!=t&&"object"!=typeof t?null!=e&&"string"!=typeof e||null!=t&&"string"!=typeof t?t||e:[e||"",t||""].join(" "):{...e||{},...t||{}}}static isPrintableCharacter(e=""){return this.isNotEmpty(e)&&1===e.length&&e.match(/\S| /)}static getItemValue(e,...t){return this.isFunction(e)?e(...t):e}static findLastIndex(e,t){let i=-1;if(this.isNotEmpty(e))try{i=e.findLastIndex(t)}catch{i=e.lastIndexOf([...e].reverse().find(t))}return i}static findLast(e,t){let i;if(this.isNotEmpty(e))try{i=e.findLast(t)}catch{i=[...e].reverse().find(t)}return i}}var HO=0;!function Tte(){let n=[];const r=s=>s&&parseInt(s.style.zIndex,10)||0}();const Ate=["*"];let zO=(()=>{class n{label;spin=!1;styleClass;role;ariaLabel;ariaHidden;ngOnInit(){this.getAttributes()}getAttributes(){const t=jd.isEmpty(this.label);this.role=t?void 0:"img",this.ariaLabel=t?void 0:this.label,this.ariaHidden=t}getClassNames(){return`p-icon ${this.styleClass?this.styleClass+" ":""}${this.spin?"p-icon-spin":""}`}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=Rr({type:n,selectors:[["ng-component"]],hostAttrs:[1,"p-element","p-icon-wrapper"],inputs:{label:"label",spin:"spin",styleClass:"styleClass"},standalone:!0,features:[Tu],ngContentSelectors:Ate,decls:1,vars:0,template:function(i,r){1&i&&(C_(),T_(0))},encapsulation:2,changeDetection:0})}return n})(),GO=(()=>{class n extends zO{pathId;ngOnInit(){this.pathId="url(#"+function Cte(n="pn_id_"){return`${n}${++HO}`}()+")"}static \u0275fac=function(){let t;return function(r){return(t||(t=Cn(n)))(r||n)}}();static \u0275cmp=Rr({type:n,selectors:[["SpinnerIcon"]],standalone:!0,features:[wt,Tu],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M6.99701 14C5.85441 13.999 4.72939 13.7186 3.72012 13.1832C2.71084 12.6478 1.84795 11.8737 1.20673 10.9284C0.565504 9.98305 0.165424 8.89526 0.041387 7.75989C-0.0826496 6.62453 0.073125 5.47607 0.495122 4.4147C0.917119 3.35333 1.59252 2.4113 2.46241 1.67077C3.33229 0.930247 4.37024 0.413729 5.4857 0.166275C6.60117 -0.0811796 7.76026 -0.0520535 8.86188 0.251112C9.9635 0.554278 10.9742 1.12227 11.8057 1.90555C11.915 2.01493 11.9764 2.16319 11.9764 2.31778C11.9764 2.47236 11.915 2.62062 11.8057 2.73C11.7521 2.78503 11.688 2.82877 11.6171 2.85864C11.5463 2.8885 11.4702 2.90389 11.3933 2.90389C11.3165 2.90389 11.2404 2.8885 11.1695 2.85864C11.0987 2.82877 11.0346 2.78503 10.9809 2.73C9.9998 1.81273 8.73246 1.26138 7.39226 1.16876C6.05206 1.07615 4.72086 1.44794 3.62279 2.22152C2.52471 2.99511 1.72683 4.12325 1.36345 5.41602C1.00008 6.70879 1.09342 8.08723 1.62775 9.31926C2.16209 10.5513 3.10478 11.5617 4.29713 12.1803C5.48947 12.7989 6.85865 12.988 8.17414 12.7157C9.48963 12.4435 10.6711 11.7264 11.5196 10.6854C12.3681 9.64432 12.8319 8.34282 12.8328 7C12.8328 6.84529 12.8943 6.69692 13.0038 6.58752C13.1132 6.47812 13.2616 6.41667 13.4164 6.41667C13.5712 6.41667 13.7196 6.47812 13.8291 6.58752C13.9385 6.69692 14 6.84529 14 7C14 8.85651 13.2622 10.637 11.9489 11.9497C10.6356 13.2625 8.85432 14 6.99701 14Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(i,r){1&i&&(ey(),en(0,"svg",0)(1,"g"),Hi(2,"path",1),tn(),en(3,"defs")(4,"clipPath",2),Hi(5,"rect",3),tn()()()),2&i&&(cs(r.getClassNames()),Kt("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role),Tt(1),Kt("clip-path",r.pathId),Tt(3),ut("id",r.pathId))},encapsulation:2})}return n})(),Ri=(()=>{class n{static zindex=1e3;static calculatedScrollbarWidth=null;static calculatedScrollbarHeight=null;static browser;static addClass(t,i){t&&i&&(t.classList?t.classList.add(i):t.className+=" "+i)}static addMultipleClasses(t,i){if(t&&i)if(t.classList){let r=i.trim().split(" ");for(let s=0;s<r.length;s++)t.classList.add(r[s])}else{let r=i.split(" ");for(let s=0;s<r.length;s++)t.className+=" "+r[s]}}static removeClass(t,i){t&&i&&(t.classList?t.classList.remove(i):t.className=t.className.replace(new RegExp("(^|\\b)"+i.split(" ").join("|")+"(\\b|$)","gi")," "))}static hasClass(t,i){return!(!t||!i)&&(t.classList?t.classList.contains(i):new RegExp("(^| )"+i+"( |$)","gi").test(t.className))}static siblings(t){return Array.prototype.filter.call(t.parentNode.children,function(i){return i!==t})}static find(t,i){return Array.from(t.querySelectorAll(i))}static findSingle(t,i){return this.isElement(t)?t.querySelector(i):null}static index(t){let i=t.parentNode.childNodes,r=0;for(var s=0;s<i.length;s++){if(i[s]==t)return r;1==i[s].nodeType&&r++}return-1}static indexWithinGroup(t,i){let r=t.parentNode?t.parentNode.childNodes:[],s=0;for(var o=0;o<r.length;o++){if(r[o]==t)return s;r[o].attributes&&r[o].attributes[i]&&1==r[o].nodeType&&s++}return-1}static appendOverlay(t,i,r="self"){"self"!==r&&t&&i&&this.appendChild(t,i)}static alignOverlay(t,i,r="self",s=!0){t&&i&&(s&&(t.style.minWidth=`${n.getOuterWidth(i)}px`),"self"===r?this.relativePosition(t,i):this.absolutePosition(t,i))}static relativePosition(t,i){const r=m=>{if(m)return"relative"===getComputedStyle(m).getPropertyValue("position")?m:r(m.parentElement)},s=t.offsetParent?{width:t.offsetWidth,height:t.offsetHeight}:this.getHiddenElementDimensions(t),o=i.offsetHeight,a=i.getBoundingClientRect(),l=this.getWindowScrollTop(),c=this.getWindowScrollLeft(),u=this.getViewport(),h=r(t)?.getBoundingClientRect()||{top:-1*l,left:-1*c};let f,p;a.top+o+s.height>u.height?(f=a.top-h.top-s.height,t.style.transformOrigin="bottom",a.top+f<0&&(f=-1*a.top)):(f=o+a.top-h.top,t.style.transformOrigin="top");const y=a.left+s.width-u.width;p=s.width>u.width?-1*(a.left-h.left):y>0?a.left-h.left-y:a.left-h.left,t.style.top=f+"px",t.style.left=p+"px"}static absolutePosition(t,i){const r=t.offsetParent?{width:t.offsetWidth,height:t.offsetHeight}:this.getHiddenElementDimensions(t),s=r.height,o=r.width,a=i.offsetHeight,l=i.offsetWidth,c=i.getBoundingClientRect(),u=this.getWindowScrollTop(),d=this.getWindowScrollLeft(),h=this.getViewport();let f,p;c.top+a+s>h.height?(f=c.top+u-s,t.style.transformOrigin="bottom",f<0&&(f=u)):(f=a+c.top+u,t.style.transformOrigin="top"),p=c.left+o>h.width?Math.max(0,c.left+d+l-o):c.left+d,t.style.top=f+"px",t.style.left=p+"px"}static getParents(t,i=[]){return null===t.parentNode?i:this.getParents(t.parentNode,i.concat([t.parentNode]))}static getScrollableParents(t){let i=[];if(t){let r=this.getParents(t);const s=/(auto|scroll)/,o=a=>{let l=window.getComputedStyle(a,null);return s.test(l.getPropertyValue("overflow"))||s.test(l.getPropertyValue("overflowX"))||s.test(l.getPropertyValue("overflowY"))};for(let a of r){let l=1===a.nodeType&&a.dataset.scrollselectors;if(l){let c=l.split(",");for(let u of c){let d=this.findSingle(a,u);d&&o(d)&&i.push(d)}}9!==a.nodeType&&o(a)&&i.push(a)}}return i}static getHiddenElementOuterHeight(t){t.style.visibility="hidden",t.style.display="block";let i=t.offsetHeight;return t.style.display="none",t.style.visibility="visible",i}static getHiddenElementOuterWidth(t){t.style.visibility="hidden",t.style.display="block";let i=t.offsetWidth;return t.style.display="none",t.style.visibility="visible",i}static getHiddenElementDimensions(t){let i={};return t.style.visibility="hidden",t.style.display="block",i.width=t.offsetWidth,i.height=t.offsetHeight,t.style.display="none",t.style.visibility="visible",i}static scrollInView(t,i){let r=getComputedStyle(t).getPropertyValue("borderTopWidth"),s=r?parseFloat(r):0,o=getComputedStyle(t).getPropertyValue("paddingTop"),a=o?parseFloat(o):0,l=t.getBoundingClientRect(),u=i.getBoundingClientRect().top+document.body.scrollTop-(l.top+document.body.scrollTop)-s-a,d=t.scrollTop,h=t.clientHeight,f=this.getOuterHeight(i);u<0?t.scrollTop=d+u:u+f>h&&(t.scrollTop=d+u-h+f)}static fadeIn(t,i){t.style.opacity=0;let r=+new Date,s=0,o=function(){s=+t.style.opacity.replace(",",".")+((new Date).getTime()-r)/i,t.style.opacity=s,r=+new Date,+s<1&&(window.requestAnimationFrame&&requestAnimationFrame(o)||setTimeout(o,16))};o()}static fadeOut(t,i){var r=1,a=50/i;let l=setInterval(()=>{(r-=a)<=0&&(r=0,clearInterval(l)),t.style.opacity=r},50)}static getWindowScrollTop(){let t=document.documentElement;return(window.pageYOffset||t.scrollTop)-(t.clientTop||0)}static getWindowScrollLeft(){let t=document.documentElement;return(window.pageXOffset||t.scrollLeft)-(t.clientLeft||0)}static matches(t,i){var r=Element.prototype;return(r.matches||r.webkitMatchesSelector||r.mozMatchesSelector||r.msMatchesSelector||function(o){return-1!==[].indexOf.call(document.querySelectorAll(o),this)}).call(t,i)}static getOuterWidth(t,i){let r=t.offsetWidth;if(i){let s=getComputedStyle(t);r+=parseFloat(s.marginLeft)+parseFloat(s.marginRight)}return r}static getHorizontalPadding(t){let i=getComputedStyle(t);return parseFloat(i.paddingLeft)+parseFloat(i.paddingRight)}static getHorizontalMargin(t){let i=getComputedStyle(t);return parseFloat(i.marginLeft)+parseFloat(i.marginRight)}static innerWidth(t){let i=t.offsetWidth,r=getComputedStyle(t);return i+=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight),i}static width(t){let i=t.offsetWidth,r=getComputedStyle(t);return i-=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight),i}static getInnerHeight(t){let i=t.offsetHeight,r=getComputedStyle(t);return i+=parseFloat(r.paddingTop)+parseFloat(r.paddingBottom),i}static getOuterHeight(t,i){let r=t.offsetHeight;if(i){let s=getComputedStyle(t);r+=parseFloat(s.marginTop)+parseFloat(s.marginBottom)}return r}static getHeight(t){let i=t.offsetHeight,r=getComputedStyle(t);return i-=parseFloat(r.paddingTop)+parseFloat(r.paddingBottom)+parseFloat(r.borderTopWidth)+parseFloat(r.borderBottomWidth),i}static getWidth(t){let i=t.offsetWidth,r=getComputedStyle(t);return i-=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight)+parseFloat(r.borderLeftWidth)+parseFloat(r.borderRightWidth),i}static getViewport(){let t=window,i=document,r=i.documentElement,s=i.getElementsByTagName("body")[0];return{width:t.innerWidth||r.clientWidth||s.clientWidth,height:t.innerHeight||r.clientHeight||s.clientHeight}}static getOffset(t){var i=t.getBoundingClientRect();return{top:i.top+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0),left:i.left+(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0)}}static replaceElementWith(t,i){let r=t.parentNode;if(!r)throw"Can't replace element";return r.replaceChild(i,t)}static getUserAgent(){if(navigator&&this.isClient())return navigator.userAgent}static isIE(){var t=window.navigator.userAgent;return t.indexOf("MSIE ")>0||(t.indexOf("Trident/")>0?(t.indexOf("rv:"),!0):t.indexOf("Edge/")>0)}static isIOS(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream}static isAndroid(){return/(android)/i.test(navigator.userAgent)}static isTouchDevice(){return"ontouchstart"in window||navigator.maxTouchPoints>0}static appendChild(t,i){if(this.isElement(i))i.appendChild(t);else{if(!(i&&i.el&&i.el.nativeElement))throw"Cannot append "+i+" to "+t;i.el.nativeElement.appendChild(t)}}static removeChild(t,i){if(this.isElement(i))i.removeChild(t);else{if(!i.el||!i.el.nativeElement)throw"Cannot remove "+t+" from "+i;i.el.nativeElement.removeChild(t)}}static removeElement(t){"remove"in Element.prototype?t.remove():t.parentNode.removeChild(t)}static isElement(t){return"object"==typeof HTMLElement?t instanceof HTMLElement:t&&"object"==typeof t&&null!==t&&1===t.nodeType&&"string"==typeof t.nodeName}static calculateScrollbarWidth(t){if(t){let i=getComputedStyle(t);return t.offsetWidth-t.clientWidth-parseFloat(i.borderLeftWidth)-parseFloat(i.borderRightWidth)}{if(null!==this.calculatedScrollbarWidth)return this.calculatedScrollbarWidth;let i=document.createElement("div");i.className="p-scrollbar-measure",document.body.appendChild(i);let r=i.offsetWidth-i.clientWidth;return document.body.removeChild(i),this.calculatedScrollbarWidth=r,r}}static calculateScrollbarHeight(){if(null!==this.calculatedScrollbarHeight)return this.calculatedScrollbarHeight;let t=document.createElement("div");t.className="p-scrollbar-measure",document.body.appendChild(t);let i=t.offsetHeight-t.clientHeight;return document.body.removeChild(t),this.calculatedScrollbarWidth=i,i}static invokeElementMethod(t,i,r){t[i].apply(t,r)}static clearSelection(){if(window.getSelection)window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().rangeCount>0&&window.getSelection().getRangeAt(0).getClientRects().length>0&&window.getSelection().removeAllRanges();else if(document.selection&&document.selection.empty)try{document.selection.empty()}catch{}}static getBrowser(){if(!this.browser){let t=this.resolveUserAgent();this.browser={},t.browser&&(this.browser[t.browser]=!0,this.browser.version=t.version),this.browser.chrome?this.browser.webkit=!0:this.browser.webkit&&(this.browser.safari=!0)}return this.browser}static resolveUserAgent(){let t=navigator.userAgent.toLowerCase(),i=/(chrome)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[];return{browser:i[1]||"",version:i[2]||"0"}}static isInteger(t){return Number.isInteger?Number.isInteger(t):"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}static isHidden(t){return!t||null===t.offsetParent}static isVisible(t){return t&&null!=t.offsetParent}static isExist(t){return null!==t&&typeof t<"u"&&t.nodeName&&t.parentNode}static focus(t,i){t&&document.activeElement!==t&&t.focus(i)}static getFocusableElements(t){let i=n.find(t,'button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),\n                [href]:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),\n                input:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]), select:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),\n                textarea:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]), [tabIndex]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),\n                [contenteditable]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]):not(.p-disabled)'),r=[];for(let s of i)(s.offsetWidth||s.offsetHeight||s.getClientRects().length)&&r.push(s);return r}static getNextFocusableElement(t,i=!1){const r=n.getFocusableElements(t);let s=0;if(r&&r.length>0){const o=r.indexOf(r[0].ownerDocument.activeElement);i?s=-1==o||0===o?r.length-1:o-1:-1!=o&&o!==r.length-1&&(s=o+1)}return r[s]}static generateZIndex(){return this.zindex=this.zindex||999,++this.zindex}static getSelection(){return window.getSelection?window.getSelection().toString():document.getSelection?document.getSelection().toString():document.selection?document.selection.createRange().text:null}static getTargetElement(t,i){if(!t)return null;switch(t){case"document":return document;case"window":return window;case"@next":return i?.nextElementSibling;case"@prev":return i?.previousElementSibling;case"@parent":return i?.parentElement;case"@grandparent":return i?.parentElement.parentElement;default:const r=typeof t;if("string"===r)return document.querySelector(t);if("object"===r&&t.hasOwnProperty("nativeElement"))return this.isExist(t.nativeElement)?t.nativeElement:void 0;const o=(a=t)&&a.constructor&&a.call&&a.apply?t():t;return o&&9===o.nodeType||this.isExist(o)?o:null}var a}static isClient(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}static getAttribute(t,i){if(t){const r=t.getAttribute(i);return isNaN(r)?"true"===r||"false"===r?"true"===r:r:+r}}static calculateBodyScrollbarWidth(){return window.innerWidth-document.documentElement.offsetWidth}static blockBodyScroll(t="p-overflow-hidden"){document.body.style.setProperty("--scrollbar-width",this.calculateBodyScrollbarWidth()+"px"),this.addClass(document.body,t)}static unblockBodyScroll(t="p-overflow-hidden"){document.body.style.removeProperty("--scrollbar-width"),this.removeClass(document.body,t)}}return n})(),Dte=(()=>{class n{document;platformId;renderer;el;zone;config;constructor(t,i,r,s,o,a){this.document=t,this.platformId=i,this.renderer=r,this.el=s,this.zone=o,this.config=a}animationListener;mouseDownListener;timeout;ngAfterViewInit(){(function g5(n){return n===kD})(this.platformId)&&this.config&&this.config.ripple&&this.zone.runOutsideAngular(()=>{this.create(),this.mouseDownListener=this.renderer.listen(this.el.nativeElement,"mousedown",this.onMouseDown.bind(this))})}onMouseDown(t){let i=this.getInk();if(!i||"none"===this.document.defaultView?.getComputedStyle(i,null).display)return;if(Ri.removeClass(i,"p-ink-active"),!Ri.getHeight(i)&&!Ri.getWidth(i)){let a=Math.max(Ri.getOuterWidth(this.el.nativeElement),Ri.getOuterHeight(this.el.nativeElement));i.style.height=a+"px",i.style.width=a+"px"}let r=Ri.getOffset(this.el.nativeElement),s=t.pageX-r.left+this.document.body.scrollTop-Ri.getWidth(i)/2,o=t.pageY-r.top+this.document.body.scrollLeft-Ri.getHeight(i)/2;this.renderer.setStyle(i,"top",o+"px"),this.renderer.setStyle(i,"left",s+"px"),Ri.addClass(i,"p-ink-active"),this.timeout=setTimeout(()=>{let a=this.getInk();a&&Ri.removeClass(a,"p-ink-active")},401)}getInk(){const t=this.el.nativeElement.children;for(let i=0;i<t.length;i++)if("string"==typeof t[i].className&&-1!==t[i].className.indexOf("p-ink"))return t[i];return null}resetInk(){let t=this.getInk();t&&Ri.removeClass(t,"p-ink-active")}onAnimationEnd(t){this.timeout&&clearTimeout(this.timeout),Ri.removeClass(t.currentTarget,"p-ink-active")}create(){let t=this.renderer.createElement("span");this.renderer.addClass(t,"p-ink"),this.renderer.appendChild(this.el.nativeElement,t),this.renderer.setAttribute(t,"aria-hidden","true"),this.renderer.setAttribute(t,"role","presentation"),this.animationListener||(this.animationListener=this.renderer.listen(t,"animationend",this.onAnimationEnd.bind(this)))}remove(){let t=this.getInk();t&&(this.mouseDownListener&&this.mouseDownListener(),this.animationListener&&this.animationListener(),this.mouseDownListener=null,this.animationListener=null,Ri.removeElement(t))}ngOnDestroy(){this.config&&this.config.ripple&&this.remove()}static \u0275fac=function(i){return new(i||n)(ne(Yn),ne(js),ne(kr),ne(Si),ne(Dt),ne(xte,8))};static \u0275dir=Ge({type:n,selectors:[["","pRipple",""]],hostAttrs:[1,"p-ripple","p-element"]})}return n})(),Ite=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=jn({type:n});static \u0275inj=Un({imports:[Fu]})}return n})();function Rte(n,e){1&n&&M_(0)}function Pte(n,e){if(1&n&&Hi(0,"span",8),2&n){const t=Rn(3);cs("p-button-loading-icon pi-spin "+t.loadingIcon),ut("ngClass",t.iconClass()),Kt("aria-hidden",!0)("data-pc-section","loadingicon")}}function Nte(n,e){1&n&&Hi(0,"SpinnerIcon",9),2&n&&(ut("styleClass",Rn(3).spinnerIconClass())("spin",!0),Kt("aria-hidden",!0)("data-pc-section","loadingicon"))}function Lte(n,e){if(1&n&&($s(0),qt(1,Pte,1,5,"span",6),qt(2,Nte,1,4,"SpinnerIcon",7),qs()),2&n){const t=Rn(2);Tt(1),ut("ngIf",t.loadingIcon),Tt(1),ut("ngIf",!t.loadingIcon)}}function Ote(n,e){}function Fte(n,e){1&n&&qt(0,Ote,0,0,"ng-template")}function kte(n,e){if(1&n&&(en(0,"span",10),qt(1,Fte,1,0,null,1),tn()),2&n){const t=Rn(2);ut("ngClass",t.iconClass()),Kt("aria-hidden",!0)("data-pc-section","loadingicon"),Tt(1),ut("ngTemplateOutlet",t.loadingIconTemplate)}}function Ute(n,e){if(1&n&&($s(0),qt(1,Lte,3,2,"ng-container",2),qt(2,kte,2,4,"span",5),qs()),2&n){const t=Rn();Tt(1),ut("ngIf",!t.loadingIconTemplate),Tt(1),ut("ngIf",t.loadingIconTemplate)}}function Bte(n,e){if(1&n&&Hi(0,"span",8),2&n){const t=Rn(2);cs(t.icon),ut("ngClass",t.iconClass()),Kt("data-pc-section","icon")}}function Vte(n,e){}function Hte(n,e){1&n&&qt(0,Vte,0,0,"ng-template",12),2&n&&ut("ngIf",!Rn(3).icon)}function zte(n,e){if(1&n&&(en(0,"span",8),qt(1,Hte,1,1,null,1),tn()),2&n){const t=Rn(2);ut("ngClass",t.iconClass()),Kt("data-pc-section","icon"),Tt(1),ut("ngTemplateOutlet",t.iconTemplate)}}function Gte(n,e){if(1&n&&($s(0),qt(1,Bte,1,4,"span",6),qt(2,zte,2,3,"span",11),qs()),2&n){const t=Rn();Tt(1),ut("ngIf",t.icon&&!t.iconTemplate),Tt(1),ut("ngIf",!t.icon&&t.iconTemplate)}}function Wte(n,e){if(1&n&&(en(0,"span",13),zr(1),tn()),2&n){const t=Rn();Kt("aria-hidden",t.icon&&!t.label)("data-pc-section","label"),Tt(1),bu(t.label)}}function jte(n,e){if(1&n&&(en(0,"span",8),zr(1),tn()),2&n){const t=Rn();cs(t.badgeClass),ut("ngClass",t.badgeStyleClass()),Kt("data-pc-section","badge"),Tt(1),bu(t.badge)}}const $te=["*"];let WO=(()=>{class n{type="button";iconPos="left";icon;badge;label;disabled;loading=!1;loadingIcon;raised=!1;rounded=!1;text=!1;plain=!1;severity;outlined=!1;link=!1;size;style;styleClass;badgeClass;ariaLabel;onClick=new Ut;onFocus=new Ut;onBlur=new Ut;contentTemplate;loadingIconTemplate;iconTemplate;templates;spinnerIconClass(){return Object.entries(this.iconClass()).filter(([,t])=>!!t).reduce((t,[i])=>t+` ${i}`,"p-button-loading-icon")}iconClass(){return{"p-button-icon":!0,"p-button-icon-left":"left"===this.iconPos&&this.label,"p-button-icon-right":"right"===this.iconPos&&this.label,"p-button-icon-top":"top"===this.iconPos&&this.label,"p-button-icon-bottom":"bottom"===this.iconPos&&this.label}}buttonClass(){return{"p-button p-component":!0,"p-button-icon-only":(this.icon||this.iconTemplate||this.loadingIcon||this.loadingIconTemplate)&&!this.label,"p-button-vertical":("top"===this.iconPos||"bottom"===this.iconPos)&&this.label,"p-disabled":this.disabled||this.loading,"p-button-loading":this.loading,"p-button-loading-label-only":this.loading&&!this.icon&&this.label&&!this.loadingIcon&&"left"===this.iconPos,"p-button-link":this.link,[`p-button-${this.severity}`]:this.severity,"p-button-raised":this.raised,"p-button-rounded":this.rounded,"p-button-text":this.text,"p-button-outlined":this.outlined,"p-button-sm":"small"===this.size,"p-button-lg":"large"===this.size,"p-button-plain":this.plain}}ngAfterContentInit(){this.templates?.forEach(t=>{switch(t.getType()){case"content":default:this.contentTemplate=t.template;break;case"icon":this.iconTemplate=t.template;break;case"loadingicon":this.loadingIconTemplate=t.template}})}badgeStyleClass(){return{"p-badge p-component":!0,"p-badge-no-gutter":this.badge&&1===String(this.badge).length}}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=Rr({type:n,selectors:[["p-button"]],contentQueries:function(i,r,s){if(1&i&&Ef(s,VO,4),2&i){let o;pl(o=ml())&&(r.templates=o)}},hostAttrs:[1,"p-element"],hostVars:2,hostBindings:function(i,r){2&i&&vu("p-disabled",r.disabled)},inputs:{type:"type",iconPos:"iconPos",icon:"icon",badge:"badge",label:"label",disabled:"disabled",loading:"loading",loadingIcon:"loadingIcon",raised:"raised",rounded:"rounded",text:"text",plain:"plain",severity:"severity",outlined:"outlined",link:"link",size:"size",style:"style",styleClass:"styleClass",badgeClass:"badgeClass",ariaLabel:"ariaLabel"},outputs:{onClick:"onClick",onFocus:"onFocus",onBlur:"onBlur"},ngContentSelectors:$te,decls:7,vars:14,consts:[["pRipple","",3,"ngStyle","disabled","ngClass","click","focus","blur"],[4,"ngTemplateOutlet"],[4,"ngIf"],["class","p-button-label",4,"ngIf"],[3,"ngClass","class",4,"ngIf"],["class","p-button-loading-icon",3,"ngClass",4,"ngIf"],[3,"class","ngClass",4,"ngIf"],[3,"styleClass","spin",4,"ngIf"],[3,"ngClass"],[3,"styleClass","spin"],[1,"p-button-loading-icon",3,"ngClass"],[3,"ngClass",4,"ngIf"],[3,"ngIf"],[1,"p-button-label"]],template:function(i,r){1&i&&(C_(),en(0,"button",0),dn("click",function(o){return r.onClick.emit(o)})("focus",function(o){return r.onFocus.emit(o)})("blur",function(o){return r.onBlur.emit(o)}),T_(1),qt(2,Rte,1,0,"ng-container",1),qt(3,Ute,3,2,"ng-container",2),qt(4,Gte,3,2,"ng-container",2),qt(5,Wte,2,3,"span",3),qt(6,jte,2,5,"span",4),tn()),2&i&&(cs(r.styleClass),ut("ngStyle",r.style)("disabled",r.disabled||r.loading)("ngClass",r.buttonClass()),Kt("type",r.type)("aria-label",r.ariaLabel)("data-pc-name","button")("data-pc-section","root"),Tt(2),ut("ngTemplateOutlet",r.contentTemplate),Tt(1),ut("ngIf",r.loading),Tt(1),ut("ngIf",!r.loading),Tt(1),ut("ngIf",!r.contentTemplate&&r.label),Tt(1),ut("ngIf",!r.contentTemplate&&r.badge))},dependencies:function(){return[Pv,Nv,kv,Fv,Dte,GO]},encapsulation:2,changeDetection:0})}return n})(),qte=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=jn({type:n});static \u0275inj=Un({imports:[Fu,Ite,Jb,GO,Jb]})}return n})(),jO=(()=>{class n extends zO{static \u0275fac=function(){let t;return function(r){return(t||(t=Cn(n)))(r||n)}}();static \u0275cmp=Rr({type:n,selectors:[["CheckIcon"]],standalone:!0,features:[wt,Tu],decls:2,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M4.86199 11.5948C4.78717 11.5923 4.71366 11.5745 4.64596 11.5426C4.57826 11.5107 4.51779 11.4652 4.46827 11.4091L0.753985 7.69483C0.683167 7.64891 0.623706 7.58751 0.580092 7.51525C0.536478 7.44299 0.509851 7.36177 0.502221 7.27771C0.49459 7.19366 0.506156 7.10897 0.536046 7.03004C0.565935 6.95111 0.613367 6.88 0.674759 6.82208C0.736151 6.76416 0.8099 6.72095 0.890436 6.69571C0.970973 6.67046 1.05619 6.66385 1.13966 6.67635C1.22313 6.68886 1.30266 6.72017 1.37226 6.76792C1.44186 6.81567 1.4997 6.8786 1.54141 6.95197L4.86199 10.2503L12.6397 2.49483C12.7444 2.42694 12.8689 2.39617 12.9932 2.40745C13.1174 2.41873 13.2343 2.47141 13.3251 2.55705C13.4159 2.64268 13.4753 2.75632 13.4938 2.87973C13.5123 3.00315 13.4888 3.1292 13.4271 3.23768L5.2557 11.4091C5.20618 11.4652 5.14571 11.5107 5.07801 11.5426C5.01031 11.5745 4.9368 11.5923 4.86199 11.5948Z","fill","currentColor"]],template:function(i,r){1&i&&(ey(),en(0,"svg",0),Hi(1,"path",1),tn()),2&i&&(cs(r.getClassNames()),Kt("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role))},encapsulation:2})}return n})();const Xte=["cb"];function Yte(n,e){1&n&&Hi(0,"span",10),2&n&&ut("ngClass",Rn(3).checkboxIcon)}function Zte(n,e){1&n&&Hi(0,"CheckIcon",11),2&n&&ut("styleClass","p-checkbox-icon")}function Kte(n,e){if(1&n&&($s(0),qt(1,Yte,1,1,"span",8),qt(2,Zte,1,1,"CheckIcon",9),qs()),2&n){const t=Rn(2);Tt(1),ut("ngIf",t.checkboxIcon),Tt(1),ut("ngIf",!t.checkboxIcon)}}function Jte(n,e){}function Qte(n,e){1&n&&qt(0,Jte,0,0,"ng-template")}function ene(n,e){if(1&n&&(en(0,"span",12),qt(1,Qte,1,0,null,13),tn()),2&n){const t=Rn(2);Tt(1),ut("ngTemplateOutlet",t.checkboxIconTemplate)}}function tne(n,e){if(1&n&&($s(0),qt(1,Kte,3,2,"ng-container",5),qt(2,ene,2,1,"span",7),qs()),2&n){const t=Rn();Tt(1),ut("ngIf",!t.checkboxIconTemplate),Tt(1),ut("ngIf",t.checkboxIconTemplate)}}const nne=function(n,e,t){return{"p-checkbox-label":!0,"p-checkbox-label-active":n,"p-disabled":e,"p-checkbox-label-focus":t}};function ine(n,e){if(1&n){const t=x_();en(0,"label",14),dn("click",function(r){jg(t);const s=Rn(),o=S_(3);return $g(s.onClick(r,o,!0))}),zr(1),tn()}if(2&n){const t=Rn();cs(t.labelStyleClass),ut("ngClass",yf(5,nne,t.checked(),t.disabled,t.focused)),Kt("for",t.inputId),Tt(1),bu(t.label)}}const rne=function(n,e,t){return{"p-checkbox p-component":!0,"p-checkbox-checked":n,"p-checkbox-disabled":e,"p-checkbox-focused":t}},sne=function(n,e,t){return{"p-highlight":n,"p-disabled":e,"p-focus":t}},one={provide:Mr,useExisting:Lt(()=>$O),multi:!0};let $O=(()=>{class n{cd;value;name;disabled;binary;label;ariaLabelledBy;ariaLabel;tabindex;inputId;style;styleClass;labelStyleClass;formControl;checkboxIcon;readonly;required;trueValue=!0;falseValue=!1;onChange=new Ut;inputViewChild;templates;checkboxIconTemplate;model;onModelChange=()=>{};onModelTouched=()=>{};focused=!1;constructor(t){this.cd=t}ngAfterContentInit(){this.templates.forEach(t=>{"icon"===t.getType()&&(this.checkboxIconTemplate=t.template)})}onClick(t,i,r){t.preventDefault(),!this.disabled&&!this.readonly&&(this.updateModel(t),r&&i.focus())}updateModel(t){let i;this.binary?(i=this.checked()?this.falseValue:this.trueValue,this.model=i,this.onModelChange(i)):(i=this.checked()?this.model.filter(r=>!jd.equals(r,this.value)):this.model?[...this.model,this.value]:[this.value],this.onModelChange(i),this.model=i,this.formControl&&this.formControl.setValue(i)),this.onChange.emit({checked:i,originalEvent:t})}handleChange(t){this.readonly||this.updateModel(t)}onFocus(){this.focused=!0}onBlur(){this.focused=!1,this.onModelTouched()}focus(){this.inputViewChild?.nativeElement.focus()}writeValue(t){this.model=t,this.cd.markForCheck()}registerOnChange(t){this.onModelChange=t}registerOnTouched(t){this.onModelTouched=t}setDisabledState(t){this.disabled=t,this.cd.markForCheck()}checked(){return this.binary?this.model===this.trueValue:jd.contains(this.value,this.model)}static \u0275fac=function(i){return new(i||n)(ne(Pu))};static \u0275cmp=Rr({type:n,selectors:[["p-checkbox"]],contentQueries:function(i,r,s){if(1&i&&Ef(s,VO,4),2&i){let o;pl(o=ml())&&(r.templates=o)}},viewQuery:function(i,r){if(1&i&&K_(Xte,5),2&i){let s;pl(s=ml())&&(r.inputViewChild=s.first)}},hostAttrs:[1,"p-element"],inputs:{value:"value",name:"name",disabled:"disabled",binary:"binary",label:"label",ariaLabelledBy:"ariaLabelledBy",ariaLabel:"ariaLabel",tabindex:"tabindex",inputId:"inputId",style:"style",styleClass:"styleClass",labelStyleClass:"labelStyleClass",formControl:"formControl",checkboxIcon:"checkboxIcon",readonly:"readonly",required:"required",trueValue:"trueValue",falseValue:"falseValue"},outputs:{onChange:"onChange"},features:[Ht([one])],decls:7,vars:26,consts:[[3,"ngStyle","ngClass"],[1,"p-hidden-accessible"],["type","checkbox",3,"readonly","value","checked","disabled","focus","blur","change"],["cb",""],[1,"p-checkbox-box",3,"ngClass","click"],[4,"ngIf"],[3,"class","ngClass","click",4,"ngIf"],["class","p-checkbox-icon",4,"ngIf"],["class","p-checkbox-icon",3,"ngClass",4,"ngIf"],[3,"styleClass",4,"ngIf"],[1,"p-checkbox-icon",3,"ngClass"],[3,"styleClass"],[1,"p-checkbox-icon"],[4,"ngTemplateOutlet"],[3,"ngClass","click"]],template:function(i,r){if(1&i){const s=x_();en(0,"div",0)(1,"div",1)(2,"input",2,3),dn("focus",function(){return r.onFocus()})("blur",function(){return r.onBlur()})("change",function(a){return r.handleChange(a)}),tn()(),en(4,"div",4),dn("click",function(a){jg(s);const l=S_(3);return $g(r.onClick(a,l,!0))}),qt(5,tne,3,2,"ng-container",5),tn()(),qt(6,ine,2,9,"label",6)}2&i&&(cs(r.styleClass),ut("ngStyle",r.style)("ngClass",yf(18,rne,r.checked(),r.disabled,r.focused)),Tt(2),ut("readonly",r.readonly)("value",r.value)("checked",r.checked())("disabled",r.disabled),Kt("id",r.inputId)("name",r.name)("tabindex",r.tabindex)("aria-labelledby",r.ariaLabelledBy)("aria-label",r.ariaLabel)("aria-checked",r.checked())("required",r.required),Tt(2),ut("ngClass",yf(22,sne,r.checked(),r.disabled,r.focused)),Tt(1),ut("ngIf",r.checked()),Tt(1),ut("ngIf",r.label))},dependencies:function(){return[Pv,Nv,kv,Fv,jO]},styles:["@layer primeng{.p-checkbox{display:inline-flex;cursor:pointer;-webkit-user-select:none;user-select:none;vertical-align:bottom;position:relative}.p-checkbox-disabled{cursor:default!important;pointer-events:none}.p-checkbox-box{display:flex;justify-content:center;align-items:center}p-checkbox{display:inline-flex;vertical-align:bottom;align-items:center}.p-checkbox-label{line-height:1}}\n"],encapsulation:2,changeDetection:0})}return n})(),ane=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=jn({type:n});static \u0275inj=Un({imports:[Fu,jO,Jb]})}return n})();const lne=["rendererContainer"];let cne=(()=>{class n{constructor(t,i){this.signalRService=t,this.dalService=i}ngOnInit(){this.signalRService.startConnection(),this.signalRService.hubConnection.on("test",t=>{console.log(t),this.click1()})}ngAfterViewInit(){this.initThree()}resizeCanvasToDisplaySize(){const t=this.renderer.domElement,i=t.clientWidth,r=t.clientHeight;this.renderer.setSize(i,r,!1),this.camera.aspect=i/r,this.camera.updateProjectionMatrix()}initThree(){this.scene=new ZN,this.scene.background=new Ae(16777215),this.camera=new Gn(75,this.rendererContainer.nativeElement.clientWidth/this.rendererContainer.nativeElement.clientHeight,.1,1e3),this.camera.position.set(-1.8,.6,2.7),this.renderer=new YN({antialias:!0}),this.renderer.setSize(this.rendererContainer.nativeElement.clientWidth,this.rendererContainer.nativeElement.clientHeight),this.rendererContainer.nativeElement.appendChild(this.renderer.domElement),this.controls=new dee(this.camera,this.renderer.domElement),this.controls.addEventListener("change",()=>{this.renderer.render(this.scene,this.camera)}),this.controls.enableZoom=!0,this.controls.update(),this.interactionManager=new class{renderer;camera;domElement;bindEventsOnBodyElement;autoAdd;scene;mouse;supportsPointerEvents;interactiveObjects;closestObject;raycaster;treatTouchEventsAsMouseEvents;constructor(n,e,t,i){this.renderer=n,this.camera=e,this.domElement=t,this.bindEventsOnBodyElement=!(i&&typeof i.bindEventsOnBodyElement<"u")||i.bindEventsOnBodyElement,this.scene=i&&typeof i.scene<"u"?i.scene:null,this.scene&&(this.scene.onBeforeRender=()=>{this.autoAdd&&null!==this.scene&&this.scene.traverse(r=>{this.add(r),r.addEventListener("removed",s=>{this.remove(s.target)})}),this.update()}),this.autoAdd=!!(i&&typeof i.autoAdd<"u")&&i.autoAdd,this.autoAdd&&null===this.scene&&console.error("Attention: Options.scene needs to be set when using options.autoAdd"),this.mouse=new K(-1,1),this.supportsPointerEvents=!!window.PointerEvent,this.interactiveObjects=[],this.closestObject=null,this.raycaster=new lee,t.addEventListener("click",this.onMouseClick),this.supportsPointerEvents&&(this.bindEventsOnBodyElement?t.ownerDocument.addEventListener("pointermove",this.onDocumentPointerMove):t.addEventListener("pointermove",this.onDocumentPointerMove),t.addEventListener("pointerdown",this.onPointerDown),t.addEventListener("pointerup",this.onPointerUp)),this.bindEventsOnBodyElement?t.ownerDocument.addEventListener("mousemove",this.onDocumentMouseMove):t.addEventListener("mousemove",this.onDocumentMouseMove),t.addEventListener("mousedown",this.onMouseDown),t.addEventListener("mouseup",this.onMouseUp),t.addEventListener("touchstart",this.onTouchStart,{passive:!0}),t.addEventListener("touchmove",this.onTouchMove,{passive:!0}),t.addEventListener("touchend",this.onTouchEnd,{passive:!0}),this.treatTouchEventsAsMouseEvents=!0}dispose=()=>{this.domElement.removeEventListener("click",this.onMouseClick),this.supportsPointerEvents&&(this.bindEventsOnBodyElement?this.domElement.ownerDocument.removeEventListener("pointermove",this.onDocumentPointerMove):this.domElement.removeEventListener("pointermove",this.onDocumentPointerMove),this.domElement.removeEventListener("pointerdown",this.onPointerDown),this.domElement.removeEventListener("pointerup",this.onPointerUp)),this.bindEventsOnBodyElement?this.domElement.ownerDocument.removeEventListener("mousemove",this.onDocumentMouseMove):this.domElement.removeEventListener("mousemove",this.onDocumentMouseMove),this.domElement.removeEventListener("mousedown",this.onMouseDown),this.domElement.removeEventListener("mouseup",this.onMouseUp),this.domElement.removeEventListener("touchstart",this.onTouchStart),this.domElement.removeEventListener("touchmove",this.onTouchMove),this.domElement.removeEventListener("touchend",this.onTouchEnd)};add=(n,e=[])=>{if(n&&!this.interactiveObjects.find(t=>t.target===n))if(e.length>0)e.forEach(t=>{let i=n.getObjectByName(t);if(i){let r=new pO(i,t);this.interactiveObjects.push(r)}});else{let t=new pO(n,n.name);this.interactiveObjects.push(t)}};remove=(n,e=[])=>{!n||(e.length>0?e.forEach(t=>{let i=n.getObjectByName(t);i&&(this.interactiveObjects=this.interactiveObjects.filter(r=>r.target!==i))}):this.interactiveObjects=this.interactiveObjects.filter(t=>t.target!==n))};update=()=>{this.raycaster.setFromCamera(this.mouse,this.camera),this.interactiveObjects.forEach(i=>{i.target&&this.checkIntersection(i)}),this.interactiveObjects.sort(function(i,r){return i.distance-r.distance});let e,t,n=this.interactiveObjects.find(i=>i.intersected)??null;if(n!=this.closestObject){if(this.closestObject){let i=new Ii("mouseout");this.dispatch(this.closestObject,i)}if(n){let i=new Ii("mouseover");this.dispatch(n,i)}this.closestObject=n}this.interactiveObjects.forEach(i=>{!i.intersected&&i.wasIntersected&&(e||(e=new Ii("mouseleave")),this.dispatch(i,e))}),this.interactiveObjects.forEach(i=>{i.intersected&&!i.wasIntersected&&(t||(t=new Ii("mouseenter")),this.dispatch(i,t))})};checkIntersection=n=>{let e=this.raycaster.intersectObjects([n.target],!0);if(n.wasIntersected=n.intersected,e.length>0){let t=e[0].distance;e.forEach(i=>{i.distance<t&&(t=i.distance)}),n.intersected=!0,n.distance=t}else n.intersected=!1};onDocumentMouseMove=n=>{this.mapPositionToPoint(this.mouse,n.clientX,n.clientY);let e=new Ii("mousemove",n);this.interactiveObjects.forEach(t=>{this.dispatch(t,e)})};onDocumentPointerMove=n=>{this.mapPositionToPoint(this.mouse,n.clientX,n.clientY);let e=new Ii("pointermove",n);this.interactiveObjects.forEach(t=>{this.dispatch(t,e)})};onTouchMove=n=>{n.touches.length>0&&this.mapPositionToPoint(this.mouse,n.touches[0].clientX,n.touches[0].clientY);let e=new Ii(this.treatTouchEventsAsMouseEvents?"mousemove":"touchmove",n);this.interactiveObjects.forEach(t=>{this.dispatch(t,e)})};onMouseClick=n=>{this.update();let e=new Ii("click",n);this.interactiveObjects.forEach(t=>{t.intersected&&this.dispatch(t,e)})};onMouseDown=n=>{this.mapPositionToPoint(this.mouse,n.clientX,n.clientY),this.update();let e=new Ii("mousedown",n);this.interactiveObjects.forEach(t=>{t.intersected&&this.dispatch(t,e)})};onPointerDown=n=>{this.mapPositionToPoint(this.mouse,n.clientX,n.clientY),this.update();let e=new Ii("pointerdown",n);this.interactiveObjects.forEach(t=>{t.intersected&&this.dispatch(t,e)})};onTouchStart=n=>{n.touches.length>0&&this.mapPositionToPoint(this.mouse,n.touches[0].clientX,n.touches[0].clientY),this.update();let e=new Ii(this.treatTouchEventsAsMouseEvents?"mousedown":"touchstart",n);this.interactiveObjects.forEach(t=>{t.intersected&&this.dispatch(t,e)})};onMouseUp=n=>{let e=new Ii("mouseup",n);this.interactiveObjects.forEach(t=>{this.dispatch(t,e)})};onPointerUp=n=>{let e=new Ii("pointerup",n);this.interactiveObjects.forEach(t=>{this.dispatch(t,e)})};onTouchEnd=n=>{n.touches.length>0&&this.mapPositionToPoint(this.mouse,n.touches[0].clientX,n.touches[0].clientY),this.update();let e=new Ii(this.treatTouchEventsAsMouseEvents?"mouseup":"touchend",n);this.interactiveObjects.forEach(t=>{this.dispatch(t,e)})};dispatch=(n,e)=>{n.target&&!e.cancelBubble&&(e.coords=this.mouse,e.distance=n.distance,e.intersected=n.intersected,n.target.dispatchEvent(e))};mapPositionToPoint=(n,e,t)=>{let i=this.renderer.domElement.getBoundingClientRect();n.x=(e-i.left)/i.width*2-1,n.y=-(t-i.top)/i.height*2+1}}(this.renderer,this.camera,this.renderer.domElement);const t=new GL(16777215);this.scene.add(t);const i=()=>{requestAnimationFrame(i),this.controls.update(),this.interactionManager.update(),this.renderer.render(this.scene,this.camera)};i()}randomIntFromInterval(t,i){return Math.random()*(i-t+1)+t}click1(){const t=ZP_randInt(0,16777215),i=new la(this.randomIntFromInterval(-1,1),this.randomIntFromInterval(-1,1),this.randomIntFromInterval(-1,1)),r=new _o({color:t}),s=new Di(i,r);s.position.set(this.randomIntFromInterval(-1,1),this.randomIntFromInterval(-1,1),this.randomIntFromInterval(-1,1)),this.scene.add(s),s.userData.who=()=>{console.log("WHOOOOO",s.id)},s.addEventListener("click",o=>{o.stopPropagation(),this.signalRService.testSendXXX1(),console.log(s)}),s.addEventListener("mouseover",o=>{o.target.userData.c=o.target.material.clone().color,o.target.material.color.set(16711680),document.body.style.cursor="pointer"}),s.addEventListener("mouseout",o=>{let a=o.target.userData.c;o.target.material.color.set(a.r,a.g,a.b),document.body.style.cursor="default"}),this.interactionManager.add(s)}loadGame(){this.dalService.getGameById("xx").subscribe(t=>{console.log(t)})}static#e=this.\u0275fac=function(i){return new(i||n)(ne(qee),ne(wte))};static#t=this.\u0275cmp=Rr({type:n,selectors:[["app-game-play"]],viewQuery:function(i,r){if(1&i&&K_(lne,7),2&i){let s;pl(s=ml())&&(r.rendererContainer=s.first)}},decls:10,vars:3,consts:[[3,"ngModel","ngModelChange"],[3,"onClick"],[3,"ngModel","binary","ngModelChange"],[2,"width","500px","height","500px","border","1px dashed red"],["rendererContainer",""]],template:function(i,r){1&i&&(en(0,"div"),zr(1,"XXX 1"),tn(),en(2,"input",0),dn("ngModelChange",function(o){return r.checked=o}),tn(),en(3,"p-button",1),dn("onClick",function(){return r.click1()}),zr(4,"b"),tn(),en(5,"p-checkbox",2),dn("ngModelChange",function(o){return r.checked=o}),tn(),en(6,"p-button",1),dn("onClick",function(){return r.loadGame()}),zr(7,"load game"),tn(),Hi(8,"div",3,4)),2&i&&(Tt(2),ut("ngModel",r.checked),Tt(3),ut("ngModel",r.checked)("binary",!0))},dependencies:[ip,_1,O0,WO,$O]})}return n})(),qO=(()=>{class n{constructor(t){this.router=t}canActivate(){return!0}static#e=this.\u0275fac=function(i){return new(i||n)(xe(xi))};static#t=this.\u0275prov=Pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const une=[{path:"",redirectTo:"/home",pathMatch:"full"},{path:"home",component:(()=>{class n{constructor(t){this.router=t}click1(){this.router.navigateByUrl("/game-play/123")}static#e=this.\u0275fac=function(i){return new(i||n)(ne(xi))};static#t=this.\u0275cmp=Rr({type:n,selectors:[["app-home-view"]],decls:4,vars:0,consts:[[3,"onClick"]],template:function(i,r){1&i&&(en(0,"p"),zr(1,"home-view works!"),tn(),en(2,"p-button",0),dn("onClick",function(){return r.click1()}),zr(3,"game"),tn())},dependencies:[WO]})}return n})(),canActivate:[qO]},{path:"game-play/:id",component:cne,canActivate:[qO]},{path:"**",redirectTo:"/home"}];let dne=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=jn({type:n});static#n=this.\u0275inj=Un({imports:[tP.forRoot(une),tP]})}return n})(),hne=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=Rr({type:n,selectors:[["app-root"]],decls:2,vars:0,template:function(i,r){1&i&&(zr(0,"i am app.component\n"),Hi(1,"router-outlet"))},dependencies:[rE]})}return n})(),fne=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=jn({type:n,bootstrap:[hne]});static#n=this.\u0275inj=Un({imports:[nI,d$,y6,dne,qte,ane,yte]})}return n})();l8().bootstrapModule(fne).catch(n=>console.error(n))}},Rt=>{Rt(Rt.s=846)}]);