(self.webpackChunkmgx=self.webpackChunkmgx||[]).push([[179],{241:($s,_o,yo)=>{"use strict";function fn(n){return"function"==typeof n}function B(n){const t=n(i=>{Error.call(i),i.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const vo=B(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function ws(n,e){if(n){const t=n.indexOf(e);0<=t&&n.splice(t,1)}}class mi{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:i}=this;if(fn(i))try{i()}catch(s){e=s instanceof vo?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{dr(s)}catch(o){e=e??[],o instanceof vo?e=[...e,...o.errors]:e.push(o)}}if(e)throw new vo(e)}}add(e){var t;if(e&&e!==this)if(this.closed)dr(e);else{if(e instanceof mi){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&ws(t,e)}remove(e){const{_finalizers:t}=this;t&&ws(t,e),e instanceof mi&&e._removeParent(this)}}mi.EMPTY=(()=>{const n=new mi;return n.closed=!0,n})();const ai=mi.EMPTY;function ll(n){return n instanceof mi||n&&"closed"in n&&fn(n.remove)&&fn(n.add)&&fn(n.unsubscribe)}function dr(n){fn(n)?n():n.unsubscribe()}const Eo={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},hr={setTimeout(n,e,...t){const{delegate:i}=hr;return i?.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){const{delegate:e}=hr;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function fr(n){hr.setTimeout(()=>{const{onUnhandledError:e}=Eo;if(!e)throw n;e(n)})}function cl(){}const Ea=Ui("C",void 0,void 0);function Ui(n,e,t){return{kind:n,value:e,error:t}}let Dr=null;function js(n){if(Eo.useDeprecatedSynchronousErrorHandling){const e=!Dr;if(e&&(Dr={errorThrown:!1,error:null}),n(),e){const{errorThrown:t,error:i}=Dr;if(Dr=null,t)throw i}}else n()}class qs extends mi{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,ll(e)&&e.add(this)):this.destination=Ke}static create(e,t,i){return new qt(e,t,i)}next(e){this.isStopped?yt(function oc(n){return Ui("N",n,void 0)}(e),this):this._next(e)}error(e){this.isStopped?yt(function ba(n){return Ui("E",void 0,n)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?yt(Ea,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Br=Function.prototype.bind;function es(n,e){return Br.call(n,e)}class Mn{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){Xs(i)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){Xs(i)}else Xs(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Xs(t)}}}class qt extends qs{constructor(e,t,i){let r;if(super(),fn(e)||!e)r={next:e??void 0,error:t??void 0,complete:i??void 0};else{let s;this&&Eo.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&es(e.next,s),error:e.error&&es(e.error,s),complete:e.complete&&es(e.complete,s)}):r=e}this.destination=new Mn(r)}}function Xs(n){Eo.useDeprecatedSynchronousErrorHandling?function Bi(n){Eo.useDeprecatedSynchronousErrorHandling&&Dr&&(Dr.errorThrown=!0,Dr.error=n)}(n):fr(n)}function yt(n,e){const{onStoppedNotification:t}=Eo;t&&hr.setTimeout(()=>t(n,e))}const Ke={closed:!0,next:cl,error:function dh(n){throw n},complete:cl},Be="function"==typeof Symbol&&Symbol.observable||"@@observable";function Qe(n){return n}function It(n){return 0===n.length?Qe:1===n.length?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}let qe=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){const i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){const s=function Qn(n){return n&&n instanceof qs||function Jn(n){return n&&fn(n.next)&&fn(n.error)&&fn(n.complete)}(n)&&ll(n)}(t)?t:new qt(t,i,r);return js(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return new(i=tn(i))((r,s)=>{const o=new qt({next:a=>{try{t(a)}catch(l){s(l),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(t){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(t)}[Be](){return this}pipe(...t){return It(t)(this)}toPromise(t){return new(t=tn(t))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return n.create=e=>new n(e),n})();function tn(n){var e;return null!==(e=n??Eo.Promise)&&void 0!==e?e:Promise}const An=B(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Un=(()=>{class n extends qe{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const i=new Go(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new An}next(t){js(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(t)}})}error(t){js(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){js(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:i,isStopped:r,observers:s}=this;return i||r?ai:(this.currentObservers=null,s.push(t),new mi(()=>{this.currentObservers=null,ws(s,t)}))}_checkFinalizedStatuses(t){const{hasError:i,thrownError:r,isStopped:s}=this;i?t.error(r):s&&t.complete()}asObservable(){const t=new qe;return t.source=this,t}}return n.create=(e,t)=>new Go(e,t),n})();class Go extends Un{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===i||i.call(t,e)}error(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===i||i.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,i;return null!==(i=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==i?i:ai}}function bo(n){return fn(n?.lift)}function gn(n){return e=>{if(bo(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function mn(n,e,t,i,r){return new pr(n,e,t,i,r)}class pr extends qs{constructor(e,t,i,r,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(l){e.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function Rt(n,e){return gn((t,i)=>{let r=0;t.subscribe(mn(i,s=>{i.next(n.call(e,s,r++))}))})}function So(n){return this instanceof So?(this.v=n,this):new So(n)}function gh(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=n[Symbol.asyncIterator];return e?e.call(n):(n=function Tm(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(o){return new Promise(function(a,l){!function r(s,o,a,l){Promise.resolve(l).then(function(c){s({value:c,done:a})},o)}(a,l,(o=n[s](o)).done,o.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const fv=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function pv(n){return fn(n?.then)}function mv(n){return fn(n[Be])}function Nm(n){return Symbol.asyncIterator&&fn(n?.[Symbol.asyncIterator])}function gv(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const _v=function Vw(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function _h(n){return fn(n?.[_v])}function yv(n){return function mh(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=t.apply(n,e||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(p){i[p]&&(r[p]=function(m){return new Promise(function(_,E){s.push([p,m,_,E])>1||a(p,m)})})}function a(p,m){try{!function l(p){p.value instanceof So?Promise.resolve(p.value.v).then(c,d):f(s[0][2],p)}(i[p](m))}catch(_){f(s[0][3],_)}}function c(p){a("next",p)}function d(p){a("throw",p)}function f(p,m){p(m),s.shift(),s.length&&a(s[0][0],s[0][1])}}(this,arguments,function*(){const t=n.getReader();try{for(;;){const{value:i,done:r}=yield So(t.read());if(r)return yield So(void 0);yield yield So(i)}}finally{t.releaseLock()}})}function yh(n){return fn(n?.getReader)}function ns(n){if(n instanceof qe)return n;if(null!=n){if(mv(n))return function Hw(n){return new qe(e=>{const t=n[Be]();if(fn(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(fv(n))return function zw(n){return new qe(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}(n);if(pv(n))return function Gw(n){return new qe(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,fr)})}(n);if(Nm(n))return vv(n);if(_h(n))return function Ww(n){return new qe(e=>{for(const t of n)if(e.next(t),e.closed)return;e.complete()})}(n);if(yh(n))return function $w(n){return vv(yv(n))}(n)}throw gv(n)}function vv(n){return new qe(e=>{(function jw(n,e){var t,i,r,s;return function cc(n,e,t,i){return new(t||(t=Promise))(function(s,o){function a(d){try{c(i.next(d))}catch(f){o(f)}}function l(d){try{c(i.throw(d))}catch(f){o(f)}}function c(d){d.done?s(d.value):function r(s){return s instanceof t?s:new t(function(o){o(s)})}(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=gh(n);!(i=yield t.next()).done;)if(e.next(i.value),e.closed)return}catch(o){r={error:o}}finally{try{i&&!i.done&&(s=t.return)&&(yield s.call(t))}finally{if(r)throw r.error}}e.complete()})})(n,e).catch(t=>e.error(t))})}function wo(n,e,t,i=0,r=!1){const s=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(s),!r)return s}function er(n,e,t=1/0){return fn(e)?er((i,r)=>Rt((s,o)=>e(i,s,r,o))(ns(n(i,r))),t):("number"==typeof e&&(t=e),gn((i,r)=>function qw(n,e,t,i,r,s,o,a){const l=[];let c=0,d=0,f=!1;const p=()=>{f&&!l.length&&!c&&e.complete()},m=E=>c<i?_(E):l.push(E),_=E=>{s&&e.next(E),c++;let v=!1;ns(t(E,d++)).subscribe(mn(e,y=>{r?.(y),s?m(y):e.next(y)},()=>{v=!0},void 0,()=>{if(v)try{for(c--;l.length&&c<i;){const y=l.shift();o?wo(e,o,()=>_(y)):_(y)}p()}catch(y){e.error(y)}}))};return n.subscribe(mn(e,m,()=>{f=!0,p()})),()=>{a?.()}}(i,r,n,t)))}function hc(n=1/0){return er(Qe,n)}const Mo=new qe(n=>n.complete());function Lm(n){return n[n.length-1]}function Cu(n){return fn(Lm(n))?n.pop():void 0}function Au(n){return function vh(n){return n&&fn(n.schedule)}(Lm(n))?n.pop():void 0}function Ev(n,e=0){return gn((t,i)=>{t.subscribe(mn(i,r=>wo(i,n,()=>i.next(r),e),()=>wo(i,n,()=>i.complete(),e),r=>wo(i,n,()=>i.error(r),e)))})}function Om(n,e=0){return gn((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function wv(n,e){if(!n)throw new Error("Iterable cannot be null");return new qe(t=>{wo(t,e,()=>{const i=n[Symbol.asyncIterator]();wo(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function gi(n,e){return e?function Mv(n,e){if(null!=n){if(mv(n))return function bv(n,e){return ns(n).pipe(Om(e),Ev(e))}(n,e);if(fv(n))return function Kw(n,e){return new qe(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}(n,e);if(pv(n))return function Sv(n,e){return ns(n).pipe(Om(e),Ev(e))}(n,e);if(Nm(n))return wv(n,e);if(_h(n))return function Zw(n,e){return new qe(t=>{let i;return wo(t,e,()=>{i=n[_v](),wo(t,e,()=>{let r,s;try{({value:r,done:s}=i.next())}catch(o){return void t.error(o)}s?t.complete():t.next(r)},0,!0)}),()=>fn(i?.return)&&i.return()})}(n,e);if(yh(n))return function Jw(n,e){return wv(yv(n),e)}(n,e)}throw gv(n)}(n,e):ns(n)}class Vr extends Un{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}}function vt(...n){return gi(n,Au(n))}function Fm(n={}){const{connector:e=(()=>new Un),resetOnError:t=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=n;return s=>{let o,a,l,c=0,d=!1,f=!1;const p=()=>{a?.unsubscribe(),a=void 0},m=()=>{p(),o=l=void 0,d=f=!1},_=()=>{const E=o;m(),E?.unsubscribe()};return gn((E,v)=>{c++,!f&&!d&&p();const y=l=l??e();v.add(()=>{c--,0===c&&!f&&!d&&(a=fc(_,r))}),y.subscribe(v),!o&&c>0&&(o=new qt({next:S=>y.next(S),error:S=>{f=!0,p(),a=fc(m,t,S),y.error(S)},complete:()=>{d=!0,p(),a=fc(m,i),y.complete()}}),ns(E).subscribe(o))})(s)}}function fc(n,e,...t){if(!0===e)return void n();if(!1===e)return;const i=new qt({next:()=>{i.unsubscribe(),n()}});return ns(e(...t)).subscribe(i)}function Ms(n,e){return gn((t,i)=>{let r=null,s=0,o=!1;const a=()=>o&&!r&&i.complete();t.subscribe(mn(i,l=>{r?.unsubscribe();let c=0;const d=s++;ns(n(l,d)).subscribe(r=mn(i,f=>i.next(e?e(l,f,d,c++):f),()=>{r=null,a()}))},()=>{o=!0,a()}))})}function Tv(n,e){return n===e}function _n(n){for(let e in n)if(n[e]===_n)return e;throw Error("Could not find renamed property on target object.")}function pc(n,e){for(const t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function Ai(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(Ai).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function Eh(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const km=_n({__forward_ref__:_n});function vn(n){return n.__forward_ref__=vn,n.toString=function(){return Ai(this())},n}function ht(n){return bh(n)?n():n}function bh(n){return"function"==typeof n&&n.hasOwnProperty(km)&&n.__forward_ref__===vn}function Sh(n){return n&&!!n.\u0275providers}class re extends Error{constructor(e,t){super(function Du(n,e){return`NG0${Math.abs(n)}${e?": "+e:""}`}(e,t)),this.code=e}}function xt(n){return"string"==typeof n?n:null==n?"":String(n)}function Bm(n,e){throw new re(-201,!1)}function xs(n,e){null==n&&function Et(n,e,t,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${t} ${i} ${e} <=Actual]`))}(e,n,null,"!=")}function tt(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Vi(n){return{providers:n.providers||[],imports:n.imports||[]}}function wa(n){return wh(n,Ru)||wh(n,Vm)}function wh(n,e){return n.hasOwnProperty(e)?n[e]:null}function Iu(n){return n&&(n.hasOwnProperty(Mh)||n.hasOwnProperty(Iv))?n[Mh]:null}const Ru=_n({\u0275prov:_n}),Mh=_n({\u0275inj:_n}),Vm=_n({ngInjectableDef:_n}),Iv=_n({ngInjectorDef:_n});var Xt=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(Xt||{});let Ir;function Hn(n){const e=Ir;return Ir=n,e}function Pv(n,e,t){const i=wa(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&Xt.Optional?null:void 0!==e?e:void Bm(Ai(n))}const un=globalThis,Nu={},Th="__NG_DI_FLAG__",Lu="ngTempTokenPath",qm=/\n/gm,Ov="__source";let Ma;function xa(n){const e=Ma;return Ma=n,e}function Fv(n,e=Xt.Default){if(void 0===Ma)throw new re(-203,!1);return null===Ma?Pv(n,void 0,e):Ma.get(n,e&Xt.Optional?null:void 0,e)}function Ne(n,e=Xt.Default){return(function Rv(){return Ir}()||Fv)(ht(n),e)}function Ve(n,e=Xt.Default){return Ne(n,Ou(e))}function Ou(n){return typeof n>"u"||"number"==typeof n?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Ah(n){const e=[];for(let t=0;t<n.length;t++){const i=ht(n[t]);if(Array.isArray(i)){if(0===i.length)throw new re(900,!1);let r,s=Xt.Default;for(let o=0;o<i.length;o++){const a=i[o],l=oM(a);"number"==typeof l?-1===l?r=a.token:s|=l:r=a}e.push(Ne(r,s))}else e.push(Ne(i))}return e}function Fu(n,e){return n[Th]=e,n.prototype[Th]=e,n}function oM(n){return n[Th]}function Wo(n){return{toString:n}.toString()}var $o=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}($o||{}),Cs=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(Cs||{});const To={},ln=[],ku=_n({\u0275cmp:_n}),Co=_n({\u0275dir:_n}),mc=_n({\u0275pipe:_n}),kv=_n({\u0275mod:_n}),jo=_n({\u0275fac:_n}),Uu=_n({__NG_ELEMENT_ID__:_n}),hl=_n({__NG_ENV_ID__:_n});function As(n,e,t){let i=n.length;for(;;){const r=n.indexOf(e,t);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const s=e.length;if(r+s===i||n.charCodeAt(r+s)<=32)return r}t=r+1}}function Dh(n,e,t){let i=0;for(;i<t.length;){const r=t[i];if("number"==typeof r){if(0!==r)break;i++;const s=t[i++],o=t[i++],a=t[i++];n.setAttribute(e,o,a,s)}else{const s=r,o=t[++i];Bv(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),i++}}return i}function Uv(n){return 3===n||4===n||6===n}function Bv(n){return 64===n.charCodeAt(0)}function Bu(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?t=r:0===t||Vv(n,t,r,null,-1===t||2===t?e[++i]:null)}}return n}function Vv(n,e,t,i,r){let s=0,o=n.length;if(-1===e)o=-1;else for(;s<n.length;){const a=n[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<n.length;){const a=n[s];if("number"==typeof a)break;if(a===t){if(null===i)return void(null!==r&&(n[s+1]=r));if(i===n[s+1])return void(n[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),null!==i&&n.splice(s++,0,i),null!==r&&n.splice(s++,0,r)}const Hv="ng-template";function Ih(n,e,t){let i=0,r=!0;for(;i<n.length;){let s=n[i++];if("string"==typeof s&&r){const o=n[i++];if(t&&"class"===s&&-1!==As(o.toLowerCase(),e,0))return!0}else{if(1===s){for(;i<n.length&&"string"==typeof(s=n[i++]);)if(s.toLowerCase()===e)return!0;return!1}"number"==typeof s&&(r=!1)}}return!1}function j(n){return 4===n.type&&n.value!==Hv}function ae(n,e,t){return e===(4!==n.type||t?n.value:Hv)}function ne(n,e,t){let i=4;const r=n.attrs||[],s=function Dn(n){for(let e=0;e<n.length;e++)if(Uv(n[e]))return e;return n.length}(r);let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&i){if(i=2|1&i,""!==l&&!ae(n,l,t)||""===l&&1===e.length){if(Fe(i))return!1;o=!0}}else{const c=8&i?l:e[++a];if(8&i&&null!==n.attrs){if(!Ih(n.attrs,c,t)){if(Fe(i))return!1;o=!0}continue}const f=Pt(8&i?"class":l,r,j(n),t);if(-1===f){if(Fe(i))return!1;o=!0;continue}if(""!==c){let p;p=f>s?"":r[f+1].toLowerCase();const m=8&i?p:null;if(m&&-1!==As(m,c,0)||2&i&&c!==p){if(Fe(i))return!1;o=!0}}}}else{if(!o&&!Fe(i)&&!Fe(l))return!1;if(o&&Fe(l))continue;o=!1,i=l|1&i}}return Fe(i)||o}function Fe(n){return 0==(1&n)}function Pt(n,e,t,i){if(null===e)return-1;let r=0;if(i||!t){let s=!1;for(;r<e.length;){const o=e[r];if(o===n)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function Ym(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const i=n[t];if("number"==typeof i)return-1;if(i===e)return t;t++}return-1}(e,n)}function pn(n,e,t=!1){for(let i=0;i<e.length;i++)if(ne(n,e[i],t))return!0;return!1}function cM(n,e){e:for(let t=0;t<e.length;t++){const i=e[t];if(n.length===i.length){for(let r=0;r<n.length;r++)if(n[r]!==i[r])continue e;return!0}}return!1}function rs(n,e){return n?":not("+e.trim()+")":e}function Rh(n){let e=n[0],t=1,i=2,r="",s=!1;for(;t<n.length;){let o=n[t];if("string"==typeof o)if(2&i){const a=n[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!Fe(o)&&(e+=rs(s,r),r=""),i=o,s=s||!Fe(i);t++}return""!==r&&(e+=rs(s,r)),e}function ss(n){return Wo(()=>{const e=Km(n),t={...e,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===$o.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Cs.Emulated,styles:n.styles||ln,_:null,schemas:n.schemas||null,tView:null,id:""};Zm(t);const i=n.dependencies;return t.directiveDefs=pl(i,!1),t.pipeDefs=pl(i,!0),t.id=function Vu(n){let e=0;const t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(const r of t)e=Math.imul(31,e)+r.charCodeAt(0)<<0;return e+=2147483648,"c"+e}(t),t})}function En(n){return Jt(n)||Wn(n)}function dM(n){return null!==n}function tr(n){return Wo(()=>({type:n.type,bootstrap:n.bootstrap||ln,declarations:n.declarations||ln,imports:n.imports||ln,exports:n.exports||ln,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function zv(n,e){if(null==n)return To;const t={};for(const i in n)if(n.hasOwnProperty(i)){let r=n[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),t[r]=i,e&&(e[r]=s)}return t}function _t(n){return Wo(()=>{const e=Km(n);return Zm(e),e})}function Jt(n){return n[ku]||null}function Wn(n){return n[Co]||null}function Hi(n){return n[mc]||null}function gr(n,e){const t=n[kv]||null;if(!t&&!0===e)throw new Error(`Type ${Ai(n)} does not have '\u0275mod' property.`);return t}function Km(n){const e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||To,exportAs:n.exportAs||null,standalone:!0===n.standalone,signals:!0===n.signals,selectors:n.selectors||ln,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:zv(n.inputs,e),outputs:zv(n.outputs)}}function Zm(n){n.features?.forEach(e=>e(n))}function pl(n,e){if(!n)return null;const t=e?Hi:En;return()=>("function"==typeof n?n():n).map(i=>t(i)).filter(dM)}const xn=0,ke=1,Ot=2,$n=3,Zs=4,Ta=5,Ii=6,Ca=7,ui=8,qo=9,_c=10,Ct=11,ei=12,nr=13,yc=14,di=15,vc=16,Ec=17,Ds=18,Xo=19,Lh=20,os=21,as=22,Yo=23,Aa=24,Ut=25,Jm=1,Wv=2,Ao=7,Ko=9,zi=11;function Ri(n){return Array.isArray(n)&&"object"==typeof n[Jm]}function Gi(n){return Array.isArray(n)&&!0===n[Jm]}function zr(n){return 0!=(4&n.flags)}function Bt(n){return n.componentOffset>-1}function Fh(n){return 1==(1&n.flags)}function Js(n){return!!n.template}function Qm(n){return 0!=(512&n[Ot])}function gl(n,e){return n.hasOwnProperty(jo)?n[jo]:null}let ir=null,Hu=!1;function ls(n){const e=ir;return ir=n,e}const jv={version:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{}};function kh(n){if(!zu(n)||n.dirty){if(!n.producerMustRecompute(n)&&!Io(n))return void(n.dirty=!1);n.producerRecomputeValue(n),n.dirty=!1}}function Xv(n){n.dirty=!0,function bc(n){if(void 0===n.liveConsumerNode)return;const e=Hu;Hu=!0;try{for(const t of n.liveConsumerNode)t.dirty||Xv(t)}finally{Hu=e}}(n),n.consumerMarkedDirty?.(n)}function Uh(n){return n&&(n.nextProducerIndex=0),ls(n)}function eg(n,e){if(ls(e),n&&void 0!==n.producerNode&&void 0!==n.producerIndexOfThis&&void 0!==n.producerLastReadVersion){if(zu(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)Rr(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function Io(n){_l(n);for(let e=0;e<n.producerNode.length;e++){const t=n.producerNode[e],i=n.producerLastReadVersion[e];if(i!==t.version||(kh(t),i!==t.version))return!0}return!1}function Bh(n){if(_l(n),zu(n))for(let e=0;e<n.producerNode.length;e++)Rr(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function Rr(n,e){if(function tg(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}(n),_l(n),1===n.liveConsumerNode.length)for(let i=0;i<n.producerNode.length;i++)Rr(n.producerNode[i],n.producerIndexOfThis[i]);const t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){const i=n.liveConsumerIndexOfThis[e],r=n.liveConsumerNode[e];_l(r),r.producerIndexOfThis[i]=e}}function zu(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function _l(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}let ng=null;const Wh=()=>{},vM=(()=>({...jv,consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:n=>{n.schedule(n.ref)},hasRun:!1,cleanupFn:Wh}))();class Zv{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function Is(){return Jv}function Jv(n){return n.type.prototype.ngOnChanges&&(n.setInput=EM),Gu}function Gu(){const n=jh(this),e=n?.current;if(e){const t=n.previous;if(t===To)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function EM(n,e,t,i){const r=this.declaredInputs[t],s=jh(n)||function e0(n,e){return n[Qv]=e}(n,{previous:To,current:null}),o=s.current||(s.current={}),a=s.previous,l=a[r];o[r]=new Zv(l&&l.currentValue,e,a===To),n[i]=e}Is.ngInherit=!0;const Qv="__ngSimpleChanges__";function jh(n){return n[Qv]||null}const Ro=function(n,e,t){};function Ln(n){for(;Array.isArray(n);)n=n[xn];return n}function $u(n,e){return Ln(e[n])}function Nr(n,e){return Ln(e[n.index])}function ju(n,e){return n.data[e]}function Gr(n,e){const t=e[n];return Ri(t)?t:t[xn]}function Oa(n,e){return null==e?null:n[e]}function Xh(n){n[Ec]=0}function s0(n){1024&n[Ot]||(n[Ot]|=1024,o0(n,1))}function Yh(n){1024&n[Ot]&&(n[Ot]&=-1025,o0(n,-1))}function o0(n,e){let t=n[$n];if(null===t)return;t[Ta]+=e;let i=t;for(t=t[$n];null!==t&&(1===e&&1===i[Ta]||-1===e&&0===i[Ta]);)t[Ta]+=e,i=t,t=t[$n]}const bt={lFrame:fg(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function cs(){return bt.bindingsEnabled}function Mc(){return null!==bt.skipHydrationRootTNode}function me(){return bt.lFrame.lView}function nn(){return bt.lFrame.tView}function Qh(n){return bt.lFrame.contextLView=n,n[ui]}function xc(n){return bt.lFrame.contextLView=null,n}function Wi(){let n=ef();for(;null!==n&&64===n.type;)n=n.parent;return n}function ef(){return bt.lFrame.currentTNode}function Rs(n,e){const t=bt.lFrame;t.currentTNode=n,t.isParent=e}function qu(){return bt.lFrame.isParent}function Po(){bt.lFrame.isParent=!1}function Cc(){return bt.lFrame.bindingIndex++}function Qo(n){const e=bt.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function TM(n,e){const t=bt.lFrame;t.bindingIndex=t.bindingRootIndex=n,tf(e)}function tf(n){bt.lFrame.currentDirectiveIndex=n}function eo(){return bt.lFrame.currentQueryIndex}function dg(n){bt.lFrame.currentQueryIndex=n}function CM(n){const e=n[ke];return 2===e.type?e.declTNode:1===e.type?n[Ii]:null}function Xu(n,e,t){if(t&Xt.SkipSelf){let r=e,s=n;for(;!(r=r.parent,null!==r||t&Xt.Host||(r=CM(s),null===r||(s=s[yc],10&r.type))););if(null===r)return!1;e=r,n=s}const i=bt.lFrame=hg();return i.currentTNode=e,i.lView=n,!0}function Fa(n){const e=hg(),t=n[ke];bt.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function hg(){const n=bt.lFrame,e=null===n?null:n.child;return null===e?fg(n):e}function fg(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function p0(){const n=bt.lFrame;return bt.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const pg=p0;function ka(){const n=p0();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function vr(){return bt.lFrame.selectedIndex}function Ua(n){bt.lFrame.selectedIndex=n}function On(){const n=bt.lFrame;return ju(n.tView,n.selectedIndex)}function nf(){bt.lFrame.currentNamespace="svg"}let gg=!0;function El(){return gg}function ea(n){gg=n}function af(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){const s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:d}=s;o&&(n.contentHooks??=[]).push(-t,o),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),l&&(n.viewHooks??=[]).push(-t,l),c&&((n.viewHooks??=[]).push(t,c),(n.viewCheckHooks??=[]).push(t,c)),null!=d&&(n.destroyHooks??=[]).push(t,d)}}function Ku(n,e,t){yg(n,e,3,t)}function Ps(n,e,t,i){(3&n[Ot])===t&&yg(n,e,t,i)}function lf(n,e){let t=n[Ot];(3&t)===e&&(t&=8191,t+=1,n[Ot]=t)}function yg(n,e,t,i){const s=i??-1,o=e.length-1;let a=0;for(let l=void 0!==i?65535&n[Ec]:0;l<o;l++)if("number"==typeof e[l+1]){if(a=e[l],null!=i&&a>=i)break}else e[l]<0&&(n[Ec]+=65536),(a<s||-1==s)&&(_0(n,t,e,l),n[Ec]=(4294901760&n[Ec])+l+2),l++}function g0(n,e){Ro(4,n,e);const t=ls(null);try{e.call(n)}finally{ls(t),Ro(5,n,e)}}function _0(n,e,t,i){const r=t[i]<0,s=t[i+1],a=n[r?-t[i]:t[i]];r?n[Ot]>>13<n[Ec]>>16&&(3&n[Ot])===e&&(n[Ot]+=8192,g0(a,s)):g0(a,s)}const Ac=-1;class Zu{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function Qu(n){return n!==Ac}function to(n){return 32767&n}function bl(n,e){let t=function DM(n){return n>>16}(n),i=e;for(;t>0;)i=i[yc],t--;return i}let uf=!0;function Ni(n){const e=uf;return uf=n,e}const E0=255,Eg=5;let IM=0;const no={};function df(n,e){const t=No(n,e);if(-1!==t)return t;const i=e[ke];i.firstCreatePass&&(n.injectorIndex=e.length,bg(i.data,n),bg(e,null),bg(i.blueprint,null));const r=$i(n,e),s=n.injectorIndex;if(Qu(r)){const o=to(r),a=bl(r,e),l=a[ke].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|l[o+c]}return e[s+8]=r,s}function bg(n,e){n.push(0,0,0,0,0,0,0,0,e)}function No(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function $i(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;null!==r;){if(i=Mg(r),null===i)return Ac;if(t++,r=r[yc],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return Ac}function ed(n,e,t){!function RM(n,e,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(Uu)&&(i=t[Uu]),null==i&&(i=t[Uu]=IM++);const r=i&E0;e.data[n+(r>>Eg)]|=1<<r}(n,e,t)}function hf(n,e,t){if(t&Xt.Optional||void 0!==n)return n;Bm()}function b0(n,e,t,i){if(t&Xt.Optional&&void 0===i&&(i=null),!(t&(Xt.Self|Xt.Host))){const r=n[qo],s=Hn(void 0);try{return r?r.get(e,i,t&Xt.Optional):Pv(e,i,t&Xt.Optional)}finally{Hn(s)}}return hf(i,0,t)}function S0(n,e,t,i=Xt.Default,r){if(null!==n){if(2048&e[Ot]&&!(i&Xt.Self)){const o=function wg(n,e,t,i,r){let s=n,o=e;for(;null!==s&&null!==o&&2048&o[Ot]&&!(512&o[Ot]);){const a=Ic(s,o,t,i|Xt.Self,no);if(a!==no)return a;let l=s.parent;if(!l){const c=o[Lh];if(c){const d=c.get(t,no,i);if(d!==no)return d}l=Mg(o),o=o[yc]}s=l}return r}(n,e,t,i,no);if(o!==no)return o}const s=Ic(n,e,t,i,no);if(s!==no)return s}return b0(e,t,i,r)}function Ic(n,e,t,i,r){const s=function NM(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(Uu)?n[Uu]:void 0;return"number"==typeof e?e>=0?e&E0:Sg:e}(t);if("function"==typeof s){if(!Xu(e,n,i))return i&Xt.Host?hf(r,0,i):b0(e,t,i,r);try{let o;if(o=s(i),null!=o||i&Xt.Optional)return o;Bm()}finally{pg()}}else if("number"==typeof s){let o=null,a=No(n,e),l=Ac,c=i&Xt.Host?e[di][Ii]:null;for((-1===a||i&Xt.SkipSelf)&&(l=-1===a?$i(n,e):e[a+8],l!==Ac&&x0(i,!1)?(o=e[ke],a=to(l),e=bl(l,e)):a=-1);-1!==a;){const d=e[ke];if(M0(s,a,d.data)){const f=w0(a,e,t,o,i,c);if(f!==no)return f}l=e[a+8],l!==Ac&&x0(i,e[ke].data[a+8]===c)&&M0(s,a,e)?(o=d,a=to(l),e=bl(l,e)):a=-1}}return r}function w0(n,e,t,i,r,s){const o=e[ke],a=o.data[n+8],d=td(a,o,t,null==i?Bt(a)&&uf:i!=o&&0!=(3&a.type),r&Xt.Host&&s===a);return null!==d?Sl(e,o,d,a):no}function td(n,e,t,i,r){const s=n.providerIndexes,o=e.data,a=1048575&s,l=n.directiveStart,d=s>>20,p=r?a+d:n.directiveEnd;for(let m=i?a:a+d;m<p;m++){const _=o[m];if(m<l&&t===_||m>=l&&_.type===t)return m}if(r){const m=o[l];if(m&&Js(m)&&m.type===t)return l}return null}function Sl(n,e,t,i){let r=n[t];const s=e.data;if(function ta(n){return n instanceof Zu}(r)){const o=r;o.resolving&&function eM(n,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new re(-200,`Circular dependency in DI detected for ${n}${t}`)}(function yn(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():xt(n)}(s[t]));const a=Ni(o.canSeeViewProviders);o.resolving=!0;const c=o.injectImpl?Hn(o.injectImpl):null;Xu(n,i,Xt.Default);try{r=n[t]=o.factory(void 0,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&function _g(n,e,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const o=Jv(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}r&&(t.preOrderHooks??=[]).push(0-n,r),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}(t,s[t],e)}finally{null!==c&&Hn(c),Ni(a),o.resolving=!1,pg()}}return r}function M0(n,e,t){return!!(t[e+(n>>Eg)]&1<<n)}function x0(n,e){return!(n&Xt.Self||n&Xt.Host&&e)}class Lr{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return S0(this._tNode,this._lView,e,Ou(i),t)}}function Sg(){return new Lr(Wi(),me())}function _i(n){return Wo(()=>{const e=n.prototype.constructor,t=e[jo]||wl(e),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const s=r[jo]||wl(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function wl(n){return bh(n)?()=>{const e=wl(ht(n));return e&&e()}:gl(n)}function Mg(n){const e=n[ke],t=e.type;return 2===t?e.declTNode:1===t?n[Ii]:null}const Ml="__parameters__";function xl(n,e,t){return Wo(()=>{const i=function xg(n){return function(...t){if(n){const i=n(...t);for(const r in i)this[r]=i[r]}}}(e);function r(...s){if(this instanceof r)return i.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(l,c,d){const f=l.hasOwnProperty(Ml)?l[Ml]:Object.defineProperty(l,Ml,{value:[]})[Ml];for(;f.length<=d;)f.push(null);return(f[d]=f[d]||[]).push(o),l}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}function Lc(n,e){n.forEach(t=>Array.isArray(t)?Lc(t,e):e(t))}function Tg(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function ff(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function id(n,e){const t=[];for(let i=0;i<n;i++)t.push(e);return t}function jn(n,e,t){let i=Oc(n,e);return i>=0?n[1|i]=t:(i=~i,function BM(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(1===r)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;)n[r]=n[r-2],r--;n[e]=t,n[e+1]=i}}(n,i,e,t)),i}function Cg(n,e){const t=Oc(n,e);if(t>=0)return n[1|t]}function Oc(n,e){return function Ag(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){const s=i+(r-i>>1),o=n[s<<t];if(e===o)return s<<t;o>e?r=s:i=s+1}return~(r<<t)}(n,e,1)}const mf=Fu(xl("Optional"),8),gf=Fu(xl("SkipSelf"),4);function Sf(n){return 128==(128&n.flags)}var Va=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(Va||{});const rx=/^>|^->|<!--|-->|--!>|<!-$/g,Mf=/(<|>)/g,sx="\u200b$1\u200b";const Fg=new Map;let ox=0;const Ug="__ngContext__";function rr(n,e){Ri(e)?(n[Ug]=e[Xo],function lx(n){Fg.set(n[Xo],n)}(e)):n[Ug]=e}let Hg;function zg(n,e){return Hg(n,e)}function Bc(n){const e=n[$n];return Gi(e)?e[$n]:e}function $0(n){return q0(n[ei])}function j0(n){return q0(n[Zs])}function q0(n){for(;null!==n&&!Gi(n);)n=n[Zs];return n}function Vc(n,e,t,i,r){if(null!=i){let s,o=!1;Gi(i)?s=i:Ri(i)&&(o=!0,i=i[xn]);const a=Ln(i);0===n&&null!==t?null==r?K0(e,t,a):Cl(e,t,a,r||null,!0):1===n&&null!==t?Cl(e,t,a,r||null,!0):2===n?function Nf(n,e,t){const i=Ls(n,e);i&&function jg(n,e,t,i){n.removeChild(e,t,i)}(n,i,e,t)}(e,a,o):3===n&&e.destroyNode(a),null!=s&&function Lf(n,e,t,i,r){const s=t[Ao];s!==Ln(t)&&Vc(e,n,i,s,r);for(let a=zi;a<t.length;a++){const l=t[a];Dl(l[ke],l,n,e,i,s)}}(e,n,s,t,r)}}function Wg(n,e){return n.createComment(function B0(n){return n.replace(rx,e=>e.replace(Mf,sx))}(e))}function Df(n,e,t){return n.createElement(e,t)}function Nt(n,e){const t=n[Ko],i=t.indexOf(e);Yh(e),t.splice(i,1)}function If(n,e){if(n.length<=zi)return;const t=zi+e,i=n[t];if(i){const r=i[vc];null!==r&&r!==n&&Nt(r,i),e>0&&(n[t-1][Zs]=i[Zs]);const s=ff(n,zi+e);!function px(n,e){Dl(n,e,e[Ct],2,null,null),e[xn]=null,e[Ii]=null}(i[ke],i);const o=s[Ds];null!==o&&o.detachView(s[ke]),i[$n]=null,i[Zs]=null,i[Ot]&=-129}return i}function Er(n,e){if(!(256&e[Ot])){const t=e[Ct];e[Yo]&&Bh(e[Yo]),e[Aa]&&Bh(e[Aa]),t.destroyNode&&Dl(n,e,t,3,null,null),function gx(n){let e=n[ei];if(!e)return ti(n[ke],n);for(;e;){let t=null;if(Ri(e))t=e[ei];else{const i=e[zi];i&&(t=i)}if(!t){for(;e&&!e[Zs]&&e!==n;)Ri(e)&&ti(e[ke],e),e=e[$n];null===e&&(e=n),Ri(e)&&ti(e[ke],e),t=e&&e[Zs]}e=t}}(e)}}function ti(n,e){if(!(256&e[Ot])){e[Ot]&=-129,e[Ot]|=256,function Ha(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let i=0;i<t.length;i+=2){const r=e[t[i]];if(!(r instanceof Zu)){const s=t[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],l=s[o+1];Ro(4,a,l);try{l.call(a)}finally{Ro(5,a,l)}}else{Ro(4,r,s);try{s.call(r)}finally{Ro(5,r,s)}}}}}(n,e),function yx(n,e){const t=n.cleanup,i=e[Ca];if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+3];o>=0?i[o]():i[-o].unsubscribe(),s+=2}else t[s].call(i[t[s+1]]);null!==i&&(e[Ca]=null);const r=e[os];if(null!==r){e[os]=null;for(let s=0;s<r.length;s++)(0,r[s])()}}(n,e),1===e[ke].type&&e[Ct].destroy();const t=e[vc];if(null!==t&&Gi(e[$n])){t!==e[$n]&&Nt(t,e);const i=e[Ds];null!==i&&i.detachView(n)}!function cx(n){Fg.delete(n[Xo])}(e)}}function $g(n,e,t){return function Y0(n,e,t){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return t[xn];{const{componentOffset:r}=i;if(r>-1){const{encapsulation:s}=n.data[i.directiveStart+r];if(s===Cs.None||s===Cs.Emulated)return null}return Nr(i,t)}}(n,e.parent,t)}function Cl(n,e,t,i,r){n.insertBefore(e,t,i,r)}function K0(n,e,t){n.appendChild(e,t)}function Z0(n,e,t,i,r){null!==i?Cl(n,e,t,i,r):K0(n,e,t)}function Ls(n,e){return n.parentNode(e)}function od(n,e,t){return ni(n,e,t)}let Rf,$r,ni=function qn(n,e,t){return 40&n.type?Nr(n,t):null};function Pf(n,e,t,i){const r=$g(n,i,e),s=e[Ct],a=od(i.parent||e[Ii],i,e);if(null!=r)if(Array.isArray(t))for(let l=0;l<t.length;l++)Z0(s,r,t[l],a,!1);else Z0(s,r,t,a,!1);void 0!==Rf&&Rf(s,i,e,t,r)}function ad(n,e){if(null!==e){const t=e.type;if(3&t)return Nr(e,n);if(4&t)return qg(-1,n[e.index]);if(8&t){const i=e.child;if(null!==i)return ad(n,i);{const r=n[e.index];return Gi(r)?qg(-1,r):Ln(r)}}if(32&t)return zg(e,n)()||Ln(n[e.index]);{const i=eE(n,e);return null!==i?Array.isArray(i)?i[0]:ad(Bc(n[di]),i):ad(n,e.next)}}return null}function eE(n,e){return null!==e?n[di][Ii].projection[e.projection]:null}function qg(n,e){const t=zi+n+1;if(t<e.length){const i=e[t],r=i[ke].firstChild;if(null!==r)return ad(i,r)}return e[Ao]}function Al(n,e,t,i,r,s,o){for(;null!=t;){const a=i[t.index],l=t.type;if(o&&0===e&&(a&&rr(Ln(a),i),t.flags|=2),32!=(32&t.flags))if(8&l)Al(n,e,t.child,i,r,s,!1),Vc(e,n,r,a,s);else if(32&l){const c=zg(t,i);let d;for(;d=c();)Vc(e,n,r,d,s);Vc(e,n,r,a,s)}else 16&l?Yg(n,e,i,t,r,s):Vc(e,n,r,a,s);t=o?t.projectionNext:t.next}}function Dl(n,e,t,i,r,s){Al(t,i,n.firstChild,e,r,s,!1)}function Yg(n,e,t,i,r,s){const o=t[di],l=o[Ii].projection[i.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++)Vc(e,n,r,l[c],s);else{let c=l;const d=o[$n];Sf(i)&&(c.flags|=128),Al(n,e,c,d,r,s,!0)}}function tE(n,e,t){""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function nE(n,e,t){const{mergedAttrs:i,classes:r,styles:s}=t;null!==i&&Dh(n,e,i),null!==r&&tE(n,e,r),null!==s&&function Hc(n,e,t){n.setAttribute(e,"style",t)}(n,e,s)}class aE{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}function za(n){return n instanceof aE?n.changingThisBreaksApplicationSecurity:n}class Ye{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=tt({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const hd=new Ye("ENVIRONMENT_INITIALIZER"),gE=new Ye("INJECTOR",-1),_E=new Ye("INJECTOR_DEF_TYPES");class r_{get(e,t=Nu){if(t===Nu){const i=new Error(`NullInjectorError: No provider for ${Ai(e)}!`);throw i.name="NullInjectorError",i}return t}}function Hx(...n){return{\u0275providers:yE(0,n),\u0275fromNgModule:!0}}function yE(n,...e){const t=[],i=new Set;let r;const s=o=>{t.push(o)};return Lc(e,o=>{const a=o;Uf(a,s,[],i)&&(r||=[],r.push(a))}),void 0!==r&&vE(r,s),t}function vE(n,e){for(let t=0;t<n.length;t++){const{ngModule:i,providers:r}=n[t];o_(r,s=>{e(s,i)})}}function Uf(n,e,t,i){if(!(n=ht(n)))return!1;let r=null,s=Iu(n);const o=!s&&Jt(n);if(s||o){if(o&&!o.standalone)return!1;r=n}else{const l=n.ngModule;if(s=Iu(l),!s)return!1;r=l}const a=i.has(r);if(o){if(a)return!1;if(i.add(r),o.dependencies){const l="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const c of l)Uf(c,e,t,i)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let c;i.add(r);try{Lc(s.imports,d=>{Uf(d,e,t,i)&&(c||=[],c.push(d))})}finally{}void 0!==c&&vE(c,e)}if(!a){const c=gl(r)||(()=>new r);e({provide:r,useFactory:c,deps:ln},r),e({provide:_E,useValue:r,multi:!0},r),e({provide:hd,useValue:()=>Ne(r),multi:!0},r)}const l=s.providers;if(null!=l&&!a){const c=n;o_(l,d=>{e(d,c)})}}}return r!==n&&void 0!==n.providers}function o_(n,e){for(let t of n)Sh(t)&&(t=t.\u0275providers),Array.isArray(t)?o_(t,e):e(t)}const zx=_n({provide:String,useValue:_n});function a_(n){return null!==n&&"object"==typeof n&&zx in n}function Ga(n){return"function"==typeof n}const l_=new Ye("Set Injector scope."),Vf={},Gx={};let fd;function Hf(){return void 0===fd&&(fd=new r_),fd}class hs{}class zf extends hs{get destroyed(){return this._destroyed}constructor(e,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,pd(e,o=>this.processProvider(o)),this.records.set(gE,$c(void 0,this)),r.has("environment")&&this.records.set(hs,$c(void 0,this));const s=this.records.get(l_);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(_E.multi,ln,Xt.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();const e=this._onDestroyHooks;this._onDestroyHooks=[];for(const t of e)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();const t=xa(this),i=Hn(void 0);try{return e()}finally{xa(t),Hn(i)}}get(e,t=Nu,i=Xt.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(hl))return e[hl](this);i=Ou(i);const s=xa(this),o=Hn(void 0);try{if(!(i&Xt.SkipSelf)){let l=this.records.get(e);if(void 0===l){const c=function jx(n){return"function"==typeof n||"object"==typeof n&&n instanceof Ye}(e)&&wa(e);l=c&&this.injectableDefInScope(c)?$c(Sr(e),Vf):null,this.records.set(e,l)}if(null!=l)return this.hydrate(e,l)}return(i&Xt.Self?Hf():this.parent).get(e,t=i&Xt.Optional&&t===Nu?null:t)}catch(a){if("NullInjectorError"===a.name){if((a[Lu]=a[Lu]||[]).unshift(Ai(e)),s)throw a;return function aM(n,e,t,i){const r=n[Lu];throw e[Ov]&&r.unshift(e[Ov]),n.message=function lM(n,e,t,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let r=Ai(e);if(Array.isArray(e))r=e.map(Ai).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):Ai(a)))}r=`{${s.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${n.replace(qm,"\n  ")}`}("\n"+n.message,r,t,i),n.ngTokenPath=r,n[Lu]=null,n}(a,e,"R3InjectorError",this.source)}throw a}finally{Hn(o),xa(s)}}resolveInjectorInitializers(){const e=xa(this),t=Hn(void 0);try{const r=this.get(hd.multi,ln,Xt.Self);for(const s of r)s()}finally{xa(e),Hn(t)}}toString(){const e=[],t=this.records;for(const i of t.keys())e.push(Ai(i));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new re(205,!1)}processProvider(e){let t=Ga(e=ht(e))?e:ht(e&&e.provide);const i=function Wx(n){return a_(n)?$c(void 0,n.useValue):$c(SE(n),Vf)}(e);if(Ga(e)||!0!==e.multi)this.records.get(t);else{let r=this.records.get(t);r||(r=$c(void 0,Vf,!0),r.factory=()=>Ah(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,i)}hydrate(e,t){return t.value===Vf&&(t.value=Gx,t.value=t.factory()),"object"==typeof t.value&&t.value&&function u_(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=ht(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){const t=this._onDestroyHooks.indexOf(e);-1!==t&&this._onDestroyHooks.splice(t,1)}}function Sr(n){const e=wa(n),t=null!==e?e.factory:gl(n);if(null!==t)return t;if(n instanceof Ye)throw new re(204,!1);if(n instanceof Function)return function c_(n){const e=n.length;if(e>0)throw id(e,"?"),new re(204,!1);const t=function Ts(n){return n&&(n[Ru]||n[Vm])||null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new re(204,!1)}function SE(n,e,t){let i;if(Ga(n)){const r=ht(n);return gl(r)||Sr(r)}if(a_(n))i=()=>ht(n.useValue);else if(function Bf(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...Ah(n.deps||[]));else if(function EE(n){return!(!n||!n.useExisting)}(n))i=()=>Ne(ht(n.useExisting));else{const r=ht(n&&(n.useClass||n.provide));if(!function $x(n){return!!n.deps}(n))return gl(r)||Sr(r);i=()=>new r(...Ah(n.deps))}return i}function $c(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function pd(n,e){for(const t of n)Array.isArray(t)?pd(t,e):t&&Sh(t)?pd(t.\u0275providers,e):e(t)}const Gf=new Ye("AppId",{providedIn:"root",factory:()=>qx}),qx="ng",wE=new Ye("Platform Initializer"),Wa=new Ye("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),ME=new Ye("AnimationModuleType"),xE=new Ye("CSP nonce",{providedIn:"root",factory:()=>function Gc(){if(void 0!==$r)return $r;if(typeof document<"u")return document;throw new re(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let AE=(n,e,t)=>null;function y_(n,e,t=!1){return AE(n,e,t)}class Ee{}class Ue{}class mt{resolveComponentFactory(e){throw function rt(n){const e=Error(`No component factory found for ${Ai(n)}.`);return e.ngComponent=n,e}(e)}}let zt=(()=>{class n{static#e=this.NULL=new mt}return n})();function sn(){return qi(Wi(),me())}function qi(n,e){return new Tn(Nr(n,e))}let Tn=(()=>{class n{constructor(t){this.nativeElement=t}static#e=this.__NG_ELEMENT_ID__=sn}return n})();function fs(n){return n instanceof Tn?n.nativeElement:n}class zn{}let vi=(()=>{class n{constructor(){this.destroyNode=null}static#e=this.__NG_ELEMENT_ID__=()=>function sa(){const n=me(),t=Gr(Wi().index,n);return(Ri(t)?t:n)[Ct]}()}return n})(),DE=(()=>{class n{static#e=this.\u0275prov=tt({token:n,providedIn:"root",factory:()=>null})}return n})();class v_{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const OH=new v_("16.2.9"),eT={};function OR(n,e=null,t=null,i){const r=FR(n,e,t,i);return r.resolveInjectorInitializers(),r}function FR(n,e=null,t=null,i,r=new Set){const s=[t||ln,Hx(n)];return i=i||("object"==typeof n?void 0:Ai(n)),new zf(s,e||Hf(),i||null,r)}let ro=(()=>{class n{static#e=this.THROW_IF_NOT_FOUND=Nu;static#t=this.NULL=new r_;static create(t,i){if(Array.isArray(t))return OR({name:""},i,t,"");{const r=t.name??"";return OR({name:r},t.parent,t.providers,r)}}static#n=this.\u0275prov=tt({token:n,providedIn:"any",factory:()=>Ne(gE)});static#i=this.__NG_ELEMENT_ID__=-1}return n})();function nT(n){return n.ngOriginalError}class Rl{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&nT(e);for(;t&&nT(t);)t=nT(t);return t||null}}function rT(n){return e=>{setTimeout(n,void 0,e)}}const Xn=class zH extends Un{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,i){let r=e,s=t||(()=>null),o=i;if(e&&"object"==typeof e){const l=e;r=l.next?.bind(l),s=l.error?.bind(l),o=l.complete?.bind(l)}this.__isAsync&&(s=rT(s),r&&(r=rT(r)),o&&(o=rT(o)));const a=super.subscribe({next:r,error:s,complete:o});return e instanceof mi&&e.add(a),a}};function UR(...n){}class In{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Xn(!1),this.onMicrotaskEmpty=new Xn(!1),this.onStable=new Xn(!1),this.onError=new Xn(!1),typeof Zone>"u")throw new re(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&t,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function GH(){const n="function"==typeof un.requestAnimationFrame;let e=un[n?"requestAnimationFrame":"setTimeout"],t=un[n?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&t){const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i);const r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function jH(n){const e=()=>{!function $H(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(un,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,oT(n),n.isCheckStableRunning=!0,sT(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),oT(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,r,s,o,a)=>{if(function XH(n){return!(!Array.isArray(n)||1!==n.length)&&!0===n[0].data?.__ignore_ng_zone__}(a))return t.invokeTask(r,s,o,a);try{return BR(n),t.invokeTask(r,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||n.shouldCoalesceRunChangeDetection)&&e(),VR(n)}},onInvoke:(t,i,r,s,o,a,l)=>{try{return BR(n),t.invoke(r,s,o,a,l)}finally{n.shouldCoalesceRunChangeDetection&&e(),VR(n)}},onHasTask:(t,i,r,s)=>{t.hasTask(r,s),i===r&&("microTask"==s.change?(n._hasPendingMicrotasks=s.microTask,oT(n),sT(n)):"macroTask"==s.change&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,i,r,s)=>(t.handleError(r,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!In.isInAngularZone())throw new re(909,!1)}static assertNotInAngularZone(){if(In.isInAngularZone())throw new re(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,WH,UR,UR);try{return s.runTask(o,t,i)}finally{s.cancelTask(o)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const WH={};function sT(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function oT(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function BR(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function VR(n){n._nesting--,sT(n)}class qH{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Xn,this.onMicrotaskEmpty=new Xn,this.onStable=new Xn,this.onError=new Xn}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}}const HR=new Ye("",{providedIn:"root",factory:zR});function zR(){const n=Ve(In);let e=!0;return function xv(...n){const e=Au(n),t=function Yw(n,e){return"number"==typeof Lm(n)?n.pop():e}(n,1/0),i=n;return i.length?1===i.length?ns(i[0]):hc(t)(gi(i,e)):Mo}(new qe(r=>{e=n.isStable&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks,n.runOutsideAngular(()=>{r.next(e),r.complete()})}),new qe(r=>{let s;n.runOutsideAngular(()=>{s=n.onStable.subscribe(()=>{In.assertNotInAngularZone(),queueMicrotask(()=>{!e&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks&&(e=!0,r.next(!0))})})});const o=n.onUnstable.subscribe(()=>{In.assertInAngularZone(),e&&(e=!1,n.runOutsideAngular(()=>{r.next(!1)}))});return()=>{s.unsubscribe(),o.unsubscribe()}}).pipe(Fm()))}function Pl(n){return n instanceof Function?n():n}let aT=(()=>{class n{constructor(){this.renderDepth=0,this.handler=null}begin(){this.handler?.validateBegin(),this.renderDepth++}end(){this.renderDepth--,0===this.renderDepth&&this.handler?.execute()}ngOnDestroy(){this.handler?.destroy(),this.handler=null}static#e=this.\u0275prov=tt({token:n,providedIn:"root",factory:()=>new n})}return n})();function E_(n){for(;n;){n[Ot]|=64;const e=Bc(n);if(Qm(n)&&!e)return n;n=e}return null}const qR=new Ye("",{providedIn:"root",factory:()=>!1});let RE=null;function ZR(n,e){return n[e]??eP()}function JR(n,e){const t=eP();t.producerNode?.length&&(n[e]=RE,t.lView=n,RE=QR())}const rz={...jv,consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{E_(n.lView)},lView:null};function QR(){return Object.create(rz)}function eP(){return RE??=QR(),RE}const Vt={};function Rn(n){tP(nn(),me(),vr()+n,!1)}function tP(n,e,t,i){if(!i)if(3==(3&e[Ot])){const s=n.preOrderCheckHooks;null!==s&&Ku(e,s,t)}else{const s=n.preOrderHooks;null!==s&&Ps(e,s,0,t)}Ua(t)}function ye(n,e=Xt.Default){const t=me();return null===t?Ne(n,e):S0(Wi(),t,ht(n),e)}function PE(n,e,t,i,r,s,o,a,l,c,d){const f=e.blueprint.slice();return f[xn]=r,f[Ot]=140|i,(null!==c||n&&2048&n[Ot])&&(f[Ot]|=2048),Xh(f),f[$n]=f[yc]=n,f[ui]=t,f[_c]=o||n&&n[_c],f[Ct]=a||n&&n[Ct],f[qo]=l||n&&n[qo]||null,f[Ii]=s,f[Xo]=function ax(){return ox++}(),f[as]=d,f[Lh]=c,f[di]=2==e.type?n[di]:f,f}function Yf(n,e,t,i,r){let s=n.data[e];if(null===s)s=function lT(n,e,t,i,r){const s=ef(),o=qu(),l=n.data[e]=function hz(n,e,t,i,r,s){let o=e?e.injectorIndex:-1,a=0;return Mc()&&(a|=128),{type:t,index:i,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,i,r);return null===n.firstChild&&(n.firstChild=l),null!==s&&(o?null==s.child&&null!==l.parent&&(s.child=l):null===s.next&&(s.next=l,l.prev=s)),l}(n,e,t,i,r),function h0(){return bt.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=t,s.value=i,s.attrs=r;const o=function Tc(){const n=bt.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return Rs(s,!0),s}function b_(n,e,t,i){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function iP(n,e,t,i,r){const s=ZR(e,Yo),o=vr(),a=2&i;try{Ua(-1),a&&e.length>Ut&&tP(n,e,Ut,!1),Ro(a?2:0,r);const c=a?s:null,d=Uh(c);try{null!==c&&(c.dirty=!1),t(i,r)}finally{eg(c,d)}}finally{a&&null===e[Yo]&&JR(e,Yo),Ua(o),Ro(a?3:1,r)}}function cT(n,e,t){if(zr(e)){const i=ls(null);try{const s=e.directiveEnd;for(let o=e.directiveStart;o<s;o++){const a=n.data[o];a.contentQueries&&a.contentQueries(1,t[o],o)}}finally{ls(i)}}}function uT(n,e,t){cs()&&(function vz(n,e,t,i){const r=t.directiveStart,s=t.directiveEnd;Bt(t)&&function Tz(n,e,t){const i=Nr(e,n),r=rP(t);let o=16;t.signals?o=4096:t.onPush&&(o=64);const a=NE(n,PE(n,r,null,o,i,e,null,n[_c].rendererFactory.createRenderer(i,t),null,null,null));n[e.index]=a}(e,t,n.data[r+t.componentOffset]),n.firstCreatePass||df(t,e),rr(i,e);const o=t.initialInputs;for(let a=r;a<s;a++){const l=n.data[a],c=Sl(e,n,a,t);rr(c,e),null!==o&&Cz(0,a-r,c,l,0,o),Js(l)&&(Gr(t.index,e)[ui]=Sl(e,n,a,t))}}(n,e,t,Nr(t,e)),64==(64&t.flags)&&cP(n,e,t))}function dT(n,e,t=Nr){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?t(e,n):n[o];n[r++]=a}}}function rP(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=hT(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function hT(n,e,t,i,r,s,o,a,l,c,d){const f=Ut+i,p=f+r,m=function oz(n,e){const t=[];for(let i=0;i<e;i++)t.push(i<n?null:Vt);return t}(f,p),_="function"==typeof c?c():c;return m[ke]={type:n,blueprint:m,template:t,queries:null,viewQuery:a,declTNode:e,data:m.slice().fill(null,f),bindingStartIndex:f,expandoStartIndex:p,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:_,incompleteFirstPass:!1,ssrId:d}}let sP=n=>null;function oP(n,e,t,i){for(let r in n)if(n.hasOwnProperty(r)){t=null===t?{}:t;const s=n[r];null===i?aP(t,e,r,s):i.hasOwnProperty(r)&&aP(t,e,i[r],s)}return t}function aP(n,e,t,i){n.hasOwnProperty(t)?n[t].push(e,i):n[t]=[e,i]}function fT(n,e,t,i){if(cs()){const r=null===i?null:{"":-1},s=function bz(n,e){const t=n.directiveRegistry;let i=null,r=null;if(t)for(let s=0;s<t.length;s++){const o=t[s];if(pn(e,o.selectors,!1))if(i||(i=[]),Js(o))if(null!==o.findHostDirectiveDefs){const a=[];r=r||new Map,o.findHostDirectiveDefs(o,a,r),i.unshift(...a,o),pT(n,e,a.length)}else i.unshift(o),pT(n,e,0);else r=r||new Map,o.findHostDirectiveDefs?.(o,i,r),i.push(o)}return null===i?null:[i,r]}(n,t);let o,a;null===s?o=a=null:[o,a]=s,null!==o&&lP(n,e,t,o,r,a),r&&function Sz(n,e,t){if(e){const i=n.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new re(-301,!1);i.push(e[r],s)}}}(t,i,r)}t.mergedAttrs=Bu(t.mergedAttrs,t.attrs)}function lP(n,e,t,i,r,s){for(let c=0;c<i.length;c++)ed(df(t,e),n,i[c].type);!function Mz(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}(t,n.data.length,i.length);for(let c=0;c<i.length;c++){const d=i[c];d.providersResolver&&d.providersResolver(d)}let o=!1,a=!1,l=b_(n,e,i.length,null);for(let c=0;c<i.length;c++){const d=i[c];t.mergedAttrs=Bu(t.mergedAttrs,d.hostAttrs),xz(n,t,e,l,d),wz(l,d,r),null!==d.contentQueries&&(t.flags|=4),(null!==d.hostBindings||null!==d.hostAttrs||0!==d.hostVars)&&(t.flags|=64);const f=d.type.prototype;!o&&(f.ngOnChanges||f.ngOnInit||f.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),o=!0),!a&&(f.ngOnChanges||f.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),l++}!function fz(n,e,t){const r=e.directiveEnd,s=n.data,o=e.attrs,a=[];let l=null,c=null;for(let d=e.directiveStart;d<r;d++){const f=s[d],p=t?t.get(f):null,_=p?p.outputs:null;l=oP(f.inputs,d,l,p?p.inputs:null),c=oP(f.outputs,d,c,_);const E=null===l||null===o||j(e)?null:Az(l,d,o);a.push(E)}null!==l&&(l.hasOwnProperty("class")&&(e.flags|=8),l.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=l,e.outputs=c}(n,t,s)}function cP(n,e,t){const i=t.directiveStart,r=t.directiveEnd,s=t.index,o=function f0(){return bt.lFrame.currentDirectiveIndex}();try{Ua(s);for(let a=i;a<r;a++){const l=n.data[a],c=e[a];tf(a),(null!==l.hostBindings||0!==l.hostVars||null!==l.hostAttrs)&&Ez(l,c)}}finally{Ua(-1),tf(o)}}function Ez(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function pT(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function wz(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;Js(e)&&(t[""]=n)}}function xz(n,e,t,i,r){n.data[i]=r;const s=r.factory||(r.factory=gl(r.type)),o=new Zu(s,Js(r),ye);n.blueprint[i]=o,t[i]=o,function _z(n,e,t,i,r){const s=r.hostBindings;if(s){let o=n.hostBindingOpCodes;null===o&&(o=n.hostBindingOpCodes=[]);const a=~e.index;(function yz(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(o)!=a&&o.push(a),o.push(t,i,s)}}(n,e,i,b_(n,t,r.hostVars,Vt),r)}function $a(n,e,t,i,r,s){const o=Nr(n,e);!function mT(n,e,t,i,r,s,o){if(null==s)n.removeAttribute(e,r,t);else{const a=null==o?xt(s):o(s,i||"",r);n.setAttribute(e,r,a,t)}}(e[Ct],o,s,n.value,t,i,r)}function Cz(n,e,t,i,r,s){const o=s[e];if(null!==o)for(let a=0;a<o.length;)uP(i,t,o[a++],o[a++],o[a++])}function uP(n,e,t,i,r){const s=ls(null);try{const o=n.inputTransforms;null!==o&&o.hasOwnProperty(i)&&(r=o[i].call(e,r)),null!==n.setInput?n.setInput(e,r,t,i):e[i]=r}finally{ls(s)}}function Az(n,e,t){let i=null,r=0;for(;r<t.length;){const s=t[r];if(0!==s)if(5!==s){if("number"==typeof s)break;if(n.hasOwnProperty(s)){null===i&&(i=[]);const o=n[s];for(let a=0;a<o.length;a+=2)if(o[a]===e){i.push(s,o[a+1],t[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function dP(n,e,t,i){return[n,!0,!1,e,null,0,i,t,null,null,null]}function hP(n,e){const t=n.contentQueries;if(null!==t)for(let i=0;i<t.length;i+=2){const s=t[i+1];if(-1!==s){const o=n.data[s];dg(t[i]),o.contentQueries(2,e[s],s)}}}function NE(n,e){return n[ei]?n[nr][Zs]=e:n[ei]=e,n[nr]=e,e}function gT(n,e,t){dg(0);const i=ls(null);try{e(n,t)}finally{ls(i)}}function fP(n){return n[Ca]||(n[Ca]=[])}function pP(n){return n.cleanup||(n.cleanup=[])}function gP(n,e){const t=n[qo],i=t?t.get(Rl,null):null;i&&i.handleError(e)}function _T(n,e,t,i,r){for(let s=0;s<t.length;){const o=t[s++],a=t[s++];uP(n.data[o],e[o],i,a,r)}}function Dz(n,e){const t=Gr(e,n),i=t[ke];!function Iz(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}(i,t);const r=t[xn];null!==r&&null===t[as]&&(t[as]=y_(r,t[qo])),yT(i,t,t[ui])}function yT(n,e,t){Fa(e);try{const i=n.viewQuery;null!==i&&gT(1,i,t);const r=n.template;null!==r&&iP(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&hP(n,e),n.staticViewQueries&&gT(2,n.viewQuery,t);const s=n.components;null!==s&&function Rz(n,e){for(let t=0;t<e.length;t++)Dz(n,e[t])}(e,s)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[Ot]&=-5,ka()}}let _P=(()=>{class n{constructor(){this.all=new Set,this.queue=new Map}create(t,i,r){const s=typeof Zone>"u"?null:Zone.current,o=function yM(n,e,t){const i=Object.create(vM);t&&(i.consumerAllowSignalWrites=!0),i.fn=n,i.schedule=e;const r=o=>{i.cleanupFn=o};return i.ref={notify:()=>Xv(i),run:()=>{if(i.dirty=!1,i.hasRun&&!Io(i))return;i.hasRun=!0;const o=Uh(i);try{i.cleanupFn(),i.cleanupFn=Wh,i.fn(r)}finally{eg(i,o)}},cleanup:()=>i.cleanupFn()},i.ref}(t,c=>{this.all.has(c)&&this.queue.set(c,s)},r);let a;this.all.add(o),o.notify();const l=()=>{o.cleanup(),a?.(),this.all.delete(o),this.queue.delete(o)};return a=i?.onDestroy(l),{destroy:l}}flush(){if(0!==this.queue.size)for(const[t,i]of this.queue)this.queue.delete(t),i?i.run(()=>t.run()):t.run()}get isQueueEmpty(){return 0===this.queue.size}static#e=this.\u0275prov=tt({token:n,providedIn:"root",factory:()=>new n})}return n})();function LE(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?r=Eh(r,a):2==s&&(i=Eh(i,a+": "+e[++o]+";"))}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}function S_(n,e,t,i,r=!1){for(;null!==t;){const s=e[t.index];null!==s&&i.push(Ln(s)),Gi(s)&&yP(s,i);const o=t.type;if(8&o)S_(n,e,t.child,i);else if(32&o){const a=zg(t,e);let l;for(;l=a();)i.push(l)}else if(16&o){const a=eE(e,t);if(Array.isArray(a))i.push(...a);else{const l=Bc(e[di]);S_(l[ke],l,a,i,!0)}}t=r?t.projectionNext:t.next}return i}function yP(n,e){for(let t=zi;t<n.length;t++){const i=n[t],r=i[ke].firstChild;null!==r&&S_(i[ke],i,r,e)}n[Ao]!==n[xn]&&e.push(n[Ao])}function OE(n,e,t,i=!0){const r=e[_c],s=r.rendererFactory,o=r.afterRenderEventManager;s.begin?.(),o?.begin();try{vP(n,e,n.template,t)}catch(l){throw i&&gP(e,l),l}finally{s.end?.(),r.effectManager?.flush(),o?.end()}}function vP(n,e,t,i){const r=e[Ot];if(256!=(256&r)){e[_c].effectManager?.flush(),Fa(e);try{Xh(e),function d0(n){return bt.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&iP(n,e,t,2,i);const o=3==(3&r);if(o){const c=n.preOrderCheckHooks;null!==c&&Ku(e,c,null)}else{const c=n.preOrderHooks;null!==c&&Ps(e,c,0,null),lf(e,0)}if(function Lz(n){for(let e=$0(n);null!==e;e=j0(e)){if(!e[Wv])continue;const t=e[Ko];for(let i=0;i<t.length;i++){s0(t[i])}}}(e),EP(e,2),null!==n.contentQueries&&hP(n,e),o){const c=n.contentCheckHooks;null!==c&&Ku(e,c)}else{const c=n.contentHooks;null!==c&&Ps(e,c,1),lf(e,1)}!function sz(n,e){const t=n.hostBindingOpCodes;if(null===t)return;const i=ZR(e,Aa);try{for(let r=0;r<t.length;r++){const s=t[r];if(s<0)Ua(~s);else{const o=s,a=t[++r],l=t[++r];TM(a,o),i.dirty=!1;const c=Uh(i);try{l(2,e[o])}finally{eg(i,c)}}}}finally{null===e[Aa]&&JR(e,Aa),Ua(-1)}}(n,e);const a=n.components;null!==a&&SP(e,a,0);const l=n.viewQuery;if(null!==l&&gT(2,l,i),o){const c=n.viewCheckHooks;null!==c&&Ku(e,c)}else{const c=n.viewHooks;null!==c&&Ps(e,c,2),lf(e,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),e[Ot]&=-73,Yh(e)}finally{ka()}}}function EP(n,e){for(let t=$0(n);null!==t;t=j0(t))for(let i=zi;i<t.length;i++)bP(t[i],e)}function Oz(n,e,t){bP(Gr(e,n),t)}function bP(n,e){if(!function SM(n){return 128==(128&n[Ot])}(n))return;const t=n[ke],i=n[Ot];if(80&i&&0===e||1024&i||2===e)vP(t,n,t.template,n[ui]);else if(n[Ta]>0){EP(n,1);const r=t.components;null!==r&&SP(n,r,1)}}function SP(n,e,t){for(let i=0;i<e.length;i++)Oz(n,e[i],t)}class w_{get rootNodes(){const e=this._lView,t=e[ke];return S_(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[ui]}set context(e){this._lView[ui]=e}get destroyed(){return 256==(256&this._lView[Ot])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[$n];if(Gi(e)){const t=e[8],i=t?t.indexOf(this):-1;i>-1&&(If(e,i),ff(t,i))}this._attachedToViewContainer=!1}Er(this._lView[ke],this._lView)}onDestroy(e){!function Kh(n,e){if(256==(256&n[Ot]))throw new re(911,!1);null===n[os]&&(n[os]=[]),n[os].push(e)}(this._lView,e)}markForCheck(){E_(this._cdRefInjectingView||this._lView)}detach(){this._lView[Ot]&=-129}reattach(){this._lView[Ot]|=128}detectChanges(){OE(this._lView[ke],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new re(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function io(n,e){Dl(n,e,e[Ct],2,null,null)}(this._lView[ke],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new re(902,!1);this._appRef=e}}class Fz extends w_{constructor(e){super(e),this._view=e}detectChanges(){const e=this._view;OE(e[ke],e,e[ui],!1)}checkNoChanges(){}get context(){return null}}class wP extends zt{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=Jt(e);return new M_(t,this.ngModule)}}function MP(n){const e=[];for(let t in n)n.hasOwnProperty(t)&&e.push({propName:n[t],templateName:t});return e}class Uz{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){i=Ou(i);const r=this.injector.get(e,eT,i);return r!==eT||t===eT?r:this.parentInjector.get(e,t,i)}}class M_ extends Ue{get inputs(){const e=this.componentDef,t=e.inputTransforms,i=MP(e.inputs);if(null!==t)for(const r of i)t.hasOwnProperty(r.propName)&&(r.transform=t[r.propName]);return i}get outputs(){return MP(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function uM(n){return n.map(Rh).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,i,r){let s=(r=r||this.ngModule)instanceof hs?r:r?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const o=s?new Uz(e,s):e,a=o.get(zn,null);if(null===a)throw new re(407,!1);const f={rendererFactory:a,sanitizer:o.get(DE,null),effectManager:o.get(_P,null),afterRenderEventManager:o.get(aT,null)},p=a.createRenderer(null,this.componentDef),m=this.componentDef.selectors[0][0]||"div",_=i?function az(n,e,t,i){const s=i.get(qR,!1)||t===Cs.ShadowDom,o=n.selectRootElement(e,s);return function lz(n){sP(n)}(o),o}(p,i,this.componentDef.encapsulation,o):Df(p,m,function kz(n){const e=n.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(m)),y=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let S=null;null!==_&&(S=y_(_,o,!0));const b=hT(0,null,null,1,0,null,null,null,null,null,null),M=PE(null,b,null,y,null,null,f,p,o,null,S);let T,I;Fa(M);try{const A=this.componentDef;let F,C=null;A.findHostDirectiveDefs?(F=[],C=new Map,A.findHostDirectiveDefs(A,F,C),F.push(A)):F=[A];const N=function Vz(n,e){const t=n[ke],i=Ut;return n[i]=e,Yf(t,i,2,"#host",null)}(M,_),K=function Hz(n,e,t,i,r,s,o){const a=r[ke];!function zz(n,e,t,i){for(const r of n)e.mergedAttrs=Bu(e.mergedAttrs,r.hostAttrs);null!==e.mergedAttrs&&(LE(e,e.mergedAttrs,!0),null!==t&&nE(i,t,e))}(i,n,e,o);let l=null;null!==e&&(l=y_(e,r[qo]));const c=s.rendererFactory.createRenderer(e,t);let d=16;t.signals?d=4096:t.onPush&&(d=64);const f=PE(r,rP(t),null,d,r[n.index],n,s,c,null,null,l);return a.firstCreatePass&&pT(a,n,i.length-1),NE(r,f),r[n.index]=f}(N,_,A,F,M,f,p);I=ju(b,Ut),_&&function Wz(n,e,t,i){if(i)Dh(n,t,["ng-version",OH.full]);else{const{attrs:r,classes:s}=function gc(n){const e=[],t=[];let i=1,r=2;for(;i<n.length;){let s=n[i];if("string"==typeof s)2===r?""!==s&&e.push(s,n[++i]):8===r&&t.push(s);else{if(!Fe(r))break;r=s}i++}return{attrs:e,classes:t}}(e.selectors[0]);r&&Dh(n,t,r),s&&s.length>0&&tE(n,t,s.join(" "))}}(p,A,_,i),void 0!==t&&function $z(n,e,t){const i=n.projection=[];for(let r=0;r<e.length;r++){const s=t[r];i.push(null!=s?Array.from(s):null)}}(I,this.ngContentSelectors,t),T=function Gz(n,e,t,i,r,s){const o=Wi(),a=r[ke],l=Nr(o,r);lP(a,r,o,t,null,i);for(let d=0;d<t.length;d++)rr(Sl(r,a,o.directiveStart+d,o),r);cP(a,r,o),l&&rr(l,r);const c=Sl(r,a,o.directiveStart+o.componentOffset,o);if(n[ui]=r[ui]=c,null!==s)for(const d of s)d(c,e);return cT(a,o,n),c}(K,A,F,C,M,[jz]),yT(b,M,null)}finally{ka()}return new Bz(this.componentType,T,qi(I,M),M,I)}}class Bz extends Ee{constructor(e,t,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new Fz(r),this.componentType=e}setInput(e,t){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;const s=this._rootLView;_T(s[ke],s,r,e,t),this.previousInputValues.set(e,t),E_(Gr(this._tNode.index,s))}}get injector(){return new Lr(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function jz(){const n=Wi();af(me()[ke],n)}function bn(n){let e=function xP(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),t=!0;const i=[n];for(;e;){let r;if(Js(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new re(903,!1);r=e.\u0275dir}if(r){if(t){i.push(r);const o=n;o.inputs=FE(n.inputs),o.inputTransforms=FE(n.inputTransforms),o.declaredInputs=FE(n.declaredInputs),o.outputs=FE(n.outputs);const a=r.hostBindings;a&&Kz(n,a);const l=r.viewQuery,c=r.contentQueries;if(l&&Xz(n,l),c&&Yz(n,c),pc(n.inputs,r.inputs),pc(n.declaredInputs,r.declaredInputs),pc(n.outputs,r.outputs),null!==r.inputTransforms&&(null===o.inputTransforms&&(o.inputTransforms={}),pc(o.inputTransforms,r.inputTransforms)),Js(r)&&r.data.animation){const d=n.data;d.animation=(d.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(n),a===bn&&(t=!1)}}e=Object.getPrototypeOf(e)}!function qz(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){const r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=Bu(r.hostAttrs,t=Bu(t,r.hostAttrs))}}(i)}function FE(n){return n===To?{}:n===ln?[]:n}function Xz(n,e){const t=n.viewQuery;n.viewQuery=t?(i,r)=>{e(i,r),t(i,r)}:e}function Yz(n,e){const t=n.contentQueries;n.contentQueries=t?(i,r,s)=>{e(i,r,s),t(i,r,s)}:e}function Kz(n,e){const t=n.hostBindings;n.hostBindings=t?(i,r)=>{e(i,r),t(i,r)}:e}function kE(n){return!!vT(n)&&(Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n)}function vT(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function jr(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function UE(n,e,t,i,r){const s=function _d(n,e,t,i){const r=jr(n,e,t);return jr(n,e+1,i)||r}(n,e,t,i);return jr(n,e+2,r)||s}function hi(n,e,t,i){const r=me();return jr(r,Cc(),e)&&(nn(),$a(On(),r,n,e,t,i)),hi}function li(n,e,t,i,r,s,o,a){const l=me(),c=nn(),d=n+Ut,f=c.firstCreatePass?function bG(n,e,t,i,r,s,o,a,l){const c=e.consts,d=Yf(e,n,4,o||null,Oa(c,a));fT(e,t,d,Oa(c,l)),af(e,d);const f=d.tView=hT(2,d,i,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c,null);return null!==e.queries&&(e.queries.template(e,d),f.queries=e.queries.embeddedTView(d)),d}(d,c,l,e,t,i,r,s,o):c.data[d];Rs(f,!1);const p=zP(c,l,f,n);El()&&Pf(c,l,p,f),rr(p,l),NE(l,l[d]=dP(p,l,p,f)),Fh(f)&&uT(c,l,f),null!=o&&dT(l,f,a)}let zP=function GP(n,e,t,i){return ea(!0),e[Ct].createComment("")};function xT(n){return function wc(n,e){return n[e]}(function xM(){return bt.lFrame.contextLView}(),Ut+n)}function rn(n,e,t){const i=me();return jr(i,Cc(),e)&&function so(n,e,t,i,r,s,o,a){const l=Nr(e,t);let d,c=e.inputs;!a&&null!=c&&(d=c[i])?(_T(n,t,d,i,r),Bt(e)&&function mz(n,e){const t=Gr(e,n);16&t[Ot]||(t[Ot]|=64)}(t,e.index)):3&e.type&&(i=function pz(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=o?o(r,e.value||"",i):r,s.setProperty(l,i,r))}(nn(),On(),i,n,e,i[Ct],t,!1),rn}function TT(n,e,t,i,r){const o=r?"class":"style";_T(n,t,e.inputs[o],o,i)}function sr(n,e,t,i){const r=me(),s=nn(),o=Ut+n,a=r[Ct],l=s.firstCreatePass?function xG(n,e,t,i,r,s){const o=e.consts,l=Yf(e,n,2,i,Oa(o,r));return fT(e,t,l,Oa(o,s)),null!==l.attrs&&LE(l,l.attrs,!1),null!==l.mergedAttrs&&LE(l,l.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,l),l}(o,s,r,e,t,i):s.data[o],c=WP(s,r,l,a,e,n);r[o]=c;const d=Fh(l);return Rs(l,!0),nE(a,c,l),32!=(32&l.flags)&&El()&&Pf(s,r,c,l),0===function l0(){return bt.lFrame.elementDepthCount}()&&rr(c,r),function wM(){bt.lFrame.elementDepthCount++}(),d&&(uT(s,r,l),cT(s,l,r)),null!==i&&dT(r,l),sr}function Xi(){let n=Wi();qu()?Po():(n=n.parent,Rs(n,!1));const e=n;(function Jh(n){return bt.skipHydrationRootTNode===n})(e)&&function us(){bt.skipHydrationRootTNode=null}(),function MM(){bt.lFrame.elementDepthCount--}();const t=nn();return t.firstCreatePass&&(af(t,n),zr(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function cf(n){return 0!=(8&n.flags)}(e)&&TT(t,e,me(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function Dc(n){return 0!=(16&n.flags)}(e)&&TT(t,e,me(),e.stylesWithoutHost,!1),Xi}function oo(n,e,t,i){return sr(n,e,t,i),Xi(),oo}let WP=(n,e,t,i,r,s)=>(ea(!0),Df(i,r,function m0(){return bt.lFrame.currentNamespace}()));function Xc(n,e,t){const i=me(),r=nn(),s=n+Ut,o=r.firstCreatePass?function AG(n,e,t,i,r){const s=e.consts,o=Oa(s,i),a=Yf(e,n,8,"ng-container",o);return null!==o&&LE(a,o,!0),fT(e,t,a,Oa(s,r)),null!==e.queries&&e.queries.elementStart(e,a),a}(s,r,i,e,t):r.data[s];Rs(o,!0);const a=$P(r,i,o,n);return i[s]=a,El()&&Pf(r,i,a,o),rr(a,i),Fh(o)&&(uT(r,i,o),cT(r,o,i)),null!=t&&dT(i,o),Xc}function Yc(){let n=Wi();const e=nn();return qu()?Po():(n=n.parent,Rs(n,!1)),e.firstCreatePass&&(af(e,n),zr(n)&&e.queries.elementEnd(n)),Yc}function CT(n,e,t){return Xc(n,e,t),Yc(),CT}let $P=(n,e,t,i)=>(ea(!0),Wg(e[Ct],""));function AT(){return me()}function D_(n){return!!n&&"function"==typeof n.then}function jP(n){return!!n&&"function"==typeof n.subscribe}function or(n,e,t,i){const r=me(),s=nn(),o=Wi();return function XP(n,e,t,i,r,s,o){const a=Fh(i),c=n.firstCreatePass&&pP(n),d=e[ui],f=fP(e);let p=!0;if(3&i.type||o){const E=Nr(i,e),v=o?o(E):E,y=f.length,S=o?M=>o(Ln(M[i.index])):i.index;let b=null;if(!o&&a&&(b=function RG(n,e,t,i){const r=n.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===t&&r[s+1]===i){const a=e[Ca],l=r[s+2];return a.length>l?a[l]:null}"string"==typeof o&&(s+=2)}return null}(n,e,r,i.index)),null!==b)(b.__ngLastListenerFn__||b).__ngNextListenerFn__=s,b.__ngLastListenerFn__=s,p=!1;else{s=KP(i,e,d,s,!1);const M=t.listen(v,r,s);f.push(s,M),c&&c.push(r,S,y,y+1)}}else s=KP(i,e,d,s,!1);const m=i.outputs;let _;if(p&&null!==m&&(_=m[r])){const E=_.length;if(E)for(let v=0;v<E;v+=2){const T=e[_[v]][_[v+1]].subscribe(s),I=f.length;f.push(s,T),c&&c.push(r,i.index,I,-(I+1))}}}(s,r,r[Ct],o,n,e,i),or}function YP(n,e,t,i){try{return Ro(6,e,t),!1!==t(i)}catch(r){return gP(n,r),!1}finally{Ro(7,e,t)}}function KP(n,e,t,i,r){return function s(o){if(o===Function)return i;E_(n.componentOffset>-1?Gr(n.index,e):e);let l=YP(e,t,i,o),c=s.__ngNextListenerFn__;for(;c;)l=YP(e,t,c,o)&&l,c=c.__ngNextListenerFn__;return r&&!1===l&&o.preventDefault(),l}}function wr(n=1){return function Yu(n){return(bt.lFrame.contextLView=function AM(n,e){for(;n>0;)e=e[yc],n--;return e}(n,bt.lFrame.contextLView))[ui]}(n)}function PG(n,e){let t=null;const i=function Di(n){const e=n.attrs;if(null!=e){const t=e.indexOf(5);if(!(1&t))return e[t+1]}return null}(n);for(let r=0;r<e.length;r++){const s=e[r];if("*"!==s){if(null===i?pn(n,s,!0):cM(i,s))return r}else t=r}return t}function DT(n){const e=me()[di][Ii];if(!e.projection){const i=e.projection=id(n?n.length:1,null),r=i.slice();let s=e.child;for(;null!==s;){const o=n?PG(s,n):0;null!==o&&(r[o]?r[o].projectionNext=s:i[o]=s,r[o]=s),s=s.next}}}function IT(n,e=0,t){const i=me(),r=nn(),s=Yf(r,Ut+n,16,null,t||null);null===s.projection&&(s.projection=e),Po(),(!i[as]||Mc())&&32!=(32&s.flags)&&function vx(n,e,t){Yg(e[Ct],0,e,t,$g(n,t,e),od(t.parent||e[Ii],t,e))}(r,i,s)}function zE(n,e){return n<<17|e<<2}function Kc(n){return n>>17&32767}function PT(n){return 2|n}function yd(n){return(131068&n)>>2}function NT(n,e){return-131069&n|e<<2}function LT(n){return 1|n}function oN(n,e,t,i,r){const s=n[t+1],o=null===e;let a=i?Kc(s):yd(s),l=!1;for(;0!==a&&(!1===l||o);){const d=n[a+1];UG(n[a],e)&&(l=!0,n[a+1]=i?LT(d):PT(d)),a=i?Kc(d):yd(d)}l&&(n[t+1]=i?PT(s):LT(s))}function UG(n,e){return null===n||null==e||(Array.isArray(n)?n[1]:n)===e||!(!Array.isArray(n)||"string"!=typeof e)&&Oc(n,e)>=0}const ar={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function aN(n){return n.substring(ar.key,ar.keyEnd)}function lN(n,e){const t=ar.textEnd;return t===e?-1:(e=ar.keyEnd=function zG(n,e,t){for(;e<t&&n.charCodeAt(e)>32;)e++;return e}(n,ar.key=e,t),sp(n,e,t))}function sp(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function I_(n,e){return function oa(n,e,t,i){const r=me(),s=nn(),o=Qo(2);s.firstUpdatePass&&mN(s,n,o,i),e!==Vt&&jr(r,o,e)&&_N(s,s.data[vr()],r,r[Ct],n,r[o+1]=function QG(n,e){return null==n||""===n||("string"==typeof e?n+=e:"object"==typeof n&&(n=Ai(za(n)))),n}(e,t),i,o)}(n,e,null,!0),I_}function Ll(n){!function aa(n,e,t,i){const r=nn(),s=Qo(2);r.firstUpdatePass&&mN(r,null,s,i);const o=me();if(t!==Vt&&jr(o,s,t)){const a=r.data[vr()];if(vN(a,i)&&!pN(r,s)){let l=i?a.classesWithoutHost:a.stylesWithoutHost;null!==l&&(t=Eh(l,t||"")),TT(r,a,o,t,i)}else!function JG(n,e,t,i,r,s,o,a){r===Vt&&(r=ln);let l=0,c=0,d=0<r.length?r[0]:null,f=0<s.length?s[0]:null;for(;null!==d||null!==f;){const p=l<r.length?r[l+1]:void 0,m=c<s.length?s[c+1]:void 0;let E,_=null;d===f?(l+=2,c+=2,p!==m&&(_=f,E=m)):null===f||null!==d&&d<f?(l+=2,_=d):(c+=2,_=f,E=m),null!==_&&_N(n,e,t,i,_,E,o,a),d=l<r.length?r[l]:null,f=c<s.length?s[c]:null}}(r,a,o,o[Ct],o[s+1],o[s+1]=function KG(n,e,t){if(null==t||""===t)return ln;const i=[],r=za(t);if(Array.isArray(r))for(let s=0;s<r.length;s++)n(i,r[s],!0);else if("object"==typeof r)for(const s in r)r.hasOwnProperty(s)&&n(i,s,r[s]);else"string"==typeof r&&e(i,r);return i}(n,e,t),i,s)}}(ZG,Xa,n,!0)}function Xa(n,e){for(let t=function VG(n){return function uN(n){ar.key=0,ar.keyEnd=0,ar.value=0,ar.valueEnd=0,ar.textEnd=n.length}(n),lN(n,sp(n,0,ar.textEnd))}(e);t>=0;t=lN(e,t))jn(n,aN(e),!0)}function pN(n,e){return e>=n.expandoStartIndex}function mN(n,e,t,i){const r=n.data;if(null===r[t+1]){const s=r[vr()],o=pN(n,t);vN(s,i)&&null===e&&!o&&(e=!1),e=function jG(n,e,t,i){const r=function yr(n){const e=bt.lFrame.currentDirectiveIndex;return-1===e?null:n[e]}(n);let s=i?e.residualClasses:e.residualStyles;if(null===r)0===(i?e.classBindings:e.styleBindings)&&(t=R_(t=OT(null,n,e,t,i),e.attrs,i),s=null);else{const o=e.directiveStylingLast;if(-1===o||n[o]!==r)if(t=OT(r,n,e,t,i),null===s){let l=function qG(n,e,t){const i=t?e.classBindings:e.styleBindings;if(0!==yd(i))return n[Kc(i)]}(n,e,i);void 0!==l&&Array.isArray(l)&&(l=OT(null,n,e,l[1],i),l=R_(l,e.attrs,i),function XG(n,e,t,i){n[Kc(t?e.classBindings:e.styleBindings)]=i}(n,e,i,l))}else s=function YG(n,e,t){let i;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)i=R_(i,n[s].hostAttrs,t);return R_(i,e.attrs,t)}(n,e,i)}return void 0!==s&&(i?e.residualClasses=s:e.residualStyles=s),t}(r,s,e,i),function FG(n,e,t,i,r,s){let o=s?e.classBindings:e.styleBindings,a=Kc(o),l=yd(o);n[i]=t;let d,c=!1;if(Array.isArray(t)?(d=t[1],(null===d||Oc(t,d)>0)&&(c=!0)):d=t,r)if(0!==l){const p=Kc(n[a+1]);n[i+1]=zE(p,a),0!==p&&(n[p+1]=NT(n[p+1],i)),n[a+1]=function LG(n,e){return 131071&n|e<<17}(n[a+1],i)}else n[i+1]=zE(a,0),0!==a&&(n[a+1]=NT(n[a+1],i)),a=i;else n[i+1]=zE(l,0),0===a?a=i:n[l+1]=NT(n[l+1],i),l=i;c&&(n[i+1]=PT(n[i+1])),oN(n,d,i,!0),oN(n,d,i,!1),function kG(n,e,t,i,r){const s=r?n.residualClasses:n.residualStyles;null!=s&&"string"==typeof e&&Oc(s,e)>=0&&(t[i+1]=LT(t[i+1]))}(e,d,n,i,s),o=zE(a,l),s?e.classBindings=o:e.styleBindings=o}(r,s,e,t,o,i)}}function OT(n,e,t,i,r){let s=null;const o=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<o&&(s=e[a],i=R_(i,s.hostAttrs,r),s!==n);)a++;return null!==n&&(t.directiveStylingLast=a),i}function R_(n,e,t){const i=t?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?r=o:r===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),jn(n,o,!!t||e[++s]))}return void 0===n?null:n}function ZG(n,e,t){const i=String(e);""!==i&&!i.includes(" ")&&jn(n,i,t)}function _N(n,e,t,i,r,s,o,a){if(!(3&e.type))return;const l=n.data,c=l[a+1],d=function OG(n){return 1==(1&n)}(c)?yN(l,e,t,r,yd(c),o):void 0;GE(d)||(GE(s)||function NG(n){return 2==(2&n)}(c)&&(s=yN(l,null,t,r,a,o)),function ds(n,e,t,i,r){if(e)r?n.addClass(t,i):n.removeClass(t,i);else{let s=-1===i.indexOf("-")?void 0:Va.DashCase;null==r?n.removeStyle(t,i,s):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),s|=Va.Important),n.setStyle(t,i,r,s))}}(i,o,$u(vr(),t),r,s))}function yN(n,e,t,i,r,s){const o=null===e;let a;for(;r>0;){const l=n[r],c=Array.isArray(l),d=c?l[1]:l,f=null===d;let p=t[r+1];p===Vt&&(p=f?ln:void 0);let m=f?Cg(p,i):d===i?p:void 0;if(c&&!GE(m)&&(m=Cg(l,i)),GE(m)&&(a=m,o))return a;const _=n[r+1];r=o?Kc(_):yd(_)}if(null!==e){let l=s?e.residualClasses:e.residualStyles;null!=l&&(a=Cg(l,i))}return a}function GE(n){return void 0!==n}function vN(n,e){return 0!=(n.flags&(e?8:16))}function vd(n,e=""){const t=me(),i=nn(),r=n+Ut,s=i.firstCreatePass?Yf(i,r,1,e,null):i.data[r],o=EN(i,t,s,e,n);t[r]=o,El()&&Pf(i,t,o,s),Rs(s,!1)}let EN=(n,e,t,i,r)=>(ea(!0),function Af(n,e){return n.createText(e)}(e[Ct],i));function P_(n){return FT("",n,""),P_}function FT(n,e,t){const i=me(),r=function Zf(n,e,t,i){return jr(n,Cc(),t)?e+xt(t)+i:Vt}(i,n,e,t);return r!==Vt&&function Nl(n,e,t){const i=$u(e,n);!function X0(n,e,t){n.setValue(e,t)}(n[Ct],i,t)}(i,vr(),r),FT}const ap="en-US";let zN=ap;function BT(n,e,t,i,r){if(n=ht(n),Array.isArray(n))for(let s=0;s<n.length;s++)BT(n[s],e,t,i,r);else{const s=nn(),o=me(),a=Wi();let l=Ga(n)?n:ht(n.provide);const c=SE(n),d=1048575&a.providerIndexes,f=a.directiveStart,p=a.providerIndexes>>20;if(Ga(n)||!n.multi){const m=new Zu(c,r,ye),_=HT(l,e,r?d:d+p,f);-1===_?(ed(df(a,o),s,l),VT(s,n,e.length),e.push(l),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(m),o.push(m)):(t[_]=m,o[_]=m)}else{const m=HT(l,e,d+p,f),_=HT(l,e,d,d+p),v=_>=0&&t[_];if(r&&!v||!r&&!(m>=0&&t[m])){ed(df(a,o),s,l);const y=function EW(n,e,t,i,r){const s=new Zu(n,t,ye);return s.multi=[],s.index=e,s.componentProviders=0,fL(s,r,i&&!t),s}(r?vW:yW,t.length,r,i,c);!r&&v&&(t[_].providerFactory=y),VT(s,n,e.length,0),e.push(l),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(y),o.push(y)}else VT(s,n,m>-1?m:_,fL(t[r?_:m],c,!r&&i));!r&&i&&v&&t[_].componentProviders++}}}function VT(n,e,t,i){const r=Ga(e),s=function bE(n){return!!n.useClass}(e);if(r||s){const l=(s?ht(e.useClass):e).prototype.ngOnDestroy;if(l){const c=n.destroyHooks||(n.destroyHooks=[]);if(!r&&e.multi){const d=c.indexOf(t);-1===d?c.push(t,[i,l]):c[d+1].push(i,l)}else c.push(t,l)}}}function fL(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function HT(n,e,t,i){for(let r=t;r<i;r++)if(e[r]===n)return r;return-1}function yW(n,e,t,i){return zT(this.multi,[])}function vW(n,e,t,i){const r=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=Sl(t,t[ke],this.providerFactory.index,i);s=a.slice(0,o),zT(r,s);for(let l=o;l<a.length;l++)s.push(a[l])}else s=[],zT(r,s);return s}function zT(n,e){for(let t=0;t<n.length;t++)e.push((0,n[t])());return e}function ii(n,e=[]){return t=>{t.providersResolver=(i,r)=>function _W(n,e,t){const i=nn();if(i.firstCreatePass){const r=Js(n);BT(t,i.data,i.blueprint,r,!0),BT(e,i.data,i.blueprint,r,!1)}}(i,r?r(n):n,e)}}class bd{}class pL{}class GT extends bd{constructor(e,t,i){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new wP(this);const r=gr(e);this._bootstrapComponents=Pl(r.bootstrap),this._r3Injector=FR(e,t,[{provide:bd,useValue:this},{provide:zt,useValue:this.componentFactoryResolver},...i],Ai(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class WT extends pL{constructor(e){super(),this.moduleType=e}create(e){return new GT(this.moduleType,e,[])}}class mL extends bd{constructor(e){super(),this.componentFactoryResolver=new wP(this),this.instance=null;const t=new zf([...e.providers,{provide:bd,useValue:this},{provide:zt,useValue:this.componentFactoryResolver}],e.parent||Hf(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function $T(n,e,t=null){return new mL({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}let wW=(()=>{class n{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){const i=yE(0,t.type),r=i.length>0?$T([i],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,r)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}static#e=this.\u0275prov=tt({token:n,providedIn:"environment",factory:()=>new n(Ne(hs))})}return n})();function U_(n){n.getStandaloneInjector=e=>e.get(wW).getOrCreateStandaloneInjector(n)}function XE(n,e,t,i,r,s){return function ML(n,e,t,i,r,s,o,a){const l=e+t;return UE(n,l,r,s,o)?function ja(n,e,t){return n[e]=t}(n,l+3,a?i.call(a,r,s,o):i(r,s,o)):function B_(n,e){const t=n[e];return t===Vt?void 0:t}(n,l+3)}(me(),function _r(){const n=bt.lFrame;let e=n.bindingRootIndex;return-1===e&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}(),n,e,t,i,r,s)}function XW(){return this._results[Symbol.iterator]()}class qT{static#e=Symbol.iterator;get changes(){return this._changes||(this._changes=new Xn)}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=qT.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=XW)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const i=this;i.dirty=!1;const r=function Ns(n){return n.flat(Number.POSITIVE_INFINITY)}(e);(this._changesDetected=!function kM(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],s=e[i];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}(i._results,r,t))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}function KW(n,e,t,i=!0){const r=e[ke];if(function _x(n,e,t,i){const r=zi+i,s=t.length;i>0&&(t[r-1][Zs]=e),i<s-zi?(e[Zs]=t[r],Tg(t,zi+i,e)):(t.push(e),e[Zs]=null),e[$n]=t;const o=e[vc];null!==o&&t!==o&&function Tl(n,e){const t=n[Ko];e[di]!==e[$n][$n][di]&&(n[Wv]=!0),null===t?n[Ko]=[e]:t.push(e)}(o,e);const a=e[Ds];null!==a&&a.insertView(n),e[Ot]|=128}(r,e,n,t),i){const s=qg(t,n),o=e[Ct],a=Ls(o,n[Ao]);null!==a&&function mx(n,e,t,i,r,s){i[xn]=r,i[Ii]=e,Dl(n,i,t,1,r,s)}(r,n[Ii],o,e,a,s)}}let Ya=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=QW}return n})();const ZW=Ya,JW=class extends ZW{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,i){const r=function YW(n,e,t,i){const r=e.tView,a=PE(n,r,t,4096&n[Ot]?4096:16,null,e,null,null,null,i?.injector??null,i?.hydrationInfo??null);a[vc]=n[e.index];const c=n[Ds];return null!==c&&(a[Ds]=c.createEmbeddedView(r)),yT(r,a,t),a}(this._declarationLView,this._declarationTContainer,e,{injector:t,hydrationInfo:i});return new w_(r)}};function QW(){return YE(Wi(),me())}function YE(n,e){return 4&n.type?new JW(e,n,qi(n,e)):null}let la=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=s5}return n})();function s5(){return NL(Wi(),me())}const o5=la,RL=class extends o5{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return qi(this._hostTNode,this._hostLView)}get injector(){return new Lr(this._hostTNode,this._hostLView)}get parentInjector(){const e=$i(this._hostTNode,this._hostLView);if(Qu(e)){const t=bl(e,this._hostLView),i=to(e);return new Lr(t[ke].data[i+8],t)}return new Lr(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=PL(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-zi}createEmbeddedView(e,t,i){let r,s;"number"==typeof i?r=i:null!=i&&(r=i.index,s=i.injector);const a=e.createEmbeddedViewImpl(t||{},s,null);return this.insertImpl(a,r,false),a}createComponent(e,t,i,r,s){const o=e&&!function Nc(n){return"function"==typeof n}(e);let a;if(o)a=t;else{const E=t||{};a=E.index,i=E.injector,r=E.projectableNodes,s=E.environmentInjector||E.ngModuleRef}const l=o?e:new M_(Jt(e)),c=i||this.parentInjector;if(!s&&null==l.ngModule){const v=(o?c:this.parentInjector).get(hs,null);v&&(s=v)}Jt(l.componentType??{});const m=l.create(c,r,null,s);return this.insertImpl(m.hostView,a,false),m}insert(e,t){return this.insertImpl(e,t,!1)}insertImpl(e,t,i){const r=e._lView;if(function r0(n){return Gi(n[$n])}(r)){const l=this.indexOf(e);if(-1!==l)this.detach(l);else{const c=r[$n],d=new RL(c,c[Ii],c[$n]);d.detach(d.indexOf(e))}}const o=this._adjustIndex(t),a=this._lContainer;return KW(a,r,o,!i),e.attachToViewContainerRef(),Tg(XT(a),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=PL(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=If(this._lContainer,t);i&&(ff(XT(this._lContainer),t),Er(i[ke],i))}detach(e){const t=this._adjustIndex(e,-1),i=If(this._lContainer,t);return i&&null!=ff(XT(this._lContainer),t)?new w_(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function PL(n){return n[8]}function XT(n){return n[8]||(n[8]=[])}function NL(n,e){let t;const i=e[n.index];return Gi(i)?t=i:(t=dP(i,e,null,n),e[n.index]=t,NE(e,t)),LL(t,e,n,i),new RL(t,n,e)}let LL=function OL(n,e,t,i){if(n[Ao])return;let r;r=8&t.type?Ln(i):function a5(n,e){const t=n[Ct],i=t.createComment(""),r=Nr(e,n);return Cl(t,Ls(t,r),i,function J0(n,e){return n.nextSibling(e)}(t,r),!1),i}(e,t),n[Ao]=r};class YT{constructor(e){this.queryList=e,this.matches=null}clone(){return new YT(this.queryList)}setDirty(){this.queryList.setDirty()}}class KT{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let s=0;s<i;s++){const o=t.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new KT(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==VL(e,t).matches&&this.queries[t].setDirty()}}class FL{constructor(e,t,i=null){this.predicate=e,this.flags=t,this.read=i}}class ZT{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,s=this.getByIndex(i).embeddedTView(e,r);s&&(s.indexInDeclarationView=i,null!==t?t.push(s):t=[s])}return null!==t?new ZT(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class JT{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new JT(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(e,t,u5(t,s)),this.matchTNodeWithReadOption(e,t,td(t,e,s,!1,!1))}else i===Ya?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,td(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===Tn||r===la||r===Ya&&4&t.type)this.addMatch(t.index,-2);else{const s=td(t,e,r,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function u5(n,e){const t=n.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1];return null}function h5(n,e,t,i){return-1===t?function d5(n,e){return 11&n.type?qi(n,e):4&n.type?YE(n,e):null}(e,n):-2===t?function f5(n,e,t){return t===Tn?qi(e,n):t===Ya?YE(e,n):t===la?NL(e,n):void 0}(n,e,i):Sl(n,n[ke],t,e)}function kL(n,e,t,i){const r=e[Ds].queries[i];if(null===r.matches){const s=n.data,o=t.matches,a=[];for(let l=0;l<o.length;l+=2){const c=o[l];a.push(c<0?null:h5(e,s[c],o[l+1],t.metadata.read))}r.matches=a}return r.matches}function QT(n,e,t,i){const r=n.queries.getByIndex(t),s=r.matches;if(null!==s){const o=kL(n,e,r,t);for(let a=0;a<s.length;a+=2){const l=s[a];if(l>0)i.push(o[a/2]);else{const c=s[a+1],d=e[-l];for(let f=zi;f<d.length;f++){const p=d[f];p[vc]===p[$n]&&QT(p[ke],p,c,i)}if(null!==d[Ko]){const f=d[Ko];for(let p=0;p<f.length;p++){const m=f[p];QT(m[ke],m,c,i)}}}}}return i}function lp(n){const e=me(),t=nn(),i=eo();dg(i+1);const r=VL(t,i);if(n.dirty&&function n0(n){return 4==(4&n[Ot])}(e)===(2==(2&r.metadata.flags))){if(null===r.matches)n.reset([]);else{const s=r.crossesNgTemplate?QT(t,e,i,[]):kL(t,e,r,i);n.reset(s,fs),n.notifyOnChanges()}return!0}return!1}function eC(n,e,t){const i=nn();i.firstCreatePass&&(BL(i,new FL(n,e,t),-1),2==(2&e)&&(i.staticViewQueries=!0)),UL(i,me(),e)}function ZE(n,e,t,i){const r=nn();if(r.firstCreatePass){const s=Wi();BL(r,new FL(e,t,i),s.index),function m5(n,e){const t=n.contentQueries||(n.contentQueries=[]);e!==(t.length?t[t.length-1]:-1)&&t.push(n.queries.length-1,e)}(r,n),2==(2&t)&&(r.staticContentQueries=!0)}UL(r,me(),t)}function cp(){return function p5(n,e){return n[Ds].queries[e].queryList}(me(),eo())}function UL(n,e,t){const i=new qT(4==(4&t));(function dz(n,e,t,i){const r=fP(e);r.push(t),n.firstCreatePass&&pP(n).push(i,r.length-1)})(n,e,i,i.destroy),null===e[Ds]&&(e[Ds]=new KT),e[Ds].queries.push(new YT(i))}function BL(n,e,t){null===n.queries&&(n.queries=new ZT),n.queries.track(new JT(e,t))}function VL(n,e){return n.queries.getByIndex(e)}const oC=new Ye("Application Initializer");let aC=(()=>{class n{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,i)=>{this.resolve=t,this.reject=i}),this.appInits=Ve(oC,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const t=[];for(const r of this.appInits){const s=r();if(D_(s))t.push(s);else if(jP(s)){const o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});t.push(o)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=tt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),iO=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=tt({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();const Ol=new Ye("LocaleId",{providedIn:"root",factory:()=>Ve(Ol,Xt.Optional|Xt.SkipSelf)||function k5(){return typeof $localize<"u"&&$localize.locale||ap}()});let QE=(()=>{class n{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Vr(!1)}add(){this.hasPendingTasks.next(!0);const t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=tt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class V5{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let rO=(()=>{class n{compileModuleSync(t){return new WT(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const i=this.compileModuleSync(t),s=Pl(gr(t).declarations).reduce((o,a)=>{const l=Jt(a);return l&&o.push(new M_(l)),o},[]);return new V5(i,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=tt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const lO=new Ye(""),tb=new Ye("");let hC,uC=(()=>{class n{constructor(t,i,r){this._ngZone=t,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,hC||(function o$(n){hC=n}(r),r.addToWindow(i)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{In.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,i,r){return[]}static#e=this.\u0275fac=function(i){return new(i||n)(Ne(In),Ne(dC),Ne(tb))};static#t=this.\u0275prov=tt({token:n,factory:n.\u0275fac})}return n})(),dC=(()=>{class n{constructor(){this._applications=new Map}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return hC?.findTestabilityInTree(this,t,i)??null}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=tt({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})(),Zc=null;const cO=new Ye("AllowMultipleToken"),fC=new Ye("PlatformDestroyListeners"),pC=new Ye("appBootstrapListener");class dO{constructor(e,t){this.name=e,this.token=t}}function fO(n,e,t=[]){const i=`Platform: ${e}`,r=new Ye(i);return(s=[])=>{let o=mC();if(!o||o.injector.get(cO,!1)){const a=[...t,...s,{provide:r,useValue:!0}];n?n(a):function c$(n){if(Zc&&!Zc.get(cO,!1))throw new re(400,!1);(function uO(){!function ig(n){ng=n}(()=>{throw new re(600,!1)})})(),Zc=n;const e=n.get(mO);(function hO(n){n.get(wE,null)?.forEach(t=>t())})(n)}(function pO(n=[],e){return ro.create({name:e,providers:[{provide:l_,useValue:"platform"},{provide:fC,useValue:new Set([()=>Zc=null])},...n]})}(a,i))}return function d$(n){const e=mC();if(!e)throw new re(401,!1);return e}()}}function mC(){return Zc?.get(mO)??null}let mO=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,i){const r=function h$(n="zone.js",e){return"noop"===n?new qH:"zone.js"===n?new In(e):n}(i?.ngZone,function gO(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return r.run(()=>{const s=function SW(n,e,t){return new GT(n,e,t)}(t.moduleType,this.injector,function bO(n){return[{provide:In,useFactory:n},{provide:hd,multi:!0,useFactory:()=>{const e=Ve(p$,{optional:!0});return()=>e.initialize()}},{provide:EO,useFactory:f$},{provide:HR,useFactory:zR}]}(()=>r)),o=s.injector.get(Rl,null);return r.runOutsideAngular(()=>{const a=r.onError.subscribe({next:l=>{o.handleError(l)}});s.onDestroy(()=>{nb(this._modules,s),a.unsubscribe()})}),function _O(n,e,t){try{const i=t();return D_(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}(o,r,()=>{const a=s.injector.get(aC);return a.runInitializers(),a.donePromise.then(()=>(function GN(n){xs(n,"Expected localeId to be defined"),"string"==typeof n&&(zN=n.toLowerCase().replace(/_/g,"-"))}(s.injector.get(Ol,ap)||ap),this._moduleDoBootstrap(s),s))})})}bootstrapModule(t,i=[]){const r=yO({},i);return function a$(n,e,t){const i=new WT(t);return Promise.resolve(i)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(t){const i=t.injector.get(Sd);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new re(-403,!1);t.instance.ngDoBootstrap(i)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new re(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const t=this._injector.get(fC,null);t&&(t.forEach(i=>i()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static#e=this.\u0275fac=function(i){return new(i||n)(Ne(ro))};static#t=this.\u0275prov=tt({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();function yO(n,e){return Array.isArray(e)?e.reduce(yO,n):{...n,...e}}let Sd=(()=>{class n{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=Ve(EO),this.zoneIsStable=Ve(HR),this.componentTypes=[],this.components=[],this.isStable=Ve(QE).hasPendingTasks.pipe(Ms(t=>t?vt(!1):this.zoneIsStable),function Qw(n,e=Qe){return n=n??Tv,gn((t,i)=>{let r,s=!0;t.subscribe(mn(i,o=>{const a=e(o);(s||!n(r,a))&&(s=!1,r=a,i.next(o))}))})}(),Fm()),this._injector=Ve(hs)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(t,i){const r=t instanceof Ue;if(!this._injector.get(aC).done)throw!r&&function fl(n){const e=Jt(n)||Wn(n)||Hi(n);return null!==e&&e.standalone}(t),new re(405,!1);let o;o=r?t:this._injector.get(zt).resolveComponentFactory(t),this.componentTypes.push(o.componentType);const a=function l$(n){return n.isBoundToModule}(o)?void 0:this._injector.get(bd),c=o.create(ro.NULL,[],i||o.selector,a),d=c.location.nativeElement,f=c.injector.get(lO,null);return f?.registerApplication(d),c.onDestroy(()=>{this.detachView(c.hostView),nb(this.components,c),f?.unregisterApplication(d)}),this._loadComponent(c),c}tick(){if(this._runningTick)throw new re(101,!1);try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this.internalErrorHandler(t)}finally{this._runningTick=!1}}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;nb(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);const i=this._injector.get(pC,[]);i.push(...this._bootstrapListeners),i.forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>nb(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new re(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=tt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function nb(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const EO=new Ye("",{providedIn:"root",factory:()=>Ve(Rl).handleError.bind(void 0)});function f$(){const n=Ve(In),e=Ve(Rl);return t=>n.runOutsideAngular(()=>e.handleError(t))}let p$=(()=>{class n{constructor(){this.zone=Ve(In),this.applicationRef=Ve(Sd)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=tt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();let G_=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=g$}return n})();function g$(n){return function _$(n,e,t){if(Bt(n)&&!t){const i=Gr(n.index,e);return new w_(i,i)}return 47&n.type?new w_(e[di],e):null}(Wi(),me(),16==(16&n))}class xO{constructor(){}supports(e){return kE(e)}create(e){return new w$(e)}}const S$=(n,e)=>e;class w${constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||S$}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,s=null;for(;t||i;){const o=!i||t&&t.currentIndex<CO(i,r,s)?t:i,a=CO(o,r,s),l=o.currentIndex;if(o===i)r--,i=i._nextRemoved;else if(t=t._next,null==o.previousIndex)r++;else{s||(s=[]);const c=a-r,d=l-r;if(c!=d){for(let p=0;p<c;p++){const m=p<s.length?s[p]:s[p]=0,_=m+p;d<=_&&_<c&&(s[p]=m+1)}s[o.previousIndex]=d-c}}a!==l&&e(o,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!kE(e))throw new re(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let r,s,o,t=this._itHead,i=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,o,a),i=!0),t=t._next}else r=0,function iG(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{const t=n[Symbol.iterator]();let i;for(;!(i=t.next()).done;)e(i.value)}}(e,a=>{o=this._trackByFn(r,a),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,a,o,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,o,r),i=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,r)):e=this._addAfter(new M$(t,i),s,r),e}_verifyReinsertion(e,t,i,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?e=this._reinsertAfter(s,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,s=e._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){const r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new TO),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,i=e._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new TO),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class M${constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class x${constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){const t=e._prevDup,i=e._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}class TO{constructor(){this.map=new Map}put(e){const t=e.trackById;let i=this.map.get(t);i||(i=new x$,this.map.set(t,i)),i.add(e)}get(e,t){const r=this.map.get(e);return r?r.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function CO(n,e,t){const i=n.previousIndex;if(null===i)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}class AO{constructor(){}supports(e){return e instanceof Map||vT(e)}create(){return new T$}}class T${constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||vT(e)))throw new re(900,!1)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(i,r)=>{if(t&&t.key===r)this._maybeAddToChanges(t,i),this._appendAfter=t,t=t._next;else{const s=this._getOrCreateRecordForKey(r,i);t=this._insertBeforeOrAppend(t,s)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let i=t;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const i=e._prev;return t._next=e,t._prev=i,e._prev=t,i&&(i._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const r=this._records.get(e);this._maybeAddToChanges(r,t);const s=r._prev,o=r._next;return s&&(s._next=o),o&&(o._prev=s),r._next=null,r._prev=null,r}const i=new C$(e);return this._records.set(e,i),i.currentValue=t,this._addToAdditions(i),i}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(i=>t(e[i],i))}}class C${constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function DO(){return new sb([new xO])}let sb=(()=>{class n{static#e=this.\u0275prov=tt({token:n,providedIn:"root",factory:DO});constructor(t){this.factories=t}static create(t,i){if(null!=i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||DO()),deps:[[n,new gf,new mf]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(null!=i)return i;throw new re(901,!1)}}return n})();function IO(){return new W_([new AO])}let W_=(()=>{class n{static#e=this.\u0275prov=tt({token:n,providedIn:"root",factory:IO});constructor(t){this.factories=t}static create(t,i){if(i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||IO()),deps:[[n,new gf,new mf]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(i)return i;throw new re(901,!1)}}return n})();const I$=fO(null,"core",[]);let R$=(()=>{class n{constructor(t){}static#e=this.\u0275fac=function(i){return new(i||n)(Ne(Sd))};static#t=this.\u0275mod=tr({type:n});static#n=this.\u0275inj=Vi({})}return n})();let bC=null;function Jc(){return bC}class $${}const qr=new Ye("DocumentToken");let SC=(()=>{class n{historyGo(t){throw new Error("Not implemented")}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=tt({token:n,factory:function(){return Ve(q$)},providedIn:"platform"})}return n})();const j$=new Ye("Location Initialized");let q$=(()=>{class n extends SC{constructor(){super(),this._doc=Ve(qr),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Jc().getBaseHref(this._doc)}onPopState(t){const i=Jc().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=Jc().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,r){this._history.pushState(t,i,r)}replaceState(t,i,r){this._history.replaceState(t,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=tt({token:n,factory:function(){return new n},providedIn:"platform"})}return n})();function wC(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function BO(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function Fl(n){return n&&"?"!==n[0]?"?"+n:n}let Md=(()=>{class n{historyGo(t){throw new Error("Not implemented")}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=tt({token:n,factory:function(){return Ve(HO)},providedIn:"root"})}return n})();const VO=new Ye("appBaseHref");let HO=(()=>{class n extends Md{constructor(t,i){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??Ve(qr).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return wC(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+Fl(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,s){const o=this.prepareExternalUrl(r+Fl(s));this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){const o=this.prepareExternalUrl(r+Fl(s));this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static#e=this.\u0275fac=function(i){return new(i||n)(Ne(SC),Ne(VO,8))};static#t=this.\u0275prov=tt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),X$=(()=>{class n extends Md{constructor(t,i){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(t){const i=wC(this._baseHref,t);return i.length>0?"#"+i:i}pushState(t,i,r,s){let o=this.prepareExternalUrl(r+Fl(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){let o=this.prepareExternalUrl(r+Fl(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static#e=this.\u0275fac=function(i){return new(i||n)(Ne(SC),Ne(VO,8))};static#t=this.\u0275prov=tt({token:n,factory:n.\u0275fac})}return n})(),MC=(()=>{class n{constructor(t){this._subject=new Xn,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const i=this._locationStrategy.getBaseHref();this._basePath=function Z$(n){if(new RegExp("^(https?:)?//").test(n)){const[,t]=n.split(/\/\/[^\/]+/);return t}return n}(BO(zO(i))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+Fl(i))}normalize(t){return n.stripTrailingSlash(function K$(n,e){if(!n||!e.startsWith(n))return e;const t=e.substring(n.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,zO(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Fl(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Fl(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{const i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i,complete:r})}static#e=this.normalizeQueryParams=Fl;static#t=this.joinWithSlash=wC;static#n=this.stripTrailingSlash=BO;static#i=this.\u0275fac=function(i){return new(i||n)(Ne(Md))};static#r=this.\u0275prov=tt({token:n,factory:function(){return function Y$(){return new MC(Ne(Md))}()},providedIn:"root"})}return n})();function zO(n){return n.replace(/\/index.html$/,"")}function ZO(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,s]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}const LC=/\s+/,JO=[];let OC=(()=>{class n{constructor(t,i,r,s){this._iterableDiffers=t,this._keyValueDiffers=i,this._ngEl=r,this._renderer=s,this.initialClasses=JO,this.stateMap=new Map}set klass(t){this.initialClasses=null!=t?t.trim().split(LC):JO}set ngClass(t){this.rawClass="string"==typeof t?t.trim().split(LC):t}ngDoCheck(){for(const i of this.initialClasses)this._updateState(i,!0);const t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(const i of t)this._updateState(i,!0);else if(null!=t)for(const i of Object.keys(t))this._updateState(i,!!t[i]);this._applyStateDiff()}_updateState(t,i){const r=this.stateMap.get(t);void 0!==r?(r.enabled!==i&&(r.changed=!0,r.enabled=i),r.touched=!0):this.stateMap.set(t,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(const t of this.stateMap){const i=t[0],r=t[1];r.changed?(this._toggleClass(i,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),r.touched=!1}}_toggleClass(t,i){(t=t.trim()).length>0&&t.split(LC).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}static#e=this.\u0275fac=function(i){return new(i||n)(ye(sb),ye(W_),ye(Tn),ye(vi))};static#t=this.\u0275dir=_t({type:n,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0})}return n})(),FC=(()=>{class n{constructor(t,i){this._viewContainer=t,this._context=new U8,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){tF("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){tF("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}static#e=this.\u0275fac=function(i){return new(i||n)(ye(la),ye(Ya))};static#t=this.\u0275dir=_t({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}return n})();class U8{constructor(){this.$implicit=null,this.ngIf=null}}function tF(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${Ai(e)}'.`)}let BC=(()=>{class n{constructor(t,i,r){this._ngEl=t,this._differs=i,this._renderer=r,this._ngStyle=null,this._differ=null}set ngStyle(t){this._ngStyle=t,!this._differ&&t&&(this._differ=this._differs.find(t).create())}ngDoCheck(){if(this._differ){const t=this._differ.diff(this._ngStyle);t&&this._applyChanges(t)}}_setStyle(t,i){const[r,s]=t.split("."),o=-1===r.indexOf("-")?void 0:Va.DashCase;null!=i?this._renderer.setStyle(this._ngEl.nativeElement,r,s?`${i}${s}`:i,o):this._renderer.removeStyle(this._ngEl.nativeElement,r,o)}_applyChanges(t){t.forEachRemovedItem(i=>this._setStyle(i.key,null)),t.forEachAddedItem(i=>this._setStyle(i.key,i.currentValue)),t.forEachChangedItem(i=>this._setStyle(i.key,i.currentValue))}static#e=this.\u0275fac=function(i){return new(i||n)(ye(Tn),ye(W_),ye(vi))};static#t=this.\u0275dir=_t({type:n,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0})}return n})(),VC=(()=>{class n{constructor(t){this._viewContainerRef=t,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(t){if(t.ngTemplateOutlet||t.ngTemplateOutletInjector){const i=this._viewContainerRef;if(this._viewRef&&i.remove(i.indexOf(this._viewRef)),this.ngTemplateOutlet){const{ngTemplateOutlet:r,ngTemplateOutletContext:s,ngTemplateOutletInjector:o}=this;this._viewRef=i.createEmbeddedView(r,s,o?{injector:o}:void 0)}else this._viewRef=null}else this._viewRef&&t.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}static#e=this.\u0275fac=function(i){return new(i||n)(ye(la))};static#t=this.\u0275dir=_t({type:n,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[Is]})}return n})(),q_=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=tr({type:n});static#n=this.\u0275inj=Vi({})}return n})();const rF="browser";function sF(n){return"server"===n}let pj=(()=>{class n{static#e=this.\u0275prov=tt({token:n,providedIn:"root",factory:()=>new mj(Ne(qr),window)})}return n})();class mj{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function gj(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&"function"==typeof n.body.attachShadow){const i=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const s=r.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}r=i.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.supportsScrolling()&&(this.window.history.scrollRestoration=e)}scrollToElement(e){const t=e.getBoundingClientRect(),i=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(i-s[0],r-s[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}class oF{}class Bj extends $${constructor(){super(...arguments),this.supportsDOMEvents=!0}}class $C extends Bj{static makeCurrent(){!function W$(n){bC||(bC=n)}(new $C)}onAndCancel(e,t,i){return e.addEventListener(t,i),()=>{e.removeEventListener(t,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function Vj(){return Y_=Y_||document.querySelector("base"),Y_?Y_.getAttribute("href"):null}();return null==t?null:function Hj(n){vb=vb||document.createElement("a"),vb.setAttribute("href",n);const e=vb.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){Y_=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return ZO(document.cookie,e)}}let vb,Y_=null,Gj=(()=>{class n{build(){return new XMLHttpRequest}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=tt({token:n,factory:n.\u0275fac})}return n})();const jC=new Ye("EventManagerPlugins");let dF=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>{r.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(s=>s.supports(t)),!i)throw new re(5101,!1);return this._eventNameToPlugin.set(t,i),i}static#e=this.\u0275fac=function(i){return new(i||n)(Ne(jC),Ne(In))};static#t=this.\u0275prov=tt({token:n,factory:n.\u0275fac})}return n})();class hF{constructor(e){this._doc=e}}const qC="ng-app-id";let fF=(()=>{class n{constructor(t,i,r,s={}){this.doc=t,this.appId=i,this.nonce=r,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=sF(s),this.resetHostNodes()}addStyles(t){for(const i of t)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(t){for(const i of t)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){const t=this.styleNodesInDOM;t&&(t.forEach(i=>i.remove()),t.clear());for(const i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const i of this.getAllStyles())this.addStyleToHost(t,i)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(const i of this.hostNodes)this.addStyleToHost(i,t)}onStyleRemoved(t){const i=this.styleRef;i.get(t)?.elements?.forEach(r=>r.remove()),i.delete(t)}collectServerRenderedStyles(){const t=this.doc.head?.querySelectorAll(`style[${qC}="${this.appId}"]`);if(t?.length){const i=new Map;return t.forEach(r=>{null!=r.textContent&&i.set(r.textContent,r)}),i}return null}changeUsageCount(t,i){const r=this.styleRef;if(r.has(t)){const s=r.get(t);return s.usage+=i,s.usage}return r.set(t,{usage:i,elements:[]}),i}getStyleElement(t,i){const r=this.styleNodesInDOM,s=r?.get(i);if(s?.parentNode===t)return r.delete(i),s.removeAttribute(qC),s;{const o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=i,this.platformIsServer&&o.setAttribute(qC,this.appId),o}}addStyleToHost(t,i){const r=this.getStyleElement(t,i);t.appendChild(r);const s=this.styleRef,o=s.get(i)?.elements;o?o.push(r):s.set(i,{elements:[r],usage:1})}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}static#e=this.\u0275fac=function(i){return new(i||n)(Ne(qr),Ne(Gf),Ne(xE,8),Ne(Wa))};static#t=this.\u0275prov=tt({token:n,factory:n.\u0275fac})}return n})();const XC={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},YC=/%COMP%/g,qj=new Ye("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function mF(n,e){return e.map(t=>t.replace(YC,n))}let KC=(()=>{class n{constructor(t,i,r,s,o,a,l,c=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=a,this.ngZone=l,this.nonce=c,this.rendererByCompId=new Map,this.platformIsServer=sF(a),this.defaultRenderer=new ZC(t,o,l,this.platformIsServer)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Cs.ShadowDom&&(i={...i,encapsulation:Cs.Emulated});const r=this.getOrCreateRenderer(t,i);return r instanceof _F?r.applyToHost(t):r instanceof JC&&r.applyStyles(),r}getOrCreateRenderer(t,i){const r=this.rendererByCompId;let s=r.get(i.id);if(!s){const o=this.doc,a=this.ngZone,l=this.eventManager,c=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,f=this.platformIsServer;switch(i.encapsulation){case Cs.Emulated:s=new _F(l,c,i,this.appId,d,o,a,f);break;case Cs.ShadowDom:return new Zj(l,c,t,i,o,a,this.nonce,f);default:s=new JC(l,c,i,d,o,a,f)}r.set(i.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static#e=this.\u0275fac=function(i){return new(i||n)(Ne(dF),Ne(fF),Ne(Gf),Ne(qj),Ne(qr),Ne(Wa),Ne(In),Ne(xE))};static#t=this.\u0275prov=tt({token:n,factory:n.\u0275fac})}return n})();class ZC{constructor(e,t,i,r){this.eventManager=e,this.doc=t,this.ngZone=i,this.platformIsServer=r,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(XC[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(gF(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(gF(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?this.doc.querySelector(e):e;if(!i)throw new re(-5104,!1);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const s=XC[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=XC[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(Va.DashCase|Va.Important)?e.style.setProperty(t,i,r&Va.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&Va.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e[t]=i}setValue(e,t){e.nodeValue=t}listen(e,t,i){if("string"==typeof e&&!(e=Jc().getGlobalEventTarget(this.doc,e)))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(i))}decoratePreventDefault(e){return t=>{if("__ngUnwrap__"===t)return e;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))&&t.preventDefault()}}}function gF(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class Zj extends ZC{constructor(e,t,i,r,s,o,a,l){super(e,s,o,l),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const c=mF(r.id,r.styles);for(const d of c){const f=document.createElement("style");a&&f.setAttribute("nonce",a),f.textContent=d,this.shadowRoot.appendChild(f)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class JC extends ZC{constructor(e,t,i,r,s,o,a,l){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r,this.styles=l?mF(l,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class _F extends JC{constructor(e,t,i,r,s,o,a,l){const c=r+"-"+i.id;super(e,t,i,s,o,a,l,c),this.contentAttr=function Xj(n){return"_ngcontent-%COMP%".replace(YC,n)}(c),this.hostAttr=function Yj(n){return"_nghost-%COMP%".replace(YC,n)}(c)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}let Jj=(()=>{class n extends hF{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}static#e=this.\u0275fac=function(i){return new(i||n)(Ne(qr))};static#t=this.\u0275prov=tt({token:n,factory:n.\u0275fac})}return n})();const yF=["alt","control","meta","shift"],Qj={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},e6={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let t6=(()=>{class n extends hF{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,r){const s=n.parseEventName(i),o=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Jc().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=n._normalizeKey(i.pop());let o="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),o="code."),yF.forEach(c=>{const d=i.indexOf(c);d>-1&&(i.splice(d,1),o+=c+".")}),o+=s,0!=i.length||0===s.length)return null;const l={};return l.domEventName=r,l.fullKey=o,l}static matchEventFullKeyCode(t,i){let r=Qj[t.key]||t.key,s="";return i.indexOf("code.")>-1&&(r=t.code,s="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),yF.forEach(o=>{o!==r&&(0,e6[o])(t)&&(s+=o+".")}),s+=r,s===i)}static eventCallback(t,i,r){return s=>{n.matchEventFullKeyCode(s,t)&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}static#e=this.\u0275fac=function(i){return new(i||n)(Ne(qr))};static#t=this.\u0275prov=tt({token:n,factory:n.\u0275fac})}return n})();const EF=[{provide:Wa,useValue:rF},{provide:wE,useValue:function n6(){$C.makeCurrent()},multi:!0},{provide:qr,useFactory:function r6(){return function sE(n){$r=n}(document),document},deps:[]}],s6=fO(I$,"browser",EF),o6=new Ye(""),bF=[{provide:tb,useClass:class zj{addToWindow(e){un.getAngularTestability=(i,r=!0)=>{const s=e.findTestabilityInTree(i,r);if(null==s)throw new re(5103,!1);return s},un.getAllAngularTestabilities=()=>e.getAllTestabilities(),un.getAllAngularRootElements=()=>e.getAllRootElements(),un.frameworkStabilizers||(un.frameworkStabilizers=[]),un.frameworkStabilizers.push(i=>{const r=un.getAllAngularTestabilities();let s=r.length,o=!1;const a=function(l){o=o||l,s--,0==s&&i(o)};r.forEach(l=>{l.whenStable(a)})})}findTestabilityInTree(e,t,i){return null==t?null:e.getTestability(t)??(i?Jc().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:lO,useClass:uC,deps:[In,dC,tb]},{provide:uC,useClass:uC,deps:[In,dC,tb]}],SF=[{provide:l_,useValue:"root"},{provide:Rl,useFactory:function i6(){return new Rl},deps:[]},{provide:jC,useClass:Jj,multi:!0,deps:[qr,In,Wa]},{provide:jC,useClass:t6,multi:!0,deps:[qr]},KC,fF,dF,{provide:zn,useExisting:KC},{provide:oF,useClass:Gj,deps:[]},[]];let wF=(()=>{class n{constructor(t){}static withServerTransition(t){return{ngModule:n,providers:[{provide:Gf,useValue:t.appId}]}}static#e=this.\u0275fac=function(i){return new(i||n)(Ne(o6,12))};static#t=this.\u0275mod=tr({type:n});static#n=this.\u0275inj=Vi({providers:[...SF,...bF],imports:[q_,R$]})}return n})(),MF=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static#e=this.\u0275fac=function(i){return new(i||n)(Ne(qr))};static#t=this.\u0275prov=tt({token:n,factory:function(i){let r=null;return r=i?new i:function l6(){return new MF(Ne(qr))}(),r},providedIn:"root"})}return n})();typeof window<"u"&&window;class AF{}class f6{}const Bl="*";function DF(n,e=null){return{type:2,steps:n,options:e}}function IF(n){return{type:6,styles:n,offset:null}}class K_{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class RF{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,i=0,r=0;const s=this.players.length;0==s?queueMicrotask(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++t==s&&this._onFinish()}),o.onDestroy(()=>{++i==s&&this._onDestroy()}),o.onStart(()=>{++r==s&&this._onStart()})}),this.totalTime=this.players.reduce((o,a)=>Math.max(o,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,t/i.totalTime):1;i.setPosition(r)})}getPosition(){const e=this.players.reduce((t,i)=>null===t||i.totalTime>t.totalTime?i:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}function PF(n){return new re(3e3,!1)}function eu(n){switch(n.length){case 0:return new K_;case 1:return n[0];default:return new RF(n)}}function NF(n,e,t=new Map,i=new Map){const r=[],s=[];let o=-1,a=null;if(e.forEach(l=>{const c=l.get("offset"),d=c==o,f=d&&a||new Map;l.forEach((p,m)=>{let _=m,E=p;if("offset"!==m)switch(_=n.normalizePropertyName(_,r),E){case"!":E=t.get(m);break;case Bl:E=i.get(m);break;default:E=n.normalizeStyleValue(m,_,E,r)}f.set(_,E)}),d||s.push(f),a=f,o=c}),r.length)throw function F6(n){return new re(3502,!1)}();return s}function tA(n,e,t,i){switch(e){case"start":n.onStart(()=>i(t&&nA(t,"start",n)));break;case"done":n.onDone(()=>i(t&&nA(t,"done",n)));break;case"destroy":n.onDestroy(()=>i(t&&nA(t,"destroy",n)))}}function nA(n,e,t){const s=iA(n.element,n.triggerName,n.fromState,n.toState,e||n.phaseName,t.totalTime??n.totalTime,!!t.disabled),o=n._data;return null!=o&&(s._data=o),s}function iA(n,e,t,i,r="",s=0,o){return{element:n,triggerName:e,fromState:t,toState:i,phaseName:r,totalTime:s,disabled:!!o}}function lo(n,e,t){let i=n.get(e);return i||n.set(e,i=t),i}function LF(n){const e=n.indexOf(":");return[n.substring(1,e),n.slice(e+1)]}const X6=(()=>typeof document>"u"?null:document.documentElement)();function rA(n){const e=n.parentNode||n.host||null;return e===X6?null:e}let xd=null,OF=!1;function FF(n,e){for(;e;){if(e===n)return!0;e=rA(e)}return!1}function kF(n,e,t){if(t)return Array.from(n.querySelectorAll(e));const i=n.querySelector(e);return i?[i]:[]}let UF=(()=>{class n{validateStyleProperty(t){return function K6(n){xd||(xd=function Z6(){return typeof document<"u"?document.body:null}()||{},OF=!!xd.style&&"WebkitAppearance"in xd.style);let e=!0;return xd.style&&!function Y6(n){return"ebkit"==n.substring(1,6)}(n)&&(e=n in xd.style,!e&&OF&&(e="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in xd.style)),e}(t)}matchesElement(t,i){return!1}containsElement(t,i){return FF(t,i)}getParentElement(t){return rA(t)}query(t,i,r){return kF(t,i,r)}computeStyle(t,i,r){return r||""}animate(t,i,r,s,o,a=[],l){return new K_(r,s)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=tt({token:n,factory:n.\u0275fac})}return n})(),sA=(()=>{class n{static#e=this.NOOP=new UF}return n})();const J6=1e3,oA="ng-enter",Eb="ng-leave",bb="ng-trigger",Sb=".ng-trigger",VF="ng-animating",aA=".ng-animating";function Vl(n){if("number"==typeof n)return n;const e=n.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:lA(parseFloat(e[1]),e[2])}function lA(n,e){return"s"===e?n*J6:n}function wb(n,e,t){return n.hasOwnProperty("duration")?n:function e9(n,e,t){let r,s=0,o="";if("string"==typeof n){const a=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return e.push(PF()),{duration:0,delay:0,easing:""};r=lA(parseFloat(a[1]),a[2]);const l=a[3];null!=l&&(s=lA(parseFloat(l),a[4]));const c=a[5];c&&(o=c)}else r=n;if(!t){let a=!1,l=e.length;r<0&&(e.push(function p6(){return new re(3100,!1)}()),a=!0),s<0&&(e.push(function m6(){return new re(3101,!1)}()),a=!0),a&&e.splice(l,0,PF())}return{duration:r,delay:s,easing:o}}(n,e,t)}function Z_(n,e={}){return Object.keys(n).forEach(t=>{e[t]=n[t]}),e}function HF(n){const e=new Map;return Object.keys(n).forEach(t=>{e.set(t,n[t])}),e}function tu(n,e=new Map,t){if(t)for(let[i,r]of t)e.set(i,r);for(let[i,r]of n)e.set(i,r);return e}function Ka(n,e,t){e.forEach((i,r)=>{const s=uA(r);t&&!t.has(r)&&t.set(r,n.style[s]),n.style[s]=i})}function Td(n,e){e.forEach((t,i)=>{const r=uA(i);n.style[r]=""})}function J_(n){return Array.isArray(n)?1==n.length?n[0]:DF(n):n}const cA=new RegExp("{{\\s*(.+?)\\s*}}","g");function GF(n){let e=[];if("string"==typeof n){let t;for(;t=cA.exec(n);)e.push(t[1]);cA.lastIndex=0}return e}function Q_(n,e,t){const i=n.toString(),r=i.replace(cA,(s,o)=>{let a=e[o];return null==a&&(t.push(function _6(n){return new re(3003,!1)}()),a=""),a.toString()});return r==i?n:r}function Mb(n){const e=[];let t=n.next();for(;!t.done;)e.push(t.value),t=n.next();return e}const i9=/-+([a-z0-9])/g;function uA(n){return n.replace(i9,(...e)=>e[1].toUpperCase())}function co(n,e,t){switch(e.type){case 7:return n.visitTrigger(e,t);case 0:return n.visitState(e,t);case 1:return n.visitTransition(e,t);case 2:return n.visitSequence(e,t);case 3:return n.visitGroup(e,t);case 4:return n.visitAnimate(e,t);case 5:return n.visitKeyframes(e,t);case 6:return n.visitStyle(e,t);case 8:return n.visitReference(e,t);case 9:return n.visitAnimateChild(e,t);case 10:return n.visitAnimateRef(e,t);case 11:return n.visitQuery(e,t);case 12:return n.visitStagger(e,t);default:throw function y6(n){return new re(3004,!1)}()}}function WF(n,e){return window.getComputedStyle(n)[e]}const xb="*";function o9(n,e){const t=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(i=>function a9(n,e,t){if(":"==n[0]){const l=function l9(n,e){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,i)=>parseFloat(i)>parseFloat(t);case":decrement":return(t,i)=>parseFloat(i)<parseFloat(t);default:return e.push(function P6(n){return new re(3016,!1)}()),"* => *"}}(n,t);if("function"==typeof l)return void e.push(l);n=l}const i=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return t.push(function R6(n){return new re(3015,!1)}()),e;const r=i[1],s=i[2],o=i[3];e.push($F(r,o));"<"==s[0]&&!(r==xb&&o==xb)&&e.push($F(o,r))}(i,t,e)):t.push(n),t}const Tb=new Set(["true","1"]),Cb=new Set(["false","0"]);function $F(n,e){const t=Tb.has(n)||Cb.has(n),i=Tb.has(e)||Cb.has(e);return(r,s)=>{let o=n==xb||n==r,a=e==xb||e==s;return!o&&t&&"boolean"==typeof r&&(o=r?Tb.has(n):Cb.has(n)),!a&&i&&"boolean"==typeof s&&(a=s?Tb.has(e):Cb.has(e)),o&&a}}const c9=new RegExp("s*:selfs*,?","g");function dA(n,e,t,i){return new u9(n).build(e,t,i)}class u9{constructor(e){this._driver=e}build(e,t,i){const r=new f9(t);return this._resetContextStyleTimingState(r),co(this,J_(e),r)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles=new Map,e.collectedStyles.set("",new Map),e.currentTime=0}visitTrigger(e,t){let i=t.queryCount=0,r=t.depCount=0;const s=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push(function E6(){return new re(3006,!1)}()),e.definitions.forEach(a=>{if(this._resetContextStyleTimingState(t),0==a.type){const l=a,c=l.name;c.toString().split(/\s*,\s*/).forEach(d=>{l.name=d,s.push(this.visitState(l,t))}),l.name=c}else if(1==a.type){const l=this.visitTransition(a,t);i+=l.queryCount,r+=l.depCount,o.push(l)}else t.errors.push(function b6(){return new re(3007,!1)}())}),{type:7,name:e.name,states:s,transitions:o,queryCount:i,depCount:r,options:null}}visitState(e,t){const i=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(i.containsDynamicStyles){const s=new Set,o=r||{};i.styles.forEach(a=>{a instanceof Map&&a.forEach(l=>{GF(l).forEach(c=>{o.hasOwnProperty(c)||s.add(c)})})}),s.size&&(Mb(s.values()),t.errors.push(function S6(n,e){return new re(3008,!1)}()))}return{type:0,name:e.name,style:i,options:r?{params:r}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const i=co(this,J_(e.animation),t);return{type:1,matchers:o9(e.expr,t.errors),animation:i,queryCount:t.queryCount,depCount:t.depCount,options:Cd(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(i=>co(this,i,t)),options:Cd(e.options)}}visitGroup(e,t){const i=t.currentTime;let r=0;const s=e.steps.map(o=>{t.currentTime=i;const a=co(this,o,t);return r=Math.max(r,t.currentTime),a});return t.currentTime=r,{type:3,steps:s,options:Cd(e.options)}}visitAnimate(e,t){const i=function m9(n,e){if(n.hasOwnProperty("duration"))return n;if("number"==typeof n)return hA(wb(n,e).duration,0,"");const t=n;if(t.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=hA(0,0,"");return s.dynamic=!0,s.strValue=t,s}const r=wb(t,e);return hA(r.duration,r.delay,r.easing)}(e.timings,t.errors);t.currentAnimateTimings=i;let r,s=e.styles?e.styles:IF({});if(5==s.type)r=this.visitKeyframes(s,t);else{let o=e.styles,a=!1;if(!o){a=!0;const c={};i.easing&&(c.easing=i.easing),o=IF(c)}t.currentTime+=i.duration+i.delay;const l=this.visitStyle(o,t);l.isEmptyStep=a,r=l}return t.currentAnimateTimings=null,{type:4,timings:i,style:r,options:null}}visitStyle(e,t){const i=this._makeStyleAst(e,t);return this._validateStyleAst(i,t),i}_makeStyleAst(e,t){const i=[],r=Array.isArray(e.styles)?e.styles:[e.styles];for(let a of r)"string"==typeof a?a===Bl?i.push(a):t.errors.push(new re(3002,!1)):i.push(HF(a));let s=!1,o=null;return i.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(o=a.get("easing"),a.delete("easing")),!s))for(let l of a.values())if(l.toString().indexOf("{{")>=0){s=!0;break}}),{type:6,styles:i,easing:o,offset:e.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(e,t){const i=t.currentAnimateTimings;let r=t.currentTime,s=t.currentTime;i&&s>0&&(s-=i.duration+i.delay),e.styles.forEach(o=>{"string"!=typeof o&&o.forEach((a,l)=>{const c=t.collectedStyles.get(t.currentQuerySelector),d=c.get(l);let f=!0;d&&(s!=r&&s>=d.startTime&&r<=d.endTime&&(t.errors.push(function M6(n,e,t,i,r){return new re(3010,!1)}()),f=!1),s=d.startTime),f&&c.set(l,{startTime:s,endTime:r}),t.options&&function n9(n,e,t){const i=e.params||{},r=GF(n);r.length&&r.forEach(s=>{i.hasOwnProperty(s)||t.push(function g6(n){return new re(3001,!1)}())})}(a,t.options,t.errors)})})}visitKeyframes(e,t){const i={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function x6(){return new re(3011,!1)}()),i;let s=0;const o=[];let a=!1,l=!1,c=0;const d=e.steps.map(y=>{const S=this._makeStyleAst(y,t);let b=null!=S.offset?S.offset:function p9(n){if("string"==typeof n)return null;let e=null;if(Array.isArray(n))n.forEach(t=>{if(t instanceof Map&&t.has("offset")){const i=t;e=parseFloat(i.get("offset")),i.delete("offset")}});else if(n instanceof Map&&n.has("offset")){const t=n;e=parseFloat(t.get("offset")),t.delete("offset")}return e}(S.styles),M=0;return null!=b&&(s++,M=S.offset=b),l=l||M<0||M>1,a=a||M<c,c=M,o.push(M),S});l&&t.errors.push(function T6(){return new re(3012,!1)}()),a&&t.errors.push(function C6(){return new re(3200,!1)}());const f=e.steps.length;let p=0;s>0&&s<f?t.errors.push(function A6(){return new re(3202,!1)}()):0==s&&(p=1/(f-1));const m=f-1,_=t.currentTime,E=t.currentAnimateTimings,v=E.duration;return d.forEach((y,S)=>{const b=p>0?S==m?1:p*S:o[S],M=b*v;t.currentTime=_+E.delay+M,E.duration=M,this._validateStyleAst(y,t),y.offset=b,i.styles.push(y)}),i}visitReference(e,t){return{type:8,animation:co(this,J_(e.animation),t),options:Cd(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:Cd(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:Cd(e.options)}}visitQuery(e,t){const i=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;const[s,o]=function d9(n){const e=!!n.split(/\s*,\s*/).find(t=>":self"==t);return e&&(n=n.replace(c9,"")),n=n.replace(/@\*/g,Sb).replace(/@\w+/g,t=>Sb+"-"+t.slice(1)).replace(/:animating/g,aA),[n,e]}(e.selector);t.currentQuerySelector=i.length?i+" "+s:s,lo(t.collectedStyles,t.currentQuerySelector,new Map);const a=co(this,J_(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=i,{type:11,selector:s,limit:r.limit||0,optional:!!r.optional,includeSelf:o,animation:a,originalSelector:e.selector,options:Cd(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function D6(){return new re(3013,!1)}());const i="full"===e.timings?{duration:0,delay:0,easing:"full"}:wb(e.timings,t.errors,!0);return{type:12,animation:co(this,J_(e.animation),t),timings:i,options:null}}}class f9{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function Cd(n){return n?(n=Z_(n)).params&&(n.params=function h9(n){return n?Z_(n):null}(n.params)):n={},n}function hA(n,e,t){return{duration:n,delay:e,easing:t}}function fA(n,e,t,i,r,s,o=null,a=!1){return{type:1,element:n,keyframes:e,preStyleProps:t,postStyleProps:i,duration:r,delay:s,totalTime:r+s,easing:o,subTimeline:a}}class Ab{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let i=this._map.get(e);i||this._map.set(e,i=[]),i.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const y9=new RegExp(":enter","g"),E9=new RegExp(":leave","g");function pA(n,e,t,i,r,s=new Map,o=new Map,a,l,c=[]){return(new b9).buildKeyframes(n,e,t,i,r,s,o,a,l,c)}class b9{buildKeyframes(e,t,i,r,s,o,a,l,c,d=[]){c=c||new Ab;const f=new mA(e,t,c,r,s,d,[]);f.options=l;const p=l.delay?Vl(l.delay):0;f.currentTimeline.delayNextStep(p),f.currentTimeline.setStyles([o],null,f.errors,l),co(this,i,f);const m=f.timelines.filter(_=>_.containsAnimation());if(m.length&&a.size){let _;for(let E=m.length-1;E>=0;E--){const v=m[E];if(v.element===t){_=v;break}}_&&!_.allowOnlyTimelineStyles()&&_.setStyles([a],null,f.errors,l)}return m.length?m.map(_=>_.buildKeyframes()):[fA(t,[],[],[],0,p,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const i=t.subInstructions.get(t.element);if(i){const r=t.createSubContext(e.options),s=t.currentTimeline.currentTime,o=this._visitSubInstructions(i,r,r.options);s!=o&&t.transformIntoNewTimeline(o)}t.previousNode=e}visitAnimateRef(e,t){const i=t.createSubContext(e.options);i.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],t,i),this.visitReference(e.animation,i),t.transformIntoNewTimeline(i.currentTimeline.currentTime),t.previousNode=e}_applyAnimationRefDelays(e,t,i){for(const r of e){const s=r?.delay;if(s){const o="number"==typeof s?s:Vl(Q_(s,r?.params??{},t.errors));i.delayNextStep(o)}}}_visitSubInstructions(e,t,i){let s=t.currentTimeline.currentTime;const o=null!=i.duration?Vl(i.duration):null,a=null!=i.delay?Vl(i.delay):null;return 0!==o&&e.forEach(l=>{const c=t.appendInstructionToTimeline(l,o,a);s=Math.max(s,c.duration+c.delay)}),s}visitReference(e,t){t.updateOptions(e.options,!0),co(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const i=t.subContextCount;let r=t;const s=e.options;if(s&&(s.params||s.delay)&&(r=t.createSubContext(s),r.transformIntoNewTimeline(),null!=s.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=Db);const o=Vl(s.delay);r.delayNextStep(o)}e.steps.length&&(e.steps.forEach(o=>co(this,o,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const i=[];let r=t.currentTimeline.currentTime;const s=e.options&&e.options.delay?Vl(e.options.delay):0;e.steps.forEach(o=>{const a=t.createSubContext(e.options);s&&a.delayNextStep(s),co(this,o,a),r=Math.max(r,a.currentTimeline.currentTime),i.push(a.currentTimeline)}),i.forEach(o=>t.currentTimeline.mergeTimelineCollectedStyles(o)),t.transformIntoNewTimeline(r),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const i=e.strValue;return wb(t.params?Q_(i,t.params,t.errors):i,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const i=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;i.delay&&(t.incrementTime(i.delay),r.snapshotCurrentStyles());const s=e.style;5==s.type?this.visitKeyframes(s,t):(t.incrementTime(i.duration),this.visitStyle(s,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const i=t.currentTimeline,r=t.currentAnimateTimings;!r&&i.hasCurrentStyleProperties()&&i.forwardFrame();const s=r&&r.easing||e.easing;e.isEmptyStep?i.applyEmptyStep(s):i.setStyles(e.styles,s,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const i=t.currentAnimateTimings,r=t.currentTimeline.duration,s=i.duration,a=t.createSubContext().currentTimeline;a.easing=i.easing,e.styles.forEach(l=>{a.forwardTime((l.offset||0)*s),a.setStyles(l.styles,l.easing,t.errors,t.options),a.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(r+s),t.previousNode=e}visitQuery(e,t){const i=t.currentTimeline.currentTime,r=e.options||{},s=r.delay?Vl(r.delay):0;s&&(6===t.previousNode.type||0==i&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=Db);let o=i;const a=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!r.optional,t.errors);t.currentQueryTotal=a.length;let l=null;a.forEach((c,d)=>{t.currentQueryIndex=d;const f=t.createSubContext(e.options,c);s&&f.delayNextStep(s),c===t.element&&(l=f.currentTimeline),co(this,e.animation,f),f.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,f.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),l&&(t.currentTimeline.mergeTimelineCollectedStyles(l),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const i=t.parentContext,r=t.currentTimeline,s=e.timings,o=Math.abs(s.duration),a=o*(t.currentQueryTotal-1);let l=o*t.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":l=a-l;break;case"full":l=i.currentStaggerTime}const d=t.currentTimeline;l&&d.delayNextStep(l);const f=d.currentTime;co(this,e.animation,t),t.previousNode=e,i.currentStaggerTime=r.currentTime-f+(r.startTime-i.currentTimeline.startTime)}}const Db={};class mA{constructor(e,t,i,r,s,o,a,l){this._driver=e,this.element=t,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=s,this.errors=o,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Db,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=l||new Ib(this._driver,t,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const i=e;let r=this.options;null!=i.duration&&(r.duration=Vl(i.duration)),null!=i.delay&&(r.delay=Vl(i.delay));const s=i.params;if(s){let o=r.params;o||(o=this.options.params={}),Object.keys(s).forEach(a=>{(!t||!o.hasOwnProperty(a))&&(o[a]=Q_(s[a],o,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const i=e.params={};Object.keys(t).forEach(r=>{i[r]=t[r]})}}return e}createSubContext(e=null,t,i){const r=t||this.element,s=new mA(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(e),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(e){return this.previousNode=Db,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,i){const r={duration:t??e.duration,delay:this.currentTimeline.currentTime+(i??0)+e.delay,easing:""},s=new S9(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(s),r}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,i,r,s,o){let a=[];if(r&&a.push(this.element),e.length>0){e=(e=e.replace(y9,"."+this._enterClassName)).replace(E9,"."+this._leaveClassName);let c=this._driver.query(this.element,e,1!=i);0!==i&&(c=i<0?c.slice(c.length+i,c.length):c.slice(0,i)),a.push(...c)}return!s&&0==a.length&&o.push(function I6(n){return new re(3014,!1)}()),a}}class Ib{constructor(e,t,i,r){this._driver=e,this.element=t,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new Ib(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,i]of this._globalTimelineStyles)this._backFill.set(t,i||Bl),this._currentKeyframe.set(t,Bl);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,i,r){t&&this._previousKeyframe.set("easing",t);const s=r&&r.params||{},o=function w9(n,e){const t=new Map;let i;return n.forEach(r=>{if("*"===r){i=i||e.keys();for(let s of i)t.set(s,Bl)}else tu(r,t)}),t}(e,this._globalTimelineStyles);for(let[a,l]of o){const c=Q_(l,s,i);this._pendingStyles.set(a,c),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??Bl),this._updateStyle(a,c)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,i)=>{const r=this._styleSummary.get(i);(!r||t.time>r.time)&&this._updateStyle(i,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((a,l)=>{const c=tu(a,new Map,this._backFill);c.forEach((d,f)=>{"!"===d?e.add(f):d===Bl&&t.add(f)}),i||c.set("offset",l/this.duration),r.push(c)});const s=e.size?Mb(e.values()):[],o=t.size?Mb(t.values()):[];if(i){const a=r[0],l=new Map(a);a.set("offset",0),l.set("offset",1),r=[a,l]}return fA(this.element,r,s,o,this.duration,this.startTime,this.easing,!1)}}class S9 extends Ib{constructor(e,t,i,r,s,o,a=!1){super(e,t,o.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=s,this._stretchStartingKeyframe=a,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&t){const s=[],o=i+t,a=t/o,l=tu(e[0]);l.set("offset",0),s.push(l);const c=tu(e[0]);c.set("offset",XF(a)),s.push(c);const d=e.length-1;for(let f=1;f<=d;f++){let p=tu(e[f]);const m=p.get("offset");p.set("offset",XF((t+m*i)/o)),s.push(p)}i=o,t=0,r="",e=s}return fA(this.element,e,this.preStyleProps,this.postStyleProps,i,t,r,!0)}}function XF(n,e=3){const t=Math.pow(10,e-1);return Math.round(n*t)/t}class gA{}const M9=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class x9 extends gA{normalizePropertyName(e,t){return uA(e)}normalizeStyleValue(e,t,i,r){let s="";const o=i.toString().trim();if(M9.has(t)&&0!==i&&"0"!==i)if("number"==typeof i)s="px";else{const a=i.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&r.push(function v6(n,e){return new re(3005,!1)}())}return o+s}}function YF(n,e,t,i,r,s,o,a,l,c,d,f,p){return{type:0,element:n,triggerName:e,isRemovalTransition:r,fromState:t,fromStyles:s,toState:i,toStyles:o,timelines:a,queriedElements:l,preStyleProps:c,postStyleProps:d,totalTime:f,errors:p}}const _A={};class KF{constructor(e,t,i){this._triggerName=e,this.ast=t,this._stateStyles=i}match(e,t,i,r){return function T9(n,e,t,i,r){return n.some(s=>s(e,t,i,r))}(this.ast.matchers,e,t,i,r)}buildStyles(e,t,i){let r=this._stateStyles.get("*");return void 0!==e&&(r=this._stateStyles.get(e?.toString())||r),r?r.buildStyles(t,i):new Map}build(e,t,i,r,s,o,a,l,c,d){const f=[],p=this.ast.options&&this.ast.options.params||_A,_=this.buildStyles(i,a&&a.params||_A,f),E=l&&l.params||_A,v=this.buildStyles(r,E,f),y=new Set,S=new Map,b=new Map,M="void"===r,T={params:C9(E,p),delay:this.ast.options?.delay},I=d?[]:pA(e,t,this.ast.animation,s,o,_,v,T,c,f);let A=0;if(I.forEach(C=>{A=Math.max(C.duration+C.delay,A)}),f.length)return YF(t,this._triggerName,i,r,M,_,v,[],[],S,b,A,f);I.forEach(C=>{const N=C.element,K=lo(S,N,new Set);C.preStyleProps.forEach(ue=>K.add(ue));const oe=lo(b,N,new Set);C.postStyleProps.forEach(ue=>oe.add(ue)),N!==t&&y.add(N)});const F=Mb(y.values());return YF(t,this._triggerName,i,r,M,_,v,I,F,S,b,A)}}function C9(n,e){const t=Z_(e);for(const i in n)n.hasOwnProperty(i)&&null!=n[i]&&(t[i]=n[i]);return t}class A9{constructor(e,t,i){this.styles=e,this.defaultParams=t,this.normalizer=i}buildStyles(e,t){const i=new Map,r=Z_(this.defaultParams);return Object.keys(e).forEach(s=>{const o=e[s];null!==o&&(r[s]=o)}),this.styles.styles.forEach(s=>{"string"!=typeof s&&s.forEach((o,a)=>{o&&(o=Q_(o,r,t));const l=this.normalizer.normalizePropertyName(a,t);o=this.normalizer.normalizeStyleValue(a,l,o,t),i.set(a,o)})}),i}}class I9{constructor(e,t,i){this.name=e,this.ast=t,this._normalizer=i,this.transitionFactories=[],this.states=new Map,t.states.forEach(r=>{this.states.set(r.name,new A9(r.style,r.options&&r.options.params||{},i))}),ZF(this.states,"true","1"),ZF(this.states,"false","0"),t.transitions.forEach(r=>{this.transitionFactories.push(new KF(e,r,this.states))}),this.fallbackTransition=function R9(n,e,t){return new KF(n,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,a)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,i,r){return this.transitionFactories.find(o=>o.match(e,t,i,r))||null}matchStyles(e,t,i){return this.fallbackTransition.buildStyles(e,t,i)}}function ZF(n,e,t){n.has(e)?n.has(t)||n.set(t,n.get(e)):n.has(t)&&n.set(e,n.get(t))}const P9=new Ab;class N9{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,t){const i=[],s=dA(this._driver,t,i,[]);if(i.length)throw function k6(n){return new re(3503,!1)}();this._animations.set(e,s)}_buildPlayer(e,t,i){const r=e.element,s=NF(this._normalizer,e.keyframes,t,i);return this._driver.animate(r,s,e.duration,e.delay,e.easing,[],!0)}create(e,t,i={}){const r=[],s=this._animations.get(e);let o;const a=new Map;if(s?(o=pA(this._driver,t,s,oA,Eb,new Map,new Map,i,P9,r),o.forEach(d=>{const f=lo(a,d.element,new Map);d.postStyleProps.forEach(p=>f.set(p,null))})):(r.push(function U6(){return new re(3300,!1)}()),o=[]),r.length)throw function B6(n){return new re(3504,!1)}();a.forEach((d,f)=>{d.forEach((p,m)=>{d.set(m,this._driver.computeStyle(f,m,Bl))})});const c=eu(o.map(d=>{const f=a.get(d.element);return this._buildPlayer(d,new Map,f)}));return this._playersById.set(e,c),c.onDestroy(()=>this.destroy(e)),this.players.push(c),c}destroy(e){const t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);const i=this.players.indexOf(t);i>=0&&this.players.splice(i,1)}_getPlayer(e){const t=this._playersById.get(e);if(!t)throw function V6(n){return new re(3301,!1)}();return t}listen(e,t,i,r){const s=iA(t,"","","");return tA(this._getPlayer(e),i,s,r),()=>{}}command(e,t,i,r){if("register"==i)return void this.register(e,r[0]);if("create"==i)return void this.create(e,t,r[0]||{});const s=this._getPlayer(e);switch(i){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}}const JF="ng-animate-queued",yA="ng-animate-disabled",U9=[],QF={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},B9={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},da="__ng_removed";class vA{get params(){return this.options.params}constructor(e,t=""){this.namespaceId=t;const i=e&&e.hasOwnProperty("value");if(this.value=function G9(n){return n??null}(i?e.value:e),i){const s=Z_(e);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){const t=e.params;if(t){const i=this.options.params;Object.keys(t).forEach(r=>{null==i[r]&&(i[r]=t[r])})}}}const ey="void",EA=new vA(ey);class V9{constructor(e,t,i){this.id=e,this.hostElement=t,this._engine=i,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,ko(t,this._hostClassName)}listen(e,t,i,r){if(!this._triggers.has(t))throw function H6(n,e){return new re(3302,!1)}();if(null==i||0==i.length)throw function z6(n){return new re(3303,!1)}();if(!function W9(n){return"start"==n||"done"==n}(i))throw function G6(n,e){return new re(3400,!1)}();const s=lo(this._elementListeners,e,[]),o={name:t,phase:i,callback:r};s.push(o);const a=lo(this._engine.statesByElement,e,new Map);return a.has(t)||(ko(e,bb),ko(e,bb+"-"+t),a.set(t,EA)),()=>{this._engine.afterFlush(()=>{const l=s.indexOf(o);l>=0&&s.splice(l,1),this._triggers.has(t)||a.delete(t)})}}register(e,t){return!this._triggers.has(e)&&(this._triggers.set(e,t),!0)}_getTrigger(e){const t=this._triggers.get(e);if(!t)throw function W6(n){return new re(3401,!1)}();return t}trigger(e,t,i,r=!0){const s=this._getTrigger(t),o=new bA(this.id,t,e);let a=this._engine.statesByElement.get(e);a||(ko(e,bb),ko(e,bb+"-"+t),this._engine.statesByElement.set(e,a=new Map));let l=a.get(t);const c=new vA(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&l&&c.absorbOptions(l.options),a.set(t,c),l||(l=EA),c.value!==ey&&l.value===c.value){if(!function q9(n,e){const t=Object.keys(n),i=Object.keys(e);if(t.length!=i.length)return!1;for(let r=0;r<t.length;r++){const s=t[r];if(!e.hasOwnProperty(s)||n[s]!==e[s])return!1}return!0}(l.params,c.params)){const E=[],v=s.matchStyles(l.value,l.params,E),y=s.matchStyles(c.value,c.params,E);E.length?this._engine.reportError(E):this._engine.afterFlush(()=>{Td(e,v),Ka(e,y)})}return}const p=lo(this._engine.playersByElement,e,[]);p.forEach(E=>{E.namespaceId==this.id&&E.triggerName==t&&E.queued&&E.destroy()});let m=s.matchTransition(l.value,c.value,e,c.params),_=!1;if(!m){if(!r)return;m=s.fallbackTransition,_=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:m,fromState:l,toState:c,player:o,isFallbackTransition:_}),_||(ko(e,JF),o.onStart(()=>{pp(e,JF)})),o.onDone(()=>{let E=this.players.indexOf(o);E>=0&&this.players.splice(E,1);const v=this._engine.playersByElement.get(e);if(v){let y=v.indexOf(o);y>=0&&v.splice(y,1)}}),this.players.push(o),p.push(o),o}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,i)=>{this._elementListeners.set(i,t.filter(r=>r.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(i=>i.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const i=this._engine.driver.query(e,Sb,!0);i.forEach(r=>{if(r[da])return;const s=this._engine.fetchNamespacesByElement(r);s.size?s.forEach(o=>o.triggerLeaveAnimation(r,t,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(e,t,i,r){const s=this._engine.statesByElement.get(e),o=new Map;if(s){const a=[];if(s.forEach((l,c)=>{if(o.set(c,l.value),this._triggers.has(c)){const d=this.trigger(e,c,ey,r);d&&a.push(d)}}),a.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,o),i&&eu(a).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),i=this._engine.statesByElement.get(e);if(t&&i){const r=new Set;t.forEach(s=>{const o=s.name;if(r.has(o))return;r.add(o);const l=this._triggers.get(o).fallbackTransition,c=i.get(o)||EA,d=new vA(ey),f=new bA(this.id,o,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:o,transition:l,fromState:c,toState:d,player:f,isFallbackTransition:!0})})}}removeNode(e,t){const i=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let r=!1;if(i.totalAnimations){const s=i.players.length?i.playersByQueriedElement.get(e):[];if(s&&s.length)r=!0;else{let o=e;for(;o=o.parentNode;)if(i.statesByElement.get(o)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(e),r)i.markElementAsRemoved(this.id,e,!1,t);else{const s=e[da];(!s||s===QF)&&(i.afterFlush(()=>this.clearElementCache(e)),i.destroyInnerAnimations(e),i._onRemovalComplete(e,t))}}insertNode(e,t){ko(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const s=i.element,o=this._elementListeners.get(s);o&&o.forEach(a=>{if(a.name==i.triggerName){const l=iA(s,i.triggerName,i.fromState.value,i.toState.value);l._data=e,tA(i.player,a.phase,l,a.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):t.push(i)}),this._queue=[],t.sort((i,r)=>{const s=i.transition.ast.depCount,o=r.transition.ast.depCount;return 0==s||0==o?s-o:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}}class H9{_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}constructor(e,t,i){this.bodyNode=e,this.driver=t,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,s)=>{}}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(i=>{i.queued&&e.push(i)})}),e}createNamespace(e,t){const i=new V9(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(i,t):(this.newHostElements.set(t,i),this.collectEnterElement(t)),this._namespaceLookup[e]=i}_balanceNamespaceList(e,t){const i=this._namespaceList,r=this.namespacesByHostElement;if(i.length-1>=0){let o=!1,a=this.driver.getParentElement(t);for(;a;){const l=r.get(a);if(l){const c=i.indexOf(l);i.splice(c+1,0,e),o=!0;break}a=this.driver.getParentElement(a)}o||i.unshift(e)}else i.push(e);return r.set(t,e),e}register(e,t){let i=this._namespaceLookup[e];return i||(i=this.createNamespace(e,t)),i}registerTrigger(e,t,i){let r=this._namespaceLookup[e];r&&r.register(t,i)&&this.totalAnimations++}destroy(e,t){e&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const i=this._fetchNamespace(e);this.namespacesByHostElement.delete(i.hostElement);const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1),i.destroy(t),delete this._namespaceLookup[e]}))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,i=this.statesByElement.get(e);if(i)for(let r of i.values())if(r.namespaceId){const s=this._fetchNamespace(r.namespaceId);s&&t.add(s)}return t}trigger(e,t,i,r){if(Rb(t)){const s=this._fetchNamespace(e);if(s)return s.trigger(t,i,r),!0}return!1}insertNode(e,t,i,r){if(!Rb(t))return;const s=t[da];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const o=this.collectedLeaveElements.indexOf(t);o>=0&&this.collectedLeaveElements.splice(o,1)}if(e){const o=this._fetchNamespace(e);o&&o.insertNode(t,i)}r&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),ko(e,yA)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),pp(e,yA))}removeNode(e,t,i){if(Rb(t)){const r=e?this._fetchNamespace(e):null;r?r.removeNode(t,i):this.markElementAsRemoved(e,t,!1,i);const s=this.namespacesByHostElement.get(t);s&&s.id!==e&&s.removeNode(t,i)}else this._onRemovalComplete(t,i)}markElementAsRemoved(e,t,i,r,s){this.collectedLeaveElements.push(t),t[da]={namespaceId:e,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:s}}listen(e,t,i,r,s){return Rb(t)?this._fetchNamespace(e).listen(t,i,r,s):()=>{}}_buildInstruction(e,t,i,r,s){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,i,r,e.fromState.options,e.toState.options,t,s)}destroyInnerAnimations(e){let t=this.driver.query(e,Sb,!0);t.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,aA,!0),t.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return eu(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e[da];if(t&&t.setForRemoval){if(e[da]=QF,t.namespaceId){this.destroyInnerAnimations(e);const i=this._fetchNamespace(t.namespaceId);i&&i.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(yA)&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)ko(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{t=this._flushAnimations(i,e)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],t.length?eu(t).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(e){throw function $6(n){return new re(3402,!1)}()}_flushAnimations(e,t){const i=new Ab,r=[],s=new Map,o=[],a=new Map,l=new Map,c=new Map,d=new Set;this.disabledNodes.forEach($=>{d.add($);const Y=this.driver.query($,".ng-animate-queued",!0);for(let ie=0;ie<Y.length;ie++)d.add(Y[ie])});const f=this.bodyNode,p=Array.from(this.statesByElement.keys()),m=n2(p,this.collectedEnterElements),_=new Map;let E=0;m.forEach(($,Y)=>{const ie=oA+E++;_.set(Y,ie),$.forEach(Z=>ko(Z,ie))});const v=[],y=new Set,S=new Set;for(let $=0;$<this.collectedLeaveElements.length;$++){const Y=this.collectedLeaveElements[$],ie=Y[da];ie&&ie.setForRemoval&&(v.push(Y),y.add(Y),ie.hasAnimation?this.driver.query(Y,".ng-star-inserted",!0).forEach(Z=>y.add(Z)):S.add(Y))}const b=new Map,M=n2(p,Array.from(y));M.forEach(($,Y)=>{const ie=Eb+E++;b.set(Y,ie),$.forEach(Z=>ko(Z,ie))}),e.push(()=>{m.forEach(($,Y)=>{const ie=_.get(Y);$.forEach(Z=>pp(Z,ie))}),M.forEach(($,Y)=>{const ie=b.get(Y);$.forEach(Z=>pp(Z,ie))}),v.forEach($=>{this.processLeaveNode($)})});const T=[],I=[];for(let $=this._namespaceList.length-1;$>=0;$--)this._namespaceList[$].drainQueuedTransitions(t).forEach(ie=>{const Z=ie.player,de=ie.element;if(T.push(Z),this.collectedEnterElements.length){const Ge=de[da];if(Ge&&Ge.setForMove){if(Ge.previousTriggersValues&&Ge.previousTriggersValues.has(ie.triggerName)){const Ze=Ge.previousTriggersValues.get(ie.triggerName),St=this.statesByElement.get(ie.element);if(St&&St.has(ie.triggerName)){const Kt=St.get(ie.triggerName);Kt.value=Ze,St.set(ie.triggerName,Kt)}}return void Z.destroy()}}const q=!f||!this.driver.containsElement(f,de),se=b.get(de),xe=_.get(de),Se=this._buildInstruction(ie,i,xe,se,q);if(Se.errors&&Se.errors.length)return void I.push(Se);if(q)return Z.onStart(()=>Td(de,Se.fromStyles)),Z.onDestroy(()=>Ka(de,Se.toStyles)),void r.push(Z);if(ie.isFallbackTransition)return Z.onStart(()=>Td(de,Se.fromStyles)),Z.onDestroy(()=>Ka(de,Se.toStyles)),void r.push(Z);const ze=[];Se.timelines.forEach(Ge=>{Ge.stretchStartingKeyframe=!0,this.disabledNodes.has(Ge.element)||ze.push(Ge)}),Se.timelines=ze,i.append(de,Se.timelines),o.push({instruction:Se,player:Z,element:de}),Se.queriedElements.forEach(Ge=>lo(a,Ge,[]).push(Z)),Se.preStyleProps.forEach((Ge,Ze)=>{if(Ge.size){let St=l.get(Ze);St||l.set(Ze,St=new Set),Ge.forEach((Kt,lt)=>St.add(lt))}}),Se.postStyleProps.forEach((Ge,Ze)=>{let St=c.get(Ze);St||c.set(Ze,St=new Set),Ge.forEach((Kt,lt)=>St.add(lt))})});if(I.length){const $=[];I.forEach(Y=>{$.push(function j6(n,e){return new re(3505,!1)}())}),T.forEach(Y=>Y.destroy()),this.reportError($)}const A=new Map,F=new Map;o.forEach($=>{const Y=$.element;i.has(Y)&&(F.set(Y,Y),this._beforeAnimationBuild($.player.namespaceId,$.instruction,A))}),r.forEach($=>{const Y=$.element;this._getPreviousPlayers(Y,!1,$.namespaceId,$.triggerName,null).forEach(Z=>{lo(A,Y,[]).push(Z),Z.destroy()})});const C=v.filter($=>r2($,l,c)),N=new Map;t2(N,this.driver,S,c,Bl).forEach($=>{r2($,l,c)&&C.push($)});const oe=new Map;m.forEach(($,Y)=>{t2(oe,this.driver,new Set($),l,"!")}),C.forEach($=>{const Y=N.get($),ie=oe.get($);N.set($,new Map([...Y?.entries()??[],...ie?.entries()??[]]))});const ue=[],W=[],J={};o.forEach($=>{const{element:Y,player:ie,instruction:Z}=$;if(i.has(Y)){if(d.has(Y))return ie.onDestroy(()=>Ka(Y,Z.toStyles)),ie.disabled=!0,ie.overrideTotalTime(Z.totalTime),void r.push(ie);let de=J;if(F.size>1){let se=Y;const xe=[];for(;se=se.parentNode;){const Se=F.get(se);if(Se){de=Se;break}xe.push(se)}xe.forEach(Se=>F.set(Se,de))}const q=this._buildAnimation(ie.namespaceId,Z,A,s,oe,N);if(ie.setRealPlayer(q),de===J)ue.push(ie);else{const se=this.playersByElement.get(de);se&&se.length&&(ie.parentPlayer=eu(se)),r.push(ie)}}else Td(Y,Z.fromStyles),ie.onDestroy(()=>Ka(Y,Z.toStyles)),W.push(ie),d.has(Y)&&r.push(ie)}),W.forEach($=>{const Y=s.get($.element);if(Y&&Y.length){const ie=eu(Y);$.setRealPlayer(ie)}}),r.forEach($=>{$.parentPlayer?$.syncPlayerEvents($.parentPlayer):$.destroy()});for(let $=0;$<v.length;$++){const Y=v[$],ie=Y[da];if(pp(Y,Eb),ie&&ie.hasAnimation)continue;let Z=[];if(a.size){let q=a.get(Y);q&&q.length&&Z.push(...q);let se=this.driver.query(Y,aA,!0);for(let xe=0;xe<se.length;xe++){let Se=a.get(se[xe]);Se&&Se.length&&Z.push(...Se)}}const de=Z.filter(q=>!q.destroyed);de.length?$9(this,Y,de):this.processLeaveNode(Y)}return v.length=0,ue.forEach($=>{this.players.push($),$.onDone(()=>{$.destroy();const Y=this.players.indexOf($);this.players.splice(Y,1)}),$.play()}),ue}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,i,r,s){let o=[];if(t){const a=this.playersByQueriedElement.get(e);a&&(o=a)}else{const a=this.playersByElement.get(e);if(a){const l=!s||s==ey;a.forEach(c=>{c.queued||!l&&c.triggerName!=r||o.push(c)})}}return(i||r)&&(o=o.filter(a=>!(i&&i!=a.namespaceId||r&&r!=a.triggerName))),o}_beforeAnimationBuild(e,t,i){const s=t.element,o=t.isRemovalTransition?void 0:e,a=t.isRemovalTransition?void 0:t.triggerName;for(const l of t.timelines){const c=l.element,d=c!==s,f=lo(i,c,[]);this._getPreviousPlayers(c,d,o,a,t.toState).forEach(m=>{const _=m.getRealPlayer();_.beforeDestroy&&_.beforeDestroy(),m.destroy(),f.push(m)})}Td(s,t.fromStyles)}_buildAnimation(e,t,i,r,s,o){const a=t.triggerName,l=t.element,c=[],d=new Set,f=new Set,p=t.timelines.map(_=>{const E=_.element;d.add(E);const v=E[da];if(v&&v.removedBeforeQueried)return new K_(_.duration,_.delay);const y=E!==l,S=function j9(n){const e=[];return i2(n,e),e}((i.get(E)||U9).map(A=>A.getRealPlayer())).filter(A=>!!A.element&&A.element===E),b=s.get(E),M=o.get(E),T=NF(this._normalizer,_.keyframes,b,M),I=this._buildPlayer(_,T,S);if(_.subTimeline&&r&&f.add(E),y){const A=new bA(e,a,E);A.setRealPlayer(I),c.push(A)}return I});c.forEach(_=>{lo(this.playersByQueriedElement,_.element,[]).push(_),_.onDone(()=>function z9(n,e,t){let i=n.get(e);if(i){if(i.length){const r=i.indexOf(t);i.splice(r,1)}0==i.length&&n.delete(e)}return i}(this.playersByQueriedElement,_.element,_))}),d.forEach(_=>ko(_,VF));const m=eu(p);return m.onDestroy(()=>{d.forEach(_=>pp(_,VF)),Ka(l,t.toStyles)}),f.forEach(_=>{lo(r,_,[]).push(m)}),m}_buildPlayer(e,t,i){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,i):new K_(e.duration,e.delay)}}class bA{constructor(e,t,i){this.namespaceId=e,this.triggerName=t,this.element=i,this._player=new K_,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,i)=>{t.forEach(r=>tA(e,i,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){lo(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function Rb(n){return n&&1===n.nodeType}function e2(n,e){const t=n.style.display;return n.style.display=e??"none",t}function t2(n,e,t,i,r){const s=[];t.forEach(l=>s.push(e2(l)));const o=[];i.forEach((l,c)=>{const d=new Map;l.forEach(f=>{const p=e.computeStyle(c,f,r);d.set(f,p),(!p||0==p.length)&&(c[da]=B9,o.push(c))}),n.set(c,d)});let a=0;return t.forEach(l=>e2(l,s[a++])),o}function n2(n,e){const t=new Map;if(n.forEach(a=>t.set(a,[])),0==e.length)return t;const r=new Set(e),s=new Map;function o(a){if(!a)return 1;let l=s.get(a);if(l)return l;const c=a.parentNode;return l=t.has(c)?c:r.has(c)?1:o(c),s.set(a,l),l}return e.forEach(a=>{const l=o(a);1!==l&&t.get(l).push(a)}),t}function ko(n,e){n.classList?.add(e)}function pp(n,e){n.classList?.remove(e)}function $9(n,e,t){eu(t).onDone(()=>n.processLeaveNode(e))}function i2(n,e){for(let t=0;t<n.length;t++){const i=n[t];i instanceof RF?i2(i.players,e):e.push(i)}}function r2(n,e,t){const i=t.get(n);if(!i)return!1;let r=e.get(n);return r?i.forEach(s=>r.add(s)):e.set(n,i),t.delete(n),!0}class Pb{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(r,s)=>{},this._transitionEngine=new H9(e,t,i),this._timelineEngine=new N9(e,t,i),this._transitionEngine.onRemovalComplete=(r,s)=>this.onRemovalComplete(r,s)}registerTrigger(e,t,i,r,s){const o=e+"-"+r;let a=this._triggerCache[o];if(!a){const l=[],d=dA(this._driver,s,l,[]);if(l.length)throw function O6(n,e){return new re(3404,!1)}();a=function D9(n,e,t){return new I9(n,e,t)}(r,d,this._normalizer),this._triggerCache[o]=a}this._transitionEngine.registerTrigger(t,r,a)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,i,r){this._transitionEngine.insertNode(e,t,i,r)}onRemove(e,t,i){this._transitionEngine.removeNode(e,t,i)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,i,r){if("@"==i.charAt(0)){const[s,o]=LF(i);this._timelineEngine.command(s,t,o,r)}else this._transitionEngine.trigger(e,t,i,r)}listen(e,t,i,r,s){if("@"==i.charAt(0)){const[o,a]=LF(i);return this._timelineEngine.listen(o,t,a,s)}return this._transitionEngine.listen(e,t,i,r,s)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(e){this._transitionEngine.afterFlushAnimationsDone(e)}}let Y9=(()=>{class n{static#e=this.initialStylesByElement=new WeakMap;constructor(t,i,r){this._element=t,this._startStyles=i,this._endStyles=r,this._state=0;let s=n.initialStylesByElement.get(t);s||n.initialStylesByElement.set(t,s=new Map),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&Ka(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Ka(this._element,this._initialStyles),this._endStyles&&(Ka(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(Td(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Td(this._element,this._endStyles),this._endStyles=null),Ka(this._element,this._initialStyles),this._state=3)}}return n})();function SA(n){let e=null;return n.forEach((t,i)=>{(function K9(n){return"display"===n||"position"===n})(i)&&(e=e||new Map,e.set(i,t))}),e}class s2{constructor(e,t,i,r){this.element=e,this.keyframes=t,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){const t=[];return e.forEach(i=>{t.push(Object.fromEntries(i))}),t}_triggerWebAnimation(e,t,i){return e.animate(this._convertKeyframesToObject(t),i)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((i,r)=>{"offset"!==r&&e.set(r,this._finished?i:WF(this.element,r))}),this.currentSnapshot=e}triggerCallback(e){const t="start"===e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class Z9{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}matchesElement(e,t){return!1}containsElement(e,t){return FF(e,t)}getParentElement(e){return rA(e)}query(e,t,i){return kF(e,t,i)}computeStyle(e,t,i){return window.getComputedStyle(e)[t]}animate(e,t,i,r,s,o=[]){const l={duration:i,delay:r,fill:0==r?"both":"forwards"};s&&(l.easing=s);const c=new Map,d=o.filter(m=>m instanceof s2);(function r9(n,e){return 0===n||0===e})(i,r)&&d.forEach(m=>{m.currentSnapshot.forEach((_,E)=>c.set(E,_))});let f=function t9(n){return n.length?n[0]instanceof Map?n:n.map(e=>HF(e)):[]}(t).map(m=>tu(m));f=function s9(n,e,t){if(t.size&&e.length){let i=e[0],r=[];if(t.forEach((s,o)=>{i.has(o)||r.push(o),i.set(o,s)}),r.length)for(let s=1;s<e.length;s++){let o=e[s];r.forEach(a=>o.set(a,WF(n,a)))}}return e}(e,f,c);const p=function X9(n,e){let t=null,i=null;return Array.isArray(e)&&e.length?(t=SA(e[0]),e.length>1&&(i=SA(e[e.length-1]))):e instanceof Map&&(t=SA(e)),t||i?new Y9(n,t,i):null}(e,f);return new s2(e,f,l,p)}}let J9=(()=>{class n extends AF{constructor(t,i){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(i.body,{id:"0",encapsulation:Cs.None,styles:[],data:{animation:[]}})}build(t){const i=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(t)?DF(t):t;return o2(this._renderer,null,i,"register",[r]),new Q9(i,this._renderer)}static#e=this.\u0275fac=function(i){return new(i||n)(Ne(zn),Ne(qr))};static#t=this.\u0275prov=tt({token:n,factory:n.\u0275fac})}return n})();class Q9 extends f6{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new e7(this._id,e,t||{},this._renderer)}}class e7{constructor(e,t,i,r){this.id=e,this.element=t,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return o2(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function o2(n,e,t,i,r){return n.setProperty(e,`@@${t}:${i}`,r)}const a2="@.disabled";let t7=(()=>{class n{constructor(t,i,r){this.delegate=t,this.engine=i,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,i.onRemovalComplete=(s,o)=>{const a=o?.parentNode(s);a&&o.removeChild(a,s)}}createRenderer(t,i){const s=this.delegate.createRenderer(t,i);if(!(t&&i&&i.data&&i.data.animation)){let d=this._rendererCache.get(s);return d||(d=new l2("",s,this.engine,()=>this._rendererCache.delete(s)),this._rendererCache.set(s,d)),d}const o=i.id,a=i.id+"-"+this._currentId;this._currentId++,this.engine.register(a,t);const l=d=>{Array.isArray(d)?d.forEach(l):this.engine.registerTrigger(o,a,t,d.name,d)};return i.data.animation.forEach(l),new n7(this,a,s,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(t,i,r){t>=0&&t<this._microtaskId?this._zone.run(()=>i(r)):(0==this._animationCallbacksBuffer.length&&queueMicrotask(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(s=>{const[o,a]=s;o(a)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}static#e=this.\u0275fac=function(i){return new(i||n)(Ne(zn),Ne(Pb),Ne(In))};static#t=this.\u0275prov=tt({token:n,factory:n.\u0275fac})}return n})();class l2{constructor(e,t,i,r){this.namespaceId=e,this.delegate=t,this.engine=i,this._onDestroy=r}get data(){return this.delegate.data}destroyNode(e){this.delegate.destroyNode?.(e)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,i,r=!0){this.delegate.insertBefore(e,t,i),this.engine.onInsert(this.namespaceId,t,e,r)}removeChild(e,t,i){this.engine.onRemove(this.namespaceId,t,this.delegate)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,i,r){this.delegate.setAttribute(e,t,i,r)}removeAttribute(e,t,i){this.delegate.removeAttribute(e,t,i)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,i,r){this.delegate.setStyle(e,t,i,r)}removeStyle(e,t,i){this.delegate.removeStyle(e,t,i)}setProperty(e,t,i){"@"==t.charAt(0)&&t==a2?this.disableAnimations(e,!!i):this.delegate.setProperty(e,t,i)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,i){return this.delegate.listen(e,t,i)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class n7 extends l2{constructor(e,t,i,r,s){super(t,i,r,s),this.factory=e,this.namespaceId=t}setProperty(e,t,i){"@"==t.charAt(0)?"."==t.charAt(1)&&t==a2?this.disableAnimations(e,i=void 0===i||!!i):this.engine.process(this.namespaceId,e,t.slice(1),i):this.delegate.setProperty(e,t,i)}listen(e,t,i){if("@"==t.charAt(0)){const r=function i7(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(e);let s=t.slice(1),o="";return"@"!=s.charAt(0)&&([s,o]=function r7(n){const e=n.indexOf(".");return[n.substring(0,e),n.slice(e+1)]}(s)),this.engine.listen(this.namespaceId,r,s,o,a=>{this.factory.scheduleListenerCallback(a._data||-1,i,a)})}return this.delegate.listen(e,t,i)}}let s7=(()=>{class n extends Pb{constructor(t,i,r,s){super(t.body,i,r)}ngOnDestroy(){this.flush()}static#e=this.\u0275fac=function(i){return new(i||n)(Ne(qr),Ne(sA),Ne(gA),Ne(Sd))};static#t=this.\u0275prov=tt({token:n,factory:n.\u0275fac})}return n})();const c2=[{provide:AF,useClass:J9},{provide:gA,useFactory:function o7(){return new x9}},{provide:Pb,useClass:s7},{provide:zn,useFactory:function a7(n,e,t){return new t7(n,e,t)},deps:[KC,Pb,In]}],wA=[{provide:sA,useFactory:()=>new Z9},{provide:ME,useValue:"BrowserAnimations"},...c2],u2=[{provide:sA,useClass:UF},{provide:ME,useValue:"NoopAnimations"},...c2];let l7=(()=>{class n{static withConfig(t){return{ngModule:n,providers:t.disableAnimations?u2:wA}}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=tr({type:n});static#n=this.\u0275inj=Vi({providers:wA,imports:[wF]})}return n})();const{isArray:c7}=Array,{getPrototypeOf:u7,prototype:d7,keys:h7}=Object;function d2(n){if(1===n.length){const e=n[0];if(c7(e))return{args:e,keys:null};if(function f7(n){return n&&"object"==typeof n&&u7(n)===d7}(e)){const t=h7(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}const{isArray:p7}=Array;function h2(n){return Rt(e=>function m7(n,e){return p7(e)?n(...e):n(e)}(n,e))}function f2(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}let p2=(()=>{class n{constructor(t,i){this._renderer=t,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static#e=this.\u0275fac=function(i){return new(i||n)(ye(vi),ye(Tn))};static#t=this.\u0275dir=_t({type:n})}return n})(),Ad=(()=>{class n extends p2{static#e=this.\u0275fac=function(){let t;return function(r){return(t||(t=_i(n)))(r||n)}}();static#t=this.\u0275dir=_t({type:n,features:[bn]})}return n})();const ha=new Ye("NgValueAccessor"),y7={provide:ha,useExisting:vn(()=>Lb),multi:!0},E7=new Ye("CompositionEventMode");let Lb=(()=>{class n extends p2{constructor(t,i,r){super(t,i),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function v7(){const n=Jc()?Jc().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(t){this.setProperty("value",t??"")}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static#e=this.\u0275fac=function(i){return new(i||n)(ye(vi),ye(Tn),ye(E7,8))};static#t=this.\u0275dir=_t({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,r){1&i&&or("input",function(o){return r._handleInput(o.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(o){return r._compositionEnd(o.target.value)})},features:[ii([y7]),bn]})}return n})();const Xr=new Ye("NgValidators"),iu=new Ye("NgAsyncValidators");function x2(n){return null!=n}function T2(n){return D_(n)?gi(n):n}function C2(n){let e={};return n.forEach(t=>{e=null!=t?{...e,...t}:e}),0===Object.keys(e).length?null:e}function A2(n,e){return e.map(t=>t(n))}function D2(n){return n.map(e=>function S7(n){return!n.validate}(e)?e:t=>e.validate(t))}function MA(n){return null!=n?function I2(n){if(!n)return null;const e=n.filter(x2);return 0==e.length?null:function(t){return C2(A2(t,e))}}(D2(n)):null}function xA(n){return null!=n?function R2(n){if(!n)return null;const e=n.filter(x2);return 0==e.length?null:function(t){return function g7(...n){const e=Cu(n),{args:t,keys:i}=d2(n),r=new qe(s=>{const{length:o}=t;if(!o)return void s.complete();const a=new Array(o);let l=o,c=o;for(let d=0;d<o;d++){let f=!1;ns(t[d]).subscribe(mn(s,p=>{f||(f=!0,c--),a[d]=p},()=>l--,void 0,()=>{(!l||!f)&&(c||s.next(i?f2(i,a):a),s.complete())}))}});return e?r.pipe(h2(e)):r}(A2(t,e).map(T2)).pipe(Rt(C2))}}(D2(n)):null}function P2(n,e){return null===n?[e]:Array.isArray(n)?[...n,e]:[n,e]}function TA(n){return n?Array.isArray(n)?n:[n]:[]}function Fb(n,e){return Array.isArray(n)?n.includes(e):n===e}function O2(n,e){const t=TA(e);return TA(n).forEach(r=>{Fb(t,r)||t.push(r)}),t}function F2(n,e){return TA(e).filter(t=>!Fb(n,t))}class k2{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=MA(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=xA(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class _s extends k2{get formDirective(){return null}get path(){return null}}class ru extends k2{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class U2{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let B2=(()=>{class n extends U2{constructor(t){super(t)}static#e=this.\u0275fac=function(i){return new(i||n)(ye(ru,2))};static#t=this.\u0275dir=_t({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,r){2&i&&I_("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[bn]})}return n})();const ty="VALID",Ub="INVALID",mp="PENDING",ny="DISABLED";function Bb(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}class G2{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===ty}get invalid(){return this.status===Ub}get pending(){return this.status==mp}get disabled(){return this.status===ny}get enabled(){return this.status!==ny}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(O2(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(O2(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(F2(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(F2(e,this._rawAsyncValidators))}hasValidator(e){return Fb(this._rawValidators,e)}hasAsyncValidator(e){return Fb(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=mp,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=ny,this.errors=null,this._forEachChild(i=>{i.disable({...e,onlySelf:!0})}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=ty,this._forEachChild(i=>{i.enable({...e,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===ty||this.status===mp)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?ny:ty}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=mp,this._hasOwnPendingAsyncValidator=!0;const t=T2(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){let t=e;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((i,r)=>i&&i._find(r),this)}getError(e,t){const i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new Xn,this.statusChanges=new Xn}_calculateStatus(){return this._allControlsDisabled()?ny:this.errors?Ub:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(mp)?mp:this._anyControlsHaveStatus(Ub)?Ub:ty}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Bb(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=function C7(n){return Array.isArray(n)?MA(n):n||null}(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=function A7(n){return Array.isArray(n)?xA(n):n||null}(this._rawAsyncValidators)}}const gp=new Ye("CallSetDisabledState",{providedIn:"root",factory:()=>Vb}),Vb="always";function iy(n,e,t=Vb){(function PA(n,e){const t=function N2(n){return n._rawValidators}(n);null!==e.validator?n.setValidators(P2(t,e.validator)):"function"==typeof t&&n.setValidators([t]);const i=function L2(n){return n._rawAsyncValidators}(n);null!==e.asyncValidator?n.setAsyncValidators(P2(i,e.asyncValidator)):"function"==typeof i&&n.setAsyncValidators([i]);const r=()=>n.updateValueAndValidity();Gb(e._rawValidators,r),Gb(e._rawAsyncValidators,r)})(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||"always"===t)&&e.valueAccessor.setDisabledState?.(n.disabled),function R7(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&W2(n,e)})}(n,e),function N7(n,e){const t=(i,r)=>{e.valueAccessor.writeValue(i),r&&e.viewToModelUpdate(i)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}(n,e),function P7(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&W2(n,e),"submit"!==n.updateOn&&n.markAsTouched()})}(n,e),function I7(n,e){if(e.valueAccessor.setDisabledState){const t=i=>{e.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}(n,e)}function Gb(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function W2(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function q2(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}function X2(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}const Y2=class extends G2{constructor(e=null,t,i){super(function DA(n){return(Bb(n)?n.validators:n)||null}(t),function IA(n,e){return(Bb(e)?e.asyncValidators:n)||null}(i,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Bb(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=X2(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){q2(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){q2(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){X2(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}},H7={provide:ru,useExisting:vn(()=>kA)},J2=(()=>Promise.resolve())();let kA=(()=>{class n extends ru{constructor(t,i,r,s,o,a){super(),this._changeDetectorRef=o,this.callSetDisabledState=a,this.control=new Y2,this._registered=!1,this.name="",this.update=new Xn,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=function OA(n,e){if(!e)return null;let t,i,r;return Array.isArray(e),e.forEach(s=>{s.constructor===Lb?t=s:function F7(n){return Object.getPrototypeOf(n.constructor)===Ad}(s)?i=s:r=s}),r||i||t||null}(0,s)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){const i=t.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),function LA(n,e){if(!n.hasOwnProperty("model"))return!1;const t=n.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){iy(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){J2.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){const i=t.isDisabled.currentValue,r=0!==i&&function hp(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}(i);J2.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?function Hb(n,e){return[...e.path,n]}(t,this._parent):[t]}static#e=this.\u0275fac=function(i){return new(i||n)(ye(_s,9),ye(Xr,10),ye(iu,10),ye(ha,10),ye(G_,8),ye(gp,8))};static#t=this.\u0275dir=_t({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[ii([H7]),bn,Is]})}return n})(),ek=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=tr({type:n});static#n=this.\u0275inj=Vi({})}return n})(),hq=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=tr({type:n});static#n=this.\u0275inj=Vi({imports:[ek]})}return n})(),pq=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:gp,useValue:t.callSetDisabledState??Vb}]}}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=tr({type:n});static#n=this.\u0275inj=Vi({imports:[hq]})}return n})();function WA(...n){const e=Au(n),t=Cu(n),{args:i,keys:r}=d2(n);if(0===i.length)return gi([],e);const s=new qe(function gq(n,e,t=Qe){return i=>{yk(e,()=>{const{length:r}=n,s=new Array(r);let o=r,a=r;for(let l=0;l<r;l++)yk(e,()=>{const c=gi(n[l],e);let d=!1;c.subscribe(mn(i,f=>{s[l]=f,d||(d=!0,a--),a||i.next(t(s.slice()))},()=>{--o||i.complete()}))},i)},i)}}(i,e,r?o=>f2(r,o):Qe));return t?s.pipe(h2(t)):s}function yk(n,e,t){n?wo(t,n,e):e()}const $b=B(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function $A(...n){return function _q(){return hc(1)}()(gi(n,Au(n)))}function vk(n){return new qe(e=>{ns(n()).subscribe(e)})}function sy(n,e){const t=fn(n)?n:()=>n,i=r=>r.error(t());return new qe(e?r=>e.schedule(i,0,r):i)}function jA(){return gn((n,e)=>{let t=null;n._refCount++;const i=mn(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const r=n._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});n.subscribe(i),i.closed||(t=n.connect())})}class Ek extends qe{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,bo(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new mi;const t=this.getSubject();e.add(this.source.subscribe(mn(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=mi.EMPTY)}return e}refCount(){return jA()(this)}}function _p(n){return n<=0?()=>Mo:gn((e,t)=>{let i=0;e.subscribe(mn(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function Hl(n,e){return gn((t,i)=>{let r=0;t.subscribe(mn(i,s=>n.call(e,s,r++)&&i.next(s)))})}function jb(n){return gn((e,t)=>{let i=!1;e.subscribe(mn(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function bk(n=vq){return gn((e,t)=>{let i=!1;e.subscribe(mn(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function vq(){return new $b}function Id(n,e){const t=arguments.length>=2;return i=>i.pipe(n?Hl((r,s)=>n(r,s,i)):Qe,_p(1),t?jb(e):bk(()=>new $b))}function yp(n,e){return fn(e)?er(n,e,1):er(n,1)}function Yr(n,e,t){const i=fn(n)||e||t?{next:n,error:e,complete:t}:n;return i?gn((r,s)=>{var o;null===(o=i.subscribe)||void 0===o||o.call(i);let a=!0;r.subscribe(mn(s,l=>{var c;null===(c=i.next)||void 0===c||c.call(i,l),s.next(l)},()=>{var l;a=!1,null===(l=i.complete)||void 0===l||l.call(i),s.complete()},l=>{var c;a=!1,null===(c=i.error)||void 0===c||c.call(i,l),s.error(l)},()=>{var l,c;a&&(null===(l=i.unsubscribe)||void 0===l||l.call(i)),null===(c=i.finalize)||void 0===c||c.call(i)}))}):Qe}function Rd(n){return gn((e,t)=>{let s,i=null,r=!1;i=e.subscribe(mn(t,void 0,void 0,o=>{s=ns(n(o,Rd(n)(e))),i?(i.unsubscribe(),i=null,s.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,s.subscribe(t))})}function qA(n){return n<=0?()=>Mo:gn((e,t)=>{let i=[];e.subscribe(mn(t,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(const r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function oy(n){return gn((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}const Gt="primary",ay=Symbol("RouteTitle");class xq{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function vp(n){return new xq(n)}function Tq(n,e,t){const i=t.path.split("/");if(i.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||i.length<n.length))return null;const r={};for(let s=0;s<i.length;s++){const o=i[s],a=n[s];if(o.startsWith(":"))r[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function Za(n,e){const t=n?Object.keys(n):void 0,i=e?Object.keys(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!Sk(n[r],e[r]))return!1;return!0}function Sk(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),i=[...e].sort();return t.every((r,s)=>i[s]===r)}return n===e}function wk(n){return n.length>0?n[n.length-1]:null}function su(n){return function mq(n){return!!n&&(n instanceof qe||fn(n.lift)&&fn(n.subscribe))}(n)?n:D_(n)?gi(Promise.resolve(n)):vt(n)}const Aq={exact:function Tk(n,e,t){if(!Pd(n.segments,e.segments)||!qb(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const i in e.children)if(!n.children[i]||!Tk(n.children[i],e.children[i],t))return!1;return!0},subset:Ck},Mk={exact:function Dq(n,e){return Za(n,e)},subset:function Iq(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>Sk(n[t],e[t]))},ignored:()=>!0};function xk(n,e,t){return Aq[t.paths](n.root,e.root,t.matrixParams)&&Mk[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function Ck(n,e,t){return Ak(n,e,e.segments,t)}function Ak(n,e,t,i){if(n.segments.length>t.length){const r=n.segments.slice(0,t.length);return!(!Pd(r,t)||e.hasChildren()||!qb(r,t,i))}if(n.segments.length===t.length){if(!Pd(n.segments,t)||!qb(n.segments,t,i))return!1;for(const r in e.children)if(!n.children[r]||!Ck(n.children[r],e.children[r],i))return!1;return!0}{const r=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!!(Pd(n.segments,r)&&qb(n.segments,r,i)&&n.children[Gt])&&Ak(n.children[Gt],e,s,i)}}function qb(n,e,t){return e.every((i,r)=>Mk[t](n[r].parameters,i.parameters))}class Ep{constructor(e=new Pn([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=vp(this.queryParams)),this._queryParamMap}toString(){return Nq.serialize(this)}}class Pn{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Xb(this)}}class ly{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=vp(this.parameters)),this._parameterMap}toString(){return Rk(this)}}function Pd(n,e){return n.length===e.length&&n.every((t,i)=>t.path===e[i].path)}let cy=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=tt({token:n,factory:function(){return new XA},providedIn:"root"})}return n})();class XA{parse(e){const t=new Wq(e);return new Ep(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${uy(e.root,!0)}`,i=function Fq(n){const e=Object.keys(n).map(t=>{const i=n[t];return Array.isArray(i)?i.map(r=>`${Yb(t)}=${Yb(r)}`).join("&"):`${Yb(t)}=${Yb(i)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${i}${"string"==typeof e.fragment?`#${function Lq(n){return encodeURI(n)}(e.fragment)}`:""}`}}const Nq=new XA;function Xb(n){return n.segments.map(e=>Rk(e)).join("/")}function uy(n,e){if(!n.hasChildren())return Xb(n);if(e){const t=n.children[Gt]?uy(n.children[Gt],!1):"",i=[];return Object.entries(n.children).forEach(([r,s])=>{r!==Gt&&i.push(`${r}:${uy(s,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}{const t=function Pq(n,e){let t=[];return Object.entries(n.children).forEach(([i,r])=>{i===Gt&&(t=t.concat(e(r,i)))}),Object.entries(n.children).forEach(([i,r])=>{i!==Gt&&(t=t.concat(e(r,i)))}),t}(n,(i,r)=>r===Gt?[uy(n.children[Gt],!1)]:[`${r}:${uy(i,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[Gt]?`${Xb(n)}/${t[0]}`:`${Xb(n)}/(${t.join("//")})`}}function Dk(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Yb(n){return Dk(n).replace(/%3B/gi,";")}function YA(n){return Dk(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Kb(n){return decodeURIComponent(n)}function Ik(n){return Kb(n.replace(/\+/g,"%20"))}function Rk(n){return`${YA(n.path)}${function Oq(n){return Object.keys(n).map(e=>`;${YA(e)}=${YA(n[e])}`).join("")}(n.parameters)}`}const kq=/^[^\/()?;#]+/;function KA(n){const e=n.match(kq);return e?e[0]:""}const Uq=/^[^\/()?;=#]+/,Vq=/^[^=?&#]+/,zq=/^[^&#]+/;class Wq{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Pn([],{}):new Pn([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[Gt]=new Pn(e,t)),i}parseSegment(){const e=KA(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new re(4009,!1);return this.capture(e),new ly(Kb(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=function Bq(n){const e=n.match(Uq);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const r=KA(this.remaining);r&&(i=r,this.capture(i))}e[Kb(t)]=Kb(i)}parseQueryParam(e){const t=function Hq(n){const e=n.match(Vq);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const o=function Gq(n){const e=n.match(zq);return e?e[0]:""}(this.remaining);o&&(i=o,this.capture(i))}const r=Ik(t),s=Ik(i);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=KA(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new re(4010,!1);let s;i.indexOf(":")>-1?(s=i.slice(0,i.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=Gt);const o=this.parseChildren();t[s]=1===Object.keys(o).length?o[Gt]:new Pn([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new re(4011,!1)}}function Pk(n){return n.segments.length>0?new Pn([],{[Gt]:n}):n}function Nk(n){const e={};for(const i of Object.keys(n.children)){const s=Nk(n.children[i]);if(i===Gt&&0===s.segments.length&&s.hasChildren())for(const[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[i]=s)}return function $q(n){if(1===n.numberOfChildren&&n.children[Gt]){const e=n.children[Gt];return new Pn(n.segments.concat(e.segments),e.children)}return n}(new Pn(n.segments,e))}function Nd(n){return n instanceof Ep}function Lk(n){let e;const r=Pk(function t(s){const o={};for(const l of s.children){const c=t(l);o[l.outlet]=c}const a=new Pn(s.url,o);return s===n&&(e=a),a}(n.root));return e??r}function Ok(n,e,t,i){let r=n;for(;r.parent;)r=r.parent;if(0===e.length)return ZA(r,r,r,t,i);const s=function qq(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new kk(!0,0,n);let e=0,t=!1;const i=n.reduce((r,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return Object.entries(s.outlets).forEach(([l,c])=>{a[l]="string"==typeof c?c.split("/"):c}),[...r,{outlets:a}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===o?(s.split("/").forEach((a,l)=>{0==l&&"."===a||(0==l&&""===a?t=!0:".."===a?e++:""!=a&&r.push(a))}),r):[...r,s]},[]);return new kk(t,e,i)}(e);if(s.toRoot())return ZA(r,r,new Pn([],{}),t,i);const o=function Xq(n,e,t){if(n.isAbsolute)return new Jb(e,!0,0);if(!t)return new Jb(e,!1,NaN);if(null===t.parent)return new Jb(t,!0,0);const i=Zb(n.commands[0])?0:1;return function Yq(n,e,t){let i=n,r=e,s=t;for(;s>r;){if(s-=r,i=i.parent,!i)throw new re(4005,!1);r=i.segments.length}return new Jb(i,!1,r-s)}(t,t.segments.length-1+i,n.numberOfDoubleDots)}(s,r,n),a=o.processChildren?hy(o.segmentGroup,o.index,s.commands):Uk(o.segmentGroup,o.index,s.commands);return ZA(r,o.segmentGroup,a,t,i)}function Zb(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function dy(n){return"object"==typeof n&&null!=n&&n.outlets}function ZA(n,e,t,i,r){let o,s={};i&&Object.entries(i).forEach(([l,c])=>{s[l]=Array.isArray(c)?c.map(d=>`${d}`):`${c}`}),o=n===e?t:Fk(n,e,t);const a=Pk(Nk(o));return new Ep(a,s,r)}function Fk(n,e,t){const i={};return Object.entries(n.children).forEach(([r,s])=>{i[r]=s===e?t:Fk(s,e,t)}),new Pn(n.segments,i)}class kk{constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&Zb(i[0]))throw new re(4003,!1);const r=i.find(dy);if(r&&r!==wk(i))throw new re(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Jb{constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}}function Uk(n,e,t){if(n||(n=new Pn([],{})),0===n.segments.length&&n.hasChildren())return hy(n,e,t);const i=function Zq(n,e,t){let i=0,r=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return s;const o=n.segments[r],a=t[i];if(dy(a))break;const l=`${a}`,c=i<t.length-1?t[i+1]:null;if(r>0&&void 0===l)break;if(l&&c&&"object"==typeof c&&void 0===c.outlets){if(!Vk(l,c,o))return s;i+=2}else{if(!Vk(l,{},o))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){const s=new Pn(n.segments.slice(0,i.pathIndex),{});return s.children[Gt]=new Pn(n.segments.slice(i.pathIndex),n.children),hy(s,0,r)}return i.match&&0===r.length?new Pn(n.segments,{}):i.match&&!n.hasChildren()?JA(n,e,t):i.match?hy(n,0,r):JA(n,e,t)}function hy(n,e,t){if(0===t.length)return new Pn(n.segments,{});{const i=function Kq(n){return dy(n[0])?n[0].outlets:{[Gt]:n}}(t),r={};if(Object.keys(i).some(s=>s!==Gt)&&n.children[Gt]&&1===n.numberOfChildren&&0===n.children[Gt].segments.length){const s=hy(n.children[Gt],e,t);return new Pn(n.segments,s.children)}return Object.entries(i).forEach(([s,o])=>{"string"==typeof o&&(o=[o]),null!==o&&(r[s]=Uk(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{void 0===i[s]&&(r[s]=o)}),new Pn(n.segments,r)}}function JA(n,e,t){const i=n.segments.slice(0,e);let r=0;for(;r<t.length;){const s=t[r];if(dy(s)){const l=Jq(s.outlets);return new Pn(i,l)}if(0===r&&Zb(t[0])){i.push(new ly(n.segments[e].path,Bk(t[0]))),r++;continue}const o=dy(s)?s.outlets[Gt]:`${s}`,a=r<t.length-1?t[r+1]:null;o&&a&&Zb(a)?(i.push(new ly(o,Bk(a))),r+=2):(i.push(new ly(o,{})),r++)}return new Pn(i,{})}function Jq(n){const e={};return Object.entries(n).forEach(([t,i])=>{"string"==typeof i&&(i=[i]),null!==i&&(e[t]=JA(new Pn([],{}),0,i))}),e}function Bk(n){const e={};return Object.entries(n).forEach(([t,i])=>e[t]=`${i}`),e}function Vk(n,e,t){return n==t.path&&Za(e,t.parameters)}const fy="imperative";class Ja{constructor(e,t){this.id=e,this.url=t}}class Qb extends Ja{constructor(e,t,i="imperative",r=null){super(e,t),this.type=0,this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class ou extends Ja{constructor(e,t,i){super(e,t),this.urlAfterRedirects=i,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class py extends Ja{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class bp extends Ja{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=16}}class eS extends Ja{constructor(e,t,i,r){super(e,t),this.error=i,this.target=r,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Hk extends Ja{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Qq extends Ja{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class eX extends Ja{constructor(e,t,i,r,s){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class tX extends Ja{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class nX extends Ja{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class iX{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class rX{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class sX{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class oX{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class aX{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class lX{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class zk{constructor(e,t,i){this.routerEvent=e,this.position=t,this.anchor=i,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class QA{}class eD{constructor(e){this.url=e}}class cX{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new my,this.attachRef=null}}let my=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(t,i){const r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){const i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new cX,this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=tt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class Gk{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=tD(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){const t=tD(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=nD(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return nD(e,this._root).map(t=>t.value)}}function tD(n,e){if(n===e.value)return e;for(const t of e.children){const i=tD(n,t);if(i)return i}return null}function nD(n,e){if(n===e.value)return[e];for(const t of e.children){const i=nD(n,t);if(i.length)return i.unshift(e),i}return[]}class zl{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function Sp(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class Wk extends Gk{constructor(e,t){super(e),this.snapshot=t,iD(this,e)}toString(){return this.snapshot.toString()}}function $k(n,e){const t=function uX(n,e){const o=new tS([],{},{},"",{},Gt,e,null,{});return new qk("",new zl(o,[]))}(0,e),i=new Vr([new ly("",{})]),r=new Vr({}),s=new Vr({}),o=new Vr({}),a=new Vr(""),l=new wp(i,r,o,a,s,Gt,e,t.root);return l.snapshot=t.root,new Wk(new zl(l,[]),t)}class wp{constructor(e,t,i,r,s,o,a,l){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(Rt(c=>c[ay]))??vt(void 0),this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(Rt(e=>vp(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Rt(e=>vp(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function jk(n,e="emptyOnly"){const t=n.pathFromRoot;let i=0;if("always"!==e)for(i=t.length-1;i>=1;){const r=t[i],s=t[i-1];if(r.routeConfig&&""===r.routeConfig.path)i--;else{if(s.component)break;i--}}return function dX(n){return n.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(i))}class tS{get title(){return this.data?.[ay]}constructor(e,t,i,r,s,o,a,l,c){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.routeConfig=l,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=vp(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=vp(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class qk extends Gk{constructor(e,t){super(t),this.url=e,iD(this,t)}toString(){return Xk(this._root)}}function iD(n,e){e.value._routerState=n,e.children.forEach(t=>iD(n,t))}function Xk(n){const e=n.children.length>0?` { ${n.children.map(Xk).join(", ")} } `:"";return`${n.value}${e}`}function rD(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Za(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),Za(e.params,t.params)||n.paramsSubject.next(t.params),function Cq(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Za(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.urlSubject.next(t.url),Za(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function sD(n,e){const t=Za(n.params,e.params)&&function Rq(n,e){return Pd(n,e)&&n.every((t,i)=>Za(t.parameters,e[i].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||sD(n.parent,e.parent))}let oD=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=Gt,this.activateEvents=new Xn,this.deactivateEvents=new Xn,this.attachEvents=new Xn,this.detachEvents=new Xn,this.parentContexts=Ve(my),this.location=Ve(la),this.changeDetector=Ve(G_),this.environmentInjector=Ve(hs),this.inputBinder=Ve(nS,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){const{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new re(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new re(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new re(4012,!1);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new re(4013,!1);this._activatedRoute=t;const r=this.location,o=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,l=new hX(t,a,r.injector);this.activated=r.createComponent(o,{index:r.length,injector:l,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275dir=_t({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Is]})}return n})();class hX{constructor(e,t,i){this.route=e,this.childContexts=t,this.parent=i}get(e,t){return e===wp?this.route:e===my?this.childContexts:this.parent.get(e,t)}}const nS=new Ye("");let Yk=(()=>{class n{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){const{activatedRoute:i}=t,r=WA([i.queryParams,i.params,i.data]).pipe(Ms(([s,o,a],l)=>(a={...s,...o,...a},0===l?vt(a):Promise.resolve(a)))).subscribe(s=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==i||null===i.component)return void this.unsubscribeFromRouteData(t);const o=function G$(n){const e=Jt(n);if(!e)return null;const t=new M_(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}(i.component);if(o)for(const{templateName:a}of o.inputs)t.activatedComponentRef.setInput(a,s[a]);else this.unsubscribeFromRouteData(t)});this.outletDataSubscriptions.set(t,r)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=tt({token:n,factory:n.\u0275fac})}return n})();function gy(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const i=t.value;i._futureSnapshot=e.value;const r=function pX(n,e,t){return e.children.map(i=>{for(const r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return gy(n,i,r);return gy(n,i)})}(n,e,t);return new zl(i,r)}{if(n.shouldAttach(e.value)){const s=n.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>gy(n,a)),o}}const i=function mX(n){return new wp(new Vr(n.url),new Vr(n.params),new Vr(n.queryParams),new Vr(n.fragment),new Vr(n.data),n.outlet,n.component,n)}(e.value),r=e.children.map(s=>gy(n,s));return new zl(i,r)}}const aD="ngNavigationCancelingError";function Kk(n,e){const{redirectTo:t,navigationBehaviorOptions:i}=Nd(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=Zk(!1,0,e);return r.url=t,r.navigationBehaviorOptions=i,r}function Zk(n,e,t){const i=new Error("NavigationCancelingError: "+(n||""));return i[aD]=!0,i.cancellationCode=e,t&&(i.url=t),i}function Jk(n){return n&&n[aD]}let Qk=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=ss({type:n,selectors:[["ng-component"]],standalone:!0,features:[U_],decls:1,vars:0,template:function(i,r){1&i&&oo(0,"router-outlet")},dependencies:[oD],encapsulation:2})}return n})();function lD(n){const e=n.children&&n.children.map(lD),t=e?{...n,children:e}:{...n};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Gt&&(t.component=Qk),t}function fa(n){return n.outlet||Gt}function _y(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class wX{constructor(e,t,i,r,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=s}activate(e){const t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),rD(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){const r=Sp(t);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,r[o],i),delete r[o]}),Object.values(r).forEach(s=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(r===s)if(r.component){const o=i.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,i);else s&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=Sp(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);if(i&&i.outlet){const o=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=Sp(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(e,t,i){const r=Sp(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new lX(s.value.snapshot))}),e.children.length&&this.forwardEvent(new oX(e.value.snapshot))}activateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(rD(r),r===s)if(r.component){const o=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,i);else if(r.component){const o=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),rD(a.route.value),this.activateChildRoutes(e,null,o.children)}else{const a=_y(r.snapshot);o.attachRef=null,o.route=r,o.injector=a,o.outlet&&o.outlet.activateWith(r,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,i)}}class eU{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class iS{constructor(e,t){this.component=e,this.route=t}}function MX(n,e,t){const i=n._root;return yy(i,e?e._root:null,t,[i.value])}function Mp(n,e){const t=Symbol(),i=e.get(n,t);return i===t?"function"!=typeof n||function Dv(n){return null!==wa(n)}(n)?e.get(n):n:i}function yy(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=Sp(e);return n.children.forEach(o=>{(function TX(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const l=function CX(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!Pd(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Pd(n.url,e.url)||!Za(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!sD(n,e)||!Za(n.queryParams,e.queryParams);default:return!sD(n,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new eU(i)):(s.data=o.data,s._resolvedData=o._resolvedData),yy(n,e,s.component?a?a.children:null:t,i,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new iS(a.outlet.component,o))}else o&&vy(e,a,r),r.canActivateChecks.push(new eU(i)),yy(n,null,s.component?a?a.children:null:t,i,r)})(o,s[o.value.outlet],t,i.concat([o.value]),r),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>vy(a,t.getContext(o),r)),r}function vy(n,e,t){const i=Sp(n),r=n.value;Object.entries(i).forEach(([s,o])=>{vy(o,r.component?e?e.children.getContext(s):null:e,t)}),t.canDeactivateChecks.push(new iS(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}function Ey(n){return"function"==typeof n}function tU(n){return n instanceof $b||"EmptyError"===n?.name}const rS=Symbol("INITIAL_VALUE");function xp(){return Ms(n=>WA(n.map(e=>e.pipe(_p(1),function yq(...n){const e=Au(n);return gn((t,i)=>{(e?$A(n,t,e):$A(n,t)).subscribe(i)})}(rS)))).pipe(Rt(e=>{for(const t of e)if(!0!==t){if(t===rS)return rS;if(!1===t||t instanceof Ep)return t}return!0}),Hl(e=>e!==rS),_p(1)))}function nU(n){return function Xe(...n){return It(n)}(Yr(e=>{if(Nd(e))throw Kk(0,e)}),Rt(e=>!0===e))}class sS{constructor(e){this.segmentGroup=e||null}}class iU{constructor(e){this.urlTree=e}}function Tp(n){return sy(new sS(n))}function rU(n){return sy(new iU(n))}class qX{constructor(e,t){this.urlSerializer=e,this.urlTree=t}noMatchError(e){return new re(4002,!1)}lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return vt(i);if(r.numberOfChildren>1||!r.children[Gt])return sy(new re(4e3,!1));r=r.children[Gt]}}applyRedirectCommands(e,t,i){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,i)}applyRedirectCreateUrlTree(e,t,i,r){const s=this.createSegmentGroup(e,t.root,i,r);return new Ep(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const i={};return Object.entries(e).forEach(([r,s])=>{if("string"==typeof s&&s.startsWith(":")){const a=s.substring(1);i[r]=t[a]}else i[r]=s}),i}createSegmentGroup(e,t,i,r){const s=this.createSegments(e,t.segments,i,r);let o={};return Object.entries(t.children).forEach(([a,l])=>{o[a]=this.createSegmentGroup(e,l,i,r)}),new Pn(s,o)}createSegments(e,t,i,r){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,r):this.findOrReturn(s,i))}findPosParam(e,t,i){const r=i[t.path.substring(1)];if(!r)throw new re(4001,!1);return r}findOrReturn(e,t){let i=0;for(const r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}}const cD={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function XX(n,e,t,i,r){const s=uD(n,e,t);return s.matched?(i=function _X(n,e){return n.providers&&!n._injector&&(n._injector=$T(n.providers,e,`Route: ${n.path}`)),n._injector??e}(e,i),function WX(n,e,t,i){const r=e.canMatch;return r&&0!==r.length?vt(r.map(o=>{const a=Mp(o,n);return su(function NX(n){return n&&Ey(n.canMatch)}(a)?a.canMatch(e,t):n.runInContext(()=>a(e,t)))})).pipe(xp(),nU()):vt(!0)}(i,e,t).pipe(Rt(o=>!0===o?s:{...cD}))):vt(s)}function uD(n,e,t){if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?{...cD}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const r=(e.matcher||Tq)(t,n,e);if(!r)return{...cD};const s={};Object.entries(r.posParams??{}).forEach(([a,l])=>{s[a]=l.path});const o=r.consumed.length>0?{...s,...r.consumed[r.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:o,positionalParamSegments:r.posParams??{}}}function sU(n,e,t,i){return t.length>0&&function ZX(n,e,t){return t.some(i=>oS(n,e,i)&&fa(i)!==Gt)}(n,t,i)?{segmentGroup:new Pn(e,KX(i,new Pn(t,n.children))),slicedSegments:[]}:0===t.length&&function JX(n,e,t){return t.some(i=>oS(n,e,i))}(n,t,i)?{segmentGroup:new Pn(n.segments,YX(n,0,t,i,n.children)),slicedSegments:t}:{segmentGroup:new Pn(n.segments,n.children),slicedSegments:t}}function YX(n,e,t,i,r){const s={};for(const o of i)if(oS(n,t,o)&&!r[fa(o)]){const a=new Pn([],{});s[fa(o)]=a}return{...r,...s}}function KX(n,e){const t={};t[Gt]=e;for(const i of n)if(""===i.path&&fa(i)!==Gt){const r=new Pn([],{});t[fa(i)]=r}return t}function oS(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}class nY{constructor(e,t,i,r,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=i,this.config=r,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.allowRedirects=!0,this.applyRedirects=new qX(this.urlSerializer,this.urlTree)}noMatchError(e){return new re(4002,!1)}recognize(){const e=sU(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,Gt).pipe(Rd(t=>{if(t instanceof iU)return this.allowRedirects=!1,this.urlTree=t.urlTree,this.match(t.urlTree);throw t instanceof sS?this.noMatchError(t):t}),Rt(t=>{const i=new tS([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Gt,this.rootComponentType,null,{}),r=new zl(i,t),s=new qk("",r),o=function jq(n,e,t=null,i=null){return Ok(Lk(n),e,t,i)}(i,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e.root,Gt).pipe(Rd(i=>{throw i instanceof sS?this.noMatchError(i):i}))}inheritParamsAndData(e){const t=e.value,i=jk(t,this.paramsInheritanceStrategy);t.params=Object.freeze(i.params),t.data=Object.freeze(i.data),e.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(e,t,i,r){return 0===i.segments.length&&i.hasChildren()?this.processChildren(e,t,i):this.processSegment(e,t,i,i.segments,r,!0)}processChildren(e,t,i){const r=[];for(const s of Object.keys(i.children))"primary"===s?r.unshift(s):r.push(s);return gi(r).pipe(yp(s=>{const o=i.children[s],a=function bX(n,e){const t=n.filter(i=>fa(i)===e);return t.push(...n.filter(i=>fa(i)!==e)),t}(t,s);return this.processSegmentGroup(e,a,o,s)}),function bq(n,e){return gn(function Eq(n,e,t,i,r){return(s,o)=>{let a=t,l=e,c=0;s.subscribe(mn(o,d=>{const f=c++;l=a?n(l,d,f):(a=!0,d),i&&o.next(l)},r&&(()=>{a&&o.next(l),o.complete()})))}}(n,e,arguments.length>=2,!0))}((s,o)=>(s.push(...o),s)),jb(null),function Sq(n,e){const t=arguments.length>=2;return i=>i.pipe(n?Hl((r,s)=>n(r,s,i)):Qe,qA(1),t?jb(e):bk(()=>new $b))}(),er(s=>{if(null===s)return Tp(i);const o=oU(s);return function iY(n){n.sort((e,t)=>e.value.outlet===Gt?-1:t.value.outlet===Gt?1:e.value.outlet.localeCompare(t.value.outlet))}(o),vt(o)}))}processSegment(e,t,i,r,s,o){return gi(t).pipe(yp(a=>this.processSegmentAgainstRoute(a._injector??e,t,a,i,r,s,o).pipe(Rd(l=>{if(l instanceof sS)return vt(null);throw l}))),Id(a=>!!a),Rd(a=>{if(tU(a))return function eY(n,e,t){return 0===e.length&&!n.children[t]}(i,r,s)?vt([]):Tp(i);throw a}))}processSegmentAgainstRoute(e,t,i,r,s,o,a){return function QX(n,e,t,i){return!!(fa(n)===i||i!==Gt&&oS(e,t,n))&&("**"===n.path||uD(e,n,t).matched)}(i,r,s,o)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(e,r,i,s,o,a):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,r,t,i,s,o):Tp(r):Tp(r)}expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,i,r,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,i,r){const s=this.applyRedirects.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?rU(s):this.applyRedirects.lineralizeSegments(i,s).pipe(er(o=>{const a=new Pn(o,{});return this.processSegment(e,t,a,o,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o){const{matched:a,consumedSegments:l,remainingSegments:c,positionalParamSegments:d}=uD(t,r,s);if(!a)return Tp(t);const f=this.applyRedirects.applyRedirectCommands(l,r.redirectTo,d);return r.redirectTo.startsWith("/")?rU(f):this.applyRedirects.lineralizeSegments(r,f).pipe(er(p=>this.processSegment(e,i,t,p.concat(c),o,!1)))}matchSegmentAgainstRoute(e,t,i,r,s,o){let a;if("**"===i.path){const l=r.length>0?wk(r).parameters:{};a=vt({snapshot:new tS(r,l,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,aU(i),fa(i),i.component??i._loadedComponent??null,i,lU(i)),consumedSegments:[],remainingSegments:[]}),t.children={}}else a=XX(t,i,r,e).pipe(Rt(({matched:l,consumedSegments:c,remainingSegments:d,parameters:f})=>l?{snapshot:new tS(c,f,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,aU(i),fa(i),i.component??i._loadedComponent??null,i,lU(i)),consumedSegments:c,remainingSegments:d}:null));return a.pipe(Ms(l=>null===l?Tp(t):this.getChildConfig(e=i._injector??e,i,r).pipe(Ms(({routes:c})=>{const d=i._loadedInjector??e,{snapshot:f,consumedSegments:p,remainingSegments:m}=l,{segmentGroup:_,slicedSegments:E}=sU(t,p,m,c);if(0===E.length&&_.hasChildren())return this.processChildren(d,c,_).pipe(Rt(y=>null===y?null:[new zl(f,y)]));if(0===c.length&&0===E.length)return vt([new zl(f,[])]);const v=fa(i)===s;return this.processSegment(d,c,_,E,v?Gt:s,!0).pipe(Rt(y=>[new zl(f,y)]))}))))}getChildConfig(e,t,i){return t.children?vt({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?vt({routes:t._loadedRoutes,injector:t._loadedInjector}):function GX(n,e,t,i){const r=e.canLoad;return void 0===r||0===r.length?vt(!0):vt(r.map(o=>{const a=Mp(o,n);return su(function DX(n){return n&&Ey(n.canLoad)}(a)?a.canLoad(e,t):n.runInContext(()=>a(e,t)))})).pipe(xp(),nU())}(e,t,i).pipe(er(r=>r?this.configLoader.loadChildren(e,t).pipe(Yr(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):function jX(n){return sy(Zk(!1,3))}())):vt({routes:[],injector:e})}}function rY(n){const e=n.value.routeConfig;return e&&""===e.path}function oU(n){const e=[],t=new Set;for(const i of n){if(!rY(i)){e.push(i);continue}const r=e.find(s=>i.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...i.children),t.add(r)):e.push(i)}for(const i of t){const r=oU(i.children);e.push(new zl(i.value,r))}return e.filter(i=>!t.has(i))}function aU(n){return n.data||{}}function lU(n){return n.resolve||{}}function cU(n){return"string"==typeof n.title||null===n.title}function dD(n){return Ms(e=>{const t=n(e);return t?gi(t).pipe(Rt(()=>e)):vt(e)})}const Cp=new Ye("ROUTES");let hD=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=Ve(rO)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return vt(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const i=su(t.loadComponent()).pipe(Rt(uU),Yr(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),oy(()=>{this.componentLoaders.delete(t)})),r=new Ek(i,()=>new Un).pipe(jA());return this.componentLoaders.set(t,r),r}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return vt({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const s=function dY(n,e,t,i){return su(n.loadChildren()).pipe(Rt(uU),er(r=>r instanceof pL||Array.isArray(r)?vt(r):gi(e.compileModuleAsync(r))),Rt(r=>{i&&i(n);let s,o,a=!1;return Array.isArray(r)?(o=r,!0):(s=r.create(t).injector,o=s.get(Cp,[],{optional:!0,self:!0}).flat()),{routes:o.map(lD),injector:s}}))}(i,this.compiler,t,this.onLoadEndListener).pipe(oy(()=>{this.childrenLoaders.delete(i)})),o=new Ek(s,()=>new Un).pipe(jA());return this.childrenLoaders.set(i,o),o}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=tt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function uU(n){return function hY(n){return n&&"object"==typeof n&&"default"in n}(n)?n.default:n}let aS=(()=>{class n{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Un,this.transitionAbortSubject=new Un,this.configLoader=Ve(hD),this.environmentInjector=Ve(hs),this.urlSerializer=Ve(cy),this.rootContexts=Ve(my),this.inputBindingEnabled=null!==Ve(nS,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>vt(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=r=>this.events.next(new rX(r)),this.configLoader.onLoadStartListener=r=>this.events.next(new iX(r))}complete(){this.transitions?.complete()}handleNavigationRequest(t){const i=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:i})}setupNavigations(t,i,r){return this.transitions=new Vr({id:0,currentUrlTree:i,currentRawUrl:i,currentBrowserUrl:i,extractedUrl:t.urlHandlingStrategy.extract(i),urlAfterRedirects:t.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:fy,restoredState:null,currentSnapshot:r.snapshot,targetSnapshot:null,currentRouterState:r,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Hl(s=>0!==s.id),Rt(s=>({...s,extractedUrl:t.urlHandlingStrategy.extract(s.rawUrl)})),Ms(s=>{this.currentTransition=s;let o=!1,a=!1;return vt(s).pipe(Yr(l=>{this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),Ms(l=>{const c=l.currentBrowserUrl.toString(),d=!t.navigated||l.extractedUrl.toString()!==c||c!==l.currentUrlTree.toString();if(!d&&"reload"!==(l.extras.onSameUrlNavigation??t.onSameUrlNavigation)){const p="";return this.events.next(new bp(l.id,this.urlSerializer.serialize(l.rawUrl),p,0)),l.resolve(null),Mo}if(t.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return vt(l).pipe(Ms(p=>{const m=this.transitions?.getValue();return this.events.next(new Qb(p.id,this.urlSerializer.serialize(p.extractedUrl),p.source,p.restoredState)),m!==this.transitions?.getValue()?Mo:Promise.resolve(p)}),function sY(n,e,t,i,r,s){return er(o=>function tY(n,e,t,i,r,s,o="emptyOnly"){return new nY(n,e,t,i,r,o,s).recognize()}(n,e,t,i,o.extractedUrl,r,s).pipe(Rt(({state:a,tree:l})=>({...o,targetSnapshot:a,urlAfterRedirects:l}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,t.paramsInheritanceStrategy),Yr(p=>{s.targetSnapshot=p.targetSnapshot,s.urlAfterRedirects=p.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:p.urlAfterRedirects};const m=new Hk(p.id,this.urlSerializer.serialize(p.extractedUrl),this.urlSerializer.serialize(p.urlAfterRedirects),p.targetSnapshot);this.events.next(m)}));if(d&&t.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){const{id:p,extractedUrl:m,source:_,restoredState:E,extras:v}=l,y=new Qb(p,this.urlSerializer.serialize(m),_,E);this.events.next(y);const S=$k(0,this.rootComponentType).snapshot;return this.currentTransition=s={...l,targetSnapshot:S,urlAfterRedirects:m,extras:{...v,skipLocationChange:!1,replaceUrl:!1}},vt(s)}{const p="";return this.events.next(new bp(l.id,this.urlSerializer.serialize(l.extractedUrl),p,1)),l.resolve(null),Mo}}),Yr(l=>{const c=new Qq(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(c)}),Rt(l=>(this.currentTransition=s={...l,guards:MX(l.targetSnapshot,l.currentSnapshot,this.rootContexts)},s)),function OX(n,e){return er(t=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return 0===o.length&&0===s.length?vt({...t,guardsResult:!0}):function FX(n,e,t,i){return gi(n).pipe(er(r=>function zX(n,e,t,i,r){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?vt(s.map(a=>{const l=_y(e)??r,c=Mp(a,l);return su(function PX(n){return n&&Ey(n.canDeactivate)}(c)?c.canDeactivate(n,e,t,i):l.runInContext(()=>c(n,e,t,i))).pipe(Id())})).pipe(xp()):vt(!0)}(r.component,r.route,t,e,i)),Id(r=>!0!==r,!0))}(o,i,r,n).pipe(er(a=>a&&function AX(n){return"boolean"==typeof n}(a)?function kX(n,e,t,i){return gi(e).pipe(yp(r=>$A(function BX(n,e){return null!==n&&e&&e(new sX(n)),vt(!0)}(r.route.parent,i),function UX(n,e){return null!==n&&e&&e(new aX(n)),vt(!0)}(r.route,i),function HX(n,e,t){const i=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function xX(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(o)).filter(o=>null!==o).map(o=>vk(()=>vt(o.guards.map(l=>{const c=_y(o.node)??t,d=Mp(l,c);return su(function RX(n){return n&&Ey(n.canActivateChild)}(d)?d.canActivateChild(i,n):c.runInContext(()=>d(i,n))).pipe(Id())})).pipe(xp())));return vt(s).pipe(xp())}(n,r.path,t),function VX(n,e,t){const i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||0===i.length)return vt(!0);const r=i.map(s=>vk(()=>{const o=_y(e)??t,a=Mp(s,o);return su(function IX(n){return n&&Ey(n.canActivate)}(a)?a.canActivate(e,n):o.runInContext(()=>a(e,n))).pipe(Id())}));return vt(r).pipe(xp())}(n,r.route,t))),Id(r=>!0!==r,!0))}(i,s,n,e):vt(a)),Rt(a=>({...t,guardsResult:a})))})}(this.environmentInjector,l=>this.events.next(l)),Yr(l=>{if(s.guardsResult=l.guardsResult,Nd(l.guardsResult))throw Kk(0,l.guardsResult);const c=new eX(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(c)}),Hl(l=>!!l.guardsResult||(this.cancelNavigationTransition(l,"",3),!1)),dD(l=>{if(l.guards.canActivateChecks.length)return vt(l).pipe(Yr(c=>{const d=new tX(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(d)}),Ms(c=>{let d=!1;return vt(c).pipe(function oY(n,e){return er(t=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return vt(t);let s=0;return gi(r).pipe(yp(o=>function aY(n,e,t,i){const r=n.routeConfig,s=n._resolve;return void 0!==r?.title&&!cU(r)&&(s[ay]=r.title),function lY(n,e,t,i){const r=function cY(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===r.length)return vt({});const s={};return gi(r).pipe(er(o=>function uY(n,e,t,i){const r=_y(e)??i,s=Mp(n,r);return su(s.resolve?s.resolve(e,t):r.runInContext(()=>s(e,t)))}(n[o],e,t,i).pipe(Id(),Yr(a=>{s[o]=a}))),qA(1),function wq(n){return Rt(()=>n)}(s),Rd(o=>tU(o)?Mo:sy(o)))}(s,n,e,i).pipe(Rt(o=>(n._resolvedData=o,n.data=jk(n,t).resolve,r&&cU(r)&&(n.data[ay]=r.title),null)))}(o.route,i,n,e)),Yr(()=>s++),qA(1),er(o=>s===r.length?vt(t):Mo))})}(t.paramsInheritanceStrategy,this.environmentInjector),Yr({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(c,"",2)}}))}),Yr(c=>{const d=new nX(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(d)}))}),dD(l=>{const c=d=>{const f=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&f.push(this.configLoader.loadComponent(d.routeConfig).pipe(Yr(p=>{d.component=p}),Rt(()=>{})));for(const p of d.children)f.push(...c(p));return f};return WA(c(l.targetSnapshot.root)).pipe(jb(),_p(1))}),dD(()=>this.afterPreactivation()),Rt(l=>{const c=function fX(n,e,t){const i=gy(n,e._root,t?t._root:void 0);return new Wk(i,e)}(t.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=s={...l,targetRouterState:c},s}),Yr(()=>{this.events.next(new QA)}),((n,e,t,i)=>Rt(r=>(new wX(e,r.targetRouterState,r.currentRouterState,t,i).activate(n),r)))(this.rootContexts,t.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),_p(1),Yr({next:l=>{o=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new ou(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),t.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{o=!0}}),function Mq(n){return gn((e,t)=>{ns(n).subscribe(mn(t,()=>t.complete(),cl)),!t.closed&&e.subscribe(t)})}(this.transitionAbortSubject.pipe(Yr(l=>{throw l}))),oy(()=>{o||a||this.cancelNavigationTransition(s,"",1),this.currentNavigation?.id===s.id&&(this.currentNavigation=null)}),Rd(l=>{if(a=!0,Jk(l))this.events.next(new py(s.id,this.urlSerializer.serialize(s.extractedUrl),l.message,l.cancellationCode)),function gX(n){return Jk(n)&&Nd(n.url)}(l)?this.events.next(new eD(l.url)):s.resolve(!1);else{this.events.next(new eS(s.id,this.urlSerializer.serialize(s.extractedUrl),l,s.targetSnapshot??void 0));try{s.resolve(t.errorHandler(l))}catch(c){s.reject(c)}}return Mo}))}))}cancelNavigationTransition(t,i,r){const s=new py(t.id,this.urlSerializer.serialize(t.extractedUrl),i,r);this.events.next(s),t.resolve(!1)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=tt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function dU(n){return n!==fy}let hU=(()=>{class n{buildTitle(t){let i,r=t.root;for(;void 0!==r;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(s=>s.outlet===Gt);return i}getResolvedTitleForRoute(t){return t.data[ay]}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=tt({token:n,factory:function(){return Ve(fY)},providedIn:"root"})}return n})(),fY=(()=>{class n extends hU{constructor(t){super(),this.title=t}updateTitle(t){const i=this.buildTitle(t);void 0!==i&&this.title.setTitle(i)}static#e=this.\u0275fac=function(i){return new(i||n)(Ne(MF))};static#t=this.\u0275prov=tt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),pY=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=tt({token:n,factory:function(){return Ve(gY)},providedIn:"root"})}return n})();class mY{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let gY=(()=>{class n extends mY{static#e=this.\u0275fac=function(){let t;return function(r){return(t||(t=_i(n)))(r||n)}}();static#t=this.\u0275prov=tt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const lS=new Ye("",{providedIn:"root",factory:()=>({})});let _Y=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=tt({token:n,factory:function(){return Ve(yY)},providedIn:"root"})}return n})(),yY=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=tt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var by=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(by||{});function fU(n,e){n.events.pipe(Hl(t=>t instanceof ou||t instanceof py||t instanceof eS||t instanceof bp),Rt(t=>t instanceof ou||t instanceof bp?by.COMPLETE:t instanceof py&&(0===t.code||1===t.code)?by.REDIRECTING:by.FAILED),Hl(t=>t!==by.REDIRECTING),_p(1)).subscribe(()=>{e()})}function vY(n){throw n}function EY(n,e,t){return e.parse("/")}const bY={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},SY={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let ks=(()=>{class n{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.location.getState()?.\u0275routerPageId??this.currentPageId}get events(){return this._events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=Ve(iO),this.isNgZoneEnabled=!1,this._events=new Un,this.options=Ve(lS,{optional:!0})||{},this.pendingTasks=Ve(QE),this.errorHandler=this.options.errorHandler||vY,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||EY,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=Ve(_Y),this.routeReuseStrategy=Ve(pY),this.titleStrategy=Ve(hU),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=Ve(Cp,{optional:!0})?.flat()??[],this.navigationTransitions=Ve(aS),this.urlSerializer=Ve(cy),this.location=Ve(MC),this.componentInputBindingEnabled=!!Ve(nS,{optional:!0}),this.eventsSubscription=new mi,this.isNgZoneEnabled=Ve(In)instanceof In&&In.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new Ep,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=$k(0,null),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe(t=>{this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const t=this.navigationTransitions.events.subscribe(i=>{try{const{currentTransition:r}=this.navigationTransitions;if(null===r)return void(pU(i)&&this._events.next(i));if(i instanceof Qb)dU(r.source)&&(this.browserUrlTree=r.extractedUrl);else if(i instanceof bp)this.rawUrlTree=r.rawUrl;else if(i instanceof Hk){if("eager"===this.urlUpdateStrategy){if(!r.extras.skipLocationChange){const s=this.urlHandlingStrategy.merge(r.urlAfterRedirects,r.rawUrl);this.setBrowserUrl(s,r)}this.browserUrlTree=r.urlAfterRedirects}}else if(i instanceof QA)this.currentUrlTree=r.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(r.urlAfterRedirects,r.rawUrl),this.routerState=r.targetRouterState,"deferred"===this.urlUpdateStrategy&&(r.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,r),this.browserUrlTree=r.urlAfterRedirects);else if(i instanceof py)0!==i.code&&1!==i.code&&(this.navigated=!0),(3===i.code||2===i.code)&&this.restoreHistory(r);else if(i instanceof eD){const s=this.urlHandlingStrategy.merge(i.url,r.currentRawUrl),o={skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||dU(r.source)};this.scheduleNavigation(s,fy,null,o,{resolve:r.resolve,reject:r.reject,promise:r.promise})}i instanceof eS&&this.restoreHistory(r,!0),i instanceof ou&&(this.navigated=!0),pU(i)&&this._events.next(i)}catch(r){this.navigationTransitions.transitionAbortSubject.next(r)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const t=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),fy,t)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const i="popstate"===t.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{this.navigateToSyncWithBrowser(t.url,i,t.state)},0)}))}navigateToSyncWithBrowser(t,i,r){const s={replaceUrl:!0},o=r?.navigationId?r:null;if(r){const l={...r};delete l.navigationId,delete l.\u0275routerPageId,0!==Object.keys(l).length&&(s.state=l)}const a=this.parseUrl(t);this.scheduleNavigation(a,i,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(lD),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,i={}){const{relativeTo:r,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:l}=i,c=l?this.currentUrlTree.fragment:o;let f,d=null;switch(a){case"merge":d={...this.currentUrlTree.queryParams,...s};break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=s||null}null!==d&&(d=this.removeEmptyProps(d));try{f=Lk(r?r.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof t[0]||!t[0].startsWith("/"))&&(t=[]),f=this.currentUrlTree.root}return Ok(f,t,d,c??null)}navigateByUrl(t,i={skipLocationChange:!1}){const r=Nd(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,fy,null,i)}navigate(t,i={skipLocationChange:!1}){return function wY(n){for(let e=0;e<n.length;e++)if(null==n[e])throw new re(4008,!1)}(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let i;try{i=this.urlSerializer.parse(t)}catch(r){i=this.malformedUriErrorHandler(r,this.urlSerializer,t)}return i}isActive(t,i){let r;if(r=!0===i?{...bY}:!1===i?{...SY}:i,Nd(t))return xk(this.currentUrlTree,t,r);const s=this.parseUrl(t);return xk(this.currentUrlTree,s,r)}removeEmptyProps(t){return Object.keys(t).reduce((i,r)=>{const s=t[r];return null!=s&&(i[r]=s),i},{})}scheduleNavigation(t,i,r,s,o){if(this.disposed)return Promise.resolve(!1);let a,l,c;o?(a=o.resolve,l=o.reject,c=o.promise):c=new Promise((f,p)=>{a=f,l=p});const d=this.pendingTasks.add();return fU(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,currentBrowserUrl:this.browserUrlTree,rawUrl:t,extras:s,resolve:a,reject:l,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(f=>Promise.reject(f))}setBrowserUrl(t,i){const r=this.urlSerializer.serialize(t);if(this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl){const o={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId)};this.location.replaceState(r,"",o)}else{const s={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId+1)};this.location.go(r,"",s)}}restoreHistory(t,i=!1){if("computed"===this.canceledNavigationResolution){const s=this.currentPageId-this.browserPageId;0!==s?this.location.historyGo(s):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===s&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=tt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function pU(n){return!(n instanceof QA||n instanceof eD)}class mU{}let TY=(()=>{class n{constructor(t,i,r,s,o){this.router=t,this.injector=r,this.preloadingStrategy=s,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(Hl(t=>t instanceof ou),yp(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,i){const r=[];for(const s of i){s.providers&&!s._injector&&(s._injector=$T(s.providers,t,`Route: ${s.path}`));const o=s._injector??t,a=s._loadedInjector??o;(s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent)&&r.push(this.preloadConfig(o,s)),(s.children||s._loadedRoutes)&&r.push(this.processRoutes(a,s.children??s._loadedRoutes))}return gi(r).pipe(hc())}preloadConfig(t,i){return this.preloadingStrategy.preload(i,()=>{let r;r=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(t,i):vt(null);const s=r.pipe(er(o=>null===o?vt(void 0):(i._loadedRoutes=o.routes,i._loadedInjector=o.injector,this.processRoutes(o.injector??t,o.routes))));return i.loadComponent&&!i._loadedComponent?gi([s,this.loader.loadComponent(i)]).pipe(hc()):s})}static#e=this.\u0275fac=function(i){return new(i||n)(Ne(ks),Ne(rO),Ne(hs),Ne(mU),Ne(hD))};static#t=this.\u0275prov=tt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const pD=new Ye("");let gU=(()=>{class n{constructor(t,i,r,s,o={}){this.urlSerializer=t,this.transitions=i,this.viewportScroller=r,this.zone=s,this.options=o,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},o.scrollPositionRestoration=o.scrollPositionRestoration||"disabled",o.anchorScrolling=o.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof Qb?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof ou?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof bp&&0===t.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof zk&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new zk(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static#e=this.\u0275fac=function(i){!function nP(){throw new Error("invalid")}()};static#t=this.\u0275prov=tt({token:n,factory:n.\u0275fac})}return n})();function Gl(n,e){return{\u0275kind:n,\u0275providers:e}}function yU(){const n=Ve(ro);return e=>{const t=n.get(Sd);if(e!==t.components[0])return;const i=n.get(ks),r=n.get(vU);1===n.get(mD)&&i.initialNavigation(),n.get(EU,null,Xt.Optional)?.setUpPreloading(),n.get(pD,null,Xt.Optional)?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}const vU=new Ye("",{factory:()=>new Un}),mD=new Ye("",{providedIn:"root",factory:()=>1}),EU=new Ye("");function IY(n){return Gl(0,[{provide:EU,useExisting:TY},{provide:mU,useExisting:n}])}const bU=new Ye("ROUTER_FORROOT_GUARD"),PY=[MC,{provide:cy,useClass:XA},ks,my,{provide:wp,useFactory:function _U(n){return n.routerState.root},deps:[ks]},hD,[]];function NY(){return new dO("Router",ks)}let SU=(()=>{class n{constructor(t){}static forRoot(t,i){return{ngModule:n,providers:[PY,[],{provide:Cp,multi:!0,useValue:t},{provide:bU,useFactory:kY,deps:[[ks,new mf,new gf]]},{provide:lS,useValue:i||{}},i?.useHash?{provide:Md,useClass:X$}:{provide:Md,useClass:HO},{provide:pD,useFactory:()=>{const n=Ve(pj),e=Ve(In),t=Ve(lS),i=Ve(aS),r=Ve(cy);return t.scrollOffset&&n.setOffset(t.scrollOffset),new gU(r,i,n,e,t)}},i?.preloadingStrategy?IY(i.preloadingStrategy).\u0275providers:[],{provide:dO,multi:!0,useFactory:NY},i?.initialNavigation?UY(i):[],i?.bindToComponentInputs?Gl(8,[Yk,{provide:nS,useExisting:Yk}]).\u0275providers:[],[{provide:wU,useFactory:yU},{provide:pC,multi:!0,useExisting:wU}]]}}static forChild(t){return{ngModule:n,providers:[{provide:Cp,multi:!0,useValue:t}]}}static#e=this.\u0275fac=function(i){return new(i||n)(Ne(bU,8))};static#t=this.\u0275mod=tr({type:n});static#n=this.\u0275inj=Vi({})}return n})();function kY(n){return"guarded"}function UY(n){return["disabled"===n.initialNavigation?Gl(3,[{provide:oC,multi:!0,useFactory:()=>{const e=Ve(ks);return()=>{e.setUpLocationChangeListener()}}},{provide:mD,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?Gl(2,[{provide:mD,useValue:0},{provide:oC,multi:!0,deps:[ro],useFactory:e=>{const t=e.get(j$,Promise.resolve());return()=>t.then(()=>new Promise(i=>{const r=e.get(ks),s=e.get(vU);fU(r,()=>{i(!0)}),e.get(aS).afterPreactivation=()=>(i(!0),s.closed?vt(void 0):s),r.initialNavigation()}))}}]).\u0275providers:[]]}const wU=new Ye("");function MU(n,e,t,i,r,s,o){try{var a=n[s](o),l=a.value}catch(c){return void t(c)}a.done?e(l):Promise.resolve(l).then(i,r)}function Fn(n){return function(){var e=this,t=arguments;return new Promise(function(i,r){var s=n.apply(e,t);function o(l){MU(s,i,r,o,a,"next",l)}function a(l){MU(s,i,r,o,a,"throw",l)}o(void 0)})}}const TU=1,zY=2,Wl=3,cS=0,lK=1,cK=2,lu=0,uK=1,dK=2,hK=3,fK=4,pK=5,cu=301,Ld=302,Sy=306,Od=1e3,Kr=1001,Oi=1003,bi=1006,jl=1008,uu=1009,du=1014,ql=1015,xy=1016,Fd=1020,Uo=1023,kd=1026,Pp=1027,Ty=2300,Np=2301,Ud=3001,fi="srgb",Fr="srgb-linear",DD="display-p3",pS="display-p3-linear",mS="linear",ri="srgb",gS="rec709",_S="p3",p3="300 es",Xl=2e3;class Vd{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const r=this._listeners[e];if(void 0!==r){const s=r.indexOf(t);-1!==s&&r.splice(s,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const i=this._listeners[e.type];if(void 0!==i){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const Zr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];const Hd=Math.PI/180,Fp=180/Math.PI;function uo(){const n=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(Zr[255&n]+Zr[n>>8&255]+Zr[n>>16&255]+Zr[n>>24&255]+"-"+Zr[255&e]+Zr[e>>8&255]+"-"+Zr[e>>16&15|64]+Zr[e>>24&255]+"-"+Zr[63&t|128]+Zr[t>>8&255]+"-"+Zr[t>>16&255]+Zr[t>>24&255]+Zr[255&i]+Zr[i>>8&255]+Zr[i>>16&255]+Zr[i>>24&255]).toLowerCase()}function Si(n,e,t){return Math.max(e,Math.min(t,n))}function PD(n,e){return(n%e+e)%e}function Cy(n,e,t){return(1-t)*n+t*e}function ND(n){return 0==(n&n-1)&&0!==n}function g3(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function ES(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function Bs(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function jt(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(4294967295*n);case Uint16Array:return Math.round(65535*n);case Uint8Array:return Math.round(255*n);case Int32Array:return Math.round(2147483647*n);case Int16Array:return Math.round(32767*n);case Int8Array:return Math.round(127*n);default:throw new Error("Invalid component type.")}}const LD_DEG2RAD=Hd,LD_randInt=function jK(n,e){return n+Math.floor(Math.random()*(e-n+1))},LD_radToDeg=function ZK(n){return n*Fp};class he{constructor(e=0,t=0){he.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(Si(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Qt{constructor(e,t,i,r,s,o,a,l,c){Qt.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,i,r,s,o,a,l,c)}set(e,t,i,r,s,o,a,l,c){const d=this.elements;return d[0]=e,d[1]=r,d[2]=a,d[3]=t,d[4]=s,d[5]=l,d[6]=i,d[7]=o,d[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[3],l=i[6],c=i[1],d=i[4],f=i[7],p=i[2],m=i[5],_=i[8],E=r[0],v=r[3],y=r[6],S=r[1],b=r[4],M=r[7],T=r[2],I=r[5],A=r[8];return s[0]=o*E+a*S+l*T,s[3]=o*v+a*b+l*I,s[6]=o*y+a*M+l*A,s[1]=c*E+d*S+f*T,s[4]=c*v+d*b+f*I,s[7]=c*y+d*M+f*A,s[2]=p*E+m*S+_*T,s[5]=p*v+m*b+_*I,s[8]=p*y+m*M+_*A,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],d=e[8];return t*o*d-t*a*c-i*s*d+i*a*l+r*s*c-r*o*l}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],d=e[8],f=d*o-a*c,p=a*l-d*s,m=c*s-o*l,_=t*f+i*p+r*m;if(0===_)return this.set(0,0,0,0,0,0,0,0,0);const E=1/_;return e[0]=f*E,e[1]=(r*c-d*i)*E,e[2]=(a*i-r*o)*E,e[3]=p*E,e[4]=(d*t-r*l)*E,e[5]=(r*s-a*t)*E,e[6]=m*E,e[7]=(i*l-c*t)*E,e[8]=(o*t-i*s)*E,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(i*l,i*c,-i*(l*o+c*a)+o+e,-r*c,r*l,-r*(-c*o+l*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(OD.makeScale(e,t)),this}rotate(e){return this.premultiply(OD.makeRotation(-e)),this}translate(e,t){return this.premultiply(OD.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const OD=new Qt;function _3(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function Ay(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function eZ(){const n=Ay("canvas");return n.style.display="block",n}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const y3={};function Dy(n){n in y3||(y3[n]=!0,console.warn(n))}const v3=(new Qt).set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),E3=(new Qt).set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),bS={[Fr]:{transfer:mS,primaries:gS,toReference:n=>n,fromReference:n=>n},[fi]:{transfer:ri,primaries:gS,toReference:n=>n.convertSRGBToLinear(),fromReference:n=>n.convertLinearToSRGB()},[pS]:{transfer:mS,primaries:_S,toReference:n=>n.applyMatrix3(E3),fromReference:n=>n.applyMatrix3(v3)},[DD]:{transfer:ri,primaries:_S,toReference:n=>n.convertSRGBToLinear().applyMatrix3(E3),fromReference:n=>n.applyMatrix3(v3).convertLinearToSRGB()}},tZ=new Set([Fr,pS]),Cn={enabled:!0,_workingColorSpace:Fr,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(n){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!n},get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(n){if(!tZ.has(n))throw new Error(`Unsupported working color space, "${n}".`);this._workingColorSpace=n},convert:function(n,e,t){return!1!==this.enabled&&e!==t&&e&&t?(0,bS[t].fromReference)((0,bS[e].toReference)(n)):n},fromWorkingColorSpace:function(n,e){return this.convert(n,this._workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this._workingColorSpace)},getPrimaries:function(n){return bS[n].primaries},getTransfer:function(n){return""===n?mS:bS[n].transfer}};function Up(n){return n<.04045?.0773993808*n:Math.pow(.9478672986*n+.0521327014,2.4)}function FD(n){return n<.0031308?12.92*n:1.055*Math.pow(n,.41666)-.055}let Bp;class b3{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===Bp&&(Bp=Ay("canvas")),Bp.width=e.width,Bp.height=e.height;const i=Bp.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=Bp}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=Ay("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=255*Up(s[o]/255);return i.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t[i]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*Up(t[i]/255)):Up(t[i]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let nZ=0;class Vp{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:nZ++}),this.uuid=uo(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(null!==r){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)s.push(kD(r[o].isDataTexture?r[o].image:r[o]))}else s=kD(r);i.url=s}return t||(e.images[this.uuid]=i),i}}function kD(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?b3.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let iZ=0,pa=(()=>{class n extends Vd{constructor(t=n.DEFAULT_IMAGE,i=n.DEFAULT_MAPPING,r=Kr,s=Kr,o=bi,a=jl,l=Uo,c=uu,d=n.DEFAULT_ANISOTROPY,f=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:iZ++}),this.uuid=uo(),this.name="",this.source=new Vp(t),this.mipmaps=[],this.mapping=i,this.channel=0,this.wrapS=r,this.wrapT=s,this.magFilter=o,this.minFilter=a,this.anisotropy=d,this.format=l,this.internalFormat=null,this.type=c,this.offset=new he(0,0),this.repeat=new he(1,1),this.center=new he(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Qt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,"string"==typeof f?this.colorSpace=f:(Dy("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=f===Ud?fi:""),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const i=void 0===t||"string"==typeof t;if(!i&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),i||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Od:t.x=t.x-Math.floor(t.x);break;case Kr:t.x=t.x<0?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case Od:t.y=t.y-Math.floor(t.y);break;case Kr:t.y=t.y<0?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return Dy("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===fi?Ud:3e3}set encoding(t){Dy("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=t===Ud?fi:""}}return n.DEFAULT_IMAGE=null,n.DEFAULT_MAPPING=300,n.DEFAULT_ANISOTROPY=1,n})();class kn{constructor(e=0,t=0,i=0,r=1){kn.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*i+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,s;const l=e.elements,c=l[0],d=l[4],f=l[8],p=l[1],m=l[5],_=l[9],E=l[2],v=l[6],y=l[10];if(Math.abs(d-p)<.01&&Math.abs(f-E)<.01&&Math.abs(_-v)<.01){if(Math.abs(d+p)<.1&&Math.abs(f+E)<.1&&Math.abs(_+v)<.1&&Math.abs(c+m+y-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const b=(c+1)/2,M=(m+1)/2,T=(y+1)/2,I=(d+p)/4,A=(f+E)/4,F=(_+v)/4;return b>M&&b>T?b<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(b),r=I/i,s=A/i):M>T?M<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(M),i=I/r,s=F/r):T<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(T),i=A/s,r=F/s),this.set(i,r,s,t),this}let S=Math.sqrt((v-_)*(v-_)+(f-E)*(f-E)+(p-d)*(p-d));return Math.abs(S)<.001&&(S=1),this.x=(v-_)/S,this.y=(f-E)/S,this.z=(p-d)/S,this.w=Math.acos((c+m+y-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class rZ extends Vd{constructor(e=1,t=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new kn(0,0,e,t),this.scissorTest=!1,this.viewport=new kn(0,0,e,t);const r={width:e,height:t,depth:1};void 0!==i.encoding&&(Dy("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),i.colorSpace=i.encoding===Ud?fi:""),i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:bi,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},i),this.texture=new pa(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps,this.texture.internalFormat=i.internalFormat,this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.depthTexture=i.depthTexture,this.samples=i.samples}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new Vp(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class zd extends rZ{constructor(e=1,t=1,i={}){super(e,t,i),this.isWebGLRenderTarget=!0}}class UD extends pa{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=Oi,this.minFilter=Oi,this.wrapR=Kr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class S3 extends pa{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=Oi,this.minFilter=Oi,this.wrapR=Kr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class kr{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,s,o,a){let l=i[r+0],c=i[r+1],d=i[r+2],f=i[r+3];const p=s[o+0],m=s[o+1],_=s[o+2],E=s[o+3];if(0===a)return e[t+0]=l,e[t+1]=c,e[t+2]=d,void(e[t+3]=f);if(1===a)return e[t+0]=p,e[t+1]=m,e[t+2]=_,void(e[t+3]=E);if(f!==E||l!==p||c!==m||d!==_){let v=1-a;const y=l*p+c*m+d*_+f*E,S=y>=0?1:-1,b=1-y*y;if(b>Number.EPSILON){const T=Math.sqrt(b),I=Math.atan2(T,y*S);v=Math.sin(v*I)/T,a=Math.sin(a*I)/T}const M=a*S;if(l=l*v+p*M,c=c*v+m*M,d=d*v+_*M,f=f*v+E*M,v===1-a){const T=1/Math.sqrt(l*l+c*c+d*d+f*f);l*=T,c*=T,d*=T,f*=T}}e[t]=l,e[t+1]=c,e[t+2]=d,e[t+3]=f}static multiplyQuaternionsFlat(e,t,i,r,s,o){const a=i[r],l=i[r+1],c=i[r+2],d=i[r+3],f=s[o],p=s[o+1],m=s[o+2],_=s[o+3];return e[t]=a*_+d*f+l*m-c*p,e[t+1]=l*_+d*p+c*f-a*m,e[t+2]=c*_+d*m+a*p-l*f,e[t+3]=d*_-a*f-l*p-c*m,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,c=a(i/2),d=a(r/2),f=a(s/2),p=l(i/2),m=l(r/2),_=l(s/2);switch(o){case"XYZ":this._x=p*d*f+c*m*_,this._y=c*m*f-p*d*_,this._z=c*d*_+p*m*f,this._w=c*d*f-p*m*_;break;case"YXZ":this._x=p*d*f+c*m*_,this._y=c*m*f-p*d*_,this._z=c*d*_-p*m*f,this._w=c*d*f+p*m*_;break;case"ZXY":this._x=p*d*f-c*m*_,this._y=c*m*f+p*d*_,this._z=c*d*_+p*m*f,this._w=c*d*f-p*m*_;break;case"ZYX":this._x=p*d*f-c*m*_,this._y=c*m*f+p*d*_,this._z=c*d*_-p*m*f,this._w=c*d*f+p*m*_;break;case"YZX":this._x=p*d*f+c*m*_,this._y=c*m*f+p*d*_,this._z=c*d*_-p*m*f,this._w=c*d*f-p*m*_;break;case"XZY":this._x=p*d*f-c*m*_,this._y=c*m*f-p*d*_,this._z=c*d*_+p*m*f,this._w=c*d*f+p*m*_;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],s=t[8],o=t[1],a=t[5],l=t[9],c=t[2],d=t[6],f=t[10],p=i+a+f;if(p>0){const m=.5/Math.sqrt(p+1);this._w=.25/m,this._x=(d-l)*m,this._y=(s-c)*m,this._z=(o-r)*m}else if(i>a&&i>f){const m=2*Math.sqrt(1+i-a-f);this._w=(d-l)/m,this._x=.25*m,this._y=(r+o)/m,this._z=(s+c)/m}else if(a>f){const m=2*Math.sqrt(1+a-i-f);this._w=(s-c)/m,this._x=(r+o)/m,this._y=.25*m,this._z=(l+d)/m}else{const m=2*Math.sqrt(1+f-i-a);this._w=(o-r)/m,this._x=(s+c)/m,this._y=(l+d)/m,this._z=.25*m}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Si(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(0===i)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,s=e._z,o=e._w,a=t._x,l=t._y,c=t._z,d=t._w;return this._x=i*d+o*a+r*c-s*l,this._y=r*d+o*l+s*a-i*c,this._z=s*d+o*c+i*l-r*a,this._w=o*d-i*a-r*l-s*c,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const i=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const m=1-t;return this._w=m*o+t*this._w,this._x=m*i+t*this._x,this._y=m*r+t*this._y,this._z=m*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const c=Math.sqrt(l),d=Math.atan2(c,a),f=Math.sin((1-t)*d)/c,p=Math.sin(t*d)/c;return this._w=o*f+this._w*p,this._x=i*f+this._x*p,this._y=r*f+this._y*p,this._z=s*f+this._z*p,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(r),i*Math.sin(s),i*Math.cos(s),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class L{constructor(e=0,t=0,i=0){L.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return void 0===i&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(w3.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(w3.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*r,this.y=s[1]*t+s[4]*i+s[7]*r,this.z=s[2]*t+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=l*t+o*r-a*i,d=l*i+a*t-s*r,f=l*r+s*i-o*t,p=-s*t-o*i-a*r;return this.x=c*l+p*-s+d*-a-f*-o,this.y=d*l+p*-o+f*-s-c*-a,this.z=f*l+p*-a+c*-o-d*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r,this.y=s[1]*t+s[5]*i+s[9]*r,this.z=s[2]*t+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=r*l-s*a,this.y=s*o-i*l,this.z=i*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return BD.copy(this).projectOnVector(e),this.sub(BD)}reflect(e){return this.sub(BD.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(Si(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const BD=new L,w3=new kr;class el{constructor(e=new L(1/0,1/0,1/0),t=new L(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(Kl.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(Kl.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=Kl.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){if(e.updateWorldMatrix(!1,!1),void 0!==e.boundingBox)null===e.boundingBox&&e.computeBoundingBox(),Hp.copy(e.boundingBox),Hp.applyMatrix4(e.matrixWorld),this.union(Hp);else{const r=e.geometry;if(void 0!==r)if(t&&void 0!==r.attributes&&void 0!==r.attributes.position){const s=r.attributes.position;for(let o=0,a=s.count;o<a;o++)Kl.fromBufferAttribute(s,o).applyMatrix4(e.matrixWorld),this.expandByPoint(Kl)}else null===r.boundingBox&&r.computeBoundingBox(),Hp.copy(r.boundingBox),Hp.applyMatrix4(e.matrixWorld),this.union(Hp)}const i=e.children;for(let r=0,s=i.length;r<s;r++)this.expandByObject(i[r],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Kl),Kl.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Iy),SS.subVectors(this.max,Iy),zp.subVectors(e.a,Iy),Gp.subVectors(e.b,Iy),Wp.subVectors(e.c,Iy),hu.subVectors(Gp,zp),fu.subVectors(Wp,Gp),Gd.subVectors(zp,Wp);let t=[0,-hu.z,hu.y,0,-fu.z,fu.y,0,-Gd.z,Gd.y,hu.z,0,-hu.x,fu.z,0,-fu.x,Gd.z,0,-Gd.x,-hu.y,hu.x,0,-fu.y,fu.x,0,-Gd.y,Gd.x,0];return!(!VD(t,zp,Gp,Wp,SS)||(t=[1,0,0,0,1,0,0,0,1],!VD(t,zp,Gp,Wp,SS)))&&(wS.crossVectors(hu,fu),t=[wS.x,wS.y,wS.z],VD(t,zp,Gp,Wp,SS))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Kl).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(Kl).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(Yl[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Yl[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Yl[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Yl[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Yl[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Yl[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Yl[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Yl[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Yl)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Yl=[new L,new L,new L,new L,new L,new L,new L,new L],Kl=new L,Hp=new el,zp=new L,Gp=new L,Wp=new L,hu=new L,fu=new L,Gd=new L,Iy=new L,SS=new L,wS=new L,Wd=new L;function VD(n,e,t,i,r){for(let s=0,o=n.length-3;s<=o;s+=3){Wd.fromArray(n,s);const a=r.x*Math.abs(Wd.x)+r.y*Math.abs(Wd.y)+r.z*Math.abs(Wd.z),l=e.dot(Wd),c=t.dot(Wd),d=i.dot(Wd);if(Math.max(-Math.max(l,c,d),Math.min(l,c,d))>a)return!1}return!0}const sZ=new el,Ry=new L,HD=new L;class ma{constructor(e=new L,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;void 0!==t?i.copy(t):sZ.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Ry.subVectors(e,this.center);const t=Ry.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=.5*(i-this.radius);this.center.addScaledVector(Ry,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(HD.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Ry.copy(e.center).add(HD)),this.expandByPoint(Ry.copy(e.center).sub(HD))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Zl=new L,zD=new L,MS=new L,pu=new L,GD=new L,xS=new L,WD=new L;class $p{constructor(e=new L,t=new L(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Zl)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Zl.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Zl.copy(this.origin).addScaledVector(this.direction,t),Zl.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){zD.copy(e).add(t).multiplyScalar(.5),MS.copy(t).sub(e).normalize(),pu.copy(this.origin).sub(zD);const s=.5*e.distanceTo(t),o=-this.direction.dot(MS),a=pu.dot(this.direction),l=-pu.dot(MS),c=pu.lengthSq(),d=Math.abs(1-o*o);let f,p,m,_;if(d>0)if(f=o*l-a,p=o*a-l,_=s*d,f>=0)if(p>=-_)if(p<=_){const E=1/d;f*=E,p*=E,m=f*(f+o*p+2*a)+p*(o*f+p+2*l)+c}else p=s,f=Math.max(0,-(o*p+a)),m=-f*f+p*(p+2*l)+c;else p=-s,f=Math.max(0,-(o*p+a)),m=-f*f+p*(p+2*l)+c;else p<=-_?(f=Math.max(0,-(-o*s+a)),p=f>0?-s:Math.min(Math.max(-s,-l),s),m=-f*f+p*(p+2*l)+c):p<=_?(f=0,p=Math.min(Math.max(-s,-l),s),m=p*(p+2*l)+c):(f=Math.max(0,-(o*s+a)),p=f>0?s:Math.min(Math.max(-s,-l),s),m=-f*f+p*(p+2*l)+c);else p=o>0?-s:s,f=Math.max(0,-(o*p+a)),m=-f*f+p*(p+2*l)+c;return i&&i.copy(this.origin).addScaledVector(this.direction,f),r&&r.copy(zD).addScaledVector(MS,p),m}intersectSphere(e,t){Zl.subVectors(e.center,this.origin);const i=Zl.dot(this.direction),r=Zl.dot(Zl)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=i-o,l=i+o;return l<0?null:this.at(a<0?l:a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return null===i?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,s,o,a,l;const c=1/this.direction.x,d=1/this.direction.y,f=1/this.direction.z,p=this.origin;return c>=0?(i=(e.min.x-p.x)*c,r=(e.max.x-p.x)*c):(i=(e.max.x-p.x)*c,r=(e.min.x-p.x)*c),d>=0?(s=(e.min.y-p.y)*d,o=(e.max.y-p.y)*d):(s=(e.max.y-p.y)*d,o=(e.min.y-p.y)*d),i>o||s>r||((s>i||isNaN(i))&&(i=s),(o<r||isNaN(r))&&(r=o),f>=0?(a=(e.min.z-p.z)*f,l=(e.max.z-p.z)*f):(a=(e.max.z-p.z)*f,l=(e.min.z-p.z)*f),i>l||a>r)||((a>i||i!=i)&&(i=a),(l<r||r!=r)&&(r=l),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return null!==this.intersectBox(e,Zl)}intersectTriangle(e,t,i,r,s){GD.subVectors(t,e),xS.subVectors(i,e),WD.crossVectors(GD,xS);let a,o=this.direction.dot(WD);if(o>0){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}pu.subVectors(this.origin,e);const l=a*this.direction.dot(xS.crossVectors(pu,xS));if(l<0)return null;const c=a*this.direction.dot(GD.cross(pu));if(c<0||l+c>o)return null;const d=-a*pu.dot(WD);return d<0?null:this.at(d/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class At{constructor(e,t,i,r,s,o,a,l,c,d,f,p,m,_,E,v){At.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,i,r,s,o,a,l,c,d,f,p,m,_,E,v)}set(e,t,i,r,s,o,a,l,c,d,f,p,m,_,E,v){const y=this.elements;return y[0]=e,y[4]=t,y[8]=i,y[12]=r,y[1]=s,y[5]=o,y[9]=a,y[13]=l,y[2]=c,y[6]=d,y[10]=f,y[14]=p,y[3]=m,y[7]=_,y[11]=E,y[15]=v,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new At).fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/jp.setFromMatrixColumn(e,0).length(),s=1/jp.setFromMatrixColumn(e,1).length(),o=1/jp.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),l=Math.cos(r),c=Math.sin(r),d=Math.cos(s),f=Math.sin(s);if("XYZ"===e.order){const p=o*d,m=o*f,_=a*d,E=a*f;t[0]=l*d,t[4]=-l*f,t[8]=c,t[1]=m+_*c,t[5]=p-E*c,t[9]=-a*l,t[2]=E-p*c,t[6]=_+m*c,t[10]=o*l}else if("YXZ"===e.order){const p=l*d,m=l*f,_=c*d,E=c*f;t[0]=p+E*a,t[4]=_*a-m,t[8]=o*c,t[1]=o*f,t[5]=o*d,t[9]=-a,t[2]=m*a-_,t[6]=E+p*a,t[10]=o*l}else if("ZXY"===e.order){const p=l*d,m=l*f,_=c*d,E=c*f;t[0]=p-E*a,t[4]=-o*f,t[8]=_+m*a,t[1]=m+_*a,t[5]=o*d,t[9]=E-p*a,t[2]=-o*c,t[6]=a,t[10]=o*l}else if("ZYX"===e.order){const p=o*d,m=o*f,_=a*d,E=a*f;t[0]=l*d,t[4]=_*c-m,t[8]=p*c+E,t[1]=l*f,t[5]=E*c+p,t[9]=m*c-_,t[2]=-c,t[6]=a*l,t[10]=o*l}else if("YZX"===e.order){const p=o*l,m=o*c,_=a*l,E=a*c;t[0]=l*d,t[4]=E-p*f,t[8]=_*f+m,t[1]=f,t[5]=o*d,t[9]=-a*d,t[2]=-c*d,t[6]=m*f+_,t[10]=p-E*f}else if("XZY"===e.order){const p=o*l,m=o*c,_=a*l,E=a*c;t[0]=l*d,t[4]=-f,t[8]=c*d,t[1]=p*f+E,t[5]=o*d,t[9]=m*f-_,t[2]=_*f-m,t[6]=a*d,t[10]=E*f+p}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(oZ,e,aZ)}lookAt(e,t,i){const r=this.elements;return ho.subVectors(e,t),0===ho.lengthSq()&&(ho.z=1),ho.normalize(),mu.crossVectors(i,ho),0===mu.lengthSq()&&(1===Math.abs(i.z)?ho.x+=1e-4:ho.z+=1e-4,ho.normalize(),mu.crossVectors(i,ho)),mu.normalize(),TS.crossVectors(ho,mu),r[0]=mu.x,r[4]=TS.x,r[8]=ho.x,r[1]=mu.y,r[5]=TS.y,r[9]=ho.y,r[2]=mu.z,r[6]=TS.z,r[10]=ho.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[4],l=i[8],c=i[12],d=i[1],f=i[5],p=i[9],m=i[13],_=i[2],E=i[6],v=i[10],y=i[14],S=i[3],b=i[7],M=i[11],T=i[15],I=r[0],A=r[4],F=r[8],C=r[12],N=r[1],K=r[5],oe=r[9],ue=r[13],W=r[2],J=r[6],$=r[10],Y=r[14],ie=r[3],Z=r[7],de=r[11],q=r[15];return s[0]=o*I+a*N+l*W+c*ie,s[4]=o*A+a*K+l*J+c*Z,s[8]=o*F+a*oe+l*$+c*de,s[12]=o*C+a*ue+l*Y+c*q,s[1]=d*I+f*N+p*W+m*ie,s[5]=d*A+f*K+p*J+m*Z,s[9]=d*F+f*oe+p*$+m*de,s[13]=d*C+f*ue+p*Y+m*q,s[2]=_*I+E*N+v*W+y*ie,s[6]=_*A+E*K+v*J+y*Z,s[10]=_*F+E*oe+v*$+y*de,s[14]=_*C+E*ue+v*Y+y*q,s[3]=S*I+b*N+M*W+T*ie,s[7]=S*A+b*K+M*J+T*Z,s[11]=S*F+b*oe+M*$+T*de,s[15]=S*C+b*ue+M*Y+T*q,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],d=e[2],f=e[6],p=e[10],m=e[14];return e[3]*(+s*l*f-r*c*f-s*a*p+i*c*p+r*a*m-i*l*m)+e[7]*(+t*l*m-t*c*p+s*o*p-r*o*m+r*c*d-s*l*d)+e[11]*(+t*c*f-t*a*m-s*o*f+i*o*m+s*a*d-i*c*d)+e[15]*(-r*a*d-t*l*f+t*a*p+r*o*f-i*o*p+i*l*d)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],d=e[8],f=e[9],p=e[10],m=e[11],_=e[12],E=e[13],v=e[14],y=e[15],S=f*v*c-E*p*c+E*l*m-a*v*m-f*l*y+a*p*y,b=_*p*c-d*v*c-_*l*m+o*v*m+d*l*y-o*p*y,M=d*E*c-_*f*c+_*a*m-o*E*m-d*a*y+o*f*y,T=_*f*l-d*E*l-_*a*p+o*E*p+d*a*v-o*f*v,I=t*S+i*b+r*M+s*T;if(0===I)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const A=1/I;return e[0]=S*A,e[1]=(E*p*s-f*v*s-E*r*m+i*v*m+f*r*y-i*p*y)*A,e[2]=(a*v*s-E*l*s+E*r*c-i*v*c-a*r*y+i*l*y)*A,e[3]=(f*l*s-a*p*s-f*r*c+i*p*c+a*r*m-i*l*m)*A,e[4]=b*A,e[5]=(d*v*s-_*p*s+_*r*m-t*v*m-d*r*y+t*p*y)*A,e[6]=(_*l*s-o*v*s-_*r*c+t*v*c+o*r*y-t*l*y)*A,e[7]=(o*p*s-d*l*s+d*r*c-t*p*c-o*r*m+t*l*m)*A,e[8]=M*A,e[9]=(_*f*s-d*E*s-_*i*m+t*E*m+d*i*y-t*f*y)*A,e[10]=(o*E*s-_*a*s+_*i*c-t*E*c-o*i*y+t*a*y)*A,e[11]=(d*a*s-o*f*s-d*i*c+t*f*c+o*i*m-t*a*m)*A,e[12]=T*A,e[13]=(d*E*r-_*f*r+_*i*p-t*E*p-d*i*v+t*f*v)*A,e[14]=(_*a*r-o*E*r-_*i*l+t*E*l+o*i*v-t*a*v)*A,e[15]=(o*f*r-d*a*r+d*i*l-t*f*l-o*i*p+t*a*p)*A,this}scale(e){const t=this.elements,i=e.x,r=e.y,s=e.z;return t[0]*=i,t[4]*=r,t[8]*=s,t[1]*=i,t[5]*=r,t[9]*=s,t[2]*=i,t[6]*=r,t[10]*=s,t[3]*=i,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),s=1-i,o=e.x,a=e.y,l=e.z,c=s*o,d=s*a;return this.set(c*o+i,c*a-r*l,c*l+r*a,0,c*a+r*l,d*a+i,d*l-r*o,0,c*l-r*a,d*l+r*o,s*l*l+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,c=s+s,d=o+o,f=a+a,p=s*c,m=s*d,_=s*f,E=o*d,v=o*f,y=a*f,S=l*c,b=l*d,M=l*f,T=i.x,I=i.y,A=i.z;return r[0]=(1-(E+y))*T,r[1]=(m+M)*T,r[2]=(_-b)*T,r[3]=0,r[4]=(m-M)*I,r[5]=(1-(p+y))*I,r[6]=(v+S)*I,r[7]=0,r[8]=(_+b)*A,r[9]=(v-S)*A,r[10]=(1-(p+E))*A,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let s=jp.set(r[0],r[1],r[2]).length();const o=jp.set(r[4],r[5],r[6]).length(),a=jp.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],ga.copy(this);const c=1/s,d=1/o,f=1/a;return ga.elements[0]*=c,ga.elements[1]*=c,ga.elements[2]*=c,ga.elements[4]*=d,ga.elements[5]*=d,ga.elements[6]*=d,ga.elements[8]*=f,ga.elements[9]*=f,ga.elements[10]*=f,t.setFromRotationMatrix(ga),i.x=s,i.y=o,i.z=a,this}makePerspective(e,t,i,r,s,o,a=Xl){const l=this.elements,c=2*s/(t-e),d=2*s/(i-r),f=(t+e)/(t-e),p=(i+r)/(i-r);let m,_;if(a===Xl)m=-(o+s)/(o-s),_=-2*o*s/(o-s);else{if(2001!==a)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);m=-o/(o-s),_=-o*s/(o-s)}return l[0]=c,l[4]=0,l[8]=f,l[12]=0,l[1]=0,l[5]=d,l[9]=p,l[13]=0,l[2]=0,l[6]=0,l[10]=m,l[14]=_,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,i,r,s,o,a=Xl){const l=this.elements,c=1/(t-e),d=1/(i-r),f=1/(o-s),p=(t+e)*c,m=(i+r)*d;let _,E;if(a===Xl)_=(o+s)*f,E=-2*f;else{if(2001!==a)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);_=s*f,E=-1*f}return l[0]=2*c,l[4]=0,l[8]=0,l[12]=-p,l[1]=0,l[5]=2*d,l[9]=0,l[13]=-m,l[2]=0,l[6]=0,l[10]=E,l[14]=-_,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const jp=new L,ga=new At,oZ=new L(0,0,0),aZ=new L(1,1,1),mu=new L,TS=new L,ho=new L,M3=new At,x3=new kr;let lZ=(()=>{class n{constructor(t=0,i=0,r=0,s=n.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=i,this._z=r,this._order=s}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,i,r,s=this._order){return this._x=t,this._y=i,this._z=r,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,i=this._order,r=!0){const s=t.elements,o=s[0],a=s[4],l=s[8],c=s[1],d=s[5],f=s[9],p=s[2],m=s[6],_=s[10];switch(i){case"XYZ":this._y=Math.asin(Si(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-f,_),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(m,d),this._z=0);break;case"YXZ":this._x=Math.asin(-Si(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(l,_),this._z=Math.atan2(c,d)):(this._y=Math.atan2(-p,o),this._z=0);break;case"ZXY":this._x=Math.asin(Si(m,-1,1)),Math.abs(m)<.9999999?(this._y=Math.atan2(-p,_),this._z=Math.atan2(-a,d)):(this._y=0,this._z=Math.atan2(c,o));break;case"ZYX":this._y=Math.asin(-Si(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(m,_),this._z=Math.atan2(c,o)):(this._x=0,this._z=Math.atan2(-a,d));break;case"YZX":this._z=Math.asin(Si(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-f,d),this._y=Math.atan2(-p,o)):(this._x=0,this._y=Math.atan2(l,_));break;case"XZY":this._z=Math.asin(-Si(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(m,d),this._y=Math.atan2(l,o)):(this._x=Math.atan2(-f,_),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,!0===r&&this._onChangeCallback(),this}setFromQuaternion(t,i,r){return M3.makeRotationFromQuaternion(t),this.setFromRotationMatrix(M3,i,r)}setFromVector3(t,i=this._order){return this.set(t.x,t.y,t.z,i)}reorder(t){return x3.setFromEuler(this),this.setFromQuaternion(x3,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],i=0){return t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return n.DEFAULT_ORDER="XYZ",n})();class $D{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let cZ=0;const T3=new L,qp=new kr,Jl=new At,CS=new L,Py=new L,uZ=new L,dZ=new kr,C3=new L(1,0,0),A3=new L(0,1,0),D3=new L(0,0,1),hZ={type:"added"},fZ={type:"removed"};let lr=(()=>{class n extends Vd{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:cZ++}),this.uuid=uo(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=n.DEFAULT_UP.clone();const t=new L,i=new lZ,r=new kr,s=new L(1,1,1);i._onChange(function o(){r.setFromEuler(i,!1)}),r._onChange(function a(){i.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new At},normalMatrix:{value:new Qt}}),this.matrix=new At,this.matrixWorld=new At,this.matrixAutoUpdate=n.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new $D,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,i){this.quaternion.setFromAxisAngle(t,i)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,i){return qp.setFromAxisAngle(t,i),this.quaternion.multiply(qp),this}rotateOnWorldAxis(t,i){return qp.setFromAxisAngle(t,i),this.quaternion.premultiply(qp),this}rotateX(t){return this.rotateOnAxis(C3,t)}rotateY(t){return this.rotateOnAxis(A3,t)}rotateZ(t){return this.rotateOnAxis(D3,t)}translateOnAxis(t,i){return T3.copy(t).applyQuaternion(this.quaternion),this.position.add(T3.multiplyScalar(i)),this}translateX(t){return this.translateOnAxis(C3,t)}translateY(t){return this.translateOnAxis(A3,t)}translateZ(t){return this.translateOnAxis(D3,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(Jl.copy(this.matrixWorld).invert())}lookAt(t,i,r){t.isVector3?CS.copy(t):CS.set(t,i,r);const s=this.parent;this.updateWorldMatrix(!0,!1),Py.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Jl.lookAt(Py,CS,this.up):Jl.lookAt(CS,Py,this.up),this.quaternion.setFromRotationMatrix(Jl),s&&(Jl.extractRotation(s.matrixWorld),qp.setFromRotationMatrix(Jl),this.quaternion.premultiply(qp.invert()))}add(t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(hZ)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const i=this.children.indexOf(t);return-1!==i&&(t.parent=null,this.children.splice(i,1),t.dispatchEvent(fZ)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),Jl.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),Jl.multiply(t.parent.matrixWorld)),t.applyMatrix4(Jl),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,i){if(this[t]===i)return this;for(let r=0,s=this.children.length;r<s;r++){const a=this.children[r].getObjectByProperty(t,i);if(void 0!==a)return a}}getObjectsByProperty(t,i){let r=[];this[t]===i&&r.push(this);for(let s=0,o=this.children.length;s<o;s++){const a=this.children[s].getObjectsByProperty(t,i);a.length>0&&(r=r.concat(a))}return r}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Py,t,uZ),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Py,dZ,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return t.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(t){t(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].traverseVisible(t)}traverseAncestors(t){const i=this.parent;null!==i&&(t(i),i.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const i=this.children;for(let r=0,s=i.length;r<s;r++){const o=i[r];(!0===o.matrixWorldAutoUpdate||!0===t)&&o.updateMatrixWorld(t)}}updateWorldMatrix(t,i){const r=this.parent;if(!0===t&&null!==r&&!0===r.matrixWorldAutoUpdate&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===i){const s=this.children;for(let o=0,a=s.length;o<a;o++){const l=s[o];!0===l.matrixWorldAutoUpdate&&l.updateWorldMatrix(!1,!0)}}}toJSON(t){const i=void 0===t||"string"==typeof t,r={};i&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const s={};function o(l,c){return void 0===l[c.uuid]&&(l[c.uuid]=c.toJSON(t)),c.uuid}if(s.uuid=this.uuid,s.type=this.type,""!==this.name&&(s.name=this.name),!0===this.castShadow&&(s.castShadow=!0),!0===this.receiveShadow&&(s.receiveShadow=!0),!1===this.visible&&(s.visible=!1),!1===this.frustumCulled&&(s.frustumCulled=!1),0!==this.renderOrder&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(s.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(s.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=o(t.geometries,this.geometry);const l=this.geometry.parameters;if(void 0!==l&&void 0!==l.shapes){const c=l.shapes;if(Array.isArray(c))for(let d=0,f=c.length;d<f;d++)o(t.shapes,c[d]);else o(t.shapes,c)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(o(t.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const l=[];for(let c=0,d=this.material.length;c<d;c++)l.push(o(t.materials,this.material[c]));s.material=l}else s.material=o(t.materials,this.material);if(this.children.length>0){s.children=[];for(let l=0;l<this.children.length;l++)s.children.push(this.children[l].toJSON(t).object)}if(this.animations.length>0){s.animations=[];for(let l=0;l<this.animations.length;l++)s.animations.push(o(t.animations,this.animations[l]))}if(i){const l=a(t.geometries),c=a(t.materials),d=a(t.textures),f=a(t.images),p=a(t.shapes),m=a(t.skeletons),_=a(t.animations),E=a(t.nodes);l.length>0&&(r.geometries=l),c.length>0&&(r.materials=c),d.length>0&&(r.textures=d),f.length>0&&(r.images=f),p.length>0&&(r.shapes=p),m.length>0&&(r.skeletons=m),_.length>0&&(r.animations=_),E.length>0&&(r.nodes=E)}return r.object=s,r;function a(l){const c=[];for(const d in l){const f=l[d];delete f.metadata,c.push(f)}return c}}clone(t){return(new this.constructor).copy(this,t)}copy(t,i=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),!0===i)for(let r=0;r<t.children.length;r++)this.add(t.children[r].clone());return this}}return n.DEFAULT_UP=new L(0,1,0),n.DEFAULT_MATRIX_AUTO_UPDATE=!0,n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,n})();const _a=new L,Ql=new L,jD=new L,ec=new L,Xp=new L,Yp=new L,I3=new L,qD=new L,XD=new L,YD=new L;let AS=!1;class fo{constructor(e=new L,t=new L,i=new L){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),_a.subVectors(e,t),r.cross(_a);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,i,r,s){_a.subVectors(r,t),Ql.subVectors(i,t),jD.subVectors(e,t);const o=_a.dot(_a),a=_a.dot(Ql),l=_a.dot(jD),c=Ql.dot(Ql),d=Ql.dot(jD),f=o*c-a*a;if(0===f)return s.set(-2,-1,-1);const p=1/f,m=(c*l-a*d)*p,_=(o*d-a*l)*p;return s.set(1-m-_,_,m)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,ec),ec.x>=0&&ec.y>=0&&ec.x+ec.y<=1}static getUV(e,t,i,r,s,o,a,l){return!1===AS&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),AS=!0),this.getInterpolation(e,t,i,r,s,o,a,l)}static getInterpolation(e,t,i,r,s,o,a,l){return this.getBarycoord(e,t,i,r,ec),l.setScalar(0),l.addScaledVector(s,ec.x),l.addScaledVector(o,ec.y),l.addScaledVector(a,ec.z),l}static isFrontFacing(e,t,i,r){return _a.subVectors(i,t),Ql.subVectors(e,t),_a.cross(Ql).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return _a.subVectors(this.c,this.b),Ql.subVectors(this.a,this.b),.5*_a.cross(Ql).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return fo.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return fo.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,r,s){return!1===AS&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),AS=!0),fo.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}getInterpolation(e,t,i,r,s){return fo.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}containsPoint(e){return fo.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return fo.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,s=this.c;let o,a;Xp.subVectors(r,i),Yp.subVectors(s,i),qD.subVectors(e,i);const l=Xp.dot(qD),c=Yp.dot(qD);if(l<=0&&c<=0)return t.copy(i);XD.subVectors(e,r);const d=Xp.dot(XD),f=Yp.dot(XD);if(d>=0&&f<=d)return t.copy(r);const p=l*f-d*c;if(p<=0&&l>=0&&d<=0)return o=l/(l-d),t.copy(i).addScaledVector(Xp,o);YD.subVectors(e,s);const m=Xp.dot(YD),_=Yp.dot(YD);if(_>=0&&m<=_)return t.copy(s);const E=m*c-l*_;if(E<=0&&c>=0&&_<=0)return a=c/(c-_),t.copy(i).addScaledVector(Yp,a);const v=d*_-m*f;if(v<=0&&f-d>=0&&m-_>=0)return I3.subVectors(s,r),a=(f-d)/(f-d+(m-_)),t.copy(r).addScaledVector(I3,a);const y=1/(v+E+p);return o=E*y,a=p*y,t.copy(i).addScaledVector(Xp,o).addScaledVector(Yp,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let pZ=0;class ya extends Vd{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:pZ++}),this.uuid=uo(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const i=e[t];if(void 0===i){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i:console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`)}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),void 0!==this.sheen&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(i.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(i.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(i.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(i.combine=this.combine)),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(i.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(i.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(i.size=this.size),null!==this.shadowSide&&(i.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(i.blending=this.blending),0!==this.side&&(i.side=this.side),!0===this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=!0),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.alphaHash&&(i.alphaHash=!0),!0===this.alphaToCoverage&&(i.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=!0),!0===this.forceSinglePass&&(i.forceSinglePass=!0),!0===this.wireframe&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(i.flatShading=!0),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),!1===this.fog&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData),t){const s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(null!==t){const r=t.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=t[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}const R3={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},gu={h:0,s:0,l:0},DS={h:0,s:0,l:0};function KD(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+6*(e-n)*t:t<.5?e:t<2/3?n+6*(e-n)*(2/3-t):n}class je{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(void 0===t&&void 0===i){const r=e;r&&r.isColor?this.copy(r):"number"==typeof r?this.setHex(r):"string"==typeof r&&this.setStyle(r)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=fi){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,Cn.toWorkingColorSpace(this,t),this}setRGB(e,t,i,r=Cn.workingColorSpace){return this.r=e,this.g=t,this.b=i,Cn.toWorkingColorSpace(this,r),this}setHSL(e,t,i,r=Cn.workingColorSpace){if(e=PD(e,1),t=Si(t,0,1),i=Si(i,0,1),0===t)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+t):i+t-i*t,o=2*i-s;this.r=KD(o,s,e+1/3),this.g=KD(o,s,e),this.b=KD(o,s,e-1/3)}return Cn.toWorkingColorSpace(this,r),this}setStyle(e,t=fi){function i(s){void 0!==s&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const a=r[2];switch(r[1]){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(3===o)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(6===o)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=fi){const i=R3[e.toLowerCase()];return void 0!==i?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Up(e.r),this.g=Up(e.g),this.b=Up(e.b),this}copyLinearToSRGB(e){return this.r=FD(e.r),this.g=FD(e.g),this.b=FD(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=fi){return Cn.fromWorkingColorSpace(Jr.copy(this),e),65536*Math.round(Si(255*Jr.r,0,255))+256*Math.round(Si(255*Jr.g,0,255))+Math.round(Si(255*Jr.b,0,255))}getHexString(e=fi){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Cn.workingColorSpace){Cn.fromWorkingColorSpace(Jr.copy(this),t);const i=Jr.r,r=Jr.g,s=Jr.b,o=Math.max(i,r,s),a=Math.min(i,r,s);let l,c;const d=(a+o)/2;if(a===o)l=0,c=0;else{const f=o-a;switch(c=d<=.5?f/(o+a):f/(2-o-a),o){case i:l=(r-s)/f+(r<s?6:0);break;case r:l=(s-i)/f+2;break;case s:l=(i-r)/f+4}l/=6}return e.h=l,e.s=c,e.l=d,e}getRGB(e,t=Cn.workingColorSpace){return Cn.fromWorkingColorSpace(Jr.copy(this),t),e.r=Jr.r,e.g=Jr.g,e.b=Jr.b,e}getStyle(e=fi){Cn.fromWorkingColorSpace(Jr.copy(this),e);const t=Jr.r,i=Jr.g,r=Jr.b;return e!==fi?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(255*t)},${Math.round(255*i)},${Math.round(255*r)})`}offsetHSL(e,t,i){return this.getHSL(gu),this.setHSL(gu.h+e,gu.s+t,gu.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(gu),e.getHSL(DS);const i=Cy(gu.h,DS.h,t),r=Cy(gu.s,DS.s,t),s=Cy(gu.l,DS.l,t);return this.setHSL(i,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,i=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*i+s[6]*r,this.g=s[1]*t+s[4]*i+s[7]*r,this.b=s[2]*t+s[5]*i+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Jr=new je;je.NAMES=R3;class Vs extends ya{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new je(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=cS,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Ki=new L,IS=new he;class wi{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=i,this.usage=35044,this.updateRange={offset:0,count:-1},this.gpuType=ql,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,i=this.count;t<i;t++)IS.fromBufferAttribute(this,t),IS.applyMatrix3(e),this.setXY(t,IS.x,IS.y);else if(3===this.itemSize)for(let t=0,i=this.count;t<i;t++)Ki.fromBufferAttribute(this,t),Ki.applyMatrix3(e),this.setXYZ(t,Ki.x,Ki.y,Ki.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)Ki.fromBufferAttribute(this,t),Ki.applyMatrix4(e),this.setXYZ(t,Ki.x,Ki.y,Ki.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Ki.fromBufferAttribute(this,t),Ki.applyNormalMatrix(e),this.setXYZ(t,Ki.x,Ki.y,Ki.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Ki.fromBufferAttribute(this,t),Ki.transformDirection(e),this.setXYZ(t,Ki.x,Ki.y,Ki.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=Bs(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=jt(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Bs(t,this.array)),t}setX(e,t){return this.normalized&&(t=jt(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Bs(t,this.array)),t}setY(e,t){return this.normalized&&(t=jt(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Bs(t,this.array)),t}setZ(e,t){return this.normalized&&(t=jt(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Bs(t,this.array)),t}setW(e,t){return this.normalized&&(t=jt(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=jt(t,this.array),i=jt(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=jt(t,this.array),i=jt(i,this.array),r=jt(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=jt(t,this.array),i=jt(i,this.array),r=jt(r,this.array),s=jt(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}}class P3 extends wi{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class N3 extends wi{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class st extends wi{constructor(e,t,i){super(new Float32Array(e),t,i)}}let gZ=0;const Vo=new At,ZD=new lr,Kp=new L,po=new el,Ly=new el,Mr=new L;class en extends Vd{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:gZ++}),this.uuid=uo(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(_3(e)?N3:P3)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(void 0!==i){const s=(new Qt).getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return Vo.makeRotationFromQuaternion(e),this.applyMatrix4(Vo),this}rotateX(e){return Vo.makeRotationX(e),this.applyMatrix4(Vo),this}rotateY(e){return Vo.makeRotationY(e),this.applyMatrix4(Vo),this}rotateZ(e){return Vo.makeRotationZ(e),this.applyMatrix4(Vo),this}translate(e,t,i){return Vo.makeTranslation(e,t,i),this.applyMatrix4(Vo),this}scale(e,t,i){return Vo.makeScale(e,t,i),this.applyMatrix4(Vo),this}lookAt(e){return ZD.lookAt(e),ZD.updateMatrix(),this.applyMatrix4(ZD.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Kp).negate(),this.translate(Kp.x,Kp.y,Kp.z),this}setFromPoints(e){const t=[];for(let i=0,r=e.length;i<r;i++){const s=e[i];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new st(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new el);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new L(-1/0,-1/0,-1/0),new L(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++)po.setFromBufferAttribute(t[i]),this.morphTargetsRelative?(Mr.addVectors(this.boundingBox.min,po.min),this.boundingBox.expandByPoint(Mr),Mr.addVectors(this.boundingBox.max,po.max),this.boundingBox.expandByPoint(Mr)):(this.boundingBox.expandByPoint(po.min),this.boundingBox.expandByPoint(po.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new ma);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new L,1/0);if(e){const i=this.boundingSphere.center;if(po.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++)Ly.setFromBufferAttribute(t[s]),this.morphTargetsRelative?(Mr.addVectors(po.min,Ly.min),po.expandByPoint(Mr),Mr.addVectors(po.max,Ly.max),po.expandByPoint(Mr)):(po.expandByPoint(Ly.min),po.expandByPoint(Ly.max));po.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)Mr.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(Mr));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let c=0,d=a.count;c<d;c++)Mr.fromBufferAttribute(a,c),l&&(Kp.fromBufferAttribute(e,c),Mr.add(Kp)),r=Math.max(r,i.distanceToSquared(Mr))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const i=e.array,r=t.position.array,s=t.normal.array,o=t.uv.array,a=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new wi(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,c=[],d=[];for(let N=0;N<a;N++)c[N]=new L,d[N]=new L;const f=new L,p=new L,m=new L,_=new he,E=new he,v=new he,y=new L,S=new L;function b(N,K,oe){f.fromArray(r,3*N),p.fromArray(r,3*K),m.fromArray(r,3*oe),_.fromArray(o,2*N),E.fromArray(o,2*K),v.fromArray(o,2*oe),p.sub(f),m.sub(f),E.sub(_),v.sub(_);const ue=1/(E.x*v.y-v.x*E.y);isFinite(ue)&&(y.copy(p).multiplyScalar(v.y).addScaledVector(m,-E.y).multiplyScalar(ue),S.copy(m).multiplyScalar(E.x).addScaledVector(p,-v.x).multiplyScalar(ue),c[N].add(y),c[K].add(y),c[oe].add(y),d[N].add(S),d[K].add(S),d[oe].add(S))}let M=this.groups;0===M.length&&(M=[{start:0,count:i.length}]);for(let N=0,K=M.length;N<K;++N){const oe=M[N],ue=oe.start;for(let J=ue,$=ue+oe.count;J<$;J+=3)b(i[J+0],i[J+1],i[J+2])}const T=new L,I=new L,A=new L,F=new L;function C(N){A.fromArray(s,3*N),F.copy(A);const K=c[N];T.copy(K),T.sub(A.multiplyScalar(A.dot(K))).normalize(),I.crossVectors(F,K);const ue=I.dot(d[N])<0?-1:1;l[4*N]=T.x,l[4*N+1]=T.y,l[4*N+2]=T.z,l[4*N+3]=ue}for(let N=0,K=M.length;N<K;++N){const oe=M[N],ue=oe.start;for(let J=ue,$=ue+oe.count;J<$;J+=3)C(i[J+0]),C(i[J+1]),C(i[J+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let i=this.getAttribute("normal");if(void 0===i)i=new wi(new Float32Array(3*t.count),3),this.setAttribute("normal",i);else for(let p=0,m=i.count;p<m;p++)i.setXYZ(p,0,0,0);const r=new L,s=new L,o=new L,a=new L,l=new L,c=new L,d=new L,f=new L;if(e)for(let p=0,m=e.count;p<m;p+=3){const _=e.getX(p+0),E=e.getX(p+1),v=e.getX(p+2);r.fromBufferAttribute(t,_),s.fromBufferAttribute(t,E),o.fromBufferAttribute(t,v),d.subVectors(o,s),f.subVectors(r,s),d.cross(f),a.fromBufferAttribute(i,_),l.fromBufferAttribute(i,E),c.fromBufferAttribute(i,v),a.add(d),l.add(d),c.add(d),i.setXYZ(_,a.x,a.y,a.z),i.setXYZ(E,l.x,l.y,l.z),i.setXYZ(v,c.x,c.y,c.z)}else for(let p=0,m=t.count;p<m;p+=3)r.fromBufferAttribute(t,p+0),s.fromBufferAttribute(t,p+1),o.fromBufferAttribute(t,p+2),d.subVectors(o,s),f.subVectors(r,s),d.cross(f),i.setXYZ(p+0,d.x,d.y,d.z),i.setXYZ(p+1,d.x,d.y,d.z),i.setXYZ(p+2,d.x,d.y,d.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)Mr.fromBufferAttribute(e,t),Mr.normalize(),e.setXYZ(t,Mr.x,Mr.y,Mr.z)}toNonIndexed(){function e(a,l){const c=a.array,d=a.itemSize,f=a.normalized,p=new c.constructor(l.length*d);let m=0,_=0;for(let E=0,v=l.length;E<v;E++){m=a.isInterleavedBufferAttribute?l[E]*a.data.stride+a.offset:l[E]*d;for(let y=0;y<d;y++)p[_++]=c[m++]}return new wi(p,d,f)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new en,i=this.index.array,r=this.attributes;for(const a in r){const c=e(r[a],i);t.setAttribute(a,c)}const s=this.morphAttributes;for(const a in s){const l=[],c=s[a];for(let d=0,f=c.length;d<f;d++){const m=e(c[d],i);l.push(m)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const c=o[a];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const l=this.parameters;for(const c in l)void 0!==l[c]&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const l in i)e.data.attributes[l]=i[l].toJSON(e.data);const r={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],d=[];for(let f=0,p=c.length;f<p;f++)d.push(c[f].toJSON(e.data));d.length>0&&(r[l]=d,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return null!==a&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;null!==i&&this.setIndex(i.clone(t));const r=e.attributes;for(const c in r)this.setAttribute(c,r[c].clone(t));const s=e.morphAttributes;for(const c in s){const d=[],f=s[c];for(let p=0,m=f.length;p<m;p++)d.push(f[p].clone(t));this.morphAttributes[c]=d}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let c=0,d=o.length;c<d;c++){const f=o[c];this.addGroup(f.start,f.count,f.materialIndex)}const a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());const l=e.boundingSphere;return null!==l&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const L3=new At,$d=new $p,RS=new ma,O3=new L,Zp=new L,Jp=new L,Qp=new L,JD=new L,PS=new L,NS=new he,LS=new he,OS=new he,F3=new L,k3=new L,U3=new L,FS=new L,kS=new L;class xr extends lr{constructor(e=new en,t=new Vs){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){const i=this.geometry,s=i.morphAttributes.position,o=i.morphTargetsRelative;t.fromBufferAttribute(i.attributes.position,e);const a=this.morphTargetInfluences;if(s&&a){PS.set(0,0,0);for(let l=0,c=s.length;l<c;l++){const d=a[l];0!==d&&(JD.fromBufferAttribute(s[l],e),PS.addScaledVector(o?JD:JD.sub(t),d))}t.add(PS)}return t}raycast(e,t){const i=this.geometry,s=this.matrixWorld;void 0!==this.material&&(null===i.boundingSphere&&i.computeBoundingSphere(),RS.copy(i.boundingSphere),RS.applyMatrix4(s),$d.copy(e.ray).recast(e.near),(!1!==RS.containsPoint($d.origin)||!(null===$d.intersectSphere(RS,O3)||$d.origin.distanceToSquared(O3)>(e.far-e.near)**2))&&(L3.copy(s).invert(),$d.copy(e.ray).applyMatrix4(L3),(null===i.boundingBox||!1!==$d.intersectsBox(i.boundingBox))&&this._computeIntersections(e,t,$d)))}_computeIntersections(e,t,i){let r;const s=this.geometry,o=this.material,a=s.index,l=s.attributes.position,c=s.attributes.uv,d=s.attributes.uv1,f=s.attributes.normal,p=s.groups,m=s.drawRange;if(null!==a)if(Array.isArray(o))for(let _=0,E=p.length;_<E;_++){const v=p[_],y=o[v.materialIndex];for(let M=Math.max(v.start,m.start),T=Math.min(a.count,Math.min(v.start+v.count,m.start+m.count));M<T;M+=3)r=US(this,y,e,i,c,d,f,a.getX(M),a.getX(M+1),a.getX(M+2)),r&&(r.faceIndex=Math.floor(M/3),r.face.materialIndex=v.materialIndex,t.push(r))}else for(let v=Math.max(0,m.start),y=Math.min(a.count,m.start+m.count);v<y;v+=3)r=US(this,o,e,i,c,d,f,a.getX(v),a.getX(v+1),a.getX(v+2)),r&&(r.faceIndex=Math.floor(v/3),t.push(r));else if(void 0!==l)if(Array.isArray(o))for(let _=0,E=p.length;_<E;_++){const v=p[_],y=o[v.materialIndex];for(let M=Math.max(v.start,m.start),T=Math.min(l.count,Math.min(v.start+v.count,m.start+m.count));M<T;M+=3)r=US(this,y,e,i,c,d,f,M,M+1,M+2),r&&(r.faceIndex=Math.floor(M/3),r.face.materialIndex=v.materialIndex,t.push(r))}else for(let v=Math.max(0,m.start),y=Math.min(l.count,m.start+m.count);v<y;v+=3)r=US(this,o,e,i,c,d,f,v,v+1,v+2),r&&(r.faceIndex=Math.floor(v/3),t.push(r))}}function US(n,e,t,i,r,s,o,a,l,c){n.getVertexPosition(a,Zp),n.getVertexPosition(l,Jp),n.getVertexPosition(c,Qp);const d=function _Z(n,e,t,i,r,s,o,a){let l;if(l=1===e.side?i.intersectTriangle(o,s,r,!0,a):i.intersectTriangle(r,s,o,0===e.side,a),null===l)return null;kS.copy(a),kS.applyMatrix4(n.matrixWorld);const c=t.ray.origin.distanceTo(kS);return c<t.near||c>t.far?null:{distance:c,point:kS.clone(),object:n}}(n,e,t,i,Zp,Jp,Qp,FS);if(d){r&&(NS.fromBufferAttribute(r,a),LS.fromBufferAttribute(r,l),OS.fromBufferAttribute(r,c),d.uv=fo.getInterpolation(FS,Zp,Jp,Qp,NS,LS,OS,new he)),s&&(NS.fromBufferAttribute(s,a),LS.fromBufferAttribute(s,l),OS.fromBufferAttribute(s,c),d.uv1=fo.getInterpolation(FS,Zp,Jp,Qp,NS,LS,OS,new he),d.uv2=d.uv1),o&&(F3.fromBufferAttribute(o,a),k3.fromBufferAttribute(o,l),U3.fromBufferAttribute(o,c),d.normal=fo.getInterpolation(FS,Zp,Jp,Qp,F3,k3,U3,new L),d.normal.dot(i.direction)>0&&d.normal.multiplyScalar(-1));const f={a,b:l,c,normal:new L,materialIndex:0};fo.getNormal(Zp,Jp,Qp,f.normal),d.face=f}return d}class jd extends en{constructor(e=1,t=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],c=[],d=[],f=[];let p=0,m=0;function _(E,v,y,S,b,M,T,I,A,F,C){const N=M/A,K=T/F,oe=M/2,ue=T/2,W=I/2,J=A+1,$=F+1;let Y=0,ie=0;const Z=new L;for(let de=0;de<$;de++){const q=de*K-ue;for(let se=0;se<J;se++)Z[E]=(se*N-oe)*S,Z[v]=q*b,Z[y]=W,c.push(Z.x,Z.y,Z.z),Z[E]=0,Z[v]=0,Z[y]=I>0?1:-1,d.push(Z.x,Z.y,Z.z),f.push(se/A),f.push(1-de/F),Y+=1}for(let de=0;de<F;de++)for(let q=0;q<A;q++){const xe=p+q+J*(de+1),Se=p+(q+1)+J*(de+1),ze=p+(q+1)+J*de;l.push(p+q+J*de,xe,ze),l.push(xe,Se,ze),ie+=6}a.addGroup(m,ie,C),m+=ie,p+=Y}_("z","y","x",-1,-1,i,t,e,o,s,0),_("z","y","x",1,-1,i,t,-e,o,s,1),_("x","z","y",1,1,e,i,t,r,o,2),_("x","z","y",1,-1,e,i,-t,r,o,3),_("x","y","z",1,-1,e,t,i,r,s,4),_("x","y","z",-1,-1,e,t,-i,r,s,5),this.setIndex(l),this.setAttribute("position",new st(c,3)),this.setAttribute("normal",new st(d,3)),this.setAttribute("uv",new st(f,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new jd(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function em(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=r.clone():e[t][i]=Array.isArray(r)?r.slice():r}}return e}function ys(n){const e={};for(let t=0;t<n.length;t++){const i=em(n[t]);for(const r in i)e[r]=i[r]}return e}function B3(n){return null===n.getRenderTarget()?n.outputColorSpace:Cn.workingColorSpace}const vZ={clone:em,merge:ys};class _u extends ya{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=em(e.uniforms),this.uniformsGroups=function yZ(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;t.uniforms[r]=o&&o.isTexture?{type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?{type:"c",value:o.getHex()}:o&&o.isVector2?{type:"v2",value:o.toArray()}:o&&o.isVector3?{type:"v3",value:o.toArray()}:o&&o.isVector4?{type:"v4",value:o.toArray()}:o&&o.isMatrix3?{type:"m3",value:o.toArray()}:o&&o.isMatrix4?{type:"m4",value:o.toArray()}:{value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const i={};for(const r in this.extensions)!0===this.extensions[r]&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class QD extends lr{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new At,this.projectionMatrix=new At,this.projectionMatrixInverse=new At,this.coordinateSystem=Xl}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class Tr extends QD{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*Fp*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*Hd*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*Fp*Math.atan(Math.tan(.5*Hd*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,r,s,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*Hd*this.fov)/this.zoom,i=2*t,r=this.aspect*i,s=-.5*r;const o=this.view;if(null!==this.view&&this.view.enabled){const l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*r/l,t-=o.offsetY*i/c,r*=o.width/l,i*=o.height/c}const a=this.filmOffset;0!==a&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class SZ extends lr{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new Tr(-90,1,e,t);r.layers=this.layers,this.add(r);const s=new Tr(-90,1,e,t);s.layers=this.layers,this.add(s);const o=new Tr(-90,1,e,t);o.layers=this.layers,this.add(o);const a=new Tr(-90,1,e,t);a.layers=this.layers,this.add(a);const l=new Tr(-90,1,e,t);l.layers=this.layers,this.add(l);const c=new Tr(-90,1,e,t);c.layers=this.layers,this.add(c)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[i,r,s,o,a,l]=t;for(const c of t)this.remove(c);if(e===Xl)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else{if(2001!==e)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1)}for(const c of t)this.add(c),c.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,o,a,l,c,d]=this.children,f=e.getRenderTarget(),p=e.getActiveCubeFace(),m=e.getActiveMipmapLevel(),_=e.xr.enabled;e.xr.enabled=!1;const E=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,r),e.render(t,s),e.setRenderTarget(i,1,r),e.render(t,o),e.setRenderTarget(i,2,r),e.render(t,a),e.setRenderTarget(i,3,r),e.render(t,l),e.setRenderTarget(i,4,r),e.render(t,c),i.texture.generateMipmaps=E,e.setRenderTarget(i,5,r),e.render(t,d),e.setRenderTarget(f,p,m),e.xr.enabled=_,i.texture.needsPMREMUpdate=!0}}class BS extends pa{constructor(e,t,i,r,s,o,a,l,c,d){super(e=void 0!==e?e:[],t=void 0!==t?t:cu,i,r,s,o,a,l,c,d),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class wZ extends zd{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];void 0!==t.encoding&&(Dy("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),t.colorSpace=t.encoding===Ud?fi:""),this.texture=new BS(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:bi}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i_uniforms={tEquirect:{value:null}},i_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",r=new jd(5,5,5),s=new _u({name:"CubemapFromEquirect",uniforms:em(i_uniforms),vertexShader:i_vertexShader,fragmentShader:i_fragmentShader,side:1,blending:0});s.uniforms.tEquirect.value=t;const o=new xr(r,s),a=t.minFilter;return t.minFilter===jl&&(t.minFilter=bi),new SZ(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,i,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,i,r);e.setRenderTarget(s)}}const e1=new L,MZ=new L,xZ=new Qt;class yu{constructor(e=new L(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=e1.subVectors(i,t).cross(MZ.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(e1),r=this.normal.dot(i);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(i,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||xZ.getNormalMatrix(e),r=this.coplanarPoint(e1).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const qd=new ma,VS=new L;class t1{constructor(e=new yu,t=new yu,i=new yu,r=new yu,s=new yu,o=new yu){this.planes=[e,t,i,r,s,o]}set(e,t,i,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=Xl){const i=this.planes,r=e.elements,s=r[0],o=r[1],a=r[2],l=r[3],c=r[4],d=r[5],f=r[6],p=r[7],m=r[8],_=r[9],E=r[10],v=r[11],y=r[12],S=r[13],b=r[14],M=r[15];if(i[0].setComponents(l-s,p-c,v-m,M-y).normalize(),i[1].setComponents(l+s,p+c,v+m,M+y).normalize(),i[2].setComponents(l+o,p+d,v+_,M+S).normalize(),i[3].setComponents(l-o,p-d,v-_,M-S).normalize(),i[4].setComponents(l-a,p-f,v-E,M-b).normalize(),t===Xl)i[5].setComponents(l+a,p+f,v+E,M+b).normalize();else{if(2001!==t)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);i[5].setComponents(a,f,E,b).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),qd.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),qd.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(qd)}intersectsSprite(e){return qd.center.set(0,0,0),qd.radius=.7071067811865476,qd.applyMatrix4(e.matrixWorld),this.intersectsSphere(qd)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(VS.x=r.normal.x>0?e.max.x:e.min.x,VS.y=r.normal.y>0?e.max.y:e.min.y,VS.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(VS)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function V3(){let n=null,e=!1,t=null,i=null;function r(s,o){t(s,o),i=n.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==t&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function TZ(n,e){const t=e.isWebGL2,i=new WeakMap;return{get:function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),i.get(c)},remove:function a(c){c.isInterleavedBufferAttribute&&(c=c.data);const d=i.get(c);d&&(n.deleteBuffer(d.buffer),i.delete(c))},update:function l(c,d){if(c.isGLBufferAttribute){const p=i.get(c);return void((!p||p.version<c.version)&&i.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version}))}c.isInterleavedBufferAttribute&&(c=c.data);const f=i.get(c);void 0===f?i.set(c,function r(c,d){const f=c.array,p=c.usage,m=n.createBuffer();let _;if(n.bindBuffer(d,m),n.bufferData(d,f,p),c.onUploadCallback(),f instanceof Float32Array)_=n.FLOAT;else if(f instanceof Uint16Array)if(c.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");_=n.HALF_FLOAT}else _=n.UNSIGNED_SHORT;else if(f instanceof Int16Array)_=n.SHORT;else if(f instanceof Uint32Array)_=n.UNSIGNED_INT;else if(f instanceof Int32Array)_=n.INT;else if(f instanceof Int8Array)_=n.BYTE;else if(f instanceof Uint8Array)_=n.UNSIGNED_BYTE;else{if(!(f instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+f);_=n.UNSIGNED_BYTE}return{buffer:m,type:_,bytesPerElement:f.BYTES_PER_ELEMENT,version:c.version}}(c,d)):f.version<c.version&&(function s(c,d,f){const p=d.array,m=d.updateRange;n.bindBuffer(f,c),-1===m.count?n.bufferSubData(f,0,p):(t?n.bufferSubData(f,m.offset*p.BYTES_PER_ELEMENT,p,m.offset,m.count):n.bufferSubData(f,m.offset*p.BYTES_PER_ELEMENT,p.subarray(m.offset,m.offset+m.count)),m.count=-1),d.onUploadCallback()}(f.buffer,c,d),f.version=c.version)}}}class HS extends en{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(i),l=Math.floor(r),c=a+1,d=l+1,f=e/a,p=t/l,m=[],_=[],E=[],v=[];for(let y=0;y<d;y++){const S=y*p-o;for(let b=0;b<c;b++)_.push(b*f-s,-S,0),E.push(0,0,1),v.push(b/a),v.push(1-y/l)}for(let y=0;y<l;y++)for(let S=0;S<a;S++){const M=S+c*(y+1),T=S+1+c*(y+1),I=S+1+c*y;m.push(S+c*y,M,I),m.push(M,T,I)}this.setIndex(m),this.setAttribute("position",new st(_,3)),this.setAttribute("normal",new st(E,3)),this.setAttribute("uv",new st(v,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new HS(e.width,e.height,e.widthSegments,e.heightSegments)}}const Yt={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"\nconst mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(\n\tvec3( 0.8224621, 0.177538, 0.0 ),\n\tvec3( 0.0331941, 0.9668058, 0.0 ),\n\tvec3( 0.0170827, 0.0723974, 0.9105199 )\n);\nconst mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.2249401, - 0.2249404, 0.0 ),\n\tvec3( - 0.0420569, 1.0420571, 0.0 ),\n\tvec3( - 0.0196376, - 0.0786361, 1.0982735 )\n);\nvec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );\n}\nvec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );\n}\nvec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn sRGBTransferOETF( value );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tanisotropyV /= material.anisotropy;\n\tmaterial.anisotropy = saturate( material.anisotropy );\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x - tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x + tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal;\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},He={common:{diffuse:{value:new je(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Qt},alphaMap:{value:null},alphaMapTransform:{value:new Qt},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Qt}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Qt}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Qt}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Qt},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Qt},normalScale:{value:new he(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Qt},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Qt}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Qt}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Qt}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new je(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new je(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Qt},alphaTest:{value:0},uvTransform:{value:new Qt}},sprite:{diffuse:{value:new je(16777215)},opacity:{value:1},center:{value:new he(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Qt},alphaMap:{value:null},alphaMapTransform:{value:new Qt},alphaTest:{value:0}}},tl={basic:{uniforms:ys([He.common,He.specularmap,He.envmap,He.aomap,He.lightmap,He.fog]),vertexShader:Yt.meshbasic_vert,fragmentShader:Yt.meshbasic_frag},lambert:{uniforms:ys([He.common,He.specularmap,He.envmap,He.aomap,He.lightmap,He.emissivemap,He.bumpmap,He.normalmap,He.displacementmap,He.fog,He.lights,{emissive:{value:new je(0)}}]),vertexShader:Yt.meshlambert_vert,fragmentShader:Yt.meshlambert_frag},phong:{uniforms:ys([He.common,He.specularmap,He.envmap,He.aomap,He.lightmap,He.emissivemap,He.bumpmap,He.normalmap,He.displacementmap,He.fog,He.lights,{emissive:{value:new je(0)},specular:{value:new je(1118481)},shininess:{value:30}}]),vertexShader:Yt.meshphong_vert,fragmentShader:Yt.meshphong_frag},standard:{uniforms:ys([He.common,He.envmap,He.aomap,He.lightmap,He.emissivemap,He.bumpmap,He.normalmap,He.displacementmap,He.roughnessmap,He.metalnessmap,He.fog,He.lights,{emissive:{value:new je(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Yt.meshphysical_vert,fragmentShader:Yt.meshphysical_frag},toon:{uniforms:ys([He.common,He.aomap,He.lightmap,He.emissivemap,He.bumpmap,He.normalmap,He.displacementmap,He.gradientmap,He.fog,He.lights,{emissive:{value:new je(0)}}]),vertexShader:Yt.meshtoon_vert,fragmentShader:Yt.meshtoon_frag},matcap:{uniforms:ys([He.common,He.bumpmap,He.normalmap,He.displacementmap,He.fog,{matcap:{value:null}}]),vertexShader:Yt.meshmatcap_vert,fragmentShader:Yt.meshmatcap_frag},points:{uniforms:ys([He.points,He.fog]),vertexShader:Yt.points_vert,fragmentShader:Yt.points_frag},dashed:{uniforms:ys([He.common,He.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Yt.linedashed_vert,fragmentShader:Yt.linedashed_frag},depth:{uniforms:ys([He.common,He.displacementmap]),vertexShader:Yt.depth_vert,fragmentShader:Yt.depth_frag},normal:{uniforms:ys([He.common,He.bumpmap,He.normalmap,He.displacementmap,{opacity:{value:1}}]),vertexShader:Yt.meshnormal_vert,fragmentShader:Yt.meshnormal_frag},sprite:{uniforms:ys([He.sprite,He.fog]),vertexShader:Yt.sprite_vert,fragmentShader:Yt.sprite_frag},background:{uniforms:{uvTransform:{value:new Qt},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Yt.background_vert,fragmentShader:Yt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Yt.backgroundCube_vert,fragmentShader:Yt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Yt.cube_vert,fragmentShader:Yt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Yt.equirect_vert,fragmentShader:Yt.equirect_frag},distanceRGBA:{uniforms:ys([He.common,He.displacementmap,{referencePosition:{value:new L},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Yt.distanceRGBA_vert,fragmentShader:Yt.distanceRGBA_frag},shadow:{uniforms:ys([He.lights,He.fog,{color:{value:new je(0)},opacity:{value:1}}]),vertexShader:Yt.shadow_vert,fragmentShader:Yt.shadow_frag}};tl.physical={uniforms:ys([tl.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Qt},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Qt},clearcoatNormalScale:{value:new he(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Qt},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Qt},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Qt},sheen:{value:0},sheenColor:{value:new je(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Qt},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Qt},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Qt},transmissionSamplerSize:{value:new he},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Qt},attenuationDistance:{value:0},attenuationColor:{value:new je(0)},specularColor:{value:new je(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Qt},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Qt},anisotropyVector:{value:new he},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Qt}}]),vertexShader:Yt.meshphysical_vert,fragmentShader:Yt.meshphysical_frag};const zS={r:0,b:0,g:0};function MQ(n,e,t,i,r,s,o){const a=new je(0);let c,d,l=!0===s?0:1,f=null,p=0,m=null;function E(v,y){v.getRGB(zS,B3(n)),i.buffers.color.setClear(zS.r,zS.g,zS.b,y,o)}return{getClearColor:function(){return a},setClearColor:function(v,y=1){a.set(v),l=y,E(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(v){l=v,E(a,l)},render:function _(v,y){let S=!1,b=!0===y.isScene?y.background:null;b&&b.isTexture&&(b=(y.backgroundBlurriness>0?t:e).get(b)),null===b?E(a,l):b&&b.isColor&&(E(b,1),S=!0);const M=n.xr.getEnvironmentBlendMode();"additive"===M?i.buffers.color.setClear(0,0,0,1,o):"alpha-blend"===M&&i.buffers.color.setClear(0,0,0,0,o),(n.autoClear||S)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),b&&(b.isCubeTexture||b.mapping===Sy)?(void 0===d&&(d=new xr(new jd(1,1,1),new _u({name:"BackgroundCubeMaterial",uniforms:em(tl.backgroundCube.uniforms),vertexShader:tl.backgroundCube.vertexShader,fragmentShader:tl.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),d.geometry.deleteAttribute("normal"),d.geometry.deleteAttribute("uv"),d.onBeforeRender=function(T,I,A){this.matrixWorld.copyPosition(A.matrixWorld)},Object.defineProperty(d.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(d)),d.material.uniforms.envMap.value=b,d.material.uniforms.flipEnvMap.value=b.isCubeTexture&&!1===b.isRenderTargetTexture?-1:1,d.material.uniforms.backgroundBlurriness.value=y.backgroundBlurriness,d.material.uniforms.backgroundIntensity.value=y.backgroundIntensity,d.material.toneMapped=Cn.getTransfer(b.colorSpace)!==ri,(f!==b||p!==b.version||m!==n.toneMapping)&&(d.material.needsUpdate=!0,f=b,p=b.version,m=n.toneMapping),d.layers.enableAll(),v.unshift(d,d.geometry,d.material,0,0,null)):b&&b.isTexture&&(void 0===c&&(c=new xr(new HS(2,2),new _u({name:"BackgroundMaterial",uniforms:em(tl.background.uniforms),vertexShader:tl.background.vertexShader,fragmentShader:tl.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=b,c.material.uniforms.backgroundIntensity.value=y.backgroundIntensity,c.material.toneMapped=Cn.getTransfer(b.colorSpace)!==ri,!0===b.matrixAutoUpdate&&b.updateMatrix(),c.material.uniforms.uvTransform.value.copy(b.matrix),(f!==b||p!==b.version||m!==n.toneMapping)&&(c.material.needsUpdate=!0,f=b,p=b.version,m=n.toneMapping),c.layers.enableAll(),v.unshift(c,c.geometry,c.material,0,0,null))}}}function xQ(n,e,t,i){const r=n.getParameter(n.MAX_VERTEX_ATTRIBS),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),o=i.isWebGL2||null!==s,a={},l=v(null);let c=l,d=!1;function m(W){return i.isWebGL2?n.bindVertexArray(W):s.bindVertexArrayOES(W)}function _(W){return i.isWebGL2?n.deleteVertexArray(W):s.deleteVertexArrayOES(W)}function v(W){const J=[],$=[],Y=[];for(let ie=0;ie<r;ie++)J[ie]=0,$[ie]=0,Y[ie]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:J,enabledAttributes:$,attributeDivisors:Y,object:W,attributes:{},index:null}}function b(){const W=c.newAttributes;for(let J=0,$=W.length;J<$;J++)W[J]=0}function M(W){T(W,0)}function T(W,J){const Y=c.enabledAttributes,ie=c.attributeDivisors;c.newAttributes[W]=1,0===Y[W]&&(n.enableVertexAttribArray(W),Y[W]=1),ie[W]!==J&&((i.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](W,J),ie[W]=J)}function I(){const W=c.newAttributes,J=c.enabledAttributes;for(let $=0,Y=J.length;$<Y;$++)J[$]!==W[$]&&(n.disableVertexAttribArray($),J[$]=0)}function A(W,J,$,Y,ie,Z,de){!0===de?n.vertexAttribIPointer(W,J,$,ie,Z):n.vertexAttribPointer(W,J,$,Y,ie,Z)}function oe(){ue(),d=!0,c!==l&&(c=l,m(c.object))}function ue(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function f(W,J,$,Y,ie){let Z=!1;if(o){const de=function E(W,J,$){const Y=!0===$.wireframe;let ie=a[W.id];void 0===ie&&(ie={},a[W.id]=ie);let Z=ie[J.id];void 0===Z&&(Z={},ie[J.id]=Z);let de=Z[Y];return void 0===de&&(de=v(function p(){return i.isWebGL2?n.createVertexArray():s.createVertexArrayOES()}()),Z[Y]=de),de}(Y,$,J);c!==de&&(c=de,m(c.object)),Z=function y(W,J,$,Y){const ie=c.attributes,Z=J.attributes;let de=0;const q=$.getAttributes();for(const se in q)if(q[se].location>=0){const Se=ie[se];let ze=Z[se];if(void 0===ze&&("instanceMatrix"===se&&W.instanceMatrix&&(ze=W.instanceMatrix),"instanceColor"===se&&W.instanceColor&&(ze=W.instanceColor)),void 0===Se||Se.attribute!==ze||ze&&Se.data!==ze.data)return!0;de++}return c.attributesNum!==de||c.index!==Y}(W,Y,$,ie),Z&&function S(W,J,$,Y){const ie={},Z=J.attributes;let de=0;const q=$.getAttributes();for(const se in q)if(q[se].location>=0){let Se=Z[se];void 0===Se&&("instanceMatrix"===se&&W.instanceMatrix&&(Se=W.instanceMatrix),"instanceColor"===se&&W.instanceColor&&(Se=W.instanceColor));const ze={};ze.attribute=Se,Se&&Se.data&&(ze.data=Se.data),ie[se]=ze,de++}c.attributes=ie,c.attributesNum=de,c.index=Y}(W,Y,$,ie)}else{const de=!0===J.wireframe;(c.geometry!==Y.id||c.program!==$.id||c.wireframe!==de)&&(c.geometry=Y.id,c.program=$.id,c.wireframe=de,Z=!0)}null!==ie&&t.update(ie,n.ELEMENT_ARRAY_BUFFER),(Z||d)&&(d=!1,function F(W,J,$,Y){if(!1===i.isWebGL2&&(W.isInstancedMesh||Y.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;b();const ie=Y.attributes,Z=$.getAttributes(),de=J.defaultAttributeValues;for(const q in Z){const se=Z[q];if(se.location>=0){let xe=ie[q];if(void 0===xe&&("instanceMatrix"===q&&W.instanceMatrix&&(xe=W.instanceMatrix),"instanceColor"===q&&W.instanceColor&&(xe=W.instanceColor)),void 0!==xe){const Se=xe.normalized,ze=xe.itemSize,nt=t.get(xe);if(void 0===nt)continue;const Ge=nt.buffer,Ze=nt.type,St=nt.bytesPerElement,Kt=!0===i.isWebGL2&&(Ze===n.INT||Ze===n.UNSIGNED_INT||1013===xe.gpuType);if(xe.isInterleavedBufferAttribute){const lt=xe.data,H=lt.stride,Pe=xe.offset;if(lt.isInstancedInterleavedBuffer){for(let _e=0;_e<se.locationSize;_e++)T(se.location+_e,lt.meshPerAttribute);!0!==W.isInstancedMesh&&void 0===Y._maxInstanceCount&&(Y._maxInstanceCount=lt.meshPerAttribute*lt.count)}else for(let _e=0;_e<se.locationSize;_e++)M(se.location+_e);n.bindBuffer(n.ARRAY_BUFFER,Ge);for(let _e=0;_e<se.locationSize;_e++)A(se.location+_e,ze/se.locationSize,Ze,Se,H*St,(Pe+ze/se.locationSize*_e)*St,Kt)}else{if(xe.isInstancedBufferAttribute){for(let lt=0;lt<se.locationSize;lt++)T(se.location+lt,xe.meshPerAttribute);!0!==W.isInstancedMesh&&void 0===Y._maxInstanceCount&&(Y._maxInstanceCount=xe.meshPerAttribute*xe.count)}else for(let lt=0;lt<se.locationSize;lt++)M(se.location+lt);n.bindBuffer(n.ARRAY_BUFFER,Ge);for(let lt=0;lt<se.locationSize;lt++)A(se.location+lt,ze/se.locationSize,Ze,Se,ze*St,ze/se.locationSize*lt*St,Kt)}}else if(void 0!==de){const Se=de[q];if(void 0!==Se)switch(Se.length){case 2:n.vertexAttrib2fv(se.location,Se);break;case 3:n.vertexAttrib3fv(se.location,Se);break;case 4:n.vertexAttrib4fv(se.location,Se);break;default:n.vertexAttrib1fv(se.location,Se)}}}}I()}(W,J,$,Y),null!==ie&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.get(ie).buffer))},reset:oe,resetDefaultState:ue,dispose:function C(){oe();for(const W in a){const J=a[W];for(const $ in J){const Y=J[$];for(const ie in Y)_(Y[ie].object),delete Y[ie];delete J[$]}delete a[W]}},releaseStatesOfGeometry:function N(W){if(void 0===a[W.id])return;const J=a[W.id];for(const $ in J){const Y=J[$];for(const ie in Y)_(Y[ie].object),delete Y[ie];delete J[$]}delete a[W.id]},releaseStatesOfProgram:function K(W){for(const J in a){const $=a[J];if(void 0===$[W.id])continue;const Y=$[W.id];for(const ie in Y)_(Y[ie].object),delete Y[ie];delete $[W.id]}},initAttributes:b,enableAttribute:M,disableUnusedAttributes:I}}function TQ(n,e,t,i){const r=i.isWebGL2;let s;this.setMode=function o(c){s=c},this.render=function a(c,d){n.drawArrays(s,c,d),t.update(d,s,1)},this.renderInstances=function l(c,d,f){if(0===f)return;let p,m;if(r)p=n,m="drawArraysInstanced";else if(p=e.get("ANGLE_instanced_arrays"),m="drawArraysInstancedANGLE",null===p)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");p[m](s,c,d,f),t.update(d,s,f)}}function CQ(n,e,t){let i;function s(A){if("highp"===A){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";A="mediump"}return"mediump"===A&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&"WebGL2RenderingContext"===n.constructor.name;let a=void 0!==t.precision?t.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const c=o||e.has("WEBGL_draw_buffers"),d=!0===t.logarithmicDepthBuffer,f=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),p=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),m=n.getParameter(n.MAX_TEXTURE_SIZE),_=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),E=n.getParameter(n.MAX_VERTEX_ATTRIBS),v=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),y=n.getParameter(n.MAX_VARYING_VECTORS),S=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),b=p>0,M=o||e.has("OES_texture_float");return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:function r(){if(void 0!==i)return i;if(!0===e.has("EXT_texture_filter_anisotropic")){const A=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(A.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:s,precision:a,logarithmicDepthBuffer:d,maxTextures:f,maxVertexTextures:p,maxTextureSize:m,maxCubemapSize:_,maxAttributes:E,maxVertexUniforms:v,maxVaryings:y,maxFragmentUniforms:S,vertexTextures:b,floatFragmentTextures:M,floatVertexTextures:b&&M,maxSamples:o?n.getParameter(n.MAX_SAMPLES):0}}function AQ(n){const e=this;let t=null,i=0,r=!1,s=!1;const o=new yu,a=new Qt,l={value:null,needsUpdate:!1};function d(f,p,m,_){const E=null!==f?f.length:0;let v=null;if(0!==E){if(v=l.value,!0!==_||null===v){const y=m+4*E,S=p.matrixWorldInverse;a.getNormalMatrix(S),(null===v||v.length<y)&&(v=new Float32Array(y));for(let b=0,M=m;b!==E;++b,M+=4)o.copy(f[b]).applyMatrix4(S,a),o.normal.toArray(v,M),v[M+3]=o.constant}l.value=v,l.needsUpdate=!0}return e.numPlanes=E,e.numIntersection=0,v}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(f,p){const m=0!==f.length||p||0!==i||r;return r=p,i=f.length,m},this.beginShadows=function(){s=!0,d(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(f,p){t=d(f,p,0)},this.setState=function(f,p,m){const _=f.clippingPlanes,E=f.clipIntersection,v=f.clipShadows,y=n.get(f);if(!r||null===_||0===_.length||s&&!v)s?d(null):function c(){l.value!==t&&(l.value=t,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}();else{const S=s?0:i,b=4*S;let M=y.clippingState||null;l.value=M,M=d(_,p,b,m);for(let T=0;T!==b;++T)M[T]=t[T];y.clippingState=M,this.numIntersection=E?this.numPlanes:0,this.numPlanes+=S}}}function DQ(n){let e=new WeakMap;function t(o,a){return 303===a?o.mapping=cu:304===a&&(o.mapping=Ld),o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=e.get(a);void 0!==l&&(e.delete(a),l.dispose())}return{get:function i(o){if(o&&o.isTexture&&!1===o.isRenderTargetTexture){const a=o.mapping;if(303===a||304===a){if(e.has(o))return t(e.get(o).texture,o.mapping);{const l=o.image;if(l&&l.height>0){const c=new wZ(l.height/2);return c.fromEquirectangularTexture(n,o),e.set(o,c),o.addEventListener("dispose",r),t(c.texture,o.mapping)}return null}}}return o},dispose:function s(){e=new WeakMap}}}class GS extends QD{constructor(e=-1,t=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,s,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,o=i+e,a=r+t,l=r-t;if(null!==this.view&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,d=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=d*this.view.offsetY,l=a-d*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const H3=[.125,.215,.35,.446,.526,.582],n1=new GS,z3=new je;let i1=null;const Yd=(1+Math.sqrt(5))/2,rm=1/Yd,G3=[new L(1,1,1),new L(-1,1,1),new L(1,1,-1),new L(-1,1,-1),new L(0,Yd,rm),new L(0,Yd,-rm),new L(rm,0,Yd),new L(-rm,0,Yd),new L(Yd,rm,0),new L(-Yd,rm,0)];class W3{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){i1=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=q3(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=j3(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(i1),e.scissorTest=!1,WS(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(e.mapping===cu||e.mapping===Ld?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),i1=this._renderer.getRenderTarget();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:bi,minFilter:bi,generateMipmaps:!1,type:xy,format:Uo,colorSpace:Fr,depthBuffer:!1},r=$3(e,t,i);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=$3(e,t,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function IQ(n){const e=[],t=[],i=[];let r=n;const s=n-4+1+H3.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let l=1/a;o>n-4?l=H3[o-n+4-1]:0===o&&(l=0),i.push(l);const c=1/(a-2),d=-c,f=1+c,p=[d,d,f,d,f,f,d,d,f,f,d,f],m=6,_=6,E=3,v=2,y=1,S=new Float32Array(E*_*m),b=new Float32Array(v*_*m),M=new Float32Array(y*_*m);for(let I=0;I<m;I++){const A=I%3*2/3-1,F=I>2?0:-1;S.set([A,F,0,A+2/3,F,0,A+2/3,F+1,0,A,F,0,A+2/3,F+1,0,A,F+1,0],E*_*I),b.set(p,v*_*I),M.set([I,I,I,I,I,I],y*_*I)}const T=new en;T.setAttribute("position",new wi(S,E)),T.setAttribute("uv",new wi(b,v)),T.setAttribute("faceIndex",new wi(M,y)),e.push(T),r>4&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}(s)),this._blurMaterial=function RQ(n,e,t){const i=new Float32Array(20),r=new L(0,1,0);return new _u({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(s,e,t)}return r}_compileMaterial(e){const t=new xr(this._lodPlanes[0],e);this._renderer.compile(t,n1)}_sceneToCubeUV(e,t,i,r){const a=new Tr(90,1,t,i),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],d=this._renderer,f=d.autoClear,p=d.toneMapping;d.getClearColor(z3),d.toneMapping=lu,d.autoClear=!1;const m=new Vs({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),_=new xr(new jd,m);let E=!1;const v=e.background;v?v.isColor&&(m.color.copy(v),e.background=null,E=!0):(m.color.copy(z3),E=!0);for(let y=0;y<6;y++){const S=y%3;0===S?(a.up.set(0,l[y],0),a.lookAt(c[y],0,0)):1===S?(a.up.set(0,0,l[y]),a.lookAt(0,c[y],0)):(a.up.set(0,l[y],0),a.lookAt(0,0,c[y]));const b=this._cubeSize;WS(r,S*b,y>2?b:0,b,b),d.setRenderTarget(r),E&&d.render(_,a),d.render(e,a)}_.geometry.dispose(),_.material.dispose(),d.toneMapping=p,d.autoClear=f,e.background=v}_textureToCubeUV(e,t){const i=this._renderer,r=e.mapping===cu||e.mapping===Ld;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=q3()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=j3());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new xr(this._lodPlanes[0],s);s.uniforms.envMap.value=e;const l=this._cubeSize;WS(t,0,0,3*l,2*l),i.setRenderTarget(t),i.render(o,n1)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]);this._blur(e,r-1,r,s,G3[(r-1)%G3.length])}t.autoClear=i}_blur(e,t,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,o,a){const l=this._renderer,c=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const f=new xr(this._lodPlanes[r],c),p=c.uniforms,m=this._sizeLods[i]-1,_=isFinite(s)?Math.PI/(2*m):2*Math.PI/39,E=s/_,v=isFinite(s)?1+Math.floor(3*E):20;v>20&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${v} samples when the maximum is set to 20`);const y=[];let S=0;for(let A=0;A<20;++A){const F=A/E,C=Math.exp(-F*F/2);y.push(C),0===A?S+=C:A<v&&(S+=2*C)}for(let A=0;A<y.length;A++)y[A]=y[A]/S;p.envMap.value=e.texture,p.samples.value=v,p.weights.value=y,p.latitudinal.value="latitudinal"===o,a&&(p.poleAxis.value=a);const{_lodMax:b}=this;p.dTheta.value=_,p.mipInt.value=b-i;const M=this._sizeLods[r];WS(t,3*M*(r>b-4?r-b+4:0),4*(this._cubeSize-M),3*M,2*M),l.setRenderTarget(t),l.render(f,n1)}}function $3(n,e,t){const i=new zd(n,e,t);return i.texture.mapping=Sy,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function WS(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function j3(){return new _u({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function q3(){return new _u({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function PQ(n){let e=new WeakMap,t=null;function s(a){const l=a.target;l.removeEventListener("dispose",s);const c=e.get(l);void 0!==c&&(e.delete(l),c.dispose())}return{get:function i(a){if(a&&a.isTexture){const l=a.mapping,c=303===l||304===l,d=l===cu||l===Ld;if(c||d){if(a.isRenderTargetTexture&&!0===a.needsPMREMUpdate){a.needsPMREMUpdate=!1;let f=e.get(a);return null===t&&(t=new W3(n)),f=c?t.fromEquirectangular(a,f):t.fromCubemap(a,f),e.set(a,f),f.texture}if(e.has(a))return e.get(a).texture;{const f=a.image;if(c&&f&&f.height>0||d&&f&&function r(a){let l=0;for(let d=0;d<6;d++)void 0!==a[d]&&l++;return 6===l}(f)){null===t&&(t=new W3(n));const p=c?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,p),a.addEventListener("dispose",s),p.texture}return null}}}return a},dispose:function o(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function NQ(n){const e={};function t(i){if(void 0!==e[i])return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return null!==t(i)},init:function(i){i.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){const r=t(i);return null===r&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function LQ(n,e,t,i){const r={},s=new WeakMap;function o(f){const p=f.target;null!==p.index&&e.remove(p.index);for(const _ in p.attributes)e.remove(p.attributes[_]);for(const _ in p.morphAttributes){const E=p.morphAttributes[_];for(let v=0,y=E.length;v<y;v++)e.remove(E[v])}p.removeEventListener("dispose",o),delete r[p.id];const m=s.get(p);m&&(e.remove(m),s.delete(p)),i.releaseStatesOfGeometry(p),!0===p.isInstancedBufferGeometry&&delete p._maxInstanceCount,t.memory.geometries--}function c(f){const p=[],m=f.index,_=f.attributes.position;let E=0;if(null!==m){const S=m.array;E=m.version;for(let b=0,M=S.length;b<M;b+=3){const T=S[b+0],I=S[b+1],A=S[b+2];p.push(T,I,I,A,A,T)}}else{if(void 0===_)return;E=_.version;for(let b=0,M=_.array.length/3-1;b<M;b+=3){const T=b+0,I=b+1,A=b+2;p.push(T,I,I,A,A,T)}}const v=new(_3(p)?N3:P3)(p,1);v.version=E;const y=s.get(f);y&&e.remove(y),s.set(f,v)}return{get:function a(f,p){return!0===r[p.id]||(p.addEventListener("dispose",o),r[p.id]=!0,t.memory.geometries++),p},update:function l(f){const p=f.attributes;for(const _ in p)e.update(p[_],n.ARRAY_BUFFER);const m=f.morphAttributes;for(const _ in m){const E=m[_];for(let v=0,y=E.length;v<y;v++)e.update(E[v],n.ARRAY_BUFFER)}},getWireframeAttribute:function d(f){const p=s.get(f);if(p){const m=f.index;null!==m&&p.version<m.version&&c(f)}else c(f);return s.get(f)}}}function OQ(n,e,t,i){const r=i.isWebGL2;let s,a,l;this.setMode=function o(p){s=p},this.setIndex=function c(p){a=p.type,l=p.bytesPerElement},this.render=function d(p,m){n.drawElements(s,m,a,p*l),t.update(m,s,1)},this.renderInstances=function f(p,m,_){if(0===_)return;let E,v;if(r)E=n,v="drawElementsInstanced";else if(E=e.get("ANGLE_instanced_arrays"),v="drawElementsInstancedANGLE",null===E)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");E[v](s,m,a,p*l,_),t.update(m,s,_)}}function FQ(n){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function i(s,o,a){switch(t.calls++,o){case n.TRIANGLES:t.triangles+=a*(s/3);break;case n.LINES:t.lines+=a*(s/2);break;case n.LINE_STRIP:t.lines+=a*(s-1);break;case n.LINE_LOOP:t.lines+=a*s;break;case n.POINTS:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o)}}}}function kQ(n,e){return n[0]-e[0]}function UQ(n,e){return Math.abs(e[1])-Math.abs(n[1])}function BQ(n,e,t){const i={},r=new Float32Array(8),s=new WeakMap,o=new kn,a=[];for(let c=0;c<8;c++)a[c]=[c,0];return{update:function l(c,d,f){const p=c.morphTargetInfluences;if(!0===e.isWebGL2){const m=d.morphAttributes.position||d.morphAttributes.normal||d.morphAttributes.color,_=void 0!==m?m.length:0;let E=s.get(d);if(void 0===E||E.count!==_){let W=function(){oe.dispose(),s.delete(d),d.removeEventListener("dispose",W)};void 0!==E&&E.texture.dispose();const S=void 0!==d.morphAttributes.position,b=void 0!==d.morphAttributes.normal,M=void 0!==d.morphAttributes.color,T=d.morphAttributes.position||[],I=d.morphAttributes.normal||[],A=d.morphAttributes.color||[];let F=0;!0===S&&(F=1),!0===b&&(F=2),!0===M&&(F=3);let C=d.attributes.position.count*F,N=1;C>e.maxTextureSize&&(N=Math.ceil(C/e.maxTextureSize),C=e.maxTextureSize);const K=new Float32Array(C*N*4*_),oe=new UD(K,C,N,_);oe.type=ql,oe.needsUpdate=!0;const ue=4*F;for(let J=0;J<_;J++){const $=T[J],Y=I[J],ie=A[J],Z=C*N*4*J;for(let de=0;de<$.count;de++){const q=de*ue;!0===S&&(o.fromBufferAttribute($,de),K[Z+q+0]=o.x,K[Z+q+1]=o.y,K[Z+q+2]=o.z,K[Z+q+3]=0),!0===b&&(o.fromBufferAttribute(Y,de),K[Z+q+4]=o.x,K[Z+q+5]=o.y,K[Z+q+6]=o.z,K[Z+q+7]=0),!0===M&&(o.fromBufferAttribute(ie,de),K[Z+q+8]=o.x,K[Z+q+9]=o.y,K[Z+q+10]=o.z,K[Z+q+11]=4===ie.itemSize?o.w:1)}}E={count:_,texture:oe,size:new he(C,N)},s.set(d,E),d.addEventListener("dispose",W)}let v=0;for(let S=0;S<p.length;S++)v+=p[S];const y=d.morphTargetsRelative?1:1-v;f.getUniforms().setValue(n,"morphTargetBaseInfluence",y),f.getUniforms().setValue(n,"morphTargetInfluences",p),f.getUniforms().setValue(n,"morphTargetsTexture",E.texture,t),f.getUniforms().setValue(n,"morphTargetsTextureSize",E.size)}else{const m=void 0===p?0:p.length;let _=i[d.id];if(void 0===_||_.length!==m){_=[];for(let b=0;b<m;b++)_[b]=[b,0];i[d.id]=_}for(let b=0;b<m;b++){const M=_[b];M[0]=b,M[1]=p[b]}_.sort(UQ);for(let b=0;b<8;b++)b<m&&_[b][1]?(a[b][0]=_[b][0],a[b][1]=_[b][1]):(a[b][0]=Number.MAX_SAFE_INTEGER,a[b][1]=0);a.sort(kQ);const E=d.morphAttributes.position,v=d.morphAttributes.normal;let y=0;for(let b=0;b<8;b++){const M=a[b],T=M[0],I=M[1];T!==Number.MAX_SAFE_INTEGER&&I?(E&&d.getAttribute("morphTarget"+b)!==E[T]&&d.setAttribute("morphTarget"+b,E[T]),v&&d.getAttribute("morphNormal"+b)!==v[T]&&d.setAttribute("morphNormal"+b,v[T]),r[b]=I,y+=I):(E&&!0===d.hasAttribute("morphTarget"+b)&&d.deleteAttribute("morphTarget"+b),v&&!0===d.hasAttribute("morphNormal"+b)&&d.deleteAttribute("morphNormal"+b),r[b]=0)}const S=d.morphTargetsRelative?1:1-y;f.getUniforms().setValue(n,"morphTargetBaseInfluence",S),f.getUniforms().setValue(n,"morphTargetInfluences",r)}}}}function VQ(n,e,t,i){let r=new WeakMap;function a(l){const c=l.target;c.removeEventListener("dispose",a),t.remove(c.instanceMatrix),null!==c.instanceColor&&t.remove(c.instanceColor)}return{update:function s(l){const c=i.render.frame,f=e.get(l,l.geometry);if(r.get(f)!==c&&(e.update(f),r.set(f,c)),l.isInstancedMesh&&(!1===l.hasEventListener("dispose",a)&&l.addEventListener("dispose",a),r.get(l)!==c&&(t.update(l.instanceMatrix,n.ARRAY_BUFFER),null!==l.instanceColor&&t.update(l.instanceColor,n.ARRAY_BUFFER),r.set(l,c))),l.isSkinnedMesh){const p=l.skeleton;r.get(p)!==c&&(p.update(),r.set(p,c))}return f},dispose:function o(){r=new WeakMap}}}const X3=new pa,Y3=new UD,K3=new S3,Z3=new BS,J3=[],Q3=[],eB=new Float32Array(16),tB=new Float32Array(9),nB=new Float32Array(4);function sm(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let s=J3[r];if(void 0===s&&(s=new Float32Array(r),J3[r]=s),0!==e){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function cr(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function ur(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function $S(n,e){let t=Q3[e];void 0===t&&(t=new Int32Array(e),Q3[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function HQ(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function zQ(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(cr(t,e))return;n.uniform2fv(this.addr,e),ur(t,e)}}function GQ(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(cr(t,e))return;n.uniform3fv(this.addr,e),ur(t,e)}}function WQ(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(cr(t,e))return;n.uniform4fv(this.addr,e),ur(t,e)}}function $Q(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(cr(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),ur(t,e)}else{if(cr(t,i))return;nB.set(i),n.uniformMatrix2fv(this.addr,!1,nB),ur(t,i)}}function jQ(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(cr(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),ur(t,e)}else{if(cr(t,i))return;tB.set(i),n.uniformMatrix3fv(this.addr,!1,tB),ur(t,i)}}function qQ(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(cr(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),ur(t,e)}else{if(cr(t,i))return;eB.set(i),n.uniformMatrix4fv(this.addr,!1,eB),ur(t,i)}}function XQ(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function YQ(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(cr(t,e))return;n.uniform2iv(this.addr,e),ur(t,e)}}function KQ(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(cr(t,e))return;n.uniform3iv(this.addr,e),ur(t,e)}}function ZQ(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(cr(t,e))return;n.uniform4iv(this.addr,e),ur(t,e)}}function JQ(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function QQ(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(cr(t,e))return;n.uniform2uiv(this.addr,e),ur(t,e)}}function eee(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(cr(t,e))return;n.uniform3uiv(this.addr,e),ur(t,e)}}function tee(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(cr(t,e))return;n.uniform4uiv(this.addr,e),ur(t,e)}}function nee(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2D(e||X3,r)}function iee(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||K3,r)}function ree(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||Z3,r)}function see(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||Y3,r)}function aee(n,e){n.uniform1fv(this.addr,e)}function lee(n,e){const t=sm(e,this.size,2);n.uniform2fv(this.addr,t)}function cee(n,e){const t=sm(e,this.size,3);n.uniform3fv(this.addr,t)}function uee(n,e){const t=sm(e,this.size,4);n.uniform4fv(this.addr,t)}function dee(n,e){const t=sm(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function hee(n,e){const t=sm(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function fee(n,e){const t=sm(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function pee(n,e){n.uniform1iv(this.addr,e)}function mee(n,e){n.uniform2iv(this.addr,e)}function gee(n,e){n.uniform3iv(this.addr,e)}function _ee(n,e){n.uniform4iv(this.addr,e)}function yee(n,e){n.uniform1uiv(this.addr,e)}function vee(n,e){n.uniform2uiv(this.addr,e)}function Eee(n,e){n.uniform3uiv(this.addr,e)}function bee(n,e){n.uniform4uiv(this.addr,e)}function See(n,e,t){const i=this.cache,r=e.length,s=$S(t,r);cr(i,s)||(n.uniform1iv(this.addr,s),ur(i,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||X3,s[o])}function wee(n,e,t){const i=this.cache,r=e.length,s=$S(t,r);cr(i,s)||(n.uniform1iv(this.addr,s),ur(i,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||K3,s[o])}function Mee(n,e,t){const i=this.cache,r=e.length,s=$S(t,r);cr(i,s)||(n.uniform1iv(this.addr,s),ur(i,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||Z3,s[o])}function xee(n,e,t){const i=this.cache,r=e.length,s=$S(t,r);cr(i,s)||(n.uniform1iv(this.addr,s),ur(i,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||Y3,s[o])}class Cee{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.setValue=function oee(n){switch(n){case 5126:return HQ;case 35664:return zQ;case 35665:return GQ;case 35666:return WQ;case 35674:return $Q;case 35675:return jQ;case 35676:return qQ;case 5124:case 35670:return XQ;case 35667:case 35671:return YQ;case 35668:case 35672:return KQ;case 35669:case 35673:return ZQ;case 5125:return JQ;case 36294:return QQ;case 36295:return eee;case 36296:return tee;case 35678:case 36198:case 36298:case 36306:case 35682:return nee;case 35679:case 36299:case 36307:return iee;case 35680:case 36300:case 36308:case 36293:return ree;case 36289:case 36303:case 36311:case 36292:return see}}(t.type)}}class Aee{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.size=t.size,this.setValue=function Tee(n){switch(n){case 5126:return aee;case 35664:return lee;case 35665:return cee;case 35666:return uee;case 35674:return dee;case 35675:return hee;case 35676:return fee;case 5124:case 35670:return pee;case 35667:case 35671:return mee;case 35668:case 35672:return gee;case 35669:case 35673:return _ee;case 5125:return yee;case 36294:return vee;case 36295:return Eee;case 36296:return bee;case 35678:case 36198:case 36298:case 36306:case 35682:return See;case 35679:case 36299:case 36307:return wee;case 35680:case 36300:case 36308:case 36293:return Mee;case 36289:case 36303:case 36311:case 36292:return xee}}(t.type)}}class Dee{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,t[a.id],i)}}}const s1=/(\w+)(\])?(\[|\.)?/g;function iB(n,e){n.seq.push(e),n.map[e.id]=e}function Iee(n,e,t){const i=n.name,r=i.length;for(s1.lastIndex=0;;){const s=s1.exec(i);let a=s[1];const c=s[3];if("]"===s[2]&&(a|=0),void 0===c||"["===c&&s1.lastIndex+2===r){iB(t,void 0===c?new Cee(a,n,e):new Aee(a,n,e));break}{let f=t.map[a];void 0===f&&(f=new Dee(a),iB(t,f)),t=f}}}class jS{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<i;++r){const s=e.getActiveUniform(t,r);Iee(s,e.getUniformLocation(t,s.name),this)}}setValue(e,t,i,r){const s=this.map[t];void 0!==s&&s.setValue(e,i,r)}setOptional(e,t,i){const r=t[i];void 0!==r&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let s=0,o=t.length;s!==o;++s){const a=t[s],l=i[a.id];!1!==l.needsUpdate&&a.setValue(e,l.value,r)}}static seqWithValue(e,t){const i=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&i.push(o)}return i}}function rB(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}let Ree=0;function sB(n,e,t){const i=n.getShaderParameter(e,n.COMPILE_STATUS),r=n.getShaderInfoLog(e).trim();if(i&&""===r)return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return t.toUpperCase()+"\n\n"+r+"\n\n"+function Pee(n,e){const t=n.split("\n"),i=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const a=o+1;i.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return i.join("\n")}(n.getShaderSource(e),o)}return r}function Lee(n,e){const t=function Nee(n){const e=Cn.getPrimaries(Cn.workingColorSpace),t=Cn.getPrimaries(n);let i;switch(e===t?i="":e===_S&&t===gS?i="LinearDisplayP3ToLinearSRGB":e===gS&&t===_S&&(i="LinearSRGBToLinearDisplayP3"),n){case Fr:case pS:return[i,"LinearTransferOETF"];case fi:case DD:return[i,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",n),[i,"LinearTransferOETF"]}}(e);return`vec4 ${n}( vec4 value ) { return ${t[0]}( ${t[1]}( value ) ); }`}function Oee(n,e){let t;switch(e){case uK:t="Linear";break;case dK:t="Reinhard";break;case hK:t="OptimizedCineon";break;case fK:t="ACESFilmic";break;case pK:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function Oy(n){return""!==n}function oB(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function aB(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Bee=/^[ \t]*#include +<([\w\d./]+)>/gm;function o1(n){return n.replace(Bee,Hee)}const Vee=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function Hee(n,e){let t=Yt[e];if(void 0===t){const i=Vee.get(e);if(void 0===i)throw new Error("Can not resolve #include <"+e+">");t=Yt[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i)}return o1(t)}const zee=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function lB(n){return n.replace(zee,Gee)}function Gee(n,e,t,i){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function cB(n){let e="precision "+n.precision+" float;\nprecision "+n.precision+" int;";return"highp"===n.precision?e+="\n#define HIGH_PRECISION":"mediump"===n.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===n.precision&&(e+="\n#define LOW_PRECISION"),e}function Yee(n,e,t,i){const r=n.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=function Wee(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===TU?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===zY?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===Wl&&(e="SHADOWMAP_TYPE_VSM"),e}(t),c=function $ee(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case cu:case Ld:e="ENVMAP_TYPE_CUBE";break;case Sy:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),d=function jee(n){let e="ENVMAP_MODE_REFLECTION";return n.envMap&&n.envMapMode===Ld&&(e="ENVMAP_MODE_REFRACTION"),e}(t),f=function qee(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case cS:e="ENVMAP_BLENDING_MULTIPLY";break;case lK:e="ENVMAP_BLENDING_MIX";break;case cK:e="ENVMAP_BLENDING_ADD"}return e}(t),p=function Xee(n){const e=n.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:i,maxMip:t}}(t),m=t.isWebGL2?"":function Fee(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.normalMapTangentSpace||n.clearcoatNormalMap||n.flatShading||"physical"===n.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Oy).join("\n")}(t),_=function kee(n){const e=[];for(const t in n){const i=n[t];!1!==i&&e.push("#define "+t+" "+i)}return e.join("\n")}(s),E=r.createProgram();let v,y,S=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(v=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,_].filter(Oy).join("\n"),v.length>0&&(v+="\n"),y=[m,"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,_].filter(Oy).join("\n"),y.length>0&&(y+="\n")):(v=[cB(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,_,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+d:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Oy).join("\n"),y=[m,cB(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,_,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+d:"",t.envMap?"#define "+f:"",p?"#define CUBEUV_TEXEL_WIDTH "+p.texelWidth:"",p?"#define CUBEUV_TEXEL_HEIGHT "+p.texelHeight:"",p?"#define CUBEUV_MAX_MIP "+p.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==lu?"#define TONE_MAPPING":"",t.toneMapping!==lu?Yt.tonemapping_pars_fragment:"",t.toneMapping!==lu?Oee("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Yt.colorspace_pars_fragment,Lee("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(Oy).join("\n")),o=o1(o),o=oB(o,t),o=aB(o,t),a=o1(a),a=oB(a,t),a=aB(a,t),o=lB(o),a=lB(a),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(S="#version 300 es\n",v=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+v,y=["#define varying in",t.glslVersion===p3?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===p3?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+y);const M=S+y+a,T=rB(r,r.VERTEX_SHADER,S+v+o),I=rB(r,r.FRAGMENT_SHADER,M);if(r.attachShader(E,T),r.attachShader(E,I),void 0!==t.index0AttributeName?r.bindAttribLocation(E,0,t.index0AttributeName):!0===t.morphTargets&&r.bindAttribLocation(E,0,"position"),r.linkProgram(E),n.debug.checkShaderErrors){const C=r.getProgramInfoLog(E).trim(),N=r.getShaderInfoLog(T).trim(),K=r.getShaderInfoLog(I).trim();let oe=!0,ue=!0;if(!1===r.getProgramParameter(E,r.LINK_STATUS))if(oe=!1,"function"==typeof n.debug.onShaderError)n.debug.onShaderError(r,E,T,I);else{const W=sB(r,T,"vertex"),J=sB(r,I,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(E,r.VALIDATE_STATUS)+"\n\nProgram Info Log: "+C+"\n"+W+"\n"+J)}else""!==C?console.warn("THREE.WebGLProgram: Program Info Log:",C):(""===N||""===K)&&(ue=!1);ue&&(this.diagnostics={runnable:oe,programLog:C,vertexShader:{log:N,prefix:v},fragmentShader:{log:K,prefix:y}})}let A,F;return r.deleteShader(T),r.deleteShader(I),this.getUniforms=function(){return void 0===A&&(A=new jS(r,E)),A},this.getAttributes=function(){return void 0===F&&(F=function Uee(n,e){const t={},i=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const s=n.getActiveAttrib(e,r),o=s.name;let a=1;s.type===n.FLOAT_MAT2&&(a=2),s.type===n.FLOAT_MAT3&&(a=3),s.type===n.FLOAT_MAT4&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}(r,E)),F},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(E),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=Ree++,this.cacheKey=e,this.usedTimes=1,this.program=E,this.vertexShader=T,this.fragmentShader=I,this}let Kee=0;class Zee{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.fragmentShader,r=this._getShaderStage(e.vertexShader),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return!1===o.has(r)&&(o.add(r),r.usedTimes++),!1===o.has(s)&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,0===i.usedTimes&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return void 0===i&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return void 0===i&&(i=new Jee(e),t.set(e,i)),i}}class Jee{constructor(e){this.id=Kee++,this.code=e,this.usedTimes=0}}function Qee(n,e,t,i,r,s,o){const a=new $D,l=new Zee,c=[],d=r.isWebGL2,f=r.logarithmicDepthBuffer,p=r.vertexTextures;let m=r.precision;const _={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function E(C){return 0===C?"uv":`uv${C}`}return{getParameters:function v(C,N,K,oe,ue){const W=oe.fog,J=ue.geometry,Y=(C.isMeshStandardMaterial?t:e).get(C.envMap||(C.isMeshStandardMaterial?oe.environment:null)),ie=Y&&Y.mapping===Sy?Y.image.height:null,Z=_[C.type];null!==C.precision&&(m=r.getMaxPrecision(C.precision),m!==C.precision&&console.warn("THREE.WebGLProgram.getParameters:",C.precision,"not supported, using",m,"instead."));const de=J.morphAttributes.position||J.morphAttributes.normal||J.morphAttributes.color,q=void 0!==de?de.length:0;let xe,Se,ze,nt,se=0;if(void 0!==J.morphAttributes.position&&(se=1),void 0!==J.morphAttributes.normal&&(se=2),void 0!==J.morphAttributes.color&&(se=3),Z){const oi=tl[Z];xe=oi.vertexShader,Se=oi.fragmentShader}else xe=C.vertexShader,Se=C.fragmentShader,l.update(C),ze=l.getVertexShaderID(C),nt=l.getFragmentShaderID(C);const Ge=n.getRenderTarget(),Ze=!0===ue.isInstancedMesh,St=!!C.map,lt=!!Y,H=!!C.aoMap,Pe=!!C.lightMap,_e=!!C.bumpMap,Ce=!!C.normalMap,be=!!C.displacementMap,ut=!!C.emissiveMap,Je=!!C.metalnessMap,et=!!C.roughnessMap,Mt=C.anisotropy>0,on=C.clearcoat>0,ci=C.iridescence>0,k=C.sheen>0,R=C.transmission>0,te=Mt&&!!C.anisotropyMap,Te=on&&!!C.clearcoatMap,Me=on&&!!C.clearcoatNormalMap,Ae=on&&!!C.clearcoatRoughnessMap,at=ci&&!!C.iridescenceMap,De=ci&&!!C.iridescenceThicknessMap,$e=k&&!!C.sheenColorMap,z=k&&!!C.sheenRoughnessMap,Ie=!!C.specularMap,ve=!!C.specularColorMap,Tt=!!C.specularIntensityMap,dt=R&&!!C.transmissionMap,gt=R&&!!C.thicknessMap,V=!!C.alphaMap,We=!!C.extensions,Oe=!!J.attributes.uv1,we=!!J.attributes.uv2,ot=!!J.attributes.uv3;let Dt=lu;return C.toneMapped&&(null===Ge||!0===Ge.isXRRenderTarget)&&(Dt=n.toneMapping),{isWebGL2:d,shaderID:Z,shaderType:C.type,shaderName:C.name,vertexShader:xe,fragmentShader:Se,defines:C.defines,customVertexShaderID:ze,customFragmentShaderID:nt,isRawShaderMaterial:!0===C.isRawShaderMaterial,glslVersion:C.glslVersion,precision:m,instancing:Ze,instancingColor:Ze&&null!==ue.instanceColor,supportsVertexTextures:p,outputColorSpace:null===Ge?n.outputColorSpace:!0===Ge.isXRRenderTarget?Ge.texture.colorSpace:Fr,map:St,matcap:!!C.matcap,envMap:lt,envMapMode:lt&&Y.mapping,envMapCubeUVHeight:ie,aoMap:H,lightMap:Pe,bumpMap:_e,normalMap:Ce,displacementMap:p&&be,emissiveMap:ut,normalMapObjectSpace:Ce&&1===C.normalMapType,normalMapTangentSpace:Ce&&0===C.normalMapType,metalnessMap:Je,roughnessMap:et,anisotropy:Mt,anisotropyMap:te,clearcoat:on,clearcoatMap:Te,clearcoatNormalMap:Me,clearcoatRoughnessMap:Ae,iridescence:ci,iridescenceMap:at,iridescenceThicknessMap:De,sheen:k,sheenColorMap:$e,sheenRoughnessMap:z,specularMap:Ie,specularColorMap:ve,specularIntensityMap:Tt,transmission:R,transmissionMap:dt,thicknessMap:gt,gradientMap:!!C.gradientMap,opaque:!1===C.transparent&&1===C.blending,alphaMap:V,alphaTest:C.alphaTest>0,alphaHash:!!C.alphaHash,combine:C.combine,mapUv:St&&E(C.map.channel),aoMapUv:H&&E(C.aoMap.channel),lightMapUv:Pe&&E(C.lightMap.channel),bumpMapUv:_e&&E(C.bumpMap.channel),normalMapUv:Ce&&E(C.normalMap.channel),displacementMapUv:be&&E(C.displacementMap.channel),emissiveMapUv:ut&&E(C.emissiveMap.channel),metalnessMapUv:Je&&E(C.metalnessMap.channel),roughnessMapUv:et&&E(C.roughnessMap.channel),anisotropyMapUv:te&&E(C.anisotropyMap.channel),clearcoatMapUv:Te&&E(C.clearcoatMap.channel),clearcoatNormalMapUv:Me&&E(C.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Ae&&E(C.clearcoatRoughnessMap.channel),iridescenceMapUv:at&&E(C.iridescenceMap.channel),iridescenceThicknessMapUv:De&&E(C.iridescenceThicknessMap.channel),sheenColorMapUv:$e&&E(C.sheenColorMap.channel),sheenRoughnessMapUv:z&&E(C.sheenRoughnessMap.channel),specularMapUv:Ie&&E(C.specularMap.channel),specularColorMapUv:ve&&E(C.specularColorMap.channel),specularIntensityMapUv:Tt&&E(C.specularIntensityMap.channel),transmissionMapUv:dt&&E(C.transmissionMap.channel),thicknessMapUv:gt&&E(C.thicknessMap.channel),alphaMapUv:V&&E(C.alphaMap.channel),vertexTangents:!!J.attributes.tangent&&(Ce||Mt),vertexColors:C.vertexColors,vertexAlphas:!0===C.vertexColors&&!!J.attributes.color&&4===J.attributes.color.itemSize,vertexUv1s:Oe,vertexUv2s:we,vertexUv3s:ot,pointsUvs:!0===ue.isPoints&&!!J.attributes.uv&&(St||V),fog:!!W,useFog:!0===C.fog,fogExp2:W&&W.isFogExp2,flatShading:!0===C.flatShading,sizeAttenuation:!0===C.sizeAttenuation,logarithmicDepthBuffer:f,skinning:!0===ue.isSkinnedMesh,morphTargets:void 0!==J.morphAttributes.position,morphNormals:void 0!==J.morphAttributes.normal,morphColors:void 0!==J.morphAttributes.color,morphTargetsCount:q,morphTextureStride:se,numDirLights:N.directional.length,numPointLights:N.point.length,numSpotLights:N.spot.length,numSpotLightMaps:N.spotLightMap.length,numRectAreaLights:N.rectArea.length,numHemiLights:N.hemi.length,numDirLightShadows:N.directionalShadowMap.length,numPointLightShadows:N.pointShadowMap.length,numSpotLightShadows:N.spotShadowMap.length,numSpotLightShadowsWithMaps:N.numSpotLightShadowsWithMaps,numLightProbes:N.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:C.dithering,shadowMapEnabled:n.shadowMap.enabled&&K.length>0,shadowMapType:n.shadowMap.type,toneMapping:Dt,useLegacyLights:n._useLegacyLights,decodeVideoTexture:St&&!0===C.map.isVideoTexture&&Cn.getTransfer(C.map.colorSpace)===ri,premultipliedAlpha:C.premultipliedAlpha,doubleSided:2===C.side,flipSided:1===C.side,useDepthPacking:C.depthPacking>=0,depthPacking:C.depthPacking||0,index0AttributeName:C.index0AttributeName,extensionDerivatives:We&&!0===C.extensions.derivatives,extensionFragDepth:We&&!0===C.extensions.fragDepth,extensionDrawBuffers:We&&!0===C.extensions.drawBuffers,extensionShaderTextureLOD:We&&!0===C.extensions.shaderTextureLOD,rendererExtensionFragDepth:d||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:d||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:d||i.has("EXT_shader_texture_lod"),customProgramCacheKey:C.customProgramCacheKey()}},getProgramCacheKey:function y(C){const N=[];if(C.shaderID?N.push(C.shaderID):(N.push(C.customVertexShaderID),N.push(C.customFragmentShaderID)),void 0!==C.defines)for(const K in C.defines)N.push(K),N.push(C.defines[K]);return!1===C.isRawShaderMaterial&&(function S(C,N){C.push(N.precision),C.push(N.outputColorSpace),C.push(N.envMapMode),C.push(N.envMapCubeUVHeight),C.push(N.mapUv),C.push(N.alphaMapUv),C.push(N.lightMapUv),C.push(N.aoMapUv),C.push(N.bumpMapUv),C.push(N.normalMapUv),C.push(N.displacementMapUv),C.push(N.emissiveMapUv),C.push(N.metalnessMapUv),C.push(N.roughnessMapUv),C.push(N.anisotropyMapUv),C.push(N.clearcoatMapUv),C.push(N.clearcoatNormalMapUv),C.push(N.clearcoatRoughnessMapUv),C.push(N.iridescenceMapUv),C.push(N.iridescenceThicknessMapUv),C.push(N.sheenColorMapUv),C.push(N.sheenRoughnessMapUv),C.push(N.specularMapUv),C.push(N.specularColorMapUv),C.push(N.specularIntensityMapUv),C.push(N.transmissionMapUv),C.push(N.thicknessMapUv),C.push(N.combine),C.push(N.fogExp2),C.push(N.sizeAttenuation),C.push(N.morphTargetsCount),C.push(N.morphAttributeCount),C.push(N.numDirLights),C.push(N.numPointLights),C.push(N.numSpotLights),C.push(N.numSpotLightMaps),C.push(N.numHemiLights),C.push(N.numRectAreaLights),C.push(N.numDirLightShadows),C.push(N.numPointLightShadows),C.push(N.numSpotLightShadows),C.push(N.numSpotLightShadowsWithMaps),C.push(N.numLightProbes),C.push(N.shadowMapType),C.push(N.toneMapping),C.push(N.numClippingPlanes),C.push(N.numClipIntersection),C.push(N.depthPacking)}(N,C),function b(C,N){a.disableAll(),N.isWebGL2&&a.enable(0),N.supportsVertexTextures&&a.enable(1),N.instancing&&a.enable(2),N.instancingColor&&a.enable(3),N.matcap&&a.enable(4),N.envMap&&a.enable(5),N.normalMapObjectSpace&&a.enable(6),N.normalMapTangentSpace&&a.enable(7),N.clearcoat&&a.enable(8),N.iridescence&&a.enable(9),N.alphaTest&&a.enable(10),N.vertexColors&&a.enable(11),N.vertexAlphas&&a.enable(12),N.vertexUv1s&&a.enable(13),N.vertexUv2s&&a.enable(14),N.vertexUv3s&&a.enable(15),N.vertexTangents&&a.enable(16),N.anisotropy&&a.enable(17),C.push(a.mask),a.disableAll(),N.fog&&a.enable(0),N.useFog&&a.enable(1),N.flatShading&&a.enable(2),N.logarithmicDepthBuffer&&a.enable(3),N.skinning&&a.enable(4),N.morphTargets&&a.enable(5),N.morphNormals&&a.enable(6),N.morphColors&&a.enable(7),N.premultipliedAlpha&&a.enable(8),N.shadowMapEnabled&&a.enable(9),N.useLegacyLights&&a.enable(10),N.doubleSided&&a.enable(11),N.flipSided&&a.enable(12),N.useDepthPacking&&a.enable(13),N.dithering&&a.enable(14),N.transmission&&a.enable(15),N.sheen&&a.enable(16),N.opaque&&a.enable(17),N.pointsUvs&&a.enable(18),N.decodeVideoTexture&&a.enable(19),C.push(a.mask)}(N,C),N.push(n.outputColorSpace)),N.push(C.customProgramCacheKey),N.join()},getUniforms:function M(C){const N=_[C.type];let K;return K=N?vZ.clone(tl[N].uniforms):C.uniforms,K},acquireProgram:function T(C,N){let K;for(let oe=0,ue=c.length;oe<ue;oe++){const W=c[oe];if(W.cacheKey===N){K=W,++K.usedTimes;break}}return void 0===K&&(K=new Yee(n,N,C,s),c.push(K)),K},releaseProgram:function I(C){if(0==--C.usedTimes){const N=c.indexOf(C);c[N]=c[c.length-1],c.pop(),C.destroy()}},releaseShaderCache:function A(C){l.remove(C)},programs:c,dispose:function F(){l.dispose()}}}function ete(){let n=new WeakMap;return{get:function e(s){let o=n.get(s);return void 0===o&&(o={},n.set(s,o)),o},remove:function t(s){n.delete(s)},update:function i(s,o,a){n.get(s)[o]=a},dispose:function r(){n=new WeakMap}}}function tte(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function uB(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function dB(){const n=[];let e=0;const t=[],i=[],r=[];function o(f,p,m,_,E,v){let y=n[e];return void 0===y?(y={id:f.id,object:f,geometry:p,material:m,groupOrder:_,renderOrder:f.renderOrder,z:E,group:v},n[e]=y):(y.id=f.id,y.object=f,y.geometry=p,y.material=m,y.groupOrder=_,y.renderOrder=f.renderOrder,y.z=E,y.group=v),e++,y}return{opaque:t,transmissive:i,transparent:r,init:function s(){e=0,t.length=0,i.length=0,r.length=0},push:function a(f,p,m,_,E,v){const y=o(f,p,m,_,E,v);m.transmission>0?i.push(y):!0===m.transparent?r.push(y):t.push(y)},unshift:function l(f,p,m,_,E,v){const y=o(f,p,m,_,E,v);m.transmission>0?i.unshift(y):!0===m.transparent?r.unshift(y):t.unshift(y)},finish:function d(){for(let f=e,p=n.length;f<p;f++){const m=n[f];if(null===m.id)break;m.id=null,m.object=null,m.geometry=null,m.material=null,m.group=null}},sort:function c(f,p){t.length>1&&t.sort(f||tte),i.length>1&&i.sort(p||uB),r.length>1&&r.sort(p||uB)}}}function nte(){let n=new WeakMap;return{get:function e(i,r){const s=n.get(i);let o;return void 0===s?(o=new dB,n.set(i,[o])):r>=s.length?(o=new dB,s.push(o)):o=s[r],o},dispose:function t(){n=new WeakMap}}}function ite(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new L,color:new je};break;case"SpotLight":t={position:new L,direction:new L,color:new je,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new L,color:new je,distance:0,decay:0};break;case"HemisphereLight":t={direction:new L,skyColor:new je,groundColor:new je};break;case"RectAreaLight":t={color:new je,position:new L,halfWidth:new L,halfHeight:new L}}return n[e.id]=t,t}}}let ste=0;function ote(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function ate(n,e){const t=new ite,i=function rte(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new he};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new he,shadowCameraNear:1,shadowCameraFar:1e3}}return n[e.id]=t,t}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let d=0;d<9;d++)r.probe.push(new L);const s=new L,o=new At,a=new At;return{setup:function l(d,f){let p=0,m=0,_=0;for(let oe=0;oe<9;oe++)r.probe[oe].set(0,0,0);let E=0,v=0,y=0,S=0,b=0,M=0,T=0,I=0,A=0,F=0,C=0;d.sort(ote);const N=!0===f?Math.PI:1;for(let oe=0,ue=d.length;oe<ue;oe++){const W=d[oe],J=W.color,$=W.intensity,Y=W.distance,ie=W.shadow&&W.shadow.map?W.shadow.map.texture:null;if(W.isAmbientLight)p+=J.r*$*N,m+=J.g*$*N,_+=J.b*$*N;else if(W.isLightProbe){for(let Z=0;Z<9;Z++)r.probe[Z].addScaledVector(W.sh.coefficients[Z],$);C++}else if(W.isDirectionalLight){const Z=t.get(W);if(Z.color.copy(W.color).multiplyScalar(W.intensity*N),W.castShadow){const de=W.shadow,q=i.get(W);q.shadowBias=de.bias,q.shadowNormalBias=de.normalBias,q.shadowRadius=de.radius,q.shadowMapSize=de.mapSize,r.directionalShadow[E]=q,r.directionalShadowMap[E]=ie,r.directionalShadowMatrix[E]=W.shadow.matrix,M++}r.directional[E]=Z,E++}else if(W.isSpotLight){const Z=t.get(W);Z.position.setFromMatrixPosition(W.matrixWorld),Z.color.copy(J).multiplyScalar($*N),Z.distance=Y,Z.coneCos=Math.cos(W.angle),Z.penumbraCos=Math.cos(W.angle*(1-W.penumbra)),Z.decay=W.decay,r.spot[y]=Z;const de=W.shadow;if(W.map&&(r.spotLightMap[A]=W.map,A++,de.updateMatrices(W),W.castShadow&&F++),r.spotLightMatrix[y]=de.matrix,W.castShadow){const q=i.get(W);q.shadowBias=de.bias,q.shadowNormalBias=de.normalBias,q.shadowRadius=de.radius,q.shadowMapSize=de.mapSize,r.spotShadow[y]=q,r.spotShadowMap[y]=ie,I++}y++}else if(W.isRectAreaLight){const Z=t.get(W);Z.color.copy(J).multiplyScalar($),Z.halfWidth.set(.5*W.width,0,0),Z.halfHeight.set(0,.5*W.height,0),r.rectArea[S]=Z,S++}else if(W.isPointLight){const Z=t.get(W);if(Z.color.copy(W.color).multiplyScalar(W.intensity*N),Z.distance=W.distance,Z.decay=W.decay,W.castShadow){const de=W.shadow,q=i.get(W);q.shadowBias=de.bias,q.shadowNormalBias=de.normalBias,q.shadowRadius=de.radius,q.shadowMapSize=de.mapSize,q.shadowCameraNear=de.camera.near,q.shadowCameraFar=de.camera.far,r.pointShadow[v]=q,r.pointShadowMap[v]=ie,r.pointShadowMatrix[v]=W.shadow.matrix,T++}r.point[v]=Z,v++}else if(W.isHemisphereLight){const Z=t.get(W);Z.skyColor.copy(W.color).multiplyScalar($*N),Z.groundColor.copy(W.groundColor).multiplyScalar($*N),r.hemi[b]=Z,b++}}S>0&&(e.isWebGL2||!0===n.has("OES_texture_float_linear")?(r.rectAreaLTC1=He.LTC_FLOAT_1,r.rectAreaLTC2=He.LTC_FLOAT_2):!0===n.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=He.LTC_HALF_1,r.rectAreaLTC2=He.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=p,r.ambient[1]=m,r.ambient[2]=_;const K=r.hash;(K.directionalLength!==E||K.pointLength!==v||K.spotLength!==y||K.rectAreaLength!==S||K.hemiLength!==b||K.numDirectionalShadows!==M||K.numPointShadows!==T||K.numSpotShadows!==I||K.numSpotMaps!==A||K.numLightProbes!==C)&&(r.directional.length=E,r.spot.length=y,r.rectArea.length=S,r.point.length=v,r.hemi.length=b,r.directionalShadow.length=M,r.directionalShadowMap.length=M,r.pointShadow.length=T,r.pointShadowMap.length=T,r.spotShadow.length=I,r.spotShadowMap.length=I,r.directionalShadowMatrix.length=M,r.pointShadowMatrix.length=T,r.spotLightMatrix.length=I+A-F,r.spotLightMap.length=A,r.numSpotLightShadowsWithMaps=F,r.numLightProbes=C,K.directionalLength=E,K.pointLength=v,K.spotLength=y,K.rectAreaLength=S,K.hemiLength=b,K.numDirectionalShadows=M,K.numPointShadows=T,K.numSpotShadows=I,K.numSpotMaps=A,K.numLightProbes=C,r.version=ste++)},setupView:function c(d,f){let p=0,m=0,_=0,E=0,v=0;const y=f.matrixWorldInverse;for(let S=0,b=d.length;S<b;S++){const M=d[S];if(M.isDirectionalLight){const T=r.directional[p];T.direction.setFromMatrixPosition(M.matrixWorld),s.setFromMatrixPosition(M.target.matrixWorld),T.direction.sub(s),T.direction.transformDirection(y),p++}else if(M.isSpotLight){const T=r.spot[_];T.position.setFromMatrixPosition(M.matrixWorld),T.position.applyMatrix4(y),T.direction.setFromMatrixPosition(M.matrixWorld),s.setFromMatrixPosition(M.target.matrixWorld),T.direction.sub(s),T.direction.transformDirection(y),_++}else if(M.isRectAreaLight){const T=r.rectArea[E];T.position.setFromMatrixPosition(M.matrixWorld),T.position.applyMatrix4(y),a.identity(),o.copy(M.matrixWorld),o.premultiply(y),a.extractRotation(o),T.halfWidth.set(.5*M.width,0,0),T.halfHeight.set(0,.5*M.height,0),T.halfWidth.applyMatrix4(a),T.halfHeight.applyMatrix4(a),E++}else if(M.isPointLight){const T=r.point[m];T.position.setFromMatrixPosition(M.matrixWorld),T.position.applyMatrix4(y),m++}else if(M.isHemisphereLight){const T=r.hemi[v];T.direction.setFromMatrixPosition(M.matrixWorld),T.direction.transformDirection(y),v++}}},state:r}}function hB(n,e){const t=new ate(n,e),i=[],r=[];return{init:function s(){i.length=0,r.length=0},state:{lightsArray:i,shadowsArray:r,lights:t},setupLights:function l(f){t.setup(i,f)},setupLightsView:function c(f){t.setupView(i,f)},pushLight:function o(f){i.push(f)},pushShadow:function a(f){r.push(f)}}}function lte(n,e){let t=new WeakMap;return{get:function i(s,o=0){const a=t.get(s);let l;return void 0===a?(l=new hB(n,e),t.set(s,[l])):o>=a.length?(l=new hB(n,e),a.push(l)):l=a[o],l},dispose:function r(){t=new WeakMap}}}class fB extends ya{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class pB extends ya{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function dte(n,e,t){let i=new t1;const r=new he,s=new he,o=new kn,a=new fB({depthPacking:3201}),l=new pB,c={},d=t.maxTextureSize,f={0:1,1:0,2:2},p=new _u({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new he},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),m=p.clone();m.defines.HORIZONTAL_PASS=1;const _=new en;_.setAttribute("position",new wi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const E=new xr(_,p),v=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=TU;let y=this.type;function S(T,I){const A=e.update(E);p.defines.VSM_SAMPLES!==T.blurSamples&&(p.defines.VSM_SAMPLES=T.blurSamples,m.defines.VSM_SAMPLES=T.blurSamples,p.needsUpdate=!0,m.needsUpdate=!0),null===T.mapPass&&(T.mapPass=new zd(r.x,r.y)),p.uniforms.shadow_pass.value=T.map.texture,p.uniforms.resolution.value=T.mapSize,p.uniforms.radius.value=T.radius,n.setRenderTarget(T.mapPass),n.clear(),n.renderBufferDirect(I,null,A,p,E,null),m.uniforms.shadow_pass.value=T.mapPass.texture,m.uniforms.resolution.value=T.mapSize,m.uniforms.radius.value=T.radius,n.setRenderTarget(T.map),n.clear(),n.renderBufferDirect(I,null,A,m,E,null)}function b(T,I,A,F){let C=null;const N=!0===A.isPointLight?T.customDistanceMaterial:T.customDepthMaterial;if(void 0!==N)C=N;else if(C=!0===A.isPointLight?l:a,n.localClippingEnabled&&!0===I.clipShadows&&Array.isArray(I.clippingPlanes)&&0!==I.clippingPlanes.length||I.displacementMap&&0!==I.displacementScale||I.alphaMap&&I.alphaTest>0||I.map&&I.alphaTest>0){const K=C.uuid,oe=I.uuid;let ue=c[K];void 0===ue&&(ue={},c[K]=ue);let W=ue[oe];void 0===W&&(W=C.clone(),ue[oe]=W),C=W}return C.visible=I.visible,C.wireframe=I.wireframe,C.side=F===Wl?null!==I.shadowSide?I.shadowSide:I.side:null!==I.shadowSide?I.shadowSide:f[I.side],C.alphaMap=I.alphaMap,C.alphaTest=I.alphaTest,C.map=I.map,C.clipShadows=I.clipShadows,C.clippingPlanes=I.clippingPlanes,C.clipIntersection=I.clipIntersection,C.displacementMap=I.displacementMap,C.displacementScale=I.displacementScale,C.displacementBias=I.displacementBias,C.wireframeLinewidth=I.wireframeLinewidth,C.linewidth=I.linewidth,!0===A.isPointLight&&!0===C.isMeshDistanceMaterial&&(n.properties.get(C).light=A),C}function M(T,I,A,F,C){if(!1===T.visible)return;if(T.layers.test(I.layers)&&(T.isMesh||T.isLine||T.isPoints)&&(T.castShadow||T.receiveShadow&&C===Wl)&&(!T.frustumCulled||i.intersectsObject(T))){T.modelViewMatrix.multiplyMatrices(A.matrixWorldInverse,T.matrixWorld);const oe=e.update(T),ue=T.material;if(Array.isArray(ue)){const W=oe.groups;for(let J=0,$=W.length;J<$;J++){const Y=W[J],ie=ue[Y.materialIndex];if(ie&&ie.visible){const Z=b(T,ie,F,C);n.renderBufferDirect(A,null,oe,Z,T,Y)}}}else if(ue.visible){const W=b(T,ue,F,C);n.renderBufferDirect(A,null,oe,W,T,null)}}const K=T.children;for(let oe=0,ue=K.length;oe<ue;oe++)M(K[oe],I,A,F,C)}this.render=function(T,I,A){if(!1===v.enabled||!1===v.autoUpdate&&!1===v.needsUpdate||0===T.length)return;const F=n.getRenderTarget(),C=n.getActiveCubeFace(),N=n.getActiveMipmapLevel(),K=n.state;K.setBlending(0),K.buffers.color.setClear(1,1,1,1),K.buffers.depth.setTest(!0),K.setScissorTest(!1);const oe=y!==Wl&&this.type===Wl,ue=y===Wl&&this.type!==Wl;for(let W=0,J=T.length;W<J;W++){const $=T[W],Y=$.shadow;if(void 0===Y){console.warn("THREE.WebGLShadowMap:",$,"has no shadow.");continue}if(!1===Y.autoUpdate&&!1===Y.needsUpdate)continue;r.copy(Y.mapSize);const ie=Y.getFrameExtents();if(r.multiply(ie),s.copy(Y.mapSize),(r.x>d||r.y>d)&&(r.x>d&&(s.x=Math.floor(d/ie.x),r.x=s.x*ie.x,Y.mapSize.x=s.x),r.y>d&&(s.y=Math.floor(d/ie.y),r.y=s.y*ie.y,Y.mapSize.y=s.y)),null===Y.map||!0===oe||!0===ue){const de=this.type!==Wl?{minFilter:Oi,magFilter:Oi}:{};null!==Y.map&&Y.map.dispose(),Y.map=new zd(r.x,r.y,de),Y.map.texture.name=$.name+".shadowMap",Y.camera.updateProjectionMatrix()}n.setRenderTarget(Y.map),n.clear();const Z=Y.getViewportCount();for(let de=0;de<Z;de++){const q=Y.getViewport(de);o.set(s.x*q.x,s.y*q.y,s.x*q.z,s.y*q.w),K.viewport(o),Y.updateMatrices($,de),i=Y.getFrustum(),M(I,A,Y.camera,$,this.type)}!0!==Y.isPointLightShadow&&this.type===Wl&&S(Y,A),Y.needsUpdate=!1}y=this.type,v.needsUpdate=!1,n.setRenderTarget(F,C,N)}}function hte(n,e,t){const i=t.isWebGL2,a=new function r(){let V=!1;const Le=new kn;let Re=null;const We=new kn(0,0,0,0);return{setMask:function(Oe){Re!==Oe&&!V&&(n.colorMask(Oe,Oe,Oe,Oe),Re=Oe)},setLocked:function(Oe){V=Oe},setClear:function(Oe,we,ot,Dt,Zi){!0===Zi&&(Oe*=Dt,we*=Dt,ot*=Dt),Le.set(Oe,we,ot,Dt),!1===We.equals(Le)&&(n.clearColor(Oe,we,ot,Dt),We.copy(Le))},reset:function(){V=!1,Re=null,We.set(-1,0,0,0)}}},l=new function s(){let V=!1,Le=null,Re=null,We=null;return{setTest:function(Oe){Oe?Ge(n.DEPTH_TEST):Ze(n.DEPTH_TEST)},setMask:function(Oe){Le!==Oe&&!V&&(n.depthMask(Oe),Le=Oe)},setFunc:function(Oe){if(Re!==Oe){switch(Oe){case 0:n.depthFunc(n.NEVER);break;case 1:n.depthFunc(n.ALWAYS);break;case 2:n.depthFunc(n.LESS);break;case 3:default:n.depthFunc(n.LEQUAL);break;case 4:n.depthFunc(n.EQUAL);break;case 5:n.depthFunc(n.GEQUAL);break;case 6:n.depthFunc(n.GREATER);break;case 7:n.depthFunc(n.NOTEQUAL)}Re=Oe}},setLocked:function(Oe){V=Oe},setClear:function(Oe){We!==Oe&&(n.clearDepth(Oe),We=Oe)},reset:function(){V=!1,Le=null,Re=null,We=null}}},c=new function o(){let V=!1,Le=null,Re=null,We=null,Oe=null,we=null,ot=null,Dt=null,Zi=null;return{setTest:function(oi){V||(oi?Ge(n.STENCIL_TEST):Ze(n.STENCIL_TEST))},setMask:function(oi){Le!==oi&&!V&&(n.stencilMask(oi),Le=oi)},setFunc:function(oi,al,bs){(Re!==oi||We!==al||Oe!==bs)&&(n.stencilFunc(oi,al,bs),Re=oi,We=al,Oe=bs)},setOp:function(oi,al,bs){(we!==oi||ot!==al||Dt!==bs)&&(n.stencilOp(oi,al,bs),we=oi,ot=al,Dt=bs)},setLocked:function(oi){V=oi},setClear:function(oi){Zi!==oi&&(n.clearStencil(oi),Zi=oi)},reset:function(){V=!1,Le=null,Re=null,We=null,Oe=null,we=null,ot=null,Dt=null,Zi=null}}},d=new WeakMap,f=new WeakMap;let p={},m={},_=new WeakMap,E=[],v=null,y=!1,S=null,b=null,M=null,T=null,I=null,A=null,F=null,C=!1,N=null,K=null,oe=null,ue=null,W=null;const J=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let $=!1,Y=0;const ie=n.getParameter(n.VERSION);-1!==ie.indexOf("WebGL")?(Y=parseFloat(/^WebGL (\d)/.exec(ie)[1]),$=Y>=1):-1!==ie.indexOf("OpenGL ES")&&(Y=parseFloat(/^OpenGL ES (\d)/.exec(ie)[1]),$=Y>=2);let Z=null,de={};const q=n.getParameter(n.SCISSOR_BOX),se=n.getParameter(n.VIEWPORT),xe=(new kn).fromArray(q),Se=(new kn).fromArray(se);function ze(V,Le,Re,We){const Oe=new Uint8Array(4),we=n.createTexture();n.bindTexture(V,we),n.texParameteri(V,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(V,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let ot=0;ot<Re;ot++)!i||V!==n.TEXTURE_3D&&V!==n.TEXTURE_2D_ARRAY?n.texImage2D(Le+ot,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,Oe):n.texImage3D(Le,0,n.RGBA,1,1,We,0,n.RGBA,n.UNSIGNED_BYTE,Oe);return we}const nt={};function Ge(V){!0!==p[V]&&(n.enable(V),p[V]=!0)}function Ze(V){!1!==p[V]&&(n.disable(V),p[V]=!1)}nt[n.TEXTURE_2D]=ze(n.TEXTURE_2D,n.TEXTURE_2D,1),nt[n.TEXTURE_CUBE_MAP]=ze(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),i&&(nt[n.TEXTURE_2D_ARRAY]=ze(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),nt[n.TEXTURE_3D]=ze(n.TEXTURE_3D,n.TEXTURE_3D,1,1)),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),Ge(n.DEPTH_TEST),l.setFunc(3),be(!1),ut(1),Ge(n.CULL_FACE),_e(0);const H={100:n.FUNC_ADD,101:n.FUNC_SUBTRACT,102:n.FUNC_REVERSE_SUBTRACT};if(i)H[103]=n.MIN,H[104]=n.MAX;else{const V=e.get("EXT_blend_minmax");null!==V&&(H[103]=V.MIN_EXT,H[104]=V.MAX_EXT)}const Pe={200:n.ZERO,201:n.ONE,202:n.SRC_COLOR,204:n.SRC_ALPHA,210:n.SRC_ALPHA_SATURATE,208:n.DST_COLOR,206:n.DST_ALPHA,203:n.ONE_MINUS_SRC_COLOR,205:n.ONE_MINUS_SRC_ALPHA,209:n.ONE_MINUS_DST_COLOR,207:n.ONE_MINUS_DST_ALPHA};function _e(V,Le,Re,We,Oe,we,ot,Dt){if(0!==V){if(!1===y&&(Ge(n.BLEND),y=!0),5===V)Oe=Oe||Le,we=we||Re,ot=ot||We,(Le!==b||Oe!==I)&&(n.blendEquationSeparate(H[Le],H[Oe]),b=Le,I=Oe),(Re!==M||We!==T||we!==A||ot!==F)&&(n.blendFuncSeparate(Pe[Re],Pe[We],Pe[we],Pe[ot]),M=Re,T=We,A=we,F=ot),S=V,C=!1;else if(V!==S||Dt!==C){if((100!==b||100!==I)&&(n.blendEquation(n.FUNC_ADD),b=100,I=100),Dt)switch(V){case 1:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case 2:n.blendFunc(n.ONE,n.ONE);break;case 3:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case 4:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",V)}else switch(V){case 1:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case 2:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case 3:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case 4:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",V)}M=null,T=null,A=null,F=null,S=V,C=Dt}}else!0===y&&(Ze(n.BLEND),y=!1)}function be(V){N!==V&&(n.frontFace(V?n.CW:n.CCW),N=V)}function ut(V){0!==V?(Ge(n.CULL_FACE),V!==K&&n.cullFace(1===V?n.BACK:2===V?n.FRONT:n.FRONT_AND_BACK)):Ze(n.CULL_FACE),K=V}function et(V,Le,Re){V?(Ge(n.POLYGON_OFFSET_FILL),(ue!==Le||W!==Re)&&(n.polygonOffset(Le,Re),ue=Le,W=Re)):Ze(n.POLYGON_OFFSET_FILL)}return{buffers:{color:a,depth:l,stencil:c},enable:Ge,disable:Ze,bindFramebuffer:function St(V,Le){return m[V]!==Le&&(n.bindFramebuffer(V,Le),m[V]=Le,i&&(V===n.DRAW_FRAMEBUFFER&&(m[n.FRAMEBUFFER]=Le),V===n.FRAMEBUFFER&&(m[n.DRAW_FRAMEBUFFER]=Le)),!0)},drawBuffers:function Kt(V,Le){let Re=E,We=!1;if(V)if(Re=_.get(Le),void 0===Re&&(Re=[],_.set(Le,Re)),V.isWebGLMultipleRenderTargets){const Oe=V.texture;if(Re.length!==Oe.length||Re[0]!==n.COLOR_ATTACHMENT0){for(let we=0,ot=Oe.length;we<ot;we++)Re[we]=n.COLOR_ATTACHMENT0+we;Re.length=Oe.length,We=!0}}else Re[0]!==n.COLOR_ATTACHMENT0&&(Re[0]=n.COLOR_ATTACHMENT0,We=!0);else Re[0]!==n.BACK&&(Re[0]=n.BACK,We=!0);We&&(t.isWebGL2?n.drawBuffers(Re):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Re))},useProgram:function lt(V){return v!==V&&(n.useProgram(V),v=V,!0)},setBlending:_e,setMaterial:function Ce(V,Le){2===V.side?Ze(n.CULL_FACE):Ge(n.CULL_FACE);let Re=1===V.side;Le&&(Re=!Re),be(Re),1===V.blending&&!1===V.transparent?_e(0):_e(V.blending,V.blendEquation,V.blendSrc,V.blendDst,V.blendEquationAlpha,V.blendSrcAlpha,V.blendDstAlpha,V.premultipliedAlpha),l.setFunc(V.depthFunc),l.setTest(V.depthTest),l.setMask(V.depthWrite),a.setMask(V.colorWrite);const We=V.stencilWrite;c.setTest(We),We&&(c.setMask(V.stencilWriteMask),c.setFunc(V.stencilFunc,V.stencilRef,V.stencilFuncMask),c.setOp(V.stencilFail,V.stencilZFail,V.stencilZPass)),et(V.polygonOffset,V.polygonOffsetFactor,V.polygonOffsetUnits),!0===V.alphaToCoverage?Ge(n.SAMPLE_ALPHA_TO_COVERAGE):Ze(n.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:be,setCullFace:ut,setLineWidth:function Je(V){V!==oe&&($&&n.lineWidth(V),oe=V)},setPolygonOffset:et,setScissorTest:function Mt(V){V?Ge(n.SCISSOR_TEST):Ze(n.SCISSOR_TEST)},activeTexture:function on(V){void 0===V&&(V=n.TEXTURE0+J-1),Z!==V&&(n.activeTexture(V),Z=V)},bindTexture:function ci(V,Le,Re){void 0===Re&&(Re=null===Z?n.TEXTURE0+J-1:Z);let We=de[Re];void 0===We&&(We={type:void 0,texture:void 0},de[Re]=We),(We.type!==V||We.texture!==Le)&&(Z!==Re&&(n.activeTexture(Re),Z=Re),n.bindTexture(V,Le||nt[V]),We.type=V,We.texture=Le)},unbindTexture:function k(){const V=de[Z];void 0!==V&&void 0!==V.type&&(n.bindTexture(V.type,null),V.type=void 0,V.texture=void 0)},compressedTexImage2D:function R(){try{n.compressedTexImage2D.apply(n,arguments)}catch(V){console.error("THREE.WebGLState:",V)}},compressedTexImage3D:function te(){try{n.compressedTexImage3D.apply(n,arguments)}catch(V){console.error("THREE.WebGLState:",V)}},texImage2D:function z(){try{n.texImage2D.apply(n,arguments)}catch(V){console.error("THREE.WebGLState:",V)}},texImage3D:function Ie(){try{n.texImage3D.apply(n,arguments)}catch(V){console.error("THREE.WebGLState:",V)}},updateUBOMapping:function dt(V,Le){let Re=f.get(Le);void 0===Re&&(Re=new WeakMap,f.set(Le,Re));let We=Re.get(V);void 0===We&&(We=n.getUniformBlockIndex(Le,V.name),Re.set(V,We))},uniformBlockBinding:function gt(V,Le){const We=f.get(Le).get(V);d.get(Le)!==We&&(n.uniformBlockBinding(Le,We,V.__bindingPointIndex),d.set(Le,We))},texStorage2D:function De(){try{n.texStorage2D.apply(n,arguments)}catch(V){console.error("THREE.WebGLState:",V)}},texStorage3D:function $e(){try{n.texStorage3D.apply(n,arguments)}catch(V){console.error("THREE.WebGLState:",V)}},texSubImage2D:function Te(){try{n.texSubImage2D.apply(n,arguments)}catch(V){console.error("THREE.WebGLState:",V)}},texSubImage3D:function Me(){try{n.texSubImage3D.apply(n,arguments)}catch(V){console.error("THREE.WebGLState:",V)}},compressedTexSubImage2D:function Ae(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(V){console.error("THREE.WebGLState:",V)}},compressedTexSubImage3D:function at(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(V){console.error("THREE.WebGLState:",V)}},scissor:function ve(V){!1===xe.equals(V)&&(n.scissor(V.x,V.y,V.z,V.w),xe.copy(V))},viewport:function Tt(V){!1===Se.equals(V)&&(n.viewport(V.x,V.y,V.z,V.w),Se.copy(V))},reset:function ct(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),!0===i&&(n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),p={},Z=null,de={},m={},_=new WeakMap,E=[],v=null,y=!1,S=null,b=null,M=null,T=null,I=null,A=null,F=null,C=!1,N=null,K=null,oe=null,ue=null,W=null,xe.set(0,0,n.canvas.width,n.canvas.height),Se.set(0,0,n.canvas.width,n.canvas.height),a.reset(),l.reset(),c.reset()}}}function fte(n,e,t,i,r,s,o){const a=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,d=r.maxTextureSize,f=r.maxSamples,p=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,m=!(typeof navigator>"u")&&/OculusBrowser/g.test(navigator.userAgent),_=new WeakMap;let E;const v=new WeakMap;let y=!1;try{y=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function S(k,R){return y?new OffscreenCanvas(k,R):Ay("canvas")}function b(k,R,te,Te){let Me=1;if((k.width>Te||k.height>Te)&&(Me=Te/Math.max(k.width,k.height)),Me<1||!0===R){if(typeof HTMLImageElement<"u"&&k instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&k instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&k instanceof ImageBitmap){const Ae=R?ES:Math.floor,at=Ae(Me*k.width),De=Ae(Me*k.height);void 0===E&&(E=S(at,De));const $e=te?S(at,De):E;return $e.width=at,$e.height=De,$e.getContext("2d").drawImage(k,0,0,at,De),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+k.width+"x"+k.height+") to ("+at+"x"+De+")."),$e}return"data"in k&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+k.width+"x"+k.height+")."),k}return k}function M(k){return ND(k.width)&&ND(k.height)}function I(k,R){return k.generateMipmaps&&R&&k.minFilter!==Oi&&k.minFilter!==bi}function A(k){n.generateMipmap(k)}function F(k,R,te,Te,Me=!1){if(!1===a)return R;if(null!==k){if(void 0!==n[k])return n[k];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+k+"'")}let Ae=R;if(R===n.RED&&(te===n.FLOAT&&(Ae=n.R32F),te===n.HALF_FLOAT&&(Ae=n.R16F),te===n.UNSIGNED_BYTE&&(Ae=n.R8)),R===n.RED_INTEGER&&(te===n.UNSIGNED_BYTE&&(Ae=n.R8UI),te===n.UNSIGNED_SHORT&&(Ae=n.R16UI),te===n.UNSIGNED_INT&&(Ae=n.R32UI),te===n.BYTE&&(Ae=n.R8I),te===n.SHORT&&(Ae=n.R16I),te===n.INT&&(Ae=n.R32I)),R===n.RG&&(te===n.FLOAT&&(Ae=n.RG32F),te===n.HALF_FLOAT&&(Ae=n.RG16F),te===n.UNSIGNED_BYTE&&(Ae=n.RG8)),R===n.RGBA){const at=Me?mS:Cn.getTransfer(Te);te===n.FLOAT&&(Ae=n.RGBA32F),te===n.HALF_FLOAT&&(Ae=n.RGBA16F),te===n.UNSIGNED_BYTE&&(Ae=at===ri?n.SRGB8_ALPHA8:n.RGBA8),te===n.UNSIGNED_SHORT_4_4_4_4&&(Ae=n.RGBA4),te===n.UNSIGNED_SHORT_5_5_5_1&&(Ae=n.RGB5_A1)}return(Ae===n.R16F||Ae===n.R32F||Ae===n.RG16F||Ae===n.RG32F||Ae===n.RGBA16F||Ae===n.RGBA32F)&&e.get("EXT_color_buffer_float"),Ae}function C(k,R,te){return!0===I(k,te)||k.isFramebufferTexture&&k.minFilter!==Oi&&k.minFilter!==bi?Math.log2(Math.max(R.width,R.height))+1:void 0!==k.mipmaps&&k.mipmaps.length>0?k.mipmaps.length:k.isCompressedTexture&&Array.isArray(k.image)?R.mipmaps.length:1}function N(k){return k===Oi||1004===k||1005===k?n.NEAREST:n.LINEAR}function K(k){const R=k.target;R.removeEventListener("dispose",K),function ue(k){const R=i.get(k);if(void 0===R.__webglInit)return;const te=k.source,Te=v.get(te);if(Te){const Me=Te[R.__cacheKey];Me.usedTimes--,0===Me.usedTimes&&W(k),0===Object.keys(Te).length&&v.delete(te)}i.remove(k)}(R),R.isVideoTexture&&_.delete(R)}function oe(k){const R=k.target;R.removeEventListener("dispose",oe),function J(k){const R=k.texture,te=i.get(k),Te=i.get(R);if(void 0!==Te.__webglTexture&&(n.deleteTexture(Te.__webglTexture),o.memory.textures--),k.depthTexture&&k.depthTexture.dispose(),k.isWebGLCubeRenderTarget)for(let Me=0;Me<6;Me++){if(Array.isArray(te.__webglFramebuffer[Me]))for(let Ae=0;Ae<te.__webglFramebuffer[Me].length;Ae++)n.deleteFramebuffer(te.__webglFramebuffer[Me][Ae]);else n.deleteFramebuffer(te.__webglFramebuffer[Me]);te.__webglDepthbuffer&&n.deleteRenderbuffer(te.__webglDepthbuffer[Me])}else{if(Array.isArray(te.__webglFramebuffer))for(let Me=0;Me<te.__webglFramebuffer.length;Me++)n.deleteFramebuffer(te.__webglFramebuffer[Me]);else n.deleteFramebuffer(te.__webglFramebuffer);if(te.__webglDepthbuffer&&n.deleteRenderbuffer(te.__webglDepthbuffer),te.__webglMultisampledFramebuffer&&n.deleteFramebuffer(te.__webglMultisampledFramebuffer),te.__webglColorRenderbuffer)for(let Me=0;Me<te.__webglColorRenderbuffer.length;Me++)te.__webglColorRenderbuffer[Me]&&n.deleteRenderbuffer(te.__webglColorRenderbuffer[Me]);te.__webglDepthRenderbuffer&&n.deleteRenderbuffer(te.__webglDepthRenderbuffer)}if(k.isWebGLMultipleRenderTargets)for(let Me=0,Ae=R.length;Me<Ae;Me++){const at=i.get(R[Me]);at.__webglTexture&&(n.deleteTexture(at.__webglTexture),o.memory.textures--),i.remove(R[Me])}i.remove(R),i.remove(k)}(R)}function W(k){const R=i.get(k);n.deleteTexture(R.__webglTexture),delete v.get(k.source)[R.__cacheKey],o.memory.textures--}let $=0;function de(k,R){const te=i.get(k);if(k.isVideoTexture&&function on(k){const R=o.render.frame;_.get(k)!==R&&(_.set(k,R),k.update())}(k),!1===k.isRenderTargetTexture&&k.version>0&&te.__version!==k.version){const Te=k.image;if(null===Te)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==Te.complete)return void St(te,k,R);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.bindTexture(n.TEXTURE_2D,te.__webglTexture,n.TEXTURE0+R)}const Se={[Od]:n.REPEAT,[Kr]:n.CLAMP_TO_EDGE,1002:n.MIRRORED_REPEAT},ze={[Oi]:n.NEAREST,1004:n.NEAREST_MIPMAP_NEAREST,1005:n.NEAREST_MIPMAP_LINEAR,[bi]:n.LINEAR,1007:n.LINEAR_MIPMAP_NEAREST,[jl]:n.LINEAR_MIPMAP_LINEAR},nt={512:n.NEVER,519:n.ALWAYS,513:n.LESS,515:n.LEQUAL,514:n.EQUAL,518:n.GEQUAL,516:n.GREATER,517:n.NOTEQUAL};function Ge(k,R,te){if(te?(n.texParameteri(k,n.TEXTURE_WRAP_S,Se[R.wrapS]),n.texParameteri(k,n.TEXTURE_WRAP_T,Se[R.wrapT]),(k===n.TEXTURE_3D||k===n.TEXTURE_2D_ARRAY)&&n.texParameteri(k,n.TEXTURE_WRAP_R,Se[R.wrapR]),n.texParameteri(k,n.TEXTURE_MAG_FILTER,ze[R.magFilter]),n.texParameteri(k,n.TEXTURE_MIN_FILTER,ze[R.minFilter])):(n.texParameteri(k,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(k,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),(k===n.TEXTURE_3D||k===n.TEXTURE_2D_ARRAY)&&n.texParameteri(k,n.TEXTURE_WRAP_R,n.CLAMP_TO_EDGE),(R.wrapS!==Kr||R.wrapT!==Kr)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(k,n.TEXTURE_MAG_FILTER,N(R.magFilter)),n.texParameteri(k,n.TEXTURE_MIN_FILTER,N(R.minFilter)),R.minFilter!==Oi&&R.minFilter!==bi&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),R.compareFunction&&(n.texParameteri(k,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(k,n.TEXTURE_COMPARE_FUNC,nt[R.compareFunction])),!0===e.has("EXT_texture_filter_anisotropic")){const Te=e.get("EXT_texture_filter_anisotropic");if(R.magFilter===Oi||1005!==R.minFilter&&R.minFilter!==jl||R.type===ql&&!1===e.has("OES_texture_float_linear")||!1===a&&R.type===xy&&!1===e.has("OES_texture_half_float_linear"))return;(R.anisotropy>1||i.get(R).__currentAnisotropy)&&(n.texParameterf(k,Te.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(R.anisotropy,r.getMaxAnisotropy())),i.get(R).__currentAnisotropy=R.anisotropy)}}function Ze(k,R){let te=!1;void 0===k.__webglInit&&(k.__webglInit=!0,R.addEventListener("dispose",K));const Te=R.source;let Me=v.get(Te);void 0===Me&&(Me={},v.set(Te,Me));const Ae=function Z(k){const R=[];return R.push(k.wrapS),R.push(k.wrapT),R.push(k.wrapR||0),R.push(k.magFilter),R.push(k.minFilter),R.push(k.anisotropy),R.push(k.internalFormat),R.push(k.format),R.push(k.type),R.push(k.generateMipmaps),R.push(k.premultiplyAlpha),R.push(k.flipY),R.push(k.unpackAlignment),R.push(k.colorSpace),R.join()}(R);if(Ae!==k.__cacheKey){void 0===Me[Ae]&&(Me[Ae]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,te=!0),Me[Ae].usedTimes++;const at=Me[k.__cacheKey];void 0!==at&&(Me[k.__cacheKey].usedTimes--,0===at.usedTimes&&W(R)),k.__cacheKey=Ae,k.__webglTexture=Me[Ae].texture}return te}function St(k,R,te){let Te=n.TEXTURE_2D;(R.isDataArrayTexture||R.isCompressedArrayTexture)&&(Te=n.TEXTURE_2D_ARRAY),R.isData3DTexture&&(Te=n.TEXTURE_3D);const Me=Ze(k,R),Ae=R.source;t.bindTexture(Te,k.__webglTexture,n.TEXTURE0+te);const at=i.get(Ae);if(Ae.version!==at.__version||!0===Me){t.activeTexture(n.TEXTURE0+te);const De=Cn.getPrimaries(Cn.workingColorSpace),$e=""===R.colorSpace?null:Cn.getPrimaries(R.colorSpace),z=""===R.colorSpace||De===$e?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,R.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,R.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,R.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,z);const Ie=function T(k){return!a&&(k.wrapS!==Kr||k.wrapT!==Kr||k.minFilter!==Oi&&k.minFilter!==bi)}(R)&&!1===M(R.image);let ve=b(R.image,Ie,!1,d);ve=ci(R,ve);const Tt=M(ve)||a,dt=s.convert(R.format,R.colorSpace);let V,gt=s.convert(R.type),ct=F(R.internalFormat,dt,gt,R.colorSpace,R.isVideoTexture);Ge(Te,R,Tt);const Le=R.mipmaps,Re=a&&!0!==R.isVideoTexture,We=void 0===at.__version||!0===Me,Oe=C(R,ve,Tt);if(R.isDepthTexture)ct=n.DEPTH_COMPONENT,a?ct=R.type===ql?n.DEPTH_COMPONENT32F:R.type===du?n.DEPTH_COMPONENT24:R.type===Fd?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT16:R.type===ql&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),R.format===kd&&ct===n.DEPTH_COMPONENT&&1012!==R.type&&R.type!==du&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),R.type=du,gt=s.convert(R.type)),R.format===Pp&&ct===n.DEPTH_COMPONENT&&(ct=n.DEPTH_STENCIL,R.type!==Fd&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),R.type=Fd,gt=s.convert(R.type))),We&&(Re?t.texStorage2D(n.TEXTURE_2D,1,ct,ve.width,ve.height):t.texImage2D(n.TEXTURE_2D,0,ct,ve.width,ve.height,0,dt,gt,null));else if(R.isDataTexture)if(Le.length>0&&Tt){Re&&We&&t.texStorage2D(n.TEXTURE_2D,Oe,ct,Le[0].width,Le[0].height);for(let we=0,ot=Le.length;we<ot;we++)V=Le[we],Re?t.texSubImage2D(n.TEXTURE_2D,we,0,0,V.width,V.height,dt,gt,V.data):t.texImage2D(n.TEXTURE_2D,we,ct,V.width,V.height,0,dt,gt,V.data);R.generateMipmaps=!1}else Re?(We&&t.texStorage2D(n.TEXTURE_2D,Oe,ct,ve.width,ve.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,ve.width,ve.height,dt,gt,ve.data)):t.texImage2D(n.TEXTURE_2D,0,ct,ve.width,ve.height,0,dt,gt,ve.data);else if(R.isCompressedTexture)if(R.isCompressedArrayTexture){Re&&We&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Oe,ct,Le[0].width,Le[0].height,ve.depth);for(let we=0,ot=Le.length;we<ot;we++)V=Le[we],R.format!==Uo?null!==dt?Re?t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,we,0,0,0,V.width,V.height,ve.depth,dt,V.data,0,0):t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,we,ct,V.width,V.height,ve.depth,0,V.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Re?t.texSubImage3D(n.TEXTURE_2D_ARRAY,we,0,0,0,V.width,V.height,ve.depth,dt,gt,V.data):t.texImage3D(n.TEXTURE_2D_ARRAY,we,ct,V.width,V.height,ve.depth,0,dt,gt,V.data)}else{Re&&We&&t.texStorage2D(n.TEXTURE_2D,Oe,ct,Le[0].width,Le[0].height);for(let we=0,ot=Le.length;we<ot;we++)V=Le[we],R.format!==Uo?null!==dt?Re?t.compressedTexSubImage2D(n.TEXTURE_2D,we,0,0,V.width,V.height,dt,V.data):t.compressedTexImage2D(n.TEXTURE_2D,we,ct,V.width,V.height,0,V.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Re?t.texSubImage2D(n.TEXTURE_2D,we,0,0,V.width,V.height,dt,gt,V.data):t.texImage2D(n.TEXTURE_2D,we,ct,V.width,V.height,0,dt,gt,V.data)}else if(R.isDataArrayTexture)Re?(We&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Oe,ct,ve.width,ve.height,ve.depth),t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,ve.width,ve.height,ve.depth,dt,gt,ve.data)):t.texImage3D(n.TEXTURE_2D_ARRAY,0,ct,ve.width,ve.height,ve.depth,0,dt,gt,ve.data);else if(R.isData3DTexture)Re?(We&&t.texStorage3D(n.TEXTURE_3D,Oe,ct,ve.width,ve.height,ve.depth),t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,ve.width,ve.height,ve.depth,dt,gt,ve.data)):t.texImage3D(n.TEXTURE_3D,0,ct,ve.width,ve.height,ve.depth,0,dt,gt,ve.data);else if(R.isFramebufferTexture){if(We)if(Re)t.texStorage2D(n.TEXTURE_2D,Oe,ct,ve.width,ve.height);else{let we=ve.width,ot=ve.height;for(let Dt=0;Dt<Oe;Dt++)t.texImage2D(n.TEXTURE_2D,Dt,ct,we,ot,0,dt,gt,null),we>>=1,ot>>=1}}else if(Le.length>0&&Tt){Re&&We&&t.texStorage2D(n.TEXTURE_2D,Oe,ct,Le[0].width,Le[0].height);for(let we=0,ot=Le.length;we<ot;we++)V=Le[we],Re?t.texSubImage2D(n.TEXTURE_2D,we,0,0,dt,gt,V):t.texImage2D(n.TEXTURE_2D,we,ct,dt,gt,V);R.generateMipmaps=!1}else Re?(We&&t.texStorage2D(n.TEXTURE_2D,Oe,ct,ve.width,ve.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,dt,gt,ve)):t.texImage2D(n.TEXTURE_2D,0,ct,dt,gt,ve);I(R,Tt)&&A(Te),at.__version=Ae.version,R.onUpdate&&R.onUpdate(R)}k.__version=R.version}function lt(k,R,te,Te,Me,Ae){const at=s.convert(te.format,te.colorSpace),De=s.convert(te.type),$e=F(te.internalFormat,at,De,te.colorSpace);if(!i.get(R).__hasExternalTextures){const Ie=Math.max(1,R.width>>Ae),ve=Math.max(1,R.height>>Ae);Me===n.TEXTURE_3D||Me===n.TEXTURE_2D_ARRAY?t.texImage3D(Me,Ae,$e,Ie,ve,R.depth,0,at,De,null):t.texImage2D(Me,Ae,$e,Ie,ve,0,at,De,null)}t.bindFramebuffer(n.FRAMEBUFFER,k),Mt(R)?p.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,Te,Me,i.get(te).__webglTexture,0,et(R)):(Me===n.TEXTURE_2D||Me>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&Me<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,Te,Me,i.get(te).__webglTexture,Ae),t.bindFramebuffer(n.FRAMEBUFFER,null)}function H(k,R,te){if(n.bindRenderbuffer(n.RENDERBUFFER,k),R.depthBuffer&&!R.stencilBuffer){let Te=!0===a?n.DEPTH_COMPONENT24:n.DEPTH_COMPONENT16;if(te||Mt(R)){const Me=R.depthTexture;Me&&Me.isDepthTexture&&(Me.type===ql?Te=n.DEPTH_COMPONENT32F:Me.type===du&&(Te=n.DEPTH_COMPONENT24));const Ae=et(R);Mt(R)?p.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Ae,Te,R.width,R.height):n.renderbufferStorageMultisample(n.RENDERBUFFER,Ae,Te,R.width,R.height)}else n.renderbufferStorage(n.RENDERBUFFER,Te,R.width,R.height);n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,k)}else if(R.depthBuffer&&R.stencilBuffer){const Te=et(R);te&&!1===Mt(R)?n.renderbufferStorageMultisample(n.RENDERBUFFER,Te,n.DEPTH24_STENCIL8,R.width,R.height):Mt(R)?p.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Te,n.DEPTH24_STENCIL8,R.width,R.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,R.width,R.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,k)}else{const Te=!0===R.isWebGLMultipleRenderTargets?R.texture:[R.texture];for(let Me=0;Me<Te.length;Me++){const Ae=Te[Me],at=s.convert(Ae.format,Ae.colorSpace),De=s.convert(Ae.type),$e=F(Ae.internalFormat,at,De,Ae.colorSpace),z=et(R);te&&!1===Mt(R)?n.renderbufferStorageMultisample(n.RENDERBUFFER,z,$e,R.width,R.height):Mt(R)?p.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,z,$e,R.width,R.height):n.renderbufferStorage(n.RENDERBUFFER,$e,R.width,R.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function _e(k){const R=i.get(k),te=!0===k.isWebGLCubeRenderTarget;if(k.depthTexture&&!R.__autoAllocateDepthBuffer){if(te)throw new Error("target.depthTexture not supported in Cube render targets");!function Pe(k,R){if(R&&R.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,k),!R.depthTexture||!R.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(R.depthTexture).__webglTexture||R.depthTexture.image.width!==R.width||R.depthTexture.image.height!==R.height)&&(R.depthTexture.image.width=R.width,R.depthTexture.image.height=R.height,R.depthTexture.needsUpdate=!0),de(R.depthTexture,0);const Te=i.get(R.depthTexture).__webglTexture,Me=et(R);if(R.depthTexture.format===kd)Mt(R)?p.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,Te,0,Me):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,Te,0);else{if(R.depthTexture.format!==Pp)throw new Error("Unknown depthTexture format");Mt(R)?p.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,Te,0,Me):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,Te,0)}}(R.__webglFramebuffer,k)}else if(te){R.__webglDepthbuffer=[];for(let Te=0;Te<6;Te++)t.bindFramebuffer(n.FRAMEBUFFER,R.__webglFramebuffer[Te]),R.__webglDepthbuffer[Te]=n.createRenderbuffer(),H(R.__webglDepthbuffer[Te],k,!1)}else t.bindFramebuffer(n.FRAMEBUFFER,R.__webglFramebuffer),R.__webglDepthbuffer=n.createRenderbuffer(),H(R.__webglDepthbuffer,k,!1);t.bindFramebuffer(n.FRAMEBUFFER,null)}function et(k){return Math.min(f,k.samples)}function Mt(k){const R=i.get(k);return a&&k.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==R.__useRenderToTexture}function ci(k,R){const te=k.colorSpace,Te=k.format,Me=k.type;return!0===k.isCompressedTexture||!0===k.isVideoTexture||1035===k.format||te!==Fr&&""!==te&&(Cn.getTransfer(te)===ri?!1===a?!0===e.has("EXT_sRGB")&&Te===Uo?(k.format=1035,k.minFilter=bi,k.generateMipmaps=!1):R=b3.sRGBToLinear(R):(Te!==Uo||Me!==uu)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",te)),R}this.allocateTextureUnit=function ie(){const k=$;return k>=l&&console.warn("THREE.WebGLTextures: Trying to use "+k+" texture units while this GPU supports only "+l),$+=1,k},this.resetTextureUnits=function Y(){$=0},this.setTexture2D=de,this.setTexture2DArray=function q(k,R){const te=i.get(k);k.version>0&&te.__version!==k.version?St(te,k,R):t.bindTexture(n.TEXTURE_2D_ARRAY,te.__webglTexture,n.TEXTURE0+R)},this.setTexture3D=function se(k,R){const te=i.get(k);k.version>0&&te.__version!==k.version?St(te,k,R):t.bindTexture(n.TEXTURE_3D,te.__webglTexture,n.TEXTURE0+R)},this.setTextureCube=function xe(k,R){const te=i.get(k);k.version>0&&te.__version!==k.version?function Kt(k,R,te){if(6!==R.image.length)return;const Te=Ze(k,R),Me=R.source;t.bindTexture(n.TEXTURE_CUBE_MAP,k.__webglTexture,n.TEXTURE0+te);const Ae=i.get(Me);if(Me.version!==Ae.__version||!0===Te){t.activeTexture(n.TEXTURE0+te);const at=Cn.getPrimaries(Cn.workingColorSpace),De=""===R.colorSpace?null:Cn.getPrimaries(R.colorSpace),$e=""===R.colorSpace||at===De?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,R.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,R.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,R.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,$e);const z=R.isCompressedTexture||R.image[0].isCompressedTexture,Ie=R.image[0]&&R.image[0].isDataTexture,ve=[];for(let we=0;we<6;we++)ve[we]=z||Ie?Ie?R.image[we].image:R.image[we]:b(R.image[we],!1,!0,c),ve[we]=ci(R,ve[we]);const Tt=ve[0],dt=M(Tt)||a,gt=s.convert(R.format,R.colorSpace),ct=s.convert(R.type),V=F(R.internalFormat,gt,ct,R.colorSpace),Le=a&&!0!==R.isVideoTexture,Re=void 0===Ae.__version||!0===Te;let Oe,We=C(R,Tt,dt);if(Ge(n.TEXTURE_CUBE_MAP,R,dt),z){Le&&Re&&t.texStorage2D(n.TEXTURE_CUBE_MAP,We,V,Tt.width,Tt.height);for(let we=0;we<6;we++){Oe=ve[we].mipmaps;for(let ot=0;ot<Oe.length;ot++){const Dt=Oe[ot];R.format!==Uo?null!==gt?Le?t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+we,ot,0,0,Dt.width,Dt.height,gt,Dt.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+we,ot,V,Dt.width,Dt.height,0,Dt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Le?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+we,ot,0,0,Dt.width,Dt.height,gt,ct,Dt.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+we,ot,V,Dt.width,Dt.height,0,gt,ct,Dt.data)}}}else{Oe=R.mipmaps,Le&&Re&&(Oe.length>0&&We++,t.texStorage2D(n.TEXTURE_CUBE_MAP,We,V,ve[0].width,ve[0].height));for(let we=0;we<6;we++)if(Ie){Le?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+we,0,0,0,ve[we].width,ve[we].height,gt,ct,ve[we].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+we,0,V,ve[we].width,ve[we].height,0,gt,ct,ve[we].data);for(let ot=0;ot<Oe.length;ot++){const Zi=Oe[ot].image[we].image;Le?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+we,ot+1,0,0,Zi.width,Zi.height,gt,ct,Zi.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+we,ot+1,V,Zi.width,Zi.height,0,gt,ct,Zi.data)}}else{Le?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+we,0,0,0,gt,ct,ve[we]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+we,0,V,gt,ct,ve[we]);for(let ot=0;ot<Oe.length;ot++){const Dt=Oe[ot];Le?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+we,ot+1,0,0,gt,ct,Dt.image[we]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+we,ot+1,V,gt,ct,Dt.image[we])}}}I(R,dt)&&A(n.TEXTURE_CUBE_MAP),Ae.__version=Me.version,R.onUpdate&&R.onUpdate(R)}k.__version=R.version}(te,k,R):t.bindTexture(n.TEXTURE_CUBE_MAP,te.__webglTexture,n.TEXTURE0+R)},this.rebindTextures=function Ce(k,R,te){const Te=i.get(k);void 0!==R&&lt(Te.__webglFramebuffer,k,k.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),void 0!==te&&_e(k)},this.setupRenderTarget=function be(k){const R=k.texture,te=i.get(k),Te=i.get(R);k.addEventListener("dispose",oe),!0!==k.isWebGLMultipleRenderTargets&&(void 0===Te.__webglTexture&&(Te.__webglTexture=n.createTexture()),Te.__version=R.version,o.memory.textures++);const Me=!0===k.isWebGLCubeRenderTarget,Ae=!0===k.isWebGLMultipleRenderTargets,at=M(k)||a;if(Me){te.__webglFramebuffer=[];for(let De=0;De<6;De++)if(a&&R.mipmaps&&R.mipmaps.length>0){te.__webglFramebuffer[De]=[];for(let $e=0;$e<R.mipmaps.length;$e++)te.__webglFramebuffer[De][$e]=n.createFramebuffer()}else te.__webglFramebuffer[De]=n.createFramebuffer()}else{if(a&&R.mipmaps&&R.mipmaps.length>0){te.__webglFramebuffer=[];for(let De=0;De<R.mipmaps.length;De++)te.__webglFramebuffer[De]=n.createFramebuffer()}else te.__webglFramebuffer=n.createFramebuffer();if(Ae)if(r.drawBuffers){const De=k.texture;for(let $e=0,z=De.length;$e<z;$e++){const Ie=i.get(De[$e]);void 0===Ie.__webglTexture&&(Ie.__webglTexture=n.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&k.samples>0&&!1===Mt(k)){const De=Ae?R:[R];te.__webglMultisampledFramebuffer=n.createFramebuffer(),te.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,te.__webglMultisampledFramebuffer);for(let $e=0;$e<De.length;$e++){const z=De[$e];te.__webglColorRenderbuffer[$e]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,te.__webglColorRenderbuffer[$e]);const Ie=s.convert(z.format,z.colorSpace),ve=s.convert(z.type),Tt=F(z.internalFormat,Ie,ve,z.colorSpace,!0===k.isXRRenderTarget),dt=et(k);n.renderbufferStorageMultisample(n.RENDERBUFFER,dt,Tt,k.width,k.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+$e,n.RENDERBUFFER,te.__webglColorRenderbuffer[$e])}n.bindRenderbuffer(n.RENDERBUFFER,null),k.depthBuffer&&(te.__webglDepthRenderbuffer=n.createRenderbuffer(),H(te.__webglDepthRenderbuffer,k,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(Me){t.bindTexture(n.TEXTURE_CUBE_MAP,Te.__webglTexture),Ge(n.TEXTURE_CUBE_MAP,R,at);for(let De=0;De<6;De++)if(a&&R.mipmaps&&R.mipmaps.length>0)for(let $e=0;$e<R.mipmaps.length;$e++)lt(te.__webglFramebuffer[De][$e],k,R,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+De,$e);else lt(te.__webglFramebuffer[De],k,R,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+De,0);I(R,at)&&A(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(Ae){const De=k.texture;for(let $e=0,z=De.length;$e<z;$e++){const Ie=De[$e],ve=i.get(Ie);t.bindTexture(n.TEXTURE_2D,ve.__webglTexture),Ge(n.TEXTURE_2D,Ie,at),lt(te.__webglFramebuffer,k,Ie,n.COLOR_ATTACHMENT0+$e,n.TEXTURE_2D,0),I(Ie,at)&&A(n.TEXTURE_2D)}t.unbindTexture()}else{let De=n.TEXTURE_2D;if((k.isWebGL3DRenderTarget||k.isWebGLArrayRenderTarget)&&(a?De=k.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(De,Te.__webglTexture),Ge(De,R,at),a&&R.mipmaps&&R.mipmaps.length>0)for(let $e=0;$e<R.mipmaps.length;$e++)lt(te.__webglFramebuffer[$e],k,R,n.COLOR_ATTACHMENT0,De,$e);else lt(te.__webglFramebuffer,k,R,n.COLOR_ATTACHMENT0,De,0);I(R,at)&&A(De),t.unbindTexture()}k.depthBuffer&&_e(k)},this.updateRenderTargetMipmap=function ut(k){const R=M(k)||a,te=!0===k.isWebGLMultipleRenderTargets?k.texture:[k.texture];for(let Te=0,Me=te.length;Te<Me;Te++){const Ae=te[Te];if(I(Ae,R)){const at=k.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D,De=i.get(Ae).__webglTexture;t.bindTexture(at,De),A(at),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function Je(k){if(a&&k.samples>0&&!1===Mt(k)){const R=k.isWebGLMultipleRenderTargets?k.texture:[k.texture],te=k.width,Te=k.height;let Me=n.COLOR_BUFFER_BIT;const Ae=[],at=k.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,De=i.get(k),$e=!0===k.isWebGLMultipleRenderTargets;if($e)for(let z=0;z<R.length;z++)t.bindFramebuffer(n.FRAMEBUFFER,De.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+z,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,De.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+z,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,De.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,De.__webglFramebuffer);for(let z=0;z<R.length;z++){Ae.push(n.COLOR_ATTACHMENT0+z),k.depthBuffer&&Ae.push(at);const Ie=void 0!==De.__ignoreDepthValues&&De.__ignoreDepthValues;if(!1===Ie&&(k.depthBuffer&&(Me|=n.DEPTH_BUFFER_BIT),k.stencilBuffer&&(Me|=n.STENCIL_BUFFER_BIT)),$e&&n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,De.__webglColorRenderbuffer[z]),!0===Ie&&(n.invalidateFramebuffer(n.READ_FRAMEBUFFER,[at]),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[at])),$e){const ve=i.get(R[z]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,ve,0)}n.blitFramebuffer(0,0,te,Te,0,0,te,Te,Me,n.NEAREST),m&&n.invalidateFramebuffer(n.READ_FRAMEBUFFER,Ae)}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),$e)for(let z=0;z<R.length;z++){t.bindFramebuffer(n.FRAMEBUFFER,De.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+z,n.RENDERBUFFER,De.__webglColorRenderbuffer[z]);const Ie=i.get(R[z]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,De.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+z,n.TEXTURE_2D,Ie,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,De.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=_e,this.setupFrameBufferTexture=lt,this.useMultisampledRTT=Mt}function pte(n,e,t){const i=t.isWebGL2;return{convert:function r(s,o=""){let a;const l=Cn.getTransfer(o);if(s===uu)return n.UNSIGNED_BYTE;if(1017===s)return n.UNSIGNED_SHORT_4_4_4_4;if(1018===s)return n.UNSIGNED_SHORT_5_5_5_1;if(1010===s)return n.BYTE;if(1011===s)return n.SHORT;if(1012===s)return n.UNSIGNED_SHORT;if(1013===s)return n.INT;if(s===du)return n.UNSIGNED_INT;if(s===ql)return n.FLOAT;if(s===xy)return i?n.HALF_FLOAT:(a=e.get("OES_texture_half_float"),null!==a?a.HALF_FLOAT_OES:null);if(1021===s)return n.ALPHA;if(s===Uo)return n.RGBA;if(1024===s)return n.LUMINANCE;if(1025===s)return n.LUMINANCE_ALPHA;if(s===kd)return n.DEPTH_COMPONENT;if(s===Pp)return n.DEPTH_STENCIL;if(1035===s)return a=e.get("EXT_sRGB"),null!==a?a.SRGB_ALPHA_EXT:null;if(1028===s)return n.RED;if(1029===s)return n.RED_INTEGER;if(1030===s)return n.RG;if(1031===s)return n.RG_INTEGER;if(1033===s)return n.RGBA_INTEGER;if(33776===s||33777===s||33778===s||33779===s)if(l===ri){if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===a)return null;if(33776===s)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(a=e.get("WEBGL_compressed_texture_s3tc"),null===a)return null;if(33776===s)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===s)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===s)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===s)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===s||35841===s||35842===s||35843===s){if(a=e.get("WEBGL_compressed_texture_pvrtc"),null===a)return null;if(35840===s)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===s)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===s)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===s)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===s)return a=e.get("WEBGL_compressed_texture_etc1"),null!==a?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===s||37496===s){if(a=e.get("WEBGL_compressed_texture_etc"),null===a)return null;if(37492===s)return l===ri?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(37496===s)return l===ri?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}if(37808===s||37809===s||37810===s||37811===s||37812===s||37813===s||37814===s||37815===s||37816===s||37817===s||37818===s||37819===s||37820===s||37821===s){if(a=e.get("WEBGL_compressed_texture_astc"),null===a)return null;if(37808===s)return l===ri?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===s)return l===ri?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===s)return l===ri?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===s)return l===ri?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===s)return l===ri?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===s)return l===ri?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===s)return l===ri?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===s)return l===ri?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===s)return l===ri?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===s)return l===ri?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===s)return l===ri?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===s)return l===ri?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===s)return l===ri?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===s)return l===ri?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===s||36494===s||36495===s){if(a=e.get("EXT_texture_compression_bptc"),null===a)return null;if(36492===s)return l===ri?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(36494===s)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(36495===s)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(36283===s||36284===s||36285===s||36286===s){if(a=e.get("EXT_texture_compression_rgtc"),null===a)return null;if(36492===s)return a.COMPRESSED_RED_RGTC1_EXT;if(36284===s)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===s)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===s)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return s===Fd?i?n.UNSIGNED_INT_24_8:(a=e.get("WEBGL_depth_texture"),null!==a?a.UNSIGNED_INT_24_8_WEBGL:null):void 0!==n[s]?n[s]:null}}}class mte extends Tr{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class vu extends lr{constructor(){super(),this.isGroup=!0,this.type="Group"}}const gte={type:"move"};class a1{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new vu,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new vu,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new L,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new L),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new vu,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new L,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new L),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,i){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,c=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(c&&e.hand){o=!0;for(const E of e.hand.values()){const v=t.getJointPose(E,i),y=this._getHandJoint(c,E);null!==v&&(y.matrix.fromArray(v.transform.matrix),y.matrix.decompose(y.position,y.rotation,y.scale),y.matrixWorldNeedsUpdate=!0,y.jointRadius=v.radius),y.visible=null!==v}const p=c.joints["index-finger-tip"].position.distanceTo(c.joints["thumb-tip"].position),m=.02,_=.005;c.inputState.pinching&&p>m+_?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&p<=m-_&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==l&&e.gripSpace&&(s=t.getPose(e.gripSpace,i),null!==s&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));null!==a&&(r=t.getPose(e.targetRaySpace,i),null===r&&null!==s&&(r=s),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(gte)))}return null!==a&&(a.visible=null!==r),null!==l&&(l.visible=null!==s),null!==c&&(c.visible=null!==o),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const i=new vu;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}class _te extends pa{constructor(e,t,i,r,s,o,a,l,c,d){if((d=void 0!==d?d:kd)!==kd&&d!==Pp)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&d===kd&&(i=du),void 0===i&&d===Pp&&(i=Fd),super(null,r,s,o,a,l,d,i,c),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==a?a:Oi,this.minFilter=void 0!==l?l:Oi,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}class yte extends Vd{constructor(e,t){super();const i=this;let r=null,s=1,o=null,a="local-floor",l=1,c=null,d=null,f=null,p=null,m=null,_=null;const E=t.getContextAttributes();let v=null,y=null;const S=[],b=[],M=new Tr;M.layers.enable(1),M.viewport=new kn;const T=new Tr;T.layers.enable(2),T.viewport=new kn;const I=[M,T],A=new mte;A.layers.enable(1),A.layers.enable(2);let F=null,C=null;function N(q){const se=b.indexOf(q.inputSource);if(-1===se)return;const xe=S[se];void 0!==xe&&(xe.update(q.inputSource,q.frame,c||o),xe.dispatchEvent({type:q.type,data:q.inputSource}))}function K(){r.removeEventListener("select",N),r.removeEventListener("selectstart",N),r.removeEventListener("selectend",N),r.removeEventListener("squeeze",N),r.removeEventListener("squeezestart",N),r.removeEventListener("squeezeend",N),r.removeEventListener("end",K),r.removeEventListener("inputsourceschange",oe);for(let q=0;q<S.length;q++){const se=b[q];null!==se&&(b[q]=null,S[q].disconnect(se))}F=null,C=null,e.setRenderTarget(v),m=null,p=null,f=null,r=null,y=null,de.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}function oe(q){for(let se=0;se<q.removed.length;se++){const xe=q.removed[se],Se=b.indexOf(xe);Se>=0&&(b[Se]=null,S[Se].disconnect(xe))}for(let se=0;se<q.added.length;se++){const xe=q.added[se];let Se=b.indexOf(xe);if(-1===Se){for(let nt=0;nt<S.length;nt++){if(nt>=b.length){b.push(xe),Se=nt;break}if(null===b[nt]){b[nt]=xe,Se=nt;break}}if(-1===Se)break}const ze=S[Se];ze&&ze.connect(xe)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(q){let se=S[q];return void 0===se&&(se=new a1,S[q]=se),se.getTargetRaySpace()},this.getControllerGrip=function(q){let se=S[q];return void 0===se&&(se=new a1,S[q]=se),se.getGripSpace()},this.getHand=function(q){let se=S[q];return void 0===se&&(se=new a1,S[q]=se),se.getHandSpace()},this.setFramebufferScaleFactor=function(q){s=q,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(q){a=q,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||o},this.setReferenceSpace=function(q){c=q},this.getBaseLayer=function(){return null!==p?p:m},this.getBinding=function(){return f},this.getFrame=function(){return _},this.getSession=function(){return r},this.setSession=function(){var q=Fn(function*(se){if(r=se,null!==r){if(v=e.getRenderTarget(),r.addEventListener("select",N),r.addEventListener("selectstart",N),r.addEventListener("selectend",N),r.addEventListener("squeeze",N),r.addEventListener("squeezestart",N),r.addEventListener("squeezeend",N),r.addEventListener("end",K),r.addEventListener("inputsourceschange",oe),!0!==E.xrCompatible&&(yield t.makeXRCompatible()),void 0===r.renderState.layers||!1===e.capabilities.isWebGL2)m=new XRWebGLLayer(r,t,{antialias:void 0!==r.renderState.layers||E.antialias,alpha:!0,depth:E.depth,stencil:E.stencil,framebufferScaleFactor:s}),r.updateRenderState({baseLayer:m}),y=new zd(m.framebufferWidth,m.framebufferHeight,{format:Uo,type:uu,colorSpace:e.outputColorSpace,stencilBuffer:E.stencil});else{let xe=null,Se=null,ze=null;E.depth&&(ze=E.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,xe=E.stencil?Pp:kd,Se=E.stencil?Fd:du);const nt={colorFormat:t.RGBA8,depthFormat:ze,scaleFactor:s};f=new XRWebGLBinding(r,t),p=f.createProjectionLayer(nt),r.updateRenderState({layers:[p]}),y=new zd(p.textureWidth,p.textureHeight,{format:Uo,type:uu,depthTexture:new _te(p.textureWidth,p.textureHeight,Se,void 0,void 0,void 0,void 0,void 0,void 0,xe),stencilBuffer:E.stencil,colorSpace:e.outputColorSpace,samples:E.antialias?4:0}),e.properties.get(y).__ignoreDepthValues=p.ignoreDepthValues}y.isXRRenderTarget=!0,this.setFoveation(l),c=null,o=yield r.requestReferenceSpace(a),de.setContext(r),de.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}});return function(se){return q.apply(this,arguments)}}(),this.getEnvironmentBlendMode=function(){if(null!==r)return r.environmentBlendMode};const ue=new L,W=new L;function $(q,se){null===se?q.matrixWorld.copy(q.matrix):q.matrixWorld.multiplyMatrices(se.matrixWorld,q.matrix),q.matrixWorldInverse.copy(q.matrixWorld).invert()}this.updateCamera=function(q){if(null===r)return;A.near=T.near=M.near=q.near,A.far=T.far=M.far=q.far,(F!==A.near||C!==A.far)&&(r.updateRenderState({depthNear:A.near,depthFar:A.far}),F=A.near,C=A.far);const se=q.parent,xe=A.cameras;$(A,se);for(let Se=0;Se<xe.length;Se++)$(xe[Se],se);2===xe.length?function J(q,se,xe){ue.setFromMatrixPosition(se.matrixWorld),W.setFromMatrixPosition(xe.matrixWorld);const Se=ue.distanceTo(W),ze=se.projectionMatrix.elements,nt=xe.projectionMatrix.elements,Ge=ze[14]/(ze[10]-1),Ze=ze[14]/(ze[10]+1),St=(ze[9]+1)/ze[5],Kt=(ze[9]-1)/ze[5],lt=(ze[8]-1)/ze[0],H=(nt[8]+1)/nt[0],Pe=Ge*lt,_e=Ge*H,Ce=Se/(-lt+H),be=Ce*-lt;se.matrixWorld.decompose(q.position,q.quaternion,q.scale),q.translateX(be),q.translateZ(Ce),q.matrixWorld.compose(q.position,q.quaternion,q.scale),q.matrixWorldInverse.copy(q.matrixWorld).invert();const ut=Ge+Ce,Je=Ze+Ce;q.projectionMatrix.makePerspective(Pe-be,_e+(Se-be),St*Ze/Je*ut,Kt*Ze/Je*ut,ut,Je),q.projectionMatrixInverse.copy(q.projectionMatrix).invert()}(A,M,T):A.projectionMatrix.copy(M.projectionMatrix),function Y(q,se,xe){null===xe?q.matrix.copy(se.matrixWorld):(q.matrix.copy(xe.matrixWorld),q.matrix.invert(),q.matrix.multiply(se.matrixWorld)),q.matrix.decompose(q.position,q.quaternion,q.scale),q.updateMatrixWorld(!0),q.projectionMatrix.copy(se.projectionMatrix),q.projectionMatrixInverse.copy(se.projectionMatrixInverse),q.isPerspectiveCamera&&(q.fov=2*Fp*Math.atan(1/q.projectionMatrix.elements[5]),q.zoom=1)}(q,A,se)},this.getCamera=function(){return A},this.getFoveation=function(){if(null!==p||null!==m)return l},this.setFoveation=function(q){l=q,null!==p&&(p.fixedFoveation=q),null!==m&&void 0!==m.fixedFoveation&&(m.fixedFoveation=q)};let ie=null;const de=new V3;de.setAnimationLoop(function Z(q,se){if(d=se.getViewerPose(c||o),_=se,null!==d){const xe=d.views;null!==m&&(e.setRenderTargetFramebuffer(y,m.framebuffer),e.setRenderTarget(y));let Se=!1;xe.length!==A.cameras.length&&(A.cameras.length=0,Se=!0);for(let ze=0;ze<xe.length;ze++){const nt=xe[ze];let Ge=null;if(null!==m)Ge=m.getViewport(nt);else{const St=f.getViewSubImage(p,nt);Ge=St.viewport,0===ze&&(e.setRenderTargetTextures(y,St.colorTexture,p.ignoreDepthValues?void 0:St.depthStencilTexture),e.setRenderTarget(y))}let Ze=I[ze];void 0===Ze&&(Ze=new Tr,Ze.layers.enable(ze),Ze.viewport=new kn,I[ze]=Ze),Ze.matrix.fromArray(nt.transform.matrix),Ze.matrix.decompose(Ze.position,Ze.quaternion,Ze.scale),Ze.projectionMatrix.fromArray(nt.projectionMatrix),Ze.projectionMatrixInverse.copy(Ze.projectionMatrix).invert(),Ze.viewport.set(Ge.x,Ge.y,Ge.width,Ge.height),0===ze&&(A.matrix.copy(Ze.matrix),A.matrix.decompose(A.position,A.quaternion,A.scale)),!0===Se&&A.cameras.push(Ze)}}for(let xe=0;xe<S.length;xe++){const Se=b[xe],ze=S[xe];null!==Se&&void 0!==ze&&ze.update(Se,se,c||o)}ie&&ie(q,se),se.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:se}),_=null}),this.setAnimationLoop=function(q){ie=q},this.dispose=function(){}}}function vte(n,e){function t(v,y){!0===v.matrixAutoUpdate&&v.updateMatrix(),y.value.copy(v.matrix)}function s(v,y){v.opacity.value=y.opacity,y.color&&v.diffuse.value.copy(y.color),y.emissive&&v.emissive.value.copy(y.emissive).multiplyScalar(y.emissiveIntensity),y.map&&(v.map.value=y.map,t(y.map,v.mapTransform)),y.alphaMap&&(v.alphaMap.value=y.alphaMap,t(y.alphaMap,v.alphaMapTransform)),y.bumpMap&&(v.bumpMap.value=y.bumpMap,t(y.bumpMap,v.bumpMapTransform),v.bumpScale.value=y.bumpScale,1===y.side&&(v.bumpScale.value*=-1)),y.normalMap&&(v.normalMap.value=y.normalMap,t(y.normalMap,v.normalMapTransform),v.normalScale.value.copy(y.normalScale),1===y.side&&v.normalScale.value.negate()),y.displacementMap&&(v.displacementMap.value=y.displacementMap,t(y.displacementMap,v.displacementMapTransform),v.displacementScale.value=y.displacementScale,v.displacementBias.value=y.displacementBias),y.emissiveMap&&(v.emissiveMap.value=y.emissiveMap,t(y.emissiveMap,v.emissiveMapTransform)),y.specularMap&&(v.specularMap.value=y.specularMap,t(y.specularMap,v.specularMapTransform)),y.alphaTest>0&&(v.alphaTest.value=y.alphaTest);const S=e.get(y).envMap;if(S&&(v.envMap.value=S,v.flipEnvMap.value=S.isCubeTexture&&!1===S.isRenderTargetTexture?-1:1,v.reflectivity.value=y.reflectivity,v.ior.value=y.ior,v.refractionRatio.value=y.refractionRatio),y.lightMap){v.lightMap.value=y.lightMap;const b=!0===n._useLegacyLights?Math.PI:1;v.lightMapIntensity.value=y.lightMapIntensity*b,t(y.lightMap,v.lightMapTransform)}y.aoMap&&(v.aoMap.value=y.aoMap,v.aoMapIntensity.value=y.aoMapIntensity,t(y.aoMap,v.aoMapTransform))}return{refreshFogUniforms:function i(v,y){y.color.getRGB(v.fogColor.value,B3(n)),y.isFog?(v.fogNear.value=y.near,v.fogFar.value=y.far):y.isFogExp2&&(v.fogDensity.value=y.density)},refreshMaterialUniforms:function r(v,y,S,b,M){y.isMeshBasicMaterial||y.isMeshLambertMaterial?s(v,y):y.isMeshToonMaterial?(s(v,y),function f(v,y){y.gradientMap&&(v.gradientMap.value=y.gradientMap)}(v,y)):y.isMeshPhongMaterial?(s(v,y),function d(v,y){v.specular.value.copy(y.specular),v.shininess.value=Math.max(y.shininess,1e-4)}(v,y)):y.isMeshStandardMaterial?(s(v,y),function p(v,y){v.metalness.value=y.metalness,y.metalnessMap&&(v.metalnessMap.value=y.metalnessMap,t(y.metalnessMap,v.metalnessMapTransform)),v.roughness.value=y.roughness,y.roughnessMap&&(v.roughnessMap.value=y.roughnessMap,t(y.roughnessMap,v.roughnessMapTransform)),e.get(y).envMap&&(v.envMapIntensity.value=y.envMapIntensity)}(v,y),y.isMeshPhysicalMaterial&&function m(v,y,S){v.ior.value=y.ior,y.sheen>0&&(v.sheenColor.value.copy(y.sheenColor).multiplyScalar(y.sheen),v.sheenRoughness.value=y.sheenRoughness,y.sheenColorMap&&(v.sheenColorMap.value=y.sheenColorMap,t(y.sheenColorMap,v.sheenColorMapTransform)),y.sheenRoughnessMap&&(v.sheenRoughnessMap.value=y.sheenRoughnessMap,t(y.sheenRoughnessMap,v.sheenRoughnessMapTransform))),y.clearcoat>0&&(v.clearcoat.value=y.clearcoat,v.clearcoatRoughness.value=y.clearcoatRoughness,y.clearcoatMap&&(v.clearcoatMap.value=y.clearcoatMap,t(y.clearcoatMap,v.clearcoatMapTransform)),y.clearcoatRoughnessMap&&(v.clearcoatRoughnessMap.value=y.clearcoatRoughnessMap,t(y.clearcoatRoughnessMap,v.clearcoatRoughnessMapTransform)),y.clearcoatNormalMap&&(v.clearcoatNormalMap.value=y.clearcoatNormalMap,t(y.clearcoatNormalMap,v.clearcoatNormalMapTransform),v.clearcoatNormalScale.value.copy(y.clearcoatNormalScale),1===y.side&&v.clearcoatNormalScale.value.negate())),y.iridescence>0&&(v.iridescence.value=y.iridescence,v.iridescenceIOR.value=y.iridescenceIOR,v.iridescenceThicknessMinimum.value=y.iridescenceThicknessRange[0],v.iridescenceThicknessMaximum.value=y.iridescenceThicknessRange[1],y.iridescenceMap&&(v.iridescenceMap.value=y.iridescenceMap,t(y.iridescenceMap,v.iridescenceMapTransform)),y.iridescenceThicknessMap&&(v.iridescenceThicknessMap.value=y.iridescenceThicknessMap,t(y.iridescenceThicknessMap,v.iridescenceThicknessMapTransform))),y.transmission>0&&(v.transmission.value=y.transmission,v.transmissionSamplerMap.value=S.texture,v.transmissionSamplerSize.value.set(S.width,S.height),y.transmissionMap&&(v.transmissionMap.value=y.transmissionMap,t(y.transmissionMap,v.transmissionMapTransform)),v.thickness.value=y.thickness,y.thicknessMap&&(v.thicknessMap.value=y.thicknessMap,t(y.thicknessMap,v.thicknessMapTransform)),v.attenuationDistance.value=y.attenuationDistance,v.attenuationColor.value.copy(y.attenuationColor)),y.anisotropy>0&&(v.anisotropyVector.value.set(y.anisotropy*Math.cos(y.anisotropyRotation),y.anisotropy*Math.sin(y.anisotropyRotation)),y.anisotropyMap&&(v.anisotropyMap.value=y.anisotropyMap,t(y.anisotropyMap,v.anisotropyMapTransform))),v.specularIntensity.value=y.specularIntensity,v.specularColor.value.copy(y.specularColor),y.specularColorMap&&(v.specularColorMap.value=y.specularColorMap,t(y.specularColorMap,v.specularColorMapTransform)),y.specularIntensityMap&&(v.specularIntensityMap.value=y.specularIntensityMap,t(y.specularIntensityMap,v.specularIntensityMapTransform))}(v,y,M)):y.isMeshMatcapMaterial?(s(v,y),function _(v,y){y.matcap&&(v.matcap.value=y.matcap)}(v,y)):y.isMeshDepthMaterial?s(v,y):y.isMeshDistanceMaterial?(s(v,y),function E(v,y){const S=e.get(y).light;v.referencePosition.value.setFromMatrixPosition(S.matrixWorld),v.nearDistance.value=S.shadow.camera.near,v.farDistance.value=S.shadow.camera.far}(v,y)):y.isMeshNormalMaterial?s(v,y):y.isLineBasicMaterial?(function o(v,y){v.diffuse.value.copy(y.color),v.opacity.value=y.opacity,y.map&&(v.map.value=y.map,t(y.map,v.mapTransform))}(v,y),y.isLineDashedMaterial&&function a(v,y){v.dashSize.value=y.dashSize,v.totalSize.value=y.dashSize+y.gapSize,v.scale.value=y.scale}(v,y)):y.isPointsMaterial?function l(v,y,S,b){v.diffuse.value.copy(y.color),v.opacity.value=y.opacity,v.size.value=y.size*S,v.scale.value=.5*b,y.map&&(v.map.value=y.map,t(y.map,v.uvTransform)),y.alphaMap&&(v.alphaMap.value=y.alphaMap,t(y.alphaMap,v.alphaMapTransform)),y.alphaTest>0&&(v.alphaTest.value=y.alphaTest)}(v,y,S,b):y.isSpriteMaterial?function c(v,y){v.diffuse.value.copy(y.color),v.opacity.value=y.opacity,v.rotation.value=y.rotation,y.map&&(v.map.value=y.map,t(y.map,v.mapTransform)),y.alphaMap&&(v.alphaMap.value=y.alphaMap,t(y.alphaMap,v.alphaMapTransform)),y.alphaTest>0&&(v.alphaTest.value=y.alphaTest)}(v,y):y.isShadowMaterial?(v.color.value.copy(y.color),v.opacity.value=y.opacity):y.isShaderMaterial&&(y.uniformsNeedUpdate=!1)}}}function Ete(n,e,t,i){let r={},s={},o=[];const a=t.isWebGL2?n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS):0;function m(S,b,M){const T=S.value;if(void 0===M[b]){if("number"==typeof T)M[b]=T;else{const I=Array.isArray(T)?T:[T],A=[];for(let F=0;F<I.length;F++)A.push(I[F].clone());M[b]=A}return!0}if("number"==typeof T){if(M[b]!==T)return M[b]=T,!0}else{const I=Array.isArray(M[b])?M[b]:[M[b]],A=Array.isArray(T)?T:[T];for(let F=0;F<I.length;F++){const C=I[F];if(!1===C.equals(A[F]))return C.copy(A[F]),!0}}return!1}function E(S){const b={boundary:0,storage:0};return"number"==typeof S?(b.boundary=4,b.storage=4):S.isVector2?(b.boundary=8,b.storage=8):S.isVector3||S.isColor?(b.boundary=16,b.storage=12):S.isVector4?(b.boundary=16,b.storage=16):S.isMatrix3?(b.boundary=48,b.storage=48):S.isMatrix4?(b.boundary=64,b.storage=64):S.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",S),b}function v(S){const b=S.target;b.removeEventListener("dispose",v);const M=o.indexOf(b.__bindingPointIndex);o.splice(M,1),n.deleteBuffer(r[b.id]),delete r[b.id],delete s[b.id]}return{bind:function l(S,b){i.uniformBlockBinding(S,b.program)},update:function c(S,b){let M=r[S.id];void 0===M&&(function _(S){const b=S.uniforms;let M=0;let I=0;for(let A=0,F=b.length;A<F;A++){const C=b[A],N={boundary:0,storage:0},K=Array.isArray(C.value)?C.value:[C.value];for(let oe=0,ue=K.length;oe<ue;oe++){const J=E(K[oe]);N.boundary+=J.boundary,N.storage+=J.storage}C.__data=new Float32Array(N.storage/Float32Array.BYTES_PER_ELEMENT),C.__offset=M,A>0&&(I=M%16,0!==I&&16-I-N.boundary<0&&(M+=16-I,C.__offset=M)),M+=N.storage}I=M%16,I>0&&(M+=16-I),S.__size=M,S.__cache={}}(S),M=function d(S){const b=function f(){for(let S=0;S<a;S++)if(-1===o.indexOf(S))return o.push(S),S;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();S.__bindingPointIndex=b;const M=n.createBuffer(),T=S.__size,I=S.usage;return n.bindBuffer(n.UNIFORM_BUFFER,M),n.bufferData(n.UNIFORM_BUFFER,T,I),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,b,M),M}(S),r[S.id]=M,S.addEventListener("dispose",v)),i.updateUBOMapping(S,b.program);const I=e.render.frame;s[S.id]!==I&&(function p(S){const M=S.uniforms,T=S.__cache;n.bindBuffer(n.UNIFORM_BUFFER,r[S.id]);for(let I=0,A=M.length;I<A;I++){const F=M[I];if(!0===m(F,I,T)){const C=F.__offset,N=Array.isArray(F.value)?F.value:[F.value];let K=0;for(let oe=0;oe<N.length;oe++){const ue=N[oe],W=E(ue);"number"==typeof ue?(F.__data[0]=ue,n.bufferSubData(n.UNIFORM_BUFFER,C+K,F.__data)):ue.isMatrix3?(F.__data[0]=ue.elements[0],F.__data[1]=ue.elements[1],F.__data[2]=ue.elements[2],F.__data[3]=ue.elements[0],F.__data[4]=ue.elements[3],F.__data[5]=ue.elements[4],F.__data[6]=ue.elements[5],F.__data[7]=ue.elements[0],F.__data[8]=ue.elements[6],F.__data[9]=ue.elements[7],F.__data[10]=ue.elements[8],F.__data[11]=ue.elements[0]):(ue.toArray(F.__data,K),K+=W.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,C,F.__data)}}n.bindBuffer(n.UNIFORM_BUFFER,null)}(S),s[S.id]=I)},dispose:function y(){for(const S in r)n.deleteBuffer(r[S]);o=[],r={},s={}}}}class mB{constructor(e={}){const{canvas:t=eZ(),context:i=null,depth:r=!0,stencil:s=!0,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:c=!1,powerPreference:d="default",failIfMajorPerformanceCaveat:f=!1}=e;let p;this.isWebGLRenderer=!0,p=null!==i?i.getContextAttributes().alpha:o;const m=new Uint32Array(4),_=new Int32Array(4);let E=null,v=null;const y=[],S=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=fi,this._useLegacyLights=!1,this.toneMapping=lu,this.toneMappingExposure=1;const b=this;let M=!1,T=0,I=0,A=null,F=-1,C=null;const N=new kn,K=new kn;let oe=null;const ue=new je(0);let W=0,J=t.width,$=t.height,Y=1,ie=null,Z=null;const de=new kn(0,0,J,$),q=new kn(0,0,J,$);let se=!1;const xe=new t1;let Se=!1,ze=!1,nt=null;const Ge=new At,Ze=new he,St=new L,Kt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function lt(){return null===A?Y:1}let _e,Ce,be,ut,Je,et,Mt,on,ci,k,R,te,Te,Me,Ae,at,De,$e,z,Ie,ve,Tt,dt,gt,H=i;function Pe(O,Q){for(let le=0;le<O.length;le++){const ce=t.getContext(O[le],Q);if(null!==ce)return ce}return null}try{const O={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:d,failIfMajorPerformanceCaveat:f};if("setAttribute"in t&&t.setAttribute("data-engine","three.js r157"),t.addEventListener("webglcontextlost",Le,!1),t.addEventListener("webglcontextrestored",Re,!1),t.addEventListener("webglcontextcreationerror",We,!1),null===H){const Q=["webgl2","webgl","experimental-webgl"];if(!0===b.isWebGL1Renderer&&Q.shift(),H=Pe(Q,O),null===H)throw Pe(Q)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&H instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),void 0===H.getShaderPrecisionFormat&&(H.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(O){throw console.error("THREE.WebGLRenderer: "+O.message),O}function ct(){_e=new NQ(H),Ce=new CQ(H,_e,e),_e.init(Ce),Tt=new pte(H,_e,Ce),be=new hte(H,_e,Ce),ut=new FQ(H),Je=new ete,et=new fte(H,_e,be,Je,Ce,Tt,ut),Mt=new DQ(b),on=new PQ(b),ci=new TZ(H,Ce),dt=new xQ(H,_e,ci,Ce),k=new LQ(H,ci,ut,dt),R=new VQ(H,k,ci,ut),z=new BQ(H,Ce,et),at=new AQ(Je),te=new Qee(b,Mt,on,_e,Ce,dt,at),Te=new vte(b,Je),Me=new nte,Ae=new lte(_e,Ce),$e=new MQ(b,Mt,on,be,R,p,l),De=new dte(b,R,Ce),gt=new Ete(H,ut,Ce,be),Ie=new TQ(H,_e,ut,Ce),ve=new OQ(H,_e,ut,Ce),ut.programs=te.programs,b.capabilities=Ce,b.extensions=_e,b.properties=Je,b.renderLists=Me,b.shadowMap=De,b.state=be,b.info=ut}ct();const V=new yte(b,H);function Le(O){O.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),M=!0}function Re(){console.log("THREE.WebGLRenderer: Context Restored."),M=!1;const O=ut.autoReset,Q=De.enabled,le=De.autoUpdate,ee=De.needsUpdate,ce=De.type;ct(),ut.autoReset=O,De.enabled=Q,De.autoUpdate=le,De.needsUpdate=ee,De.type=ce}function We(O){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",O.statusMessage)}function Oe(O){const Q=O.target;Q.removeEventListener("dispose",Oe),function we(O){(function ot(O){const Q=Je.get(O).programs;void 0!==Q&&(Q.forEach(function(le){te.releaseProgram(le)}),O.isShaderMaterial&&te.releaseShaderCache(O))})(O),Je.remove(O)}(Q)}this.xr=V,this.getContext=function(){return H},this.getContextAttributes=function(){return H.getContextAttributes()},this.forceContextLoss=function(){const O=_e.get("WEBGL_lose_context");O&&O.loseContext()},this.forceContextRestore=function(){const O=_e.get("WEBGL_lose_context");O&&O.restoreContext()},this.getPixelRatio=function(){return Y},this.setPixelRatio=function(O){void 0!==O&&(Y=O,this.setSize(J,$,!1))},this.getSize=function(O){return O.set(J,$)},this.setSize=function(O,Q,le=!0){V.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(J=O,$=Q,t.width=Math.floor(O*Y),t.height=Math.floor(Q*Y),!0===le&&(t.style.width=O+"px",t.style.height=Q+"px"),this.setViewport(0,0,O,Q))},this.getDrawingBufferSize=function(O){return O.set(J*Y,$*Y).floor()},this.setDrawingBufferSize=function(O,Q,le){J=O,$=Q,Y=le,t.width=Math.floor(O*le),t.height=Math.floor(Q*le),this.setViewport(0,0,O,Q)},this.getCurrentViewport=function(O){return O.copy(N)},this.getViewport=function(O){return O.copy(de)},this.setViewport=function(O,Q,le,ee){O.isVector4?de.set(O.x,O.y,O.z,O.w):de.set(O,Q,le,ee),be.viewport(N.copy(de).multiplyScalar(Y).floor())},this.getScissor=function(O){return O.copy(q)},this.setScissor=function(O,Q,le,ee){O.isVector4?q.set(O.x,O.y,O.z,O.w):q.set(O,Q,le,ee),be.scissor(K.copy(q).multiplyScalar(Y).floor())},this.getScissorTest=function(){return se},this.setScissorTest=function(O){be.setScissorTest(se=O)},this.setOpaqueSort=function(O){ie=O},this.setTransparentSort=function(O){Z=O},this.getClearColor=function(O){return O.copy($e.getClearColor())},this.setClearColor=function(){$e.setClearColor.apply($e,arguments)},this.getClearAlpha=function(){return $e.getClearAlpha()},this.setClearAlpha=function(){$e.setClearAlpha.apply($e,arguments)},this.clear=function(O=!0,Q=!0,le=!0){let ee=0;if(O){let ce=!1;if(null!==A){const it=A.texture.format;ce=1033===it||1031===it||1029===it}if(ce){const it=A.texture.type,wt=it===uu||it===du||1012===it||it===Fd||1017===it||1018===it,Ft=$e.getClearColor(),kt=$e.getClearAlpha(),an=Ft.r,Lt=Ft.g,Zt=Ft.b;wt?(m[0]=an,m[1]=Lt,m[2]=Zt,m[3]=kt,H.clearBufferuiv(H.COLOR,0,m)):(_[0]=an,_[1]=Lt,_[2]=Zt,_[3]=kt,H.clearBufferiv(H.COLOR,0,_))}else ee|=H.COLOR_BUFFER_BIT}Q&&(ee|=H.DEPTH_BUFFER_BIT),le&&(ee|=H.STENCIL_BUFFER_BIT),H.clear(ee)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Le,!1),t.removeEventListener("webglcontextrestored",Re,!1),t.removeEventListener("webglcontextcreationerror",We,!1),Me.dispose(),Ae.dispose(),Je.dispose(),Mt.dispose(),on.dispose(),R.dispose(),dt.dispose(),gt.dispose(),te.dispose(),V.dispose(),V.removeEventListener("sessionstart",oi),V.removeEventListener("sessionend",al),nt&&(nt.dispose(),nt=null),bs.stop()},this.renderBufferDirect=function(O,Q,le,ee,ce,it){null===Q&&(Q=Kt);const wt=ce.isMesh&&ce.matrixWorld.determinant()<0,Ft=function ooe(O,Q,le,ee,ce){!0!==Q.isScene&&(Q=Kt),et.resetTextureUnits();const it=Q.fog,Ft=null===A?b.outputColorSpace:!0===A.isXRRenderTarget?A.texture.colorSpace:Fr,kt=(ee.isMeshStandardMaterial?on:Mt).get(ee.envMap||(ee.isMeshStandardMaterial?Q.environment:null)),an=!0===ee.vertexColors&&!!le.attributes.color&&4===le.attributes.color.itemSize,Lt=!!le.attributes.tangent&&(!!ee.normalMap||ee.anisotropy>0),Zt=!!le.morphAttributes.position,Ci=!!le.morphAttributes.normal,ki=!!le.morphAttributes.color;let zo=lu;ee.toneMapped&&(null===A||!0===A.isXRRenderTarget)&&(zo=b.toneMapping);const sc=le.morphAttributes.position||le.morphAttributes.normal||le.morphAttributes.color,Ji=void 0!==sc?sc.length:0,cn=Je.get(ee),yI=v.state.lights;!0!==Se||!0!==ze&&O===C||at.setState(ee,O,O===C&&ee.id===F);let Qi=!1;ee.version===cn.__version?(cn.needsLights&&cn.lightsStateVersion!==yI.state.version||cn.outputColorSpace!==Ft||ce.isInstancedMesh&&!1===cn.instancing||!ce.isInstancedMesh&&!0===cn.instancing||ce.isSkinnedMesh&&!1===cn.skinning||!ce.isSkinnedMesh&&!0===cn.skinning||ce.isInstancedMesh&&!0===cn.instancingColor&&null===ce.instanceColor||ce.isInstancedMesh&&!1===cn.instancingColor&&null!==ce.instanceColor||cn.envMap!==kt||!0===ee.fog&&cn.fog!==it||void 0!==cn.numClippingPlanes&&(cn.numClippingPlanes!==at.numPlanes||cn.numIntersection!==at.numIntersection)||cn.vertexAlphas!==an||cn.vertexTangents!==Lt||cn.morphTargets!==Zt||cn.morphNormals!==Ci||cn.morphColors!==ki||cn.toneMapping!==zo||!0===Ce.isWebGL2&&cn.morphTargetsCount!==Ji)&&(Qi=!0):(Qi=!0,cn.__version=ee.version);let ch=cn.currentProgram;!0===Qi&&(ch=Nw(ee,Q,ce));let NH=!1,cv=!1,vI=!1;const Ss=ch.getUniforms(),uh=cn.uniforms;if(be.useProgram(ch.program)&&(NH=!0,cv=!0,vI=!0),ee.id!==F&&(F=ee.id,cv=!0),NH||C!==O){Ss.setValue(H,"projectionMatrix",O.projectionMatrix),Ss.setValue(H,"viewMatrix",O.matrixWorldInverse);const go=Ss.map.cameraPosition;void 0!==go&&go.setValue(H,St.setFromMatrixPosition(O.matrixWorld)),Ce.logarithmicDepthBuffer&&Ss.setValue(H,"logDepthBufFC",2/(Math.log(O.far+1)/Math.LN2)),(ee.isMeshPhongMaterial||ee.isMeshToonMaterial||ee.isMeshLambertMaterial||ee.isMeshBasicMaterial||ee.isMeshStandardMaterial||ee.isShaderMaterial)&&Ss.setValue(H,"isOrthographic",!0===O.isOrthographicCamera),C!==O&&(C=O,cv=!0,vI=!0)}if(ce.isSkinnedMesh){Ss.setOptional(H,ce,"bindMatrix"),Ss.setOptional(H,ce,"bindMatrixInverse");const go=ce.skeleton;go&&(Ce.floatVertexTextures?(null===go.boneTexture&&go.computeBoneTexture(),Ss.setValue(H,"boneTexture",go.boneTexture,et),Ss.setValue(H,"boneTextureSize",go.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const EI=le.morphAttributes;if((void 0!==EI.position||void 0!==EI.normal||void 0!==EI.color&&!0===Ce.isWebGL2)&&z.update(ce,le,ch),(cv||cn.receiveShadow!==ce.receiveShadow)&&(cn.receiveShadow=ce.receiveShadow,Ss.setValue(H,"receiveShadow",ce.receiveShadow)),ee.isMeshGouraudMaterial&&null!==ee.envMap&&(uh.envMap.value=kt,uh.flipEnvMap.value=kt.isCubeTexture&&!1===kt.isRenderTargetTexture?-1:1),cv&&(Ss.setValue(H,"toneMappingExposure",b.toneMappingExposure),cn.needsLights&&function aoe(O,Q){O.ambientLightColor.needsUpdate=Q,O.lightProbe.needsUpdate=Q,O.directionalLights.needsUpdate=Q,O.directionalLightShadows.needsUpdate=Q,O.pointLights.needsUpdate=Q,O.pointLightShadows.needsUpdate=Q,O.spotLights.needsUpdate=Q,O.spotLightShadows.needsUpdate=Q,O.rectAreaLights.needsUpdate=Q,O.hemisphereLights.needsUpdate=Q}(uh,vI),it&&!0===ee.fog&&Te.refreshFogUniforms(uh,it),Te.refreshMaterialUniforms(uh,ee,Y,$,nt),jS.upload(H,cn.uniformsList,uh,et)),ee.isShaderMaterial&&!0===ee.uniformsNeedUpdate&&(jS.upload(H,cn.uniformsList,uh,et),ee.uniformsNeedUpdate=!1),ee.isSpriteMaterial&&Ss.setValue(H,"center",ce.center),Ss.setValue(H,"modelViewMatrix",ce.modelViewMatrix),Ss.setValue(H,"normalMatrix",ce.normalMatrix),Ss.setValue(H,"modelMatrix",ce.matrixWorld),ee.isShaderMaterial||ee.isRawShaderMaterial){const go=ee.uniformsGroups;for(let bI=0,coe=go.length;bI<coe;bI++)if(Ce.isWebGL2){const LH=go[bI];gt.update(LH,ch),gt.bind(LH,ch)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return ch}(O,Q,le,ee,ce);be.setMaterial(ee,wt);let kt=le.index,an=1;if(!0===ee.wireframe){if(kt=k.getWireframeAttribute(le),void 0===kt)return;an=2}const Lt=le.drawRange,Zt=le.attributes.position;let Ci=Lt.start*an,ki=(Lt.start+Lt.count)*an;null!==it&&(Ci=Math.max(Ci,it.start*an),ki=Math.min(ki,(it.start+it.count)*an)),null!==kt?(Ci=Math.max(Ci,0),ki=Math.min(ki,kt.count)):null!=Zt&&(Ci=Math.max(Ci,0),ki=Math.min(ki,Zt.count));const zo=ki-Ci;if(zo<0||zo===1/0)return;dt.setup(ce,ee,Ft,le,kt);let sc,Ji=Ie;if(null!==kt&&(sc=ci.get(kt),Ji=ve,Ji.setIndex(sc)),ce.isMesh)!0===ee.wireframe?(be.setLineWidth(ee.wireframeLinewidth*lt()),Ji.setMode(H.LINES)):Ji.setMode(H.TRIANGLES);else if(ce.isLine){let cn=ee.linewidth;void 0===cn&&(cn=1),be.setLineWidth(cn*lt()),Ji.setMode(ce.isLineSegments?H.LINES:ce.isLineLoop?H.LINE_LOOP:H.LINE_STRIP)}else ce.isPoints?Ji.setMode(H.POINTS):ce.isSprite&&Ji.setMode(H.TRIANGLES);if(ce.isInstancedMesh)Ji.renderInstances(Ci,zo,ce.count);else if(le.isInstancedBufferGeometry){const yI=Math.min(le.instanceCount,void 0!==le._maxInstanceCount?le._maxInstanceCount:1/0);Ji.renderInstances(Ci,zo,yI)}else Ji.render(Ci,zo)},this.compile=function(O,Q){function le(ee,ce,it){!0===ee.transparent&&2===ee.side&&!1===ee.forceSinglePass?(ee.side=1,ee.needsUpdate=!0,Nw(ee,ce,it),ee.side=0,ee.needsUpdate=!0,Nw(ee,ce,it),ee.side=2):Nw(ee,ce,it)}v=Ae.get(O),v.init(),S.push(v),O.traverseVisible(function(ee){ee.isLight&&ee.layers.test(Q.layers)&&(v.pushLight(ee),ee.castShadow&&v.pushShadow(ee))}),v.setupLights(b._useLegacyLights),O.traverse(function(ee){const ce=ee.material;if(ce)if(Array.isArray(ce))for(let it=0;it<ce.length;it++)le(ce[it],O,ee);else le(ce,O,ee)}),S.pop(),v=null};let Dt=null;function oi(){bs.stop()}function al(){bs.start()}const bs=new V3;function DH(O,Q,le,ee){if(!1===O.visible)return;if(O.layers.test(Q.layers))if(O.isGroup)le=O.renderOrder;else if(O.isLOD)!0===O.autoUpdate&&O.update(Q);else if(O.isLight)v.pushLight(O),O.castShadow&&v.pushShadow(O);else if(O.isSprite){if(!O.frustumCulled||xe.intersectsSprite(O)){ee&&St.setFromMatrixPosition(O.matrixWorld).applyMatrix4(Ge);const wt=R.update(O),Ft=O.material;Ft.visible&&E.push(O,wt,Ft,le,St.z,null)}}else if((O.isMesh||O.isLine||O.isPoints)&&(!O.frustumCulled||xe.intersectsObject(O))){const wt=R.update(O),Ft=O.material;if(ee&&(void 0!==O.boundingSphere?(null===O.boundingSphere&&O.computeBoundingSphere(),St.copy(O.boundingSphere.center)):(null===wt.boundingSphere&&wt.computeBoundingSphere(),St.copy(wt.boundingSphere.center)),St.applyMatrix4(O.matrixWorld).applyMatrix4(Ge)),Array.isArray(Ft)){const kt=wt.groups;for(let an=0,Lt=kt.length;an<Lt;an++){const Zt=kt[an],Ci=Ft[Zt.materialIndex];Ci&&Ci.visible&&E.push(O,wt,Ci,le,St.z,Zt)}}else Ft.visible&&E.push(O,wt,Ft,le,St.z,null)}const it=O.children;for(let wt=0,Ft=it.length;wt<Ft;wt++)DH(it[wt],Q,le,ee)}function IH(O,Q,le,ee){const ce=O.opaque,it=O.transmissive,wt=O.transparent;v.setupLightsView(le),!0===Se&&at.setGlobalState(b.clippingPlanes,le),it.length>0&&function soe(O,Q,le,ee){const ce=Ce.isWebGL2;null===nt&&(nt=new zd(1,1,{generateMipmaps:!0,type:_e.has("EXT_color_buffer_half_float")?xy:uu,minFilter:jl,samples:ce?4:0})),b.getDrawingBufferSize(Ze),ce?nt.setSize(Ze.x,Ze.y):nt.setSize(ES(Ze.x),ES(Ze.y));const it=b.getRenderTarget();b.setRenderTarget(nt),b.getClearColor(ue),W=b.getClearAlpha(),W<1&&b.setClearColor(16777215,.5),b.clear();const wt=b.toneMapping;b.toneMapping=lu,Pw(O,le,ee),et.updateMultisampleRenderTarget(nt),et.updateRenderTargetMipmap(nt);let Ft=!1;for(let kt=0,an=Q.length;kt<an;kt++){const Lt=Q[kt],Zt=Lt.object,Ci=Lt.geometry,ki=Lt.material,zo=Lt.group;if(2===ki.side&&Zt.layers.test(ee.layers)){const sc=ki.side;ki.side=1,ki.needsUpdate=!0,RH(Zt,le,ee,Ci,ki,zo),ki.side=sc,ki.needsUpdate=!0,Ft=!0}}!0===Ft&&(et.updateMultisampleRenderTarget(nt),et.updateRenderTargetMipmap(nt)),b.setRenderTarget(it),b.setClearColor(ue,W),b.toneMapping=wt}(ce,it,Q,le),ee&&be.viewport(N.copy(ee)),ce.length>0&&Pw(ce,Q,le),it.length>0&&Pw(it,Q,le),wt.length>0&&Pw(wt,Q,le),be.buffers.depth.setTest(!0),be.buffers.depth.setMask(!0),be.buffers.color.setMask(!0),be.setPolygonOffset(!1)}function Pw(O,Q,le){const ee=!0===Q.isScene?Q.overrideMaterial:null;for(let ce=0,it=O.length;ce<it;ce++){const wt=O[ce],Ft=wt.object,kt=wt.geometry,an=null===ee?wt.material:ee,Lt=wt.group;Ft.layers.test(le.layers)&&RH(Ft,Q,le,kt,an,Lt)}}function RH(O,Q,le,ee,ce,it){O.onBeforeRender(b,Q,le,ee,ce,it),O.modelViewMatrix.multiplyMatrices(le.matrixWorldInverse,O.matrixWorld),O.normalMatrix.getNormalMatrix(O.modelViewMatrix),ce.onBeforeRender(b,Q,le,ee,O,it),!0===ce.transparent&&2===ce.side&&!1===ce.forceSinglePass?(ce.side=1,ce.needsUpdate=!0,b.renderBufferDirect(le,Q,ee,ce,O,it),ce.side=0,ce.needsUpdate=!0,b.renderBufferDirect(le,Q,ee,ce,O,it),ce.side=2):b.renderBufferDirect(le,Q,ee,ce,O,it),O.onAfterRender(b,Q,le,ee,ce,it)}function Nw(O,Q,le){!0!==Q.isScene&&(Q=Kt);const ee=Je.get(O),ce=v.state.lights,wt=ce.state.version,Ft=te.getParameters(O,ce.state,v.state.shadowsArray,Q,le),kt=te.getProgramCacheKey(Ft);let an=ee.programs;ee.environment=O.isMeshStandardMaterial?Q.environment:null,ee.fog=Q.fog,ee.envMap=(O.isMeshStandardMaterial?on:Mt).get(O.envMap||ee.environment),void 0===an&&(O.addEventListener("dispose",Oe),an=new Map,ee.programs=an);let Lt=an.get(kt);if(void 0!==Lt){if(ee.currentProgram===Lt&&ee.lightsStateVersion===wt)return PH(O,Ft),Lt}else Ft.uniforms=te.getUniforms(O),O.onBuild(le,Ft,b),O.onBeforeCompile(Ft,b),Lt=te.acquireProgram(Ft,kt),an.set(kt,Lt),ee.uniforms=Ft.uniforms;const Zt=ee.uniforms;(!O.isShaderMaterial&&!O.isRawShaderMaterial||!0===O.clipping)&&(Zt.clippingPlanes=at.uniform),PH(O,Ft),ee.needsLights=function loe(O){return O.isMeshLambertMaterial||O.isMeshToonMaterial||O.isMeshPhongMaterial||O.isMeshStandardMaterial||O.isShadowMaterial||O.isShaderMaterial&&!0===O.lights}(O),ee.lightsStateVersion=wt,ee.needsLights&&(Zt.ambientLightColor.value=ce.state.ambient,Zt.lightProbe.value=ce.state.probe,Zt.directionalLights.value=ce.state.directional,Zt.directionalLightShadows.value=ce.state.directionalShadow,Zt.spotLights.value=ce.state.spot,Zt.spotLightShadows.value=ce.state.spotShadow,Zt.rectAreaLights.value=ce.state.rectArea,Zt.ltc_1.value=ce.state.rectAreaLTC1,Zt.ltc_2.value=ce.state.rectAreaLTC2,Zt.pointLights.value=ce.state.point,Zt.pointLightShadows.value=ce.state.pointShadow,Zt.hemisphereLights.value=ce.state.hemi,Zt.directionalShadowMap.value=ce.state.directionalShadowMap,Zt.directionalShadowMatrix.value=ce.state.directionalShadowMatrix,Zt.spotShadowMap.value=ce.state.spotShadowMap,Zt.spotLightMatrix.value=ce.state.spotLightMatrix,Zt.spotLightMap.value=ce.state.spotLightMap,Zt.pointShadowMap.value=ce.state.pointShadowMap,Zt.pointShadowMatrix.value=ce.state.pointShadowMatrix);const Ci=Lt.getUniforms(),ki=jS.seqWithValue(Ci.seq,Zt);return ee.currentProgram=Lt,ee.uniformsList=ki,Lt}function PH(O,Q){const le=Je.get(O);le.outputColorSpace=Q.outputColorSpace,le.instancing=Q.instancing,le.instancingColor=Q.instancingColor,le.skinning=Q.skinning,le.morphTargets=Q.morphTargets,le.morphNormals=Q.morphNormals,le.morphColors=Q.morphColors,le.morphTargetsCount=Q.morphTargetsCount,le.numClippingPlanes=Q.numClippingPlanes,le.numIntersection=Q.numClipIntersection,le.vertexAlphas=Q.vertexAlphas,le.vertexTangents=Q.vertexTangents,le.toneMapping=Q.toneMapping}bs.setAnimationLoop(function Zi(O){Dt&&Dt(O)}),typeof self<"u"&&bs.setContext(self),this.setAnimationLoop=function(O){Dt=O,V.setAnimationLoop(O),null===O?bs.stop():bs.start()},V.addEventListener("sessionstart",oi),V.addEventListener("sessionend",al),this.render=function(O,Q){if(void 0===Q||!0===Q.isCamera){if(!0!==M){if(!0===O.matrixWorldAutoUpdate&&O.updateMatrixWorld(),null===Q.parent&&!0===Q.matrixWorldAutoUpdate&&Q.updateMatrixWorld(),!0===V.enabled&&!0===V.isPresenting&&(!0===V.cameraAutoUpdate&&V.updateCamera(Q),Q=V.getCamera()),!0===O.isScene&&O.onBeforeRender(b,O,Q,A),v=Ae.get(O,S.length),v.init(),S.push(v),Ge.multiplyMatrices(Q.projectionMatrix,Q.matrixWorldInverse),xe.setFromProjectionMatrix(Ge),ze=this.localClippingEnabled,Se=at.init(this.clippingPlanes,ze),E=Me.get(O,y.length),E.init(),y.push(E),DH(O,Q,0,b.sortObjects),E.finish(),!0===b.sortObjects&&E.sort(ie,Z),this.info.render.frame++,!0===Se&&at.beginShadows(),De.render(v.state.shadowsArray,O,Q),!0===Se&&at.endShadows(),!0===this.info.autoReset&&this.info.reset(),$e.render(E,O),v.setupLights(b._useLegacyLights),Q.isArrayCamera){const ee=Q.cameras;for(let ce=0,it=ee.length;ce<it;ce++){const wt=ee[ce];IH(E,O,wt,wt.viewport)}}else IH(E,O,Q);null!==A&&(et.updateMultisampleRenderTarget(A),et.updateRenderTargetMipmap(A)),!0===O.isScene&&O.onAfterRender(b,O,Q),dt.resetDefaultState(),F=-1,C=null,S.pop(),v=S.length>0?S[S.length-1]:null,y.pop(),E=y.length>0?y[y.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return T},this.getActiveMipmapLevel=function(){return I},this.getRenderTarget=function(){return A},this.setRenderTargetTextures=function(O,Q,le){Je.get(O.texture).__webglTexture=Q,Je.get(O.depthTexture).__webglTexture=le;const ee=Je.get(O);ee.__hasExternalTextures=!0,ee.__hasExternalTextures&&(ee.__autoAllocateDepthBuffer=void 0===le,ee.__autoAllocateDepthBuffer||!0===_e.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),ee.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(O,Q){const le=Je.get(O);le.__webglFramebuffer=Q,le.__useDefaultFramebuffer=void 0===Q},this.setRenderTarget=function(O,Q=0,le=0){A=O,T=Q,I=le;let ee=!0,ce=null,it=!1,wt=!1;if(O){const kt=Je.get(O);void 0!==kt.__useDefaultFramebuffer?(be.bindFramebuffer(H.FRAMEBUFFER,null),ee=!1):void 0===kt.__webglFramebuffer?et.setupRenderTarget(O):kt.__hasExternalTextures&&et.rebindTextures(O,Je.get(O.texture).__webglTexture,Je.get(O.depthTexture).__webglTexture);const an=O.texture;(an.isData3DTexture||an.isDataArrayTexture||an.isCompressedArrayTexture)&&(wt=!0);const Lt=Je.get(O).__webglFramebuffer;O.isWebGLCubeRenderTarget?(ce=Array.isArray(Lt[Q])?Lt[Q][le]:Lt[Q],it=!0):ce=Ce.isWebGL2&&O.samples>0&&!1===et.useMultisampledRTT(O)?Je.get(O).__webglMultisampledFramebuffer:Array.isArray(Lt)?Lt[le]:Lt,N.copy(O.viewport),K.copy(O.scissor),oe=O.scissorTest}else N.copy(de).multiplyScalar(Y).floor(),K.copy(q).multiplyScalar(Y).floor(),oe=se;if(be.bindFramebuffer(H.FRAMEBUFFER,ce)&&Ce.drawBuffers&&ee&&be.drawBuffers(O,ce),be.viewport(N),be.scissor(K),be.setScissorTest(oe),it){const kt=Je.get(O.texture);H.framebufferTexture2D(H.FRAMEBUFFER,H.COLOR_ATTACHMENT0,H.TEXTURE_CUBE_MAP_POSITIVE_X+Q,kt.__webglTexture,le)}else if(wt){const kt=Je.get(O.texture);H.framebufferTextureLayer(H.FRAMEBUFFER,H.COLOR_ATTACHMENT0,kt.__webglTexture,le||0,Q||0)}F=-1},this.readRenderTargetPixels=function(O,Q,le,ee,ce,it,wt){if(!O||!O.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Ft=Je.get(O).__webglFramebuffer;if(O.isWebGLCubeRenderTarget&&void 0!==wt&&(Ft=Ft[wt]),Ft){be.bindFramebuffer(H.FRAMEBUFFER,Ft);try{const kt=O.texture,an=kt.format,Lt=kt.type;if(an!==Uo&&Tt.convert(an)!==H.getParameter(H.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const Zt=Lt===xy&&(_e.has("EXT_color_buffer_half_float")||Ce.isWebGL2&&_e.has("EXT_color_buffer_float"));if(!(Lt===uu||Tt.convert(Lt)===H.getParameter(H.IMPLEMENTATION_COLOR_READ_TYPE)||Lt===ql&&(Ce.isWebGL2||_e.has("OES_texture_float")||_e.has("WEBGL_color_buffer_float"))||Zt))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");Q>=0&&Q<=O.width-ee&&le>=0&&le<=O.height-ce&&H.readPixels(Q,le,ee,ce,Tt.convert(an),Tt.convert(Lt),it)}finally{const kt=null!==A?Je.get(A).__webglFramebuffer:null;be.bindFramebuffer(H.FRAMEBUFFER,kt)}}},this.copyFramebufferToTexture=function(O,Q,le=0){const ee=Math.pow(2,-le),ce=Math.floor(Q.image.width*ee),it=Math.floor(Q.image.height*ee);et.setTexture2D(Q,0),H.copyTexSubImage2D(H.TEXTURE_2D,le,0,0,O.x,O.y,ce,it),be.unbindTexture()},this.copyTextureToTexture=function(O,Q,le,ee=0){const ce=Q.image.width,it=Q.image.height,wt=Tt.convert(le.format),Ft=Tt.convert(le.type);et.setTexture2D(le,0),H.pixelStorei(H.UNPACK_FLIP_Y_WEBGL,le.flipY),H.pixelStorei(H.UNPACK_PREMULTIPLY_ALPHA_WEBGL,le.premultiplyAlpha),H.pixelStorei(H.UNPACK_ALIGNMENT,le.unpackAlignment),Q.isDataTexture?H.texSubImage2D(H.TEXTURE_2D,ee,O.x,O.y,ce,it,wt,Ft,Q.image.data):Q.isCompressedTexture?H.compressedTexSubImage2D(H.TEXTURE_2D,ee,O.x,O.y,Q.mipmaps[0].width,Q.mipmaps[0].height,wt,Q.mipmaps[0].data):H.texSubImage2D(H.TEXTURE_2D,ee,O.x,O.y,wt,Ft,Q.image),0===ee&&le.generateMipmaps&&H.generateMipmap(H.TEXTURE_2D),be.unbindTexture()},this.copyTextureToTexture3D=function(O,Q,le,ee,ce=0){if(b.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const it=O.max.x-O.min.x+1,wt=O.max.y-O.min.y+1,Ft=O.max.z-O.min.z+1,kt=Tt.convert(ee.format),an=Tt.convert(ee.type);let Lt;if(ee.isData3DTexture)et.setTexture3D(ee,0),Lt=H.TEXTURE_3D;else{if(!ee.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");et.setTexture2DArray(ee,0),Lt=H.TEXTURE_2D_ARRAY}H.pixelStorei(H.UNPACK_FLIP_Y_WEBGL,ee.flipY),H.pixelStorei(H.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ee.premultiplyAlpha),H.pixelStorei(H.UNPACK_ALIGNMENT,ee.unpackAlignment);const Zt=H.getParameter(H.UNPACK_ROW_LENGTH),Ci=H.getParameter(H.UNPACK_IMAGE_HEIGHT),ki=H.getParameter(H.UNPACK_SKIP_PIXELS),zo=H.getParameter(H.UNPACK_SKIP_ROWS),sc=H.getParameter(H.UNPACK_SKIP_IMAGES),Ji=le.isCompressedTexture?le.mipmaps[0]:le.image;H.pixelStorei(H.UNPACK_ROW_LENGTH,Ji.width),H.pixelStorei(H.UNPACK_IMAGE_HEIGHT,Ji.height),H.pixelStorei(H.UNPACK_SKIP_PIXELS,O.min.x),H.pixelStorei(H.UNPACK_SKIP_ROWS,O.min.y),H.pixelStorei(H.UNPACK_SKIP_IMAGES,O.min.z),le.isDataTexture||le.isData3DTexture?H.texSubImage3D(Lt,ce,Q.x,Q.y,Q.z,it,wt,Ft,kt,an,Ji.data):le.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),H.compressedTexSubImage3D(Lt,ce,Q.x,Q.y,Q.z,it,wt,Ft,kt,Ji.data)):H.texSubImage3D(Lt,ce,Q.x,Q.y,Q.z,it,wt,Ft,kt,an,Ji),H.pixelStorei(H.UNPACK_ROW_LENGTH,Zt),H.pixelStorei(H.UNPACK_IMAGE_HEIGHT,Ci),H.pixelStorei(H.UNPACK_SKIP_PIXELS,ki),H.pixelStorei(H.UNPACK_SKIP_ROWS,zo),H.pixelStorei(H.UNPACK_SKIP_IMAGES,sc),0===ce&&ee.generateMipmaps&&H.generateMipmap(Lt),be.unbindTexture()},this.initTexture=function(O){O.isCubeTexture?et.setTextureCube(O,0):O.isData3DTexture?et.setTexture3D(O,0):O.isDataArrayTexture||O.isCompressedArrayTexture?et.setTexture2DArray(O,0):et.setTexture2D(O,0),be.unbindTexture()},this.resetState=function(){T=0,I=0,A=null,be.reset(),dt.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Xl}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=e===DD?"display-p3":"srgb",t.unpackColorSpace=Cn.workingColorSpace===pS?"display-p3":"srgb"}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(e){console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!e}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===fi?Ud:3e3}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===Ud?fi:Fr}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}(class bte extends mB{}).prototype.isWebGL1Renderer=!0;class gB extends lr{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t}}class u1{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=uo()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=uo()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=uo()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const vs=new L;class Kd{constructor(e,t,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)vs.fromBufferAttribute(this,t),vs.applyMatrix4(e),this.setXYZ(t,vs.x,vs.y,vs.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)vs.fromBufferAttribute(this,t),vs.applyNormalMatrix(e),this.setXYZ(t,vs.x,vs.y,vs.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)vs.fromBufferAttribute(this,t),vs.transformDirection(e),this.setXYZ(t,vs.x,vs.y,vs.z);return this}setX(e,t){return this.normalized&&(t=jt(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=jt(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=jt(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=jt(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Bs(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Bs(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Bs(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Bs(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=jt(t,this.array),i=jt(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=jt(t,this.array),i=jt(i,this.array),r=jt(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=jt(t,this.array),i=jt(i,this.array),r=jt(r,this.array),s=jt(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new wi(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Kd(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}const SB=new L,wB=new kn,MB=new kn,Mte=new L,xB=new At,um=new L,h1=new ma,TB=new At,f1=new $p;class CB extends xr{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new At,this.bindMatrixInverse=new At,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;null===this.boundingBox&&(this.boundingBox=new el),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)um.fromBufferAttribute(t,i),this.applyBoneTransform(i,um),this.boundingBox.expandByPoint(um)}computeBoundingSphere(){const e=this.geometry;null===this.boundingSphere&&(this.boundingSphere=new ma),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)um.fromBufferAttribute(t,i),this.applyBoneTransform(i,um),this.boundingSphere.expandByPoint(um)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const r=this.matrixWorld;void 0!==this.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),h1.copy(this.boundingSphere),h1.applyMatrix4(r),!1!==e.ray.intersectsSphere(h1)&&(TB.copy(r).invert(),f1.copy(e.ray).applyMatrix4(TB),(null===this.boundingBox||!1!==f1.intersectsBox(this.boundingBox))&&this._computeIntersections(e,t,f1)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new kn,t=this.geometry.attributes.skinWeight;for(let i=0,r=t.count;i<r;i++){e.fromBufferAttribute(t,i);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const i=this.skeleton,r=this.geometry;wB.fromBufferAttribute(r.attributes.skinIndex,e),MB.fromBufferAttribute(r.attributes.skinWeight,e),SB.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=MB.getComponent(s);if(0!==o){const a=wB.getComponent(s);xB.multiplyMatrices(i.bones[a].matrixWorld,i.boneInverses[a]),t.addScaledVector(Mte.copy(SB).applyMatrix4(xB),o)}}return t.applyMatrix4(this.bindMatrixInverse)}boneTransform(e,t){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,t)}}class p1 extends lr{constructor(){super(),this.isBone=!0,this.type="Bone"}}class By extends pa{constructor(e=null,t=1,i=1,r,s,o,a,l,c=Oi,d=Oi,f,p){super(null,o,a,l,c,d,r,s,f,p),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const AB=new At,xte=new At;class ZS{constructor(e=[],t=[]){this.uuid=uo(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new At)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const i=new At;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,t=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++)AB.multiplyMatrices(e[s]?e[s].matrixWorld:xte,t[s]),AB.toArray(i,16*s);null!==r&&(r.needsUpdate=!0)}clone(){return new ZS(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=g3(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const i=new By(t,e,e,Uo,ql);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const s=e.bones[i];let o=t[s];void 0===o&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new p1),this.bones.push(o),this.boneInverses.push((new At).fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,i=this.boneInverses;for(let r=0,s=t.length;r<s;r++)e.bones.push(t[r].uuid),e.boneInverses.push(i[r].toArray());return e}}class Vy extends wi{constructor(e,t,i,r=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const dm=new At,DB=new At,JS=[],IB=new el,Tte=new At,Hy=new xr,zy=new ma;class RB extends xr{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Vy(new Float32Array(16*i),16),this.instanceColor=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<i;r++)this.setMatrixAt(r,Tte)}computeBoundingBox(){const e=this.geometry,t=this.count;null===this.boundingBox&&(this.boundingBox=new el),null===e.boundingBox&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,dm),IB.copy(e.boundingBox).applyMatrix4(dm),this.boundingBox.union(IB)}computeBoundingSphere(){const e=this.geometry,t=this.count;null===this.boundingSphere&&(this.boundingSphere=new ma),null===e.boundingSphere&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,dm),zy.copy(e.boundingSphere).applyMatrix4(dm),this.boundingSphere.union(zy)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const i=this.matrixWorld,r=this.count;if(Hy.geometry=this.geometry,Hy.material=this.material,void 0!==Hy.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),zy.copy(this.boundingSphere),zy.applyMatrix4(i),!1!==e.ray.intersectsSphere(zy)))for(let s=0;s<r;s++){this.getMatrixAt(s,dm),DB.multiplyMatrices(i,dm),Hy.matrixWorld=DB,Hy.raycast(e,JS);for(let o=0,a=JS.length;o<a;o++){const l=JS[o];l.instanceId=s,l.object=this,t.push(l)}JS.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new Vy(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class zs extends ya{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new je(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const PB=new L,NB=new L,LB=new At,m1=new $p,QS=new ma;class Eu extends lr{constructor(e=new en,t=new zs){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,i=[0];for(let r=1,s=t.count;r<s;r++)PB.fromBufferAttribute(t,r-1),NB.fromBufferAttribute(t,r),i[r]=i[r-1],i[r]+=PB.distanceTo(NB);e.setAttribute("lineDistance",new st(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),QS.copy(i.boundingSphere),QS.applyMatrix4(r),QS.radius+=s,!1===e.ray.intersectsSphere(QS))return;LB.copy(r).invert(),m1.copy(e.ray).applyMatrix4(LB);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=new L,d=new L,f=new L,p=new L,m=this.isLineSegments?2:1,_=i.index,v=i.attributes.position;if(null!==_)for(let b=Math.max(0,o.start),M=Math.min(_.count,o.start+o.count)-1;b<M;b+=m){const T=_.getX(b),I=_.getX(b+1);if(c.fromBufferAttribute(v,T),d.fromBufferAttribute(v,I),m1.distanceSqToSegment(c,d,p,f)>l)continue;p.applyMatrix4(this.matrixWorld);const F=e.ray.origin.distanceTo(p);F<e.near||F>e.far||t.push({distance:F,point:f.clone().applyMatrix4(this.matrixWorld),index:b,face:null,faceIndex:null,object:this})}else for(let b=Math.max(0,o.start),M=Math.min(v.count,o.start+o.count)-1;b<M;b+=m){if(c.fromBufferAttribute(v,b),d.fromBufferAttribute(v,b+1),m1.distanceSqToSegment(c,d,p,f)>l)continue;p.applyMatrix4(this.matrixWorld);const I=e.ray.origin.distanceTo(p);I<e.near||I>e.far||t.push({distance:I,point:f.clone().applyMatrix4(this.matrixWorld),index:b,face:null,faceIndex:null,object:this})}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}const OB=new L,FB=new L;class g1 extends Eu{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,i=[];for(let r=0,s=t.count;r<s;r+=2)OB.fromBufferAttribute(t,r),FB.fromBufferAttribute(t,r+1),i[r]=0===r?0:i[r-1],i[r+1]=i[r]+OB.distanceTo(FB);e.setAttribute("lineDistance",new st(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class kB extends Eu{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class _1 extends ya{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new je(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const UB=new At,y1=new $p,ew=new ma,tw=new L;class BB extends lr{constructor(e=new en,t=new _1){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),ew.copy(i.boundingSphere),ew.applyMatrix4(r),ew.radius+=s,!1===e.ray.intersectsSphere(ew))return;UB.copy(r).invert(),y1.copy(e.ray).applyMatrix4(UB);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=i.index,f=i.attributes.position;if(null!==c)for(let _=Math.max(0,o.start),E=Math.min(c.count,o.start+o.count);_<E;_++){const v=c.getX(_);tw.fromBufferAttribute(f,v),VB(tw,v,l,r,e,t,this)}else for(let _=Math.max(0,o.start),E=Math.min(f.count,o.start+o.count);_<E;_++)tw.fromBufferAttribute(f,_),VB(tw,_,l,r,e,t,this)}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function VB(n,e,t,i,r,s,o){const a=y1.distanceSqToPoint(n);if(a<t){const l=new L;y1.closestPointToPoint(n,l),l.applyMatrix4(i);const c=r.ray.origin.distanceTo(l);if(c<r.near||c>r.far)return;s.push({distance:c,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,object:o})}}class Yy extends en{constructor(e=1,t=32,i=16,r=0,s=2*Math.PI,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));const l=Math.min(o+a,Math.PI);let c=0;const d=[],f=new L,p=new L,m=[],_=[],E=[],v=[];for(let y=0;y<=i;y++){const S=[],b=y/i;let M=0;0===y&&0===o?M=.5/t:y===i&&l===Math.PI&&(M=-.5/t);for(let T=0;T<=t;T++){const I=T/t;f.x=-e*Math.cos(r+I*s)*Math.sin(o+b*a),f.y=e*Math.cos(o+b*a),f.z=e*Math.sin(r+I*s)*Math.sin(o+b*a),_.push(f.x,f.y,f.z),p.copy(f).normalize(),E.push(p.x,p.y,p.z),v.push(I+M,1-b),S.push(c++)}d.push(S)}for(let y=0;y<i;y++)for(let S=0;S<t;S++){const M=d[y][S],T=d[y+1][S],I=d[y+1][S+1];(0!==y||o>0)&&m.push(d[y][S+1],M,I),(y!==i-1||l<Math.PI)&&m.push(M,T,I)}this.setIndex(m),this.setAttribute("position",new st(_,3)),this.setAttribute("normal",new st(E,3)),this.setAttribute("uv",new st(v,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Yy(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class fw extends ya{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new je(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new je(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new he(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class ic extends fw{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new he(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Si(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new je(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new je(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new je(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}function Qd(n,e,t){return!n||!t&&n.constructor===e?n:"number"==typeof e.BYTES_PER_ELEMENT?new e(n):Array.prototype.slice.call(n)}function nV(n){const t=n.length,i=new Array(t);for(let r=0;r!==t;++r)i[r]=r;return i.sort(function e(r,s){return n[r]-n[s]}),i}function B1(n,e,t){const i=n.length,r=new n.constructor(i);for(let s=0,o=0;o!==i;++s){const a=t[s]*e;for(let l=0;l!==e;++l)r[o++]=n[a+l]}return r}function V1(n,e,t,i){let r=1,s=n[0];for(;void 0!==s&&void 0===s[i];)s=n[r++];if(void 0===s)return;let o=s[i];if(void 0!==o)if(Array.isArray(o))do{o=s[i],void 0!==o&&(e.push(s.time),t.push.apply(t,o)),s=n[r++]}while(void 0!==s);else if(void 0!==o.toArray)do{o=s[i],void 0!==o&&(e.push(s.time),o.toArray(t,t.length)),s=n[r++]}while(void 0!==s);else do{o=s[i],void 0!==o&&(e.push(s.time),t.push(o)),s=n[r++]}while(void 0!==s)}class Ky{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,r=t[i],s=t[i-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=i+2;;){if(void 0===r){if(e<s)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(s=r,r=t[++i],e<r)break t}o=t.length;break n}if(e>=s)break e;{const a=t[1];e<a&&(i=2,s=a);for(let l=i-2;;){if(void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(i===l)break;if(r=s,s=t[--i-1],e>=s)break t}o=i,i=0}}for(;i<o;){const a=i+o>>>1;e<t[a]?o=a:i=a+1}if(r=t[i],s=t[i-1],void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=i[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class yne extends Ky{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(e,t,i){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],l=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case 2401:s=e,a=2*t-i;break;case 2402:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=i}if(void 0===l)switch(this.getSettings_().endingEnd){case 2401:o=e,l=2*i-t;break;case 2402:o=1,l=i+r[1]-r[0];break;default:o=e-1,l=t}const c=.5*(i-t),d=this.valueSize;this._weightPrev=c/(t-a),this._weightNext=c/(l-i),this._offsetPrev=s*d,this._offsetNext=o*d}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,d=this._offsetPrev,f=this._offsetNext,p=this._weightPrev,m=this._weightNext,_=(i-t)/(r-t),E=_*_,v=E*_,y=-p*v+2*p*E-p*_,S=(1+p)*v+(-1.5-2*p)*E+(-.5+p)*_+1,b=(-1-m)*v+(1.5+m)*E+.5*_,M=m*v-m*E;for(let T=0;T!==a;++T)s[T]=y*o[d+T]+S*o[c+T]+b*o[l+T]+M*o[f+T];return s}}class iV extends Ky{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,d=(i-t)/(r-t),f=1-d;for(let p=0;p!==a;++p)s[p]=o[c+p]*f+o[l+p]*d;return s}}class vne extends Ky{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class il{constructor(e,t,i,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Qd(t,this.TimeBufferType),this.values=Qd(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:Qd(e.times,Array),values:Qd(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new vne(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new iV(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new yne(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Ty:t=this.InterpolantFactoryMethodDiscrete;break;case Np:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Ty;case this.InterpolantFactoryMethodLinear:return Np;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){const i=this.times,r=i.length;let s=0,o=r-1;for(;s!==r&&i[s]<e;)++s;for(;-1!==o&&i[o]>t;)--o;if(++o,0!==s||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=i.slice(s,o),this.values=this.values.slice(s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;0===s&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=i[a];if("number"==typeof l&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(null!==o&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(void 0!==r&&function tV(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}(r))for(let a=0,l=r.length;a!==l;++a){const c=r[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),i=this.getValueSize(),r=2302===this.getInterpolation(),s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const c=e[a];if(c!==e[a+1]&&(1!==a||c!==e[0]))if(r)l=!0;else{const f=a*i,p=f-i,m=f+i;for(let _=0;_!==i;++_){const E=t[f+_];if(E!==t[p+_]||E!==t[m+_]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const f=a*i,p=o*i;for(let m=0;m!==i;++m)t[p+m]=t[f+m]}++o}}if(s>0){e[o]=e[s];for(let a=s*i,l=o*i,c=0;c!==i;++c)t[l+c]=t[a+c];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*i)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}il.prototype.TimeBufferType=Float32Array,il.prototype.ValueBufferType=Float32Array,il.prototype.DefaultInterpolation=Np;class pm extends il{}pm.prototype.ValueTypeName="bool",pm.prototype.ValueBufferType=Array,pm.prototype.DefaultInterpolation=Ty,pm.prototype.InterpolantFactoryMethodLinear=void 0,pm.prototype.InterpolantFactoryMethodSmooth=void 0;class rV extends il{}rV.prototype.ValueTypeName="color";class mm extends il{}mm.prototype.ValueTypeName="number";class Ene extends Ky{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(i-t)/(r-t);let c=e*a;for(let d=c+a;c!==d;c+=4)kr.slerpFlat(s,0,o,c-a,o,c,l);return s}}class eh extends il{InterpolantFactoryMethodLinear(e){return new Ene(this.times,this.values,this.getValueSize(),e)}}eh.prototype.ValueTypeName="quaternion",eh.prototype.DefaultInterpolation=Np,eh.prototype.InterpolantFactoryMethodSmooth=void 0;class gm extends il{}gm.prototype.ValueTypeName="string",gm.prototype.ValueBufferType=Array,gm.prototype.DefaultInterpolation=Ty,gm.prototype.InterpolantFactoryMethodLinear=void 0,gm.prototype.InterpolantFactoryMethodSmooth=void 0;class _m extends il{}_m.prototype.ValueTypeName="vector";class Zy{constructor(e,t=-1,i,r=2500){this.name=e,this.tracks=i,this.duration=t,this.blendMode=r,this.uuid=uo(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,r=1/(e.fps||1);for(let o=0,a=i.length;o!==a;++o)t.push(Sne(i[o]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=i.length;s!==o;++s)t.push(il.toJSON(i[s]));return r}static CreateFromMorphTargetSequence(e,t,i,r){const s=t.length,o=[];for(let a=0;a<s;a++){let l=[],c=[];l.push((a+s-1)%s,a,(a+1)%s),c.push(0,1,0);const d=nV(l);l=B1(l,1,d),c=B1(c,1,d),!r&&0===l[0]&&(l.push(s),c.push(c[0])),o.push(new mm(".morphTargetInfluences["+t[a].name+"]",l,c).scale(1/i))}return new this(e,-1,o)}static findByName(e,t){let i=e;Array.isArray(e)||(i=e.geometry&&e.geometry.animations||e.animations);for(let r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const c=e[a],d=c.name.match(s);if(d&&d.length>1){const f=d[1];let p=r[f];p||(r[f]=p=[]),p.push(c)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],t,i));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(f,p,m,_,E){if(0!==m.length){const v=[],y=[];V1(m,v,y,_),0!==v.length&&E.push(new f(p,v,y))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let l=e.length||-1;const c=e.hierarchy||[];for(let f=0;f<c.length;f++){const p=c[f].keys;if(p&&0!==p.length)if(p[0].morphTargets){const m={};let _;for(_=0;_<p.length;_++)if(p[_].morphTargets)for(let E=0;E<p[_].morphTargets.length;E++)m[p[_].morphTargets[E]]=-1;for(const E in m){const v=[],y=[];for(let S=0;S!==p[_].morphTargets.length;++S){const b=p[_];v.push(b.time),y.push(b.morphTarget===E?1:0)}r.push(new mm(".morphTargetInfluence["+E+"]",v,y))}l=m.length*o}else{const m=".bones["+t[f].name+"]";i(_m,m+".position",p,"pos",r),i(eh,m+".quaternion",p,"rot",r),i(_m,m+".scale",p,"scl",r)}}return 0===r.length?null:new this(s,l,r,a)}resetDuration(){let t=0;for(let i=0,r=this.tracks.length;i!==r;++i){const s=this.tracks[i];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Sne(n){if(void 0===n.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function bne(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return mm;case"vector":case"vector2":case"vector3":case"vector4":return _m;case"color":return rV;case"quaternion":return eh;case"bool":case"boolean":return pm;case"string":return gm}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}(n.type);if(void 0===n.times){const t=[],i=[];V1(n.keys,t,i,"value"),n.times=t,n.values=i}return void 0!==e.parse?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const ym={enabled:!1,files:{},add:function(n,e){!1!==this.enabled&&(this.files[n]=e)},get:function(n){if(!1!==this.enabled)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class sV{constructor(e,t,i){const r=this;let l,s=!1,o=0,a=0;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(d){a++,!1===s&&void 0!==r.onStart&&r.onStart(d,o,a),s=!0},this.itemEnd=function(d){o++,void 0!==r.onProgress&&r.onProgress(d,o,a),o===a&&(s=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(d){void 0!==r.onError&&r.onError(d)},this.resolveURL=function(d){return l?l(d):d},this.setURLModifier=function(d){return l=d,this},this.addHandler=function(d,f){return c.push(d,f),this},this.removeHandler=function(d){const f=c.indexOf(d);return-1!==f&&c.splice(f,2),this},this.getHandler=function(d){for(let f=0,p=c.length;f<p;f+=2){const m=c[f],_=c[f+1];if(m.global&&(m.lastIndex=0),m.test(d))return _}return null}}}const wne=new sV;let Jy=(()=>{class n{constructor(t){this.manager=void 0!==t?t:wne,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,i){const r=this;return new Promise(function(s,o){r.load(t,s,i,o)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}return n.DEFAULT_MATERIAL_NAME="__DEFAULT",n})();const rc={};class Mne extends Error{constructor(e,t){super(e),this.response=t}}class rl extends Jy{constructor(e){super(e)}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=ym.get(e);if(void 0!==s)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(void 0!==rc[e])return void rc[e].push({onLoad:t,onProgress:i,onError:r});rc[e]=[],rc[e].push({onLoad:t,onProgress:i,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(c=>{if(200===c.status||0===c.status){if(0===c.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||void 0===c.body||void 0===c.body.getReader)return c;const d=rc[e],f=c.body.getReader(),p=c.headers.get("Content-Length")||c.headers.get("X-File-Size"),m=p?parseInt(p):0,_=0!==m;let E=0;const v=new ReadableStream({start(y){!function S(){f.read().then(({done:b,value:M})=>{if(b)y.close();else{E+=M.byteLength;const T=new ProgressEvent("progress",{lengthComputable:_,loaded:E,total:m});for(let I=0,A=d.length;I<A;I++){const F=d[I];F.onProgress&&F.onProgress(T)}y.enqueue(M),S()}})}()}});return new Response(v)}throw new Mne(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`,c)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(d=>(new DOMParser).parseFromString(d,a));case"json":return c.json();default:if(void 0===a)return c.text();{const f=/charset="?([^;"\s]*)"?/i.exec(a),p=f&&f[1]?f[1].toLowerCase():void 0,m=new TextDecoder(p);return c.arrayBuffer().then(_=>m.decode(_))}}}).then(c=>{ym.add(e,c);const d=rc[e];delete rc[e];for(let f=0,p=d.length;f<p;f++){const m=d[f];m.onLoad&&m.onLoad(c)}}).catch(c=>{const d=rc[e];if(void 0===d)throw this.manager.itemError(e),c;delete rc[e];for(let f=0,p=d.length;f<p;f++){const m=d[f];m.onError&&m.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class pw extends Jy{constructor(e){super(e)}load(e,t,i,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=ym.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=Ay("img");function l(){d(),ym.add(e,this),t&&t(this),s.manager.itemEnd(e)}function c(f){d(),r&&r(f),s.manager.itemError(e),s.manager.itemEnd(e)}function d(){a.removeEventListener("load",l,!1),a.removeEventListener("error",c,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",c,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class xne extends Jy{constructor(e){super(e)}load(e,t,i,r){const s=new pa,o=new pw(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,void 0!==t&&t(s)},i,r),s}}class mw extends lr{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new je(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}const H1=new At,oV=new L,aV=new L;class z1{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new he(512,512),this.map=null,this.mapPass=null,this.matrix=new At,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new t1,this._frameExtents=new he(1,1),this._viewportCount=1,this._viewports=[new kn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;oV.setFromMatrixPosition(e.matrixWorld),t.position.copy(oV),aV.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(aV),t.updateMatrixWorld(),H1.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(H1),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(H1)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Cne extends z1{constructor(){super(new Tr(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,i=2*Fp*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(i!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=i,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class lV extends mw{constructor(e,t,i=0,r=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(lr.DEFAULT_UP),this.updateMatrix(),this.target=new lr,this.distance=i,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new Cne}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const cV=new At,Qy=new L,G1=new L;class Ane extends z1{constructor(){super(new Tr(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new he(4,2),this._viewportCount=6,this._viewports=[new kn(2,1,1,1),new kn(0,1,1,1),new kn(3,1,1,1),new kn(1,1,1,1),new kn(3,0,1,1),new kn(1,0,1,1)],this._cubeDirections=[new L(1,0,0),new L(-1,0,0),new L(0,0,1),new L(0,0,-1),new L(0,1,0),new L(0,-1,0)],this._cubeUps=[new L(0,1,0),new L(0,1,0),new L(0,1,0),new L(0,1,0),new L(0,0,1),new L(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),Qy.setFromMatrixPosition(e.matrixWorld),i.position.copy(Qy),G1.copy(i.position),G1.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(G1),i.updateMatrixWorld(),r.makeTranslation(-Qy.x,-Qy.y,-Qy.z),cV.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(cV)}}class uV extends mw{constructor(e,t,i=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new Ane}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class Dne extends z1{constructor(){super(new GS(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class dV extends mw{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(lr.DEFAULT_UP),this.updateMatrix(),this.target=new lr,this.shadow=new Dne}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class hV extends mw{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class ev{static decodeText(e){if(typeof TextDecoder<"u")return(new TextDecoder).decode(e);let t="";for(let i=0,r=e.length;i<r;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class Fne extends Jy{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=ym.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a={};a.credentials="anonymous"===this.crossOrigin?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(l){ym.add(e,l),t&&t(l),s.manager.itemEnd(e)}).catch(function(l){r&&r(l),s.manager.itemError(e),s.manager.itemEnd(e)}),s.manager.itemStart(e)}}const $1="\\[\\]\\.:\\/",Hne=new RegExp("["+$1+"]","g"),j1="[^"+$1+"]",zne="[^"+$1.replace("\\.","")+"]",qne=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",j1)+/(WCOD+)?/.source.replace("WCOD",zne)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",j1)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",j1)+"$"),Xne=["material","materials","bones","map"];class Yne{constructor(e,t,i){const r=i||Zn.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}let Zn=(()=>{class n{constructor(t,i,r){this.path=i,this.parsedPath=r||n.parseTrackName(i),this.node=n.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,i,r){return t&&t.isAnimationObjectGroup?new n.Composite(t,i,r):new n(t,i,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(Hne,"")}static parseTrackName(t){const i=qne.exec(t);if(null===i)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},s=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==s&&-1!==s){const o=r.nodeName.substring(s+1);-1!==Xne.indexOf(o)&&(r.nodeName=r.nodeName.substring(0,s),r.objectName=o)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,i){if(void 0===i||""===i||"."===i||-1===i||i===t.name||i===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(i);if(void 0!==r)return r}if(t.children){const r=function(o){for(let a=0;a<o.length;a++){const l=o[a];if(l.name===i||l.uuid===i)return l;const c=r(l.children);if(c)return c}return null},s=r(t.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,i){t[i]=this.targetObject[this.propertyName]}_getValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)t[i++]=r[s]}_getValue_arrayElement(t,i){t[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,i){this.resolvedProperty.toArray(t,i)}_setValue_direct(t,i){this.targetObject[this.propertyName]=t[i]}_setValue_direct_setNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++]}_setValue_array_setNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,i){this.resolvedProperty[this.propertyIndex]=t[i]}_setValue_arrayElement_setNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,i){this.resolvedProperty.fromArray(t,i)}_setValue_fromArray_setNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,i){this.bind(),this.getValue(t,i)}_setValue_unbound(t,i){this.bind(),this.setValue(t,i)}bind(){let t=this.node;const i=this.parsedPath,r=i.objectName,s=i.propertyName;let o=i.propertyIndex;if(t||(t=n.findNode(this.rootNode,i.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(r){let d=i.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let f=0;f<t.length;f++)if(t[f].name===d){d=f;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==d){if(void 0===t[d])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[d]}}const a=t[s];if(void 0===a)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+i.nodeName+"."+s+" but it wasn't found.",t);let l=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?l=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(void 0!==o){if("morphTargetInfluences"===s){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[o]&&(o=t.morphTargetDictionary[o])}c=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=o}else void 0!==a.fromArray&&void 0!==a.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(c=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=s;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return n.Composite=Yne,n})();Zn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Zn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Zn.prototype.GetterByBindingType=[Zn.prototype._getValue_direct,Zn.prototype._getValue_array,Zn.prototype._getValue_arrayElement,Zn.prototype._getValue_toArray],Zn.prototype.SetterByBindingTypeAndVersioning=[[Zn.prototype._setValue_direct,Zn.prototype._setValue_direct_setNeedsUpdate,Zn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Zn.prototype._setValue_array,Zn.prototype._setValue_array_setNeedsUpdate,Zn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Zn.prototype._setValue_arrayElement,Zn.prototype._setValue_arrayElement_setNeedsUpdate,Zn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Zn.prototype._setValue_fromArray,Zn.prototype._setValue_fromArray_setNeedsUpdate,Zn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],new Float32Array(1);class SV{constructor(e,t,i=0,r=1/0){this.ray=new $p(e,t),this.near=i,this.far=r,this.camera=null,this.layers=new $D,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,i=[]){return q1(e,this,i,t),i.sort(wV),i}intersectObjects(e,t=!0,i=[]){for(let r=0,s=e.length;r<s;r++)q1(e[r],this,i,t);return i.sort(wV),i}}function wV(n,e){return n.distance-e.distance}function q1(n,e,t,i){if(n.layers.test(e.layers)&&n.raycast(e,t),!0===i){const r=n.children;for(let s=0,o=r.length;s<o;s++)q1(r[s],e,t,!0)}}class MV{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(Si(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"157"}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="157");const LV={type:"change"},K1={type:"start"},OV={type:"end"},ww=new $p,FV=new yu,eie=Math.cos(70*LD_DEG2RAD);class tie extends Vd{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new L,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:0,MIDDLE:1,RIGHT:2},this.touches={ONE:0,TWO:2},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return a.phi},this.getAzimuthalAngle=function(){return a.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(z){z.addEventListener("keydown",R),this._domElementKeyEvents=z},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",R),this._domElementKeyEvents=null},this.saveState=function(){i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=function(){i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(LV),i.update(),s=r.NONE},this.update=function(){const z=new L,Ie=(new kr).setFromUnitVectors(e.up,new L(0,1,0)),ve=Ie.clone().invert(),Tt=new L,dt=new kr,gt=new L,ct=2*Math.PI;return function(Le=null){const Re=i.object.position;z.copy(Re).sub(i.target),z.applyQuaternion(Ie),a.setFromVector3(z),i.autoRotate&&s===r.NONE&&K(function C(z){return null!==z?2*Math.PI/60*i.autoRotateSpeed*z:2*Math.PI/60/60*i.autoRotateSpeed}(Le)),i.enableDamping?(a.theta+=l.theta*i.dampingFactor,a.phi+=l.phi*i.dampingFactor):(a.theta+=l.theta,a.phi+=l.phi);let We=i.minAzimuthAngle,Oe=i.maxAzimuthAngle;isFinite(We)&&isFinite(Oe)&&(We<-Math.PI?We+=ct:We>Math.PI&&(We-=ct),Oe<-Math.PI?Oe+=ct:Oe>Math.PI&&(Oe-=ct),a.theta=We<=Oe?Math.max(We,Math.min(Oe,a.theta)):a.theta>(We+Oe)/2?Math.max(We,a.theta):Math.min(Oe,a.theta)),a.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,a.phi)),a.makeSafe(),!0===i.enableDamping?i.target.addScaledVector(d,i.dampingFactor):i.target.add(d),a.radius=Z(i.zoomToCursor&&I||i.object.isOrthographicCamera?a.radius:a.radius*c),z.setFromSpherical(a),z.applyQuaternion(ve),Re.copy(i.target).add(z),i.object.lookAt(i.target),!0===i.enableDamping?(l.theta*=1-i.dampingFactor,l.phi*=1-i.dampingFactor,d.multiplyScalar(1-i.dampingFactor)):(l.set(0,0,0),d.set(0,0,0));let we=!1;if(i.zoomToCursor&&I){let ot=null;if(i.object.isPerspectiveCamera){const Dt=z.length();ot=Z(Dt*c),i.object.position.addScaledVector(M,Dt-ot),i.object.updateMatrixWorld()}else if(i.object.isOrthographicCamera){const Dt=new L(T.x,T.y,0);Dt.unproject(i.object),i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/c)),i.object.updateProjectionMatrix(),we=!0;const Zi=new L(T.x,T.y,0);Zi.unproject(i.object),i.object.position.sub(Zi).add(Dt),i.object.updateMatrixWorld(),ot=z.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),i.zoomToCursor=!1;null!==ot&&(this.screenSpacePanning?i.target.set(0,0,-1).transformDirection(i.object.matrix).multiplyScalar(ot).add(i.object.position):(ww.origin.copy(i.object.position),ww.direction.set(0,0,-1).transformDirection(i.object.matrix),Math.abs(i.object.up.dot(ww.direction))<eie?e.lookAt(i.target):(FV.setFromNormalAndCoplanarPoint(i.object.up,i.target),ww.intersectPlane(FV,i.target))))}else i.object.isOrthographicCamera&&(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/c)),i.object.updateProjectionMatrix(),we=!0);return c=1,I=!1,!!(we||Tt.distanceToSquared(i.object.position)>o||8*(1-dt.dot(i.object.quaternion))>o||gt.distanceToSquared(i.target)>0)&&(i.dispatchEvent(LV),Tt.copy(i.object.position),dt.copy(i.object.quaternion),gt.copy(i.target),we=!1,!0)}}(),this.dispose=function(){i.domElement.removeEventListener("contextmenu",Me),i.domElement.removeEventListener("pointerdown",Je),i.domElement.removeEventListener("pointercancel",Mt),i.domElement.removeEventListener("wheel",k),i.domElement.removeEventListener("pointermove",et),i.domElement.removeEventListener("pointerup",Mt),null!==i._domElementKeyEvents&&(i._domElementKeyEvents.removeEventListener("keydown",R),i._domElementKeyEvents=null)};const i=this,r={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let s=r.NONE;const o=1e-6,a=new MV,l=new MV;let c=1;const d=new L,f=new he,p=new he,m=new he,_=new he,E=new he,v=new he,y=new he,S=new he,b=new he,M=new L,T=new he;let I=!1;const A=[],F={};function N(){return Math.pow(.95,i.zoomSpeed)}function K(z){l.theta-=z}function oe(z){l.phi-=z}const ue=function(){const z=new L;return function(ve,Tt){z.setFromMatrixColumn(Tt,0),z.multiplyScalar(-ve),d.add(z)}}(),W=function(){const z=new L;return function(ve,Tt){!0===i.screenSpacePanning?z.setFromMatrixColumn(Tt,1):(z.setFromMatrixColumn(Tt,0),z.crossVectors(i.object.up,z)),z.multiplyScalar(ve),d.add(z)}}(),J=function(){const z=new L;return function(ve,Tt){const dt=i.domElement;if(i.object.isPerspectiveCamera){z.copy(i.object.position).sub(i.target);let ct=z.length();ct*=Math.tan(i.object.fov/2*Math.PI/180),ue(2*ve*ct/dt.clientHeight,i.object.matrix),W(2*Tt*ct/dt.clientHeight,i.object.matrix)}else i.object.isOrthographicCamera?(ue(ve*(i.object.right-i.object.left)/i.object.zoom/dt.clientWidth,i.object.matrix),W(Tt*(i.object.top-i.object.bottom)/i.object.zoom/dt.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}}();function $(z){i.object.isPerspectiveCamera||i.object.isOrthographicCamera?c/=z:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function Y(z){i.object.isPerspectiveCamera||i.object.isOrthographicCamera?c*=z:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function ie(z){if(!i.zoomToCursor)return;I=!0;const Ie=i.domElement.getBoundingClientRect(),Tt=z.clientY-Ie.top,gt=Ie.height;T.x=(z.clientX-Ie.left)/Ie.width*2-1,T.y=-Tt/gt*2+1,M.set(T.x,T.y,1).unproject(i.object).sub(i.object.position).normalize()}function Z(z){return Math.max(i.minDistance,Math.min(i.maxDistance,z))}function de(z){f.set(z.clientX,z.clientY)}function se(z){_.set(z.clientX,z.clientY)}function Ze(){1===A.length?f.set(A[0].pageX,A[0].pageY):f.set(.5*(A[0].pageX+A[1].pageX),.5*(A[0].pageY+A[1].pageY))}function St(){1===A.length?_.set(A[0].pageX,A[0].pageY):_.set(.5*(A[0].pageX+A[1].pageX),.5*(A[0].pageY+A[1].pageY))}function Kt(){const z=A[0].pageX-A[1].pageX,Ie=A[0].pageY-A[1].pageY,ve=Math.sqrt(z*z+Ie*Ie);y.set(0,ve)}function Pe(z){if(1==A.length)p.set(z.pageX,z.pageY);else{const ve=$e(z);p.set(.5*(z.pageX+ve.x),.5*(z.pageY+ve.y))}m.subVectors(p,f).multiplyScalar(i.rotateSpeed);const Ie=i.domElement;K(2*Math.PI*m.x/Ie.clientHeight),oe(2*Math.PI*m.y/Ie.clientHeight),f.copy(p)}function _e(z){if(1===A.length)E.set(z.pageX,z.pageY);else{const Ie=$e(z);E.set(.5*(z.pageX+Ie.x),.5*(z.pageY+Ie.y))}v.subVectors(E,_).multiplyScalar(i.panSpeed),J(v.x,v.y),_.copy(E)}function Ce(z){const Ie=$e(z),ve=z.pageX-Ie.x,Tt=z.pageY-Ie.y,dt=Math.sqrt(ve*ve+Tt*Tt);S.set(0,dt),b.set(0,Math.pow(S.y/y.y,i.zoomSpeed)),$(b.y),y.copy(S)}function Je(z){!1!==i.enabled&&(0===A.length&&(i.domElement.setPointerCapture(z.pointerId),i.domElement.addEventListener("pointermove",et),i.domElement.addEventListener("pointerup",Mt)),function Ae(z){A.push(z)}(z),"touch"===z.pointerType?function te(z){switch(De(z),A.length){case 1:switch(i.touches.ONE){case 0:if(!1===i.enableRotate)return;Ze(),s=r.TOUCH_ROTATE;break;case 1:if(!1===i.enablePan)return;St(),s=r.TOUCH_PAN;break;default:s=r.NONE}break;case 2:switch(i.touches.TWO){case 2:if(!1===i.enableZoom&&!1===i.enablePan)return;(function lt(){i.enableZoom&&Kt(),i.enablePan&&St()})(),s=r.TOUCH_DOLLY_PAN;break;case 3:if(!1===i.enableZoom&&!1===i.enableRotate)return;(function H(){i.enableZoom&&Kt(),i.enableRotate&&Ze()})(),s=r.TOUCH_DOLLY_ROTATE;break;default:s=r.NONE}break;default:s=r.NONE}s!==r.NONE&&i.dispatchEvent(K1)}(z):function on(z){let Ie;switch(z.button){case 0:Ie=i.mouseButtons.LEFT;break;case 1:Ie=i.mouseButtons.MIDDLE;break;case 2:Ie=i.mouseButtons.RIGHT;break;default:Ie=-1}switch(Ie){case 1:if(!1===i.enableZoom)return;(function q(z){ie(z),y.set(z.clientX,z.clientY)})(z),s=r.DOLLY;break;case 0:if(z.ctrlKey||z.metaKey||z.shiftKey){if(!1===i.enablePan)return;se(z),s=r.PAN}else{if(!1===i.enableRotate)return;de(z),s=r.ROTATE}break;case 2:if(z.ctrlKey||z.metaKey||z.shiftKey){if(!1===i.enableRotate)return;de(z),s=r.ROTATE}else{if(!1===i.enablePan)return;se(z),s=r.PAN}break;default:s=r.NONE}s!==r.NONE&&i.dispatchEvent(K1)}(z))}function et(z){!1!==i.enabled&&("touch"===z.pointerType?function Te(z){switch(De(z),s){case r.TOUCH_ROTATE:if(!1===i.enableRotate)return;Pe(z),i.update();break;case r.TOUCH_PAN:if(!1===i.enablePan)return;_e(z),i.update();break;case r.TOUCH_DOLLY_PAN:if(!1===i.enableZoom&&!1===i.enablePan)return;(function be(z){i.enableZoom&&Ce(z),i.enablePan&&_e(z)})(z),i.update();break;case r.TOUCH_DOLLY_ROTATE:if(!1===i.enableZoom&&!1===i.enableRotate)return;(function ut(z){i.enableZoom&&Ce(z),i.enableRotate&&Pe(z)})(z),i.update();break;default:s=r.NONE}}(z):function ci(z){switch(s){case r.ROTATE:if(!1===i.enableRotate)return;!function xe(z){p.set(z.clientX,z.clientY),m.subVectors(p,f).multiplyScalar(i.rotateSpeed);const Ie=i.domElement;K(2*Math.PI*m.x/Ie.clientHeight),oe(2*Math.PI*m.y/Ie.clientHeight),f.copy(p),i.update()}(z);break;case r.DOLLY:if(!1===i.enableZoom)return;!function Se(z){S.set(z.clientX,z.clientY),b.subVectors(S,y),b.y>0?$(N()):b.y<0&&Y(N()),y.copy(S),i.update()}(z);break;case r.PAN:if(!1===i.enablePan)return;!function ze(z){E.set(z.clientX,z.clientY),v.subVectors(E,_).multiplyScalar(i.panSpeed),J(v.x,v.y),_.copy(E),i.update()}(z)}}(z))}function Mt(z){(function at(z){delete F[z.pointerId];for(let Ie=0;Ie<A.length;Ie++)if(A[Ie].pointerId==z.pointerId)return void A.splice(Ie,1)})(z),0===A.length&&(i.domElement.releasePointerCapture(z.pointerId),i.domElement.removeEventListener("pointermove",et),i.domElement.removeEventListener("pointerup",Mt)),i.dispatchEvent(OV),s=r.NONE}function k(z){!1===i.enabled||!1===i.enableZoom||s!==r.NONE||(z.preventDefault(),i.dispatchEvent(K1),function nt(z){ie(z),z.deltaY<0?Y(N()):z.deltaY>0&&$(N()),i.update()}(z),i.dispatchEvent(OV))}function R(z){!1===i.enabled||!1===i.enablePan||function Ge(z){let Ie=!1;switch(z.code){case i.keys.UP:z.ctrlKey||z.metaKey||z.shiftKey?oe(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):J(0,i.keyPanSpeed),Ie=!0;break;case i.keys.BOTTOM:z.ctrlKey||z.metaKey||z.shiftKey?oe(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):J(0,-i.keyPanSpeed),Ie=!0;break;case i.keys.LEFT:z.ctrlKey||z.metaKey||z.shiftKey?K(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):J(i.keyPanSpeed,0),Ie=!0;break;case i.keys.RIGHT:z.ctrlKey||z.metaKey||z.shiftKey?K(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):J(-i.keyPanSpeed,0),Ie=!0}Ie&&(z.preventDefault(),i.update())}(z)}function Me(z){!1!==i.enabled&&z.preventDefault()}function De(z){let Ie=F[z.pointerId];void 0===Ie&&(Ie=new he,F[z.pointerId]=Ie),Ie.set(z.pageX,z.pageY)}function $e(z){return F[(z.pointerId===A[0].pointerId?A[1]:A[0]).pointerId]}i.domElement.addEventListener("contextmenu",Me),i.domElement.addEventListener("pointerdown",Je),i.domElement.addEventListener("pointercancel",Mt),i.domElement.addEventListener("wheel",k,{passive:!1}),this.update()}}var kV=class{target;name;intersected;wasIntersected=!1;distance;constructor(n,e){this.target=n,this.name=e,this.intersected=!1,this.distance=0}},Gs=class{type;cancelBubble;originalEvent;coords=new he(0,0);distance=0;intersected=!1;constructor(n,e=null){this.cancelBubble=!1,this.type=n,this.originalEvent=e}stopPropagation(){this.cancelBubble=!0}},Mw=yo(990),iie=yo(304);class rie{constructor(e,t,i){this.x=e,this.y=t,this.z=i}}let UV=(()=>{class n{static createButton(t){const i=document.createElement("button");function s(){i.style.display="",i.style.cursor="auto",i.style.left="calc(50% - 75px)",i.style.width="150px",i.onmouseenter=null,i.onmouseleave=null,i.onclick=null}function l(c){c.style.position="absolute",c.style.bottom="20px",c.style.padding="12px 6px",c.style.border="1px solid #fff",c.style.borderRadius="4px",c.style.background="rgba(0,0,0,0.1)",c.style.color="#fff",c.style.font="normal 13px sans-serif",c.style.textAlign="center",c.style.opacity="0.5",c.style.outline="none",c.style.zIndex="999"}if("xr"in navigator)return i.id="VRButton",i.style.display="none",l(i),navigator.xr.isSessionSupported("immersive-vr").then(function(c){c?function r(){let c=null;function d(m){return f.apply(this,arguments)}function f(){return(f=Fn(function*(m){m.addEventListener("end",p),yield t.xr.setSession(m),i.textContent="EXIT VR",c=m})).apply(this,arguments)}function p(){c.removeEventListener("end",p),i.textContent="ENTER VR",c=null}i.style.display="",i.style.cursor="pointer",i.style.left="calc(50% - 50px)",i.style.width="100px",i.textContent="ENTER VR",i.onmouseenter=function(){i.style.opacity="1.0"},i.onmouseleave=function(){i.style.opacity="0.5"},i.onclick=function(){null===c?navigator.xr.requestSession("immersive-vr",{optionalFeatures:["local-floor","bounded-floor","hand-tracking","layers"]}).then(d):c.end()}}():function o(){s(),i.textContent="VR NOT SUPPORTED"}(),c&&n.xrSessionIsGranted&&i.click()}).catch(function a(c){s(),console.warn("Exception when trying to call xr.isSessionSupported",c),i.textContent="VR NOT ALLOWED"}),i;{const c=document.createElement("a");return!1===window.isSecureContext?(c.href=document.location.href.replace(/^http:/,"https:"),c.innerHTML="WEBXR NEEDS HTTPS"):(c.href="https://immersiveweb.dev/",c.innerHTML="WEBXR NOT AVAILABLE"),c.style.left="calc(50% - 90px)",c.style.width="180px",c.style.textDecoration="none",l(c),c}}static registerSessionGrantedListener(){if("xr"in navigator){if(/WebXRViewer\//i.test(navigator.userAgent))return;navigator.xr.addEventListener("sessiongranted",()=>{n.xrSessionIsGranted=!0})}}}return n.xrSessionIsGranted=!1,n})();UV.registerSessionGrantedListener();var n,vm=Object.freeze({Linear:Object.freeze({None:function(n){return n},In:function(n){return this.None(n)},Out:function(n){return this.None(n)},InOut:function(n){return this.None(n)}}),Quadratic:Object.freeze({In:function(n){return n*n},Out:function(n){return n*(2-n)},InOut:function(n){return(n*=2)<1?.5*n*n:-.5*(--n*(n-2)-1)}}),Cubic:Object.freeze({In:function(n){return n*n*n},Out:function(n){return--n*n*n+1},InOut:function(n){return(n*=2)<1?.5*n*n*n:.5*((n-=2)*n*n+2)}}),Quartic:Object.freeze({In:function(n){return n*n*n*n},Out:function(n){return 1- --n*n*n*n},InOut:function(n){return(n*=2)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2)}}),Quintic:Object.freeze({In:function(n){return n*n*n*n*n},Out:function(n){return--n*n*n*n*n+1},InOut:function(n){return(n*=2)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2)}}),Sinusoidal:Object.freeze({In:function(n){return 1-Math.sin((1-n)*Math.PI/2)},Out:function(n){return Math.sin(n*Math.PI/2)},InOut:function(n){return.5*(1-Math.sin(Math.PI*(.5-n)))}}),Exponential:Object.freeze({In:function(n){return 0===n?0:Math.pow(1024,n-1)},Out:function(n){return 1===n?1:1-Math.pow(2,-10*n)},InOut:function(n){return 0===n?0:1===n?1:(n*=2)<1?.5*Math.pow(1024,n-1):.5*(2-Math.pow(2,-10*(n-1)))}}),Circular:Object.freeze({In:function(n){return 1-Math.sqrt(1-n*n)},Out:function(n){return Math.sqrt(1- --n*n)},InOut:function(n){return(n*=2)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1)}}),Elastic:Object.freeze({In:function(n){return 0===n?0:1===n?1:-Math.pow(2,10*(n-1))*Math.sin(5*(n-1.1)*Math.PI)},Out:function(n){return 0===n?0:1===n?1:Math.pow(2,-10*n)*Math.sin(5*(n-.1)*Math.PI)+1},InOut:function(n){return 0===n?0:1===n?1:(n*=2)<1?-.5*Math.pow(2,10*(n-1))*Math.sin(5*(n-1.1)*Math.PI):.5*Math.pow(2,-10*(n-1))*Math.sin(5*(n-1.1)*Math.PI)+1}}),Back:Object.freeze({In:function(n){var e=1.70158;return 1===n?1:n*n*((e+1)*n-e)},Out:function(n){var e=1.70158;return 0===n?0:--n*n*((e+1)*n+e)+1},InOut:function(n){var e=2.5949095;return(n*=2)<1?n*n*((e+1)*n-e)*.5:.5*((n-=2)*n*((e+1)*n+e)+2)}}),Bounce:Object.freeze({In:function(n){return 1-vm.Bounce.Out(1-n)},Out:function(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},InOut:function(n){return n<.5?.5*vm.Bounce.In(2*n):.5*vm.Bounce.Out(2*n-1)+.5}}),generatePow:function(n){return void 0===n&&(n=4),n=(n=n<Number.EPSILON?Number.EPSILON:n)>1e4?1e4:n,{In:function(e){return Math.pow(e,n)},Out:function(e){return 1-Math.pow(1-e,n)},InOut:function(e){return e<.5?Math.pow(2*e,n)/2:(1-Math.pow(2-2*e,n))/2+.5}}}}),Em=function(){return performance.now()},BV=function(){function n(){this._tweens={},this._tweensAddedDuringUpdate={}}return n.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map(function(t){return e._tweens[t]})},n.prototype.removeAll=function(){this._tweens={}},n.prototype.add=function(e){this._tweens[e.getId()]=e,this._tweensAddedDuringUpdate[e.getId()]=e},n.prototype.remove=function(e){delete this._tweens[e.getId()],delete this._tweensAddedDuringUpdate[e.getId()]},n.prototype.update=function(e,t){void 0===e&&(e=Em()),void 0===t&&(t=!1);var i=Object.keys(this._tweens);if(0===i.length)return!1;for(;i.length>0;){this._tweensAddedDuringUpdate={};for(var r=0;r<i.length;r++){var s=this._tweens[i[r]];s&&!1===s.update(e,!t)&&!t&&delete this._tweens[i[r]]}i=Object.keys(this._tweensAddedDuringUpdate)}return!0},n}(),oh={Linear:function(n,e){var t=n.length-1,i=t*e,r=Math.floor(i),s=oh.Utils.Linear;return e<0?s(n[0],n[1],i):e>1?s(n[t],n[t-1],t-i):s(n[r],n[r+1>t?t:r+1],i-r)},Bezier:function(n,e){for(var t=0,i=n.length-1,r=Math.pow,s=oh.Utils.Bernstein,o=0;o<=i;o++)t+=r(1-e,i-o)*r(e,o)*n[o]*s(i,o);return t},CatmullRom:function(n,e){var t=n.length-1,i=t*e,r=Math.floor(i),s=oh.Utils.CatmullRom;return n[0]===n[t]?(e<0&&(r=Math.floor(i=t*(1+e))),s(n[(r-1+t)%t],n[r],n[(r+1)%t],n[(r+2)%t],i-r)):e<0?n[0]-(s(n[0],n[0],n[1],n[1],-i)-n[0]):e>1?n[t]-(s(n[t],n[t],n[t-1],n[t-1],i-t)-n[t]):s(n[r?r-1:0],n[r],n[t<r+1?t:r+1],n[t<r+2?t:r+2],i-r)},Utils:{Linear:function(n,e,t){return(e-n)*t+n},Bernstein:function(n,e){var t=oh.Utils.Factorial;return t(n)/t(e)/t(n-e)},Factorial:(n=[1],function(e){var t=1;if(n[e])return n[e];for(var i=e;i>1;i--)t*=i;return n[e]=t,t}),CatmullRom:function(n,e,t,i,r){var s=.5*(t-n),o=.5*(i-e),a=r*r;return(2*e-2*t+s+o)*(r*a)+(-3*e+3*t-2*s-o)*a+s*r+e}}},Z1=function(){function n(){}return n.nextId=function(){return n._nextId++},n._nextId=0,n}(),J1=new BV,VV=function(){function n(e,t){void 0===t&&(t=J1),this._object=e,this._group=t,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=vm.Linear.None,this._interpolationFunction=oh.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=Z1.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1}return n.prototype.getId=function(){return this._id},n.prototype.isPlaying=function(){return this._isPlaying},n.prototype.isPaused=function(){return this._isPaused},n.prototype.to=function(e,t){if(void 0===t&&(t=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=t,this},n.prototype.duration=function(e){return void 0===e&&(e=1e3),this._duration=e,this},n.prototype.dynamic=function(e){return void 0===e&&(e=!1),this._isDynamic=e,this},n.prototype.start=function(e,t){if(void 0===e&&(e=Em()),void 0===t&&(t=!1),this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed)for(var i in this._reversed=!1,this._valuesStartRepeat)this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i];if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||t){if(this._propertiesAreSetUp=!0,!this._isDynamic){var r={};for(var s in this._valuesEnd)r[s]=this._valuesEnd[s];this._valuesEnd=r}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,t)}return this},n.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},n.prototype._setupProperties=function(e,t,i,r,s){for(var o in i){var a=e[o],l=Array.isArray(a),c=l?"array":typeof a,d=!l&&Array.isArray(i[o]);if("undefined"!==c&&"function"!==c){if(d){if(0===(f=i[o]).length)continue;for(var p=[a],m=0,_=f.length;m<_;m+=1){var E=this._handleRelativeValue(a,f[m]);if(isNaN(E)){d=!1,console.warn("Found invalid interpolation list. Skipping.");break}p.push(E)}d&&(i[o]=p)}if("object"!==c&&!l||!a||d)(typeof t[o]>"u"||s)&&(t[o]=a),l||(t[o]*=1),r[o]=d?i[o].slice().reverse():t[o]||0;else{t[o]=l?[]:{};var v=a;for(var y in v)t[o][y]=v[y];r[o]=l?[]:{};var f=i[o];if(!this._isDynamic){var S={};for(var y in f)S[y]=f[y];i[o]=f=S}this._setupProperties(v,t[o],f,r[o],s)}}}},n.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},n.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},n.prototype.pause=function(e){return void 0===e&&(e=Em()),this._isPaused||!this._isPlaying||(this._isPaused=!0,this._pauseStart=e,this._group&&this._group.remove(this)),this},n.prototype.resume=function(e){return void 0===e&&(e=Em()),this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this):this},n.prototype.stopChainedTweens=function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop();return this},n.prototype.group=function(e){return void 0===e&&(e=J1),this._group=e,this},n.prototype.delay=function(e){return void 0===e&&(e=0),this._delayTime=e,this},n.prototype.repeat=function(e){return void 0===e&&(e=0),this._initialRepeat=e,this._repeat=e,this},n.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},n.prototype.yoyo=function(e){return void 0===e&&(e=!1),this._yoyo=e,this},n.prototype.easing=function(e){return void 0===e&&(e=vm.Linear.None),this._easingFunction=e,this},n.prototype.interpolation=function(e){return void 0===e&&(e=oh.Linear),this._interpolationFunction=e,this},n.prototype.chain=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._chainedTweens=e,this},n.prototype.onStart=function(e){return this._onStartCallback=e,this},n.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},n.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},n.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},n.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},n.prototype.onStop=function(e){return this._onStopCallback=e,this},n.prototype.update=function(e,t){if(void 0===e&&(e=Em()),void 0===t&&(t=!0),this._isPaused)return!0;var i,r;if(!this._goToEnd&&!this._isPlaying){if(e>this._startTime+this._duration)return!1;t&&this.start(e,!0)}if(this._goToEnd=!1,e<this._startTime)return!0;!1===this._onStartCallbackFired&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),!1===this._onEveryStartCallbackFired&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0),r=(e-this._startTime)/this._duration;var o=this._easingFunction(r=0===this._duration||r>1?1:r);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,o),this._onUpdateCallback&&this._onUpdateCallback(this._object,r),1===r){if(this._repeat>0){for(i in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat)!this._yoyo&&"string"==typeof this._valuesEnd[i]&&(this._valuesStartRepeat[i]=this._valuesStartRepeat[i]+parseFloat(this._valuesEnd[i])),this._yoyo&&this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i];return this._yoyo&&(this._reversed=!this._reversed),this._startTime=void 0!==this._repeatDelayTime?e+this._repeatDelayTime:e+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var a=0,l=this._chainedTweens.length;a<l;a++)this._chainedTweens[a].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},n.prototype._updateProperties=function(e,t,i,r){for(var s in i)if(void 0!==t[s]){var o=t[s]||0,a=i[s],l=Array.isArray(e[s]),c=Array.isArray(a);!l&&c?e[s]=this._interpolationFunction(a,r):"object"==typeof a&&a?this._updateProperties(e[s],o,a,r):"number"==typeof(a=this._handleRelativeValue(o,a))&&(e[s]=o+(a-o)*r)}},n.prototype._handleRelativeValue=function(e,t){return"string"!=typeof t?t:"+"===t.charAt(0)||"-"===t.charAt(0)?e+parseFloat(t):parseFloat(t)},n.prototype._swapEndStartRepeatValues=function(e){var t=this._valuesStartRepeat[e],i=this._valuesEnd[e];this._valuesStartRepeat[e]="string"==typeof i?this._valuesStartRepeat[e]+parseFloat(i):this._valuesEnd[e],this._valuesEnd[e]=t},n}(),sl=J1,HV=(sl.getAll.bind(sl),sl.removeAll.bind(sl),sl.add.bind(sl),sl.remove.bind(sl),sl.update.bind(sl));function zV(n,e){if(0===e)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),n;if(2===e||1===e){let t=n.getIndex();if(null===t){const o=[],a=n.getAttribute("position");if(void 0===a)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n;for(let l=0;l<a.count;l++)o.push(l);n.setIndex(o),t=n.getIndex()}const i=t.count-2,r=[];if(2===e)for(let o=1;o<=i;o++)r.push(t.getX(0)),r.push(t.getX(o)),r.push(t.getX(o+1));else for(let o=0;o<i;o++)o%2==0?(r.push(t.getX(o)),r.push(t.getX(o+1)),r.push(t.getX(o+2))):(r.push(t.getX(o+2)),r.push(t.getX(o+1)),r.push(t.getX(o)));r.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=n.clone();return s.setIndex(r),s.clearGroups(),s}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),n}class hie extends Jy{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new _ie(t)}),this.register(function(t){return new xie(t)}),this.register(function(t){return new Tie(t)}),this.register(function(t){return new Cie(t)}),this.register(function(t){return new vie(t)}),this.register(function(t){return new Eie(t)}),this.register(function(t){return new bie(t)}),this.register(function(t){return new Sie(t)}),this.register(function(t){return new gie(t)}),this.register(function(t){return new wie(t)}),this.register(function(t){return new yie(t)}),this.register(function(t){return new Mie(t)}),this.register(function(t){return new pie(t)}),this.register(function(t){return new Aie(t)}),this.register(function(t){return new Die(t)})}load(e,t,i,r){const s=this;let o;o=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:ev.extractUrlBase(e),this.manager.itemStart(e);const a=function(c){r?r(c):console.error(c),s.manager.itemError(e),s.manager.itemEnd(e)},l=new rl(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(c){try{s.parse(c,o,function(d){t(d),s.manager.itemEnd(e)},a)}catch(d){a(d)}},i,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,r){let s;const o={},a={},l=new TextDecoder;if("string"==typeof e)s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(l.decode(new Uint8Array(e,0,4))===GV){try{o[hn.KHR_BINARY_GLTF]=new Iie(e)}catch(f){return void(r&&r(f))}s=JSON.parse(o[hn.KHR_BINARY_GLTF].content)}else s=JSON.parse(l.decode(e));else s=e;if(void 0===s.asset||s.asset.version[0]<2)return void(r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const c=new Gie(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});c.fileLoader.setRequestHeader(this.requestHeader);for(let d=0;d<this.pluginCallbacks.length;d++){const f=this.pluginCallbacks[d](c);a[f.name]=f,o[f.name]=!0}if(s.extensionsUsed)for(let d=0;d<s.extensionsUsed.length;++d){const f=s.extensionsUsed[d],p=s.extensionsRequired||[];switch(f){case hn.KHR_MATERIALS_UNLIT:o[f]=new mie;break;case hn.KHR_DRACO_MESH_COMPRESSION:o[f]=new Rie(s,this.dracoLoader);break;case hn.KHR_TEXTURE_TRANSFORM:o[f]=new Pie;break;case hn.KHR_MESH_QUANTIZATION:o[f]=new Nie;break;default:p.indexOf(f)>=0&&void 0===a[f]&&console.warn('THREE.GLTFLoader: Unknown extension "'+f+'".')}}c.setExtensions(o),c.setPlugins(a),c.parse(i,r)}parseAsync(e,t){const i=this;return new Promise(function(r,s){i.parse(e,t,r,s)})}}function fie(){let n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}const hn={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class pie{constructor(e){this.parser=e,this.name=hn.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let i=0,r=t.length;i<r;i++){const s=t[i];s.extensions&&s.extensions[this.name]&&void 0!==s.extensions[this.name].light&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,i="light:"+e;let r=t.cache.get(i);if(r)return r;const s=t.json,l=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let c;const d=new je(16777215);void 0!==l.color&&d.setRGB(l.color[0],l.color[1],l.color[2],Fr);const f=void 0!==l.range?l.range:0;switch(l.type){case"directional":c=new dV(d),c.target.position.set(0,0,-1),c.add(c.target);break;case"point":c=new uV(d),c.distance=f;break;case"spot":c=new lV(d),c.distance=f,l.spot=l.spot||{},l.spot.innerConeAngle=void 0!==l.spot.innerConeAngle?l.spot.innerConeAngle:0,l.spot.outerConeAngle=void 0!==l.spot.outerConeAngle?l.spot.outerConeAngle:Math.PI/4,c.angle=l.spot.outerConeAngle,c.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,c.target.position.set(0,0,-1),c.add(c.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return c.position.set(0,0,0),c.decay=2,wu(c,l),void 0!==l.intensity&&(c.intensity=l.intensity),c.name=t.createUniqueName(l.name||"light_"+e),r=Promise.resolve(c),t.cache.add(i,r),r}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){const t=this,i=this.parser,s=i.json.nodes[e],a=(s.extensions&&s.extensions[this.name]||{}).light;return void 0===a?null:this._loadLight(a).then(function(l){return i._getNodeRef(t.cache,a,l)})}}class mie{constructor(){this.name=hn.KHR_MATERIALS_UNLIT}getMaterialType(){return Vs}extendParams(e,t,i){const r=[];e.color=new je(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.setRGB(o[0],o[1],o[2],Fr),e.opacity=o[3]}void 0!==s.baseColorTexture&&r.push(i.assignTexture(e,"map",s.baseColorTexture,fi))}return Promise.all(r)}}class gie{constructor(e){this.parser=e,this.name=hn.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name].emissiveStrength;return void 0!==s&&(t.emissiveIntensity=s),Promise.resolve()}}class _ie{constructor(e){this.parser=e,this.name=hn.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?ic:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];if(void 0!==o.clearcoatFactor&&(t.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&s.push(i.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&s.push(i.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(s.push(i.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){const a=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new he(a,a)}return Promise.all(s)}}class yie{constructor(e){this.parser=e,this.name=hn.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?ic:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.iridescenceFactor&&(t.iridescence=o.iridescenceFactor),void 0!==o.iridescenceTexture&&s.push(i.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),void 0!==o.iridescenceIor&&(t.iridescenceIOR=o.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==o.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),void 0!==o.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),void 0!==o.iridescenceThicknessTexture&&s.push(i.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}}class vie{constructor(e){this.parser=e,this.name=hn.KHR_MATERIALS_SHEEN}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?ic:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new je(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=r.extensions[this.name];if(void 0!==o.sheenColorFactor){const a=o.sheenColorFactor;t.sheenColor.setRGB(a[0],a[1],a[2],Fr)}return void 0!==o.sheenRoughnessFactor&&(t.sheenRoughness=o.sheenRoughnessFactor),void 0!==o.sheenColorTexture&&s.push(i.assignTexture(t,"sheenColorMap",o.sheenColorTexture,fi)),void 0!==o.sheenRoughnessTexture&&s.push(i.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class Eie{constructor(e){this.parser=e,this.name=hn.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?ic:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.transmissionFactor&&(t.transmission=o.transmissionFactor),void 0!==o.transmissionTexture&&s.push(i.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class bie{constructor(e){this.parser=e,this.name=hn.KHR_MATERIALS_VOLUME}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?ic:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.thickness=void 0!==o.thicknessFactor?o.thicknessFactor:0,void 0!==o.thicknessTexture&&s.push(i.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;const a=o.attenuationColor||[1,1,1];return t.attenuationColor=(new je).setRGB(a[0],a[1],a[2],Fr),Promise.all(s)}}class Sie{constructor(e){this.parser=e,this.name=hn.KHR_MATERIALS_IOR}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?ic:null}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return t.ior=void 0!==s.ior?s.ior:1.5,Promise.resolve()}}class wie{constructor(e){this.parser=e,this.name=hn.KHR_MATERIALS_SPECULAR}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?ic:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.specularIntensity=void 0!==o.specularFactor?o.specularFactor:1,void 0!==o.specularTexture&&s.push(i.assignTexture(t,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return t.specularColor=(new je).setRGB(a[0],a[1],a[2],Fr),void 0!==o.specularColorTexture&&s.push(i.assignTexture(t,"specularColorMap",o.specularColorTexture,fi)),Promise.all(s)}}class Mie{constructor(e){this.parser=e,this.name=hn.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?ic:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.anisotropyStrength&&(t.anisotropy=o.anisotropyStrength),void 0!==o.anisotropyRotation&&(t.anisotropyRotation=o.anisotropyRotation),void 0!==o.anisotropyTexture&&s.push(i.assignTexture(t,"anisotropyMap",o.anisotropyTexture)),Promise.all(s)}}class xie{constructor(e){this.parser=e,this.name=hn.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,i=t.json,r=i.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,o)}}class Tie{constructor(e){this.parser=e,this.name=hn.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let l=i.textureLoader;if(a.uri){const c=i.options.manager.getHandler(a.uri);null!==c&&(l=c)}return this.detectSupport().then(function(c){if(c)return i.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class Cie{constructor(e){this.parser=e,this.name=hn.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let l=i.textureLoader;if(a.uri){const c=i.options.manager.getHandler(a.uri);null!==c&&(l=c)}return this.detectSupport().then(function(c){if(c)return i.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class Aie{constructor(e){this.name=hn.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){const r=i.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(a){const d=r.count,f=r.byteStride,p=new Uint8Array(a,r.byteOffset||0,r.byteLength||0);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(d,f,p,r.mode,r.filter).then(function(m){return m.buffer}):o.ready.then(function(){const m=new ArrayBuffer(d*f);return o.decodeGltfBuffer(new Uint8Array(m),d,f,p,r.mode,r.filter),m})})}return null}}class Die{constructor(e){this.name=hn.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,i=t.nodes[e];if(!i.extensions||!i.extensions[this.name]||void 0===i.mesh)return null;const r=t.meshes[i.mesh];for(const c of r.primitives)if(c.mode!==Ho.TRIANGLES&&c.mode!==Ho.TRIANGLE_STRIP&&c.mode!==Ho.TRIANGLE_FAN&&void 0!==c.mode)return null;const o=i.extensions[this.name].attributes,a=[],l={};for(const c in o)a.push(this.parser.getDependency("accessor",o[c]).then(d=>(l[c]=d,l[c])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(c=>{const d=c.pop(),f=d.isGroup?d.children:[d],p=c[0].count,m=[];for(const _ of f){const E=new At,v=new L,y=new kr,S=new L(1,1,1),b=new RB(_.geometry,_.material,p);for(let M=0;M<p;M++)l.TRANSLATION&&v.fromBufferAttribute(l.TRANSLATION,M),l.ROTATION&&y.fromBufferAttribute(l.ROTATION,M),l.SCALE&&S.fromBufferAttribute(l.SCALE,M),b.setMatrixAt(M,E.compose(v,y,S));for(const M in l)"TRANSLATION"!==M&&"ROTATION"!==M&&"SCALE"!==M&&_.geometry.setAttribute(M,l[M]);lr.prototype.copy.call(b,_),this.parser.assignFinalMaterial(b),m.push(b)}return d.isGroup?(d.clear(),d.add(...m),d):m[0]}))}}const GV="glTF";class Iie{constructor(e){this.name=hn.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12),i=new TextDecoder;if(this.header={magic:i.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==GV)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-12,s=new DataView(e,12);let o=0;for(;o<r;){const a=s.getUint32(o,!0);o+=4;const l=s.getUint32(o,!0);if(o+=4,1313821514===l){const c=new Uint8Array(e,12+o,a);this.content=i.decode(c)}else if(5130562===l){const c=12+o;this.body=e.slice(c,c+a)}o+=a}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Rie{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=hn.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const i=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},l={},c={};for(const d in o){const f=nI[d]||d.toLowerCase();a[f]=o[d]}for(const d in e.attributes){const f=nI[d]||d.toLowerCase();if(void 0!==o[d]){const p=i.accessors[e.attributes[d]];c[f]=bm[p.componentType].name,l[f]=!0===p.normalized}}return t.getDependency("bufferView",s).then(function(d){return new Promise(function(f){r.decodeDracoFile(d,function(p){for(const m in p.attributes){const E=l[m];void 0!==E&&(p.attributes[m].normalized=E)}f(p)},a,c)})})}}class Pie{constructor(){this.name=hn.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(void 0===t.texCoord||t.texCoord===e.channel)&&void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.texCoord&&(e.channel=t.texCoord),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class Nie{constructor(){this.name=hn.KHR_MESH_QUANTIZATION}}class $V extends Ky{constructor(e,t,i,r){super(e,t,i,r)}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let o=0;o!==r;o++)t[o]=i[s+o];return t}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=2*a,c=3*a,d=r-t,f=(i-t)/d,p=f*f,m=p*f,_=e*c,E=_-c,v=-2*m+3*p,y=m-p,S=1-v,b=y-p+f;for(let M=0;M!==a;M++)s[M]=S*o[E+M+a]+b*(o[E+M+l]*d)+v*o[_+M+a]+y*(o[_+M]*d);return s}}const Lie=new kr;class Oie extends $V{interpolate_(e,t,i,r){const s=super.interpolate_(e,t,i,r);return Lie.fromArray(s).normalize().toArray(s),s}}const Ho={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},bm={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},jV={9728:Oi,9729:bi,9984:1004,9985:1007,9986:1005,9987:jl},qV={33071:Kr,33648:1002,10497:Od},tI={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},nI={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Su={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Fie={CUBICSPLINE:void 0,LINEAR:Np,STEP:Ty};function kie(n){return void 0===n.DefaultMaterial&&(n.DefaultMaterial=new fw({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:0})),n.DefaultMaterial}function ah(n,e,t){for(const i in t.extensions)void 0===n[i]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=t.extensions[i])}function wu(n,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(n.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function Bie(n,e){if(n.updateMorphTargets(),void 0!==e.weights)for(let t=0,i=e.weights.length;t<i;t++)n.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(n.morphTargetInfluences.length===t.length){n.morphTargetDictionary={};for(let i=0,r=t.length;i<r;i++)n.morphTargetDictionary[t[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Vie(n){let e;const t=n.extensions&&n.extensions[hn.KHR_DRACO_MESH_COMPRESSION];if(e=t?"draco:"+t.bufferView+":"+t.indices+":"+rI(t.attributes):n.indices+":"+rI(n.attributes)+":"+n.mode,void 0!==n.targets)for(let i=0,r=n.targets.length;i<r;i++)e+=":"+rI(n.targets[i]);return e}function rI(n){let e="";const t=Object.keys(n).sort();for(let i=0,r=t.length;i<r;i++)e+=t[i]+":"+n[t[i]]+";";return e}function sI(n){switch(n){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const zie=new At;class Gie{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new fie,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,r=!1,s=-1;typeof navigator<"u"&&(i=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),r=navigator.userAgent.indexOf("Firefox")>-1,s=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),this.textureLoader=typeof createImageBitmap>"u"||i||r&&s<98?new xne(this.options.manager):new Fne(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new rl(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const i=this,r=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(o){const a={scene:o[0][r.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:r.asset,parser:i,userData:{}};return ah(s,a,r),wu(a,r),Promise.all(i._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){e(a)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){const o=t[r].joints;for(let a=0,l=o.length;a<l;a++)e[o[a]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const o=e[r];void 0!==o.mesh&&(this._addNodeRef(this.meshCache,o.mesh),void 0!==o.skin&&(i[o.mesh].isSkinnedMesh=!0)),void 0!==o.camera&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;const r=i.clone(),s=(o,a)=>{const l=this.associations.get(o);null!=l&&this.associations.set(a,l);for(const[c,d]of o.children.entries())s(d,a.children[c])};return s(i,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){const r=e(t[i]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const i=[];for(let r=0;r<t.length;r++){const s=e(t[r]);s&&i.push(s)}return i}getDependency(e,t){const i=e+":"+t;let r=this.cache.get(i);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!r)throw new Error("Unknown type: "+e)}this.cache.add(i,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const i=this;t=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map(function(s,o){return i.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],i=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[hn.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,o){i.load(ev.resolveURL(t.uri,r.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(i){const s=t.byteOffset||0;return i.slice(s,s+(t.byteLength||0))})}loadAccessor(e){const t=this,i=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse){const o=tI[r.type],l=!0===r.normalized,c=new(0,bm[r.componentType])(r.count*o);return Promise.resolve(new wi(c,o,l))}const s=[];return s.push(void 0!==r.bufferView?this.getDependency("bufferView",r.bufferView):null),void 0!==r.sparse&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(o){const a=o[0],l=tI[r.type],c=bm[r.componentType],d=c.BYTES_PER_ELEMENT,p=r.byteOffset||0,m=void 0!==r.bufferView?i.bufferViews[r.bufferView].byteStride:void 0,_=!0===r.normalized;let E,v;if(m&&m!==d*l){const y=Math.floor(p/m),S="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+y+":"+r.count;let b=t.cache.get(S);b||(E=new c(a,y*m,r.count*m/d),b=new u1(E,m/d),t.cache.add(S,b)),v=new Kd(b,l,p%m/d,_)}else E=null===a?new c(r.count*l):new c(a,p,r.count*l),v=new wi(E,l,_);if(void 0!==r.sparse){const M=r.sparse.values.byteOffset||0,T=new(0,bm[r.sparse.indices.componentType])(o[1],r.sparse.indices.byteOffset||0,r.sparse.count*tI.SCALAR),I=new c(o[2],M,r.sparse.count*l);null!==a&&(v=new wi(v.array.slice(),v.itemSize,v.normalized));for(let A=0,F=T.length;A<F;A++){const C=T[A];if(v.setX(C,I[A*l]),l>=2&&v.setY(C,I[A*l+1]),l>=3&&v.setZ(C,I[A*l+2]),l>=4&&v.setW(C,I[A*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return v})}loadTexture(e){const t=this.json,s=t.textures[e].source,o=t.images[s];let a=this.textureLoader;if(o.uri){const l=this.options.manager.getHandler(o.uri);null!==l&&(a=l)}return this.loadTextureImage(e,s,a)}loadTextureImage(e,t,i){const r=this,s=this.json,o=s.textures[e],a=s.images[t],l=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[l])return this.textureCache[l];const c=this.loadImageSource(t,i).then(function(d){d.flipY=!1,d.name=o.name||a.name||"",""===d.name&&"string"==typeof a.uri&&!1===a.uri.startsWith("data:image/")&&(d.name=a.uri);const p=(s.samplers||{})[o.sampler]||{};return d.magFilter=jV[p.magFilter]||bi,d.minFilter=jV[p.minFilter]||jl,d.wrapS=qV[p.wrapS]||Od,d.wrapT=qV[p.wrapT]||Od,r.associations.set(d,{textures:e}),d}).catch(function(){return null});return this.textureCache[l]=c,c}loadImageSource(e,t){const r=this.json,s=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(f=>f.clone());const o=r.images[e],a=self.URL||self.webkitURL;let l=o.uri||"",c=!1;if(void 0!==o.bufferView)l=this.getDependency("bufferView",o.bufferView).then(function(f){c=!0;const p=new Blob([f],{type:o.mimeType});return l=a.createObjectURL(p),l});else if(void 0===o.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const d=Promise.resolve(l).then(function(f){return new Promise(function(p,m){let _=p;!0===t.isImageBitmapLoader&&(_=function(E){const v=new pa(E);v.needsUpdate=!0,p(v)}),t.load(ev.resolveURL(f,s.path),_,void 0,m)})}).then(function(f){return!0===c&&a.revokeObjectURL(l),f.userData.mimeType=o.mimeType||function Hie(n){return n.search(/\.jpe?g($|\?)/i)>0||0===n.search(/^data\:image\/jpeg/)?"image/jpeg":n.search(/\.webp($|\?)/i)>0||0===n.search(/^data\:image\/webp/)?"image/webp":"image/png"}(o.uri),f}).catch(function(f){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),f});return this.sourceCache[e]=d,d}assignTexture(e,t,i,r){const s=this;return this.getDependency("texture",i.index).then(function(o){if(!o)return null;if(void 0!==i.texCoord&&i.texCoord>0&&((o=o.clone()).channel=i.texCoord),s.extensions[hn.KHR_TEXTURE_TRANSFORM]){const a=void 0!==i.extensions?i.extensions[hn.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const l=s.associations.get(o);o=s.extensions[hn.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),s.associations.set(o,l)}}return void 0!==r&&(o.colorSpace=r),e[t]=o,o})}assignFinalMaterial(e){const t=e.geometry;let i=e.material;const r=void 0===t.attributes.tangent,s=void 0!==t.attributes.color,o=void 0===t.attributes.normal;if(e.isPoints){const a="PointsMaterial:"+i.uuid;let l=this.cache.get(a);l||(l=new _1,ya.prototype.copy.call(l,i),l.color.copy(i.color),l.map=i.map,l.sizeAttenuation=!1,this.cache.add(a,l)),i=l}else if(e.isLine){const a="LineBasicMaterial:"+i.uuid;let l=this.cache.get(a);l||(l=new zs,ya.prototype.copy.call(l,i),l.color.copy(i.color),l.map=i.map,this.cache.add(a,l)),i=l}if(r||s||o){let a="ClonedMaterial:"+i.uuid+":";r&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=i.clone(),s&&(l.vertexColors=!0),o&&(l.flatShading=!0),r&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(i))),i=l}e.material=i}getMaterialType(){return fw}loadMaterial(e){const t=this,r=this.extensions,s=this.json.materials[e];let o;const a={},c=[];if((s.extensions||{})[hn.KHR_MATERIALS_UNLIT]){const f=r[hn.KHR_MATERIALS_UNLIT];o=f.getMaterialType(),c.push(f.extendParams(a,s,t))}else{const f=s.pbrMetallicRoughness||{};if(a.color=new je(1,1,1),a.opacity=1,Array.isArray(f.baseColorFactor)){const p=f.baseColorFactor;a.color.setRGB(p[0],p[1],p[2],Fr),a.opacity=p[3]}void 0!==f.baseColorTexture&&c.push(t.assignTexture(a,"map",f.baseColorTexture,fi)),a.metalness=void 0!==f.metallicFactor?f.metallicFactor:1,a.roughness=void 0!==f.roughnessFactor?f.roughnessFactor:1,void 0!==f.metallicRoughnessTexture&&(c.push(t.assignTexture(a,"metalnessMap",f.metallicRoughnessTexture)),c.push(t.assignTexture(a,"roughnessMap",f.metallicRoughnessTexture))),o=this._invokeOne(function(p){return p.getMaterialType&&p.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(p){return p.extendMaterialParams&&p.extendMaterialParams(e,a)})))}!0===s.doubleSided&&(a.side=2);const d=s.alphaMode||"OPAQUE";if("BLEND"===d?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,"MASK"===d&&(a.alphaTest=void 0!==s.alphaCutoff?s.alphaCutoff:.5)),void 0!==s.normalTexture&&o!==Vs&&(c.push(t.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new he(1,1),void 0!==s.normalTexture.scale)){const f=s.normalTexture.scale;a.normalScale.set(f,f)}if(void 0!==s.occlusionTexture&&o!==Vs&&(c.push(t.assignTexture(a,"aoMap",s.occlusionTexture)),void 0!==s.occlusionTexture.strength&&(a.aoMapIntensity=s.occlusionTexture.strength)),void 0!==s.emissiveFactor&&o!==Vs){const f=s.emissiveFactor;a.emissive=(new je).setRGB(f[0],f[1],f[2],Fr)}return void 0!==s.emissiveTexture&&o!==Vs&&c.push(t.assignTexture(a,"emissiveMap",s.emissiveTexture,fi)),Promise.all(c).then(function(){const f=new o(a);return s.name&&(f.name=s.name),wu(f,s),t.associations.set(f,{materials:e}),s.extensions&&ah(r,f,s),f})}createUniqueName(e){const t=Zn.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,i=this.extensions,r=this.primitiveCache;function s(a){return i[hn.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(l){return XV(l,a,t)})}const o=[];for(let a=0,l=e.length;a<l;a++){const c=e[a],d=Vie(c),f=r[d];if(f)o.push(f.promise);else{let p;p=c.extensions&&c.extensions[hn.KHR_DRACO_MESH_COMPRESSION]?s(c):XV(new en,c,t),r[d]={primitive:c,promise:p},o.push(p)}}return Promise.all(o)}loadMesh(e){const t=this,r=this.extensions,s=this.json.meshes[e],o=s.primitives,a=[];for(let l=0,c=o.length;l<c;l++){const d=void 0===o[l].material?kie(this.cache):this.getDependency("material",o[l].material);a.push(d)}return a.push(t.loadGeometries(o)),Promise.all(a).then(function(l){const c=l.slice(0,l.length-1),d=l[l.length-1],f=[];for(let m=0,_=d.length;m<_;m++){const E=d[m],v=o[m];let y;const S=c[m];if(v.mode===Ho.TRIANGLES||v.mode===Ho.TRIANGLE_STRIP||v.mode===Ho.TRIANGLE_FAN||void 0===v.mode)y=!0===s.isSkinnedMesh?new CB(E,S):new xr(E,S),!0===y.isSkinnedMesh&&y.normalizeSkinWeights(),v.mode===Ho.TRIANGLE_STRIP?y.geometry=zV(y.geometry,1):v.mode===Ho.TRIANGLE_FAN&&(y.geometry=zV(y.geometry,2));else if(v.mode===Ho.LINES)y=new g1(E,S);else if(v.mode===Ho.LINE_STRIP)y=new Eu(E,S);else if(v.mode===Ho.LINE_LOOP)y=new kB(E,S);else{if(v.mode!==Ho.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+v.mode);y=new BB(E,S)}Object.keys(y.geometry.morphAttributes).length>0&&Bie(y,s),y.name=t.createUniqueName(s.name||"mesh_"+e),wu(y,s),v.extensions&&ah(r,y,v),t.assignFinalMaterial(y),f.push(y)}for(let m=0,_=f.length;m<_;m++)t.associations.set(f[m],{meshes:e,primitives:m});if(1===f.length)return s.extensions&&ah(r,f[0],s),f[0];const p=new vu;s.extensions&&ah(r,p,s),t.associations.set(p,{meshes:e});for(let m=0,_=f.length;m<_;m++)p.add(f[m]);return p})}loadCamera(e){let t;const i=this.json.cameras[e],r=i[i.type];if(r)return"perspective"===i.type?t=new Tr(LD_radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===i.type&&(t=new GS(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),wu(t,i),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],i=[];for(let r=0,s=t.joints.length;r<s;r++)i.push(this._loadNodeShallow(t.joints[r]));return i.push(void 0!==t.inverseBindMatrices?this.getDependency("accessor",t.inverseBindMatrices):null),Promise.all(i).then(function(r){const s=r.pop(),o=r,a=[],l=[];for(let c=0,d=o.length;c<d;c++){const f=o[c];if(f){a.push(f);const p=new At;null!==s&&p.fromArray(s.array,16*c),l.push(p)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[c])}return new ZS(a,l)})}loadAnimation(e){const i=this,r=this.json.animations[e],s=r.name?r.name:"animation_"+e,o=[],a=[],l=[],c=[],d=[];for(let f=0,p=r.channels.length;f<p;f++){const m=r.channels[f],_=r.samplers[m.sampler],E=m.target,y=void 0!==r.parameters?r.parameters[_.input]:_.input,S=void 0!==r.parameters?r.parameters[_.output]:_.output;void 0!==E.node&&(o.push(this.getDependency("node",E.node)),a.push(this.getDependency("accessor",y)),l.push(this.getDependency("accessor",S)),c.push(_),d.push(E))}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l),Promise.all(c),Promise.all(d)]).then(function(f){const p=f[0],m=f[1],_=f[2],E=f[3],v=f[4],y=[];for(let S=0,b=p.length;S<b;S++){const M=p[S],T=m[S],I=_[S],A=E[S],F=v[S];if(void 0===M)continue;M.updateMatrix&&M.updateMatrix();const C=i._createAnimationTracks(M,T,I,A,F);if(C)for(let N=0;N<C.length;N++)y.push(C[N])}return new Zy(s,void 0,y)})}createNodeMesh(e){const i=this,r=this.json.nodes[e];return void 0===r.mesh?null:i.getDependency("mesh",r.mesh).then(function(s){const o=i._getNodeRef(i.meshCache,r.mesh,s);return void 0!==r.weights&&o.traverse(function(a){if(a.isMesh)for(let l=0,c=r.weights.length;l<c;l++)a.morphTargetInfluences[l]=r.weights[l]}),o})}loadNode(e){const i=this,r=this.json.nodes[e],s=i._loadNodeShallow(e),o=[],a=r.children||[];for(let c=0,d=a.length;c<d;c++)o.push(i.getDependency("node",a[c]));const l=void 0===r.skin?Promise.resolve(null):i.getDependency("skin",r.skin);return Promise.all([s,Promise.all(o),l]).then(function(c){const d=c[0],f=c[1],p=c[2];null!==p&&d.traverse(function(m){m.isSkinnedMesh&&m.bind(p,zie)});for(let m=0,_=f.length;m<_;m++)d.add(f[m]);return d})}_loadNodeShallow(e){const i=this.extensions,r=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];const s=this.json.nodes[e],o=s.name?r.createUniqueName(s.name):"",a=[],l=r._invokeOne(function(c){return c.createNodeMesh&&c.createNodeMesh(e)});return l&&a.push(l),void 0!==s.camera&&a.push(r.getDependency("camera",s.camera).then(function(c){return r._getNodeRef(r.cameraCache,s.camera,c)})),r._invokeAll(function(c){return c.createNodeAttachment&&c.createNodeAttachment(e)}).forEach(function(c){a.push(c)}),this.nodeCache[e]=Promise.all(a).then(function(c){let d;if(d=!0===s.isBone?new p1:c.length>1?new vu:1===c.length?c[0]:new lr,d!==c[0])for(let f=0,p=c.length;f<p;f++)d.add(c[f]);if(s.name&&(d.userData.name=s.name,d.name=o),wu(d,s),s.extensions&&ah(i,d,s),void 0!==s.matrix){const f=new At;f.fromArray(s.matrix),d.applyMatrix4(f)}else void 0!==s.translation&&d.position.fromArray(s.translation),void 0!==s.rotation&&d.quaternion.fromArray(s.rotation),void 0!==s.scale&&d.scale.fromArray(s.scale);return r.associations.has(d)||r.associations.set(d,{}),r.associations.get(d).nodes=e,d}),this.nodeCache[e]}loadScene(e){const t=this.extensions,i=this.json.scenes[e],r=this,s=new vu;i.name&&(s.name=r.createUniqueName(i.name)),wu(s,i),i.extensions&&ah(t,s,i);const o=i.nodes||[],a=[];for(let l=0,c=o.length;l<c;l++)a.push(r.getDependency("node",o[l]));return Promise.all(a).then(function(l){for(let d=0,f=l.length;d<f;d++)s.add(l[d]);return r.associations=(d=>{const f=new Map;for(const[p,m]of r.associations)(p instanceof ya||p instanceof pa)&&f.set(p,m);return d.traverse(p=>{const m=r.associations.get(p);null!=m&&f.set(p,m)}),f})(s),s})}_createAnimationTracks(e,t,i,r,s){const o=[],a=e.name?e.name:e.uuid,l=[];let c;switch(Su[s.path]===Su.weights?e.traverse(function(p){p.morphTargetInfluences&&l.push(p.name?p.name:p.uuid)}):l.push(a),Su[s.path]){case Su.weights:c=mm;break;case Su.rotation:c=eh;break;case Su.position:case Su.scale:c=_m;break;default:c=1===i.itemSize?mm:_m}const d=void 0!==r.interpolation?Fie[r.interpolation]:Np,f=this._getArrayFromAccessor(i);for(let p=0,m=l.length;p<m;p++){const _=new c(l[p]+"."+Su[s.path],t.array,f,d);"CUBICSPLINE"===r.interpolation&&this._createCubicSplineTrackInterpolant(_),o.push(_)}return o}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const i=sI(t.constructor),r=new Float32Array(t.length);for(let s=0,o=t.length;s<o;s++)r[s]=t[s]*i;t=r}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(i){return new(this instanceof eh?Oie:$V)(this.times,this.values,this.getValueSize()/3,i)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function XV(n,e,t){const i=e.attributes,r=[];function s(o,a){return t.getDependency("accessor",o).then(function(l){n.setAttribute(a,l)})}for(const o in i){const a=nI[o]||o.toLowerCase();a in n.attributes||r.push(s(i[o],a))}if(void 0!==e.indices&&!n.index){const o=t.getDependency("accessor",e.indices).then(function(a){n.setIndex(a)});r.push(o)}return Cn.workingColorSpace!==Fr&&"COLOR_0"in i&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${Cn.workingColorSpace}" not supported.`),wu(n,e),function Wie(n,e,t){const i=e.attributes,r=new el;if(void 0===i.POSITION)return;{const a=t.json.accessors[i.POSITION],l=a.min,c=a.max;if(void 0===l||void 0===c)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(r.set(new L(l[0],l[1],l[2]),new L(c[0],c[1],c[2])),a.normalized){const d=sI(bm[a.componentType]);r.min.multiplyScalar(d),r.max.multiplyScalar(d)}}const s=e.targets;if(void 0!==s){const a=new L,l=new L;for(let c=0,d=s.length;c<d;c++){const f=s[c];if(void 0!==f.POSITION){const p=t.json.accessors[f.POSITION],m=p.min,_=p.max;if(void 0!==m&&void 0!==_){if(l.setX(Math.max(Math.abs(m[0]),Math.abs(_[0]))),l.setY(Math.max(Math.abs(m[1]),Math.abs(_[1]))),l.setZ(Math.max(Math.abs(m[2]),Math.abs(_[2]))),p.normalized){const E=sI(bm[p.componentType]);l.multiplyScalar(E)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(a)}n.boundingBox=r;const o=new ma;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,n.boundingSphere=o}(n,e,t),Promise.all(r).then(function(){return void 0!==e.targets?function Uie(n,e,t){let i=!1,r=!1,s=!1;for(let c=0,d=e.length;c<d;c++){const f=e[c];if(void 0!==f.POSITION&&(i=!0),void 0!==f.NORMAL&&(r=!0),void 0!==f.COLOR_0&&(s=!0),i&&r&&s)break}if(!i&&!r&&!s)return Promise.resolve(n);const o=[],a=[],l=[];for(let c=0,d=e.length;c<d;c++){const f=e[c];if(i){const p=void 0!==f.POSITION?t.getDependency("accessor",f.POSITION):n.attributes.position;o.push(p)}if(r){const p=void 0!==f.NORMAL?t.getDependency("accessor",f.NORMAL):n.attributes.normal;a.push(p)}if(s){const p=void 0!==f.COLOR_0?t.getDependency("accessor",f.COLOR_0):n.attributes.color;l.push(p)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(c){const f=c[1],p=c[2];return i&&(n.morphAttributes.position=c[0]),r&&(n.morphAttributes.normal=f),s&&(n.morphAttributes.color=p),n.morphTargetsRelative=!0,n})}(n,e.targets,t):n})}const xi={Handedness:Object.freeze({NONE:"none",LEFT:"left",RIGHT:"right"}),ComponentState:Object.freeze({DEFAULT:"default",TOUCHED:"touched",PRESSED:"pressed"}),ComponentProperty:Object.freeze({BUTTON:"button",X_AXIS:"xAxis",Y_AXIS:"yAxis",STATE:"state"}),ComponentType:Object.freeze({TRIGGER:"trigger",SQUEEZE:"squeeze",TOUCHPAD:"touchpad",THUMBSTICK:"thumbstick",BUTTON:"button"}),ButtonTouchThreshold:.05,AxisTouchThreshold:.1,VisualResponseProperty:Object.freeze({TRANSFORM:"transform",VISIBILITY:"visibility"})};function YV(n){return oI.apply(this,arguments)}function oI(){return oI=Fn(function*(n){const e=yield fetch(n);if(e.ok)return e.json();throw new Error(e.statusText)}),oI.apply(this,arguments)}function aI(){return aI=Fn(function*(n){if(!n)throw new Error("No basePath supplied");return yield YV(`${n}/profilesList.json`)}),aI.apply(this,arguments)}function lI(){return lI=Fn(function*(n,e,t=null,i=!0){if(!n)throw new Error("No xrInputSource supplied");if(!e)throw new Error("No basePath supplied");const r=yield function $ie(n){return aI.apply(this,arguments)}(e);let s;if(n.profiles.some(l=>{const c=r[l];return c&&(s={profileId:l,profilePath:`${e}/${c.path}`,deprecated:!!c.deprecated}),!!s}),!s){if(!t)throw new Error("No matching profile name found");const l=r[t];if(!l)throw new Error(`No matching profile name found and default profile "${t}" missing.`);s={profileId:t,profilePath:`${e}/${l.path}`,deprecated:!!l.deprecated}}const o=yield YV(s.profilePath);let a;if(i){let l;if(l="any"===n.handedness?o.layouts[Object.keys(o.layouts)[0]]:o.layouts[n.handedness],!l)throw new Error(`No matching handedness, ${n.handedness}, in profile ${s.profileId}`);l.assetPath&&(a=s.profilePath.replace("profile.json",l.assetPath))}return{profile:o,assetPath:a}}),lI.apply(this,arguments)}const qie={xAxis:0,yAxis:0,button:0,state:xi.ComponentState.DEFAULT};class Yie{constructor(e){this.componentProperty=e.componentProperty,this.states=e.states,this.valueNodeName=e.valueNodeName,this.valueNodeProperty=e.valueNodeProperty,this.valueNodeProperty===xi.VisualResponseProperty.TRANSFORM&&(this.minNodeName=e.minNodeName,this.maxNodeName=e.maxNodeName),this.value=0,this.updateFromComponent(qie)}updateFromComponent({xAxis:e,yAxis:t,button:i,state:r}){const{normalizedXAxis:s,normalizedYAxis:o}=function Xie(n=0,e=0){let t=n,i=e;if(Math.sqrt(n*n+e*e)>1){const o=Math.atan2(e,n);t=Math.cos(o),i=Math.sin(o)}return{normalizedXAxis:.5*t+.5,normalizedYAxis:.5*i+.5}}(e,t);switch(this.componentProperty){case xi.ComponentProperty.X_AXIS:this.value=this.states.includes(r)?s:.5;break;case xi.ComponentProperty.Y_AXIS:this.value=this.states.includes(r)?o:.5;break;case xi.ComponentProperty.BUTTON:this.value=this.states.includes(r)?i:0;break;case xi.ComponentProperty.STATE:this.value=this.valueNodeProperty===xi.VisualResponseProperty.VISIBILITY?this.states.includes(r):this.states.includes(r)?1:0;break;default:throw new Error(`Unexpected visualResponse componentProperty ${this.componentProperty}`)}}}class Kie{constructor(e,t){if(!(e&&t&&t.visualResponses&&t.gamepadIndices&&0!==Object.keys(t.gamepadIndices).length))throw new Error("Invalid arguments supplied");this.id=e,this.type=t.type,this.rootNodeName=t.rootNodeName,this.touchPointNodeName=t.touchPointNodeName,this.visualResponses={},Object.keys(t.visualResponses).forEach(i=>{const r=new Yie(t.visualResponses[i]);this.visualResponses[i]=r}),this.gamepadIndices=Object.assign({},t.gamepadIndices),this.values={state:xi.ComponentState.DEFAULT,button:void 0!==this.gamepadIndices.button?0:void 0,xAxis:void 0!==this.gamepadIndices.xAxis?0:void 0,yAxis:void 0!==this.gamepadIndices.yAxis?0:void 0}}get data(){return{id:this.id,...this.values}}updateFromGamepad(e){if(this.values.state=xi.ComponentState.DEFAULT,void 0!==this.gamepadIndices.button&&e.buttons.length>this.gamepadIndices.button){const t=e.buttons[this.gamepadIndices.button];this.values.button=t.value,this.values.button=this.values.button<0?0:this.values.button,this.values.button=this.values.button>1?1:this.values.button,t.pressed||1===this.values.button?this.values.state=xi.ComponentState.PRESSED:(t.touched||this.values.button>xi.ButtonTouchThreshold)&&(this.values.state=xi.ComponentState.TOUCHED)}void 0!==this.gamepadIndices.xAxis&&e.axes.length>this.gamepadIndices.xAxis&&(this.values.xAxis=e.axes[this.gamepadIndices.xAxis],this.values.xAxis=this.values.xAxis<-1?-1:this.values.xAxis,this.values.xAxis=this.values.xAxis>1?1:this.values.xAxis,this.values.state===xi.ComponentState.DEFAULT&&Math.abs(this.values.xAxis)>xi.AxisTouchThreshold&&(this.values.state=xi.ComponentState.TOUCHED)),void 0!==this.gamepadIndices.yAxis&&e.axes.length>this.gamepadIndices.yAxis&&(this.values.yAxis=e.axes[this.gamepadIndices.yAxis],this.values.yAxis=this.values.yAxis<-1?-1:this.values.yAxis,this.values.yAxis=this.values.yAxis>1?1:this.values.yAxis,this.values.state===xi.ComponentState.DEFAULT&&Math.abs(this.values.yAxis)>xi.AxisTouchThreshold&&(this.values.state=xi.ComponentState.TOUCHED)),Object.values(this.visualResponses).forEach(t=>{t.updateFromComponent(this.values)})}}class Zie{constructor(e,t,i){if(!e)throw new Error("No xrInputSource supplied");if(!t)throw new Error("No profile supplied");this.xrInputSource=e,this.assetUrl=i,this.id=t.profileId,this.layoutDescription=t.layouts[e.handedness],this.components={},Object.keys(this.layoutDescription.components).forEach(r=>{this.components[r]=new Kie(r,this.layoutDescription.components[r])}),this.updateFromGamepad()}get gripSpace(){return this.xrInputSource.gripSpace}get targetRaySpace(){return this.xrInputSource.targetRaySpace}get data(){const e=[];return Object.values(this.components).forEach(t=>{e.push(t.data)}),e}updateFromGamepad(){Object.values(this.components).forEach(e=>{e.updateFromGamepad(this.xrInputSource.gamepad)})}}class ere extends lr{constructor(){super(),this.motionController=null,this.envMap=null}setEnvironmentMap(e){return this.envMap==e||(this.envMap=e,this.traverse(t=>{t.isMesh&&(t.material.envMap=this.envMap,t.material.needsUpdate=!0)})),this}updateMatrixWorld(e){super.updateMatrixWorld(e),this.motionController&&(this.motionController.updateFromGamepad(),Object.values(this.motionController.components).forEach(t=>{Object.values(t.visualResponses).forEach(i=>{const{valueNode:r,minNode:s,maxNode:o,value:a,valueNodeProperty:l}=i;r&&(l===xi.VisualResponseProperty.VISIBILITY?r.visible=a:l===xi.VisualResponseProperty.TRANSFORM&&(r.quaternion.slerpQuaternions(s.quaternion,o.quaternion,a),r.position.lerpVectors(s.position,o.position,a)))})}))}}function KV(n,e){(function tre(n,e){Object.values(n.components).forEach(t=>{const{type:i,touchPointNodeName:r,visualResponses:s}=t;if(i===xi.ComponentType.TOUCHPAD)if(t.touchPointNode=e.getObjectByName(r),t.touchPointNode){const o=new Yy(.001),a=new Vs({color:255}),l=new xr(o,a);t.touchPointNode.add(l)}else console.warn(`Could not find touch dot, ${t.touchPointNodeName}, in touchpad component ${t.id}`);Object.values(s).forEach(o=>{const{valueNodeName:a,minNodeName:l,maxNodeName:c,valueNodeProperty:d}=o;if(d===xi.VisualResponseProperty.TRANSFORM){if(o.minNode=e.getObjectByName(l),o.maxNode=e.getObjectByName(c),!o.minNode)return void console.warn(`Could not find ${l} in the model`);if(!o.maxNode)return void console.warn(`Could not find ${c} in the model`)}o.valueNode=e.getObjectByName(a),o.valueNode||console.warn(`Could not find ${a} in the model`)})})})(n.motionController,e),n.envMap&&e.traverse(t=>{t.isMesh&&(t.material.envMap=n.envMap,t.material.needsUpdate=!0)}),n.add(e)}class nre{constructor(e=null){this.gltfLoader=e,this.path="https://cdn.jsdelivr.net/npm/@webxr-input-profiles/assets@1.0/dist/profiles",this._assetCache={},this.gltfLoader||(this.gltfLoader=new hie)}createControllerModel(e){const t=new ere;let i=null;return e.addEventListener("connected",r=>{const s=r.data;"tracked-pointer"!==s.targetRayMode||!s.gamepad||function jie(n,e){return lI.apply(this,arguments)}(s,this.path,"generic-trigger").then(({profile:o,assetPath:a})=>{t.motionController=new Zie(s,o,a);const l=this._assetCache[t.motionController.assetUrl];if(l)i=l.scene.clone(),KV(t,i);else{if(!this.gltfLoader)throw new Error("GLTFLoader not set.");this.gltfLoader.setPath(""),this.gltfLoader.load(t.motionController.assetUrl,c=>{this._assetCache[t.motionController.assetUrl]=c,i=c.scene.clone(),KV(t,i)},null,()=>{throw new Error(`Asset ${t.motionController.assetUrl} missing or malformed.`)})}}).catch(o=>{console.warn(o)})}),e.addEventListener("disconnected",()=>{t.motionController=null,t.remove(i),i=null}),t}}const ire=[0,2e3,1e4,3e4,null];class ZV{constructor(e){this._retryDelays=void 0!==e?[...e,null]:ire}nextRetryDelayInMilliseconds(e){return this._retryDelays[e.previousRetryCount]}}let nv=(()=>{class n{}return n.Authorization="Authorization",n.Cookie="Cookie",n})();class JV{constructor(e,t,i){this.statusCode=e,this.statusText=t,this.content=i}}class xw{get(e,t){return this.send({...t,method:"GET",url:e})}post(e,t){return this.send({...t,method:"POST",url:e})}delete(e,t){return this.send({...t,method:"DELETE",url:e})}getCookieString(e){return""}}class rre extends xw{constructor(e,t){super(),this._innerClient=e,this._accessTokenFactory=t}send(e){var t=this;return Fn(function*(){let i=!0;t._accessTokenFactory&&(!t._accessToken||e.url&&e.url.indexOf("/negotiate?")>0)&&(i=!1,t._accessToken=yield t._accessTokenFactory()),t._setAuthorizationHeader(e);const r=yield t._innerClient.send(e);return i&&401===r.statusCode&&t._accessTokenFactory?(t._accessToken=yield t._accessTokenFactory(),t._setAuthorizationHeader(e),yield t._innerClient.send(e)):r})()}_setAuthorizationHeader(e){e.headers||(e.headers={}),this._accessToken?e.headers[nv.Authorization]=`Bearer ${this._accessToken}`:this._accessTokenFactory&&e.headers[nv.Authorization]&&delete e.headers[nv.Authorization]}getCookieString(e){return this._innerClient.getCookieString(e)}}class Sm extends Error{constructor(e,t){const i=new.target.prototype;super(`${e}: Status code '${t}'`),this.statusCode=t,this.__proto__=i}}class cI extends Error{constructor(e="A timeout occurred."){const t=new.target.prototype;super(e),this.__proto__=t}}class va extends Error{constructor(e="An abort occurred."){const t=new.target.prototype;super(e),this.__proto__=t}}class sre extends Error{constructor(e,t){const i=new.target.prototype;super(e),this.transport=t,this.errorType="UnsupportedTransportError",this.__proto__=i}}class ore extends Error{constructor(e,t){const i=new.target.prototype;super(e),this.transport=t,this.errorType="DisabledTransportError",this.__proto__=i}}class are extends Error{constructor(e,t){const i=new.target.prototype;super(e),this.transport=t,this.errorType="FailedToStartTransportError",this.__proto__=i}}class lre extends Error{constructor(e){const t=new.target.prototype;super(e),this.errorType="FailedToNegotiateWithServerError",this.__proto__=t}}class cre extends Error{constructor(e,t){const i=new.target.prototype;super(e),this.innerErrors=t,this.__proto__=i}}var ge=function(n){return n[n.Trace=0]="Trace",n[n.Debug=1]="Debug",n[n.Information=2]="Information",n[n.Warning=3]="Warning",n[n.Error=4]="Error",n[n.Critical=5]="Critical",n[n.None=6]="None",n}(ge||{});class iv{constructor(){}log(e,t){}}iv.instance=new iv;const ure="7.0.12";class Cr{static isRequired(e,t){if(null==e)throw new Error(`The '${t}' argument is required.`)}static isNotEmpty(e,t){if(!e||e.match(/^\s*$/))throw new Error(`The '${t}' argument should not be empty.`)}static isIn(e,t,i){if(!(e in t))throw new Error(`Unknown ${i} value: ${e}.`)}}class Ar{static get isBrowser(){return"object"==typeof window&&"object"==typeof window.document}static get isWebWorker(){return"object"==typeof self&&"importScripts"in self}static get isReactNative(){return"object"==typeof window&&typeof window.document>"u"}static get isNode(){return!this.isBrowser&&!this.isWebWorker&&!this.isReactNative}}function rv(n,e){let t="";return sv(n)?(t=`Binary data of length ${n.byteLength}`,e&&(t+=`. Content: '${function dre(n){const e=new Uint8Array(n);let t="";return e.forEach(i=>{t+=`0x${i<16?"0":""}${i.toString(16)} `}),t.substr(0,t.length-1)}(n)}'`)):"string"==typeof n&&(t=`String data of length ${n.length}`,e&&(t+=`. Content: '${n}'`)),t}function sv(n){return n&&typeof ArrayBuffer<"u"&&(n instanceof ArrayBuffer||n.constructor&&"ArrayBuffer"===n.constructor.name)}function QV(n,e,t,i,r,s){return uI.apply(this,arguments)}function uI(){return uI=Fn(function*(n,e,t,i,r,s){const o={},[a,l]=wm();o[a]=l,n.log(ge.Trace,`(${e} transport) sending data. ${rv(r,s.logMessageContent)}.`);const c=sv(r)?"arraybuffer":"text",d=yield t.post(i,{content:r,headers:{...o,...s.headers},responseType:c,timeout:s.timeout,withCredentials:s.withCredentials});n.log(ge.Trace,`(${e} transport) request complete. Response status: ${d.statusCode}.`)}),uI.apply(this,arguments)}class fre{constructor(e,t){this._subject=e,this._observer=t}dispose(){const e=this._subject.observers.indexOf(this._observer);e>-1&&this._subject.observers.splice(e,1),0===this._subject.observers.length&&this._subject.cancelCallback&&this._subject.cancelCallback().catch(t=>{})}}class Tw{constructor(e){this._minLevel=e,this.out=console}log(e,t){if(e>=this._minLevel){const i=`[${(new Date).toISOString()}] ${ge[e]}: ${t}`;switch(e){case ge.Critical:case ge.Error:this.out.error(i);break;case ge.Warning:this.out.warn(i);break;case ge.Information:this.out.info(i);break;default:this.out.log(i)}}}}function wm(){let n="X-SignalR-User-Agent";return Ar.isNode&&(n="User-Agent"),[n,pre(ure,mre(),Ar.isNode?"NodeJS":"Browser",gre())]}function pre(n,e,t,i){let r="Microsoft SignalR/";const s=n.split(".");return r+=`${s[0]}.${s[1]}`,r+=` (${n}; `,r+=e&&""!==e?`${e}; `:"Unknown OS; ",r+=`${t}`,r+=i?`; ${i}`:"; Unknown Runtime Version",r+=")",r}function mre(){if(!Ar.isNode)return"";switch(process.platform){case"win32":return"Windows NT";case"darwin":return"macOS";case"linux":return"Linux";default:return process.platform}}function gre(){if(Ar.isNode)return process.versions.node}function eH(n){return n.stack?n.stack:n.message?n.message:`${n}`}class vre extends xw{constructor(e){if(super(),this._logger=e,typeof fetch>"u"){const t=require;this._jar=new(t("tough-cookie").CookieJar),this._fetchType=t("node-fetch"),this._fetchType=t("fetch-cookie")(this._fetchType,this._jar)}else this._fetchType=fetch.bind(function yre(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("could not find global")}());if(typeof AbortController>"u"){const t=require;this._abortControllerType=t("abort-controller")}else this._abortControllerType=AbortController}send(e){var t=this;return Fn(function*(){if(e.abortSignal&&e.abortSignal.aborted)throw new va;if(!e.method)throw new Error("No method defined.");if(!e.url)throw new Error("No url defined.");const i=new t._abortControllerType;let r;e.abortSignal&&(e.abortSignal.onabort=()=>{i.abort(),r=new va});let o,s=null;e.timeout&&(s=setTimeout(()=>{i.abort(),t._logger.log(ge.Warning,"Timeout from HTTP request."),r=new cI},e.timeout)),""===e.content&&(e.content=void 0),e.content&&(e.headers=e.headers||{},e.headers["Content-Type"]=sv(e.content)?"application/octet-stream":"text/plain;charset=UTF-8");try{o=yield t._fetchType(e.url,{body:e.content,cache:"no-cache",credentials:!0===e.withCredentials?"include":"same-origin",headers:{"X-Requested-With":"XMLHttpRequest",...e.headers},method:e.method,mode:"cors",redirect:"follow",signal:i.signal})}catch(c){throw r||(t._logger.log(ge.Warning,`Error from HTTP request. ${c}.`),c)}finally{s&&clearTimeout(s),e.abortSignal&&(e.abortSignal.onabort=null)}if(!o.ok){const c=yield tH(o,"text");throw new Sm(c||o.statusText,o.status)}const l=yield tH(o,e.responseType);return new JV(o.status,o.statusText,l)})()}getCookieString(e){let t="";return Ar.isNode&&this._jar&&this._jar.getCookies(e,(i,r)=>t=r.join("; ")),t}}function tH(n,e){let t;switch(e){case"arraybuffer":t=n.arrayBuffer();break;case"text":default:t=n.text();break;case"blob":case"document":case"json":throw new Error(`${e} is not supported.`)}return t}class Ere extends xw{constructor(e){super(),this._logger=e}send(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new va):e.method?e.url?new Promise((t,i)=>{const r=new XMLHttpRequest;r.open(e.method,e.url,!0),r.withCredentials=void 0===e.withCredentials||e.withCredentials,r.setRequestHeader("X-Requested-With","XMLHttpRequest"),""===e.content&&(e.content=void 0),e.content&&(sv(e.content)?r.setRequestHeader("Content-Type","application/octet-stream"):r.setRequestHeader("Content-Type","text/plain;charset=UTF-8"));const s=e.headers;s&&Object.keys(s).forEach(o=>{r.setRequestHeader(o,s[o])}),e.responseType&&(r.responseType=e.responseType),e.abortSignal&&(e.abortSignal.onabort=()=>{r.abort(),i(new va)}),e.timeout&&(r.timeout=e.timeout),r.onload=()=>{e.abortSignal&&(e.abortSignal.onabort=null),r.status>=200&&r.status<300?t(new JV(r.status,r.statusText,r.response||r.responseText)):i(new Sm(r.response||r.responseText||r.statusText,r.status))},r.onerror=()=>{this._logger.log(ge.Warning,`Error from HTTP request. ${r.status}: ${r.statusText}.`),i(new Sm(r.statusText,r.status))},r.ontimeout=()=>{this._logger.log(ge.Warning,"Timeout from HTTP request."),i(new cI)},r.send(e.content)}):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}}class bre extends xw{constructor(e){if(super(),typeof fetch<"u"||Ar.isNode)this._httpClient=new vre(e);else{if(!(typeof XMLHttpRequest<"u"))throw new Error("No usable HttpClient found.");this._httpClient=new Ere(e)}}send(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new va):e.method?e.url?this._httpClient.send(e):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}getCookieString(e){return this._httpClient.getCookieString(e)}}var Ur=function(n){return n[n.None=0]="None",n[n.WebSockets=1]="WebSockets",n[n.ServerSentEvents=2]="ServerSentEvents",n[n.LongPolling=4]="LongPolling",n}(Ur||{}),Es=function(n){return n[n.Text=1]="Text",n[n.Binary=2]="Binary",n}(Es||{});class Sre{constructor(){this._isAborted=!1,this.onabort=null}abort(){this._isAborted||(this._isAborted=!0,this.onabort&&this.onabort())}get signal(){return this}get aborted(){return this._isAborted}}class nH{constructor(e,t,i){this._httpClient=e,this._logger=t,this._pollAbort=new Sre,this._options=i,this._running=!1,this.onreceive=null,this.onclose=null}get pollAborted(){return this._pollAbort.aborted}connect(e,t){var i=this;return Fn(function*(){if(Cr.isRequired(e,"url"),Cr.isRequired(t,"transferFormat"),Cr.isIn(t,Es,"transferFormat"),i._url=e,i._logger.log(ge.Trace,"(LongPolling transport) Connecting."),t===Es.Binary&&typeof XMLHttpRequest<"u"&&"string"!=typeof(new XMLHttpRequest).responseType)throw new Error("Binary protocols over XmlHttpRequest not implementing advanced features are not supported.");const[r,s]=wm(),o={[r]:s,...i._options.headers},a={abortSignal:i._pollAbort.signal,headers:o,timeout:1e5,withCredentials:i._options.withCredentials};t===Es.Binary&&(a.responseType="arraybuffer");const l=`${e}&_=${Date.now()}`;i._logger.log(ge.Trace,`(LongPolling transport) polling: ${l}.`);const c=yield i._httpClient.get(l,a);200!==c.statusCode?(i._logger.log(ge.Error,`(LongPolling transport) Unexpected response code: ${c.statusCode}.`),i._closeError=new Sm(c.statusText||"",c.statusCode),i._running=!1):i._running=!0,i._receiving=i._poll(i._url,a)})()}_poll(e,t){var i=this;return Fn(function*(){try{for(;i._running;)try{const r=`${e}&_=${Date.now()}`;i._logger.log(ge.Trace,`(LongPolling transport) polling: ${r}.`);const s=yield i._httpClient.get(r,t);204===s.statusCode?(i._logger.log(ge.Information,"(LongPolling transport) Poll terminated by server."),i._running=!1):200!==s.statusCode?(i._logger.log(ge.Error,`(LongPolling transport) Unexpected response code: ${s.statusCode}.`),i._closeError=new Sm(s.statusText||"",s.statusCode),i._running=!1):s.content?(i._logger.log(ge.Trace,`(LongPolling transport) data received. ${rv(s.content,i._options.logMessageContent)}.`),i.onreceive&&i.onreceive(s.content)):i._logger.log(ge.Trace,"(LongPolling transport) Poll timed out, reissuing.")}catch(r){i._running?r instanceof cI?i._logger.log(ge.Trace,"(LongPolling transport) Poll timed out, reissuing."):(i._closeError=r,i._running=!1):i._logger.log(ge.Trace,`(LongPolling transport) Poll errored after shutdown: ${r.message}`)}}finally{i._logger.log(ge.Trace,"(LongPolling transport) Polling complete."),i.pollAborted||i._raiseOnClose()}})()}send(e){var t=this;return Fn(function*(){return t._running?QV(t._logger,"LongPolling",t._httpClient,t._url,e,t._options):Promise.reject(new Error("Cannot send until the transport is connected"))})()}stop(){var e=this;return Fn(function*(){e._logger.log(ge.Trace,"(LongPolling transport) Stopping polling."),e._running=!1,e._pollAbort.abort();try{yield e._receiving,e._logger.log(ge.Trace,`(LongPolling transport) sending DELETE request to ${e._url}.`);const t={},[i,r]=wm();t[i]=r;const s={headers:{...t,...e._options.headers},timeout:e._options.timeout,withCredentials:e._options.withCredentials};yield e._httpClient.delete(e._url,s),e._logger.log(ge.Trace,"(LongPolling transport) DELETE request sent.")}finally{e._logger.log(ge.Trace,"(LongPolling transport) Stop finished."),e._raiseOnClose()}})()}_raiseOnClose(){if(this.onclose){let e="(LongPolling transport) Firing onclose event.";this._closeError&&(e+=" Error: "+this._closeError),this._logger.log(ge.Trace,e),this.onclose(this._closeError)}}}class wre{constructor(e,t,i,r){this._httpClient=e,this._accessToken=t,this._logger=i,this._options=r,this.onreceive=null,this.onclose=null}connect(e,t){var i=this;return Fn(function*(){return Cr.isRequired(e,"url"),Cr.isRequired(t,"transferFormat"),Cr.isIn(t,Es,"transferFormat"),i._logger.log(ge.Trace,"(SSE transport) Connecting."),i._url=e,i._accessToken&&(e+=(e.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(i._accessToken)}`),new Promise((r,s)=>{let a,o=!1;if(t===Es.Text){if(Ar.isBrowser||Ar.isWebWorker)a=new i._options.EventSource(e,{withCredentials:i._options.withCredentials});else{const l=i._httpClient.getCookieString(e),c={};c.Cookie=l;const[d,f]=wm();c[d]=f,a=new i._options.EventSource(e,{withCredentials:i._options.withCredentials,headers:{...c,...i._options.headers}})}try{a.onmessage=l=>{if(i.onreceive)try{i._logger.log(ge.Trace,`(SSE transport) data received. ${rv(l.data,i._options.logMessageContent)}.`),i.onreceive(l.data)}catch(c){return void i._close(c)}},a.onerror=l=>{o?i._close():s(new Error("EventSource failed to connect. The connection could not be found on the server, either the connection ID is not present on the server, or a proxy is refusing/buffering the connection. If you have multiple servers check that sticky sessions are enabled."))},a.onopen=()=>{i._logger.log(ge.Information,`SSE connected to ${i._url}`),i._eventSource=a,o=!0,r()}}catch(l){return void s(l)}}else s(new Error("The Server-Sent Events transport only supports the 'Text' transfer format"))})})()}send(e){var t=this;return Fn(function*(){return t._eventSource?QV(t._logger,"SSE",t._httpClient,t._url,e,t._options):Promise.reject(new Error("Cannot send until the transport is connected"))})()}stop(){return this._close(),Promise.resolve()}_close(e){this._eventSource&&(this._eventSource.close(),this._eventSource=void 0,this.onclose&&this.onclose(e))}}class Mre{constructor(e,t,i,r,s,o){this._logger=i,this._accessTokenFactory=t,this._logMessageContent=r,this._webSocketConstructor=s,this._httpClient=e,this.onreceive=null,this.onclose=null,this._headers=o}connect(e,t){var i=this;return Fn(function*(){let r;return Cr.isRequired(e,"url"),Cr.isRequired(t,"transferFormat"),Cr.isIn(t,Es,"transferFormat"),i._logger.log(ge.Trace,"(WebSockets transport) Connecting."),i._accessTokenFactory&&(r=yield i._accessTokenFactory()),new Promise((s,o)=>{let a;e=e.replace(/^http/,"ws");const l=i._httpClient.getCookieString(e);let c=!1;if(Ar.isNode||Ar.isReactNative){const d={},[f,p]=wm();d[f]=p,r&&(d[nv.Authorization]=`Bearer ${r}`),l&&(d[nv.Cookie]=l),a=new i._webSocketConstructor(e,void 0,{headers:{...d,...i._headers}})}else r&&(e+=(e.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(r)}`);a||(a=new i._webSocketConstructor(e)),t===Es.Binary&&(a.binaryType="arraybuffer"),a.onopen=d=>{i._logger.log(ge.Information,`WebSocket connected to ${e}.`),i._webSocket=a,c=!0,s()},a.onerror=d=>{let f=null;f=typeof ErrorEvent<"u"&&d instanceof ErrorEvent?d.error:"There was an error with the transport",i._logger.log(ge.Information,`(WebSockets transport) ${f}.`)},a.onmessage=d=>{if(i._logger.log(ge.Trace,`(WebSockets transport) data received. ${rv(d.data,i._logMessageContent)}.`),i.onreceive)try{i.onreceive(d.data)}catch(f){return void i._close(f)}},a.onclose=d=>{if(c)i._close(d);else{let f=null;f=typeof ErrorEvent<"u"&&d instanceof ErrorEvent?d.error:"WebSocket failed to connect. The connection could not be found on the server, either the endpoint may not be a SignalR endpoint, the connection ID is not present on the server, or there is a proxy blocking WebSockets. If you have multiple servers check that sticky sessions are enabled.",o(new Error(f))}}})})()}send(e){return this._webSocket&&this._webSocket.readyState===this._webSocketConstructor.OPEN?(this._logger.log(ge.Trace,`(WebSockets transport) sending data. ${rv(e,this._logMessageContent)}.`),this._webSocket.send(e),Promise.resolve()):Promise.reject("WebSocket is not in the OPEN state")}stop(){return this._webSocket&&this._close(void 0),Promise.resolve()}_close(e){this._webSocket&&(this._webSocket.onclose=()=>{},this._webSocket.onmessage=()=>{},this._webSocket.onerror=()=>{},this._webSocket.close(),this._webSocket=void 0),this._logger.log(ge.Trace,"(WebSockets transport) socket closed."),this.onclose&&(!this._isCloseEvent(e)||!1!==e.wasClean&&1e3===e.code?e instanceof Error?this.onclose(e):this.onclose():this.onclose(new Error(`WebSocket closed with status code: ${e.code} (${e.reason||"no reason given"}).`)))}_isCloseEvent(e){return e&&"boolean"==typeof e.wasClean&&"number"==typeof e.code}}class xre{constructor(e,t={}){if(this._stopPromiseResolver=()=>{},this.features={},this._negotiateVersion=1,Cr.isRequired(e,"url"),this._logger=function hre(n){return void 0===n?new Tw(ge.Information):null===n?iv.instance:void 0!==n.log?n:new Tw(n)}(t.logger),this.baseUrl=this._resolveUrl(e),(t=t||{}).logMessageContent=void 0!==t.logMessageContent&&t.logMessageContent,"boolean"!=typeof t.withCredentials&&void 0!==t.withCredentials)throw new Error("withCredentials option was not a 'boolean' or 'undefined' value");t.withCredentials=void 0===t.withCredentials||t.withCredentials,t.timeout=void 0===t.timeout?1e5:t.timeout;let i=null,r=null;if(Ar.isNode){const s=require;i=s("ws"),r=s("eventsource")}!Ar.isNode&&typeof WebSocket<"u"&&!t.WebSocket?t.WebSocket=WebSocket:Ar.isNode&&!t.WebSocket&&i&&(t.WebSocket=i),!Ar.isNode&&typeof EventSource<"u"&&!t.EventSource?t.EventSource=EventSource:Ar.isNode&&!t.EventSource&&typeof r<"u"&&(t.EventSource=r),this._httpClient=new rre(t.httpClient||new bre(this._logger),t.accessTokenFactory),this._connectionState="Disconnected",this._connectionStarted=!1,this._options=t,this.onreceive=null,this.onclose=null}start(e){var t=this;return Fn(function*(){if(Cr.isIn(e=e||Es.Binary,Es,"transferFormat"),t._logger.log(ge.Debug,`Starting connection with transfer format '${Es[e]}'.`),"Disconnected"!==t._connectionState)return Promise.reject(new Error("Cannot start an HttpConnection that is not in the 'Disconnected' state."));if(t._connectionState="Connecting",t._startInternalPromise=t._startInternal(e),yield t._startInternalPromise,"Disconnecting"===t._connectionState){const i="Failed to start the HttpConnection before stop() was called.";return t._logger.log(ge.Error,i),yield t._stopPromise,Promise.reject(new va(i))}if("Connected"!==t._connectionState){const i="HttpConnection.startInternal completed gracefully but didn't enter the connection into the connected state!";return t._logger.log(ge.Error,i),Promise.reject(new va(i))}t._connectionStarted=!0})()}send(e){return"Connected"!==this._connectionState?Promise.reject(new Error("Cannot send data if the connection is not in the 'Connected' State.")):(this._sendQueue||(this._sendQueue=new dI(this.transport)),this._sendQueue.send(e))}stop(e){var t=this;return Fn(function*(){return"Disconnected"===t._connectionState?(t._logger.log(ge.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnected state.`),Promise.resolve()):"Disconnecting"===t._connectionState?(t._logger.log(ge.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnecting state.`),t._stopPromise):(t._connectionState="Disconnecting",t._stopPromise=new Promise(i=>{t._stopPromiseResolver=i}),yield t._stopInternal(e),void(yield t._stopPromise))})()}_stopInternal(e){var t=this;return Fn(function*(){t._stopError=e;try{yield t._startInternalPromise}catch{}if(t.transport){try{yield t.transport.stop()}catch(i){t._logger.log(ge.Error,`HttpConnection.transport.stop() threw error '${i}'.`),t._stopConnection()}t.transport=void 0}else t._logger.log(ge.Debug,"HttpConnection.transport is undefined in HttpConnection.stop() because start() failed.")})()}_startInternal(e){var t=this;return Fn(function*(){let i=t.baseUrl;t._accessTokenFactory=t._options.accessTokenFactory,t._httpClient._accessTokenFactory=t._accessTokenFactory;try{if(t._options.skipNegotiation){if(t._options.transport!==Ur.WebSockets)throw new Error("Negotiation can only be skipped when using the WebSocket transport directly.");t.transport=t._constructTransport(Ur.WebSockets),yield t._startTransport(i,e)}else{let r=null,s=0;do{if(r=yield t._getNegotiationResponse(i),"Disconnecting"===t._connectionState||"Disconnected"===t._connectionState)throw new va("The connection was stopped during negotiation.");if(r.error)throw new Error(r.error);if(r.ProtocolVersion)throw new Error("Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.");if(r.url&&(i=r.url),r.accessToken){const o=r.accessToken;t._accessTokenFactory=()=>o,t._httpClient._accessToken=o,t._httpClient._accessTokenFactory=void 0}s++}while(r.url&&s<100);if(100===s&&r.url)throw new Error("Negotiate redirection limit exceeded.");yield t._createTransport(i,t._options.transport,r,e)}t.transport instanceof nH&&(t.features.inherentKeepAlive=!0),"Connecting"===t._connectionState&&(t._logger.log(ge.Debug,"The HttpConnection connected successfully."),t._connectionState="Connected")}catch(r){return t._logger.log(ge.Error,"Failed to start the connection: "+r),t._connectionState="Disconnected",t.transport=void 0,t._stopPromiseResolver(),Promise.reject(r)}})()}_getNegotiationResponse(e){var t=this;return Fn(function*(){const i={},[r,s]=wm();i[r]=s;const o=t._resolveNegotiateUrl(e);t._logger.log(ge.Debug,`Sending negotiation request: ${o}.`);try{const a=yield t._httpClient.post(o,{content:"",headers:{...i,...t._options.headers},timeout:t._options.timeout,withCredentials:t._options.withCredentials});if(200!==a.statusCode)return Promise.reject(new Error(`Unexpected status code returned from negotiate '${a.statusCode}'`));const l=JSON.parse(a.content);return(!l.negotiateVersion||l.negotiateVersion<1)&&(l.connectionToken=l.connectionId),l}catch(a){let l="Failed to complete negotiation with the server: "+a;return a instanceof Sm&&404===a.statusCode&&(l+=" Either this is not a SignalR endpoint or there is a proxy blocking the connection."),t._logger.log(ge.Error,l),Promise.reject(new lre(l))}})()}_createConnectUrl(e,t){return t?e+(-1===e.indexOf("?")?"?":"&")+`id=${t}`:e}_createTransport(e,t,i,r){var s=this;return Fn(function*(){let o=s._createConnectUrl(e,i.connectionToken);if(s._isITransport(t))return s._logger.log(ge.Debug,"Connection was provided an instance of ITransport, using that directly."),s.transport=t,yield s._startTransport(o,r),void(s.connectionId=i.connectionId);const a=[],l=i.availableTransports||[];let c=i;for(const d of l){const f=s._resolveTransportOrError(d,t,r);if(f instanceof Error)a.push(`${d.transport} failed:`),a.push(f);else if(s._isITransport(f)){if(s.transport=f,!c){try{c=yield s._getNegotiationResponse(e)}catch(p){return Promise.reject(p)}o=s._createConnectUrl(e,c.connectionToken)}try{return yield s._startTransport(o,r),void(s.connectionId=c.connectionId)}catch(p){if(s._logger.log(ge.Error,`Failed to start the transport '${d.transport}': ${p}`),c=void 0,a.push(new are(`${d.transport} failed: ${p}`,Ur[d.transport])),"Connecting"!==s._connectionState){const m="Failed to select transport before stop() was called.";return s._logger.log(ge.Debug,m),Promise.reject(new va(m))}}}}return Promise.reject(a.length>0?new cre(`Unable to connect to the server with any of the available transports. ${a.join(" ")}`,a):new Error("None of the transports supported by the client are supported by the server."))})()}_constructTransport(e){switch(e){case Ur.WebSockets:if(!this._options.WebSocket)throw new Error("'WebSocket' is not supported in your environment.");return new Mre(this._httpClient,this._accessTokenFactory,this._logger,this._options.logMessageContent,this._options.WebSocket,this._options.headers||{});case Ur.ServerSentEvents:if(!this._options.EventSource)throw new Error("'EventSource' is not supported in your environment.");return new wre(this._httpClient,this._httpClient._accessToken,this._logger,this._options);case Ur.LongPolling:return new nH(this._httpClient,this._logger,this._options);default:throw new Error(`Unknown transport: ${e}.`)}}_startTransport(e,t){return this.transport.onreceive=this.onreceive,this.transport.onclose=i=>this._stopConnection(i),this.transport.connect(e,t)}_resolveTransportOrError(e,t,i){const r=Ur[e.transport];if(null==r)return this._logger.log(ge.Debug,`Skipping transport '${e.transport}' because it is not supported by this client.`),new Error(`Skipping transport '${e.transport}' because it is not supported by this client.`);if(!function Tre(n,e){return!n||0!=(e&n)}(t,r))return this._logger.log(ge.Debug,`Skipping transport '${Ur[r]}' because it was disabled by the client.`),new ore(`'${Ur[r]}' is disabled by the client.`,r);if(!(e.transferFormats.map(o=>Es[o]).indexOf(i)>=0))return this._logger.log(ge.Debug,`Skipping transport '${Ur[r]}' because it does not support the requested transfer format '${Es[i]}'.`),new Error(`'${Ur[r]}' does not support ${Es[i]}.`);if(r===Ur.WebSockets&&!this._options.WebSocket||r===Ur.ServerSentEvents&&!this._options.EventSource)return this._logger.log(ge.Debug,`Skipping transport '${Ur[r]}' because it is not supported in your environment.'`),new sre(`'${Ur[r]}' is not supported in your environment.`,r);this._logger.log(ge.Debug,`Selecting transport '${Ur[r]}'.`);try{return this._constructTransport(r)}catch(o){return o}}_isITransport(e){return e&&"object"==typeof e&&"connect"in e}_stopConnection(e){if(this._logger.log(ge.Debug,`HttpConnection.stopConnection(${e}) called while in state ${this._connectionState}.`),this.transport=void 0,e=this._stopError||e,this._stopError=void 0,"Disconnected"!==this._connectionState){if("Connecting"===this._connectionState)throw this._logger.log(ge.Warning,`Call to HttpConnection.stopConnection(${e}) was ignored because the connection is still in the connecting state.`),new Error(`HttpConnection.stopConnection(${e}) was called while the connection is still in the connecting state.`);if("Disconnecting"===this._connectionState&&this._stopPromiseResolver(),e?this._logger.log(ge.Error,`Connection disconnected with error '${e}'.`):this._logger.log(ge.Information,"Connection disconnected."),this._sendQueue&&(this._sendQueue.stop().catch(t=>{this._logger.log(ge.Error,`TransportSendQueue.stop() threw error '${t}'.`)}),this._sendQueue=void 0),this.connectionId=void 0,this._connectionState="Disconnected",this._connectionStarted){this._connectionStarted=!1;try{this.onclose&&this.onclose(e)}catch(t){this._logger.log(ge.Error,`HttpConnection.onclose(${e}) threw error '${t}'.`)}}}else this._logger.log(ge.Debug,`Call to HttpConnection.stopConnection(${e}) was ignored because the connection is already in the disconnected state.`)}_resolveUrl(e){if(0===e.lastIndexOf("https://",0)||0===e.lastIndexOf("http://",0))return e;if(!Ar.isBrowser)throw new Error(`Cannot resolve '${e}'.`);const t=window.document.createElement("a");return t.href=e,this._logger.log(ge.Information,`Normalizing '${e}' to '${t.href}'.`),t.href}_resolveNegotiateUrl(e){const t=e.indexOf("?");let i=e.substring(0,-1===t?e.length:t);return"/"!==i[i.length-1]&&(i+="/"),i+="negotiate",i+=-1===t?"":e.substring(t),-1===i.indexOf("negotiateVersion")&&(i+=-1===t?"?":"&",i+="negotiateVersion="+this._negotiateVersion),i}}class dI{constructor(e){this._transport=e,this._buffer=[],this._executing=!0,this._sendBufferedData=new Cw,this._transportResult=new Cw,this._sendLoopPromise=this._sendLoop()}send(e){return this._bufferData(e),this._transportResult||(this._transportResult=new Cw),this._transportResult.promise}stop(){return this._executing=!1,this._sendBufferedData.resolve(),this._sendLoopPromise}_bufferData(e){if(this._buffer.length&&typeof this._buffer[0]!=typeof e)throw new Error(`Expected data to be of type ${typeof this._buffer} but was of type ${typeof e}`);this._buffer.push(e),this._sendBufferedData.resolve()}_sendLoop(){var e=this;return Fn(function*(){for(;;){if(yield e._sendBufferedData.promise,!e._executing){e._transportResult&&e._transportResult.reject("Connection stopped.");break}e._sendBufferedData=new Cw;const t=e._transportResult;e._transportResult=void 0;const i="string"==typeof e._buffer[0]?e._buffer.join(""):dI._concatBuffers(e._buffer);e._buffer.length=0;try{yield e._transport.send(i),t.resolve()}catch(r){t.reject(r)}}})()}static _concatBuffers(e){const t=e.map(s=>s.byteLength).reduce((s,o)=>s+o),i=new Uint8Array(t);let r=0;for(const s of e)i.set(new Uint8Array(s),r),r+=s.byteLength;return i.buffer}}class Cw{constructor(){this.promise=new Promise((e,t)=>[this._resolver,this._rejecter]=[e,t])}resolve(){this._resolver()}reject(e){this._rejecter(e)}}class mo{static write(e){return`${e}${mo.RecordSeparator}`}static parse(e){if(e[e.length-1]!==mo.RecordSeparator)throw new Error("Message is incomplete.");const t=e.split(mo.RecordSeparator);return t.pop(),t}}mo.RecordSeparatorCode=30,mo.RecordSeparator=String.fromCharCode(mo.RecordSeparatorCode);class Cre{writeHandshakeRequest(e){return mo.write(JSON.stringify(e))}parseHandshakeResponse(e){let t,i;if(sv(e)){const a=new Uint8Array(e),l=a.indexOf(mo.RecordSeparatorCode);if(-1===l)throw new Error("Message is incomplete.");const c=l+1;t=String.fromCharCode.apply(null,Array.prototype.slice.call(a.slice(0,c))),i=a.byteLength>c?a.slice(c).buffer:null}else{const a=e,l=a.indexOf(mo.RecordSeparator);if(-1===l)throw new Error("Message is incomplete.");const c=l+1;t=a.substring(0,c),i=a.length>c?a.substring(c):null}const r=mo.parse(t),s=JSON.parse(r[0]);if(s.type)throw new Error("Expected a handshake response from the server.");return[i,s]}}var si=function(n){return n[n.Invocation=1]="Invocation",n[n.StreamItem=2]="StreamItem",n[n.Completion=3]="Completion",n[n.StreamInvocation=4]="StreamInvocation",n[n.CancelInvocation=5]="CancelInvocation",n[n.Ping=6]="Ping",n[n.Close=7]="Close",n}(si||{});class Are{constructor(){this.observers=[]}next(e){for(const t of this.observers)t.next(e)}error(e){for(const t of this.observers)t.error&&t.error(e)}complete(){for(const e of this.observers)e.complete&&e.complete()}subscribe(e){return this.observers.push(e),new fre(this,e)}}var Ti=function(n){return n.Disconnected="Disconnected",n.Connecting="Connecting",n.Connected="Connected",n.Disconnecting="Disconnecting",n.Reconnecting="Reconnecting",n}(Ti||{});class hI{constructor(e,t,i,r){this._nextKeepAlive=0,this._freezeEventListener=()=>{this._logger.log(ge.Warning,"The page is being frozen, this will likely lead to the connection being closed and messages being lost. For more information see the docs at https://docs.microsoft.com/aspnet/core/signalr/javascript-client#bsleep")},Cr.isRequired(e,"connection"),Cr.isRequired(t,"logger"),Cr.isRequired(i,"protocol"),this.serverTimeoutInMilliseconds=3e4,this.keepAliveIntervalInMilliseconds=15e3,this._logger=t,this._protocol=i,this.connection=e,this._reconnectPolicy=r,this._handshakeProtocol=new Cre,this.connection.onreceive=s=>this._processIncomingData(s),this.connection.onclose=s=>this._connectionClosed(s),this._callbacks={},this._methods={},this._closedCallbacks=[],this._reconnectingCallbacks=[],this._reconnectedCallbacks=[],this._invocationId=0,this._receivedHandshakeResponse=!1,this._connectionState=Ti.Disconnected,this._connectionStarted=!1,this._cachedPingMessage=this._protocol.writeMessage({type:si.Ping})}static create(e,t,i,r){return new hI(e,t,i,r)}get state(){return this._connectionState}get connectionId(){return this.connection&&this.connection.connectionId||null}get baseUrl(){return this.connection.baseUrl||""}set baseUrl(e){if(this._connectionState!==Ti.Disconnected&&this._connectionState!==Ti.Reconnecting)throw new Error("The HubConnection must be in the Disconnected or Reconnecting state to change the url.");if(!e)throw new Error("The HubConnection url must be a valid url.");this.connection.baseUrl=e}start(){return this._startPromise=this._startWithStateTransitions(),this._startPromise}_startWithStateTransitions(){var e=this;return Fn(function*(){if(e._connectionState!==Ti.Disconnected)return Promise.reject(new Error("Cannot start a HubConnection that is not in the 'Disconnected' state."));e._connectionState=Ti.Connecting,e._logger.log(ge.Debug,"Starting HubConnection.");try{yield e._startInternal(),Ar.isBrowser&&window.document.addEventListener("freeze",e._freezeEventListener),e._connectionState=Ti.Connected,e._connectionStarted=!0,e._logger.log(ge.Debug,"HubConnection connected successfully.")}catch(t){return e._connectionState=Ti.Disconnected,e._logger.log(ge.Debug,`HubConnection failed to start successfully because of error '${t}'.`),Promise.reject(t)}})()}_startInternal(){var e=this;return Fn(function*(){e._stopDuringStartError=void 0,e._receivedHandshakeResponse=!1;const t=new Promise((i,r)=>{e._handshakeResolver=i,e._handshakeRejecter=r});yield e.connection.start(e._protocol.transferFormat);try{const i={protocol:e._protocol.name,version:e._protocol.version};if(e._logger.log(ge.Debug,"Sending handshake request."),yield e._sendMessage(e._handshakeProtocol.writeHandshakeRequest(i)),e._logger.log(ge.Information,`Using HubProtocol '${e._protocol.name}'.`),e._cleanupTimeout(),e._resetTimeoutPeriod(),e._resetKeepAliveInterval(),yield t,e._stopDuringStartError)throw e._stopDuringStartError;e.connection.features.inherentKeepAlive||(yield e._sendMessage(e._cachedPingMessage))}catch(i){throw e._logger.log(ge.Debug,`Hub handshake failed with error '${i}' during start(). Stopping HubConnection.`),e._cleanupTimeout(),e._cleanupPingTimer(),yield e.connection.stop(i),i}})()}stop(){var e=this;return Fn(function*(){const t=e._startPromise;e._stopPromise=e._stopInternal(),yield e._stopPromise;try{yield t}catch{}})()}_stopInternal(e){return this._connectionState===Ti.Disconnected?(this._logger.log(ge.Debug,`Call to HubConnection.stop(${e}) ignored because it is already in the disconnected state.`),Promise.resolve()):this._connectionState===Ti.Disconnecting?(this._logger.log(ge.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnecting state.`),this._stopPromise):(this._connectionState=Ti.Disconnecting,this._logger.log(ge.Debug,"Stopping HubConnection."),this._reconnectDelayHandle?(this._logger.log(ge.Debug,"Connection stopped during reconnect delay. Done reconnecting."),clearTimeout(this._reconnectDelayHandle),this._reconnectDelayHandle=void 0,this._completeClose(),Promise.resolve()):(this._cleanupTimeout(),this._cleanupPingTimer(),this._stopDuringStartError=e||new va("The connection was stopped before the hub handshake could complete."),this.connection.stop(e)))}stream(e,...t){const[i,r]=this._replaceStreamingParams(t),s=this._createStreamInvocation(e,t,r);let o;const a=new Are;return a.cancelCallback=()=>{const l=this._createCancelInvocation(s.invocationId);return delete this._callbacks[s.invocationId],o.then(()=>this._sendWithProtocol(l))},this._callbacks[s.invocationId]=(l,c)=>{c?a.error(c):l&&(l.type===si.Completion?l.error?a.error(new Error(l.error)):a.complete():a.next(l.item))},o=this._sendWithProtocol(s).catch(l=>{a.error(l),delete this._callbacks[s.invocationId]}),this._launchStreams(i,o),a}_sendMessage(e){return this._resetKeepAliveInterval(),this.connection.send(e)}_sendWithProtocol(e){return this._sendMessage(this._protocol.writeMessage(e))}send(e,...t){const[i,r]=this._replaceStreamingParams(t),s=this._sendWithProtocol(this._createInvocation(e,t,!0,r));return this._launchStreams(i,s),s}invoke(e,...t){const[i,r]=this._replaceStreamingParams(t),s=this._createInvocation(e,t,!1,r);return new Promise((a,l)=>{this._callbacks[s.invocationId]=(d,f)=>{f?l(f):d&&(d.type===si.Completion?d.error?l(new Error(d.error)):a(d.result):l(new Error(`Unexpected message type: ${d.type}`)))};const c=this._sendWithProtocol(s).catch(d=>{l(d),delete this._callbacks[s.invocationId]});this._launchStreams(i,c)})}on(e,t){!e||!t||(e=e.toLowerCase(),this._methods[e]||(this._methods[e]=[]),-1===this._methods[e].indexOf(t)&&this._methods[e].push(t))}off(e,t){if(!e)return;e=e.toLowerCase();const i=this._methods[e];if(i)if(t){const r=i.indexOf(t);-1!==r&&(i.splice(r,1),0===i.length&&delete this._methods[e])}else delete this._methods[e]}onclose(e){e&&this._closedCallbacks.push(e)}onreconnecting(e){e&&this._reconnectingCallbacks.push(e)}onreconnected(e){e&&this._reconnectedCallbacks.push(e)}_processIncomingData(e){if(this._cleanupTimeout(),this._receivedHandshakeResponse||(e=this._processHandshakeResponse(e),this._receivedHandshakeResponse=!0),e){const t=this._protocol.parseMessages(e,this._logger);for(const i of t)switch(i.type){case si.Invocation:this._invokeClientMethod(i);break;case si.StreamItem:case si.Completion:{const r=this._callbacks[i.invocationId];if(r){i.type===si.Completion&&delete this._callbacks[i.invocationId];try{r(i)}catch(s){this._logger.log(ge.Error,`Stream callback threw error: ${eH(s)}`)}}break}case si.Ping:break;case si.Close:{this._logger.log(ge.Information,"Close message received from server.");const r=i.error?new Error("Server returned an error on close: "+i.error):void 0;!0===i.allowReconnect?this.connection.stop(r):this._stopPromise=this._stopInternal(r);break}default:this._logger.log(ge.Warning,`Invalid message type: ${i.type}.`)}}this._resetTimeoutPeriod()}_processHandshakeResponse(e){let t,i;try{[i,t]=this._handshakeProtocol.parseHandshakeResponse(e)}catch(r){const s="Error parsing handshake response: "+r;this._logger.log(ge.Error,s);const o=new Error(s);throw this._handshakeRejecter(o),o}if(t.error){const r="Server returned handshake error: "+t.error;this._logger.log(ge.Error,r);const s=new Error(r);throw this._handshakeRejecter(s),s}return this._logger.log(ge.Debug,"Server handshake complete."),this._handshakeResolver(),i}_resetKeepAliveInterval(){this.connection.features.inherentKeepAlive||(this._nextKeepAlive=(new Date).getTime()+this.keepAliveIntervalInMilliseconds,this._cleanupPingTimer())}_resetTimeoutPeriod(){var e=this;if(!(this.connection.features&&this.connection.features.inherentKeepAlive||(this._timeoutHandle=setTimeout(()=>this.serverTimeout(),this.serverTimeoutInMilliseconds),void 0!==this._pingServerHandle))){let t=this._nextKeepAlive-(new Date).getTime();t<0&&(t=0),this._pingServerHandle=setTimeout(Fn(function*(){if(e._connectionState===Ti.Connected)try{yield e._sendMessage(e._cachedPingMessage)}catch{e._cleanupPingTimer()}}),t)}}serverTimeout(){this.connection.stop(new Error("Server timeout elapsed without receiving a message from the server."))}_invokeClientMethod(e){var t=this;return Fn(function*(){const i=e.target.toLowerCase(),r=t._methods[i];if(!r)return t._logger.log(ge.Warning,`No client method with the name '${i}' found.`),void(e.invocationId&&(t._logger.log(ge.Warning,`No result given for '${i}' method and invocation ID '${e.invocationId}'.`),yield t._sendWithProtocol(t._createCompletionMessage(e.invocationId,"Client didn't provide a result.",null))));const s=r.slice(),o=!!e.invocationId;let a,l,c;for(const d of s)try{const f=a;a=yield d.apply(t,e.arguments),o&&a&&f&&(t._logger.log(ge.Error,`Multiple results provided for '${i}'. Sending error to server.`),c=t._createCompletionMessage(e.invocationId,"Client provided multiple results.",null)),l=void 0}catch(f){l=f,t._logger.log(ge.Error,`A callback for the method '${i}' threw error '${f}'.`)}c?yield t._sendWithProtocol(c):o?(l?c=t._createCompletionMessage(e.invocationId,`${l}`,null):void 0!==a?c=t._createCompletionMessage(e.invocationId,null,a):(t._logger.log(ge.Warning,`No result given for '${i}' method and invocation ID '${e.invocationId}'.`),c=t._createCompletionMessage(e.invocationId,"Client didn't provide a result.",null)),yield t._sendWithProtocol(c)):a&&t._logger.log(ge.Error,`Result given for '${i}' method but server is not expecting a result.`)})()}_connectionClosed(e){this._logger.log(ge.Debug,`HubConnection.connectionClosed(${e}) called while in state ${this._connectionState}.`),this._stopDuringStartError=this._stopDuringStartError||e||new va("The underlying connection was closed before the hub handshake could complete."),this._handshakeResolver&&this._handshakeResolver(),this._cancelCallbacksWithError(e||new Error("Invocation canceled due to the underlying connection being closed.")),this._cleanupTimeout(),this._cleanupPingTimer(),this._connectionState===Ti.Disconnecting?this._completeClose(e):this._connectionState===Ti.Connected&&this._reconnectPolicy?this._reconnect(e):this._connectionState===Ti.Connected&&this._completeClose(e)}_completeClose(e){if(this._connectionStarted){this._connectionState=Ti.Disconnected,this._connectionStarted=!1,Ar.isBrowser&&window.document.removeEventListener("freeze",this._freezeEventListener);try{this._closedCallbacks.forEach(t=>t.apply(this,[e]))}catch(t){this._logger.log(ge.Error,`An onclose callback called with error '${e}' threw error '${t}'.`)}}}_reconnect(e){var t=this;return Fn(function*(){const i=Date.now();let r=0,s=void 0!==e?e:new Error("Attempting to reconnect due to a unknown error."),o=t._getNextRetryDelay(r++,0,s);if(null===o)return t._logger.log(ge.Debug,"Connection not reconnecting because the IRetryPolicy returned null on the first reconnect attempt."),void t._completeClose(e);if(t._connectionState=Ti.Reconnecting,t._logger.log(ge.Information,e?`Connection reconnecting because of error '${e}'.`:"Connection reconnecting."),0!==t._reconnectingCallbacks.length){try{t._reconnectingCallbacks.forEach(a=>a.apply(t,[e]))}catch(a){t._logger.log(ge.Error,`An onreconnecting callback called with error '${e}' threw error '${a}'.`)}if(t._connectionState!==Ti.Reconnecting)return void t._logger.log(ge.Debug,"Connection left the reconnecting state in onreconnecting callback. Done reconnecting.")}for(;null!==o;){if(t._logger.log(ge.Information,`Reconnect attempt number ${r} will start in ${o} ms.`),yield new Promise(a=>{t._reconnectDelayHandle=setTimeout(a,o)}),t._reconnectDelayHandle=void 0,t._connectionState!==Ti.Reconnecting)return void t._logger.log(ge.Debug,"Connection left the reconnecting state during reconnect delay. Done reconnecting.");try{if(yield t._startInternal(),t._connectionState=Ti.Connected,t._logger.log(ge.Information,"HubConnection reconnected successfully."),0!==t._reconnectedCallbacks.length)try{t._reconnectedCallbacks.forEach(a=>a.apply(t,[t.connection.connectionId]))}catch(a){t._logger.log(ge.Error,`An onreconnected callback called with connectionId '${t.connection.connectionId}; threw error '${a}'.`)}return}catch(a){if(t._logger.log(ge.Information,`Reconnect attempt failed because of error '${a}'.`),t._connectionState!==Ti.Reconnecting)return t._logger.log(ge.Debug,`Connection moved to the '${t._connectionState}' from the reconnecting state during reconnect attempt. Done reconnecting.`),void(t._connectionState===Ti.Disconnecting&&t._completeClose());s=a instanceof Error?a:new Error(a.toString()),o=t._getNextRetryDelay(r++,Date.now()-i,s)}}t._logger.log(ge.Information,`Reconnect retries have been exhausted after ${Date.now()-i} ms and ${r} failed attempts. Connection disconnecting.`),t._completeClose()})()}_getNextRetryDelay(e,t,i){try{return this._reconnectPolicy.nextRetryDelayInMilliseconds({elapsedMilliseconds:t,previousRetryCount:e,retryReason:i})}catch(r){return this._logger.log(ge.Error,`IRetryPolicy.nextRetryDelayInMilliseconds(${e}, ${t}) threw error '${r}'.`),null}}_cancelCallbacksWithError(e){const t=this._callbacks;this._callbacks={},Object.keys(t).forEach(i=>{const r=t[i];try{r(null,e)}catch(s){this._logger.log(ge.Error,`Stream 'error' callback called with '${e}' threw error: ${eH(s)}`)}})}_cleanupPingTimer(){this._pingServerHandle&&(clearTimeout(this._pingServerHandle),this._pingServerHandle=void 0)}_cleanupTimeout(){this._timeoutHandle&&clearTimeout(this._timeoutHandle)}_createInvocation(e,t,i,r){if(i)return 0!==r.length?{arguments:t,streamIds:r,target:e,type:si.Invocation}:{arguments:t,target:e,type:si.Invocation};{const s=this._invocationId;return this._invocationId++,0!==r.length?{arguments:t,invocationId:s.toString(),streamIds:r,target:e,type:si.Invocation}:{arguments:t,invocationId:s.toString(),target:e,type:si.Invocation}}}_launchStreams(e,t){if(0!==e.length){t||(t=Promise.resolve());for(const i in e)e[i].subscribe({complete:()=>{t=t.then(()=>this._sendWithProtocol(this._createCompletionMessage(i)))},error:r=>{let s;s=r instanceof Error?r.message:r&&r.toString?r.toString():"Unknown error",t=t.then(()=>this._sendWithProtocol(this._createCompletionMessage(i,s)))},next:r=>{t=t.then(()=>this._sendWithProtocol(this._createStreamItemMessage(i,r)))}})}}_replaceStreamingParams(e){const t=[],i=[];for(let r=0;r<e.length;r++){const s=e[r];if(this._isObservable(s)){const o=this._invocationId;this._invocationId++,t[o]=s,i.push(o.toString()),e.splice(r,1)}}return[t,i]}_isObservable(e){return e&&e.subscribe&&"function"==typeof e.subscribe}_createStreamInvocation(e,t,i){const r=this._invocationId;return this._invocationId++,0!==i.length?{arguments:t,invocationId:r.toString(),streamIds:i,target:e,type:si.StreamInvocation}:{arguments:t,invocationId:r.toString(),target:e,type:si.StreamInvocation}}_createCancelInvocation(e){return{invocationId:e,type:si.CancelInvocation}}_createStreamItemMessage(e,t){return{invocationId:e,item:t,type:si.StreamItem}}_createCompletionMessage(e,t,i){return t?{error:t,invocationId:e,type:si.Completion}:{invocationId:e,result:i,type:si.Completion}}}class Pre{constructor(){this.name="json",this.version=1,this.transferFormat=Es.Text}parseMessages(e,t){if("string"!=typeof e)throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!e)return[];null===t&&(t=iv.instance);const i=mo.parse(e),r=[];for(const s of i){const o=JSON.parse(s);if("number"!=typeof o.type)throw new Error("Invalid payload.");switch(o.type){case si.Invocation:this._isInvocationMessage(o);break;case si.StreamItem:this._isStreamItemMessage(o);break;case si.Completion:this._isCompletionMessage(o);break;case si.Ping:case si.Close:break;default:t.log(ge.Information,"Unknown message type '"+o.type+"' ignored.");continue}r.push(o)}return r}writeMessage(e){return mo.write(JSON.stringify(e))}_isInvocationMessage(e){this._assertNotEmptyString(e.target,"Invalid payload for Invocation message."),void 0!==e.invocationId&&this._assertNotEmptyString(e.invocationId,"Invalid payload for Invocation message.")}_isStreamItemMessage(e){if(this._assertNotEmptyString(e.invocationId,"Invalid payload for StreamItem message."),void 0===e.item)throw new Error("Invalid payload for StreamItem message.")}_isCompletionMessage(e){if(e.result&&e.error)throw new Error("Invalid payload for Completion message.");!e.result&&e.error&&this._assertNotEmptyString(e.error,"Invalid payload for Completion message."),this._assertNotEmptyString(e.invocationId,"Invalid payload for Completion message.")}_assertNotEmptyString(e,t){if("string"!=typeof e||""===e)throw new Error(t)}}const Nre={trace:ge.Trace,debug:ge.Debug,info:ge.Information,information:ge.Information,warn:ge.Warning,warning:ge.Warning,error:ge.Error,critical:ge.Critical,none:ge.None};class Ore{configureLogging(e){if(Cr.isRequired(e,"logging"),function Fre(n){return void 0!==n.log}(e))this.logger=e;else if("string"==typeof e){const t=function Lre(n){const e=Nre[n.toLowerCase()];if(typeof e<"u")return e;throw new Error(`Unknown log level: ${n}`)}(e);this.logger=new Tw(t)}else this.logger=new Tw(e);return this}withUrl(e,t){return Cr.isRequired(e,"url"),Cr.isNotEmpty(e,"url"),this.url=e,this.httpConnectionOptions="object"==typeof t?{...this.httpConnectionOptions,...t}:{...this.httpConnectionOptions,transport:t},this}withHubProtocol(e){return Cr.isRequired(e,"protocol"),this.protocol=e,this}withAutomaticReconnect(e){if(this.reconnectPolicy)throw new Error("A reconnectPolicy has already been set.");return this.reconnectPolicy=e?Array.isArray(e)?new ZV(e):e:new ZV,this}build(){const e=this.httpConnectionOptions||{};if(void 0===e.logger&&(e.logger=this.logger),!this.url)throw new Error("The 'HubConnectionBuilder.withUrl' method must be called before building the connection.");const t=new xre(this.url,e);return hI.create(t,this.logger||iv.instance,this.protocol||new Pre,this.reconnectPolicy)}}let kre=(()=>{class n{constructor(){}startConnection(){this.hubConnection=(new Ore).withUrl("/notifications").withAutomaticReconnect().build(),this.hubConnection.start().then(()=>{console.log("Connection started"),this.hubConnection.send("SetConnectionIDUser",123)}).catch(t=>console.log("Error while starting connection: "+t))}testSendXXX1(){this.hubConnection.send("XXX1",123,"abc")}executeAction(t,i,r,s,o,a,l){this.hubConnection.send("ExecuteAction",{GameId:t,PlayerId:i,ItemId:r,ActionId:s,DragTargetItemId:o,ClientX:a,ClientY:l})}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=tt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class Aw{}class Dw{}class ol{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?"string"==typeof e?this.lazyInit=()=>{this.headers=new Map,e.split("\n").forEach(t=>{const i=t.indexOf(":");if(i>0){const r=t.slice(0,i),s=r.toLowerCase(),o=t.slice(i+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,i)=>{this.setHeaderEntries(i,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,i])=>{this.setHeaderEntries(t,i)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof ol?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new ol;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof ol?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(e.name,t);const r=("a"===e.op?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":const s=e.value;if(s){let o=this.headers.get(t);if(!o)return;o=o.filter(a=>-1===s.indexOf(a)),0===o.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}else this.headers.delete(t),this.normalizedNames.delete(t)}}setHeaderEntries(e,t){const i=(Array.isArray(t)?t:[t]).map(s=>s.toString()),r=e.toLowerCase();this.headers.set(r,i),this.maybeSetNormalizedName(e,r)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class Ure{encodeKey(e){return sH(e)}encodeValue(e){return sH(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const Vre=/%(\d[a-f0-9])/gi,Hre={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function sH(n){return encodeURIComponent(n).replace(Vre,(e,t)=>Hre[t]??e)}function Iw(n){return`${n}`}class Mu{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new Ure,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function Bre(n,e){const t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(r=>{const s=r.indexOf("="),[o,a]=-1==s?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,s)),e.decodeValue(r.slice(s+1))],l=t.get(o)||[];l.push(a),t.set(o,l)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const i=e.fromObject[t],r=Array.isArray(i)?i.map(Iw):[Iw(i)];this.map.set(t,r)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(i=>{const r=e[i];Array.isArray(r)?r.forEach(s=>{t.push({param:i,value:s,op:"a"})}):t.push({param:i,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new Mu({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(Iw(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let i=this.map.get(e.param)||[];const r=i.indexOf(Iw(e.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(e.param,i):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class zre{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function oH(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function aH(n){return typeof Blob<"u"&&n instanceof Blob}function lH(n){return typeof FormData<"u"&&n instanceof FormData}class ov{constructor(e,t,i,r){let s;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function Gre(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,s=r):s=i,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new ol),this.context||(this.context=new zre),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=t;else{const a=t.indexOf("?");this.urlWithParams=t+(-1===a?"?":a<t.length-1?"&":"")+o}}else this.params=new Mu,this.urlWithParams=t}serializeBody(){return null===this.body?null:oH(this.body)||aH(this.body)||lH(this.body)||function Wre(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Mu?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||lH(this.body)?null:aH(this.body)?this.body.type||null:oH(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Mu?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){const t=e.method||this.method,i=e.url||this.url,r=e.responseType||this.responseType,s=void 0!==e.body?e.body:this.body,o=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,a=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let l=e.headers||this.headers,c=e.params||this.params;const d=e.context??this.context;return void 0!==e.setHeaders&&(l=Object.keys(e.setHeaders).reduce((f,p)=>f.set(p,e.setHeaders[p]),l)),e.setParams&&(c=Object.keys(e.setParams).reduce((f,p)=>f.set(p,e.setParams[p]),c)),new ov(t,i,s,{params:c,headers:l,context:d,reportProgress:a,responseType:r,withCredentials:o})}}var Mm=function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n}(Mm||{});class fI{constructor(e,t=200,i="OK"){this.headers=e.headers||new ol,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class pI extends fI{constructor(e={}){super(e),this.type=Mm.ResponseHeader}clone(e={}){return new pI({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class xm extends fI{constructor(e={}){super(e),this.type=Mm.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new xm({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class cH extends fI{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function mI(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let uH=(()=>{class n{constructor(t){this.handler=t}request(t,i,r={}){let s;if(t instanceof ov)s=t;else{let l,c;l=r.headers instanceof ol?r.headers:new ol(r.headers),r.params&&(c=r.params instanceof Mu?r.params:new Mu({fromObject:r.params})),s=new ov(t,i,void 0!==r.body?r.body:null,{headers:l,context:r.context,params:c,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const o=vt(s).pipe(yp(l=>this.handler.handle(l)));if(t instanceof ov||"events"===r.observe)return o;const a=o.pipe(Hl(l=>l instanceof xm));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(Rt(l=>{if(null!==l.body&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return a.pipe(Rt(l=>{if(null!==l.body&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return a.pipe(Rt(l=>{if(null!==l.body&&"string"!=typeof l.body)throw new Error("Response is not a string.");return l.body}));default:return a.pipe(Rt(l=>l.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:(new Mu).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,r={}){return this.request("PATCH",t,mI(r,i))}post(t,i,r={}){return this.request("POST",t,mI(r,i))}put(t,i,r={}){return this.request("PUT",t,mI(r,i))}static#e=this.\u0275fac=function(i){return new(i||n)(Ne(Aw))};static#t=this.\u0275prov=tt({token:n,factory:n.\u0275fac})}return n})();function fH(n,e){return e(n)}function jre(n,e){return(t,i)=>e.intercept(t,{handle:r=>n(r,i)})}const Xre=new Ye(""),av=new Ye(""),pH=new Ye("");function Yre(){let n=null;return(e,t)=>{null===n&&(n=(Ve(Xre,{optional:!0})??[]).reduceRight(jre,fH));const i=Ve(QE),r=i.add();return n(e,t).pipe(oy(()=>i.remove(r)))}}let mH=(()=>{class n extends Aw{constructor(t,i){super(),this.backend=t,this.injector=i,this.chain=null,this.pendingTasks=Ve(QE)}handle(t){if(null===this.chain){const r=Array.from(new Set([...this.injector.get(av),...this.injector.get(pH,[])]));this.chain=r.reduceRight((s,o)=>function qre(n,e,t){return(i,r)=>t.runInContext(()=>e(i,s=>n(s,r)))}(s,o,this.injector),fH)}const i=this.pendingTasks.add();return this.chain(t,r=>this.backend.handle(r)).pipe(oy(()=>this.pendingTasks.remove(i)))}static#e=this.\u0275fac=function(i){return new(i||n)(Ne(Dw),Ne(hs))};static#t=this.\u0275prov=tt({token:n,factory:n.\u0275fac})}return n})();const Qre=/^\)\]\}',?\n/;let _H=(()=>{class n{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new re(-2800,!1);const i=this.xhrFactory;return(i.\u0275loadImpl?gi(i.\u0275loadImpl()):vt(null)).pipe(Ms(()=>new qe(s=>{const o=i.build();if(o.open(t.method,t.urlWithParams),t.withCredentials&&(o.withCredentials=!0),t.headers.forEach((E,v)=>o.setRequestHeader(E,v.join(","))),t.headers.has("Accept")||o.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const E=t.detectContentTypeHeader();null!==E&&o.setRequestHeader("Content-Type",E)}if(t.responseType){const E=t.responseType.toLowerCase();o.responseType="json"!==E?E:"text"}const a=t.serializeBody();let l=null;const c=()=>{if(null!==l)return l;const E=o.statusText||"OK",v=new ol(o.getAllResponseHeaders()),y=function ese(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}(o)||t.url;return l=new pI({headers:v,status:o.status,statusText:E,url:y}),l},d=()=>{let{headers:E,status:v,statusText:y,url:S}=c(),b=null;204!==v&&(b=typeof o.response>"u"?o.responseText:o.response),0===v&&(v=b?200:0);let M=v>=200&&v<300;if("json"===t.responseType&&"string"==typeof b){const T=b;b=b.replace(Qre,"");try{b=""!==b?JSON.parse(b):null}catch(I){b=T,M&&(M=!1,b={error:I,text:b})}}M?(s.next(new xm({body:b,headers:E,status:v,statusText:y,url:S||void 0})),s.complete()):s.error(new cH({error:b,headers:E,status:v,statusText:y,url:S||void 0}))},f=E=>{const{url:v}=c(),y=new cH({error:E,status:o.status||0,statusText:o.statusText||"Unknown Error",url:v||void 0});s.error(y)};let p=!1;const m=E=>{p||(s.next(c()),p=!0);let v={type:Mm.DownloadProgress,loaded:E.loaded};E.lengthComputable&&(v.total=E.total),"text"===t.responseType&&o.responseText&&(v.partialText=o.responseText),s.next(v)},_=E=>{let v={type:Mm.UploadProgress,loaded:E.loaded};E.lengthComputable&&(v.total=E.total),s.next(v)};return o.addEventListener("load",d),o.addEventListener("error",f),o.addEventListener("timeout",f),o.addEventListener("abort",f),t.reportProgress&&(o.addEventListener("progress",m),null!==a&&o.upload&&o.upload.addEventListener("progress",_)),o.send(a),s.next({type:Mm.Sent}),()=>{o.removeEventListener("error",f),o.removeEventListener("abort",f),o.removeEventListener("load",d),o.removeEventListener("timeout",f),t.reportProgress&&(o.removeEventListener("progress",m),null!==a&&o.upload&&o.upload.removeEventListener("progress",_)),o.readyState!==o.DONE&&o.abort()}})))}static#e=this.\u0275fac=function(i){return new(i||n)(Ne(oF))};static#t=this.\u0275prov=tt({token:n,factory:n.\u0275fac})}return n})();const gI=new Ye("XSRF_ENABLED"),yH=new Ye("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),vH=new Ye("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class EH{}let ise=(()=>{class n{constructor(t,i,r){this.doc=t,this.platform=i,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=ZO(t,this.cookieName),this.lastCookieString=t),this.lastToken}static#e=this.\u0275fac=function(i){return new(i||n)(Ne(qr),Ne(Wa),Ne(yH))};static#t=this.\u0275prov=tt({token:n,factory:n.\u0275fac})}return n})();function rse(n,e){const t=n.url.toLowerCase();if(!Ve(gI)||"GET"===n.method||"HEAD"===n.method||t.startsWith("http://")||t.startsWith("https://"))return e(n);const i=Ve(EH).getToken(),r=Ve(vH);return null!=i&&!n.headers.has(r)&&(n=n.clone({headers:n.headers.set(r,i)})),e(n)}var xu=function(n){return n[n.Interceptors=0]="Interceptors",n[n.LegacyInterceptors=1]="LegacyInterceptors",n[n.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",n[n.NoXsrfProtection=3]="NoXsrfProtection",n[n.JsonpSupport=4]="JsonpSupport",n[n.RequestsMadeViaParent=5]="RequestsMadeViaParent",n[n.Fetch=6]="Fetch",n}(xu||{});function sse(...n){const e=[uH,_H,mH,{provide:Aw,useExisting:mH},{provide:Dw,useExisting:_H},{provide:av,useValue:rse,multi:!0},{provide:gI,useValue:!0},{provide:EH,useClass:ise}];for(const t of n)e.push(...t.\u0275providers);return function s_(n){return{\u0275providers:n}}(e)}const bH=new Ye("LEGACY_INTERCEPTOR_FN");function ose(){return function lh(n,e){return{\u0275kind:n,\u0275providers:e}}(xu.LegacyInterceptors,[{provide:bH,useFactory:Yre},{provide:av,useExisting:bH,multi:!0}])}let ase=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=tr({type:n});static#n=this.\u0275inj=Vi({providers:[sse(ose())]})}return n})(),fse=(()=>{class n{constructor(t){this.http=t,this.baseUrl="/api/Game"}getGameById(t){return this.http.get(this.baseUrl+`/GetGameByID?GameId=${t}`)}createGame(){return this.http.post(this.baseUrl+"/CreateGame",{})}executeAction(t,i,r,s,o,a){return this.http.post(this.baseUrl+"/ExecuteAction",{GameId:t,PlayerId:i,ActionId:r,ItemId:s,ClientX:o,ClientY:a})}static#e=this.\u0275fac=function(i){return new(i||n)(Ne(uH))};static#t=this.\u0275prov=tt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Qr=(()=>class n{static STARTS_WITH="startsWith";static CONTAINS="contains";static NOT_CONTAINS="notContains";static ENDS_WITH="endsWith";static EQUALS="equals";static NOT_EQUALS="notEquals";static IN="in";static LESS_THAN="lt";static LESS_THAN_OR_EQUAL_TO="lte";static GREATER_THAN="gt";static GREATER_THAN_OR_EQUAL_TO="gte";static BETWEEN="between";static IS="is";static IS_NOT="isNot";static BEFORE="before";static AFTER="after";static DATE_IS="dateIs";static DATE_IS_NOT="dateIsNot";static DATE_BEFORE="dateBefore";static DATE_AFTER="dateAfter"})(),mse=(()=>{class n{ripple=!1;overlayOptions={};filterMatchModeOptions={text:[Qr.STARTS_WITH,Qr.CONTAINS,Qr.NOT_CONTAINS,Qr.ENDS_WITH,Qr.EQUALS,Qr.NOT_EQUALS],numeric:[Qr.EQUALS,Qr.NOT_EQUALS,Qr.LESS_THAN,Qr.LESS_THAN_OR_EQUAL_TO,Qr.GREATER_THAN,Qr.GREATER_THAN_OR_EQUAL_TO],date:[Qr.DATE_IS,Qr.DATE_IS_NOT,Qr.DATE_BEFORE,Qr.DATE_AFTER]};translation={startsWith:"Starts with",contains:"Contains",notContains:"Not contains",endsWith:"Ends with",equals:"Equals",notEquals:"Not equals",noFilter:"No Filter",lt:"Less than",lte:"Less than or equal to",gt:"Greater than",gte:"Greater than or equal to",is:"Is",isNot:"Is not",before:"Before",after:"After",dateIs:"Date is",dateIsNot:"Date is not",dateBefore:"Date is before",dateAfter:"Date is after",clear:"Clear",apply:"Apply",matchAll:"Match All",matchAny:"Match Any",addRule:"Add Rule",removeRule:"Remove Rule",accept:"Yes",reject:"No",choose:"Choose",upload:"Upload",cancel:"Cancel",pending:"Pending",fileSizeTypes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],chooseYear:"Choose Year",chooseMonth:"Choose Month",chooseDate:"Choose Date",prevDecade:"Previous Decade",nextDecade:"Next Decade",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",prevHour:"Previous Hour",nextHour:"Next Hour",prevMinute:"Previous Minute",nextMinute:"Next Minute",prevSecond:"Previous Second",nextSecond:"Next Second",am:"am",pm:"pm",dateFormat:"mm/dd/yy",firstDayOfWeek:0,today:"Today",weekHeader:"Wk",weak:"Weak",medium:"Medium",strong:"Strong",passwordPrompt:"Enter a password",emptyMessage:"No results found",searchMessage:"{0} results are available",selectionMessage:"{0} items selected",emptySelectionMessage:"No selected item",emptySearchMessage:"No results found",emptyFilterMessage:"No results found",aria:{trueLabel:"True",falseLabel:"False",nullLabel:"Not Selected",star:"1 star",stars:"{star} stars",selectAll:"All items selected",unselectAll:"All items unselected",close:"Close",previous:"Previous",next:"Next",navigation:"Navigation",scrollTop:"Scroll Top",moveTop:"Move Top",moveUp:"Move Up",moveDown:"Move Down",moveBottom:"Move Bottom",moveToTarget:"Move to Target",moveToSource:"Move to Source",moveAllToTarget:"Move All to Target",moveAllToSource:"Move All to Source",pageLabel:"{page}",firstPageLabel:"First Page",lastPageLabel:"Last Page",nextPageLabel:"Next Page",prevPageLabel:"Previous Page",rowsPerPageLabel:"Rows per page",previousPageLabel:"Previous Page",jumpToPageDropdownLabel:"Jump to Page Dropdown",jumpToPageInputLabel:"Jump to Page Input",selectRow:"Row Selected",unselectRow:"Row Unselected",expandRow:"Row Expanded",collapseRow:"Row Collapsed",showFilterMenu:"Show Filter Menu",hideFilterMenu:"Hide Filter Menu",filterOperator:"Filter Operator",filterConstraint:"Filter Constraint",editRow:"Row Edit",saveEdit:"Save Edit",cancelEdit:"Cancel Edit",listView:"List View",gridView:"Grid View",slide:"Slide",slideNumber:"{slideNumber}",zoomImage:"Zoom Image",zoomIn:"Zoom In",zoomOut:"Zoom Out",rotateRight:"Rotate Right",rotateLeft:"Rotate Left"}};zIndex={modal:1100,overlay:1e3,menu:1e3,tooltip:1100};translationSource=new Un;translationObserver=this.translationSource.asObservable();getTranslation(t){return this.translation[t]}setTranslation(t){this.translation={...this.translation,...t},this.translationSource.next(this.translation)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=tt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),SH=(()=>{class n{template;type;name;constructor(t){this.template=t}getType(){return this.name}static \u0275fac=function(i){return new(i||n)(ye(Ya))};static \u0275dir=_t({type:n,selectors:[["","pTemplate",""]],inputs:{type:"type",name:["pTemplate","name"]}})}return n})(),_I=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=tr({type:n});static \u0275inj=Vi({imports:[q_]})}return n})();class lv{static equals(e,t,i){return i?this.resolveFieldData(e,i)===this.resolveFieldData(t,i):this.equalsByValue(e,t)}static equalsByValue(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var s,o,a,i=Array.isArray(e),r=Array.isArray(t);if(i&&r){if((o=e.length)!=t.length)return!1;for(s=o;0!=s--;)if(!this.equalsByValue(e[s],t[s]))return!1;return!0}if(i!=r)return!1;var l=this.isDate(e),c=this.isDate(t);if(l!=c)return!1;if(l&&c)return e.getTime()==t.getTime();var d=e instanceof RegExp,f=t instanceof RegExp;if(d!=f)return!1;if(d&&f)return e.toString()==t.toString();var p=Object.keys(e);if((o=p.length)!==Object.keys(t).length)return!1;for(s=o;0!=s--;)if(!Object.prototype.hasOwnProperty.call(t,p[s]))return!1;for(s=o;0!=s--;)if(!this.equalsByValue(e[a=p[s]],t[a]))return!1;return!0}return e!=e&&t!=t}static resolveFieldData(e,t){if(e&&t){if(this.isFunction(t))return t(e);if(-1==t.indexOf("."))return e[t];{let i=t.split("."),r=e;for(let s=0,o=i.length;s<o;++s){if(null==r)return null;r=r[i[s]]}return r}}return null}static isFunction(e){return!!(e&&e.constructor&&e.call&&e.apply)}static reorderArray(e,t,i){e&&t!==i&&(i>=e.length&&(i%=e.length,t%=e.length),e.splice(i,0,e.splice(t,1)[0]))}static insertIntoOrderedArray(e,t,i,r){if(i.length>0){let s=!1;for(let o=0;o<i.length;o++)if(this.findIndexInList(i[o],r)>t){i.splice(o,0,e),s=!0;break}s||i.push(e)}else i.push(e)}static findIndexInList(e,t){let i=-1;if(t)for(let r=0;r<t.length;r++)if(t[r]==e){i=r;break}return i}static contains(e,t){if(null!=e&&t&&t.length)for(let i of t)if(this.equals(e,i))return!0;return!1}static removeAccents(e){return e&&e.search(/[\xC0-\xFF]/g)>-1&&(e=e.replace(/[\xC0-\xC5]/g,"A").replace(/[\xC6]/g,"AE").replace(/[\xC7]/g,"C").replace(/[\xC8-\xCB]/g,"E").replace(/[\xCC-\xCF]/g,"I").replace(/[\xD0]/g,"D").replace(/[\xD1]/g,"N").replace(/[\xD2-\xD6\xD8]/g,"O").replace(/[\xD9-\xDC]/g,"U").replace(/[\xDD]/g,"Y").replace(/[\xDE]/g,"P").replace(/[\xE0-\xE5]/g,"a").replace(/[\xE6]/g,"ae").replace(/[\xE7]/g,"c").replace(/[\xE8-\xEB]/g,"e").replace(/[\xEC-\xEF]/g,"i").replace(/[\xF1]/g,"n").replace(/[\xF2-\xF6\xF8]/g,"o").replace(/[\xF9-\xFC]/g,"u").replace(/[\xFE]/g,"p").replace(/[\xFD\xFF]/g,"y")),e}static isDate(e){return"[object Date]"===Object.prototype.toString.call(e)}static isEmpty(e){return null==e||""===e||Array.isArray(e)&&0===e.length||!this.isDate(e)&&"object"==typeof e&&0===Object.keys(e).length}static isNotEmpty(e){return!this.isEmpty(e)}static compare(e,t,i,r=1){let s=-1;const o=this.isEmpty(e),a=this.isEmpty(t);return s=o&&a?0:o?r:a?-r:"string"==typeof e&&"string"==typeof t?e.localeCompare(t,i,{numeric:!0}):e<t?-1:e>t?1:0,s}static sort(e,t,i=1,r,s=1){return(1===s?i:s)*lv.compare(e,t,r,i)}static merge(e,t){if(null!=e||null!=t)return null!=e&&"object"!=typeof e||null!=t&&"object"!=typeof t?null!=e&&"string"!=typeof e||null!=t&&"string"!=typeof t?t||e:[e||"",t||""].join(" "):{...e||{},...t||{}}}static isPrintableCharacter(e=""){return this.isNotEmpty(e)&&1===e.length&&e.match(/\S| /)}static getItemValue(e,...t){return this.isFunction(e)?e(...t):e}static findLastIndex(e,t){let i=-1;if(this.isNotEmpty(e))try{i=e.findLastIndex(t)}catch{i=e.lastIndexOf([...e].reverse().find(t))}return i}static findLast(e,t){let i;if(this.isNotEmpty(e))try{i=e.findLast(t)}catch{i=[...e].reverse().find(t)}return i}}var wH=0;!function _se(){let n=[];const r=s=>s&&parseInt(s.style.zIndex,10)||0}();const yse=["*"];let MH=(()=>{class n{label;spin=!1;styleClass;role;ariaLabel;ariaHidden;ngOnInit(){this.getAttributes()}getAttributes(){const t=lv.isEmpty(this.label);this.role=t?void 0:"img",this.ariaLabel=t?void 0:this.label,this.ariaHidden=t}getClassNames(){return`p-icon ${this.styleClass?this.styleClass+" ":""}${this.spin?"p-icon-spin":""}`}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=ss({type:n,selectors:[["ng-component"]],hostAttrs:[1,"p-element","p-icon-wrapper"],inputs:{label:"label",spin:"spin",styleClass:"styleClass"},standalone:!0,features:[U_],ngContentSelectors:yse,decls:1,vars:0,template:function(i,r){1&i&&(DT(),IT(0))},encapsulation:2,changeDetection:0})}return n})(),xH=(()=>{class n extends MH{pathId;ngOnInit(){this.pathId="url(#"+function gse(n="pn_id_"){return`${n}${++wH}`}()+")"}static \u0275fac=function(){let t;return function(r){return(t||(t=_i(n)))(r||n)}}();static \u0275cmp=ss({type:n,selectors:[["SpinnerIcon"]],standalone:!0,features:[bn,U_],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M6.99701 14C5.85441 13.999 4.72939 13.7186 3.72012 13.1832C2.71084 12.6478 1.84795 11.8737 1.20673 10.9284C0.565504 9.98305 0.165424 8.89526 0.041387 7.75989C-0.0826496 6.62453 0.073125 5.47607 0.495122 4.4147C0.917119 3.35333 1.59252 2.4113 2.46241 1.67077C3.33229 0.930247 4.37024 0.413729 5.4857 0.166275C6.60117 -0.0811796 7.76026 -0.0520535 8.86188 0.251112C9.9635 0.554278 10.9742 1.12227 11.8057 1.90555C11.915 2.01493 11.9764 2.16319 11.9764 2.31778C11.9764 2.47236 11.915 2.62062 11.8057 2.73C11.7521 2.78503 11.688 2.82877 11.6171 2.85864C11.5463 2.8885 11.4702 2.90389 11.3933 2.90389C11.3165 2.90389 11.2404 2.8885 11.1695 2.85864C11.0987 2.82877 11.0346 2.78503 10.9809 2.73C9.9998 1.81273 8.73246 1.26138 7.39226 1.16876C6.05206 1.07615 4.72086 1.44794 3.62279 2.22152C2.52471 2.99511 1.72683 4.12325 1.36345 5.41602C1.00008 6.70879 1.09342 8.08723 1.62775 9.31926C2.16209 10.5513 3.10478 11.5617 4.29713 12.1803C5.48947 12.7989 6.85865 12.988 8.17414 12.7157C9.48963 12.4435 10.6711 11.7264 11.5196 10.6854C12.3681 9.64432 12.8319 8.34282 12.8328 7C12.8328 6.84529 12.8943 6.69692 13.0038 6.58752C13.1132 6.47812 13.2616 6.41667 13.4164 6.41667C13.5712 6.41667 13.7196 6.47812 13.8291 6.58752C13.9385 6.69692 14 6.84529 14 7C14 8.85651 13.2622 10.637 11.9489 11.9497C10.6356 13.2625 8.85432 14 6.99701 14Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(i,r){1&i&&(nf(),sr(0,"svg",0)(1,"g"),oo(2,"path",1),Xi(),sr(3,"defs")(4,"clipPath",2),oo(5,"rect",3),Xi()()()),2&i&&(Ll(r.getClassNames()),hi("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role),Rn(1),hi("clip-path",r.pathId),Rn(3),rn("id",r.pathId))},encapsulation:2})}return n})(),Ws=(()=>{class n{static zindex=1e3;static calculatedScrollbarWidth=null;static calculatedScrollbarHeight=null;static browser;static addClass(t,i){t&&i&&(t.classList?t.classList.add(i):t.className+=" "+i)}static addMultipleClasses(t,i){if(t&&i)if(t.classList){let r=i.trim().split(" ");for(let s=0;s<r.length;s++)t.classList.add(r[s])}else{let r=i.split(" ");for(let s=0;s<r.length;s++)t.className+=" "+r[s]}}static removeClass(t,i){t&&i&&(t.classList?t.classList.remove(i):t.className=t.className.replace(new RegExp("(^|\\b)"+i.split(" ").join("|")+"(\\b|$)","gi")," "))}static hasClass(t,i){return!(!t||!i)&&(t.classList?t.classList.contains(i):new RegExp("(^| )"+i+"( |$)","gi").test(t.className))}static siblings(t){return Array.prototype.filter.call(t.parentNode.children,function(i){return i!==t})}static find(t,i){return Array.from(t.querySelectorAll(i))}static findSingle(t,i){return this.isElement(t)?t.querySelector(i):null}static index(t){let i=t.parentNode.childNodes,r=0;for(var s=0;s<i.length;s++){if(i[s]==t)return r;1==i[s].nodeType&&r++}return-1}static indexWithinGroup(t,i){let r=t.parentNode?t.parentNode.childNodes:[],s=0;for(var o=0;o<r.length;o++){if(r[o]==t)return s;r[o].attributes&&r[o].attributes[i]&&1==r[o].nodeType&&s++}return-1}static appendOverlay(t,i,r="self"){"self"!==r&&t&&i&&this.appendChild(t,i)}static alignOverlay(t,i,r="self",s=!0){t&&i&&(s&&(t.style.minWidth=`${n.getOuterWidth(i)}px`),"self"===r?this.relativePosition(t,i):this.absolutePosition(t,i))}static relativePosition(t,i){const r=y=>{if(y)return"relative"===getComputedStyle(y).getPropertyValue("position")?y:r(y.parentElement)},s=t.offsetParent?{width:t.offsetWidth,height:t.offsetHeight}:this.getHiddenElementDimensions(t),o=i.offsetHeight,a=i.getBoundingClientRect(),l=this.getWindowScrollTop(),c=this.getWindowScrollLeft(),d=this.getViewport(),p=r(t)?.getBoundingClientRect()||{top:-1*l,left:-1*c};let m,_;a.top+o+s.height>d.height?(m=a.top-p.top-s.height,t.style.transformOrigin="bottom",a.top+m<0&&(m=-1*a.top)):(m=o+a.top-p.top,t.style.transformOrigin="top");const E=a.left+s.width-d.width;_=s.width>d.width?-1*(a.left-p.left):E>0?a.left-p.left-E:a.left-p.left,t.style.top=m+"px",t.style.left=_+"px"}static absolutePosition(t,i){const r=t.offsetParent?{width:t.offsetWidth,height:t.offsetHeight}:this.getHiddenElementDimensions(t),s=r.height,o=r.width,a=i.offsetHeight,l=i.offsetWidth,c=i.getBoundingClientRect(),d=this.getWindowScrollTop(),f=this.getWindowScrollLeft(),p=this.getViewport();let m,_;c.top+a+s>p.height?(m=c.top+d-s,t.style.transformOrigin="bottom",m<0&&(m=d)):(m=a+c.top+d,t.style.transformOrigin="top"),_=c.left+o>p.width?Math.max(0,c.left+f+l-o):c.left+f,t.style.top=m+"px",t.style.left=_+"px"}static getParents(t,i=[]){return null===t.parentNode?i:this.getParents(t.parentNode,i.concat([t.parentNode]))}static getScrollableParents(t){let i=[];if(t){let r=this.getParents(t);const s=/(auto|scroll)/,o=a=>{let l=window.getComputedStyle(a,null);return s.test(l.getPropertyValue("overflow"))||s.test(l.getPropertyValue("overflowX"))||s.test(l.getPropertyValue("overflowY"))};for(let a of r){let l=1===a.nodeType&&a.dataset.scrollselectors;if(l){let c=l.split(",");for(let d of c){let f=this.findSingle(a,d);f&&o(f)&&i.push(f)}}9!==a.nodeType&&o(a)&&i.push(a)}}return i}static getHiddenElementOuterHeight(t){t.style.visibility="hidden",t.style.display="block";let i=t.offsetHeight;return t.style.display="none",t.style.visibility="visible",i}static getHiddenElementOuterWidth(t){t.style.visibility="hidden",t.style.display="block";let i=t.offsetWidth;return t.style.display="none",t.style.visibility="visible",i}static getHiddenElementDimensions(t){let i={};return t.style.visibility="hidden",t.style.display="block",i.width=t.offsetWidth,i.height=t.offsetHeight,t.style.display="none",t.style.visibility="visible",i}static scrollInView(t,i){let r=getComputedStyle(t).getPropertyValue("borderTopWidth"),s=r?parseFloat(r):0,o=getComputedStyle(t).getPropertyValue("paddingTop"),a=o?parseFloat(o):0,l=t.getBoundingClientRect(),d=i.getBoundingClientRect().top+document.body.scrollTop-(l.top+document.body.scrollTop)-s-a,f=t.scrollTop,p=t.clientHeight,m=this.getOuterHeight(i);d<0?t.scrollTop=f+d:d+m>p&&(t.scrollTop=f+d-p+m)}static fadeIn(t,i){t.style.opacity=0;let r=+new Date,s=0,o=function(){s=+t.style.opacity.replace(",",".")+((new Date).getTime()-r)/i,t.style.opacity=s,r=+new Date,+s<1&&(window.requestAnimationFrame&&requestAnimationFrame(o)||setTimeout(o,16))};o()}static fadeOut(t,i){var r=1,a=50/i;let l=setInterval(()=>{(r-=a)<=0&&(r=0,clearInterval(l)),t.style.opacity=r},50)}static getWindowScrollTop(){let t=document.documentElement;return(window.pageYOffset||t.scrollTop)-(t.clientTop||0)}static getWindowScrollLeft(){let t=document.documentElement;return(window.pageXOffset||t.scrollLeft)-(t.clientLeft||0)}static matches(t,i){var r=Element.prototype;return(r.matches||r.webkitMatchesSelector||r.mozMatchesSelector||r.msMatchesSelector||function(o){return-1!==[].indexOf.call(document.querySelectorAll(o),this)}).call(t,i)}static getOuterWidth(t,i){let r=t.offsetWidth;if(i){let s=getComputedStyle(t);r+=parseFloat(s.marginLeft)+parseFloat(s.marginRight)}return r}static getHorizontalPadding(t){let i=getComputedStyle(t);return parseFloat(i.paddingLeft)+parseFloat(i.paddingRight)}static getHorizontalMargin(t){let i=getComputedStyle(t);return parseFloat(i.marginLeft)+parseFloat(i.marginRight)}static innerWidth(t){let i=t.offsetWidth,r=getComputedStyle(t);return i+=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight),i}static width(t){let i=t.offsetWidth,r=getComputedStyle(t);return i-=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight),i}static getInnerHeight(t){let i=t.offsetHeight,r=getComputedStyle(t);return i+=parseFloat(r.paddingTop)+parseFloat(r.paddingBottom),i}static getOuterHeight(t,i){let r=t.offsetHeight;if(i){let s=getComputedStyle(t);r+=parseFloat(s.marginTop)+parseFloat(s.marginBottom)}return r}static getHeight(t){let i=t.offsetHeight,r=getComputedStyle(t);return i-=parseFloat(r.paddingTop)+parseFloat(r.paddingBottom)+parseFloat(r.borderTopWidth)+parseFloat(r.borderBottomWidth),i}static getWidth(t){let i=t.offsetWidth,r=getComputedStyle(t);return i-=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight)+parseFloat(r.borderLeftWidth)+parseFloat(r.borderRightWidth),i}static getViewport(){let t=window,i=document,r=i.documentElement,s=i.getElementsByTagName("body")[0];return{width:t.innerWidth||r.clientWidth||s.clientWidth,height:t.innerHeight||r.clientHeight||s.clientHeight}}static getOffset(t){var i=t.getBoundingClientRect();return{top:i.top+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0),left:i.left+(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0)}}static replaceElementWith(t,i){let r=t.parentNode;if(!r)throw"Can't replace element";return r.replaceChild(i,t)}static getUserAgent(){if(navigator&&this.isClient())return navigator.userAgent}static isIE(){var t=window.navigator.userAgent;return t.indexOf("MSIE ")>0||(t.indexOf("Trident/")>0?(t.indexOf("rv:"),!0):t.indexOf("Edge/")>0)}static isIOS(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream}static isAndroid(){return/(android)/i.test(navigator.userAgent)}static isTouchDevice(){return"ontouchstart"in window||navigator.maxTouchPoints>0}static appendChild(t,i){if(this.isElement(i))i.appendChild(t);else{if(!(i&&i.el&&i.el.nativeElement))throw"Cannot append "+i+" to "+t;i.el.nativeElement.appendChild(t)}}static removeChild(t,i){if(this.isElement(i))i.removeChild(t);else{if(!i.el||!i.el.nativeElement)throw"Cannot remove "+t+" from "+i;i.el.nativeElement.removeChild(t)}}static removeElement(t){"remove"in Element.prototype?t.remove():t.parentNode.removeChild(t)}static isElement(t){return"object"==typeof HTMLElement?t instanceof HTMLElement:t&&"object"==typeof t&&null!==t&&1===t.nodeType&&"string"==typeof t.nodeName}static calculateScrollbarWidth(t){if(t){let i=getComputedStyle(t);return t.offsetWidth-t.clientWidth-parseFloat(i.borderLeftWidth)-parseFloat(i.borderRightWidth)}{if(null!==this.calculatedScrollbarWidth)return this.calculatedScrollbarWidth;let i=document.createElement("div");i.className="p-scrollbar-measure",document.body.appendChild(i);let r=i.offsetWidth-i.clientWidth;return document.body.removeChild(i),this.calculatedScrollbarWidth=r,r}}static calculateScrollbarHeight(){if(null!==this.calculatedScrollbarHeight)return this.calculatedScrollbarHeight;let t=document.createElement("div");t.className="p-scrollbar-measure",document.body.appendChild(t);let i=t.offsetHeight-t.clientHeight;return document.body.removeChild(t),this.calculatedScrollbarWidth=i,i}static invokeElementMethod(t,i,r){t[i].apply(t,r)}static clearSelection(){if(window.getSelection)window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().rangeCount>0&&window.getSelection().getRangeAt(0).getClientRects().length>0&&window.getSelection().removeAllRanges();else if(document.selection&&document.selection.empty)try{document.selection.empty()}catch{}}static getBrowser(){if(!this.browser){let t=this.resolveUserAgent();this.browser={},t.browser&&(this.browser[t.browser]=!0,this.browser.version=t.version),this.browser.chrome?this.browser.webkit=!0:this.browser.webkit&&(this.browser.safari=!0)}return this.browser}static resolveUserAgent(){let t=navigator.userAgent.toLowerCase(),i=/(chrome)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[];return{browser:i[1]||"",version:i[2]||"0"}}static isInteger(t){return Number.isInteger?Number.isInteger(t):"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}static isHidden(t){return!t||null===t.offsetParent}static isVisible(t){return t&&null!=t.offsetParent}static isExist(t){return null!==t&&typeof t<"u"&&t.nodeName&&t.parentNode}static focus(t,i){t&&document.activeElement!==t&&t.focus(i)}static getFocusableElements(t){let i=n.find(t,'button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),\n                [href]:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),\n                input:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]), select:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),\n                textarea:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]), [tabIndex]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),\n                [contenteditable]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]):not(.p-disabled)'),r=[];for(let s of i)(s.offsetWidth||s.offsetHeight||s.getClientRects().length)&&r.push(s);return r}static getNextFocusableElement(t,i=!1){const r=n.getFocusableElements(t);let s=0;if(r&&r.length>0){const o=r.indexOf(r[0].ownerDocument.activeElement);i?s=-1==o||0===o?r.length-1:o-1:-1!=o&&o!==r.length-1&&(s=o+1)}return r[s]}static generateZIndex(){return this.zindex=this.zindex||999,++this.zindex}static getSelection(){return window.getSelection?window.getSelection().toString():document.getSelection?document.getSelection().toString():document.selection?document.selection.createRange().text:null}static getTargetElement(t,i){if(!t)return null;switch(t){case"document":return document;case"window":return window;case"@next":return i?.nextElementSibling;case"@prev":return i?.previousElementSibling;case"@parent":return i?.parentElement;case"@grandparent":return i?.parentElement.parentElement;default:const r=typeof t;if("string"===r)return document.querySelector(t);if("object"===r&&t.hasOwnProperty("nativeElement"))return this.isExist(t.nativeElement)?t.nativeElement:void 0;const o=(a=t)&&a.constructor&&a.call&&a.apply?t():t;return o&&9===o.nodeType||this.isExist(o)?o:null}var a}static isClient(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}static getAttribute(t,i){if(t){const r=t.getAttribute(i);return isNaN(r)?"true"===r||"false"===r?"true"===r:r:+r}}static calculateBodyScrollbarWidth(){return window.innerWidth-document.documentElement.offsetWidth}static blockBodyScroll(t="p-overflow-hidden"){document.body.style.setProperty("--scrollbar-width",this.calculateBodyScrollbarWidth()+"px"),this.addClass(document.body,t)}static unblockBodyScroll(t="p-overflow-hidden"){document.body.style.removeProperty("--scrollbar-width"),this.removeClass(document.body,t)}}return n})(),vse=(()=>{class n{document;platformId;renderer;el;zone;config;constructor(t,i,r,s,o,a){this.document=t,this.platformId=i,this.renderer=r,this.el=s,this.zone=o,this.config=a}animationListener;mouseDownListener;timeout;ngAfterViewInit(){(function fj(n){return n===rF})(this.platformId)&&this.config&&this.config.ripple&&this.zone.runOutsideAngular(()=>{this.create(),this.mouseDownListener=this.renderer.listen(this.el.nativeElement,"mousedown",this.onMouseDown.bind(this))})}onMouseDown(t){let i=this.getInk();if(!i||"none"===this.document.defaultView?.getComputedStyle(i,null).display)return;if(Ws.removeClass(i,"p-ink-active"),!Ws.getHeight(i)&&!Ws.getWidth(i)){let a=Math.max(Ws.getOuterWidth(this.el.nativeElement),Ws.getOuterHeight(this.el.nativeElement));i.style.height=a+"px",i.style.width=a+"px"}let r=Ws.getOffset(this.el.nativeElement),s=t.pageX-r.left+this.document.body.scrollTop-Ws.getWidth(i)/2,o=t.pageY-r.top+this.document.body.scrollLeft-Ws.getHeight(i)/2;this.renderer.setStyle(i,"top",o+"px"),this.renderer.setStyle(i,"left",s+"px"),Ws.addClass(i,"p-ink-active"),this.timeout=setTimeout(()=>{let a=this.getInk();a&&Ws.removeClass(a,"p-ink-active")},401)}getInk(){const t=this.el.nativeElement.children;for(let i=0;i<t.length;i++)if("string"==typeof t[i].className&&-1!==t[i].className.indexOf("p-ink"))return t[i];return null}resetInk(){let t=this.getInk();t&&Ws.removeClass(t,"p-ink-active")}onAnimationEnd(t){this.timeout&&clearTimeout(this.timeout),Ws.removeClass(t.currentTarget,"p-ink-active")}create(){let t=this.renderer.createElement("span");this.renderer.addClass(t,"p-ink"),this.renderer.appendChild(this.el.nativeElement,t),this.renderer.setAttribute(t,"aria-hidden","true"),this.renderer.setAttribute(t,"role","presentation"),this.animationListener||(this.animationListener=this.renderer.listen(t,"animationend",this.onAnimationEnd.bind(this)))}remove(){let t=this.getInk();t&&(this.mouseDownListener&&this.mouseDownListener(),this.animationListener&&this.animationListener(),this.mouseDownListener=null,this.animationListener=null,Ws.removeElement(t))}ngOnDestroy(){this.config&&this.config.ripple&&this.remove()}static \u0275fac=function(i){return new(i||n)(ye(qr),ye(Wa),ye(vi),ye(Tn),ye(In),ye(mse,8))};static \u0275dir=_t({type:n,selectors:[["","pRipple",""]],hostAttrs:[1,"p-ripple","p-element"]})}return n})(),Ese=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=tr({type:n});static \u0275inj=Vi({imports:[q_]})}return n})();function bse(n,e){1&n&&CT(0)}function Sse(n,e){if(1&n&&oo(0,"span",8),2&n){const t=wr(3);Ll("p-button-loading-icon pi-spin "+t.loadingIcon),rn("ngClass",t.iconClass()),hi("aria-hidden",!0)("data-pc-section","loadingicon")}}function wse(n,e){1&n&&oo(0,"SpinnerIcon",9),2&n&&(rn("styleClass",wr(3).spinnerIconClass())("spin",!0),hi("aria-hidden",!0)("data-pc-section","loadingicon"))}function Mse(n,e){if(1&n&&(Xc(0),li(1,Sse,1,5,"span",6),li(2,wse,1,4,"SpinnerIcon",7),Yc()),2&n){const t=wr(2);Rn(1),rn("ngIf",t.loadingIcon),Rn(1),rn("ngIf",!t.loadingIcon)}}function xse(n,e){}function Tse(n,e){1&n&&li(0,xse,0,0,"ng-template")}function Cse(n,e){if(1&n&&(sr(0,"span",10),li(1,Tse,1,0,null,1),Xi()),2&n){const t=wr(2);rn("ngClass",t.iconClass()),hi("aria-hidden",!0)("data-pc-section","loadingicon"),Rn(1),rn("ngTemplateOutlet",t.loadingIconTemplate)}}function Ase(n,e){if(1&n&&(Xc(0),li(1,Mse,3,2,"ng-container",2),li(2,Cse,2,4,"span",5),Yc()),2&n){const t=wr();Rn(1),rn("ngIf",!t.loadingIconTemplate),Rn(1),rn("ngIf",t.loadingIconTemplate)}}function Dse(n,e){if(1&n&&oo(0,"span",8),2&n){const t=wr(2);Ll(t.icon),rn("ngClass",t.iconClass()),hi("data-pc-section","icon")}}function Ise(n,e){}function Rse(n,e){1&n&&li(0,Ise,0,0,"ng-template",12),2&n&&rn("ngIf",!wr(3).icon)}function Pse(n,e){if(1&n&&(sr(0,"span",8),li(1,Rse,1,1,null,1),Xi()),2&n){const t=wr(2);rn("ngClass",t.iconClass()),hi("data-pc-section","icon"),Rn(1),rn("ngTemplateOutlet",t.iconTemplate)}}function Nse(n,e){if(1&n&&(Xc(0),li(1,Dse,1,4,"span",6),li(2,Pse,2,3,"span",11),Yc()),2&n){const t=wr();Rn(1),rn("ngIf",t.icon&&!t.iconTemplate),Rn(1),rn("ngIf",!t.icon&&t.iconTemplate)}}function Lse(n,e){if(1&n&&(sr(0,"span",13),vd(1),Xi()),2&n){const t=wr();hi("aria-hidden",t.icon&&!t.label)("data-pc-section","label"),Rn(1),P_(t.label)}}function Ose(n,e){if(1&n&&(sr(0,"span",8),vd(1),Xi()),2&n){const t=wr();Ll(t.badgeClass),rn("ngClass",t.badgeStyleClass()),hi("data-pc-section","badge"),Rn(1),P_(t.badge)}}const Fse=["*"];let TH=(()=>{class n{type="button";iconPos="left";icon;badge;label;disabled;loading=!1;loadingIcon;raised=!1;rounded=!1;text=!1;plain=!1;severity;outlined=!1;link=!1;size;style;styleClass;badgeClass;ariaLabel;onClick=new Xn;onFocus=new Xn;onBlur=new Xn;contentTemplate;loadingIconTemplate;iconTemplate;templates;spinnerIconClass(){return Object.entries(this.iconClass()).filter(([,t])=>!!t).reduce((t,[i])=>t+` ${i}`,"p-button-loading-icon")}iconClass(){return{"p-button-icon":!0,"p-button-icon-left":"left"===this.iconPos&&this.label,"p-button-icon-right":"right"===this.iconPos&&this.label,"p-button-icon-top":"top"===this.iconPos&&this.label,"p-button-icon-bottom":"bottom"===this.iconPos&&this.label}}buttonClass(){return{"p-button p-component":!0,"p-button-icon-only":(this.icon||this.iconTemplate||this.loadingIcon||this.loadingIconTemplate)&&!this.label,"p-button-vertical":("top"===this.iconPos||"bottom"===this.iconPos)&&this.label,"p-disabled":this.disabled||this.loading,"p-button-loading":this.loading,"p-button-loading-label-only":this.loading&&!this.icon&&this.label&&!this.loadingIcon&&"left"===this.iconPos,"p-button-link":this.link,[`p-button-${this.severity}`]:this.severity,"p-button-raised":this.raised,"p-button-rounded":this.rounded,"p-button-text":this.text,"p-button-outlined":this.outlined,"p-button-sm":"small"===this.size,"p-button-lg":"large"===this.size,"p-button-plain":this.plain}}ngAfterContentInit(){this.templates?.forEach(t=>{switch(t.getType()){case"content":default:this.contentTemplate=t.template;break;case"icon":this.iconTemplate=t.template;break;case"loadingicon":this.loadingIconTemplate=t.template}})}badgeStyleClass(){return{"p-badge p-component":!0,"p-badge-no-gutter":this.badge&&1===String(this.badge).length}}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=ss({type:n,selectors:[["p-button"]],contentQueries:function(i,r,s){if(1&i&&ZE(s,SH,4),2&i){let o;lp(o=cp())&&(r.templates=o)}},hostAttrs:[1,"p-element"],hostVars:2,hostBindings:function(i,r){2&i&&I_("p-disabled",r.disabled)},inputs:{type:"type",iconPos:"iconPos",icon:"icon",badge:"badge",label:"label",disabled:"disabled",loading:"loading",loadingIcon:"loadingIcon",raised:"raised",rounded:"rounded",text:"text",plain:"plain",severity:"severity",outlined:"outlined",link:"link",size:"size",style:"style",styleClass:"styleClass",badgeClass:"badgeClass",ariaLabel:"ariaLabel"},outputs:{onClick:"onClick",onFocus:"onFocus",onBlur:"onBlur"},ngContentSelectors:Fse,decls:7,vars:14,consts:[["pRipple","",3,"ngStyle","disabled","ngClass","click","focus","blur"],[4,"ngTemplateOutlet"],[4,"ngIf"],["class","p-button-label",4,"ngIf"],[3,"ngClass","class",4,"ngIf"],["class","p-button-loading-icon",3,"ngClass",4,"ngIf"],[3,"class","ngClass",4,"ngIf"],[3,"styleClass","spin",4,"ngIf"],[3,"ngClass"],[3,"styleClass","spin"],[1,"p-button-loading-icon",3,"ngClass"],[3,"ngClass",4,"ngIf"],[3,"ngIf"],[1,"p-button-label"]],template:function(i,r){1&i&&(DT(),sr(0,"button",0),or("click",function(o){return r.onClick.emit(o)})("focus",function(o){return r.onFocus.emit(o)})("blur",function(o){return r.onBlur.emit(o)}),IT(1),li(2,bse,1,0,"ng-container",1),li(3,Ase,3,2,"ng-container",2),li(4,Nse,3,2,"ng-container",2),li(5,Lse,2,3,"span",3),li(6,Ose,2,5,"span",4),Xi()),2&i&&(Ll(r.styleClass),rn("ngStyle",r.style)("disabled",r.disabled||r.loading)("ngClass",r.buttonClass()),hi("type",r.type)("aria-label",r.ariaLabel)("data-pc-name","button")("data-pc-section","root"),Rn(2),rn("ngTemplateOutlet",r.contentTemplate),Rn(1),rn("ngIf",r.loading),Rn(1),rn("ngIf",!r.loading),Rn(1),rn("ngIf",!r.contentTemplate&&r.label),Rn(1),rn("ngIf",!r.contentTemplate&&r.badge))},dependencies:function(){return[OC,FC,VC,BC,vse,xH]},encapsulation:2,changeDetection:0})}return n})(),kse=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=tr({type:n});static \u0275inj=Vi({imports:[q_,Ese,_I,xH,_I]})}return n})();const Use=["rendererContainer"];let Bse=(()=>{class n{constructor(t,i){this.signalRService=t,this.dalService=i,this.interactionObjects=[],this.objectUnselectedColor="red",this.objectSelectedColor="blue",this.allItems={}}ngOnInit(){this.signalRService.startConnection(),this.signalRService.hubConnection.on("GameUpdated",t=>{console.log("GameUpdated",t),this.updateGame(t)})}ngAfterViewInit(){this.initThree()}updateGame(t){(0,Mw.forEach)(t.items,i=>{console.log(i),this.updateItem(i,null)})}updateItem(t,i){this.allItems[t.id]?this.updateItemPosition(this.allItems[t.id],t.position):this.createItem(t,i),i=this.allItems[t.id].mesh,(0,Mw.forEach)(t.items,r=>{this.updateItem(r,i)})}deepEqual(t,i){const r=Object.keys(t),s=Object.keys(i);if(r.length!==s.length)return!1;for(const o of r){const a=t[o],l=i[o],c=this.isObject(a)&&this.isObject(l);if(c&&!this.deepEqual(a,l)||!c&&a!==l)return!1}return!0}isObject(t){return null!=t&&"object"==typeof t}updateItemPosition(t,i){t.position=new rie(i.x,i.y,i.z),this.deepEqual(i,t.mesh.position)||new VV(t.mesh.position).to(i,300).start()}resizeCanvasToDisplaySize(){const t=this.renderer.domElement,i=t.clientWidth,r=t.clientHeight;this.renderer.setSize(i,r,!1),this.camera.aspect=i/r,this.camera.updateProjectionMatrix()}initThree(){this.scene=new gB,this.scene.background=new je(16777215),this.camera=new Tr(75,this.rendererContainer.nativeElement.clientWidth/this.rendererContainer.nativeElement.clientHeight,.1,1e3),this.camera.position.set(-1.8,.6,2.7),this.renderer=new mB({antialias:!0}),this.renderer.xr.enabled=!0,this.renderer.setSize(this.rendererContainer.nativeElement.clientWidth,this.rendererContainer.nativeElement.clientHeight),this.rendererContainer.nativeElement.appendChild(this.renderer.domElement),this.orbitControls=new tie(this.camera,this.renderer.domElement),this.orbitControls.addEventListener("change",()=>{this.renderer.render(this.scene,this.camera)}),this.orbitControls.enableZoom=!0,this.orbitControls.update(),this.interactionManager=new class{renderer;camera;domElement;bindEventsOnBodyElement;autoAdd;scene;mouse;supportsPointerEvents;interactiveObjects;closestObject;raycaster;treatTouchEventsAsMouseEvents;constructor(n,e,t,i){this.renderer=n,this.camera=e,this.domElement=t,this.bindEventsOnBodyElement=!(i&&typeof i.bindEventsOnBodyElement<"u")||i.bindEventsOnBodyElement,this.scene=i&&typeof i.scene<"u"?i.scene:null,this.scene&&(this.scene.onBeforeRender=()=>{this.autoAdd&&null!==this.scene&&this.scene.traverse(r=>{this.add(r),r.addEventListener("removed",s=>{this.remove(s.target)})}),this.update()}),this.autoAdd=!!(i&&typeof i.autoAdd<"u")&&i.autoAdd,this.autoAdd&&null===this.scene&&console.error("Attention: Options.scene needs to be set when using options.autoAdd"),this.mouse=new he(-1,1),this.supportsPointerEvents=!!window.PointerEvent,this.interactiveObjects=[],this.closestObject=null,this.raycaster=new SV,t.addEventListener("click",this.onMouseClick),this.supportsPointerEvents&&(this.bindEventsOnBodyElement?t.ownerDocument.addEventListener("pointermove",this.onDocumentPointerMove):t.addEventListener("pointermove",this.onDocumentPointerMove),t.addEventListener("pointerdown",this.onPointerDown),t.addEventListener("pointerup",this.onPointerUp)),this.bindEventsOnBodyElement?t.ownerDocument.addEventListener("mousemove",this.onDocumentMouseMove):t.addEventListener("mousemove",this.onDocumentMouseMove),t.addEventListener("mousedown",this.onMouseDown),t.addEventListener("mouseup",this.onMouseUp),t.addEventListener("touchstart",this.onTouchStart,{passive:!0}),t.addEventListener("touchmove",this.onTouchMove,{passive:!0}),t.addEventListener("touchend",this.onTouchEnd,{passive:!0}),this.treatTouchEventsAsMouseEvents=!0}dispose=()=>{this.domElement.removeEventListener("click",this.onMouseClick),this.supportsPointerEvents&&(this.bindEventsOnBodyElement?this.domElement.ownerDocument.removeEventListener("pointermove",this.onDocumentPointerMove):this.domElement.removeEventListener("pointermove",this.onDocumentPointerMove),this.domElement.removeEventListener("pointerdown",this.onPointerDown),this.domElement.removeEventListener("pointerup",this.onPointerUp)),this.bindEventsOnBodyElement?this.domElement.ownerDocument.removeEventListener("mousemove",this.onDocumentMouseMove):this.domElement.removeEventListener("mousemove",this.onDocumentMouseMove),this.domElement.removeEventListener("mousedown",this.onMouseDown),this.domElement.removeEventListener("mouseup",this.onMouseUp),this.domElement.removeEventListener("touchstart",this.onTouchStart),this.domElement.removeEventListener("touchmove",this.onTouchMove),this.domElement.removeEventListener("touchend",this.onTouchEnd)};add=(n,e=[])=>{if(n&&!this.interactiveObjects.find(t=>t.target===n))if(e.length>0)e.forEach(t=>{let i=n.getObjectByName(t);if(i){let r=new kV(i,t);this.interactiveObjects.push(r)}});else{let t=new kV(n,n.name);this.interactiveObjects.push(t)}};remove=(n,e=[])=>{!n||(e.length>0?e.forEach(t=>{let i=n.getObjectByName(t);i&&(this.interactiveObjects=this.interactiveObjects.filter(r=>r.target!==i))}):this.interactiveObjects=this.interactiveObjects.filter(t=>t.target!==n))};update=()=>{this.raycaster.setFromCamera(this.mouse,this.camera),this.interactiveObjects.forEach(i=>{i.target&&this.checkIntersection(i)}),this.interactiveObjects.sort(function(i,r){return i.distance-r.distance});let e,t,n=this.interactiveObjects.find(i=>i.intersected)??null;if(n!=this.closestObject){if(this.closestObject){let i=new Gs("mouseout");this.dispatch(this.closestObject,i)}if(n){let i=new Gs("mouseover");this.dispatch(n,i)}this.closestObject=n}this.interactiveObjects.forEach(i=>{!i.intersected&&i.wasIntersected&&(e||(e=new Gs("mouseleave")),this.dispatch(i,e))}),this.interactiveObjects.forEach(i=>{i.intersected&&!i.wasIntersected&&(t||(t=new Gs("mouseenter")),this.dispatch(i,t))})};checkIntersection=n=>{let e=this.raycaster.intersectObjects([n.target],!0);if(n.wasIntersected=n.intersected,e.length>0){let t=e[0].distance;e.forEach(i=>{i.distance<t&&(t=i.distance)}),n.intersected=!0,n.distance=t}else n.intersected=!1};onDocumentMouseMove=n=>{this.mapPositionToPoint(this.mouse,n.clientX,n.clientY);let e=new Gs("mousemove",n);this.interactiveObjects.forEach(t=>{this.dispatch(t,e)})};onDocumentPointerMove=n=>{this.mapPositionToPoint(this.mouse,n.clientX,n.clientY);let e=new Gs("pointermove",n);this.interactiveObjects.forEach(t=>{this.dispatch(t,e)})};onTouchMove=n=>{n.touches.length>0&&this.mapPositionToPoint(this.mouse,n.touches[0].clientX,n.touches[0].clientY);let e=new Gs(this.treatTouchEventsAsMouseEvents?"mousemove":"touchmove",n);this.interactiveObjects.forEach(t=>{this.dispatch(t,e)})};onMouseClick=n=>{this.update();let e=new Gs("click",n);this.interactiveObjects.forEach(t=>{t.intersected&&this.dispatch(t,e)})};onMouseDown=n=>{this.mapPositionToPoint(this.mouse,n.clientX,n.clientY),this.update();let e=new Gs("mousedown",n);this.interactiveObjects.forEach(t=>{t.intersected&&this.dispatch(t,e)})};onPointerDown=n=>{this.mapPositionToPoint(this.mouse,n.clientX,n.clientY),this.update();let e=new Gs("pointerdown",n);this.interactiveObjects.forEach(t=>{t.intersected&&this.dispatch(t,e)})};onTouchStart=n=>{n.touches.length>0&&this.mapPositionToPoint(this.mouse,n.touches[0].clientX,n.touches[0].clientY),this.update();let e=new Gs(this.treatTouchEventsAsMouseEvents?"mousedown":"touchstart",n);this.interactiveObjects.forEach(t=>{t.intersected&&this.dispatch(t,e)})};onMouseUp=n=>{let e=new Gs("mouseup",n);this.interactiveObjects.forEach(t=>{this.dispatch(t,e)})};onPointerUp=n=>{let e=new Gs("pointerup",n);this.interactiveObjects.forEach(t=>{this.dispatch(t,e)})};onTouchEnd=n=>{n.touches.length>0&&this.mapPositionToPoint(this.mouse,n.touches[0].clientX,n.touches[0].clientY),this.update();let e=new Gs(this.treatTouchEventsAsMouseEvents?"mouseup":"touchend",n);this.interactiveObjects.forEach(t=>{this.dispatch(t,e)})};dispatch=(n,e)=>{n.target&&!e.cancelBubble&&(e.coords=this.mouse,e.distance=n.distance,e.intersected=n.intersected,n.target.dispatchEvent(e))};mapPositionToPoint=(n,e,t)=>{let i=this.renderer.domElement.getBoundingClientRect();n.x=(e-i.left)/i.width*2-1,n.y=-(t-i.top)/i.height*2+1}}(this.renderer,this.camera,this.renderer.domElement);const t=new hV(16777215);this.scene.add(t),this.renderer.setAnimationLoop(()=>{this.controllers&&this.controllers.forEach(i=>{this.handleController(i)}),this.orbitControls.update(),this.interactionManager.update(),this.renderer.render(this.scene,this.camera),HV()}),document.body.appendChild(UV.createButton(this.renderer)),this.controllers=this.buildControllers(),this.controllers.forEach(i=>{i.addEventListener("selectstart",this.onSelectStart),i.addEventListener("selectend",this.onSelectEnd)})}onSelectStart(t){console.log("onSelectStart",t)}onSelectEnd(t){console.log("onSelectEnd",t)}buildControllers(){const t=new nre,i=(new en).setFromPoints([new L(0,0,0),new L(0,0,-1)]),r=new Eu(i);r.scale.z=10;const s=[];for(let o=0;o<2;o++){const a=this.renderer.xr.getController(o);a.add(r.clone()),a.userData.selectPressed=!1,a.userData.selectPressedPrev=!1,this.scene.add(a),s.push(a);const l=this.renderer.xr.getControllerGrip(o);l.add(t.createControllerModel(l)),this.scene.add(l)}return s}handleController(t){if(t.userData.selectPressed)if(t.userData.selectPressedPrev){if(this.selectedObject){const i=t.getWorldDirection(new L).multiplyScalar(this.selectedObjectDistance).negate();this.selectedObject.position.copy(t.position.clone().add(i))}}else{t.children[0].scale.z=10;const i=new At;i.extractRotation(t.matrixWorld);const r=new SV;r.ray.origin.setFromMatrixPosition(t.matrixWorld),r.ray.direction.set(0,0,-1).applyMatrix4(i);const s=r.intersectObjects(this.interactionObjects);s.length>0&&(t.children[0].scale.z=s[0].distance,this.selectedObject=s[0].object,this.selectedObject.material.color=this.objectSelectedColor,this.selectedObjectDistance=this.selectedObject.position.distanceTo(t.position))}else t.userData.selectPressedPrev&&(t.children[0].scale.z=10,null!=this.selectedObject&&(this.selectedObject.material.color=this.objectUnselectedColor,this.selectedObject=null));t.userData.selectPressedPrev=t.userData.selectPressed}randomIntFromInterval(t,i){return Math.random()*(i-t+1)+t}createItem(t,i){const r=LD_randInt(0,16777215),s=new jd(.1,.1,.1),o=new Vs({color:r}),a=new xr(s,o);a.position.set(t.position.x,t.position.y,t.position.z),i?i.add(a):this.scene.add(a);const l=this.gameData.players[0].id;a.userData.ItemData=t;let c=t.clickActions[l]||t.clickActions[""];c&&this.addClickAction(a,t,c),(0,Mw.forEach)(t.items,d=>{this.createItem(d,a)}),t.mesh=a,this.allItems[t.id]=t}addClickAction(t,i,r){t.addEventListener("click",s=>{s.stopPropagation(),console.log(t),this.signalRService.executeAction(this.gameData.id,this.playerData.id,i.id,r,"",0,0)}),t.addEventListener("mouseover",s=>{s.target.userData.c=s.target.material.clone().color,s.target.material.color.set(16711680),document.body.style.cursor="pointer",this.orbitControls.enabled=!1}),t.addEventListener("mouseout",s=>{let o=s.target.userData.c;s.target.material.color.set(o.r,o.g,o.b),document.body.style.cursor="default",this.orbitControls.enabled=!0}),this.interactionManager.add(t)}createGame(){this.dalService.createGame().subscribe(t=>{this.loadGame(t)})}loadGame(t){console.log(t,iie().startOf("month").add(1,"day").set("year",2018).format("YYYY-MM-DD HH:mm:ss")),this.gameData=t,this.playerData=this.gameData.players[0],(0,Mw.forEach)(t.items,i=>{this.createItem(i,null)})}static#e=this.\u0275fac=function(i){return new(i||n)(ye(kre),ye(fse))};static#t=this.\u0275cmp=ss({type:n,selectors:[["app-game-play"]],viewQuery:function(i,r){if(1&i&&eC(Use,7),2&i){let s;lp(s=cp())&&(r.rendererContainer=s.first)}},decls:6,vars:0,consts:[[1,"main-div"],[2,"flex-shrink","0"],[3,"onClick"],[2,"flex-grow","1","border","1px dashed red"],["rendererContainer",""]],template:function(i,r){1&i&&(sr(0,"div",0)(1,"div",1)(2,"p-button",2),or("onClick",function(){return r.createGame()}),vd(3,"create game"),Xi()(),oo(4,"div",3,4),Xi())},dependencies:[TH],styles:[".main-div[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;height:100%;background:yellow}"]})}return n})(),CH=(()=>{class n{constructor(t){this.router=t}canActivate(){return!0}static#e=this.\u0275fac=function(i){return new(i||n)(Ne(ks))};static#t=this.\u0275prov=tt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const Vse=[{path:"",redirectTo:"/home",pathMatch:"full"},{path:"home",component:(()=>{class n{constructor(t){this.router=t,this.usernameModel=""}login(){this.router.navigateByUrl("/game-play/123")}static#e=this.\u0275fac=function(i){return new(i||n)(ye(ks))};static#t=this.\u0275cmp=ss({type:n,selectors:[["app-home-view"]],decls:5,vars:1,consts:[[3,"ngModel","ngModelChange"],[3,"onClick"]],template:function(i,r){1&i&&(sr(0,"div"),vd(1,"MG X"),Xi(),sr(2,"input",0),or("ngModelChange",function(o){return r.usernameModel=o}),Xi(),sr(3,"p-button",1),or("onClick",function(){return r.login()}),vd(4,"Login"),Xi()),2&i&&(Rn(2),rn("ngModel",r.usernameModel))},dependencies:[Lb,B2,kA,TH]})}return n})(),canActivate:[CH]},{path:"game-play/:id",component:Bse,canActivate:[CH]},{path:"**",redirectTo:"/home"}];let Hse=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=tr({type:n});static#n=this.\u0275inj=Vi({imports:[SU.forRoot(Vse),SU]})}return n})(),zse=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=ss({type:n,selectors:[["app-root"]],decls:1,vars:0,template:function(i,r){1&i&&oo(0,"router-outlet")},dependencies:[oD]})}return n})(),AH=(()=>{class n extends MH{static \u0275fac=function(){let t;return function(r){return(t||(t=_i(n)))(r||n)}}();static \u0275cmp=ss({type:n,selectors:[["CheckIcon"]],standalone:!0,features:[bn,U_],decls:2,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M4.86199 11.5948C4.78717 11.5923 4.71366 11.5745 4.64596 11.5426C4.57826 11.5107 4.51779 11.4652 4.46827 11.4091L0.753985 7.69483C0.683167 7.64891 0.623706 7.58751 0.580092 7.51525C0.536478 7.44299 0.509851 7.36177 0.502221 7.27771C0.49459 7.19366 0.506156 7.10897 0.536046 7.03004C0.565935 6.95111 0.613367 6.88 0.674759 6.82208C0.736151 6.76416 0.8099 6.72095 0.890436 6.69571C0.970973 6.67046 1.05619 6.66385 1.13966 6.67635C1.22313 6.68886 1.30266 6.72017 1.37226 6.76792C1.44186 6.81567 1.4997 6.8786 1.54141 6.95197L4.86199 10.2503L12.6397 2.49483C12.7444 2.42694 12.8689 2.39617 12.9932 2.40745C13.1174 2.41873 13.2343 2.47141 13.3251 2.55705C13.4159 2.64268 13.4753 2.75632 13.4938 2.87973C13.5123 3.00315 13.4888 3.1292 13.4271 3.23768L5.2557 11.4091C5.20618 11.4652 5.14571 11.5107 5.07801 11.5426C5.01031 11.5745 4.9368 11.5923 4.86199 11.5948Z","fill","currentColor"]],template:function(i,r){1&i&&(nf(),sr(0,"svg",0),oo(1,"path",1),Xi()),2&i&&(Ll(r.getClassNames()),hi("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role))},encapsulation:2})}return n})();const Gse=["cb"];function Wse(n,e){1&n&&oo(0,"span",10),2&n&&rn("ngClass",wr(3).checkboxIcon)}function $se(n,e){1&n&&oo(0,"CheckIcon",11),2&n&&rn("styleClass","p-checkbox-icon")}function jse(n,e){if(1&n&&(Xc(0),li(1,Wse,1,1,"span",8),li(2,$se,1,1,"CheckIcon",9),Yc()),2&n){const t=wr(2);Rn(1),rn("ngIf",t.checkboxIcon),Rn(1),rn("ngIf",!t.checkboxIcon)}}function qse(n,e){}function Xse(n,e){1&n&&li(0,qse,0,0,"ng-template")}function Yse(n,e){if(1&n&&(sr(0,"span",12),li(1,Xse,1,0,null,13),Xi()),2&n){const t=wr(2);Rn(1),rn("ngTemplateOutlet",t.checkboxIconTemplate)}}function Kse(n,e){if(1&n&&(Xc(0),li(1,jse,3,2,"ng-container",5),li(2,Yse,2,1,"span",7),Yc()),2&n){const t=wr();Rn(1),rn("ngIf",!t.checkboxIconTemplate),Rn(1),rn("ngIf",t.checkboxIconTemplate)}}const Zse=function(n,e,t){return{"p-checkbox-label":!0,"p-checkbox-label-active":n,"p-disabled":e,"p-checkbox-label-focus":t}};function Jse(n,e){if(1&n){const t=AT();sr(0,"label",14),or("click",function(r){Qh(t);const s=wr(),o=xT(3);return xc(s.onClick(r,o,!0))}),vd(1),Xi()}if(2&n){const t=wr();Ll(t.labelStyleClass),rn("ngClass",XE(5,Zse,t.checked(),t.disabled,t.focused)),hi("for",t.inputId),Rn(1),P_(t.label)}}const Qse=function(n,e,t){return{"p-checkbox p-component":!0,"p-checkbox-checked":n,"p-checkbox-disabled":e,"p-checkbox-focused":t}},eoe=function(n,e,t){return{"p-highlight":n,"p-disabled":e,"p-focus":t}},toe={provide:ha,useExisting:vn(()=>noe),multi:!0};let noe=(()=>{class n{cd;value;name;disabled;binary;label;ariaLabelledBy;ariaLabel;tabindex;inputId;style;styleClass;labelStyleClass;formControl;checkboxIcon;readonly;required;trueValue=!0;falseValue=!1;onChange=new Xn;inputViewChild;templates;checkboxIconTemplate;model;onModelChange=()=>{};onModelTouched=()=>{};focused=!1;constructor(t){this.cd=t}ngAfterContentInit(){this.templates.forEach(t=>{"icon"===t.getType()&&(this.checkboxIconTemplate=t.template)})}onClick(t,i,r){t.preventDefault(),!this.disabled&&!this.readonly&&(this.updateModel(t),r&&i.focus())}updateModel(t){let i;this.binary?(i=this.checked()?this.falseValue:this.trueValue,this.model=i,this.onModelChange(i)):(i=this.checked()?this.model.filter(r=>!lv.equals(r,this.value)):this.model?[...this.model,this.value]:[this.value],this.onModelChange(i),this.model=i,this.formControl&&this.formControl.setValue(i)),this.onChange.emit({checked:i,originalEvent:t})}handleChange(t){this.readonly||this.updateModel(t)}onFocus(){this.focused=!0}onBlur(){this.focused=!1,this.onModelTouched()}focus(){this.inputViewChild?.nativeElement.focus()}writeValue(t){this.model=t,this.cd.markForCheck()}registerOnChange(t){this.onModelChange=t}registerOnTouched(t){this.onModelTouched=t}setDisabledState(t){this.disabled=t,this.cd.markForCheck()}checked(){return this.binary?this.model===this.trueValue:lv.contains(this.value,this.model)}static \u0275fac=function(i){return new(i||n)(ye(G_))};static \u0275cmp=ss({type:n,selectors:[["p-checkbox"]],contentQueries:function(i,r,s){if(1&i&&ZE(s,SH,4),2&i){let o;lp(o=cp())&&(r.templates=o)}},viewQuery:function(i,r){if(1&i&&eC(Gse,5),2&i){let s;lp(s=cp())&&(r.inputViewChild=s.first)}},hostAttrs:[1,"p-element"],inputs:{value:"value",name:"name",disabled:"disabled",binary:"binary",label:"label",ariaLabelledBy:"ariaLabelledBy",ariaLabel:"ariaLabel",tabindex:"tabindex",inputId:"inputId",style:"style",styleClass:"styleClass",labelStyleClass:"labelStyleClass",formControl:"formControl",checkboxIcon:"checkboxIcon",readonly:"readonly",required:"required",trueValue:"trueValue",falseValue:"falseValue"},outputs:{onChange:"onChange"},features:[ii([toe])],decls:7,vars:26,consts:[[3,"ngStyle","ngClass"],[1,"p-hidden-accessible"],["type","checkbox",3,"readonly","value","checked","disabled","focus","blur","change"],["cb",""],[1,"p-checkbox-box",3,"ngClass","click"],[4,"ngIf"],[3,"class","ngClass","click",4,"ngIf"],["class","p-checkbox-icon",4,"ngIf"],["class","p-checkbox-icon",3,"ngClass",4,"ngIf"],[3,"styleClass",4,"ngIf"],[1,"p-checkbox-icon",3,"ngClass"],[3,"styleClass"],[1,"p-checkbox-icon"],[4,"ngTemplateOutlet"],[3,"ngClass","click"]],template:function(i,r){if(1&i){const s=AT();sr(0,"div",0)(1,"div",1)(2,"input",2,3),or("focus",function(){return r.onFocus()})("blur",function(){return r.onBlur()})("change",function(a){return r.handleChange(a)}),Xi()(),sr(4,"div",4),or("click",function(a){Qh(s);const l=xT(3);return xc(r.onClick(a,l,!0))}),li(5,Kse,3,2,"ng-container",5),Xi()(),li(6,Jse,2,9,"label",6)}2&i&&(Ll(r.styleClass),rn("ngStyle",r.style)("ngClass",XE(18,Qse,r.checked(),r.disabled,r.focused)),Rn(2),rn("readonly",r.readonly)("value",r.value)("checked",r.checked())("disabled",r.disabled),hi("id",r.inputId)("name",r.name)("tabindex",r.tabindex)("aria-labelledby",r.ariaLabelledBy)("aria-label",r.ariaLabel)("aria-checked",r.checked())("required",r.required),Rn(2),rn("ngClass",XE(22,eoe,r.checked(),r.disabled,r.focused)),Rn(1),rn("ngIf",r.checked()),Rn(1),rn("ngIf",r.label))},dependencies:function(){return[OC,FC,VC,BC,AH]},styles:["@layer primeng{.p-checkbox{display:inline-flex;cursor:pointer;-webkit-user-select:none;user-select:none;vertical-align:bottom;position:relative}.p-checkbox-disabled{cursor:default!important;pointer-events:none}.p-checkbox-box{display:flex;justify-content:center;align-items:center}p-checkbox{display:inline-flex;vertical-align:bottom;align-items:center}.p-checkbox-label{line-height:1}}\n"],encapsulation:2,changeDetection:0})}return n})(),ioe=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=tr({type:n});static \u0275inj=Vi({imports:[q_,AH,_I]})}return n})(),roe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=tr({type:n,bootstrap:[zse]});static#n=this.\u0275inj=Vi({imports:[wF,l7,pq,Hse,kse,ioe,ase]})}return n})();s6().bootstrapModule(roe).catch(n=>console.error(n))},304:function($s){$s.exports=function(){"use strict";var B="millisecond",vo="second",ws="minute",mi="hour",ai="day",ll="week",dr="month",Eo="quarter",hr="year",fr="date",cl="Invalid Date",Ea=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,ba=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,oc={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(yt){var Ke=["th","st","nd","rd"],Be=yt%100;return"["+yt+(Ke[(Be-20)%10]||Ke[Be]||Ke[0])+"]"}},Ui=function(yt,Ke,Be){var Qe=String(yt);return!Qe||Qe.length>=Ke?yt:""+Array(Ke+1-Qe.length).join(Be)+yt},Dr={s:Ui,z:function(yt){var Ke=-yt.utcOffset(),Be=Math.abs(Ke),Qe=Math.floor(Be/60),Xe=Be%60;return(Ke<=0?"+":"-")+Ui(Qe,2,"0")+":"+Ui(Xe,2,"0")},m:function yt(Ke,Be){if(Ke.date()<Be.date())return-yt(Be,Ke);var Qe=12*(Be.year()-Ke.year())+(Be.month()-Ke.month()),Xe=Ke.clone().add(Qe,dr),It=Be-Xe<0,qe=Ke.clone().add(Qe+(It?-1:1),dr);return+(-(Qe+(Be-Xe)/(It?Xe-qe:qe-Xe))||0)},a:function(yt){return yt<0?Math.ceil(yt)||0:Math.floor(yt)},p:function(yt){return{M:dr,y:hr,w:ll,d:ai,D:fr,h:mi,m:ws,s:vo,ms:B,Q:Eo}[yt]||String(yt||"").toLowerCase().replace(/s$/,"")},u:function(yt){return void 0===yt}},js="en",Bi={};Bi[js]=oc;var qs="$isDayjsObject",Br=function(yt){return yt instanceof Xs||!(!yt||!yt[qs])},es=function yt(Ke,Be,Qe){var Xe;if(!Ke)return js;if("string"==typeof Ke){var It=Ke.toLowerCase();Bi[It]&&(Xe=It),Be&&(Bi[It]=Be,Xe=It);var qe=Ke.split("-");if(!Xe&&qe.length>1)return yt(qe[0])}else{var tn=Ke.name;Bi[tn]=Ke,Xe=tn}return!Qe&&Xe&&(js=Xe),Xe||!Qe&&js},Mn=function(yt,Ke){if(Br(yt))return yt.clone();var Be="object"==typeof Ke?Ke:{};return Be.date=yt,Be.args=arguments,new Xs(Be)},qt=Dr;qt.l=es,qt.i=Br,qt.w=function(yt,Ke){return Mn(yt,{locale:Ke.$L,utc:Ke.$u,x:Ke.$x,$offset:Ke.$offset})};var Xs=function(){function yt(Be){this.$L=es(Be.locale,null,!0),this.parse(Be),this.$x=this.$x||Be.x||{},this[qs]=!0}var Ke=yt.prototype;return Ke.parse=function(Be){this.$d=function(Qe){var Xe=Qe.date,It=Qe.utc;if(null===Xe)return new Date(NaN);if(qt.u(Xe))return new Date;if(Xe instanceof Date)return new Date(Xe);if("string"==typeof Xe&&!/Z$/i.test(Xe)){var qe=Xe.match(Ea);if(qe){var tn=qe[2]-1||0,Jn=(qe[7]||"0").substring(0,3);return It?new Date(Date.UTC(qe[1],tn,qe[3]||1,qe[4]||0,qe[5]||0,qe[6]||0,Jn)):new Date(qe[1],tn,qe[3]||1,qe[4]||0,qe[5]||0,qe[6]||0,Jn)}}return new Date(Xe)}(Be),this.init()},Ke.init=function(){var Be=this.$d;this.$y=Be.getFullYear(),this.$M=Be.getMonth(),this.$D=Be.getDate(),this.$W=Be.getDay(),this.$H=Be.getHours(),this.$m=Be.getMinutes(),this.$s=Be.getSeconds(),this.$ms=Be.getMilliseconds()},Ke.$utils=function(){return qt},Ke.isValid=function(){return this.$d.toString()!==cl},Ke.isSame=function(Be,Qe){var Xe=Mn(Be);return this.startOf(Qe)<=Xe&&Xe<=this.endOf(Qe)},Ke.isAfter=function(Be,Qe){return Mn(Be)<this.startOf(Qe)},Ke.isBefore=function(Be,Qe){return this.endOf(Qe)<Mn(Be)},Ke.$g=function(Be,Qe,Xe){return qt.u(Be)?this[Qe]:this.set(Xe,Be)},Ke.unix=function(){return Math.floor(this.valueOf()/1e3)},Ke.valueOf=function(){return this.$d.getTime()},Ke.startOf=function(Be,Qe){var Xe=this,It=!!qt.u(Qe)||Qe,qe=qt.p(Be),tn=function(mn,pr){var Rt=qt.w(Xe.$u?Date.UTC(Xe.$y,pr,mn):new Date(Xe.$y,pr,mn),Xe);return It?Rt:Rt.endOf(ai)},Jn=function(mn,pr){return qt.w(Xe.toDate()[mn].apply(Xe.toDate("s"),(It?[0,0,0,0]:[23,59,59,999]).slice(pr)),Xe)},Qn=this.$W,An=this.$M,Un=this.$D,Go="set"+(this.$u?"UTC":"");switch(qe){case hr:return It?tn(1,0):tn(31,11);case dr:return It?tn(1,An):tn(0,An+1);case ll:var bo=this.$locale().weekStart||0,gn=(Qn<bo?Qn+7:Qn)-bo;return tn(It?Un-gn:Un+(6-gn),An);case ai:case fr:return Jn(Go+"Hours",0);case mi:return Jn(Go+"Minutes",1);case ws:return Jn(Go+"Seconds",2);case vo:return Jn(Go+"Milliseconds",3);default:return this.clone()}},Ke.endOf=function(Be){return this.startOf(Be,!1)},Ke.$set=function(Be,Qe){var Xe,It=qt.p(Be),qe="set"+(this.$u?"UTC":""),tn=(Xe={},Xe[ai]=qe+"Date",Xe[fr]=qe+"Date",Xe[dr]=qe+"Month",Xe[hr]=qe+"FullYear",Xe[mi]=qe+"Hours",Xe[ws]=qe+"Minutes",Xe[vo]=qe+"Seconds",Xe[B]=qe+"Milliseconds",Xe)[It],Jn=It===ai?this.$D+(Qe-this.$W):Qe;if(It===dr||It===hr){var Qn=this.clone().set(fr,1);Qn.$d[tn](Jn),Qn.init(),this.$d=Qn.set(fr,Math.min(this.$D,Qn.daysInMonth())).$d}else tn&&this.$d[tn](Jn);return this.init(),this},Ke.set=function(Be,Qe){return this.clone().$set(Be,Qe)},Ke.get=function(Be){return this[qt.p(Be)]()},Ke.add=function(Be,Qe){var Xe,It=this;Be=Number(Be);var qe=qt.p(Qe),tn=function(An){var Un=Mn(It);return qt.w(Un.date(Un.date()+Math.round(An*Be)),It)};if(qe===dr)return this.set(dr,this.$M+Be);if(qe===hr)return this.set(hr,this.$y+Be);if(qe===ai)return tn(1);if(qe===ll)return tn(7);var Jn=(Xe={},Xe[ws]=6e4,Xe[mi]=36e5,Xe[vo]=1e3,Xe)[qe]||1,Qn=this.$d.getTime()+Be*Jn;return qt.w(Qn,this)},Ke.subtract=function(Be,Qe){return this.add(-1*Be,Qe)},Ke.format=function(Be){var Qe=this,Xe=this.$locale();if(!this.isValid())return Xe.invalidDate||cl;var It=Be||"YYYY-MM-DDTHH:mm:ssZ",qe=qt.z(this),tn=this.$H,Jn=this.$m,Qn=this.$M,An=Xe.weekdays,Un=Xe.months,bo=function(pr,Rt,ts,ac){return pr&&(pr[Rt]||pr(Qe,It))||ts[Rt].slice(0,ac)},gn=function(pr){return qt.s(tn%12||12,pr,"0")},mn=Xe.meridiem||function(pr,Rt,ts){var ac=pr<12?"AM":"PM";return ts?ac.toLowerCase():ac};return It.replace(ba,function(pr,Rt){return Rt||function(ts){switch(ts){case"YY":return String(Qe.$y).slice(-2);case"YYYY":return qt.s(Qe.$y,4,"0");case"M":return Qn+1;case"MM":return qt.s(Qn+1,2,"0");case"MMM":return bo(Xe.monthsShort,Qn,Un,3);case"MMMM":return bo(Un,Qn);case"D":return Qe.$D;case"DD":return qt.s(Qe.$D,2,"0");case"d":return String(Qe.$W);case"dd":return bo(Xe.weekdaysMin,Qe.$W,An,2);case"ddd":return bo(Xe.weekdaysShort,Qe.$W,An,3);case"dddd":return An[Qe.$W];case"H":return String(tn);case"HH":return qt.s(tn,2,"0");case"h":return gn(1);case"hh":return gn(2);case"a":return mn(tn,Jn,!0);case"A":return mn(tn,Jn,!1);case"m":return String(Jn);case"mm":return qt.s(Jn,2,"0");case"s":return String(Qe.$s);case"ss":return qt.s(Qe.$s,2,"0");case"SSS":return qt.s(Qe.$ms,3,"0");case"Z":return qe}return null}(pr)||qe.replace(":","")})},Ke.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},Ke.diff=function(Be,Qe,Xe){var It,qe=this,tn=qt.p(Qe),Jn=Mn(Be),Qn=6e4*(Jn.utcOffset()-this.utcOffset()),An=this-Jn,Un=function(){return qt.m(qe,Jn)};switch(tn){case hr:It=Un()/12;break;case dr:It=Un();break;case Eo:It=Un()/3;break;case ll:It=(An-Qn)/6048e5;break;case ai:It=(An-Qn)/864e5;break;case mi:It=An/36e5;break;case ws:It=An/6e4;break;case vo:It=An/1e3;break;default:It=An}return Xe?It:qt.a(It)},Ke.daysInMonth=function(){return this.endOf(dr).$D},Ke.$locale=function(){return Bi[this.$L]},Ke.locale=function(Be,Qe){if(!Be)return this.$L;var Xe=this.clone(),It=es(Be,Qe,!0);return It&&(Xe.$L=It),Xe},Ke.clone=function(){return qt.w(this.$d,this)},Ke.toDate=function(){return new Date(this.valueOf())},Ke.toJSON=function(){return this.isValid()?this.toISOString():null},Ke.toISOString=function(){return this.$d.toISOString()},Ke.toString=function(){return this.$d.toUTCString()},yt}(),dh=Xs.prototype;return Mn.prototype=dh,[["$ms",B],["$s",vo],["$m",ws],["$H",mi],["$W",ai],["$M",dr],["$y",hr],["$D",fr]].forEach(function(yt){dh[yt[1]]=function(Ke){return this.$g(Ke,yt[0],yt[1])}}),Mn.extend=function(yt,Ke){return yt.$i||(yt(Ke,Xs,Mn),yt.$i=!0),Mn},Mn.locale=es,Mn.isDayjs=Br,Mn.unix=function(yt){return Mn(1e3*yt)},Mn.en=Bi[js],Mn.Ls=Bi,Mn.p={},Mn}()},990:function($s,_o,yo){var fn;$s=yo.nmd($s),function(){var B,ai="Expected a function",dr="__lodash_hash_undefined__",hr="__lodash_placeholder__",qe=1/0,tn=9007199254740991,An=4294967295,bo=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],gn="[object Arguments]",mn="[object Array]",Rt="[object Boolean]",ts="[object Date]",lc="[object Error]",hh="[object Function]",uv="[object GeneratorFunction]",Ys="[object Map]",fh="[object Number]",Sa="[object Object]",Lw="[object Promise]",cc="[object RegExp]",Ks="[object Set]",ul="[object String]",ph="[object Symbol]",uc="[object WeakMap]",Tu="[object ArrayBuffer]",dc="[object DataView]",So="[object Float32Array]",mh="[object Float64Array]",Cm="[object Int8Array]",gh="[object Int16Array]",Am="[object Int32Array]",Dm="[object Uint8Array]",Im="[object Uint8ClampedArray]",Rm="[object Uint16Array]",Pm="[object Uint32Array]",kw=/\b__p \+= '';/g,Uw=/\b(__p \+=) '' \+/g,Bw=/(__e\(.*?\)|\b__t\)) \+\n'';/g,dv=/&(?:amp|lt|gt|quot|#39);/g,hv=/[&<>"']/g,wI=RegExp(dv.source),fv=RegExp(hv.source),pv=/<%-([\s\S]+?)%>/g,mv=/<%([\s\S]+?)%>/g,Nm=/<%=([\s\S]+?)%>/g,gv=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Vw=/^\w*$/,_v=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,_h=/[\\^$.*+?()[\]{}|]/g,yv=RegExp(_h.source),yh=/^\s+/,ns=/\s/,Hw=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,zw=/\{\n\/\* \[wrapped with (.+)\] \*/,Gw=/,? & /,Ww=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,vv=/[()=,{}\[\]\/\s]/,$w=/\\(\\)?/g,jw=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,wo=/\w*$/,qw=/^[-+]0x[0-9a-f]+$/i,er=/^0b[01]+$/i,hc=/^\[object .+?Constructor\]$/,Mo=/^0o[0-7]+$/i,MI=/^(?:0|[1-9]\d*)$/,Xw=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,vh=/($^)/,Lm=/['\n\r\u2028\u2029\\]/g,Cu="\\ud800-\\udfff",Om="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",bv="\\u2700-\\u27bf",Sv="a-z\\xdf-\\xf6\\xf8-\\xff",Mv="A-Z\\xc0-\\xd6\\xd8-\\xde",gi="\\ufe0e\\ufe0f",xv="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",vt="["+Cu+"]",Fm="["+xv+"]",fc="["+Om+"]",Ms="\\d+",Qw="["+bv+"]",Tv="["+Sv+"]",_n="[^"+Cu+xv+Ms+bv+Sv+Mv+"]",pc="\\ud83c[\\udffb-\\udfff]",Eh="[^"+Cu+"]",km="(?:\\ud83c[\\udde6-\\uddff]){2}",vn="[\\ud800-\\udbff][\\udc00-\\udfff]",ht="["+Mv+"]",Sh="(?:"+Tv+"|"+_n+")",xI="(?:"+ht+"|"+_n+")",Um="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",re="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",Du="(?:"+fc+"|"+pc+")?",xt="["+gi+"]?",Cv=xt+Du+"(?:\\u200d(?:"+[Eh,km,vn].join("|")+")"+xt+Du+")*",Bm="(?:"+[Qw,km,vn].join("|")+")"+Cv,is="(?:"+[Eh+fc+"?",fc,km,vn,vt].join("|")+")",CI=RegExp("['\u2019]","g"),tM=RegExp(fc,"g"),Av=RegExp(pc+"(?="+pc+")|"+is+Cv,"g"),dl=RegExp([ht+"?"+Tv+"+"+Um+"(?="+[Fm,ht,"$"].join("|")+")",xI+"+"+re+"(?="+[Fm,ht+Sh,"$"].join("|")+")",ht+"?"+Sh+"+"+Um,ht+"+"+re,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ms,Bm].join("|"),"g"),AI=RegExp("[\\u200d"+Cu+Om+gi+"]"),DI=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,II=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],RI=-1,Bn={};Bn[So]=Bn[mh]=Bn[Cm]=Bn[gh]=Bn[Am]=Bn[Dm]=Bn[Im]=Bn[Rm]=Bn[Pm]=!0,Bn[gn]=Bn[mn]=Bn[Tu]=Bn[Rt]=Bn[dc]=Bn[ts]=Bn[lc]=Bn[hh]=Bn[Ys]=Bn[fh]=Bn[Sa]=Bn[cc]=Bn[Ks]=Bn[ul]=Bn[uc]=!1;var Vn={};Vn[gn]=Vn[mn]=Vn[Tu]=Vn[dc]=Vn[Rt]=Vn[ts]=Vn[So]=Vn[mh]=Vn[Cm]=Vn[gh]=Vn[Am]=Vn[Ys]=Vn[fh]=Vn[Sa]=Vn[cc]=Vn[Ks]=Vn[ul]=Vn[ph]=Vn[Dm]=Vn[Im]=Vn[Rm]=Vn[Pm]=!0,Vn[lc]=Vn[hh]=Vn[uc]=!1;var Et={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},NI=parseFloat,LI=parseInt,iM="object"==typeof global&&global&&global.Object===Object&&global,tt="object"==typeof self&&self&&self.Object===Object&&self,mr=iM||tt||Function("return this")(),Vi=_o&&!_o.nodeType&&_o,wa=Vi&&$s&&!$s.nodeType&&$s,Dv=wa&&wa.exports===Vi,wh=Dv&&iM.process,Ts=function(){try{return wa&&wa.require&&wa.require("util").types||wh&&wh.binding&&wh.binding("util")}catch{}}(),Iu=Ts&&Ts.isArrayBuffer,Ru=Ts&&Ts.isDate,Mh=Ts&&Ts.isMap,Vm=Ts&&Ts.isRegExp,Iv=Ts&&Ts.isSet,Xt=Ts&&Ts.isTypedArray;function Ir(j,ae,ne){switch(ne.length){case 0:return j.call(ae);case 1:return j.call(ae,ne[0]);case 2:return j.call(ae,ne[0],ne[1]);case 3:return j.call(ae,ne[0],ne[1],ne[2])}return j.apply(ae,ne)}function Rv(j,ae,ne,Fe){for(var Pt=-1,pn=null==j?0:j.length;++Pt<pn;){var Di=j[Pt];ae(Fe,Di,ne(Di),j)}return Fe}function Hn(j,ae){for(var ne=-1,Fe=null==j?0:j.length;++ne<Fe&&!1!==ae(j[ne],ne,j););return j}function Pv(j,ae){for(var ne=null==j?0:j.length;ne--&&!1!==ae(j[ne],ne,j););return j}function rM(j,ae){for(var ne=-1,Fe=null==j?0:j.length;++ne<Fe;)if(!ae(j[ne],ne,j))return!1;return!0}function un(j,ae){for(var ne=-1,Fe=null==j?0:j.length,Pt=0,pn=[];++ne<Fe;){var Di=j[ne];ae(Di,ne,j)&&(pn[Pt++]=Di)}return pn}function Hm(j,ae){return!(null==j||!j.length)&&Pu(j,ae,0)>-1}function Nv(j,ae,ne){for(var Fe=-1,Pt=null==j?0:j.length;++Fe<Pt;)if(ne(ae,j[Fe]))return!0;return!1}function Nn(j,ae){for(var ne=-1,Fe=null==j?0:j.length,Pt=Array(Fe);++ne<Fe;)Pt[ne]=ae(j[ne],ne,j);return Pt}function xo(j,ae){for(var ne=-1,Fe=ae.length,Pt=j.length;++ne<Fe;)j[Pt+ne]=ae[ne];return j}function xh(j,ae,ne,Fe){var Pt=-1,pn=null==j?0:j.length;for(Fe&&pn&&(ne=j[++Pt]);++Pt<pn;)ne=ae(ne,j[Pt],Pt,j);return ne}function zm(j,ae,ne,Fe){var Pt=null==j?0:j.length;for(Fe&&Pt&&(ne=j[--Pt]);Pt--;)ne=ae(ne,j[Pt],Pt,j);return ne}function Gm(j,ae){for(var ne=-1,Fe=null==j?0:j.length;++ne<Fe;)if(ae(j[ne],ne,j))return!0;return!1}var Wm=jm("length");function sM(j,ae,ne){var Fe;return ne(j,function(Pt,pn,Di){if(ae(Pt,pn,Di))return Fe=pn,!1}),Fe}function $m(j,ae,ne,Fe){for(var Pt=j.length,pn=ne+(Fe?1:-1);Fe?pn--:++pn<Pt;)if(ae(j[pn],pn,j))return pn;return-1}function Pu(j,ae,ne){return ae==ae?function jo(j,ae,ne){for(var Fe=ne-1,Pt=j.length;++Fe<Pt;)if(j[Fe]===ae)return Fe;return-1}(j,ae,ne):$m(j,Th,ne)}function Nu(j,ae,ne,Fe){for(var Pt=ne-1,pn=j.length;++Pt<pn;)if(Fe(j[Pt],ae))return Pt;return-1}function Th(j){return j!=j}function Lu(j,ae){var ne=null==j?0:j.length;return ne?Ma(j,ae)/ne:NaN}function jm(j){return function(ae){return null==ae?B:ae[j]}}function qm(j){return function(ae){return null==j?B:j[ae]}}function Lv(j,ae,ne,Fe,Pt){return Pt(j,function(pn,Di,Dn){ne=Fe?(Fe=!1,pn):ae(ne,pn,Di,Dn)}),ne}function Ma(j,ae){for(var ne,Fe=-1,Pt=j.length;++Fe<Pt;){var pn=ae(j[Fe]);pn!==B&&(ne=ne===B?pn:ne+pn)}return ne}function Xm(j,ae){for(var ne=-1,Fe=Array(j);++ne<j;)Fe[ne]=ae(ne);return Fe}function Fv(j){return j&&j.slice(0,Dh(j)+1).replace(yh,"")}function Ne(j){return function(ae){return j(ae)}}function Ch(j,ae){return Nn(ae,function(ne){return j[ne]})}function Ve(j,ae){return j.has(ae)}function Ou(j,ae){for(var ne=-1,Fe=j.length;++ne<Fe&&Pu(ae,j[ne],0)>-1;);return ne}function Ah(j,ae){for(var ne=j.length;ne--&&Pu(ae,j[ne],0)>-1;);return ne}var oM=qm({\u00c0:"A",\u00c1:"A",\u00c2:"A",\u00c3:"A",\u00c4:"A",\u00c5:"A",\u00e0:"a",\u00e1:"a",\u00e2:"a",\u00e3:"a",\u00e4:"a",\u00e5:"a",\u00c7:"C",\u00e7:"c",\u00d0:"D",\u00f0:"d",\u00c8:"E",\u00c9:"E",\u00ca:"E",\u00cb:"E",\u00e8:"e",\u00e9:"e",\u00ea:"e",\u00eb:"e",\u00cc:"I",\u00cd:"I",\u00ce:"I",\u00cf:"I",\u00ec:"i",\u00ed:"i",\u00ee:"i",\u00ef:"i",\u00d1:"N",\u00f1:"n",\u00d2:"O",\u00d3:"O",\u00d4:"O",\u00d5:"O",\u00d6:"O",\u00d8:"O",\u00f2:"o",\u00f3:"o",\u00f4:"o",\u00f5:"o",\u00f6:"o",\u00f8:"o",\u00d9:"U",\u00da:"U",\u00db:"U",\u00dc:"U",\u00f9:"u",\u00fa:"u",\u00fb:"u",\u00fc:"u",\u00dd:"Y",\u00fd:"y",\u00ff:"y",\u00c6:"Ae",\u00e6:"ae",\u00de:"Th",\u00fe:"th",\u00df:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010a:"C",\u010c:"C",\u0107:"c",\u0109:"c",\u010b:"c",\u010d:"c",\u010e:"D",\u0110:"D",\u010f:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011a:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011b:"e",\u011c:"G",\u011e:"G",\u0120:"G",\u0122:"G",\u011d:"g",\u011f:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012a:"I",\u012c:"I",\u012e:"I",\u0130:"I",\u0129:"i",\u012b:"i",\u012d:"i",\u012f:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013b:"L",\u013d:"L",\u013f:"L",\u0141:"L",\u013a:"l",\u013c:"l",\u013e:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014a:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014b:"n",\u014c:"O",\u014e:"O",\u0150:"O",\u014d:"o",\u014f:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015a:"S",\u015c:"S",\u015e:"S",\u0160:"S",\u015b:"s",\u015d:"s",\u015f:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016a:"U",\u016c:"U",\u016e:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016b:"u",\u016d:"u",\u016f:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017b:"Z",\u017d:"Z",\u017a:"z",\u017c:"z",\u017e:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017f:"s"}),aM=qm({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function lM(j){return"\\"+Et[j]}function $o(j){return AI.test(j)}function ln(j){var ae=-1,ne=Array(j.size);return j.forEach(function(Fe,Pt){ne[++ae]=[Pt,Fe]}),ne}function ku(j,ae){return function(ne){return j(ae(ne))}}function Co(j,ae){for(var ne=-1,Fe=j.length,Pt=0,pn=[];++ne<Fe;){var Di=j[ne];(Di===ae||Di===hr)&&(j[ne]=hr,pn[Pt++]=ne)}return pn}function mc(j){var ae=-1,ne=Array(j.size);return j.forEach(function(Fe){ne[++ae]=Fe}),ne}function hl(j){return $o(j)?function Bv(j){for(var ae=Av.lastIndex=0;Av.test(j);)++ae;return ae}(j):Wm(j)}function As(j){return $o(j)?function Bu(j){return j.match(Av)||[]}(j):function OI(j){return j.split("")}(j)}function Dh(j){for(var ae=j.length;ae--&&ns.test(j.charAt(ae)););return ae}var Uv=qm({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),Ih=function j(ae){var u,ne=(ae=null==ae?mr:Ih.defaults(mr.Object(),ae,Ih.pick(mr,II))).Array,Fe=ae.Date,Pt=ae.Error,pn=ae.Function,Di=ae.Math,Dn=ae.Object,Ym=ae.RegExp,cM=ae.String,rs=ae.TypeError,Rh=ne.prototype,gc=Dn.prototype,ss=ae["__core-js_shared__"],Ph=pn.prototype.toString,En=gc.hasOwnProperty,dM=0,tr=(u=/[^.]+$/.exec(ss&&ss.keys&&ss.keys.IE_PROTO||""))?"Symbol(src)_1."+u:"",Nh=gc.toString,zv=Ph.call(Dn),_t=mr._,Hr=Ym("^"+Ph.call(En).replace(_h,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Jt=Dv?ae.Buffer:B,Wn=ae.Symbol,Hi=ae.Uint8Array,fl=Jt?Jt.allocUnsafe:B,gr=ku(Dn.getPrototypeOf,Dn),Km=Dn.create,Zm=gc.propertyIsEnumerable,pl=Rh.splice,Gv=Wn?Wn.isConcatSpreadable:B,Vu=Wn?Wn.iterator:B,xn=Wn?Wn.toStringTag:B,ke=function(){try{var u=to(Dn,"defineProperty");return u({},"",{}),u}catch{}}(),Ot=ae.clearTimeout!==mr.clearTimeout&&ae.clearTimeout,$n=Fe&&Fe.now!==mr.Date.now&&Fe.now,Zs=ae.setTimeout!==mr.setTimeout&&ae.setTimeout,Ta=Di.ceil,Ii=Di.floor,Ca=Dn.getOwnPropertySymbols,ui=Jt?Jt.isBuffer:B,qo=ae.isFinite,_c=Rh.join,Ct=ku(Dn.keys,Dn),ei=Di.max,nr=Di.min,yc=Fe.now,di=ae.parseInt,vc=Di.random,Ec=Rh.reverse,Ds=to(ae,"DataView"),Xo=to(ae,"Map"),Lh=to(ae,"Promise"),os=to(ae,"Set"),as=to(ae,"WeakMap"),Yo=to(Dn,"create"),Aa=as&&new as,Ut={},kI=Ba(Ds),Jm=Ba(Xo),Wv=Ba(Lh),Ao=Ba(os),Oh=Ba(as),Ko=Wn?Wn.prototype:B,Zo=Ko?Ko.valueOf:B,zi=Ko?Ko.toString:B;function D(u){if(ni(u)&&!Nt(u)&&!(u instanceof Bt)){if(u instanceof zr)return u;if(En.call(u,"__wrapped__"))return xl(u)}return new zr(u)}var Ri=function(){function u(){}return function(h){if(!qn(h))return{};if(Km)return Km(h);u.prototype=h;var g=new u;return u.prototype=B,g}}();function Gi(){}function zr(u,h){this.__wrapped__=u,this.__actions__=[],this.__chain__=!!h,this.__index__=0,this.__values__=B}function Bt(u){this.__wrapped__=u,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=An,this.__views__=[]}function ml(u){var h=-1,g=null==u?0:u.length;for(this.clear();++h<g;){var w=u[h];this.set(w[0],w[1])}}function Da(u){var h=-1,g=null==u?0:u.length;for(this.clear();++h<g;){var w=u[h];this.set(w[0],w[1])}}function Ia(u){var h=-1,g=null==u?0:u.length;for(this.clear();++h<g;){var w=u[h];this.set(w[0],w[1])}}function Ra(u){var h=-1,g=null==u?0:u.length;for(this.__data__=new Ia;++h<g;)this.add(u[h])}function Do(u){var h=this.__data__=new Da(u);this.size=h.size}function Hu(u,h){var g=Nt(u),w=!g&&Tl(u),x=!g&&!w&&Ha(u),P=!g&&!w&&!x&&Hc(u),U=g||w||x||P,G=U?Xm(u.length,cM):[],X=G.length;for(var fe in u)(h||En.call(u,fe))&&(!U||!("length"==fe||x&&("offset"==fe||"parent"==fe)||P&&("buffer"==fe||"byteLength"==fe||"byteOffset"==fe)||No(fe,X)))&&G.push(fe);return G}function ls(u){var h=u.length;return h?u[Yh(0,h-1)]:B}function jv(u,h){return na(yr(u),Na(h,0,u.length))}function qv(u){return na(yr(u))}function kh(u,h,g){(g!==B&&!io(u[h],g)||g===B&&!(h in u))&&Io(u,h,g)}function bc(u,h,g){var w=u[h];(!En.call(u,h)||!io(w,g)||g===B&&!(h in u))&&Io(u,h,g)}function Sc(u,h){for(var g=u.length;g--;)if(io(u[g][0],h))return g;return-1}function Xv(u,h,g,w){return yl(u,function(x,P,U){h(w,x,g(x),U)}),w}function Uh(u,h){return u&&eo(h,ji(h),u)}function Io(u,h,g){"__proto__"==h&&ke?ke(u,h,{configurable:!0,enumerable:!0,value:g,writable:!0}):u[h]=g}function Bh(u,h){for(var g=-1,w=h.length,x=ne(w),P=null==u;++g<w;)x[g]=P?B:lE(u,h[g]);return x}function Na(u,h,g){return u==u&&(g!==B&&(u=u<=g?u:g),h!==B&&(u=u>=h?u:h)),u}function Rr(u,h,g,w,x,P){var U,G=1&h,X=2&h,fe=4&h;if(g&&(U=x?g(u,w,x,P):g(u)),U!==B)return U;if(!qn(u))return u;var pe=Nt(u);if(pe){if(U=function IM(u){var h=u.length,g=new u.constructor(h);return h&&"string"==typeof u[0]&&En.call(u,"index")&&(g.index=u.index,g.input=u.input),g}(u),!G)return yr(u,U)}else{var Ee=Ni(u),Ue=Ee==hh||Ee==uv;if(Ha(u))return _r(u,G);if(Ee==Sa||Ee==gn||Ue&&!x){if(U=X||Ue?{}:no(u),!G)return X?function CM(u,h){return eo(u,uf(u),h)}(u,function eg(u,h){return u&&eo(h,br(h),u)}(U,u)):function dg(u,h){return eo(u,bl(u),h)}(u,Uh(U,u))}else{if(!Vn[Ee])return x?u:{};U=function RM(u,h,g){var w=u.constructor;switch(h){case Tu:return Qs(u);case Rt:case ts:return new w(+u);case dc:return function d0(u,h){var g=h?Qs(u.buffer):u.buffer;return new u.constructor(g,u.byteOffset,u.byteLength)}(u,g);case So:case mh:case Cm:case gh:case Am:case Dm:case Im:case Rm:case Pm:return h0(u,g);case Ys:return new w;case fh:case ul:return new w(u);case cc:return function Cc(u){var h=new u.constructor(u.source,wo.exec(u));return h.lastIndex=u.lastIndex,h}(u);case Ks:return new w;case ph:return function Qo(u){return Zo?Dn(Zo.call(u)):{}}(u)}}(u,Ee,G)}}P||(P=new Do);var rt=P.get(u);if(rt)return rt;P.set(u,U),Yg(u)?u.forEach(function(mt){U.add(Rr(mt,h,g,mt,u,P))}):Rf(u)&&u.forEach(function(mt,zt){U.set(zt,Rr(mt,h,g,zt,u,P))});var $t=pe?B:(fe?X?Ju:y0:X?br:ji)(u);return Hn($t||u,function(mt,zt){$t&&(mt=u[zt=mt]),bc(U,zt,Rr(mt,h,g,zt,u,P))}),U}function _l(u,h,g){var w=g.length;if(null==u)return!w;for(u=Dn(u);w--;){var x=g[w],U=u[x];if(U===B&&!(x in u)||!(0,h[x])(U))return!1}return!0}function tg(u,h,g){if("function"!=typeof u)throw new rs(ai);return wl(function(){u.apply(B,g)},h)}function Vh(u,h,g,w){var x=-1,P=Hm,U=!0,G=u.length,X=[],fe=h.length;if(!G)return X;g&&(h=Nn(h,Ne(g))),w?(P=Nv,U=!1):h.length>=200&&(P=Ve,U=!1,h=new Ra(h));e:for(;++x<G;){var pe=u[x],Ee=null==g?pe:g(pe);if(pe=w||0!==pe?pe:0,U&&Ee==Ee){for(var Ue=fe;Ue--;)if(h[Ue]===Ee)continue e;X.push(pe)}else P(h,Ee,w)||X.push(pe)}return X}D.templateSettings={escape:pv,evaluate:mv,interpolate:Nm,variable:"",imports:{_:D}},(D.prototype=Gi.prototype).constructor=D,(zr.prototype=Ri(Gi.prototype)).constructor=zr,(Bt.prototype=Ri(Gi.prototype)).constructor=Bt,ml.prototype.clear=function hM(){this.__data__=Yo?Yo(null):{},this.size=0},ml.prototype.delete=function UI(u){var h=this.has(u)&&delete this.__data__[u];return this.size-=h?1:0,h},ml.prototype.get=function fM(u){var h=this.__data__;if(Yo){var g=h[u];return g===dr?B:g}return En.call(h,u)?h[u]:B},ml.prototype.has=function pM(u){var h=this.__data__;return Yo?h[u]!==B:En.call(h,u)},ml.prototype.set=function BI(u,h){var g=this.__data__;return this.size+=this.has(u)?0:1,g[u]=Yo&&h===B?dr:h,this},Da.prototype.clear=function VI(){this.__data__=[],this.size=0},Da.prototype.delete=function HI(u){var h=this.__data__,g=Sc(h,u);return!(g<0||(g==h.length-1?h.pop():pl.call(h,g,1),--this.size,0))},Da.prototype.get=function zI(u){var h=this.__data__,g=Sc(h,u);return g<0?B:h[g][1]},Da.prototype.has=function GI(u){return Sc(this.__data__,u)>-1},Da.prototype.set=function WI(u,h){var g=this.__data__,w=Sc(g,u);return w<0?(++this.size,g.push([u,h])):g[w][1]=h,this},Ia.prototype.clear=function $I(){this.size=0,this.__data__={hash:new ml,map:new(Xo||Da),string:new ml}},Ia.prototype.delete=function jI(u){var h=vg(this,u).delete(u);return this.size-=h?1:0,h},Ia.prototype.get=function qI(u){return vg(this,u).get(u)},Ia.prototype.has=function XI(u){return vg(this,u).has(u)},Ia.prototype.set=function $v(u,h){var g=vg(this,u),w=g.size;return g.set(u,h),this.size+=g.size==w?0:1,this},Ra.prototype.add=Ra.prototype.push=function YI(u){return this.__data__.set(u,dr),this},Ra.prototype.has=function KI(u){return this.__data__.has(u)},Do.prototype.clear=function gl(){this.__data__=new Da,this.size=0},Do.prototype.delete=function Pa(u){var h=this.__data__,g=h.delete(u);return this.size=h.size,g},Do.prototype.get=function ZI(u){return this.__data__.get(u)},Do.prototype.has=function JI(u){return this.__data__.has(u)},Do.prototype.set=function ir(u,h){var g=this.__data__;if(g instanceof Da){var w=g.__data__;if(!Xo||w.length<199)return w.push([u,h]),this.size=++g.size,this;g=this.__data__=new Ia(w)}return g.set(u,h),this.size=g.size,this};var yl=hg(Jo),mM=hg(Yv,!0);function gM(u,h){var g=!0;return yl(u,function(w,x,P){return g=!!h(w,x,P)}),g}function Hh(u,h,g){for(var w=-1,x=u.length;++w<x;){var P=u[w],U=h(P);if(null!=U&&(G===B?U==U&&!ds(U):g(U,G)))var G=U,X=P}return X}function ng(u,h){var g=[];return yl(u,function(w,x,P){h(w,x,P)&&g.push(w)}),g}function Pi(u,h,g,w,x){var P=-1,U=u.length;for(g||(g=bg),x||(x=[]);++P<U;){var G=u[P];h>0&&g(G)?h>1?Pi(G,h-1,g,w,x):xo(x,G):w||(x[x.length]=G)}return x}var ig=fg(),zh=fg(!0);function Jo(u,h){return u&&ig(u,h,ji)}function Yv(u,h){return u&&zh(u,h,ji)}function Gh(u,h){return un(h,function(g){return Ls(u[g])})}function La(u,h){for(var g=0,w=(h=Po(h,u)).length;null!=u&&g<w;)u=u[Or(h[g++])];return g&&g==w?u:B}function rg(u,h,g){var w=h(u);return Nt(u)?w:xo(w,g(u))}function Pr(u){return null==u?u===B?"[object Undefined]":"[object Null]":xn&&xn in Dn(u)?function DM(u){var h=En.call(u,xn),g=u[xn];try{u[xn]=B;var w=!0}catch{}var x=Nh.call(u);return w&&(h?u[xn]=g:delete u[xn]),x}(u):function x0(u){return Nh.call(u)}(u)}function sg(u,h){return u>h}function _M(u,h){return null!=u&&En.call(u,h)}function Kv(u,h){return null!=u&&h in Dn(u)}function Wh(u,h,g){for(var w=g?Nv:Hm,x=u[0].length,P=u.length,U=P,G=ne(P),X=1/0,fe=[];U--;){var pe=u[U];U&&h&&(pe=Nn(pe,Ne(h))),X=nr(pe.length,X),G[U]=!g&&(h||x>=120&&pe.length>=120)?new Ra(U&&pe):B}pe=u[0];var Ee=-1,Ue=G[0];e:for(;++Ee<x&&fe.length<X;){var rt=pe[Ee],ft=h?h(rt):rt;if(rt=g||0!==rt?rt:0,!(Ue?Ve(Ue,ft):w(fe,ft,g))){for(U=P;--U;){var $t=G[U];if(!($t?Ve($t,ft):w(u[U],ft,g)))continue e}Ue&&Ue.push(ft),fe.push(rt)}}return fe}function $h(u,h,g){var w=null==(u=T0(u,h=Po(h,u)))?u:u[Or(jn(h))];return null==w?B:Ir(w,u,g)}function Zv(u){return ni(u)&&Pr(u)==gn}function Gu(u,h,g,w,x){return u===h||(null==u||null==h||!ni(u)&&!ni(h)?u!=u&&h!=h:function EM(u,h,g,w,x,P){var U=Nt(u),G=Nt(h),X=U?mn:Ni(u),fe=G?mn:Ni(h),pe=(X=X==gn?Sa:X)==Sa,Ee=(fe=fe==gn?Sa:fe)==Sa,Ue=X==fe;if(Ue&&Ha(u)){if(!Ha(h))return!1;U=!0,pe=!1}if(Ue&&!pe)return P||(P=new Do),U||Hc(u)?_0(u,h,g,w,x,P):function Ac(u,h,g,w,x,P,U){switch(g){case dc:if(u.byteLength!=h.byteLength||u.byteOffset!=h.byteOffset)return!1;u=u.buffer,h=h.buffer;case Tu:return!(u.byteLength!=h.byteLength||!P(new Hi(u),new Hi(h)));case Rt:case ts:case fh:return io(+u,+h);case lc:return u.name==h.name&&u.message==h.message;case cc:case ul:return u==h+"";case Ys:var G=ln;case Ks:if(G||(G=mc),u.size!=h.size&&!(1&w))return!1;var fe=U.get(u);if(fe)return fe==h;w|=2,U.set(u,h);var pe=_0(G(u),G(h),w,x,P,U);return U.delete(u),pe;case ph:if(Zo)return Zo.call(u)==Zo.call(h)}return!1}(u,h,X,g,w,x,P);if(!(1&g)){var rt=pe&&En.call(u,"__wrapped__"),ft=Ee&&En.call(h,"__wrapped__");if(rt||ft){var $t=rt?u.value():u,mt=ft?h.value():h;return P||(P=new Do),x($t,mt,g,w,P)}}return!!Ue&&(P||(P=new Do),function Zu(u,h,g,w,x,P){var U=1&g,G=y0(u),X=G.length;if(X!=y0(h).length&&!U)return!1;for(var Ee=X;Ee--;){var Ue=G[Ee];if(!(U?Ue in h:En.call(h,Ue)))return!1}var rt=P.get(u),ft=P.get(h);if(rt&&ft)return rt==h&&ft==u;var $t=!0;P.set(u,h),P.set(h,u);for(var mt=U;++Ee<X;){var zt=u[Ue=G[Ee]],sn=h[Ue];if(w)var qi=U?w(sn,zt,Ue,h,u,P):w(zt,sn,Ue,u,h,P);if(!(qi===B?zt===sn||x(zt,sn,g,w,P):qi)){$t=!1;break}mt||(mt="constructor"==Ue)}if($t&&!mt){var Tn=u.constructor,fs=h.constructor;Tn!=fs&&"constructor"in u&&"constructor"in h&&!("function"==typeof Tn&&Tn instanceof Tn&&"function"==typeof fs&&fs instanceof fs)&&($t=!1)}return P.delete(u),P.delete(h),$t}(u,h,g,w,x,P))}(u,h,g,w,Gu,x))}function jh(u,h,g,w){var x=g.length,P=x,U=!w;if(null==u)return!P;for(u=Dn(u);x--;){var G=g[x];if(U&&G[2]?G[1]!==u[G[0]]:!(G[0]in u))return!1}for(;++x<P;){var X=(G=g[x])[0],fe=u[X],pe=G[1];if(U&&G[2]){if(fe===B&&!(X in u))return!1}else{var Ee=new Do;if(w)var Ue=w(fe,pe,X,u,h,Ee);if(!(Ue===B?Gu(pe,fe,3,w,Ee):Ue))return!1}}return!0}function e0(u){return!(!qn(u)||function b0(u){return!!tr&&tr in u}(u))&&(Ls(u)?Hr:hc).test(Ba(u))}function ag(u){return"function"==typeof u?u:null==u?Sr:"object"==typeof u?Nt(u)?t0(u[0],u[1]):Nr(u):Xx(u)}function qh(u){if(!Ic(u))return Ct(u);var h=[];for(var g in Dn(u))En.call(u,g)&&"constructor"!=g&&h.push(g);return h}function Wu(u,h){return u<h}function $u(u,h){var g=-1,w=Er(u)?ne(u.length):[];return yl(u,function(x,P,U){w[++g]=h(x,P,U)}),w}function Nr(u){var h=Qu(u);return 1==h.length&&h[0][2]?td(h[0][0],h[0][1]):function(g){return g===u||jh(g,u,h)}}function t0(u,h){return ed(u)&&w0(h)?td(Or(u),h):function(g){var w=lE(g,u);return w===B&&w===h?Ff(g,u):Gu(h,w,3)}}function ju(u,h,g,w,x){u!==h&&ig(h,function(P,U){if(x||(x=new Do),qn(P))!function wc(u,h,g,w,x,P,U){var G=Sg(u,g),X=Sg(h,g),fe=U.get(X);if(fe)kh(u,g,fe);else{var pe=P?P(G,X,g+"",u,h,U):B,Ee=pe===B;if(Ee){var Ue=Nt(X),rt=!Ue&&Ha(X),ft=!Ue&&!rt&&Hc(X);pe=X,Ue||rt||ft?Nt(G)?pe=G:ti(G)?pe=yr(G):rt?(Ee=!1,pe=_r(X,!0)):ft?(Ee=!1,pe=h0(X,!0)):pe=[]:Al(X)||Tl(X)?(pe=G,Tl(G)?pe=sE(G):(!qn(G)||Ls(G))&&(pe=no(X))):Ee=!1}Ee&&(U.set(X,pe),x(pe,X,w,P,U),U.delete(X)),kh(u,g,pe)}}(u,h,U,g,ju,w,x);else{var G=w?w(Sg(u,U),P,U+"",u,h,x):B;G===B&&(G=P),kh(u,U,G)}},br)}function Gr(u,h){var g=u.length;if(g)return No(h+=h<0?g:0,g)?u[h]:B}function n0(u,h,g){h=h.length?Nn(h,function(P){return Nt(P)?function(U){return La(U,1===P.length?P[0]:P)}:P}):[Sr];var w=-1;return h=Nn(h,Ne(pt())),function Ov(j,ae){var ne=j.length;for(j.sort(ae);ne--;)j[ne]=j[ne].value;return j}($u(u,function(P,U,G){return{criteria:Nn(h,function(fe){return fe(P)}),index:++w,value:P}}),function(P,U){return function TM(u,h,g){for(var w=-1,x=u.criteria,P=h.criteria,U=x.length,G=g.length;++w<U;){var X=ug(x[w],P[w]);if(X)return w>=G?X:X*("desc"==g[w]?-1:1)}return u.index-h.index}(P,U,g)})}function r0(u,h,g){for(var w=-1,x=h.length,P={};++w<x;){var U=h[w],G=La(u,U);g(G,U)&&Zh(P,Po(U,u),G)}return P}function Xh(u,h,g,w){var x=w?Nu:Pu,P=-1,U=h.length,G=u;for(u===h&&(h=yr(h)),g&&(G=Nn(u,Ne(g)));++P<U;)for(var X=0,fe=h[P],pe=g?g(fe):fe;(X=x(G,pe,X,w))>-1;)G!==u&&pl.call(G,X,1),pl.call(u,X,1);return u}function s0(u,h){for(var g=u?h.length:0,w=g-1;g--;){var x=h[g];if(g==w||x!==P){var P=x;No(x)?pl.call(u,x,1):nn(u,x)}}return u}function Yh(u,h){return u+Ii(vc()*(h-u+1))}function Kh(u,h){var g="";if(!u||h<1||h>tn)return g;do{h%2&&(g+=u),(h=Ii(h/2))&&(u+=u)}while(h);return g}function Wt(u,h){return wg(Rc(u,h,Sr),u+"")}function bt(u){return ls(Il(u))}function a0(u,h){var g=Il(u);return na(g,Na(h,0,g.length))}function Zh(u,h,g,w){if(!qn(u))return u;for(var x=-1,P=(h=Po(h,u)).length,U=P-1,G=u;null!=G&&++x<P;){var X=Or(h[x]),fe=g;if("__proto__"===X||"constructor"===X||"prototype"===X)return u;if(x!=U){var pe=G[X];(fe=w?w(pe,X,G):B)===B&&(fe=qn(pe)?pe:No(h[x+1])?[]:{})}bc(G,X,fe),G=G[X]}return u}var l0=Aa?function(u,h){return Aa.set(u,h),u}:Sr,wM=ke?function(u,h){return ke(u,"toString",{configurable:!0,enumerable:!1,value:fd(h),writable:!0})}:Sr;function MM(u){return na(Il(u))}function cs(u,h,g){var w=-1,x=u.length;h<0&&(h=-h>x?0:x+h),(g=g>x?x:g)<0&&(g+=x),x=h>g?0:g-h>>>0,h>>>=0;for(var P=ne(x);++w<x;)P[w]=u[w+h];return P}function Mc(u,h){var g;return yl(u,function(w,x,P){return!(g=h(w,x,P))}),!!g}function Jh(u,h,g){var w=0,x=null==u?w:u.length;if("number"==typeof h&&h==h&&x<=2147483647){for(;w<x;){var P=w+x>>>1,U=u[P];null!==U&&!ds(U)&&(g?U<=h:U<h)?w=P+1:x=P}return x}return lg(u,h,Sr,g)}function lg(u,h,g,w){var x=0,P=null==u?0:u.length;if(0===P)return 0;for(var U=(h=g(h))!=h,G=null===h,X=ds(h),fe=h===B;x<P;){var pe=Ii((x+P)/2),Ee=g(u[pe]),Ue=Ee!==B,rt=null===Ee,ft=Ee==Ee,$t=ds(Ee);if(U)var mt=w||ft;else mt=fe?ft&&(w||Ue):G?ft&&Ue&&(w||!rt):X?ft&&Ue&&!rt&&(w||!$t):!rt&&!$t&&(w?Ee<=h:Ee<h);mt?x=pe+1:P=pe}return nr(P,4294967294)}function c0(u,h){for(var g=-1,w=u.length,x=0,P=[];++g<w;){var U=u[g],G=h?h(U):U;if(!g||!io(G,X)){var X=G;P[x++]=0===U?0:U}}return P}function u0(u){return"number"==typeof u?u:ds(u)?NaN:+u}function us(u){if("string"==typeof u)return u;if(Nt(u))return Nn(u,us)+"";if(ds(u))return zi?zi.call(u):"";var h=u+"";return"0"==h&&1/u==-qe?"-0":h}function me(u,h,g){var w=-1,x=Hm,P=u.length,U=!0,G=[],X=G;if(g)U=!1,x=Nv;else if(P>=200){var fe=h?null:af(u);if(fe)return mc(fe);U=!1,x=Ve,X=new Ra}else X=h?[]:G;e:for(;++w<P;){var pe=u[w],Ee=h?h(pe):pe;if(pe=g||0!==pe?pe:0,U&&Ee==Ee){for(var Ue=X.length;Ue--;)if(X[Ue]===Ee)continue e;h&&X.push(Ee),G.push(pe)}else x(X,Ee,g)||(X!==G&&X.push(Ee),G.push(pe))}return G}function nn(u,h){return null==(u=T0(u,h=Po(h,u)))||delete u[Or(jn(h))]}function Qh(u,h,g,w){return Zh(u,h,g(La(u,h)),w)}function xc(u,h,g,w){for(var x=u.length,P=w?x:-1;(w?P--:++P<x)&&h(u[P],P,u););return g?cs(u,w?0:P,w?P+1:x):cs(u,w?P+1:0,w?x:P)}function Wi(u,h){var g=u;return g instanceof Bt&&(g=g.value()),xh(h,function(w,x){return x.func.apply(x.thisArg,xo([w],x.args))},g)}function ef(u,h,g){var w=u.length;if(w<2)return w?me(u[0]):[];for(var x=-1,P=ne(w);++x<w;)for(var U=u[x],G=-1;++G<w;)G!=x&&(P[x]=Vh(P[x]||U,u[G],h,g));return me(Pi(P,1),h,g)}function Tc(u,h,g){for(var w=-1,x=u.length,P=h.length,U={};++w<x;)g(U,u[w],w<P?h[w]:B);return U}function Rs(u){return ti(u)?u:[]}function qu(u){return"function"==typeof u?u:Sr}function Po(u,h){return Nt(u)?u:ed(u,h)?[u]:Ml(dn(u))}var xM=Wt;function vl(u,h,g){var w=u.length;return g=g===B?w:g,!h&&g>=w?u:cs(u,h,g)}var cg=Ot||function(u){return mr.clearTimeout(u)};function _r(u,h){if(h)return u.slice();var g=u.length,w=fl?fl(g):new u.constructor(g);return u.copy(w),w}function Qs(u){var h=new u.constructor(u.byteLength);return new Hi(h).set(new Hi(u)),h}function h0(u,h){var g=h?Qs(u.buffer):u.buffer;return new u.constructor(g,u.byteOffset,u.length)}function ug(u,h){if(u!==h){var g=u!==B,w=null===u,x=u==u,P=ds(u),U=h!==B,G=null===h,X=h==h,fe=ds(h);if(!G&&!fe&&!P&&u>h||P&&U&&X&&!G&&!fe||w&&U&&X||!g&&X||!x)return 1;if(!w&&!P&&!fe&&u<h||fe&&g&&x&&!w&&!P||G&&g&&x||!U&&x||!X)return-1}return 0}function f0(u,h,g,w){for(var x=-1,P=u.length,U=g.length,G=-1,X=h.length,fe=ei(P-U,0),pe=ne(X+fe),Ee=!w;++G<X;)pe[G]=h[G];for(;++x<U;)(Ee||x<P)&&(pe[g[x]]=u[x]);for(;fe--;)pe[G++]=u[x++];return pe}function tf(u,h,g,w){for(var x=-1,P=u.length,U=-1,G=g.length,X=-1,fe=h.length,pe=ei(P-G,0),Ee=ne(pe+fe),Ue=!w;++x<pe;)Ee[x]=u[x];for(var rt=x;++X<fe;)Ee[rt+X]=h[X];for(;++U<G;)(Ue||x<P)&&(Ee[rt+g[U]]=u[x++]);return Ee}function yr(u,h){var g=-1,w=u.length;for(h||(h=ne(w));++g<w;)h[g]=u[g];return h}function eo(u,h,g,w){var x=!g;g||(g={});for(var P=-1,U=h.length;++P<U;){var G=h[P],X=w?w(g[G],u[G],G,g,u):B;X===B&&(X=u[G]),x?Io(g,G,X):bc(g,G,X)}return g}function Xu(u,h){return function(g,w){var x=Nt(g)?Rv:Xv,P=h?h():{};return x(g,u,pt(w,2),P)}}function Fa(u){return Wt(function(h,g){var w=-1,x=g.length,P=x>1?g[x-1]:B,U=x>2?g[2]:B;for(P=u.length>3&&"function"==typeof P?(x--,P):B,U&&$i(g[0],g[1],U)&&(P=x<3?B:P,x=1),h=Dn(h);++w<x;){var G=g[w];G&&u(h,G,w,P)}return h})}function hg(u,h){return function(g,w){if(null==g)return g;if(!Er(g))return u(g,w);for(var x=g.length,P=h?x:-1,U=Dn(g);(h?P--:++P<x)&&!1!==w(U[P],P,U););return g}}function fg(u){return function(h,g,w){for(var x=-1,P=Dn(h),U=w(h),G=U.length;G--;){var X=U[u?G:++x];if(!1===g(P[X],X,P))break}return h}}function pg(u){return function(h){var g=$o(h=dn(h))?As(h):B,w=g?g[0]:h.charAt(0),x=g?vl(g,1).join(""):h.slice(1);return w[u]()+x}}function ka(u){return function(h){return xh(Ga(hE(h).replace(CI,"")),u,"")}}function Yu(u){return function(){var h=arguments;switch(h.length){case 0:return new u;case 1:return new u(h[0]);case 2:return new u(h[0],h[1]);case 3:return new u(h[0],h[1],h[2]);case 4:return new u(h[0],h[1],h[2],h[3]);case 5:return new u(h[0],h[1],h[2],h[3],h[4]);case 6:return new u(h[0],h[1],h[2],h[3],h[4],h[5]);case 7:return new u(h[0],h[1],h[2],h[3],h[4],h[5],h[6])}var g=Ri(u.prototype),w=u.apply(g,h);return qn(w)?w:g}}function vr(u){return function(h,g,w){var x=Dn(h);if(!Er(h)){var P=pt(g,3);h=ji(h),g=function(G){return P(x[G],G,x)}}var U=u(h,g,w);return U>-1?x[P?h[U]:U]:B}}function Ua(u){return ta(function(h){var g=h.length,w=g,x=zr.prototype.thru;for(u&&h.reverse();w--;){var P=h[w];if("function"!=typeof P)throw new rs(ai);if(x&&!U&&"wrapper"==cf(P))var U=new zr([],!0)}for(w=U?w:g;++w<g;){var G=cf(P=h[w]),X="wrapper"==G?v0(P):B;U=X&&hf(X[0])&&424==X[1]&&!X[4].length&&1==X[9]?U[cf(X[0])].apply(U,X[3]):1==P.length&&hf(P)?U[G]():U.thru(P)}return function(){var fe=arguments,pe=fe[0];if(U&&1==fe.length&&Nt(pe))return U.plant(pe).value();for(var Ee=0,Ue=g?h[Ee].apply(this,fe):pe;++Ee<g;)Ue=h[Ee].call(this,Ue);return Ue}})}function On(u,h,g,w,x,P,U,G,X,fe){var pe=128&h,Ee=1&h,Ue=2&h,rt=24&h,ft=512&h,$t=Ue?B:Yu(u);return function mt(){for(var zt=arguments.length,sn=ne(zt),qi=zt;qi--;)sn[qi]=arguments[qi];if(rt)var Tn=Dc(mt),fs=function Fu(j,ae){for(var ne=j.length,Fe=0;ne--;)j[ne]===ae&&++Fe;return Fe}(sn,Tn);if(w&&(sn=f0(sn,w,x,rt)),P&&(sn=tf(sn,P,U,rt)),zt-=fs,rt&&zt<fe){var zn=Co(sn,Tn);return ea(u,h,On,mt.placeholder,g,sn,zn,G,X,fe-zt)}var vi=Ee?g:this,sa=Ue?vi[u]:u;return zt=sn.length,G?sn=function Lr(u,h){for(var g=u.length,w=nr(h.length,g),x=yr(u);w--;){var P=h[w];u[w]=No(P,g)?x[P]:B}return u}(sn,G):ft&&zt>1&&sn.reverse(),pe&&X<zt&&(sn.length=X),this&&this!==mr&&this instanceof mt&&(sa=$t||Yu(sa)),sa.apply(vi,sn)}}function nf(u,h){return function(g,w){return function vM(u,h,g,w){return Jo(u,function(x,P,U){h(w,g(x),P,U)}),w}(g,u,h(w),{})}}function rf(u,h){return function(g,w){var x;if(g===B&&w===B)return h;if(g!==B&&(x=g),w!==B){if(x===B)return w;"string"==typeof g||"string"==typeof w?(g=us(g),w=us(w)):(g=u0(g),w=u0(w)),x=u(g,w)}return x}}function mg(u){return ta(function(h){return h=Nn(h,Ne(pt())),Wt(function(g){var w=this;return u(h,function(x){return Ir(x,w,g)})})})}function sf(u,h){var g=(h=h===B?" ":us(h)).length;if(g<2)return g?Kh(h,u):h;var w=Kh(h,Ta(u/hl(h)));return $o(h)?vl(As(w),0,u).join(""):w.slice(0,u)}function gg(u){return function(h,g,w){return w&&"number"!=typeof w&&$i(h,g,w)&&(g=w=B),h=ia(h),g===B?(g=h,h=0):g=ia(g),function o0(u,h,g,w){for(var x=-1,P=ei(Ta((h-u)/(g||1)),0),U=ne(P);P--;)U[w?P:++x]=u,u+=g;return U}(h,g,w=w===B?h<g?1:-1:ia(w),u)}}function El(u){return function(h,g){return"string"==typeof h&&"string"==typeof g||(h=$r(h),g=$r(g)),u(h,g)}}function ea(u,h,g,w,x,P,U,G,X,fe){var pe=8&h;h|=pe?32:64,4&(h&=~(pe?64:32))||(h&=-4);var $t=[u,h,x,pe?P:B,pe?U:B,pe?B:P,pe?B:U,G,X,fe],mt=g.apply(B,$t);return hf(u)&&_i(mt,$t),mt.placeholder=w,Mg(mt,u,h)}function _g(u){var h=Di[u];return function(g,w){if(g=$r(g),(w=null==w?0:nr(Ht(w),292))&&qo(g)){var x=(dn(g)+"e").split("e");return+((x=(dn(h(x[0]+"e"+(+x[1]+w)))+"e").split("e"))[0]+"e"+(+x[1]-w))}return h(g)}}var af=os&&1/mc(new os([,-0]))[1]==qe?function(u){return new os(u)}:pd;function Ku(u){return function(h){var g=Ni(h);return g==Ys?ln(h):g==Ks?function kv(j){var ae=-1,ne=Array(j.size);return j.forEach(function(Fe){ne[++ae]=[Fe,Fe]}),ne}(h):function xa(j,ae){return Nn(ae,function(ne){return[ne,j[ne]]})}(h,u(h))}}function Ps(u,h,g,w,x,P,U,G){var X=2&h;if(!X&&"function"!=typeof u)throw new rs(ai);var fe=w?w.length:0;if(fe||(h&=-97,w=x=B),U=U===B?U:ei(Ht(U),0),G=G===B?G:Ht(G),fe-=x?x.length:0,64&h){var pe=w,Ee=x;w=x=B}var Ue=X?B:v0(u),rt=[u,h,g,w,x,pe,Ee,P,U,G];if(Ue&&function NM(u,h){var g=u[1],w=h[1],x=g|w;if(!(x<131)&&!(128==w&&8==g||128==w&&256==g&&u[7].length<=h[8]||384==w&&h[7].length<=h[8]&&8==g))return u;1&w&&(u[2]=h[2],x|=1&g?0:4);var G=h[3];if(G){var X=u[3];u[3]=X?f0(X,G,h[4]):G,u[4]=X?Co(u[3],hr):h[4]}(G=h[5])&&(u[5]=(X=u[5])?tf(X,G,h[6]):G,u[6]=X?Co(u[5],hr):h[6]),(G=h[7])&&(u[7]=G),128&w&&(u[8]=null==u[8]?h[8]:nr(u[8],h[8])),null==u[9]&&(u[9]=h[9]),u[0]=h[0],u[1]=x}(rt,Ue),u=rt[0],h=rt[1],g=rt[2],w=rt[3],x=rt[4],!(G=rt[9]=rt[9]===B?X?0:u.length:ei(rt[9]-fe,0))&&24&h&&(h&=-25),h&&1!=h)ft=8==h||16==h?function AM(u,h,g){var w=Yu(u);return function x(){for(var P=arguments.length,U=ne(P),G=P,X=Dc(x);G--;)U[G]=arguments[G];var fe=P<3&&U[0]!==X&&U[P-1]!==X?[]:Co(U,X);return(P-=fe.length)<g?ea(u,h,On,x.placeholder,B,U,fe,B,B,g-P):Ir(this&&this!==mr&&this instanceof x?w:u,this,U)}}(u,h,G):32!=h&&33!=h||x.length?On.apply(B,rt):function m0(u,h,g,w){var x=1&h,P=Yu(u);return function U(){for(var G=-1,X=arguments.length,fe=-1,pe=w.length,Ee=ne(pe+X),Ue=this&&this!==mr&&this instanceof U?P:u;++fe<pe;)Ee[fe]=w[fe];for(;X--;)Ee[fe++]=arguments[++G];return Ir(Ue,x?g:this,Ee)}}(u,h,g,w);else var ft=function p0(u,h,g){var w=1&h,x=Yu(u);return function P(){return(this&&this!==mr&&this instanceof P?x:u).apply(w?g:this,arguments)}}(u,h,g);return Mg((Ue?l0:_i)(ft,rt),u,h)}function lf(u,h,g,w){return u===B||io(u,gc[g])&&!En.call(w,g)?h:u}function yg(u,h,g,w,x,P){return qn(u)&&qn(h)&&(P.set(h,u),ju(u,h,B,yg,P),P.delete(h)),u}function g0(u){return Al(u)?B:u}function _0(u,h,g,w,x,P){var U=1&g,G=u.length,X=h.length;if(G!=X&&!(U&&X>G))return!1;var fe=P.get(u),pe=P.get(h);if(fe&&pe)return fe==h&&pe==u;var Ee=-1,Ue=!0,rt=2&g?new Ra:B;for(P.set(u,h),P.set(h,u);++Ee<G;){var ft=u[Ee],$t=h[Ee];if(w)var mt=U?w($t,ft,Ee,h,u,P):w(ft,$t,Ee,u,h,P);if(mt!==B){if(mt)continue;Ue=!1;break}if(rt){if(!Gm(h,function(zt,sn){if(!Ve(rt,sn)&&(ft===zt||x(ft,zt,g,w,P)))return rt.push(sn)})){Ue=!1;break}}else if(ft!==$t&&!x(ft,$t,g,w,P)){Ue=!1;break}}return P.delete(u),P.delete(h),Ue}function ta(u){return wg(Rc(u,B,Nc),u+"")}function y0(u){return rg(u,ji,bl)}function Ju(u){return rg(u,br,uf)}var v0=Aa?function(u){return Aa.get(u)}:pd;function cf(u){for(var h=u.name+"",g=Ut[h],w=En.call(Ut,h)?g.length:0;w--;){var x=g[w],P=x.func;if(null==P||P==u)return x.name}return h}function Dc(u){return(En.call(D,"placeholder")?D:u).placeholder}function pt(){var u=D.iteratee||c_;return u=u===c_?ag:u,arguments.length?u(arguments[0],arguments[1]):u}function vg(u,h){var g=u.__data__;return function PM(u){var h=typeof u;return"string"==h||"number"==h||"symbol"==h||"boolean"==h?"__proto__"!==u:null===u}(h)?g["string"==typeof h?"string":"hash"]:g.map}function Qu(u){for(var h=ji(u),g=h.length;g--;){var w=h[g],x=u[w];h[g]=[w,x,w0(x)]}return h}function to(u,h){var g=function Wo(j,ae){return null==j?B:j[ae]}(u,h);return e0(g)?g:B}var bl=Ca?function(u){return null==u?[]:(u=Dn(u),un(Ca(u),function(h){return Zm.call(u,h)}))}:TE,uf=Ca?function(u){for(var h=[];u;)xo(h,bl(u)),u=gr(u);return h}:TE,Ni=Pr;function Eg(u,h,g){for(var w=-1,x=(h=Po(h,u)).length,P=!1;++w<x;){var U=Or(h[w]);if(!(P=null!=u&&g(u,U)))break;u=u[U]}return P||++w!=x?P:!!(x=null==u?0:u.length)&&od(x)&&No(U,x)&&(Nt(u)||Tl(u))}function no(u){return"function"!=typeof u.constructor||Ic(u)?{}:Ri(gr(u))}function bg(u){return Nt(u)||Tl(u)||!!(Gv&&u&&u[Gv])}function No(u,h){var g=typeof u;return!!(h=h??tn)&&("number"==g||"symbol"!=g&&MI.test(u))&&u>-1&&u%1==0&&u<h}function $i(u,h,g){if(!qn(g))return!1;var w=typeof h;return!!("number"==w?Er(g)&&No(h,g.length):"string"==w&&h in g)&&io(g[h],u)}function ed(u,h){if(Nt(u))return!1;var g=typeof u;return!("number"!=g&&"symbol"!=g&&"boolean"!=g&&null!=u&&!ds(u))||Vw.test(u)||!gv.test(u)||null!=h&&u in Dn(h)}function hf(u){var h=cf(u),g=D[h];if("function"!=typeof g||!(h in Bt.prototype))return!1;if(u===g)return!0;var w=v0(g);return!!w&&u===w[0]}(Ds&&Ni(new Ds(new ArrayBuffer(1)))!=dc||Xo&&Ni(new Xo)!=Ys||Lh&&Ni(Lh.resolve())!=Lw||os&&Ni(new os)!=Ks||as&&Ni(new as)!=uc)&&(Ni=function(u){var h=Pr(u),g=h==Sa?u.constructor:B,w=g?Ba(g):"";if(w)switch(w){case kI:return dc;case Jm:return Ys;case Wv:return Lw;case Ao:return Ks;case Oh:return uc}return h});var S0=ss?Ls:CE;function Ic(u){var h=u&&u.constructor;return u===("function"==typeof h&&h.prototype||gc)}function w0(u){return u==u&&!qn(u)}function td(u,h){return function(g){return null!=g&&g[u]===h&&(h!==B||u in Dn(g))}}function Rc(u,h,g){return h=ei(h===B?u.length-1:h,0),function(){for(var w=arguments,x=-1,P=ei(w.length-h,0),U=ne(P);++x<P;)U[x]=w[h+x];x=-1;for(var G=ne(h+1);++x<h;)G[x]=w[x];return G[h]=g(U),Ir(u,this,G)}}function T0(u,h){return h.length<2?u:La(u,cs(h,0,-1))}function Sg(u,h){if(("constructor"!==h||"function"!=typeof u[h])&&"__proto__"!=h)return u[h]}var _i=nd(l0),wl=Zs||function(u,h){return mr.setTimeout(u,h)},wg=nd(wM);function Mg(u,h,g){var w=h+"";return wg(u,function df(u,h){var g=h.length;if(!g)return u;var w=g-1;return h[w]=(g>1?"& ":"")+h[w],h=h.join(g>2?", ":" "),u.replace(Hw,"{\n/* [wrapped with "+h+"] */\n")}(w,function xg(u,h){return Hn(bo,function(g){var w="_."+g[0];h&g[1]&&!Hm(u,w)&&u.push(w)}),u.sort()}(function E0(u){var h=u.match(zw);return h?h[1].split(Gw):[]}(w),g)))}function nd(u){var h=0,g=0;return function(){var w=yc(),x=16-(w-g);if(g=w,x>0){if(++h>=800)return arguments[0]}else h=0;return u.apply(B,arguments)}}function na(u,h){var g=-1,w=u.length,x=w-1;for(h=h===B?w:h;++g<h;){var P=Yh(g,x),U=u[P];u[P]=u[g],u[g]=U}return u.length=h,u}var Ml=function Sl(u){var h=Tf(u,function(w){return 500===g.size&&g.clear(),w}),g=h.cache;return h}(function(u){var h=[];return 46===u.charCodeAt(0)&&h.push(""),u.replace(_v,function(g,w,x,P){h.push(x?P.replace($w,"$1"):w||g)}),h});function Or(u){if("string"==typeof u||ds(u))return u;var h=u+"";return"0"==h&&1/u==-qe?"-0":h}function Ba(u){if(null!=u){try{return Ph.call(u)}catch{}try{return u+""}catch{}}return""}function xl(u){if(u instanceof Bt)return u.clone();var h=new zr(u.__wrapped__,u.__chain__);return h.__actions__=yr(u.__actions__),h.__index__=u.__index__,h.__values__=u.__values__,h}var iR=Wt(function(u,h){return ti(u)?Vh(u,Pi(h,1,ti,!0)):[]}),rR=Wt(function(u,h){var g=jn(h);return ti(g)&&(g=B),ti(u)?Vh(u,Pi(h,1,ti,!0),pt(g,2)):[]}),sR=Wt(function(u,h){var g=jn(h);return ti(g)&&(g=B),ti(u)?Vh(u,Pi(h,1,ti,!0),B,g):[]});function yi(u,h,g){var w=null==u?0:u.length;if(!w)return-1;var x=null==g?0:Ht(g);return x<0&&(x=ei(w+x,0)),$m(u,pt(h,3),x)}function C0(u,h,g){var w=null==u?0:u.length;if(!w)return-1;var x=w-1;return g!==B&&(x=Ht(g),x=g<0?ei(w+x,0):nr(x,w-1)),$m(u,pt(h,3),x,!0)}function Nc(u){return null!=u&&u.length?Pi(u,1):[]}function Tg(u){return u&&u.length?u[0]:B}var UM=Wt(function(u){var h=Nn(u,Rs);return h.length&&h[0]===u[0]?Wh(h):[]}),lR=Wt(function(u){var h=jn(u),g=Nn(u,Rs);return h===jn(g)?h=B:g.pop(),g.length&&g[0]===u[0]?Wh(g,pt(h,2)):[]}),BM=Wt(function(u){var h=jn(u),g=Nn(u,Rs);return(h="function"==typeof h?h:B)&&g.pop(),g.length&&g[0]===u[0]?Wh(g,B,h):[]});function jn(u){var h=null==u?0:u.length;return h?u[h-1]:B}var uR=Wt(Ag);function Ag(u,h){return u&&u.length&&h&&h.length?Xh(u,h):u}var zM=ta(function(u,h){var g=null==u?0:u.length,w=Bh(u,h);return s0(u,Nn(h,function(x){return No(x,g)?+x:x}).sort(ug)),w});function Dg(u){return null==u?u:Ec.call(u)}var Fc=Wt(function(u){return me(Pi(u,1,ti,!0))}),rd=Wt(function(u){var h=jn(u);return ti(h)&&(h=B),me(Pi(u,1,ti,!0),pt(h,2))}),KM=Wt(function(u){var h=jn(u);return h="function"==typeof h?h:B,me(Pi(u,1,ti,!0),B,h)});function R0(u){if(!u||!u.length)return[];var h=0;return u=un(u,function(g){if(ti(g))return h=ei(g.length,h),!0}),Xm(h,function(g){return Nn(u,jm(g))})}function P0(u,h){if(!u||!u.length)return[];var g=R0(u);return null==h?g:Nn(g,function(w){return Ir(h,B,w)})}var JM=Wt(function(u,h){return ti(u)?Vh(u,h):[]}),QM=Wt(function(u){return ef(un(u,ti))}),yf=Wt(function(u){var h=jn(u);return ti(h)&&(h=B),ef(un(u,ti),pt(h,2))}),N0=Wt(function(u){var h=jn(u);return h="function"==typeof h?h:B,ef(un(u,ti),B,h)}),ex=Wt(R0),O0=Wt(function(u){var h=u.length,g=h>1?u[h-1]:B;return g="function"==typeof g?(u.pop(),g):B,P0(u,g)});function tx(u){var h=D(u);return h.__chain__=!0,h}function vf(u,h){return h(u)}var Pg=ta(function(u){var h=u.length,g=h?u[0]:0,w=this.__wrapped__,x=function(P){return Bh(P,u)};return!(h>1||this.__actions__.length)&&w instanceof Bt&&No(g)?((w=w.slice(g,+g+(h?1:0))).__actions__.push({func:vf,args:[x],thisArg:B}),new zr(w,this.__chain__).thru(function(P){return h&&!P.length&&P.push(B),P})):this.thru(x)}),vR=Xu(function(u,h,g){En.call(u,g)?++u[g]:Io(u,g,1)}),bf=vr(yi),F0=vr(C0);function Lg(u,h){return(Nt(u)?Hn:yl)(u,pt(h,3))}function Og(u,h){return(Nt(u)?Pv:mM)(u,pt(h,3))}var Sf=Xu(function(u,h,g){En.call(u,g)?u[g].push(h):Io(u,g,[h])}),Va=Wt(function(u,h,g){var w=-1,x="function"==typeof h,P=Er(u)?ne(u.length):[];return yl(u,function(U){P[++w]=x?Ir(h,U,g):$h(U,h,g)}),P}),rx=Xu(function(u,h,g){Io(u,g,h)});function Mf(u,h){return(Nt(u)?Nn:$u)(u,pt(h,3))}var B0=Xu(function(u,h,g){u[g?0:1].push(h)},function(){return[[],[]]}),kg=Wt(function(u,h){if(null==u)return[];var g=h.length;return g>1&&$i(u,h[0],h[1])?h=[]:g>2&&$i(h[0],h[1],h[2])&&(h=[h[0]]),n0(u,Pi(h,1),[])}),sd=$n||function(){return mr.Date.now()};function rr(u,h,g){return h=g?B:h,Ps(u,128,B,B,B,B,h=u&&null==h?u.length:h)}function Uc(u,h){var g;if("function"!=typeof h)throw new rs(ai);return u=Ht(u),function(){return--u>0&&(g=h.apply(this,arguments)),u<=1&&(h=B),g}}var xf=Wt(function(u,h,g){var w=1;if(g.length){var x=Co(g,Dc(xf));w|=32}return Ps(u,w,h,g,x)}),Bg=Wt(function(u,h,g){var w=3;if(g.length){var x=Co(g,Dc(Bg));w|=32}return Ps(h,w,u,g,x)});function z0(u,h,g){var w,x,P,U,G,X,fe=0,pe=!1,Ee=!1,Ue=!0;if("function"!=typeof u)throw new rs(ai);function rt(zn){var vi=w,sa=x;return w=x=B,fe=zn,U=u.apply(sa,vi)}function mt(zn){var vi=zn-X;return X===B||vi>=h||vi<0||Ee&&zn-fe>=P}function zt(){var zn=sd();if(mt(zn))return sn(zn);G=wl(zt,function $t(zn){var DE=h-(zn-X);return Ee?nr(DE,P-(zn-fe)):DE}(zn))}function sn(zn){return G=B,Ue&&w?rt(zn):(w=x=B,U)}function fs(){var zn=sd(),vi=mt(zn);if(w=arguments,x=this,X=zn,vi){if(G===B)return function ft(zn){return fe=zn,G=wl(zt,h),pe?rt(zn):U}(X);if(Ee)return cg(G),G=wl(zt,h),rt(X)}return G===B&&(G=wl(zt,h)),U}return h=$r(h)||0,qn(g)&&(pe=!!g.leading,P=(Ee="maxWait"in g)?ei($r(g.maxWait)||0,h):P,Ue="trailing"in g?!!g.trailing:Ue),fs.cancel=function qi(){G!==B&&cg(G),fe=0,w=X=x=G=B},fs.flush=function Tn(){return G===B?U:sn(sd())},fs}var G0=Wt(function(u,h){return tg(u,1,h)}),dx=Wt(function(u,h,g){return tg(u,$r(h)||0,g)});function Tf(u,h){if("function"!=typeof u||null!=h&&"function"!=typeof h)throw new rs(ai);var g=function(){var w=arguments,x=h?h.apply(this,w):w[0],P=g.cache;if(P.has(x))return P.get(x);var U=u.apply(this,w);return g.cache=P.set(x,U)||P,U};return g.cache=new(Tf.Cache||Ia),g}function Cf(u){if("function"!=typeof u)throw new rs(ai);return function(){var h=arguments;switch(h.length){case 0:return!u.call(this);case 1:return!u.call(this,h[0]);case 2:return!u.call(this,h[0],h[1]);case 3:return!u.call(this,h[0],h[1],h[2])}return!u.apply(this,h)}}Tf.Cache=Ia;var zg=xM(function(u,h){var g=(h=1==h.length&&Nt(h[0])?Nn(h[0],Ne(pt())):Nn(Pi(h,1),Ne(pt()))).length;return Wt(function(w){for(var x=-1,P=nr(w.length,g);++x<P;)w[x]=h[x].call(this,w[x]);return Ir(u,this,w)})}),Gg=Wt(function(u,h){var g=Co(h,Dc(Gg));return Ps(u,32,B,h,g)}),Bc=Wt(function(u,h){var g=Co(h,Dc(Bc));return Ps(u,64,B,h,g)}),hx=ta(function(u,h){return Ps(u,256,B,B,B,h)});function io(u,h){return u===h||u!=u&&h!=h}var gx=El(sg),_x=El(function(u,h){return u>=h}),Tl=Zv(function(){return arguments}())?Zv:function(u){return ni(u)&&En.call(u,"callee")&&!Zm.call(u,"callee")},Nt=ne.isArray,If=Iu?Ne(Iu):function Is(u){return ni(u)&&Pr(u)==Tu};function Er(u){return null!=u&&od(u.length)&&!Ls(u)}function ti(u){return ni(u)&&Er(u)}var Ha=ui||CE,$g=Ru?Ne(Ru):function Jv(u){return ni(u)&&Pr(u)==ts};function jg(u){if(!ni(u))return!1;var h=Pr(u);return h==lc||"[object DOMException]"==h||"string"==typeof u.message&&"string"==typeof u.name&&!Al(u)}function Ls(u){if(!qn(u))return!1;var h=Pr(u);return h==hh||h==uv||"[object AsyncFunction]"==h||"[object Proxy]"==h}function J0(u){return"number"==typeof u&&u==Ht(u)}function od(u){return"number"==typeof u&&u>-1&&u%1==0&&u<=tn}function qn(u){var h=typeof u;return null!=u&&("object"==h||"function"==h)}function ni(u){return null!=u&&"object"==typeof u}var Rf=Mh?Ne(Mh):function Qv(u){return ni(u)&&Ni(u)==Ys};function Xg(u){return"number"==typeof u||ni(u)&&Pr(u)==fh}function Al(u){if(!ni(u)||Pr(u)!=Sa)return!1;var h=gr(u);if(null===h)return!0;var g=En.call(h,"constructor")&&h.constructor;return"function"==typeof g&&g instanceof g&&Ph.call(g)==zv}var Dl=Vm?Ne(Vm):function og(u){return ni(u)&&Pr(u)==cc},Yg=Iv?Ne(Iv):function bM(u){return ni(u)&&Ni(u)==Ks};function Lf(u){return"string"==typeof u||!Nt(u)&&ni(u)&&Pr(u)==ul}function ds(u){return"symbol"==typeof u||ni(u)&&Pr(u)==ph}var Hc=Xt?Ne(Xt):function Ro(u){return ni(u)&&od(u.length)&&!!Bn[Pr(u)]},Kg=El(Wu),zc=El(function(u,h){return u<=h});function iE(u){if(!u)return[];if(Er(u))return Lf(u)?As(u):yr(u);if(Vu&&u[Vu])return function To(j){for(var ae,ne=[];!(ae=j.next()).done;)ne.push(ae.value);return ne}(u[Vu]());var h=Ni(u);return(h==Ys?ln:h==Ks?mc:Il)(u)}function ia(u){return u?(u=$r(u))===qe||u===-qe?17976931348623157e292*(u<0?-1:1):u==u?u:0:0===u?u:0}function Ht(u){var h=ia(u),g=h%1;return h==h?g?h-g:h:0}function rE(u){return u?Na(Ht(u),0,An):0}function $r(u){if("number"==typeof u)return u;if(ds(u))return NaN;if(qn(u)){var h="function"==typeof u.valueOf?u.valueOf():u;u=qn(h)?h+"":h}if("string"!=typeof u)return 0===u?u:+u;u=Fv(u);var g=er.test(u);return g||Mo.test(u)?LI(u.slice(2),g?2:8):qw.test(u)?NaN:+u}function sE(u){return eo(u,br(u))}function dn(u){return null==u?"":us(u)}var Zg=Fa(function(u,h){if(Ic(h)||Er(h))eo(h,ji(h),u);else for(var g in h)En.call(h,g)&&bc(u,g,h[g])}),Jg=Fa(function(u,h){eo(h,br(h),u)}),ld=Fa(function(u,h,g,w){eo(h,br(h),u,w)}),oE=Fa(function(u,h,g,w){eo(h,ji(h),u,w)}),aE=ta(Bh),bx=Wt(function(u,h){u=Dn(u);var g=-1,w=h.length,x=w>2?h[2]:B;for(x&&$i(h[0],h[1],x)&&(w=1);++g<w;)for(var P=h[g],U=br(P),G=-1,X=U.length;++G<X;){var fe=U[G],pe=u[fe];(pe===B||io(pe,gc[fe])&&!En.call(u,fe))&&(u[fe]=P[fe])}return u}),Sx=Wt(function(u){return u.push(B,yg),Ir(Qg,B,u)});function lE(u,h,g){var w=null==u?B:La(u,h);return w===B?g:w}function Ff(u,h){return null!=u&&Eg(u,h,Kv)}var Tx=nf(function(u,h,g){null!=h&&"function"!=typeof h.toString&&(h=Nh.call(h)),u[h]=g},fd(Sr)),Cx=nf(function(u,h,g){null!=h&&"function"!=typeof h.toString&&(h=Nh.call(h)),En.call(u,h)?u[h].push(g):u[h]=[g]},pt),Ax=Wt($h);function ji(u){return Er(u)?Hu(u):qh(u)}function br(u){return Er(u)?Hu(u,!0):function Ln(u){if(!qn(u))return function M0(u){var h=[];if(null!=u)for(var g in Dn(u))h.push(g);return h}(u);var h=Ic(u),g=[];for(var w in u)"constructor"==w&&(h||!En.call(u,w))||g.push(w);return g}(u)}var cE=Fa(function(u,h,g){ju(u,h,g)}),Qg=Fa(function(u,h,g,w){ju(u,h,g,w)}),uE=ta(function(u,h){var g={};if(null==u)return g;var w=!1;h=Nn(h,function(P){return P=Po(P,u),w||(w=P.length>1),P}),eo(u,Ju(u),g),w&&(g=Rr(g,7,g0));for(var x=h.length;x--;)nn(g,h[x]);return g}),TR=ta(function(u,h){return null==u?{}:function SM(u,h){return r0(u,h,function(g,w){return Ff(u,w)})}(u,h)});function Dx(u,h){if(null==u)return{};var g=Nn(Ju(u),function(w){return[w]});return h=pt(h),r0(u,g,function(w,x){return h(w,x[0])})}var Ix=Ku(ji),n_=Ku(br);function Il(u){return null==u?[]:Ch(u,ji(u))}var Wc=ka(function(u,h,g){return h=h.toLowerCase(),u+(g?dE(h):h)});function dE(u){return Bf(dn(u).toLowerCase())}function hE(u){return(u=dn(u))&&u.replace(Xw,oM).replace(tM,"")}var Ux=ka(function(u,h,g){return u+(g?"-":"")+h.toLowerCase()}),Bx=ka(function(u,h,g){return u+(g?" ":"")+h.toLowerCase()}),Vx=pg("toLowerCase"),gE=ka(function(u,h,g){return u+(g?"_":"")+h.toLowerCase()}),r_=ka(function(u,h,g){return u+(g?" ":"")+Bf(h)}),EE=ka(function(u,h,g){return u+(g?" ":"")+h.toUpperCase()}),Bf=pg("toUpperCase");function Ga(u,h,g){return u=dn(u),(h=g?B:h)===B?function Cs(j){return DI.test(j)}(u)?function Vv(j){return j.match(dl)||[]}(u):function FI(j){return j.match(Ww)||[]}(u):u.match(h)||[]}var bE=Wt(function(u,h){try{return Ir(u,B,h)}catch(g){return jg(g)?g:new Pt(g)}}),l_=ta(function(u,h){return Hn(h,function(g){g=Or(g),Io(u,g,xf(u[g],u))}),u});function fd(u){return function(){return u}}var hs=Ua(),zf=Ua(!0);function Sr(u){return u}function c_(u){return ag("function"==typeof u?u:Rr(u,1))}var $c=Wt(function(u,h){return function(g){return $h(g,u,h)}}),$x=Wt(function(u,h){return function(g){return $h(u,g,h)}});function u_(u,h,g){var w=ji(h),x=Gh(h,w);null==g&&(!qn(h)||!x.length&&w.length)&&(g=h,h=u,u=this,x=Gh(h,ji(h)));var P=!(qn(g)&&"chain"in g&&!g.chain),U=Ls(u);return Hn(x,function(G){var X=h[G];u[G]=X,U&&(u.prototype[G]=function(){var fe=this.__chain__;if(P||fe){var pe=u(this.__wrapped__);return(pe.__actions__=yr(this.__actions__)).push({func:X,args:arguments,thisArg:u}),pe.__chain__=fe,pe}return X.apply(u,xo([this.value()],arguments))})}),u}function pd(){}var qx=mg(Nn),wE=mg(rM),Wa=mg(Gm);function Xx(u){return ed(u)?jm(Or(u)):function Oa(u){return function(h){return La(h,u)}}(u)}var xE=gg(),Yx=gg(!0);function TE(){return[]}function CE(){return!1}var p_=rf(function(u,h){return u+h},0),md=_g("ceil"),$f=rf(function(u,h){return u/h},1),qc=_g("floor"),Zx=rf(function(u,h){return u*h},1),AE=_g("round"),Jx=rf(function(u,h){return u-h},0);return D.after=function Ug(u,h){if("function"!=typeof h)throw new rs(ai);return u=Ht(u),function(){if(--u<1)return h.apply(this,arguments)}},D.ary=rr,D.assign=Zg,D.assignIn=Jg,D.assignInWith=ld,D.assignWith=oE,D.at=aE,D.before=Uc,D.bind=xf,D.bindAll=l_,D.bindKey=Bg,D.castArray=function Af(){if(!arguments.length)return[];var u=arguments[0];return Nt(u)?u:[u]},D.chain=tx,D.chunk=function tR(u,h,g){h=(g?$i(u,h,g):h===B)?1:ei(Ht(h),0);var w=null==u?0:u.length;if(!w||h<1)return[];for(var x=0,P=0,U=ne(Ta(w/h));x<w;)U[P++]=cs(u,x,x+=h);return U},D.compact=function LM(u){for(var h=-1,g=null==u?0:u.length,w=0,x=[];++h<g;){var P=u[h];P&&(x[w++]=P)}return x},D.concat=function nR(){var u=arguments.length;if(!u)return[];for(var h=ne(u-1),g=arguments[0],w=u;w--;)h[w-1]=arguments[w];return xo(Nt(g)?yr(g):[g],Pi(h,1))},D.cond=function Vf(u){var h=null==u?0:u.length,g=pt();return u=h?Nn(u,function(w){if("function"!=typeof w[1])throw new rs(ai);return[g(w[0]),w[1]]}):[],Wt(function(w){for(var x=-1;++x<h;){var P=u[x];if(Ir(P[0],this,w))return Ir(P[1],this,w)}})},D.conforms=function Gx(u){return function zu(u){var h=ji(u);return function(g){return _l(g,u,h)}}(Rr(u,1))},D.constant=fd,D.countBy=vR,D.create=function Ex(u,h){var g=Ri(u);return null==h?g:Uh(g,h)},D.curry=function H0(u,h,g){var w=Ps(u,8,B,B,B,B,B,h=g?B:h);return w.placeholder=H0.placeholder,w},D.curryRight=function Vg(u,h,g){var w=Ps(u,16,B,B,B,B,B,h=g?B:h);return w.placeholder=Vg.placeholder,w},D.debounce=z0,D.defaults=bx,D.defaultsDeep=Sx,D.defer=G0,D.delay=dx,D.difference=iR,D.differenceBy=rR,D.differenceWith=sR,D.drop=function oR(u,h,g){var w=null==u?0:u.length;return w?cs(u,(h=g||h===B?1:Ht(h))<0?0:h,w):[]},D.dropRight=function aR(u,h,g){var w=null==u?0:u.length;return w?cs(u,0,(h=w-(h=g||h===B?1:Ht(h)))<0?0:h):[]},D.dropRightWhile=function Pc(u,h){return u&&u.length?xc(u,pt(h,3),!0,!0):[]},D.dropWhile=function OM(u,h){return u&&u.length?xc(u,pt(h,3),!0):[]},D.fill=function FM(u,h,g,w){var x=null==u?0:u.length;return x?(g&&"number"!=typeof g&&$i(u,h,g)&&(g=0,w=x),function QI(u,h,g,w){var x=u.length;for((g=Ht(g))<0&&(g=-g>x?0:x+g),(w=w===B||w>x?x:Ht(w))<0&&(w+=x),w=g>w?0:rE(w);g<w;)u[g++]=h;return u}(u,h,g,w)):[]},D.filter=function Ef(u,h){return(Nt(u)?un:ng)(u,pt(h,3))},D.flatMap=function k0(u,h){return Pi(Mf(u,h),1)},D.flatMapDeep=function U0(u,h){return Pi(Mf(u,h),qe)},D.flatMapDepth=function kc(u,h,g){return g=g===B?1:Ht(g),Pi(Mf(u,h),g)},D.flatten=Nc,D.flattenDeep=function kM(u){return null!=u&&u.length?Pi(u,qe):[]},D.flattenDepth=function Ns(u,h){return null!=u&&u.length?Pi(u,h=h===B?1:Ht(h)):[]},D.flip=function W0(u){return Ps(u,512)},D.flow=hs,D.flowRight=zf,D.fromPairs=function Lc(u){for(var h=-1,g=null==u?0:u.length,w={};++h<g;){var x=u[h];w[x[0]]=x[1]}return w},D.functions=function SR(u){return null==u?[]:Gh(u,ji(u))},D.functionsIn=function wR(u){return null==u?[]:Gh(u,br(u))},D.groupBy=Sf,D.initial=function id(u){return null!=u&&u.length?cs(u,0,-1):[]},D.intersection=UM,D.intersectionBy=lR,D.intersectionWith=BM,D.invert=Tx,D.invertBy=Cx,D.invokeMap=Va,D.iteratee=c_,D.keyBy=rx,D.keys=ji,D.keysIn=br,D.map=Mf,D.mapKeys=function ra(u,h){var g={};return h=pt(h,3),Jo(u,function(w,x,P){Io(g,h(w,x,P),w)}),g},D.mapValues=function ud(u,h){var g={};return h=pt(h,3),Jo(u,function(w,x,P){Io(g,x,h(w,x,P))}),g},D.matches=function Wx(u){return Nr(Rr(u,1))},D.matchesProperty=function SE(u,h){return t0(u,Rr(h,1))},D.memoize=Tf,D.merge=cE,D.mergeWith=Qg,D.method=$c,D.methodOf=$x,D.mixin=u_,D.negate=Cf,D.nthArg=function Gf(u){return u=Ht(u),Wt(function(h){return Gr(h,u)})},D.omit=uE,D.omitBy=function xR(u,h){return Dx(u,Cf(pt(h)))},D.once=function Hg(u){return Uc(2,u)},D.orderBy=function sx(u,h,g,w){return null==u?[]:(Nt(h)||(h=null==h?[]:[h]),Nt(g=w?B:g)||(g=null==g?[]:[g]),n0(u,h,g))},D.over=qx,D.overArgs=zg,D.overEvery=wE,D.overSome=Wa,D.partial=Gg,D.partialRight=Bc,D.partition=B0,D.pick=TR,D.pickBy=Dx,D.property=Xx,D.propertyOf=function ME(u){return function(h){return null==u?B:La(u,h)}},D.pull=uR,D.pullAll=Ag,D.pullAllBy=function VM(u,h,g){return u&&u.length&&h&&h.length?Xh(u,h,pt(g,2)):u},D.pullAllWith=function HM(u,h,g){return u&&u.length&&h&&h.length?Xh(u,h,B,g):u},D.pullAt=zM,D.range=xE,D.rangeRight=Yx,D.rearg=hx,D.reject=function ax(u,h){return(Nt(u)?un:ng)(u,Cf(pt(h,3)))},D.remove=function GM(u,h){var g=[];if(!u||!u.length)return g;var w=-1,x=[],P=u.length;for(h=pt(h,3);++w<P;){var U=u[w];h(U,w,u)&&(g.push(U),x.push(w))}return s0(u,x),g},D.rest=function fx(u,h){if("function"!=typeof u)throw new rs(ai);return Wt(u,h=h===B?h:Ht(h))},D.reverse=Dg,D.sampleSize=function V0(u,h,g){return h=(g?$i(u,h,g):h===B)?1:Ht(h),(Nt(u)?jv:a0)(u,h)},D.set=function t_(u,h,g){return null==u?u:Zh(u,h,g)},D.setWith=function CR(u,h,g,w){return w="function"==typeof w?w:B,null==u?u:Zh(u,h,g,w)},D.shuffle=function cx(u){return(Nt(u)?qv:MM)(u)},D.slice=function WM(u,h,g){var w=null==u?0:u.length;return w?(g&&"number"!=typeof g&&$i(u,h,g)?(h=0,g=w):(h=null==h?0:Ht(h),g=g===B?w:Ht(g)),cs(u,h,g)):[]},D.sortBy=kg,D.sortedUniq=function qM(u){return u&&u.length?c0(u):[]},D.sortedUniqBy=function A0(u,h){return u&&u.length?c0(u,pt(h,2)):[]},D.split=function _E(u,h,g){return g&&"number"!=typeof g&&$i(u,h,g)&&(h=g=B),(g=g===B?An:g>>>0)?(u=dn(u))&&("string"==typeof h||null!=h&&!Dl(h))&&!(h=us(h))&&$o(u)?vl(As(u),0,g):u.split(h,g):[]},D.spread=function $0(u,h){if("function"!=typeof u)throw new rs(ai);return h=null==h?0:ei(Ht(h),0),Wt(function(g){var w=g[h],x=vl(g,0,h);return w&&xo(x,w),Ir(u,this,x)})},D.tail=function Rg(u){var h=null==u?0:u.length;return h?cs(u,1,h):[]},D.take=function _f(u,h,g){return u&&u.length?cs(u,0,(h=g||h===B?1:Ht(h))<0?0:h):[]},D.takeRight=function D0(u,h,g){var w=null==u?0:u.length;return w?cs(u,(h=w-(h=g||h===B?1:Ht(h)))<0?0:h,w):[]},D.takeRightWhile=function XM(u,h){return u&&u.length?xc(u,pt(h,3),!1,!0):[]},D.takeWhile=function YM(u,h){return u&&u.length?xc(u,pt(h,3)):[]},D.tap=function nx(u,h){return h(u),u},D.throttle=function j0(u,h,g){var w=!0,x=!0;if("function"!=typeof u)throw new rs(ai);return qn(g)&&(w="leading"in g?!!g.leading:w,x="trailing"in g?!!g.trailing:x),z0(u,h,{leading:w,maxWait:h,trailing:x})},D.thru=vf,D.toArray=iE,D.toPairs=Ix,D.toPairsIn=n_,D.toPath=function jc(u){return Nt(u)?Nn(u,Or):ds(u)?[u]:yr(Ml(dn(u)))},D.toPlainObject=sE,D.transform=function Rx(u,h,g){var w=Nt(u),x=w||Ha(u)||Hc(u);if(h=pt(h,4),null==g){var P=u&&u.constructor;g=x?w?new P:[]:qn(u)&&Ls(P)?Ri(gr(u)):{}}return(x?Hn:Jo)(u,function(U,G,X){return h(g,U,G,X)}),g},D.unary=function q0(u){return rr(u,1)},D.union=Fc,D.unionBy=rd,D.unionWith=KM,D.uniq=function dR(u){return u&&u.length?me(u):[]},D.uniqBy=function I0(u,h){return u&&u.length?me(u,pt(h,2)):[]},D.uniqWith=function ZM(u,h){return h="function"==typeof h?h:B,u&&u.length?me(u,B,h):[]},D.unset=function Px(u,h){return null==u||nn(u,h)},D.unzip=R0,D.unzipWith=P0,D.update=function Nx(u,h,g){return null==u?u:Qh(u,h,qu(g))},D.updateWith=function Lx(u,h,g,w){return w="function"==typeof w?w:B,null==u?u:Qh(u,h,qu(g),w)},D.values=Il,D.valuesIn=function kf(u){return null==u?[]:Ch(u,br(u))},D.without=JM,D.words=Ga,D.wrap=function Vc(u,h){return Gg(qu(h),u)},D.xor=QM,D.xorBy=yf,D.xorWith=N0,D.zip=ex,D.zipObject=function L0(u,h){return Tc(u||[],h||[],bc)},D.zipObjectDeep=function hR(u,h){return Tc(u||[],h||[],Zh)},D.zipWith=O0,D.entries=Ix,D.entriesIn=n_,D.extend=Jg,D.extendWith=ld,u_(D,D),D.add=p_,D.attempt=bE,D.camelCase=Wc,D.capitalize=dE,D.ceil=md,D.clamp=function Ox(u,h,g){return g===B&&(g=h,h=B),g!==B&&(g=(g=$r(g))==g?g:0),h!==B&&(h=(h=$r(h))==h?h:0),Na($r(u),h,g)},D.clone=function X0(u){return Rr(u,4)},D.cloneDeep=function Df(u){return Rr(u,5)},D.cloneDeepWith=function px(u,h){return Rr(u,5,h="function"==typeof h?h:B)},D.cloneWith=function Wg(u,h){return Rr(u,4,h="function"==typeof h?h:B)},D.conformsTo=function mx(u,h){return null==h||_l(u,h,ji(h))},D.deburr=hE,D.defaultTo=function Hf(u,h){return null==u||u!=u?h:u},D.divide=$f,D.endsWith=function fE(u,h,g){u=dn(u),h=us(h);var w=u.length,x=g=g===B?w:Na(Ht(g),0,w);return(g-=h.length)>=0&&u.slice(g,x)==h},D.eq=io,D.escape=function pE(u){return(u=dn(u))&&fv.test(u)?u.replace(hv,aM):u},D.escapeRegExp=function kx(u){return(u=dn(u))&&yv.test(u)?u.replace(_h,"\\$&"):u},D.every=function ix(u,h,g){var w=Nt(u)?rM:gM;return g&&$i(u,h,g)&&(h=B),w(u,pt(h,3))},D.find=bf,D.findIndex=yi,D.findKey=function wx(u,h){return sM(u,pt(h,3),Jo)},D.findLast=F0,D.findLastIndex=C0,D.findLastKey=function Mx(u,h){return sM(u,pt(h,3),Yv)},D.floor=qc,D.forEach=Lg,D.forEachRight=Og,D.forIn=function za(u,h){return null==u?u:ig(u,pt(h,3),br)},D.forInRight=function cd(u,h){return null==u?u:zh(u,pt(h,3),br)},D.forOwn=function xx(u,h){return u&&Jo(u,pt(h,3))},D.forOwnRight=function bR(u,h){return u&&Yv(u,pt(h,3))},D.get=lE,D.gt=gx,D.gte=_x,D.has=function MR(u,h){return null!=u&&Eg(u,h,_M)},D.hasIn=Ff,D.head=Tg,D.identity=Sr,D.includes=function wf(u,h,g,w){u=Er(u)?u:Il(u),g=g&&!w?Ht(g):0;var x=u.length;return g<0&&(g=ei(x+g,0)),Lf(u)?g<=x&&u.indexOf(h,g)>-1:!!x&&Pu(u,h,g)>-1},D.indexOf=function ff(u,h,g){var w=null==u?0:u.length;if(!w)return-1;var x=null==g?0:Ht(g);return x<0&&(x=ei(w+x,0)),Pu(u,h,x)},D.inRange=function i_(u,h,g){return h=ia(h),g===B?(g=h,h=0):g=ia(g),function yM(u,h,g){return u>=nr(h,g)&&u<ei(h,g)}(u=$r(u),h,g)},D.invoke=Ax,D.isArguments=Tl,D.isArray=Nt,D.isArrayBuffer=If,D.isArrayLike=Er,D.isArrayLikeObject=ti,D.isBoolean=function yx(u){return!0===u||!1===u||ni(u)&&Pr(u)==Rt},D.isBuffer=Ha,D.isDate=$g,D.isElement=function Y0(u){return ni(u)&&1===u.nodeType&&!Al(u)},D.isEmpty=function Cl(u){if(null==u)return!0;if(Er(u)&&(Nt(u)||"string"==typeof u||"function"==typeof u.splice||Ha(u)||Hc(u)||Tl(u)))return!u.length;var h=Ni(u);if(h==Ys||h==Ks)return!u.size;if(Ic(u))return!qh(u).length;for(var g in u)if(En.call(u,g))return!1;return!0},D.isEqual=function K0(u,h){return Gu(u,h)},D.isEqualWith=function Z0(u,h,g){var w=(g="function"==typeof g?g:B)?g(u,h):B;return w===B?Gu(u,h,B,g):!!w},D.isError=jg,D.isFinite=function ER(u){return"number"==typeof u&&qo(u)},D.isFunction=Ls,D.isInteger=J0,D.isLength=od,D.isMap=Rf,D.isMatch=function Q0(u,h){return u===h||jh(u,h,Qu(h))},D.isMatchWith=function Pf(u,h,g){return g="function"==typeof g?g:B,jh(u,h,Qu(h),g)},D.isNaN=function ad(u){return Xg(u)&&u!=+u},D.isNative=function eE(u){if(S0(u))throw new Pt("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return e0(u)},D.isNil=function Nf(u){return null==u},D.isNull=function qg(u){return null===u},D.isNumber=Xg,D.isObject=qn,D.isObjectLike=ni,D.isPlainObject=Al,D.isRegExp=Dl,D.isSafeInteger=function vx(u){return J0(u)&&u>=-tn&&u<=tn},D.isSet=Yg,D.isString=Lf,D.isSymbol=ds,D.isTypedArray=Hc,D.isUndefined=function tE(u){return u===B},D.isWeakMap=function nE(u){return ni(u)&&Ni(u)==uc},D.isWeakSet=function Of(u){return ni(u)&&"[object WeakSet]"==Pr(u)},D.join=function cR(u,h){return null==u?"":_c.call(u,h)},D.kebabCase=Ux,D.last=jn,D.lastIndexOf=function Cg(u,h,g){var w=null==u?0:u.length;if(!w)return-1;var x=w;return g!==B&&(x=(x=Ht(g))<0?ei(w+x,0):nr(x,w-1)),h==h?function Uu(j,ae,ne){for(var Fe=ne+1;Fe--;)if(j[Fe]===ae)return Fe;return Fe}(u,h,x):$m(u,Th,x,!0)},D.lowerCase=Bx,D.lowerFirst=Vx,D.lt=Kg,D.lte=zc,D.max=function m_(u){return u&&u.length?Hh(u,Sr,sg):B},D.maxBy=function g_(u,h){return u&&u.length?Hh(u,pt(h,2),sg):B},D.mean=function jf(u){return Lu(u,Sr)},D.meanBy=function RR(u,h){return Lu(u,pt(h,2))},D.min=function __(u){return u&&u.length?Hh(u,Sr,Wu):B},D.minBy=function gd(u,h){return u&&u.length?Hh(u,pt(h,2),Wu):B},D.stubArray=TE,D.stubFalse=CE,D.stubObject=function Wf(){return{}},D.stubString=function Kx(){return""},D.stubTrue=function d_(){return!0},D.multiply=Zx,D.nth=function Oc(u,h){return u&&u.length?Gr(u,Ht(h)):B},D.noConflict=function jx(){return mr._===this&&(mr._=_t),this},D.noop=pd,D.now=sd,D.pad=function mE(u,h,g){u=dn(u);var w=(h=Ht(h))?hl(u):0;if(!h||w>=h)return u;var x=(h-w)/2;return sf(Ii(x),g)+u+sf(Ta(x),g)},D.padEnd=function AR(u,h,g){u=dn(u);var w=(h=Ht(h))?hl(u):0;return h&&w<h?u+sf(h-w,g):u},D.padStart=function DR(u,h,g){u=dn(u);var w=(h=Ht(h))?hl(u):0;return h&&w<h?sf(h-w,g)+u:u},D.parseInt=function dd(u,h,g){return g||null==h?h=0:h&&(h=+h),di(dn(u).replace(yh,""),h||0)},D.random=function Fx(u,h,g){if(g&&"boolean"!=typeof g&&$i(u,h,g)&&(h=g=B),g===B&&("boolean"==typeof h?(g=h,h=B):"boolean"==typeof u&&(g=u,u=B)),u===B&&h===B?(u=0,h=1):(u=ia(u),h===B?(h=u,u=0):h=ia(h)),u>h){var w=u;u=h,h=w}if(g||u%1||h%1){var x=vc();return nr(u+x*(h-u+NI("1e-"+((x+"").length-1))),h)}return Yh(u,h)},D.reduce=function Fg(u,h,g){var w=Nt(u)?xh:Lv,x=arguments.length<3;return w(u,pt(h,4),g,x,yl)},D.reduceRight=function ox(u,h,g){var w=Nt(u)?zm:Lv,x=arguments.length<3;return w(u,pt(h,4),g,x,mM)},D.repeat=function Ye(u,h,g){return h=(g?$i(u,h,g):h===B)?1:Ht(h),Kh(dn(u),h)},D.replace=function hd(){var u=arguments,h=dn(u[0]);return u.length<3?h:h.replace(u[1],u[2])},D.result=function e_(u,h,g){var w=-1,x=(h=Po(h,u)).length;for(x||(x=1,u=B);++w<x;){var P=null==u?B:u[Or(h[w])];P===B&&(w=x,P=g),u=Ls(P)?P.call(u):P}return u},D.round=AE,D.runInContext=j,D.sample=function lx(u){return(Nt(u)?ls:bt)(u)},D.size=function ux(u){if(null==u)return 0;if(Er(u))return Lf(u)?hl(u):u.length;var h=Ni(u);return h==Ys||h==Ks?u.size:qh(u).length},D.snakeCase=gE,D.some=function Wr(u,h,g){var w=Nt(u)?Gm:Mc;return g&&$i(u,h,g)&&(h=B),w(u,pt(h,3))},D.sortedIndex=function Ig(u,h){return Jh(u,h)},D.sortedIndexBy=function pf(u,h,g){return lg(u,h,pt(g,2))},D.sortedIndexOf=function $M(u,h){var g=null==u?0:u.length;if(g){var w=Jh(u,h);if(w<g&&io(u[w],h))return w}return-1},D.sortedLastIndex=function mf(u,h){return Jh(u,h,!0)},D.sortedLastIndexBy=function jM(u,h,g){return lg(u,h,pt(g,2),!0)},D.sortedLastIndexOf=function gf(u,h){if(null!=u&&u.length){var w=Jh(u,h,!0)-1;if(io(u[w],h))return w}return-1},D.startCase=r_,D.startsWith=function s_(u,h,g){return u=dn(u),g=null==g?0:Na(Ht(g),0,u.length),h=us(h),u.slice(g,g+h.length)==h},D.subtract=Jx,D.sum=function Qx(u){return u&&u.length?Ma(u,Sr):0},D.sumBy=function y_(u,h){return u&&u.length?Ma(u,pt(h,2)):0},D.template=function Hx(u,h,g){var w=D.templateSettings;g&&$i(u,h,g)&&(h=B),u=dn(u),h=ld({},h,w,lf);var G,X,x=ld({},h.imports,w.imports,lf),P=ji(x),U=Ch(x,P),fe=0,pe=h.interpolate||vh,Ee="__p += '",Ue=Ym((h.escape||vh).source+"|"+pe.source+"|"+(pe===Nm?jw:vh).source+"|"+(h.evaluate||vh).source+"|$","g"),rt="//# sourceURL="+(En.call(h,"sourceURL")?(h.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++RI+"]")+"\n";u.replace(Ue,function(mt,zt,sn,qi,Tn,fs){return sn||(sn=qi),Ee+=u.slice(fe,fs).replace(Lm,lM),zt&&(G=!0,Ee+="' +\n__e("+zt+") +\n'"),Tn&&(X=!0,Ee+="';\n"+Tn+";\n__p += '"),sn&&(Ee+="' +\n((__t = ("+sn+")) == null ? '' : __t) +\n'"),fe=fs+mt.length,mt}),Ee+="';\n";var ft=En.call(h,"variable")&&h.variable;if(ft){if(vv.test(ft))throw new Pt("Invalid `variable` option passed into `_.template`")}else Ee="with (obj) {\n"+Ee+"\n}\n";Ee=(X?Ee.replace(kw,""):Ee).replace(Uw,"$1").replace(Bw,"$1;"),Ee="function("+(ft||"obj")+") {\n"+(ft?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(G?", __e = _.escape":"")+(X?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+Ee+"return __p\n}";var $t=bE(function(){return pn(P,rt+"return "+Ee).apply(B,U)});if($t.source=Ee,jg($t))throw $t;return $t},D.times=function h_(u,h){if((u=Ht(u))<1||u>tn)return[];var g=An,w=nr(u,An);h=pt(h),u-=An;for(var x=Xm(w,h);++g<u;)h(g);return x},D.toFinite=ia,D.toInteger=Ht,D.toLength=rE,D.toLower=function yE(u){return dn(u).toLowerCase()},D.toNumber=$r,D.toSafeInteger=function Gc(u){return u?Na(Ht(u),-tn,tn):0===u?u:0},D.toString=dn,D.toUpper=function vE(u){return dn(u).toUpperCase()},D.trim=function Uf(u,h,g){if((u=dn(u))&&(g||h===B))return Fv(u);if(!u||!(h=us(h)))return u;var w=As(u),x=As(h);return vl(w,Ou(w,x),Ah(w,x)+1).join("")},D.trimEnd=function IR(u,h,g){if((u=dn(u))&&(g||h===B))return u.slice(0,Dh(u)+1);if(!u||!(h=us(h)))return u;var w=As(u);return vl(w,0,Ah(w,As(h))+1).join("")},D.trimStart=function o_(u,h,g){if((u=dn(u))&&(g||h===B))return u.replace(yh,"");if(!u||!(h=us(h)))return u;var w=As(u);return vl(w,Ou(w,As(h))).join("")},D.truncate=function zx(u,h){var g=30,w="...";if(qn(h)){var x="separator"in h?h.separator:x;g="length"in h?Ht(h.length):g,w="omission"in h?us(h.omission):w}var P=(u=dn(u)).length;if($o(u)){var U=As(u);P=U.length}if(g>=P)return u;var G=g-hl(w);if(G<1)return w;var X=U?vl(U,0,G).join(""):u.slice(0,G);if(x===B)return X+w;if(U&&(G+=X.length-G),Dl(x)){if(u.slice(G).search(x)){var fe,pe=X;for(x.global||(x=Ym(x.source,dn(wo.exec(x))+"g")),x.lastIndex=0;fe=x.exec(pe);)var Ee=fe.index;X=X.slice(0,Ee===B?G:Ee)}}else if(u.indexOf(us(x),G)!=G){var Ue=X.lastIndexOf(x);Ue>-1&&(X=X.slice(0,Ue))}return X+w},D.unescape=function a_(u){return(u=dn(u))&&wI.test(u)?u.replace(dv,Uv):u},D.uniqueId=function f_(u){var h=++dM;return dn(u)+h},D.upperCase=EE,D.upperFirst=Bf,D.each=Lg,D.eachRight=Og,D.first=Tg,u_(D,function(){var u={};return Jo(D,function(h,g){En.call(D.prototype,g)||(u[g]=h)}),u}(),{chain:!1}),D.VERSION="4.17.21",Hn(["bind","bindKey","curry","curryRight","partial","partialRight"],function(u){D[u].placeholder=D}),Hn(["drop","take"],function(u,h){Bt.prototype[u]=function(g){g=g===B?1:ei(Ht(g),0);var w=this.__filtered__&&!h?new Bt(this):this.clone();return w.__filtered__?w.__takeCount__=nr(g,w.__takeCount__):w.__views__.push({size:nr(g,An),type:u+(w.__dir__<0?"Right":"")}),w},Bt.prototype[u+"Right"]=function(g){return this.reverse()[u](g).reverse()}}),Hn(["filter","map","takeWhile"],function(u,h){var g=h+1,w=1==g||3==g;Bt.prototype[u]=function(x){var P=this.clone();return P.__iteratees__.push({iteratee:pt(x,3),type:g}),P.__filtered__=P.__filtered__||w,P}}),Hn(["head","last"],function(u,h){var g="take"+(h?"Right":"");Bt.prototype[u]=function(){return this[g](1).value()[0]}}),Hn(["initial","tail"],function(u,h){var g="drop"+(h?"":"Right");Bt.prototype[u]=function(){return this.__filtered__?new Bt(this):this[g](1)}}),Bt.prototype.compact=function(){return this.filter(Sr)},Bt.prototype.find=function(u){return this.filter(u).head()},Bt.prototype.findLast=function(u){return this.reverse().find(u)},Bt.prototype.invokeMap=Wt(function(u,h){return"function"==typeof u?new Bt(this):this.map(function(g){return $h(g,u,h)})}),Bt.prototype.reject=function(u){return this.filter(Cf(pt(u)))},Bt.prototype.slice=function(u,h){u=Ht(u);var g=this;return g.__filtered__&&(u>0||h<0)?new Bt(g):(u<0?g=g.takeRight(-u):u&&(g=g.drop(u)),h!==B&&(g=(h=Ht(h))<0?g.dropRight(-h):g.take(h-u)),g)},Bt.prototype.takeRightWhile=function(u){return this.reverse().takeWhile(u).reverse()},Bt.prototype.toArray=function(){return this.take(An)},Jo(Bt.prototype,function(u,h){var g=/^(?:filter|find|map|reject)|While$/.test(h),w=/^(?:head|last)$/.test(h),x=D[w?"take"+("last"==h?"Right":""):h],P=w||/^find/.test(h);x&&(D.prototype[h]=function(){var U=this.__wrapped__,G=w?[1]:arguments,X=U instanceof Bt,fe=G[0],pe=X||Nt(U),Ee=function(zt){var sn=x.apply(D,xo([zt],G));return w&&Ue?sn[0]:sn};pe&&g&&"function"==typeof fe&&1!=fe.length&&(X=pe=!1);var Ue=this.__chain__,ft=P&&!Ue,$t=X&&!this.__actions__.length;if(!P&&pe){U=$t?U:new Bt(this);var mt=u.apply(U,G);return mt.__actions__.push({func:vf,args:[Ee],thisArg:B}),new zr(mt,Ue)}return ft&&$t?u.apply(this,G):(mt=this.thru(Ee),ft?w?mt.value()[0]:mt.value():mt)})}),Hn(["pop","push","shift","sort","splice","unshift"],function(u){var h=Rh[u],g=/^(?:push|sort|unshift)$/.test(u)?"tap":"thru",w=/^(?:pop|shift)$/.test(u);D.prototype[u]=function(){var x=arguments;if(w&&!this.__chain__){var P=this.value();return h.apply(Nt(P)?P:[],x)}return this[g](function(U){return h.apply(Nt(U)?U:[],x)})}}),Jo(Bt.prototype,function(u,h){var g=D[h];if(g){var w=g.name+"";En.call(Ut,w)||(Ut[w]=[]),Ut[w].push({name:h,func:g})}}),Ut[On(B,2).name]=[{name:"wrapper",func:B}],Bt.prototype.clone=function Fh(){var u=new Bt(this.__wrapped__);return u.__actions__=yr(this.__actions__),u.__dir__=this.__dir__,u.__filtered__=this.__filtered__,u.__iteratees__=yr(this.__iteratees__),u.__takeCount__=this.__takeCount__,u.__views__=yr(this.__views__),u},Bt.prototype.reverse=function Js(){if(this.__filtered__){var u=new Bt(this);u.__dir__=-1,u.__filtered__=!0}else(u=this.clone()).__dir__*=-1;return u},Bt.prototype.value=function Qm(){var u=this.__wrapped__.value(),h=this.__dir__,g=Nt(u),w=h<0,x=g?u.length:0,P=function eR(u,h,g){for(var w=-1,x=g.length;++w<x;){var P=g[w],U=P.size;switch(P.type){case"drop":u+=U;break;case"dropRight":h-=U;break;case"take":h=nr(h,u+U);break;case"takeRight":u=ei(u,h-U)}}return{start:u,end:h}}(0,x,this.__views__),U=P.start,G=P.end,X=G-U,fe=w?G:U-1,pe=this.__iteratees__,Ee=pe.length,Ue=0,rt=nr(X,this.__takeCount__);if(!g||!w&&x==X&&rt==X)return Wi(u,this.__actions__);var ft=[];e:for(;X--&&Ue<rt;){for(var $t=-1,mt=u[fe+=h];++$t<Ee;){var zt=pe[$t],qi=zt.type,Tn=(0,zt.iteratee)(mt);if(2==qi)mt=Tn;else if(!Tn){if(1==qi)continue e;break e}}ft[Ue++]=mt}return ft},D.prototype.at=Pg,D.prototype.chain=function fR(){return tx(this)},D.prototype.commit=function pR(){return new zr(this.value(),this.__chain__)},D.prototype.next=function Ng(){this.__values__===B&&(this.__values__=iE(this.value()));var u=this.__index__>=this.__values__.length;return{done:u,value:u?B:this.__values__[this.__index__++]}},D.prototype.plant=function gR(u){for(var h,g=this;g instanceof Gi;){var w=xl(g);w.__index__=0,w.__values__=B,h?x.__wrapped__=w:h=w;var x=w;g=g.__wrapped__}return x.__wrapped__=u,h},D.prototype.reverse=function _R(){var u=this.__wrapped__;if(u instanceof Bt){var h=u;return this.__actions__.length&&(h=new Bt(this)),(h=h.reverse()).__actions__.push({func:vf,args:[Dg],thisArg:B}),new zr(h,this.__chain__)}return this.thru(Dg)},D.prototype.toJSON=D.prototype.valueOf=D.prototype.value=function yR(){return Wi(this.__wrapped__,this.__actions__)},D.prototype.first=D.prototype.head,Vu&&(D.prototype[Vu]=function mR(){return this}),D}();mr._=Ih,(fn=function(){return Ih}.call(_o,yo,_o,$s))!==B&&($s.exports=fn)}.call(this)}},$s=>{$s($s.s=241)}]);