(self.webpackChunkmgx=self.webpackChunkmgx||[]).push([[179],{497:(Hs,lc,vd)=>{"use strict";function fn(n){return"function"==typeof n}function B(n){const t=n(i=>{Error.call(i),i.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const Xm=B(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function Iu(n,e){if(n){const t=n.indexOf(e);0<=t&&n.splice(t,1)}}class Yr{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:i}=this;if(fn(i))try{i()}catch(s){e=s instanceof Xm?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{wd(s)}catch(o){e=e??[],o instanceof Xm?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Xm(e)}}add(e){var t;if(e&&e!==this)if(this.closed)wd(e);else{if(e instanceof Yr){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Iu(t,e)}remove(e){const{_finalizers:t}=this;t&&Iu(t,e),e instanceof Yr&&e._removeParent(this)}}Yr.EMPTY=(()=>{const n=new Yr;return n.closed=!0,n})();const Kr=Yr.EMPTY;function Wv(n){return n instanceof Yr||n&&"closed"in n&&fn(n.remove)&&fn(n.add)&&fn(n.unsubscribe)}function wd(n){fn(n)?n():n.unsubscribe()}const rl={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},sl={setTimeout(n,e,...t){const{delegate:i}=sl;return i?.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){const{delegate:e}=sl;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Fo(n){sl.setTimeout(()=>{const{onUnhandledError:e}=rl;if(!e)throw n;e(n)})}function bd(){}const cc=Rr("C",void 0,void 0);function Rr(n,e,t){return{kind:n,value:e,error:t}}let Zr=null;function Ru(n){if(rl.useDeprecatedSynchronousErrorHandling){const e=!Zr;if(e&&(Zr={errorThrown:!1,error:null}),n(),e){const{errorThrown:t,error:i}=Zr;if(Zr=null,t)throw i}}else n()}class ga extends Yr{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Wv(e)&&e.add(this)):this.destination=HC}static create(e,t,i){return new Uo(e,t,i)}next(e){this.isStopped?Ym(function Ed(n){return Rr("N",n,void 0)}(e),this):this._next(e)}error(e){this.isStopped?Ym(function uc(n){return Rr("E",void 0,n)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Ym(cc,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const uo=Function.prototype.bind;function _a(n,e){return uo.call(n,e)}class ko{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){hc(i)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){hc(i)}else hc(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){hc(t)}}}class Uo extends ga{constructor(e,t,i){let r;if(super(),fn(e)||!e)r={next:e??void 0,error:t??void 0,complete:i??void 0};else{let s;this&&rl.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&_a(e.next,s),error:e.error&&_a(e.error,s),complete:e.complete&&_a(e.complete,s)}):r=e}this.destination=new ko(r)}}function hc(n){rl.useDeprecatedSynchronousErrorHandling?function co(n){rl.useDeprecatedSynchronousErrorHandling&&Zr&&(Zr.errorThrown=!0,Zr.error=n)}(n):Fo(n)}function Ym(n,e){const{onStoppedNotification:t}=rl;t&&sl.setTimeout(()=>t(n,e))}const HC={closed:!0,next:bd,error:function VC(n){throw n},complete:bd},Km="function"==typeof Symbol&&Symbol.observable||"@@observable";function Bo(n){return n}function jv(n){return 0===n.length?Bo:1===n.length?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}let Cn=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){const i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){const s=function Sd(n){return n&&n instanceof ga||function GC(n){return n&&fn(n.next)&&fn(n.error)&&fn(n.complete)}(n)&&Wv(n)}(t)?t:new Uo(t,i,r);return Ru(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return new(i=Vo(i))((r,s)=>{const o=new Uo({next:a=>{try{t(a)}catch(l){s(l),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(t){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(t)}[Km](){return this}pipe(...t){return jv(t)(this)}toPromise(t){return new(t=Vo(t))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return n.create=e=>new n(e),n})();function Vo(n){var e;return null!==(e=n??rl.Promise)&&void 0!==e?e:Promise}const ho=B(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Jr=(()=>{class n extends Cn{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const i=new $v(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new ho}next(t){Ru(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(t)}})}error(t){Ru(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){Ru(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:i,isStopped:r,observers:s}=this;return i||r?Kr:(this.currentObservers=null,s.push(t),new Yr(()=>{this.currentObservers=null,Iu(s,t)}))}_checkFinalizedStatuses(t){const{hasError:i,thrownError:r,isStopped:s}=this;i?t.error(r):s&&t.complete()}asObservable(){const t=new Cn;return t.source=this,t}}return n.create=(e,t)=>new $v(e,t),n})();class $v extends Jr{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===i||i.call(t,e)}error(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===i||i.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,i;return null!==(i=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==i?i:Kr}}function qv(n){return fn(n?.lift)}function zn(n){return e=>{if(qv(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function Jn(n,e,t,i,r){return new WC(n,e,t,i,r)}class WC extends ga{constructor(e,t,i,r,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(l){e.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function Jt(n,e){return zn((t,i)=>{let r=0;t.subscribe(Jn(i,s=>{i.next(n.call(e,s,r++))}))})}function fo(n){return this instanceof fo?(this.v=n,this):new fo(n)}function Ad(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=n[Symbol.asyncIterator];return e?e.call(n):(n=function Zm(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(o){return new Promise(function(a,l){!function r(s,o,a,l){Promise.resolve(l).then(function(c){s({value:c,done:a})},o)}(a,l,(o=n[s](o)).done,o.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const Zv=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function Jv(n){return fn(n?.then)}function Qv(n){return fn(n[Km])}function rg(n){return Symbol.asyncIterator&&fn(n?.[Symbol.asyncIterator])}function e0(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const t0=function JC(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function Dd(n){return fn(n?.[t0])}function n0(n){return function Td(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=t.apply(n,e||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(p){i[p]&&(r[p]=function(m){return new Promise(function(g,v){s.push([p,m,g,v])>1||a(p,m)})})}function a(p,m){try{!function l(p){p.value instanceof fo?Promise.resolve(p.value.v).then(c,h):d(s[0][2],p)}(i[p](m))}catch(g){d(s[0][3],g)}}function c(p){a("next",p)}function h(p){a("throw",p)}function d(p,m){p(m),s.shift(),s.length&&a(s[0][0],s[0][1])}}(this,arguments,function*(){const t=n.getReader();try{for(;;){const{value:i,done:r}=yield fo(t.read());if(r)return yield fo(void 0);yield yield fo(i)}}finally{t.releaseLock()}})}function Id(n){return fn(n?.getReader)}function Qr(n){if(n instanceof Cn)return n;if(null!=n){if(Qv(n))return function QC(n){return new Cn(e=>{const t=n[Km]();if(fn(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(Zv(n))return function ex(n){return new Cn(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}(n);if(Jv(n))return function tx(n){return new Cn(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Fo)})}(n);if(rg(n))return r0(n);if(Dd(n))return function nx(n){return new Cn(e=>{for(const t of n)if(e.next(t),e.closed)return;e.complete()})}(n);if(Id(n))return function ix(n){return r0(n0(n))}(n)}throw e0(n)}function r0(n){return new Cn(e=>{(function rx(n,e){var t,i,r,s;return function fc(n,e,t,i){return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(d){o(d)}}function l(h){try{c(i.throw(h))}catch(d){o(d)}}function c(h){h.done?s(h.value):function r(s){return s instanceof t?s:new t(function(o){o(s)})}(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=Ad(n);!(i=yield t.next()).done;)if(e.next(i.value),e.closed)return}catch(o){r={error:o}}finally{try{i&&!i.done&&(s=t.return)&&(yield s.call(t))}finally{if(r)throw r.error}}e.complete()})})(n,e).catch(t=>e.error(t))})}function po(n,e,t,i=0,r=!1){const s=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(s),!r)return s}function Zi(n,e,t=1/0){return fn(e)?Zi((i,r)=>Jt((s,o)=>e(i,s,r,o))(Qr(n(i,r))),t):("number"==typeof e&&(t=e),zn((i,r)=>function sx(n,e,t,i,r,s,o,a){const l=[];let c=0,h=0,d=!1;const p=()=>{d&&!l.length&&!c&&e.complete()},m=v=>c<i?g(v):l.push(v),g=v=>{s&&e.next(v),c++;let w=!1;Qr(t(v,h++)).subscribe(Jn(e,y=>{r?.(y),s?m(y):e.next(y)},()=>{w=!0},void 0,()=>{if(w)try{for(c--;l.length&&c<i;){const y=l.shift();o?po(e,o,()=>g(y)):g(y)}p()}catch(y){e.error(y)}}))};return n.subscribe(Jn(e,m,()=>{d=!0,p()})),()=>{a?.()}}(i,r,n,t)))}function gc(n=1/0){return Zi(Bo,n)}const mo=new Cn(n=>n.complete());function sg(n){return n[n.length-1]}function Nu(n){return fn(sg(n))?n.pop():void 0}function Lu(n){return function Rd(n){return n&&fn(n.schedule)}(sg(n))?n.pop():void 0}function s0(n,e=0){return zn((t,i)=>{t.subscribe(Jn(i,r=>po(i,n,()=>i.next(r),e),()=>po(i,n,()=>i.complete(),e),r=>po(i,n,()=>i.error(r),e)))})}function og(n,e=0){return zn((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function l0(n,e){if(!n)throw new Error("Iterable cannot be null");return new Cn(t=>{po(t,e,()=>{const i=n[Symbol.asyncIterator]();po(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function mi(n,e){return e?function c0(n,e){if(null!=n){if(Qv(n))return function o0(n,e){return Qr(n).pipe(og(e),s0(e))}(n,e);if(Zv(n))return function lx(n,e){return new Cn(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}(n,e);if(Jv(n))return function a0(n,e){return Qr(n).pipe(og(e),s0(e))}(n,e);if(rg(n))return l0(n,e);if(Dd(n))return function cx(n,e){return new Cn(t=>{let i;return po(t,e,()=>{i=n[t0](),po(t,e,()=>{let r,s;try{({value:r,done:s}=i.next())}catch(o){return void t.error(o)}s?t.complete():t.next(r)},0,!0)}),()=>fn(i?.return)&&i.return()})}(n,e);if(Id(n))return function ux(n,e){return l0(n0(n),e)}(n,e)}throw e0(n)}(n,e):Qr(n)}class Pr extends Jr{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}}function mt(...n){return mi(n,Lu(n))}function ag(n={}){const{connector:e=(()=>new Jr),resetOnError:t=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=n;return s=>{let o,a,l,c=0,h=!1,d=!1;const p=()=>{a?.unsubscribe(),a=void 0},m=()=>{p(),o=l=void 0,h=d=!1},g=()=>{const v=o;m(),v?.unsubscribe()};return zn((v,w)=>{c++,!d&&!h&&p();const y=l=l??e();w.add(()=>{c--,0===c&&!d&&!h&&(a=_c(g,r))}),y.subscribe(w),!o&&c>0&&(o=new Uo({next:b=>y.next(b),error:b=>{d=!0,p(),a=_c(m,t,b),y.error(b)},complete:()=>{h=!0,p(),a=_c(m,i),y.complete()}}),Qr(v).subscribe(o))})(s)}}function _c(n,e,...t){if(!0===e)return void n();if(!1===e)return;const i=new Uo({next:()=>{i.unsubscribe(),n()}});return Qr(e(...t)).subscribe(i)}function Es(n,e){return zn((t,i)=>{let r=null,s=0,o=!1;const a=()=>o&&!r&&i.complete();t.subscribe(Jn(i,l=>{r?.unsubscribe();let c=0;const h=s++;Qr(n(l,h)).subscribe(r=Jn(i,d=>i.next(e?e(l,d,h,c++):d),()=>{r=null,a()}))},()=>{o=!0,a()}))})}function h0(n,e){return n===e}function un(n){for(let e in n)if(n[e]===un)return e;throw Error("Could not find renamed property on target object.")}function yc(n,e){for(const t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function Mi(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(Mi).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function Pd(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const lg=un({__forward_ref__:un});function pn(n){return n.__forward_ref__=pn,n.toString=function(){return Mi(this())},n}function lt(n){return Nd(n)?n():n}function Nd(n){return"function"==typeof n&&n.hasOwnProperty(lg)&&n.__forward_ref__===pn}function Ld(n){return n&&!!n.\u0275providers}class ae extends Error{constructor(e,t){super(function Ou(n,e){return`NG0${Math.abs(n)}${e?": "+e:""}`}(e,t)),this.code=e}}function Et(n){return"string"==typeof n?n:null==n?"":String(n)}function ug(n,e){throw new ae(-201,!1)}function Ss(n,e){null==n&&function gt(n,e,t,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${t} ${i} ${e} <=Actual]`))}(e,n,null,"!=")}function Je(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Ti(n){return{providers:n.providers||[],imports:n.imports||[]}}function va(n){return Od(n,ku)||Od(n,hg)}function Od(n,e){return n.hasOwnProperty(e)?n[e]:null}function Fu(n){return n&&(n.hasOwnProperty(Fd)||n.hasOwnProperty(m0))?n[Fd]:null}const ku=un({\u0275prov:un}),Fd=un({\u0275inj:un}),hg=un({ngInjectableDef:un}),m0=un({ngInjectorDef:un});var $t=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}($t||{});let vr;function Fn(n){const e=vr;return vr=n,e}function _0(n,e,t){const i=va(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&$t.Optional?null:void 0!==e?e:void ug(Mi(n))}const on=globalThis,Bu={},Ud="__NG_DI_FLAG__",Vu="ngTempTokenPath",yg=/\n/gm,w0="__source";let wa;function ba(n){const e=wa;return wa=n,e}function b0(n,e=$t.Default){if(void 0===wa)throw new ae(-203,!1);return null===wa?_0(n,void 0,e):wa.get(n,e&$t.Optional?null:void 0,e)}function Oe(n,e=$t.Default){return(function g0(){return vr}()||b0)(lt(n),e)}function ze(n,e=$t.Default){return Oe(n,Hu(e))}function Hu(n){return typeof n>"u"||"number"==typeof n?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Vd(n){const e=[];for(let t=0;t<n.length;t++){const i=lt(n[t]);if(Array.isArray(i)){if(0===i.length)throw new ae(900,!1);let r,s=$t.Default;for(let o=0;o<i.length;o++){const a=i[o],l=yx(a);"number"==typeof l?-1===l?r=a.token:s|=l:r=a}e.push(Oe(r,s))}else e.push(Oe(i))}return e}function zu(n,e){return n[Ud]=e,n.prototype[Ud]=e,n}function yx(n){return n[Ud]}function Ho(n){return{toString:n}.toString()}var zo=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(zo||{}),xs=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(xs||{});const _o={},nn=[],Gu=un({\u0275cmp:un}),yo=un({\u0275dir:un}),vc=un({\u0275pipe:un}),E0=un({\u0275mod:un}),Go=un({\u0275fac:un}),Wu=un({__NG_ELEMENT_ID__:un}),cl=un({__NG_ENV_ID__:un});function Ms(n,e,t){let i=n.length;for(;;){const r=n.indexOf(e,t);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const s=e.length;if(r+s===i||n.charCodeAt(r+s)<=32)return r}t=r+1}}function Hd(n,e,t){let i=0;for(;i<t.length;){const r=t[i];if("number"==typeof r){if(0!==r)break;i++;const s=t[i++],o=t[i++],a=t[i++];n.setAttribute(e,o,a,s)}else{const s=r,o=t[++i];C0(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),i++}}return i}function S0(n){return 3===n||4===n||6===n}function C0(n){return 64===n.charCodeAt(0)}function ju(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?t=r:0===t||x0(n,t,r,null,-1===t||2===t?e[++i]:null)}}return n}function x0(n,e,t,i,r){let s=0,o=n.length;if(-1===e)o=-1;else for(;s<n.length;){const a=n[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<n.length;){const a=n[s];if("number"==typeof a)break;if(a===t){if(null===i)return void(null!==r&&(n[s+1]=r));if(i===n[s+1])return void(n[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),null!==i&&n.splice(s++,0,i),null!==r&&n.splice(s++,0,r)}const M0="ng-template";function zd(n,e,t){let i=0,r=!0;for(;i<n.length;){let s=n[i++];if("string"==typeof s&&r){const o=n[i++];if(t&&"class"===s&&-1!==Ms(o.toLowerCase(),e,0))return!0}else{if(1===s){for(;i<n.length&&"string"==typeof(s=n[i++]);)if(s.toLowerCase()===e)return!0;return!1}"number"==typeof s&&(r=!1)}}return!1}function Y(n){return 4===n.type&&n.value!==M0}function ue(n,e,t){return e===(4!==n.type||t?n.value:M0)}function re(n,e,t){let i=4;const r=n.attrs||[],s=function xn(n){for(let e=0;e<n.length;e++)if(S0(n[e]))return e;return n.length}(r);let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&i){if(i=2|1&i,""!==l&&!ue(n,l,t)||""===l&&1===e.length){if(Ue(i))return!1;o=!0}}else{const c=8&i?l:e[++a];if(8&i&&null!==n.attrs){if(!zd(n.attrs,c,t)){if(Ue(i))return!1;o=!0}continue}const d=At(8&i?"class":l,r,Y(n),t);if(-1===d){if(Ue(i))return!1;o=!0;continue}if(""!==c){let p;p=d>s?"":r[d+1].toLowerCase();const m=8&i?p:null;if(m&&-1!==Ms(m,c,0)||2&i&&c!==p){if(Ue(i))return!1;o=!0}}}}else{if(!o&&!Ue(i)&&!Ue(l))return!1;if(o&&Ue(l))continue;o=!1,i=l|1&i}}return Ue(i)||o}function Ue(n){return 0==(1&n)}function At(n,e,t,i){if(null===e)return-1;let r=0;if(i||!t){let s=!1;for(;r<e.length;){const o=e[r];if(o===n)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function wg(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const i=n[t];if("number"==typeof i)return-1;if(i===e)return t;t++}return-1}(e,n)}function cn(n,e,t=!1){for(let i=0;i<e.length;i++)if(re(n,e[i],t))return!0;return!1}function bx(n,e){e:for(let t=0;t<e.length;t++){const i=e[t];if(n.length===i.length){for(let r=0;r<n.length;r++)if(n[r]!==i[r])continue e;return!0}}return!1}function ts(n,e){return n?":not("+e.trim()+")":e}function Gd(n){let e=n[0],t=1,i=2,r="",s=!1;for(;t<n.length;){let o=n[t];if("string"==typeof o)if(2&i){const a=n[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!Ue(o)&&(e+=ts(s,r),r=""),i=o,s=s||!Ue(i);t++}return""!==r&&(e+=ts(s,r)),e}function Ji(n){return Ho(()=>{const e=bg(n),t={...e,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===zo.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||xs.Emulated,styles:n.styles||nn,_:null,schemas:n.schemas||null,tView:null,id:""};Eg(t);const i=n.dependencies;return t.directiveDefs=hl(i,!1),t.pipeDefs=hl(i,!0),t.id=function $u(n){let e=0;const t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(const r of t)e=Math.imul(31,e)+r.charCodeAt(0)<<0;return e+=2147483648,"c"+e}(t),t})}function mn(n){return Yt(n)||Gn(n)}function Sx(n){return null!==n}function ki(n){return Ho(()=>({type:n.type,bootstrap:n.bootstrap||nn,declarations:n.declarations||nn,imports:n.imports||nn,exports:n.exports||nn,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function T0(n,e){if(null==n)return _o;const t={};for(const i in n)if(n.hasOwnProperty(i)){let r=n[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),t[r]=i,e&&(e[r]=s)}return t}function pt(n){return Ho(()=>{const e=bg(n);return Eg(e),e})}function Yt(n){return n[Gu]||null}function Gn(n){return n[yo]||null}function Ui(n){return n[vc]||null}function lr(n,e){const t=n[E0]||null;if(!t&&!0===e)throw new Error(`Type ${Mi(n)} does not have '\u0275mod' property.`);return t}function bg(n){const e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||_o,exportAs:n.exportAs||null,standalone:!0===n.standalone,signals:!0===n.signals,selectors:n.selectors||nn,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:T0(n.inputs,e),outputs:T0(n.outputs)}}function Eg(n){n.features?.forEach(e=>e(n))}function hl(n,e){if(!n)return null;const t=e?Ui:mn;return()=>("function"==typeof n?n():n).map(i=>t(i)).filter(Sx)}const bn=0,Ve=1,Nt=2,Wn=3,Ws=4,Ea=5,Di=6,Sa=7,ci=8,Wo=9,bc=10,xt=11,Qn=12,Qi=13,Ec=14,ui=15,Sc=16,Cc=17,Ts=18,jo=19,$d=20,ns=21,is=22,$o=23,Ca=24,kt=25,Sg=1,D0=2,vo=7,qo=9,Bi=11;function Ii(n){return Array.isArray(n)&&"object"==typeof n[Sg]}function Vi(n){return Array.isArray(n)&&!0===n[Sg]}function Lr(n){return 0!=(4&n.flags)}function Ut(n){return n.componentOffset>-1}function Xd(n){return 1==(1&n.flags)}function js(n){return!!n.template}function Cg(n){return 0!=(512&n[Nt])}function fl(n,e){return n.hasOwnProperty(Go)?n[Go]:null}let er=null,qu=!1;function rs(n){const e=er;return er=n,e}const R0={version:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{}};function Yd(n){if(!Xu(n)||n.dirty){if(!n.producerMustRecompute(n)&&!bo(n))return void(n.dirty=!1);n.producerRecomputeValue(n),n.dirty=!1}}function N0(n){n.dirty=!0,function xc(n){if(void 0===n.liveConsumerNode)return;const e=qu;qu=!0;try{for(const t of n.liveConsumerNode)t.dirty||N0(t)}finally{qu=e}}(n),n.consumerMarkedDirty?.(n)}function Kd(n){return n&&(n.nextProducerIndex=0),rs(n)}function xg(n,e){if(rs(e),n&&void 0!==n.producerNode&&void 0!==n.producerIndexOfThis&&void 0!==n.producerLastReadVersion){if(Xu(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)wr(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function bo(n){pl(n);for(let e=0;e<n.producerNode.length;e++){const t=n.producerNode[e],i=n.producerLastReadVersion[e];if(i!==t.version||(Yd(t),i!==t.version))return!0}return!1}function Zd(n){if(pl(n),Xu(n))for(let e=0;e<n.producerNode.length;e++)wr(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function wr(n,e){if(function Mg(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}(n),pl(n),1===n.liveConsumerNode.length)for(let i=0;i<n.producerNode.length;i++)wr(n.producerNode[i],n.producerIndexOfThis[i]);const t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){const i=n.liveConsumerIndexOfThis[e],r=n.liveConsumerNode[e];pl(r),r.producerIndexOfThis[i]=e}}function Xu(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function pl(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}let Tg=null;const nf=()=>{},Rx=(()=>({...R0,consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:n=>{n.schedule(n.ref)},hasRun:!1,cleanupFn:nf}))();class F0{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function Hi(){return k0}function k0(n){return n.type.prototype.ngOnChanges&&(n.setInput=Px),Yu}function Yu(){const n=sf(this),e=n?.current;if(e){const t=n.previous;if(t===_o)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function Px(n,e,t,i){const r=this.declaredInputs[t],s=sf(n)||function B0(n,e){return n[U0]=e}(n,{previous:_o,current:null}),o=s.current||(s.current={}),a=s.previous,l=a[r];o[r]=new F0(l&&l.currentValue,e,a===_o),n[i]=e}Hi.ngInherit=!0;const U0="__ngSimpleChanges__";function sf(n){return n[U0]||null}const Eo=function(n,e,t){};function In(n){for(;Array.isArray(n);)n=n[bn];return n}function Zu(n,e){return In(e[n])}function Er(n,e){return In(e[n.index])}function Ju(n,e){return n.data[e]}function Or(n,e){const t=e[n];return Ii(t)?t:t[bn]}function Ra(n,e){return null==e?null:n[e]}function lf(n){n[Cc]=0}function G0(n){1024&n[Nt]||(n[Nt]|=1024,W0(n,1))}function cf(n){1024&n[Nt]&&(n[Nt]&=-1025,W0(n,-1))}function W0(n,e){let t=n[Wn];if(null===t)return;t[Ea]+=e;let i=t;for(t=t[Wn];null!==t&&(1===e&&1===i[Ea]||-1===e&&0===i[Ea]);)t[Ea]+=e,i=t,t=t[Wn]}const _t={lFrame:Ug(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function ss(){return _t.bindingsEnabled}function Ac(){return null!==_t.skipHydrationRootTNode}function ge(){return _t.lFrame.lView}function Zt(){return _t.lFrame.tView}function as(n){return _t.lFrame.contextLView=n,n[ci]}function Sr(n){return _t.lFrame.contextLView=null,n}function zi(){let n=ff();for(;null!==n&&64===n.type;)n=n.parent;return n}function ff(){return _t.lFrame.currentTNode}function As(n,e){const t=_t.lFrame;t.currentTNode=n,t.isParent=e}function Qu(){return _t.lFrame.isParent}function So(){_t.lFrame.isParent=!1}function cr(){const n=_t.lFrame;let e=n.bindingRootIndex;return-1===e&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function Ic(){return _t.lFrame.bindingIndex++}function Ko(n){const e=_t.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function Ux(n,e){const t=_t.lFrame;t.bindingIndex=t.bindingRootIndex=n,pf(e)}function pf(n){_t.lFrame.currentDirectiveIndex=n}function qs(){return _t.lFrame.currentQueryIndex}function Fg(n){_t.lFrame.currentQueryIndex=n}function Bx(n){const e=n[Ve];return 2===e.type?e.declTNode:1===e.type?n[Di]:null}function eh(n,e,t){if(t&$t.SkipSelf){let r=e,s=n;for(;!(r=r.parent,null!==r||t&$t.Host||(r=Bx(s),null===r||(s=s[Ec],10&r.type))););if(null===r)return!1;e=r,n=s}const i=_t.lFrame=kg();return i.currentTNode=e,i.lView=n,!0}function Pa(n){const e=kg(),t=n[Ve];_t.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function kg(){const n=_t.lFrame,e=null===n?null:n.child;return null===e?Ug(n):e}function Ug(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function J0(){const n=_t.lFrame;return _t.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const Bg=J0;function Na(){const n=J0();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function hr(){return _t.lFrame.selectedIndex}function La(n){_t.lFrame.selectedIndex=n}function Rn(){const n=_t.lFrame;return Ju(n.tView,n.selectedIndex)}function mf(){_t.lFrame.currentNamespace="svg"}let Hg=!0;function _l(){return Hg}function Zo(n){Hg=n}function yf(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){const s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:h}=s;o&&(n.contentHooks??=[]).push(-t,o),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),l&&(n.viewHooks??=[]).push(-t,l),c&&((n.viewHooks??=[]).push(t,c),(n.viewCheckHooks??=[]).push(t,c)),null!=h&&(n.destroyHooks??=[]).push(t,h)}}function nh(n,e,t){Gg(n,e,3,t)}function Ds(n,e,t,i){(3&n[Nt])===t&&Gg(n,e,t,i)}function vf(n,e){let t=n[Nt];(3&t)===e&&(t&=8191,t+=1,n[Nt]=t)}function Gg(n,e,t,i){const s=i??-1,o=e.length-1;let a=0;for(let l=void 0!==i?65535&n[Cc]:0;l<o;l++)if("number"==typeof e[l+1]){if(a=e[l],null!=i&&a>=i)break}else e[l]<0&&(n[Cc]+=65536),(a<s||-1==s)&&(tw(n,t,e,l),n[Cc]=(4294901760&n[Cc])+l+2),l++}function ew(n,e){Eo(4,n,e);const t=rs(null);try{e.call(n)}finally{rs(t),Eo(5,n,e)}}function tw(n,e,t,i){const r=t[i]<0,s=t[i+1],a=n[r?-t[i]:t[i]];r?n[Nt]>>13<n[Cc]>>16&&(3&n[Nt])===e&&(n[Nt]+=8192,ew(a,s)):ew(a,s)}const Rc=-1;class ih{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function sh(n){return n!==Rc}function Xs(n){return 32767&n}function yl(n,e){let t=function Hx(n){return n>>16}(n),i=e;for(;t>0;)i=i[Ec],t--;return i}let bf=!0;function Pi(n){const e=bf;return bf=n,e}const rw=255,jg=5;let zx=0;const Ys={};function Ef(n,e){const t=Co(n,e);if(-1!==t)return t;const i=e[Ve];i.firstCreatePass&&(n.injectorIndex=e.length,$g(i.data,n),$g(e,null),$g(i.blueprint,null));const r=Gi(n,e),s=n.injectorIndex;if(sh(r)){const o=Xs(r),a=yl(r,e),l=a[Ve].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|l[o+c]}return e[s+8]=r,s}function $g(n,e){n.push(0,0,0,0,0,0,0,0,e)}function Co(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function Gi(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;null!==r;){if(i=Yg(r),null===i)return Rc;if(t++,r=r[Ec],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return Rc}function oh(n,e,t){!function Gx(n,e,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(Wu)&&(i=t[Wu]),null==i&&(i=t[Wu]=zx++);const r=i&rw;e.data[n+(r>>jg)]|=1<<r}(n,e,t)}function Sf(n,e,t){if(t&$t.Optional||void 0!==n)return n;ug()}function sw(n,e,t,i){if(t&$t.Optional&&void 0===i&&(i=null),!(t&($t.Self|$t.Host))){const r=n[Wo],s=Fn(void 0);try{return r?r.get(e,i,t&$t.Optional):_0(e,i,t&$t.Optional)}finally{Fn(s)}}return Sf(i,0,t)}function ow(n,e,t,i=$t.Default,r){if(null!==n){if(2048&e[Nt]&&!(i&$t.Self)){const o=function Xg(n,e,t,i,r){let s=n,o=e;for(;null!==s&&null!==o&&2048&o[Nt]&&!(512&o[Nt]);){const a=Nc(s,o,t,i|$t.Self,Ys);if(a!==Ys)return a;let l=s.parent;if(!l){const c=o[$d];if(c){const h=c.get(t,Ys,i);if(h!==Ys)return h}l=Yg(o),o=o[Ec]}s=l}return r}(n,e,t,i,Ys);if(o!==Ys)return o}const s=Nc(n,e,t,i,Ys);if(s!==Ys)return s}return sw(e,t,i,r)}function Nc(n,e,t,i,r){const s=function jx(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(Wu)?n[Wu]:void 0;return"number"==typeof e?e>=0?e&rw:qg:e}(t);if("function"==typeof s){if(!eh(e,n,i))return i&$t.Host?Sf(r,0,i):sw(e,t,i,r);try{let o;if(o=s(i),null!=o||i&$t.Optional)return o;ug()}finally{Bg()}}else if("number"==typeof s){let o=null,a=Co(n,e),l=Rc,c=i&$t.Host?e[ui][Di]:null;for((-1===a||i&$t.SkipSelf)&&(l=-1===a?Gi(n,e):e[a+8],l!==Rc&&cw(i,!1)?(o=e[Ve],a=Xs(l),e=yl(l,e)):a=-1);-1!==a;){const h=e[Ve];if(lw(s,a,h.data)){const d=aw(a,e,t,o,i,c);if(d!==Ys)return d}l=e[a+8],l!==Rc&&cw(i,e[Ve].data[a+8]===c)&&lw(s,a,e)?(o=h,a=Xs(l),e=yl(l,e)):a=-1}}return r}function aw(n,e,t,i,r,s){const o=e[Ve],a=o.data[n+8],h=ah(a,o,t,null==i?Ut(a)&&bf:i!=o&&0!=(3&a.type),r&$t.Host&&s===a);return null!==h?vl(e,o,h,a):Ys}function ah(n,e,t,i,r){const s=n.providerIndexes,o=e.data,a=1048575&s,l=n.directiveStart,h=s>>20,p=r?a+h:n.directiveEnd;for(let m=i?a:a+h;m<p;m++){const g=o[m];if(m<l&&t===g||m>=l&&g.type===t)return m}if(r){const m=o[l];if(m&&js(m)&&m.type===t)return l}return null}function vl(n,e,t,i){let r=n[t];const s=e.data;if(function Jo(n){return n instanceof ih}(r)){const o=r;o.resolving&&function dx(n,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new ae(-200,`Circular dependency in DI detected for ${n}${t}`)}(function hn(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():Et(n)}(s[t]));const a=Pi(o.canSeeViewProviders);o.resolving=!0;const c=o.injectImpl?Fn(o.injectImpl):null;eh(n,i,$t.Default);try{r=n[t]=o.factory(void 0,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&function zg(n,e,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const o=k0(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}r&&(t.preOrderHooks??=[]).push(0-n,r),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}(t,s[t],e)}finally{null!==c&&Fn(c),Pi(a),o.resolving=!1,Bg()}}return r}function lw(n,e,t){return!!(t[e+(n>>jg)]&1<<n)}function cw(n,e){return!(n&$t.Self||n&$t.Host&&e)}class Cr{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return ow(this._tNode,this._lView,e,Hu(i),t)}}function qg(){return new Cr(zi(),ge())}function gi(n){return Ho(()=>{const e=n.prototype.constructor,t=e[Go]||wl(e),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const s=r[Go]||wl(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function wl(n){return Nd(n)?()=>{const e=wl(lt(n));return e&&e()}:fl(n)}function Yg(n){const e=n[Ve],t=e.type;return 2===t?e.declTNode:1===t?n[Di]:null}const bl="__parameters__";function El(n,e,t){return Ho(()=>{const i=function Kg(n){return function(...t){if(n){const i=n(...t);for(const r in i)this[r]=i[r]}}}(e);function r(...s){if(this instanceof r)return i.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(l,c,h){const d=l.hasOwnProperty(bl)?l[bl]:Object.defineProperty(l,bl,{value:[]})[bl];for(;d.length<=h;)d.push(null);return(d[h]=d[h]||[]).push(o),l}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}function kc(n,e){n.forEach(t=>Array.isArray(t)?kc(t,e):e(t))}function Zg(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Cf(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function ch(n,e){const t=[];for(let i=0;i<n;i++)t.push(e);return t}function jn(n,e,t){let i=Uc(n,e);return i>=0?n[1|i]=t:(i=~i,function Zx(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(1===r)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;)n[r]=n[r-2],r--;n[e]=t,n[e+1]=i}}(n,i,e,t)),i}function Jg(n,e){const t=Uc(n,e);if(t>=0)return n[1|t]}function Uc(n,e){return function Qg(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){const s=i+(r-i>>1),o=n[s<<t];if(e===o)return s<<t;o>e?r=s:i=s+1}return~(r<<t)}(n,e,1)}const Mf=zu(El("Optional"),8),Tf=zu(El("SkipSelf"),4);function Nf(n){return 128==(128&n.flags)}var Fa=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(Fa||{});const gM=/^>|^->|<!--|-->|--!>|<!-$/g,Of=/(<|>)/g,_M="\u200b$1\u200b";const a_=new Map;let yM=0;const c_="__ngContext__";function tr(n,e){Ii(e)?(n[c_]=e[jo],function wM(n){a_.set(n[jo],n)}(e)):n[c_]=e}let d_;function f_(n,e){return d_(n,e)}function zc(n){const e=n[Wn];return Vi(e)?e[Wn]:e}function Dw(n){return Rw(n[Qn])}function Iw(n){return Rw(n[Ws])}function Rw(n){for(;null!==n&&!Vi(n);)n=n[Ws];return n}function Gc(n,e,t,i,r){if(null!=i){let s,o=!1;Vi(i)?s=i:Ii(i)&&(o=!0,i=i[bn]);const a=In(i);0===n&&null!==t?null==r?Lw(e,t,a):Cl(e,t,a,r||null,!0):1===n&&null!==t?Cl(e,t,a,r||null,!0):2===n?function Wf(n,e,t){const i=Rs(n,e);i&&function __(n,e,t,i){n.removeChild(e,t,i)}(n,i,e,t)}(e,a,o):3===n&&e.destroyNode(a),null!=s&&function jf(n,e,t,i,r){const s=t[vo];s!==In(t)&&Gc(e,n,i,s,r);for(let a=Bi;a<t.length;a++){const l=t[a];Ml(l[Ve],l,n,e,i,s)}}(e,n,s,t,r)}}function m_(n,e){return n.createComment(function Sw(n){return n.replace(gM,e=>e.replace(Of,_M))}(e))}function Vf(n,e,t){return n.createElement(e,t)}function Dt(n,e){const t=n[qo],i=t.indexOf(e);cf(e),t.splice(i,1)}function Hf(n,e){if(n.length<=Bi)return;const t=Bi+e,i=n[t];if(i){const r=i[Sc];null!==r&&r!==n&&Dt(r,i),e>0&&(n[t-1][Ws]=i[Ws]);const s=Cf(n,Bi+e);!function MM(n,e){Ml(n,e,e[xt],2,null,null),e[bn]=null,e[Di]=null}(i[Ve],i);const o=s[Ts];null!==o&&o.detachView(s[Ve]),i[Wn]=null,i[Ws]=null,i[Nt]&=-129}return i}function dr(n,e){if(!(256&e[Nt])){const t=e[xt];e[$o]&&Zd(e[$o]),e[Ca]&&Zd(e[Ca]),t.destroyNode&&Ml(n,e,t,3,null,null),function AM(n){let e=n[Qn];if(!e)return ei(n[Ve],n);for(;e;){let t=null;if(Ii(e))t=e[Qn];else{const i=e[Bi];i&&(t=i)}if(!t){for(;e&&!e[Ws]&&e!==n;)Ii(e)&&ei(e[Ve],e),e=e[Wn];null===e&&(e=n),Ii(e)&&ei(e[Ve],e),t=e&&e[Ws]}e=t}}(e)}}function ei(n,e){if(!(256&e[Nt])){e[Nt]&=-129,e[Nt]|=256,function ka(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let i=0;i<t.length;i+=2){const r=e[t[i]];if(!(r instanceof ih)){const s=t[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],l=s[o+1];Eo(4,a,l);try{l.call(a)}finally{Eo(5,a,l)}}else{Eo(4,r,s);try{s.call(r)}finally{Eo(5,r,s)}}}}}(n,e),function IM(n,e){const t=n.cleanup,i=e[Sa];if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+3];o>=0?i[o]():i[-o].unsubscribe(),s+=2}else t[s].call(i[t[s+1]]);null!==i&&(e[Sa]=null);const r=e[ns];if(null!==r){e[ns]=null;for(let s=0;s<r.length;s++)(0,r[s])()}}(n,e),1===e[Ve].type&&e[xt].destroy();const t=e[Sc];if(null!==t&&Vi(e[Wn])){t!==e[Wn]&&Dt(t,e);const i=e[Ts];null!==i&&i.detachView(n)}!function bM(n){a_.delete(n[jo])}(e)}}function g_(n,e,t){return function Nw(n,e,t){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return t[bn];{const{componentOffset:r}=i;if(r>-1){const{encapsulation:s}=n.data[i.directiveStart+r];if(s===xs.None||s===xs.Emulated)return null}return Er(i,t)}}(n,e.parent,t)}function Cl(n,e,t,i,r){n.insertBefore(e,t,i,r)}function Lw(n,e,t){n.appendChild(e,t)}function Ow(n,e,t,i,r){null!==i?Cl(n,e,t,i,r):Lw(n,e,t)}function Rs(n,e){return n.parentNode(e)}function dh(n,e,t){return ti(n,e,t)}let zf,kr,ti=function $n(n,e,t){return 40&n.type?Er(n,t):null};function Gf(n,e,t,i){const r=g_(n,i,e),s=e[xt],a=dh(i.parent||e[Di],i,e);if(null!=r)if(Array.isArray(t))for(let l=0;l<t.length;l++)Ow(s,r,t[l],a,!1);else Ow(s,r,t,a,!1);void 0!==zf&&zf(s,i,e,t,r)}function fh(n,e){if(null!==e){const t=e.type;if(3&t)return Er(e,n);if(4&t)return y_(-1,n[e.index]);if(8&t){const i=e.child;if(null!==i)return fh(n,i);{const r=n[e.index];return Vi(r)?y_(-1,r):In(r)}}if(32&t)return f_(e,n)()||In(n[e.index]);{const i=Uw(n,e);return null!==i?Array.isArray(i)?i[0]:fh(zc(n[ui]),i):fh(n,e.next)}}return null}function Uw(n,e){return null!==e?n[ui][Di].projection[e.projection]:null}function y_(n,e){const t=Bi+n+1;if(t<e.length){const i=e[t],r=i[Ve].firstChild;if(null!==r)return fh(i,r)}return e[vo]}function xl(n,e,t,i,r,s,o){for(;null!=t;){const a=i[t.index],l=t.type;if(o&&0===e&&(a&&tr(In(a),i),t.flags|=2),32!=(32&t.flags))if(8&l)xl(n,e,t.child,i,r,s,!1),Gc(e,n,r,a,s);else if(32&l){const c=f_(t,i);let h;for(;h=c();)Gc(e,n,r,h,s);Gc(e,n,r,a,s)}else 16&l?w_(n,e,i,t,r,s):Gc(e,n,r,a,s);t=o?t.projectionNext:t.next}}function Ml(n,e,t,i,r,s){xl(t,i,n.firstChild,e,r,s,!1)}function w_(n,e,t,i,r,s){const o=t[ui],l=o[Di].projection[i.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++)Gc(e,n,r,l[c],s);else{let c=l;const h=o[Wn];Nf(i)&&(c.flags|=128),xl(n,e,c,h,r,s,!0)}}function Bw(n,e,t){""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function Vw(n,e,t){const{mergedAttrs:i,classes:r,styles:s}=t;null!==i&&Hd(n,e,i),null!==r&&Bw(n,e,r),null!==s&&function Wc(n,e,t){n.setAttribute(e,"style",t)}(n,e,s)}class jw{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}function Ua(n){return n instanceof jw?n.changingThisBreaksApplicationSecurity:n}class Ye{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=Je({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const yh=new Ye("ENVIRONMENT_INITIALIZER"),eb=new Ye("INJECTOR",-1),tb=new Ye("INJECTOR_DEF_TYPES");class D_{get(e,t=Bu){if(t===Bu){const i=new Error(`NullInjectorError: No provider for ${Mi(e)}!`);throw i.name="NullInjectorError",i}return t}}function QM(...n){return{\u0275providers:nb(0,n),\u0275fromNgModule:!0}}function nb(n,...e){const t=[],i=new Set;let r;const s=o=>{t.push(o)};return kc(e,o=>{const a=o;Yf(a,s,[],i)&&(r||=[],r.push(a))}),void 0!==r&&ib(r,s),t}function ib(n,e){for(let t=0;t<n.length;t++){const{ngModule:i,providers:r}=n[t];R_(r,s=>{e(s,i)})}}function Yf(n,e,t,i){if(!(n=lt(n)))return!1;let r=null,s=Fu(n);const o=!s&&Yt(n);if(s||o){if(o&&!o.standalone)return!1;r=n}else{const l=n.ngModule;if(s=Fu(l),!s)return!1;r=l}const a=i.has(r);if(o){if(a)return!1;if(i.add(r),o.dependencies){const l="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const c of l)Yf(c,e,t,i)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let c;i.add(r);try{kc(s.imports,h=>{Yf(h,e,t,i)&&(c||=[],c.push(h))})}finally{}void 0!==c&&ib(c,e)}if(!a){const c=fl(r)||(()=>new r);e({provide:r,useFactory:c,deps:nn},r),e({provide:tb,useValue:r,multi:!0},r),e({provide:yh,useValue:()=>Oe(r),multi:!0},r)}const l=s.providers;if(null!=l&&!a){const c=n;R_(l,h=>{e(h,c)})}}}return r!==n&&void 0!==n.providers}function R_(n,e){for(let t of n)Ld(t)&&(t=t.\u0275providers),Array.isArray(t)?R_(t,e):e(t)}const eT=un({provide:String,useValue:un});function P_(n){return null!==n&&"object"==typeof n&&eT in n}function Ba(n){return"function"==typeof n}const N_=new Ye("Set Injector scope."),Zf={},tT={};let vh;function Jf(){return void 0===vh&&(vh=new D_),vh}class cs{}class Qf extends cs{get destroyed(){return this._destroyed}constructor(e,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,wh(e,o=>this.processProvider(o)),this.records.set(eb,Xc(void 0,this)),r.has("environment")&&this.records.set(cs,Xc(void 0,this));const s=this.records.get(N_);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(tb.multi,nn,$t.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();const e=this._onDestroyHooks;this._onDestroyHooks=[];for(const t of e)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();const t=ba(this),i=Fn(void 0);try{return e()}finally{ba(t),Fn(i)}}get(e,t=Bu,i=$t.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(cl))return e[cl](this);i=Hu(i);const s=ba(this),o=Fn(void 0);try{if(!(i&$t.SkipSelf)){let l=this.records.get(e);if(void 0===l){const c=function rT(n){return"function"==typeof n||"object"==typeof n&&n instanceof Ye}(e)&&va(e);l=c&&this.injectableDefInScope(c)?Xc(pr(e),Zf):null,this.records.set(e,l)}if(null!=l)return this.hydrate(e,l)}return(i&$t.Self?Jf():this.parent).get(e,t=i&$t.Optional&&t===Bu?null:t)}catch(a){if("NullInjectorError"===a.name){if((a[Vu]=a[Vu]||[]).unshift(Mi(e)),s)throw a;return function vx(n,e,t,i){const r=n[Vu];throw e[w0]&&r.unshift(e[w0]),n.message=function wx(n,e,t,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let r=Mi(e);if(Array.isArray(e))r=e.map(Mi).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):Mi(a)))}r=`{${s.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${n.replace(yg,"\n  ")}`}("\n"+n.message,r,t,i),n.ngTokenPath=r,n[Vu]=null,n}(a,e,"R3InjectorError",this.source)}throw a}finally{Fn(o),ba(s)}}resolveInjectorInitializers(){const e=ba(this),t=Fn(void 0);try{const r=this.get(yh.multi,nn,$t.Self);for(const s of r)s()}finally{ba(e),Fn(t)}}toString(){const e=[],t=this.records;for(const i of t.keys())e.push(Mi(i));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ae(205,!1)}processProvider(e){let t=Ba(e=lt(e))?e:lt(e&&e.provide);const i=function nT(n){return P_(n)?Xc(void 0,n.useValue):Xc(ob(n),Zf)}(e);if(Ba(e)||!0!==e.multi)this.records.get(t);else{let r=this.records.get(t);r||(r=Xc(void 0,Zf,!0),r.factory=()=>Vd(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,i)}hydrate(e,t){return t.value===Zf&&(t.value=tT,t.value=t.factory()),"object"==typeof t.value&&t.value&&function O_(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=lt(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){const t=this._onDestroyHooks.indexOf(e);-1!==t&&this._onDestroyHooks.splice(t,1)}}function pr(n){const e=va(n),t=null!==e?e.factory:fl(n);if(null!==t)return t;if(n instanceof Ye)throw new ae(204,!1);if(n instanceof Function)return function L_(n){const e=n.length;if(e>0)throw ch(e,"?"),new ae(204,!1);const t=function Cs(n){return n&&(n[ku]||n[hg])||null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new ae(204,!1)}function ob(n,e,t){let i;if(Ba(n)){const r=lt(n);return fl(r)||pr(r)}if(P_(n))i=()=>lt(n.useValue);else if(function Kf(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...Vd(n.deps||[]));else if(function rb(n){return!(!n||!n.useExisting)}(n))i=()=>Oe(lt(n.useExisting));else{const r=lt(n&&(n.useClass||n.provide));if(!function iT(n){return!!n.deps}(n))return fl(r)||pr(r);i=()=>new r(...Vd(n.deps))}return i}function Xc(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function wh(n,e){for(const t of n)Array.isArray(t)?wh(t,e):t&&Ld(t)?wh(t.\u0275providers,e):e(t)}const ep=new Ye("AppId",{providedIn:"root",factory:()=>sT}),sT="ng",ab=new Ye("Platform Initializer"),Va=new Ye("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),lb=new Ye("AnimationModuleType"),cb=new Ye("CSP nonce",{providedIn:"root",factory:()=>function $c(){if(void 0!==kr)return kr;if(typeof document<"u")return document;throw new ae(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let db=(n,e,t)=>null;function G_(n,e,t=!1){return db(n,e,t)}class be{}class He{}class ht{resolveComponentFactory(e){throw function tt(n){const e=Error(`No component factory found for ${Mi(n)}.`);return e.ngComponent=n,e}(e)}}let Ht=(()=>{class n{static#e=this.NULL=new ht}return n})();function Qt(){return ji(zi(),ge())}function ji(n,e){return new En(Er(n,e))}let En=(()=>{class n{constructor(t){this.nativeElement=t}static#e=this.__NG_ELEMENT_ID__=Qt}return n})();function us(n){return n instanceof En?n.nativeElement:n}class kn{}let yi=(()=>{class n{constructor(){this.destroyNode=null}static#e=this.__NG_ELEMENT_ID__=()=>function na(){const n=ge(),t=Or(zi().index,n);return(Ii(t)?t:n)[xt]}()}return n})(),fb=(()=>{class n{static#e=this.\u0275prov=Je({token:n,providedIn:"root",factory:()=>null})}return n})();class W_{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const KG=new W_("16.2.9"),dT={};function gN(n,e=null,t=null,i){const r=_N(n,e,t,i);return r.resolveInjectorInitializers(),r}function _N(n,e=null,t=null,i,r=new Set){const s=[t||nn,QM(n)];return i=i||("object"==typeof n?void 0:Mi(n)),new Qf(s,e||Jf(),i||null,r)}let Zs=(()=>{class n{static#e=this.THROW_IF_NOT_FOUND=Bu;static#t=this.NULL=new D_;static create(t,i){if(Array.isArray(t))return gN({name:""},i,t,"");{const r=t.name??"";return gN({name:r},t.parent,t.providers,r)}}static#n=this.\u0275prov=Je({token:n,providedIn:"any",factory:()=>Oe(eb)});static#i=this.__NG_ELEMENT_ID__=-1}return n})();function pT(n){return n.ngOriginalError}class Al{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&pT(e);for(;t&&pT(t);)t=pT(t);return t||null}}function gT(n){return e=>{setTimeout(n,void 0,e)}}const qn=class i4 extends Jr{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,i){let r=e,s=t||(()=>null),o=i;if(e&&"object"==typeof e){const l=e;r=l.next?.bind(l),s=l.error?.bind(l),o=l.complete?.bind(l)}this.__isAsync&&(s=gT(s),r&&(r=gT(r)),o&&(o=gT(o)));const a=super.subscribe({next:r,error:s,complete:o});return e instanceof Yr&&e.add(a),a}};function vN(...n){}class Mn{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new qn(!1),this.onMicrotaskEmpty=new qn(!1),this.onStable=new qn(!1),this.onError=new qn(!1),typeof Zone>"u")throw new ae(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&t,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function r4(){const n="function"==typeof on.requestAnimationFrame;let e=on[n?"requestAnimationFrame":"setTimeout"],t=on[n?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&t){const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i);const r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function a4(n){const e=()=>{!function o4(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(on,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,yT(n),n.isCheckStableRunning=!0,_T(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),yT(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,r,s,o,a)=>{if(function c4(n){return!(!Array.isArray(n)||1!==n.length)&&!0===n[0].data?.__ignore_ng_zone__}(a))return t.invokeTask(r,s,o,a);try{return wN(n),t.invokeTask(r,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||n.shouldCoalesceRunChangeDetection)&&e(),bN(n)}},onInvoke:(t,i,r,s,o,a,l)=>{try{return wN(n),t.invoke(r,s,o,a,l)}finally{n.shouldCoalesceRunChangeDetection&&e(),bN(n)}},onHasTask:(t,i,r,s)=>{t.hasTask(r,s),i===r&&("microTask"==s.change?(n._hasPendingMicrotasks=s.microTask,yT(n),_T(n)):"macroTask"==s.change&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,i,r,s)=>(t.handleError(r,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Mn.isInAngularZone())throw new ae(909,!1)}static assertNotInAngularZone(){if(Mn.isInAngularZone())throw new ae(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,s4,vN,vN);try{return s.runTask(o,t,i)}finally{s.cancelTask(o)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const s4={};function _T(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function yT(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function wN(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function bN(n){n._nesting--,_T(n)}class l4{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new qn,this.onMicrotaskEmpty=new qn,this.onStable=new qn,this.onError=new qn}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}}const EN=new Ye("",{providedIn:"root",factory:SN});function SN(){const n=ze(Mn);let e=!0;return function u0(...n){const e=Lu(n),t=function ax(n,e){return"number"==typeof sg(n)?n.pop():e}(n,1/0),i=n;return i.length?1===i.length?Qr(i[0]):gc(t)(mi(i,e)):mo}(new Cn(r=>{e=n.isStable&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks,n.runOutsideAngular(()=>{r.next(e),r.complete()})}),new Cn(r=>{let s;n.runOutsideAngular(()=>{s=n.onStable.subscribe(()=>{Mn.assertNotInAngularZone(),queueMicrotask(()=>{!e&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks&&(e=!0,r.next(!0))})})});const o=n.onUnstable.subscribe(()=>{Mn.assertInAngularZone(),e&&(e=!1,n.runOutsideAngular(()=>{r.next(!1)}))});return()=>{s.unsubscribe(),o.unsubscribe()}}).pipe(ag()))}function Dl(n){return n instanceof Function?n():n}let vT=(()=>{class n{constructor(){this.renderDepth=0,this.handler=null}begin(){this.handler?.validateBegin(),this.renderDepth++}end(){this.renderDepth--,0===this.renderDepth&&this.handler?.execute()}ngOnDestroy(){this.handler?.destroy(),this.handler=null}static#e=this.\u0275prov=Je({token:n,providedIn:"root",factory:()=>new n})}return n})();function j_(n){for(;n;){n[Nt]|=64;const e=zc(n);if(Cg(n)&&!e)return n;n=e}return null}const AN=new Ye("",{providedIn:"root",factory:()=>!1});let mb=null;function PN(n,e){return n[e]??ON()}function NN(n,e){const t=ON();t.producerNode?.length&&(n[e]=mb,t.lView=n,mb=LN())}const v4={...R0,consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{j_(n.lView)},lView:null};function LN(){return Object.create(v4)}function ON(){return mb??=LN(),mb}const Bt={};function Lt(n){FN(Zt(),ge(),hr()+n,!1)}function FN(n,e,t,i){if(!i)if(3==(3&e[Nt])){const s=n.preOrderCheckHooks;null!==s&&nh(e,s,t)}else{const s=n.preOrderHooks;null!==s&&Ds(e,s,0,t)}La(t)}function ce(n,e=$t.Default){const t=ge();return null===t?Oe(n,e):ow(zi(),t,lt(n),e)}function gb(n,e,t,i,r,s,o,a,l,c,h){const d=e.blueprint.slice();return d[bn]=r,d[Nt]=140|i,(null!==c||n&&2048&n[Nt])&&(d[Nt]|=2048),lf(d),d[Wn]=d[Ec]=n,d[ci]=t,d[bc]=o||n&&n[bc],d[xt]=a||n&&n[xt],d[Wo]=l||n&&n[Wo]||null,d[Di]=s,d[jo]=function vM(){return yM++}(),d[is]=h,d[$d]=c,d[ui]=2==e.type?n[ui]:d,d}function op(n,e,t,i,r){let s=n.data[e];if(null===s)s=function wT(n,e,t,i,r){const s=ff(),o=Qu(),l=n.data[e]=function T4(n,e,t,i,r,s){let o=e?e.injectorIndex:-1,a=0;return Ac()&&(a|=128),{type:t,index:i,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,i,r);return null===n.firstChild&&(n.firstChild=l),null!==s&&(o?null==s.child&&null!==l.parent&&(s.child=l):null===s.next&&(s.next=l,l.prev=s)),l}(n,e,t,i,r),function K0(){return _t.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=t,s.value=i,s.attrs=r;const o=function Dc(){const n=_t.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return As(s,!0),s}function $_(n,e,t,i){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function UN(n,e,t,i,r){const s=PN(e,$o),o=hr(),a=2&i;try{La(-1),a&&e.length>kt&&FN(n,e,kt,!1),Eo(a?2:0,r);const c=a?s:null,h=Kd(c);try{null!==c&&(c.dirty=!1),t(i,r)}finally{xg(c,h)}}finally{a&&null===e[$o]&&NN(e,$o),La(o),Eo(a?3:1,r)}}function bT(n,e,t){if(Lr(e)){const i=rs(null);try{const s=e.directiveEnd;for(let o=e.directiveStart;o<s;o++){const a=n.data[o];a.contentQueries&&a.contentQueries(1,t[o],o)}}finally{rs(i)}}}function ET(n,e,t){ss()&&(function L4(n,e,t,i){const r=t.directiveStart,s=t.directiveEnd;Ut(t)&&function H4(n,e,t){const i=Er(e,n),r=BN(t);let o=16;t.signals?o=4096:t.onPush&&(o=64);const a=_b(n,gb(n,r,null,o,i,e,null,n[bc].rendererFactory.createRenderer(i,t),null,null,null));n[e.index]=a}(e,t,n.data[r+t.componentOffset]),n.firstCreatePass||Ef(t,e),tr(i,e);const o=t.initialInputs;for(let a=r;a<s;a++){const l=n.data[a],c=vl(e,n,a,t);tr(c,e),null!==o&&z4(0,a-r,c,l,0,o),js(l)&&(Or(t.index,e)[ci]=vl(e,n,a,t))}}(n,e,t,Er(t,e)),64==(64&t.flags)&&WN(n,e,t))}function ST(n,e,t=Er){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?t(e,n):n[o];n[r++]=a}}}function BN(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=CT(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function CT(n,e,t,i,r,s,o,a,l,c,h){const d=kt+i,p=d+r,m=function b4(n,e){const t=[];for(let i=0;i<e;i++)t.push(i<n?null:Bt);return t}(d,p),g="function"==typeof c?c():c;return m[Ve]={type:n,blueprint:m,template:t,queries:null,viewQuery:a,declTNode:e,data:m.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:p,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:g,incompleteFirstPass:!1,ssrId:h}}let VN=n=>null;function HN(n,e,t,i){for(let r in n)if(n.hasOwnProperty(r)){t=null===t?{}:t;const s=n[r];null===i?zN(t,e,r,s):i.hasOwnProperty(r)&&zN(t,e,i[r],s)}return t}function zN(n,e,t,i){n.hasOwnProperty(t)?n[t].push(e,i):n[t]=[e,i]}function xT(n,e,t,i){if(ss()){const r=null===i?null:{"":-1},s=function F4(n,e){const t=n.directiveRegistry;let i=null,r=null;if(t)for(let s=0;s<t.length;s++){const o=t[s];if(cn(e,o.selectors,!1))if(i||(i=[]),js(o))if(null!==o.findHostDirectiveDefs){const a=[];r=r||new Map,o.findHostDirectiveDefs(o,a,r),i.unshift(...a,o),MT(n,e,a.length)}else i.unshift(o),MT(n,e,0);else r=r||new Map,o.findHostDirectiveDefs?.(o,i,r),i.push(o)}return null===i?null:[i,r]}(n,t);let o,a;null===s?o=a=null:[o,a]=s,null!==o&&GN(n,e,t,o,r,a),r&&function k4(n,e,t){if(e){const i=n.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new ae(-301,!1);i.push(e[r],s)}}}(t,i,r)}t.mergedAttrs=ju(t.mergedAttrs,t.attrs)}function GN(n,e,t,i,r,s){for(let c=0;c<i.length;c++)oh(Ef(t,e),n,i[c].type);!function B4(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}(t,n.data.length,i.length);for(let c=0;c<i.length;c++){const h=i[c];h.providersResolver&&h.providersResolver(h)}let o=!1,a=!1,l=$_(n,e,i.length,null);for(let c=0;c<i.length;c++){const h=i[c];t.mergedAttrs=ju(t.mergedAttrs,h.hostAttrs),V4(n,t,e,l,h),U4(l,h,r),null!==h.contentQueries&&(t.flags|=4),(null!==h.hostBindings||null!==h.hostAttrs||0!==h.hostVars)&&(t.flags|=64);const d=h.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),l++}!function A4(n,e,t){const r=e.directiveEnd,s=n.data,o=e.attrs,a=[];let l=null,c=null;for(let h=e.directiveStart;h<r;h++){const d=s[h],p=t?t.get(d):null,g=p?p.outputs:null;l=HN(d.inputs,h,l,p?p.inputs:null),c=HN(d.outputs,h,c,g);const v=null===l||null===o||Y(e)?null:G4(l,h,o);a.push(v)}null!==l&&(l.hasOwnProperty("class")&&(e.flags|=8),l.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=l,e.outputs=c}(n,t,s)}function WN(n,e,t){const i=t.directiveStart,r=t.directiveEnd,s=t.index,o=function Z0(){return _t.lFrame.currentDirectiveIndex}();try{La(s);for(let a=i;a<r;a++){const l=n.data[a],c=e[a];pf(a),(null!==l.hostBindings||0!==l.hostVars||null!==l.hostAttrs)&&O4(l,c)}}finally{La(-1),pf(o)}}function O4(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function MT(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function U4(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;js(e)&&(t[""]=n)}}function V4(n,e,t,i,r){n.data[i]=r;const s=r.factory||(r.factory=fl(r.type)),o=new ih(s,js(r),ce);n.blueprint[i]=o,t[i]=o,function P4(n,e,t,i,r){const s=r.hostBindings;if(s){let o=n.hostBindingOpCodes;null===o&&(o=n.hostBindingOpCodes=[]);const a=~e.index;(function N4(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(o)!=a&&o.push(a),o.push(t,i,s)}}(n,e,i,$_(n,t,r.hostVars,Bt),r)}function Ha(n,e,t,i,r,s){const o=Er(n,e);!function TT(n,e,t,i,r,s,o){if(null==s)n.removeAttribute(e,r,t);else{const a=null==o?Et(s):o(s,i||"",r);n.setAttribute(e,r,a,t)}}(e[xt],o,s,n.value,t,i,r)}function z4(n,e,t,i,r,s){const o=s[e];if(null!==o)for(let a=0;a<o.length;)jN(i,t,o[a++],o[a++],o[a++])}function jN(n,e,t,i,r){const s=rs(null);try{const o=n.inputTransforms;null!==o&&o.hasOwnProperty(i)&&(r=o[i].call(e,r)),null!==n.setInput?n.setInput(e,r,t,i):e[i]=r}finally{rs(s)}}function G4(n,e,t){let i=null,r=0;for(;r<t.length;){const s=t[r];if(0!==s)if(5!==s){if("number"==typeof s)break;if(n.hasOwnProperty(s)){null===i&&(i=[]);const o=n[s];for(let a=0;a<o.length;a+=2)if(o[a]===e){i.push(s,o[a+1],t[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function $N(n,e,t,i){return[n,!0,!1,e,null,0,i,t,null,null,null]}function qN(n,e){const t=n.contentQueries;if(null!==t)for(let i=0;i<t.length;i+=2){const s=t[i+1];if(-1!==s){const o=n.data[s];Fg(t[i]),o.contentQueries(2,e[s],s)}}}function _b(n,e){return n[Qn]?n[Qi][Ws]=e:n[Qn]=e,n[Qi]=e,e}function AT(n,e,t){Fg(0);const i=rs(null);try{e(n,t)}finally{rs(i)}}function XN(n){return n[Sa]||(n[Sa]=[])}function YN(n){return n.cleanup||(n.cleanup=[])}function ZN(n,e){const t=n[Wo],i=t?t.get(Al,null):null;i&&i.handleError(e)}function DT(n,e,t,i,r){for(let s=0;s<t.length;){const o=t[s++],a=t[s++];jN(n.data[o],e[o],i,a,r)}}function W4(n,e){const t=Or(e,n),i=t[Ve];!function j4(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}(i,t);const r=t[bn];null!==r&&null===t[is]&&(t[is]=G_(r,t[Wo])),IT(i,t,t[ci])}function IT(n,e,t){Pa(e);try{const i=n.viewQuery;null!==i&&AT(1,i,t);const r=n.template;null!==r&&UN(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&qN(n,e),n.staticViewQueries&&AT(2,n.viewQuery,t);const s=n.components;null!==s&&function $4(n,e){for(let t=0;t<e.length;t++)W4(n,e[t])}(e,s)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[Nt]&=-5,Na()}}let JN=(()=>{class n{constructor(){this.all=new Set,this.queue=new Map}create(t,i,r){const s=typeof Zone>"u"?null:Zone.current,o=function Ix(n,e,t){const i=Object.create(Rx);t&&(i.consumerAllowSignalWrites=!0),i.fn=n,i.schedule=e;const r=o=>{i.cleanupFn=o};return i.ref={notify:()=>N0(i),run:()=>{if(i.dirty=!1,i.hasRun&&!bo(i))return;i.hasRun=!0;const o=Kd(i);try{i.cleanupFn(),i.cleanupFn=nf,i.fn(r)}finally{xg(i,o)}},cleanup:()=>i.cleanupFn()},i.ref}(t,c=>{this.all.has(c)&&this.queue.set(c,s)},r);let a;this.all.add(o),o.notify();const l=()=>{o.cleanup(),a?.(),this.all.delete(o),this.queue.delete(o)};return a=i?.onDestroy(l),{destroy:l}}flush(){if(0!==this.queue.size)for(const[t,i]of this.queue)this.queue.delete(t),i?i.run(()=>t.run()):t.run()}get isQueueEmpty(){return 0===this.queue.size}static#e=this.\u0275prov=Je({token:n,providedIn:"root",factory:()=>new n})}return n})();function yb(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?r=Pd(r,a):2==s&&(i=Pd(i,a+": "+e[++o]+";"))}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}function q_(n,e,t,i,r=!1){for(;null!==t;){const s=e[t.index];null!==s&&i.push(In(s)),Vi(s)&&QN(s,i);const o=t.type;if(8&o)q_(n,e,t.child,i);else if(32&o){const a=f_(t,e);let l;for(;l=a();)i.push(l)}else if(16&o){const a=Uw(e,t);if(Array.isArray(a))i.push(...a);else{const l=zc(e[ui]);q_(l[Ve],l,a,i,!0)}}t=r?t.projectionNext:t.next}return i}function QN(n,e){for(let t=Bi;t<n.length;t++){const i=n[t],r=i[Ve].firstChild;null!==r&&q_(i[Ve],i,r,e)}n[vo]!==n[bn]&&e.push(n[vo])}function vb(n,e,t,i=!0){const r=e[bc],s=r.rendererFactory,o=r.afterRenderEventManager;s.begin?.(),o?.begin();try{eL(n,e,n.template,t)}catch(l){throw i&&ZN(e,l),l}finally{s.end?.(),r.effectManager?.flush(),o?.end()}}function eL(n,e,t,i){const r=e[Nt];if(256!=(256&r)){e[bc].effectManager?.flush(),Pa(e);try{lf(e),function Y0(n){return _t.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&UN(n,e,t,2,i);const o=3==(3&r);if(o){const c=n.preOrderCheckHooks;null!==c&&nh(e,c,null)}else{const c=n.preOrderHooks;null!==c&&Ds(e,c,0,null),vf(e,0)}if(function Y4(n){for(let e=Dw(n);null!==e;e=Iw(e)){if(!e[D0])continue;const t=e[qo];for(let i=0;i<t.length;i++){G0(t[i])}}}(e),tL(e,2),null!==n.contentQueries&&qN(n,e),o){const c=n.contentCheckHooks;null!==c&&nh(e,c)}else{const c=n.contentHooks;null!==c&&Ds(e,c,1),vf(e,1)}!function w4(n,e){const t=n.hostBindingOpCodes;if(null===t)return;const i=PN(e,Ca);try{for(let r=0;r<t.length;r++){const s=t[r];if(s<0)La(~s);else{const o=s,a=t[++r],l=t[++r];Ux(a,o),i.dirty=!1;const c=Kd(i);try{l(2,e[o])}finally{xg(i,c)}}}}finally{null===e[Ca]&&NN(e,Ca),La(-1)}}(n,e);const a=n.components;null!==a&&iL(e,a,0);const l=n.viewQuery;if(null!==l&&AT(2,l,i),o){const c=n.viewCheckHooks;null!==c&&nh(e,c)}else{const c=n.viewHooks;null!==c&&Ds(e,c,2),vf(e,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),e[Nt]&=-73,cf(e)}finally{Na()}}}function tL(n,e){for(let t=Dw(n);null!==t;t=Iw(t))for(let i=Bi;i<t.length;i++)nL(t[i],e)}function K4(n,e,t){nL(Or(e,n),t)}function nL(n,e){if(!function Lx(n){return 128==(128&n[Nt])}(n))return;const t=n[Ve],i=n[Nt];if(80&i&&0===e||1024&i||2===e)eL(t,n,t.template,n[ci]);else if(n[Ea]>0){tL(n,1);const r=t.components;null!==r&&iL(n,r,1)}}function iL(n,e,t){for(let i=0;i<e.length;i++)K4(n,e[i],t)}class X_{get rootNodes(){const e=this._lView,t=e[Ve];return q_(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[ci]}set context(e){this._lView[ci]=e}get destroyed(){return 256==(256&this._lView[Nt])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[Wn];if(Vi(e)){const t=e[8],i=t?t.indexOf(this):-1;i>-1&&(Hf(e,i),Cf(t,i))}this._attachedToViewContainer=!1}dr(this._lView[Ve],this._lView)}onDestroy(e){!function uf(n,e){if(256==(256&n[Nt]))throw new ae(911,!1);null===n[ns]&&(n[ns]=[]),n[ns].push(e)}(this._lView,e)}markForCheck(){j_(this._cdRefInjectingView||this._lView)}detach(){this._lView[Nt]&=-129}reattach(){this._lView[Nt]|=128}detectChanges(){vb(this._lView[Ve],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ae(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function Ks(n,e){Ml(n,e,e[xt],2,null,null)}(this._lView[Ve],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new ae(902,!1);this._appRef=e}}class Z4 extends X_{constructor(e){super(e),this._view=e}detectChanges(){const e=this._view;vb(e[Ve],e,e[ci],!1)}checkNoChanges(){}get context(){return null}}class rL extends Ht{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=Yt(e);return new Y_(t,this.ngModule)}}function sL(n){const e=[];for(let t in n)n.hasOwnProperty(t)&&e.push({propName:n[t],templateName:t});return e}class Q4{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){i=Hu(i);const r=this.injector.get(e,dT,i);return r!==dT||t===dT?r:this.parentInjector.get(e,t,i)}}class Y_ extends He{get inputs(){const e=this.componentDef,t=e.inputTransforms,i=sL(e.inputs);if(null!==t)for(const r of i)t.hasOwnProperty(r.propName)&&(r.transform=t[r.propName]);return i}get outputs(){return sL(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function Ex(n){return n.map(Gd).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,i,r){let s=(r=r||this.ngModule)instanceof cs?r:r?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const o=s?new Q4(e,s):e,a=o.get(kn,null);if(null===a)throw new ae(407,!1);const d={rendererFactory:a,sanitizer:o.get(fb,null),effectManager:o.get(JN,null),afterRenderEventManager:o.get(vT,null)},p=a.createRenderer(null,this.componentDef),m=this.componentDef.selectors[0][0]||"div",g=i?function E4(n,e,t,i){const s=i.get(AN,!1)||t===xs.ShadowDom,o=n.selectRootElement(e,s);return function S4(n){VN(n)}(o),o}(p,i,this.componentDef.encapsulation,o):Vf(p,m,function J4(n){const e=n.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(m)),y=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let b=null;null!==g&&(b=G_(g,o,!0));const E=CT(0,null,null,1,0,null,null,null,null,null,null),C=gb(null,E,null,y,null,null,d,p,o,null,b);let x,A;Pa(C);try{const D=this.componentDef;let O,T=null;D.findHostDirectiveDefs?(O=[],T=new Map,D.findHostDirectiveDefs(D,O,T),O.push(D)):O=[D];const R=function t5(n,e){const t=n[Ve],i=kt;return n[i]=e,op(t,i,2,"#host",null)}(C,g),$=function n5(n,e,t,i,r,s,o){const a=r[Ve];!function i5(n,e,t,i){for(const r of n)e.mergedAttrs=ju(e.mergedAttrs,r.hostAttrs);null!==e.mergedAttrs&&(yb(e,e.mergedAttrs,!0),null!==t&&Vw(i,t,e))}(i,n,e,o);let l=null;null!==e&&(l=G_(e,r[Wo]));const c=s.rendererFactory.createRenderer(e,t);let h=16;t.signals?h=4096:t.onPush&&(h=64);const d=gb(r,BN(t),null,h,r[n.index],n,s,c,null,null,l);return a.firstCreatePass&&MT(a,n,i.length-1),_b(r,d),r[n.index]=d}(R,g,D,O,C,d,p);A=Ju(E,kt),g&&function s5(n,e,t,i){if(i)Hd(n,t,["ng-version",KG.full]);else{const{attrs:r,classes:s}=function wc(n){const e=[],t=[];let i=1,r=2;for(;i<n.length;){let s=n[i];if("string"==typeof s)2===r?""!==s&&e.push(s,n[++i]):8===r&&t.push(s);else{if(!Ue(r))break;r=s}i++}return{attrs:e,classes:t}}(e.selectors[0]);r&&Hd(n,t,r),s&&s.length>0&&Bw(n,t,s.join(" "))}}(p,D,g,i),void 0!==t&&function o5(n,e,t){const i=n.projection=[];for(let r=0;r<e.length;r++){const s=t[r];i.push(null!=s?Array.from(s):null)}}(A,this.ngContentSelectors,t),x=function r5(n,e,t,i,r,s){const o=zi(),a=r[Ve],l=Er(o,r);GN(a,r,o,t,null,i);for(let h=0;h<t.length;h++)tr(vl(r,a,o.directiveStart+h,o),r);WN(a,r,o),l&&tr(l,r);const c=vl(r,a,o.directiveStart+o.componentOffset,o);if(n[ci]=r[ci]=c,null!==s)for(const h of s)h(c,e);return bT(a,o,n),c}($,D,O,T,C,[a5]),IT(E,C,null)}finally{Na()}return new e5(this.componentType,x,ji(A,C),C,A)}}class e5 extends be{constructor(e,t,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new Z4(r),this.componentType=e}setInput(e,t){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;const s=this._rootLView;DT(s[Ve],s,r,e,t),this.previousInputValues.set(e,t),j_(Or(this._tNode.index,s))}}get injector(){return new Cr(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function a5(){const n=zi();yf(ge()[Ve],n)}function gn(n){let e=function oL(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),t=!0;const i=[n];for(;e;){let r;if(js(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new ae(903,!1);r=e.\u0275dir}if(r){if(t){i.push(r);const o=n;o.inputs=wb(n.inputs),o.inputTransforms=wb(n.inputTransforms),o.declaredInputs=wb(n.declaredInputs),o.outputs=wb(n.outputs);const a=r.hostBindings;a&&h5(n,a);const l=r.viewQuery,c=r.contentQueries;if(l&&c5(n,l),c&&u5(n,c),yc(n.inputs,r.inputs),yc(n.declaredInputs,r.declaredInputs),yc(n.outputs,r.outputs),null!==r.inputTransforms&&(null===o.inputTransforms&&(o.inputTransforms={}),yc(o.inputTransforms,r.inputTransforms)),js(r)&&r.data.animation){const h=n.data;h.animation=(h.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(n),a===gn&&(t=!1)}}e=Object.getPrototypeOf(e)}!function l5(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){const r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=ju(r.hostAttrs,t=ju(t,r.hostAttrs))}}(i)}function wb(n){return n===_o?{}:n===nn?[]:n}function c5(n,e){const t=n.viewQuery;n.viewQuery=t?(i,r)=>{e(i,r),t(i,r)}:e}function u5(n,e){const t=n.contentQueries;n.contentQueries=t?(i,r,s)=>{e(i,r,s),t(i,r,s)}:e}function h5(n,e){const t=n.hostBindings;n.hostBindings=t?(i,r)=>{e(i,r),t(i,r)}:e}function bb(n){return!!RT(n)&&(Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n)}function RT(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function za(n,e,t){return n[e]=t}function Ur(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function Sh(n,e,t,i){const r=Ur(n,e,t);return Ur(n,e+1,i)||r}function si(n,e,t,i){const r=ge();return Ur(r,Ic(),e)&&(Zt(),Ha(Rn(),r,n,e,t,i)),si}function _n(n,e,t,i,r,s,o,a){const l=ge(),c=Zt(),h=n+kt,d=c.firstCreatePass?function F5(n,e,t,i,r,s,o,a,l){const c=e.consts,h=op(e,n,4,o||null,Ra(c,a));xT(e,t,h,Ra(c,l)),yf(e,h);const d=h.tView=CT(2,h,i,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c,null);return null!==e.queries&&(e.queries.template(e,h),d.queries=e.queries.embeddedTView(h)),h}(h,c,l,e,t,i,r,s,o):c.data[h];As(d,!1);const p=SL(c,l,d,n);_l()&&Gf(c,l,p,d),tr(p,l),_b(l,l[h]=$N(p,l,p,d)),Xd(d)&&ET(c,l,d),null!=o&&ST(l,d,a)}let SL=function CL(n,e,t,i){return Zo(!0),e[xt].createComment("")};function kT(n){return function Tc(n,e){return n[e]}(function kx(){return _t.lFrame.contextLView}(),kt+n)}function vt(n,e,t){const i=ge();return Ur(i,Ic(),e)&&function Js(n,e,t,i,r,s,o,a){const l=Er(e,t);let h,c=e.inputs;!a&&null!=c&&(h=c[i])?(DT(n,t,h,i,r),Ut(e)&&function I4(n,e){const t=Or(e,n);16&t[Nt]||(t[Nt]|=64)}(t,e.index)):3&e.type&&(i=function D4(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=o?o(r,e.value||"",i):r,s.setProperty(l,i,r))}(Zt(),Rn(),i,n,e,i[xt],t,!1),vt}function UT(n,e,t,i,r){const o=r?"class":"style";DT(n,t,e.inputs[o],o,i)}function It(n,e,t,i){const r=ge(),s=Zt(),o=kt+n,a=r[xt],l=s.firstCreatePass?function V5(n,e,t,i,r,s){const o=e.consts,l=op(e,n,2,i,Ra(o,r));return xT(e,t,l,Ra(o,s)),null!==l.attrs&&yb(l,l.attrs,!1),null!==l.mergedAttrs&&yb(l,l.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,l),l}(o,s,r,e,t,i):s.data[o],c=xL(s,r,l,a,e,n);r[o]=c;const h=Xd(l);return As(l,!0),Vw(a,c,l),32!=(32&l.flags)&&_l()&&Gf(s,r,c,l),0===function $0(){return _t.lFrame.elementDepthCount}()&&tr(c,r),function Ox(){_t.lFrame.elementDepthCount++}(),h&&(ET(s,r,l),bT(s,l,r)),null!==i&&ST(r,l),It}function Mt(){let n=zi();Qu()?So():(n=n.parent,As(n,!1));const e=n;(function df(n){return _t.skipHydrationRootTNode===n})(e)&&function os(){_t.skipHydrationRootTNode=null}(),function Fx(){_t.lFrame.elementDepthCount--}();const t=Zt();return t.firstCreatePass&&(yf(t,n),Lr(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function wf(n){return 0!=(8&n.flags)}(e)&&UT(t,e,ge(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function Pc(n){return 0!=(16&n.flags)}(e)&&UT(t,e,ge(),e.stylesWithoutHost,!1),Mt}function Br(n,e,t,i){return It(n,e,t,i),Mt(),Br}let xL=(n,e,t,i,r,s)=>(Zo(!0),Vf(i,r,function Q0(){return _t.lFrame.currentNamespace}()));function Zc(n,e,t){const i=ge(),r=Zt(),s=n+kt,o=r.firstCreatePass?function G5(n,e,t,i,r){const s=e.consts,o=Ra(s,i),a=op(e,n,8,"ng-container",o);return null!==o&&yb(a,o,!0),xT(e,t,a,Ra(s,r)),null!==e.queries&&e.queries.elementStart(e,a),a}(s,r,i,e,t):r.data[s];As(o,!0);const a=ML(r,i,o,n);return i[s]=a,_l()&&Gf(r,i,a,o),tr(a,i),Xd(o)&&(ET(r,i,o),bT(r,o,i)),null!=t&&ST(i,o),Zc}function Jc(){let n=zi();const e=Zt();return Qu()?So():(n=n.parent,As(n,!1)),e.firstCreatePass&&(yf(e,n),Lr(n)&&e.queries.elementEnd(n)),Jc}function BT(n,e,t){return Zc(n,e,t),Jc(),BT}let ML=(n,e,t,i)=>(Zo(!0),m_(e[xt],""));function Ch(){return ge()}function ey(n){return!!n&&"function"==typeof n.then}function TL(n){return!!n&&"function"==typeof n.subscribe}function yn(n,e,t,i){const r=ge(),s=Zt(),o=zi();return function DL(n,e,t,i,r,s,o){const a=Xd(i),c=n.firstCreatePass&&YN(n),h=e[ci],d=XN(e);let p=!0;if(3&i.type||o){const v=Er(i,e),w=o?o(v):v,y=d.length,b=o?C=>o(In(C[i.index])):i.index;let E=null;if(!o&&a&&(E=function $5(n,e,t,i){const r=n.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===t&&r[s+1]===i){const a=e[Sa],l=r[s+2];return a.length>l?a[l]:null}"string"==typeof o&&(s+=2)}return null}(n,e,r,i.index)),null!==E)(E.__ngLastListenerFn__||E).__ngNextListenerFn__=s,E.__ngLastListenerFn__=s,p=!1;else{s=RL(i,e,h,s,!1);const C=t.listen(w,r,s);d.push(s,C),c&&c.push(r,b,y,y+1)}}else s=RL(i,e,h,s,!1);const m=i.outputs;let g;if(p&&null!==m&&(g=m[r])){const v=g.length;if(v)for(let w=0;w<v;w+=2){const x=e[g[w]][g[w+1]].subscribe(s),A=d.length;d.push(s,x),c&&c.push(r,i.index,A,-(A+1))}}}(s,r,r[xt],o,n,e,i),yn}function IL(n,e,t,i){try{return Eo(6,e,t),!1!==t(i)}catch(r){return ZN(n,r),!1}finally{Eo(7,e,t)}}function RL(n,e,t,i,r){return function s(o){if(o===Function)return i;j_(n.componentOffset>-1?Or(n.index,e):e);let l=IL(e,t,i,o),c=s.__ngNextListenerFn__;for(;c;)l=IL(e,t,c,o)&&l,c=c.__ngNextListenerFn__;return r&&!1===l&&o.preventDefault(),l}}function dn(n=1){return function th(n){return(_t.lFrame.contextLView=function Vx(n,e){for(;n>0;)e=e[Ec],n--;return e}(n,_t.lFrame.contextLView))[ci]}(n)}function q5(n,e){let t=null;const i=function Ai(n){const e=n.attrs;if(null!=e){const t=e.indexOf(5);if(!(1&t))return e[t+1]}return null}(n);for(let r=0;r<e.length;r++){const s=e[r];if("*"!==s){if(null===i?cn(n,s,!0):bx(i,s))return r}else t=r}return t}function VT(n){const e=ge()[ui][Di];if(!e.projection){const i=e.projection=ch(n?n.length:1,null),r=i.slice();let s=e.child;for(;null!==s;){const o=n?q5(s,n):0;null!==o&&(r[o]?r[o].projectionNext=s:i[o]=s,r[o]=s),s=s.next}}}function HT(n,e=0,t){const i=ge(),r=Zt(),s=op(r,kt+n,16,null,t||null);null===s.projection&&(s.projection=e),So(),(!i[is]||Ac())&&32!=(32&s.flags)&&function RM(n,e,t){w_(e[xt],0,e,t,g_(n,t,e),dh(t.parent||e[Di],t,e))}(r,i,s)}function Mb(n,e){return n<<17|e<<2}function Qc(n){return n>>17&32767}function GT(n){return 2|n}function xh(n){return(131068&n)>>2}function WT(n,e){return-131069&n|e<<2}function jT(n){return 1|n}function HL(n,e,t,i,r){const s=n[t+1],o=null===e;let a=i?Qc(s):xh(s),l=!1;for(;0!==a&&(!1===l||o);){const h=n[a+1];Q5(n[a],e)&&(l=!0,n[a+1]=i?jT(h):GT(h)),a=i?Qc(h):xh(h)}l&&(n[t+1]=i?GT(s):jT(s))}function Q5(n,e){return null===n||null==e||(Array.isArray(n)?n[1]:n)===e||!(!Array.isArray(n)||"string"!=typeof e)&&Uc(n,e)>=0}const nr={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function zL(n){return n.substring(nr.key,nr.keyEnd)}function GL(n,e){const t=nr.textEnd;return t===e?-1:(e=nr.keyEnd=function iW(n,e,t){for(;e<t&&n.charCodeAt(e)>32;)e++;return e}(n,nr.key=e,t),gp(n,e,t))}function gp(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function ty(n,e){return function ia(n,e,t,i){const r=ge(),s=Zt(),o=Ko(2);s.firstUpdatePass&&KL(s,n,o,i),e!==Bt&&Ur(r,o,e)&&JL(s,s.data[hr()],r,r[xt],n,r[o+1]=function pW(n,e){return null==n||""===n||("string"==typeof e?n+=e:"object"==typeof n&&(n=Mi(Ua(n)))),n}(e,t),i,o)}(n,e,null,!0),ty}function Rl(n){!function ra(n,e,t,i){const r=Zt(),s=Ko(2);r.firstUpdatePass&&KL(r,null,s,i);const o=ge();if(t!==Bt&&Ur(o,s,t)){const a=r.data[hr()];if(eO(a,i)&&!YL(r,s)){let l=i?a.classesWithoutHost:a.stylesWithoutHost;null!==l&&(t=Pd(l,t||"")),UT(r,a,o,t,i)}else!function fW(n,e,t,i,r,s,o,a){r===Bt&&(r=nn);let l=0,c=0,h=0<r.length?r[0]:null,d=0<s.length?s[0]:null;for(;null!==h||null!==d;){const p=l<r.length?r[l+1]:void 0,m=c<s.length?s[c+1]:void 0;let v,g=null;h===d?(l+=2,c+=2,p!==m&&(g=d,v=m)):null===d||null!==h&&h<d?(l+=2,g=h):(c+=2,g=d,v=m),null!==g&&JL(n,e,t,i,g,v,o,a),h=l<r.length?r[l]:null,d=c<s.length?s[c]:null}}(r,a,o,o[xt],o[s+1],o[s+1]=function hW(n,e,t){if(null==t||""===t)return nn;const i=[],r=Ua(t);if(Array.isArray(r))for(let s=0;s<r.length;s++)n(i,r[s],!0);else if("object"==typeof r)for(const s in r)r.hasOwnProperty(s)&&n(i,s,r[s]);else"string"==typeof r&&e(i,r);return i}(n,e,t),i,s)}}(dW,Wa,n,!0)}function Wa(n,e){for(let t=function tW(n){return function jL(n){nr.key=0,nr.keyEnd=0,nr.value=0,nr.valueEnd=0,nr.textEnd=n.length}(n),GL(n,gp(n,0,nr.textEnd))}(e);t>=0;t=GL(e,t))jn(n,zL(e),!0)}function YL(n,e){return e>=n.expandoStartIndex}function KL(n,e,t,i){const r=n.data;if(null===r[t+1]){const s=r[hr()],o=YL(n,t);eO(s,i)&&null===e&&!o&&(e=!1),e=function aW(n,e,t,i){const r=function ur(n){const e=_t.lFrame.currentDirectiveIndex;return-1===e?null:n[e]}(n);let s=i?e.residualClasses:e.residualStyles;if(null===r)0===(i?e.classBindings:e.styleBindings)&&(t=ny(t=$T(null,n,e,t,i),e.attrs,i),s=null);else{const o=e.directiveStylingLast;if(-1===o||n[o]!==r)if(t=$T(r,n,e,t,i),null===s){let l=function lW(n,e,t){const i=t?e.classBindings:e.styleBindings;if(0!==xh(i))return n[Qc(i)]}(n,e,i);void 0!==l&&Array.isArray(l)&&(l=$T(null,n,e,l[1],i),l=ny(l,e.attrs,i),function cW(n,e,t,i){n[Qc(t?e.classBindings:e.styleBindings)]=i}(n,e,i,l))}else s=function uW(n,e,t){let i;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)i=ny(i,n[s].hostAttrs,t);return ny(i,e.attrs,t)}(n,e,i)}return void 0!==s&&(i?e.residualClasses=s:e.residualStyles=s),t}(r,s,e,i),function Z5(n,e,t,i,r,s){let o=s?e.classBindings:e.styleBindings,a=Qc(o),l=xh(o);n[i]=t;let h,c=!1;if(Array.isArray(t)?(h=t[1],(null===h||Uc(t,h)>0)&&(c=!0)):h=t,r)if(0!==l){const p=Qc(n[a+1]);n[i+1]=Mb(p,a),0!==p&&(n[p+1]=WT(n[p+1],i)),n[a+1]=function Y5(n,e){return 131071&n|e<<17}(n[a+1],i)}else n[i+1]=Mb(a,0),0!==a&&(n[a+1]=WT(n[a+1],i)),a=i;else n[i+1]=Mb(l,0),0===a?a=i:n[l+1]=WT(n[l+1],i),l=i;c&&(n[i+1]=GT(n[i+1])),HL(n,h,i,!0),HL(n,h,i,!1),function J5(n,e,t,i,r){const s=r?n.residualClasses:n.residualStyles;null!=s&&"string"==typeof e&&Uc(s,e)>=0&&(t[i+1]=jT(t[i+1]))}(e,h,n,i,s),o=Mb(a,l),s?e.classBindings=o:e.styleBindings=o}(r,s,e,t,o,i)}}function $T(n,e,t,i,r){let s=null;const o=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<o&&(s=e[a],i=ny(i,s.hostAttrs,r),s!==n);)a++;return null!==n&&(t.directiveStylingLast=a),i}function ny(n,e,t){const i=t?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?r=o:r===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),jn(n,o,!!t||e[++s]))}return void 0===n?null:n}function dW(n,e,t){const i=String(e);""!==i&&!i.includes(" ")&&jn(n,i,t)}function JL(n,e,t,i,r,s,o,a){if(!(3&e.type))return;const l=n.data,c=l[a+1],h=function K5(n){return 1==(1&n)}(c)?QL(l,e,t,r,xh(c),o):void 0;Tb(h)||(Tb(s)||function X5(n){return 2==(2&n)}(c)&&(s=QL(l,null,t,r,a,o)),function ls(n,e,t,i,r){if(e)r?n.addClass(t,i):n.removeClass(t,i);else{let s=-1===i.indexOf("-")?void 0:Fa.DashCase;null==r?n.removeStyle(t,i,s):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),s|=Fa.Important),n.setStyle(t,i,r,s))}}(i,o,Zu(hr(),t),r,s))}function QL(n,e,t,i,r,s){const o=null===e;let a;for(;r>0;){const l=n[r],c=Array.isArray(l),h=c?l[1]:l,d=null===h;let p=t[r+1];p===Bt&&(p=d?nn:void 0);let m=d?Jg(p,i):h===i?p:void 0;if(c&&!Tb(m)&&(m=Jg(l,i)),Tb(m)&&(a=m,o))return a;const g=n[r+1];r=o?Qc(g):xh(g)}if(null!==e){let l=s?e.residualClasses:e.residualStyles;null!=l&&(a=Jg(l,i))}return a}function Tb(n){return void 0!==n}function eO(n,e){return 0!=(n.flags&(e?8:16))}function Tn(n,e=""){const t=ge(),i=Zt(),r=n+kt,s=i.firstCreatePass?op(i,r,1,e,null):i.data[r],o=tO(i,t,s,e,n);t[r]=o,_l()&&Gf(i,t,o,s),As(s,!1)}let tO=(n,e,t,i,r)=>(Zo(!0),function Bf(n,e){return n.createText(e)}(e[xt],i));function Pl(n){return _p("",n,""),Pl}function _p(n,e,t){const i=ge(),r=function lp(n,e,t,i){return Ur(n,Ic(),t)?e+Et(t)+i:Bt}(i,n,e,t);return r!==Bt&&function Il(n,e,t){const i=Zu(e,n);!function Pw(n,e,t){n.setValue(e,t)}(n[xt],i,t)}(i,hr(),r),_p}const vp="en-US";let SO=vp;function YT(n,e,t,i,r){if(n=lt(n),Array.isArray(n))for(let s=0;s<n.length;s++)YT(n[s],e,t,i,r);else{const s=Zt(),o=ge(),a=zi();let l=Ba(n)?n:lt(n.provide);const c=ob(n),h=1048575&a.providerIndexes,d=a.directiveStart,p=a.providerIndexes>>20;if(Ba(n)||!n.multi){const m=new ih(c,r,ce),g=ZT(l,e,r?h:h+p,d);-1===g?(oh(Ef(a,o),s,l),KT(s,n,e.length),e.push(l),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(m),o.push(m)):(t[g]=m,o[g]=m)}else{const m=ZT(l,e,h+p,d),g=ZT(l,e,h,h+p),w=g>=0&&t[g];if(r&&!w||!r&&!(m>=0&&t[m])){oh(Ef(a,o),s,l);const y=function Oj(n,e,t,i,r){const s=new ih(n,t,ce);return s.multi=[],s.index=e,s.componentProviders=0,XO(s,r,i&&!t),s}(r?Lj:Nj,t.length,r,i,c);!r&&w&&(t[g].providerFactory=y),KT(s,n,e.length,0),e.push(l),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(y),o.push(y)}else KT(s,n,m>-1?m:g,XO(t[r?g:m],c,!r&&i));!r&&i&&w&&t[g].componentProviders++}}}function KT(n,e,t,i){const r=Ba(e),s=function sb(n){return!!n.useClass}(e);if(r||s){const l=(s?lt(e.useClass):e).prototype.ngOnDestroy;if(l){const c=n.destroyHooks||(n.destroyHooks=[]);if(!r&&e.multi){const h=c.indexOf(t);-1===h?c.push(t,[i,l]):c[h+1].push(i,l)}else c.push(t,l)}}}function XO(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function ZT(n,e,t,i){for(let r=t;r<i;r++)if(e[r]===n)return r;return-1}function Nj(n,e,t,i){return JT(this.multi,[])}function Lj(n,e,t,i){const r=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=vl(t,t[Ve],this.providerFactory.index,i);s=a.slice(0,o),JT(r,s);for(let l=o;l<a.length;l++)s.push(a[l])}else s=[],JT(r,s);return s}function JT(n,e){for(let t=0;t<n.length;t++)e.push((0,n[t])());return e}function Un(n,e=[]){return t=>{t.providersResolver=(i,r)=>function Pj(n,e,t){const i=Zt();if(i.firstCreatePass){const r=js(n);YT(t,i.data,i.blueprint,r,!0),YT(e,i.data,i.blueprint,r,!1)}}(i,r?r(n):n,e)}}class Th{}class YO{}class QT extends Th{constructor(e,t,i){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new rL(this);const r=lr(e);this._bootstrapComponents=Dl(r.bootstrap),this._r3Injector=_N(e,t,[{provide:Th,useValue:this},{provide:Ht,useValue:this.componentFactoryResolver},...i],Mi(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class eA extends YO{constructor(e){super(),this.moduleType=e}create(e){return new QT(this.moduleType,e,[])}}class KO extends Th{constructor(e){super(),this.componentFactoryResolver=new rL(this),this.instance=null;const t=new Qf([...e.providers,{provide:Th,useValue:this},{provide:Ht,useValue:this.componentFactoryResolver}],e.parent||Jf(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function tA(n,e,t=null){return new KO({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}let Uj=(()=>{class n{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){const i=nb(0,t.type),r=i.length>0?tA([i],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,r)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}static#e=this.\u0275prov=Je({token:n,providedIn:"environment",factory:()=>new n(Oe(cs))})}return n})();function ly(n){n.getStandaloneInjector=e=>e.get(Uj).getOrCreateStandaloneInjector(n)}function i2(n,e,t,i){return function s2(n,e,t,i,r,s){const o=e+t;return Ur(n,o,r)?za(n,o+1,s?i.call(s,r):i(r)):cy(n,o+1)}(ge(),cr(),n,e,t,i)}function r2(n,e,t,i,r){return function o2(n,e,t,i,r,s,o){const a=e+t;return Sh(n,a,r,s)?za(n,a+2,o?i.call(o,r,s):i(r,s)):cy(n,a+2)}(ge(),cr(),n,e,t,i,r)}function Pb(n,e,t,i,r,s){return function a2(n,e,t,i,r,s,o,a){const l=e+t;return function Eb(n,e,t,i,r){const s=Sh(n,e,t,i);return Ur(n,e+2,r)||s}(n,l,r,s,o)?za(n,l+3,a?i.call(a,r,s,o):i(r,s,o)):cy(n,l+3)}(ge(),cr(),n,e,t,i,r,s)}function cy(n,e){const t=n[e];return t===Bt?void 0:t}function a8(){return this._results[Symbol.iterator]()}class iA{static#e=Symbol.iterator;get changes(){return this._changes||(this._changes=new qn)}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=iA.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=a8)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const i=this;i.dirty=!1;const r=function Is(n){return n.flat(Number.POSITIVE_INFINITY)}(e);(this._changesDetected=!function Yx(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],s=e[i];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}(i._results,r,t))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}function c8(n,e,t,i=!0){const r=e[Ve];if(function DM(n,e,t,i){const r=Bi+i,s=t.length;i>0&&(t[r-1][Ws]=e),i<s-Bi?(e[Ws]=t[r],Zg(t,Bi+i,e)):(t.push(e),e[Ws]=null),e[Wn]=t;const o=e[Sc];null!==o&&t!==o&&function Sl(n,e){const t=n[qo];e[ui]!==e[Wn][Wn][ui]&&(n[D0]=!0),null===t?n[qo]=[e]:t.push(e)}(o,e);const a=e[Ts];null!==a&&a.insertView(n),e[Nt]|=128}(r,e,n,t),i){const s=y_(t,n),o=e[xt],a=Rs(o,n[vo]);null!==a&&function TM(n,e,t,i,r,s){i[bn]=r,i[Di]=e,Ml(n,i,t,1,r,s)}(r,n[Di],o,e,a,s)}}let ja=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=d8}return n})();const u8=ja,h8=class extends u8{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,i){const r=function l8(n,e,t,i){const r=e.tView,a=gb(n,r,t,4096&n[Nt]?4096:16,null,e,null,null,null,i?.injector??null,i?.hydrationInfo??null);a[Sc]=n[e.index];const c=n[Ts];return null!==c&&(a[Ts]=c.createEmbeddedView(r)),IT(r,a,t),a}(this._declarationLView,this._declarationTContainer,e,{injector:t,hydrationInfo:i});return new X_(r)}};function d8(){return Nb(zi(),ge())}function Nb(n,e){return 4&n.type?new h8(e,n,ji(n,e)):null}let sa=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=y8}return n})();function y8(){return g2(zi(),ge())}const v8=sa,p2=class extends v8{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return ji(this._hostTNode,this._hostLView)}get injector(){return new Cr(this._hostTNode,this._hostLView)}get parentInjector(){const e=Gi(this._hostTNode,this._hostLView);if(sh(e)){const t=yl(e,this._hostLView),i=Xs(e);return new Cr(t[Ve].data[i+8],t)}return new Cr(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=m2(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-Bi}createEmbeddedView(e,t,i){let r,s;"number"==typeof i?r=i:null!=i&&(r=i.index,s=i.injector);const a=e.createEmbeddedViewImpl(t||{},s,null);return this.insertImpl(a,r,false),a}createComponent(e,t,i,r,s){const o=e&&!function Fc(n){return"function"==typeof n}(e);let a;if(o)a=t;else{const v=t||{};a=v.index,i=v.injector,r=v.projectableNodes,s=v.environmentInjector||v.ngModuleRef}const l=o?e:new Y_(Yt(e)),c=i||this.parentInjector;if(!s&&null==l.ngModule){const w=(o?c:this.parentInjector).get(cs,null);w&&(s=w)}Yt(l.componentType??{});const m=l.create(c,r,null,s);return this.insertImpl(m.hostView,a,false),m}insert(e,t){return this.insertImpl(e,t,!1)}insertImpl(e,t,i){const r=e._lView;if(function z0(n){return Vi(n[Wn])}(r)){const l=this.indexOf(e);if(-1!==l)this.detach(l);else{const c=r[Wn],h=new p2(c,c[Di],c[Wn]);h.detach(h.indexOf(e))}}const o=this._adjustIndex(t),a=this._lContainer;return c8(a,r,o,!i),e.attachToViewContainerRef(),Zg(rA(a),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=m2(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=Hf(this._lContainer,t);i&&(Cf(rA(this._lContainer),t),dr(i[Ve],i))}detach(e){const t=this._adjustIndex(e,-1),i=Hf(this._lContainer,t);return i&&null!=Cf(rA(this._lContainer),t)?new X_(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function m2(n){return n[8]}function rA(n){return n[8]||(n[8]=[])}function g2(n,e){let t;const i=e[n.index];return Vi(i)?t=i:(t=$N(i,e,null,n),e[n.index]=t,_b(e,t)),_2(t,e,n,i),new p2(t,n,e)}let _2=function y2(n,e,t,i){if(n[vo])return;let r;r=8&t.type?In(i):function w8(n,e){const t=n[xt],i=t.createComment(""),r=Er(e,n);return Cl(t,Rs(t,r),i,function Fw(n,e){return n.nextSibling(e)}(t,r),!1),i}(e,t),n[vo]=r};class sA{constructor(e){this.queryList=e,this.matches=null}clone(){return new sA(this.queryList)}setDirty(){this.queryList.setDirty()}}class oA{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let s=0;s<i;s++){const o=t.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new oA(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==S2(e,t).matches&&this.queries[t].setDirty()}}class v2{constructor(e,t,i=null){this.predicate=e,this.flags=t,this.read=i}}class aA{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,s=this.getByIndex(i).embeddedTView(e,r);s&&(s.indexInDeclarationView=i,null!==t?t.push(s):t=[s])}return null!==t?new aA(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class lA{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new lA(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(e,t,S8(t,s)),this.matchTNodeWithReadOption(e,t,ah(t,e,s,!1,!1))}else i===ja?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,ah(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===En||r===sa||r===ja&&4&t.type)this.addMatch(t.index,-2);else{const s=ah(t,e,r,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function S8(n,e){const t=n.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1];return null}function x8(n,e,t,i){return-1===t?function C8(n,e){return 11&n.type?ji(n,e):4&n.type?Nb(n,e):null}(e,n):-2===t?function M8(n,e,t){return t===En?ji(e,n):t===ja?Nb(e,n):t===sa?g2(e,n):void 0}(n,e,i):vl(n,n[Ve],t,e)}function w2(n,e,t,i){const r=e[Ts].queries[i];if(null===r.matches){const s=n.data,o=t.matches,a=[];for(let l=0;l<o.length;l+=2){const c=o[l];a.push(c<0?null:x8(e,s[c],o[l+1],t.metadata.read))}r.matches=a}return r.matches}function cA(n,e,t,i){const r=n.queries.getByIndex(t),s=r.matches;if(null!==s){const o=w2(n,e,r,t);for(let a=0;a<s.length;a+=2){const l=s[a];if(l>0)i.push(o[a/2]);else{const c=s[a+1],h=e[-l];for(let d=Bi;d<h.length;d++){const p=h[d];p[Sc]===p[Wn]&&cA(p[Ve],p,c,i)}if(null!==h[qo]){const d=h[qo];for(let p=0;p<d.length;p++){const m=d[p];cA(m[Ve],m,c,i)}}}}}return i}function wp(n){const e=ge(),t=Zt(),i=qs();Fg(i+1);const r=S2(t,i);if(n.dirty&&function H0(n){return 4==(4&n[Nt])}(e)===(2==(2&r.metadata.flags))){if(null===r.matches)n.reset([]);else{const s=r.crossesNgTemplate?cA(t,e,i,[]):w2(t,e,r,i);n.reset(s,us),n.notifyOnChanges()}return!0}return!1}function uA(n,e,t){const i=Zt();i.firstCreatePass&&(E2(i,new v2(n,e,t),-1),2==(2&e)&&(i.staticViewQueries=!0)),b2(i,ge(),e)}function Ob(n,e,t,i){const r=Zt();if(r.firstCreatePass){const s=zi();E2(r,new v2(e,t,i),s.index),function A8(n,e){const t=n.contentQueries||(n.contentQueries=[]);e!==(t.length?t[t.length-1]:-1)&&t.push(n.queries.length-1,e)}(r,n),2==(2&t)&&(r.staticContentQueries=!0)}b2(r,ge(),t)}function bp(){return function T8(n,e){return n[Ts].queries[e].queryList}(ge(),qs())}function b2(n,e,t){const i=new iA(4==(4&t));(function M4(n,e,t,i){const r=XN(e);r.push(t),n.firstCreatePass&&YN(n).push(i,r.length-1)})(n,e,i,i.destroy),null===e[Ts]&&(e[Ts]=new oA),e[Ts].queries.push(new sA(i))}function E2(n,e,t){null===n.queries&&(n.queries=new aA),n.queries.track(new lA(e,t))}function S2(n,e){return n.queries.getByIndex(e)}const gA=new Ye("Application Initializer");let _A=(()=>{class n{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,i)=>{this.resolve=t,this.reject=i}),this.appInits=ze(gA,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const t=[];for(const r of this.appInits){const s=r();if(ey(s))t.push(s);else if(TL(s)){const o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});t.push(o)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),V2=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();const Nl=new Ye("LocaleId",{providedIn:"root",factory:()=>ze(Nl,$t.Optional|$t.SkipSelf)||function K8(){return typeof $localize<"u"&&$localize.locale||vp}()});let kb=(()=>{class n{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Pr(!1)}add(){this.hasPendingTasks.next(!0);const t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class Q8{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let H2=(()=>{class n{compileModuleSync(t){return new eA(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const i=this.compileModuleSync(t),s=Dl(lr(t).declarations).reduce((o,a)=>{const l=Yt(a);return l&&o.push(new Y_(l)),o},[]);return new Q8(i,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const j2=new Ye(""),Bb=new Ye("");let EA,wA=(()=>{class n{constructor(t,i,r){this._ngZone=t,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,EA||(function v6(n){EA=n}(r),r.addToWindow(i)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Mn.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,i,r){return[]}static#e=this.\u0275fac=function(i){return new(i||n)(Oe(Mn),Oe(bA),Oe(Bb))};static#t=this.\u0275prov=Je({token:n,factory:n.\u0275fac})}return n})(),bA=(()=>{class n{constructor(){this._applications=new Map}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return EA?.findTestabilityInTree(this,t,i)??null}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})(),eu=null;const $2=new Ye("AllowMultipleToken"),SA=new Ye("PlatformDestroyListeners"),CA=new Ye("appBootstrapListener");class X2{constructor(e,t){this.name=e,this.token=t}}function K2(n,e,t=[]){const i=`Platform: ${e}`,r=new Ye(i);return(s=[])=>{let o=xA();if(!o||o.injector.get($2,!1)){const a=[...t,...s,{provide:r,useValue:!0}];n?n(a):function E6(n){if(eu&&!eu.get($2,!1))throw new ae(400,!1);(function q2(){!function Ag(n){Tg=n}(()=>{throw new ae(600,!1)})})(),eu=n;const e=n.get(J2);(function Y2(n){n.get(ab,null)?.forEach(t=>t())})(n)}(function Z2(n=[],e){return Zs.create({name:e,providers:[{provide:N_,useValue:"platform"},{provide:SA,useValue:new Set([()=>eu=null])},...n]})}(a,i))}return function C6(n){const e=xA();if(!e)throw new ae(401,!1);return e}()}}function xA(){return eu?.get(J2)??null}let J2=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,i){const r=function x6(n="zone.js",e){return"noop"===n?new l4:"zone.js"===n?new Mn(e):n}(i?.ngZone,function Q2(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return r.run(()=>{const s=function kj(n,e,t){return new QT(n,e,t)}(t.moduleType,this.injector,function rF(n){return[{provide:Mn,useFactory:n},{provide:yh,multi:!0,useFactory:()=>{const e=ze(T6,{optional:!0});return()=>e.initialize()}},{provide:iF,useFactory:M6},{provide:EN,useFactory:SN}]}(()=>r)),o=s.injector.get(Al,null);return r.runOutsideAngular(()=>{const a=r.onError.subscribe({next:l=>{o.handleError(l)}});s.onDestroy(()=>{Vb(this._modules,s),a.unsubscribe()})}),function eF(n,e,t){try{const i=t();return ey(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}(o,r,()=>{const a=s.injector.get(_A);return a.runInitializers(),a.donePromise.then(()=>(function CO(n){Ss(n,"Expected localeId to be defined"),"string"==typeof n&&(SO=n.toLowerCase().replace(/_/g,"-"))}(s.injector.get(Nl,vp)||vp),this._moduleDoBootstrap(s),s))})})}bootstrapModule(t,i=[]){const r=tF({},i);return function w6(n,e,t){const i=new eA(t);return Promise.resolve(i)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(t){const i=t.injector.get(Ah);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new ae(-403,!1);t.instance.ngDoBootstrap(i)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new ae(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const t=this._injector.get(SA,null);t&&(t.forEach(i=>i()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static#e=this.\u0275fac=function(i){return new(i||n)(Oe(Zs))};static#t=this.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();function tF(n,e){return Array.isArray(e)?e.reduce(tF,n):{...n,...e}}let Ah=(()=>{class n{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=ze(iF),this.zoneIsStable=ze(EN),this.componentTypes=[],this.components=[],this.isStable=ze(kb).hasPendingTasks.pipe(Es(t=>t?mt(!1):this.zoneIsStable),function hx(n,e=Bo){return n=n??h0,zn((t,i)=>{let r,s=!0;t.subscribe(Jn(i,o=>{const a=e(o);(s||!n(r,a))&&(s=!1,r=a,i.next(o))}))})}(),ag()),this._injector=ze(cs)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(t,i){const r=t instanceof He;if(!this._injector.get(_A).done)throw!r&&function ul(n){const e=Yt(n)||Gn(n)||Ui(n);return null!==e&&e.standalone}(t),new ae(405,!1);let o;o=r?t:this._injector.get(Ht).resolveComponentFactory(t),this.componentTypes.push(o.componentType);const a=function b6(n){return n.isBoundToModule}(o)?void 0:this._injector.get(Th),c=o.create(Zs.NULL,[],i||o.selector,a),h=c.location.nativeElement,d=c.injector.get(j2,null);return d?.registerApplication(h),c.onDestroy(()=>{this.detachView(c.hostView),Vb(this.components,c),d?.unregisterApplication(h)}),this._loadComponent(c),c}tick(){if(this._runningTick)throw new ae(101,!1);try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this.internalErrorHandler(t)}finally{this._runningTick=!1}}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;Vb(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);const i=this._injector.get(CA,[]);i.push(...this._bootstrapListeners),i.forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>Vb(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new ae(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Vb(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const iF=new Ye("",{providedIn:"root",factory:()=>ze(Al).handleError.bind(void 0)});function M6(){const n=ze(Mn),e=ze(Al);return t=>n.runOutsideAngular(()=>e.handleError(t))}let T6=(()=>{class n{constructor(){this.zone=ze(Mn),this.applicationRef=ze(Ah)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();let fy=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=D6}return n})();function D6(n){return function I6(n,e,t){if(Ut(n)&&!t){const i=Or(n.index,e);return new X_(i,i)}return 47&n.type?new X_(e[ui],e):null}(zi(),ge(),16==(16&n))}class lF{constructor(){}supports(e){return bb(e)}create(e){return new F6(e)}}const O6=(n,e)=>e;class F6{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||O6}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,s=null;for(;t||i;){const o=!i||t&&t.currentIndex<uF(i,r,s)?t:i,a=uF(o,r,s),l=o.currentIndex;if(o===i)r--,i=i._nextRemoved;else if(t=t._next,null==o.previousIndex)r++;else{s||(s=[]);const c=a-r,h=l-r;if(c!=h){for(let p=0;p<c;p++){const m=p<s.length?s[p]:s[p]=0,g=m+p;h<=g&&g<c&&(s[p]=m+1)}s[o.previousIndex]=h-c}}a!==l&&e(o,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!bb(e))throw new ae(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let r,s,o,t=this._itHead,i=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,o,a),i=!0),t=t._next}else r=0,function y5(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{const t=n[Symbol.iterator]();let i;for(;!(i=t.next()).done;)e(i.value)}}(e,a=>{o=this._trackByFn(r,a),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,a,o,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,o,r),i=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,r)):e=this._addAfter(new k6(t,i),s,r),e}_verifyReinsertion(e,t,i,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?e=this._reinsertAfter(s,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,s=e._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){const r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new cF),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,i=e._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new cF),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class k6{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class U6{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){const t=e._prevDup,i=e._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}class cF{constructor(){this.map=new Map}put(e){const t=e.trackById;let i=this.map.get(t);i||(i=new U6,this.map.set(t,i)),i.add(e)}get(e,t){const r=this.map.get(e);return r?r.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function uF(n,e,t){const i=n.previousIndex;if(null===i)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}class hF{constructor(){}supports(e){return e instanceof Map||RT(e)}create(){return new B6}}class B6{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||RT(e)))throw new ae(900,!1)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(i,r)=>{if(t&&t.key===r)this._maybeAddToChanges(t,i),this._appendAfter=t,t=t._next;else{const s=this._getOrCreateRecordForKey(r,i);t=this._insertBeforeOrAppend(t,s)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let i=t;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const i=e._prev;return t._next=e,t._prev=i,e._prev=t,i&&(i._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const r=this._records.get(e);this._maybeAddToChanges(r,t);const s=r._prev,o=r._next;return s&&(s._next=o),o&&(o._prev=s),r._next=null,r._prev=null,r}const i=new V6(e);return this._records.set(e,i),i.currentValue=t,this._addToAdditions(i),i}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(i=>t(e[i],i))}}class V6{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function dF(){return new Gb([new lF])}let Gb=(()=>{class n{static#e=this.\u0275prov=Je({token:n,providedIn:"root",factory:dF});constructor(t){this.factories=t}static create(t,i){if(null!=i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||dF()),deps:[[n,new Tf,new Mf]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(null!=i)return i;throw new ae(901,!1)}}return n})();function fF(){return new py([new hF])}let py=(()=>{class n{static#e=this.\u0275prov=Je({token:n,providedIn:"root",factory:fF});constructor(t){this.factories=t}static create(t,i){if(i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||fF()),deps:[[n,new Tf,new Mf]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(i)return i;throw new ae(901,!1)}}return n})();const G6=K2(null,"core",[]);let W6=(()=>{class n{constructor(t){}static#e=this.\u0275fac=function(i){return new(i||n)(Oe(Ah))};static#t=this.\u0275mod=ki({type:n});static#n=this.\u0275inj=Ti({})}return n})();let RA=null;function tu(){return RA}class r${}const Vr=new Ye("DocumentToken");let PA=(()=>{class n{historyGo(t){throw new Error("Not implemented")}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Je({token:n,factory:function(){return ze(o$)},providedIn:"platform"})}return n})();const s$=new Ye("Location Initialized");let o$=(()=>{class n extends PA{constructor(){super(),this._doc=ze(Vr),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return tu().getBaseHref(this._doc)}onPopState(t){const i=tu().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=tu().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,r){this._history.pushState(t,i,r)}replaceState(t,i,r){this._history.replaceState(t,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Je({token:n,factory:function(){return new n},providedIn:"platform"})}return n})();function NA(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function EF(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function Ll(n){return n&&"?"!==n[0]?"?"+n:n}let Ih=(()=>{class n{historyGo(t){throw new Error("Not implemented")}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Je({token:n,factory:function(){return ze(CF)},providedIn:"root"})}return n})();const SF=new Ye("appBaseHref");let CF=(()=>{class n extends Ih{constructor(t,i){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??ze(Vr).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return NA(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+Ll(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,s){const o=this.prepareExternalUrl(r+Ll(s));this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){const o=this.prepareExternalUrl(r+Ll(s));this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static#e=this.\u0275fac=function(i){return new(i||n)(Oe(PA),Oe(SF,8))};static#t=this.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),a$=(()=>{class n extends Ih{constructor(t,i){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(t){const i=NA(this._baseHref,t);return i.length>0?"#"+i:i}pushState(t,i,r,s){let o=this.prepareExternalUrl(r+Ll(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){let o=this.prepareExternalUrl(r+Ll(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static#e=this.\u0275fac=function(i){return new(i||n)(Oe(PA),Oe(SF,8))};static#t=this.\u0275prov=Je({token:n,factory:n.\u0275fac})}return n})(),LA=(()=>{class n{constructor(t){this._subject=new qn,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const i=this._locationStrategy.getBaseHref();this._basePath=function u$(n){if(new RegExp("^(https?:)?//").test(n)){const[,t]=n.split(/\/\/[^\/]+/);return t}return n}(EF(xF(i))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+Ll(i))}normalize(t){return n.stripTrailingSlash(function c$(n,e){if(!n||!e.startsWith(n))return e;const t=e.substring(n.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,xF(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Ll(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Ll(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{const i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i,complete:r})}static#e=this.normalizeQueryParams=Ll;static#t=this.joinWithSlash=NA;static#n=this.stripTrailingSlash=EF;static#i=this.\u0275fac=function(i){return new(i||n)(Oe(Ih))};static#r=this.\u0275prov=Je({token:n,factory:function(){return function l$(){return new LA(Oe(Ih))}()},providedIn:"root"})}return n})();function xF(n){return n.replace(/\/index.html$/,"")}function LF(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,s]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}const WA=/\s+/,OF=[];let tE=(()=>{class n{constructor(t,i,r,s){this._iterableDiffers=t,this._keyValueDiffers=i,this._ngEl=r,this._renderer=s,this.initialClasses=OF,this.stateMap=new Map}set klass(t){this.initialClasses=null!=t?t.trim().split(WA):OF}set ngClass(t){this.rawClass="string"==typeof t?t.trim().split(WA):t}ngDoCheck(){for(const i of this.initialClasses)this._updateState(i,!0);const t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(const i of t)this._updateState(i,!0);else if(null!=t)for(const i of Object.keys(t))this._updateState(i,!!t[i]);this._applyStateDiff()}_updateState(t,i){const r=this.stateMap.get(t);void 0!==r?(r.enabled!==i&&(r.changed=!0,r.enabled=i),r.touched=!0):this.stateMap.set(t,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(const t of this.stateMap){const i=t[0],r=t[1];r.changed?(this._toggleClass(i,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),r.touched=!1}}_toggleClass(t,i){(t=t.trim()).length>0&&t.split(WA).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}static#e=this.\u0275fac=function(i){return new(i||n)(ce(Gb),ce(py),ce(En),ce(yi))};static#t=this.\u0275dir=pt({type:n,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0})}return n})();class Y${constructor(e,t,i,r){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let nE=(()=>{class n{set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const i=this._viewContainer;t.forEachOperation((r,s,o)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new Y$(r.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)i.remove(null===s?void 0:s);else if(null!==s){const a=i.get(s);i.move(a,o),kF(a,r)}});for(let r=0,s=i.length;r<s;r++){const a=i.get(r).context;a.index=r,a.count=s,a.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{kF(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(t,i){return!0}static#e=this.\u0275fac=function(i){return new(i||n)(ce(sa),ce(ja),ce(Gb))};static#t=this.\u0275dir=pt({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}return n})();function kF(n,e){n.context.$implicit=e.item}let _y=(()=>{class n{constructor(t,i){this._viewContainer=t,this._context=new K$,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){UF("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){UF("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}static#e=this.\u0275fac=function(i){return new(i||n)(ce(sa),ce(ja))};static#t=this.\u0275dir=pt({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}return n})();class K${constructor(){this.$implicit=null,this.ngIf=null}}function UF(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${Mi(e)}'.`)}let qA=(()=>{class n{constructor(t,i,r){this._ngEl=t,this._differs=i,this._renderer=r,this._ngStyle=null,this._differ=null}set ngStyle(t){this._ngStyle=t,!this._differ&&t&&(this._differ=this._differs.find(t).create())}ngDoCheck(){if(this._differ){const t=this._differ.diff(this._ngStyle);t&&this._applyChanges(t)}}_setStyle(t,i){const[r,s]=t.split("."),o=-1===r.indexOf("-")?void 0:Fa.DashCase;null!=i?this._renderer.setStyle(this._ngEl.nativeElement,r,s?`${i}${s}`:i,o):this._renderer.removeStyle(this._ngEl.nativeElement,r,o)}_applyChanges(t){t.forEachRemovedItem(i=>this._setStyle(i.key,null)),t.forEachAddedItem(i=>this._setStyle(i.key,i.currentValue)),t.forEachChangedItem(i=>this._setStyle(i.key,i.currentValue))}static#e=this.\u0275fac=function(i){return new(i||n)(ce(En),ce(py),ce(yi))};static#t=this.\u0275dir=pt({type:n,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0})}return n})(),XA=(()=>{class n{constructor(t){this._viewContainerRef=t,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(t){if(t.ngTemplateOutlet||t.ngTemplateOutletInjector){const i=this._viewContainerRef;if(this._viewRef&&i.remove(i.indexOf(this._viewRef)),this.ngTemplateOutlet){const{ngTemplateOutlet:r,ngTemplateOutletContext:s,ngTemplateOutletInjector:o}=this;this._viewRef=i.createEmbeddedView(r,s,o?{injector:o}:void 0)}else this._viewRef=null}else this._viewRef&&t.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}static#e=this.\u0275fac=function(i){return new(i||n)(ce(sa))};static#t=this.\u0275dir=pt({type:n,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[Hi]})}return n})(),Mp=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=ki({type:n});static#n=this.\u0275inj=Ti({})}return n})();const HF="browser";function zF(n){return"server"===n}let M9=(()=>{class n{static#e=this.\u0275prov=Je({token:n,providedIn:"root",factory:()=>new T9(Oe(Vr),window)})}return n})();class T9{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function A9(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&"function"==typeof n.body.attachShadow){const i=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const s=r.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}r=i.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.supportsScrolling()&&(this.window.history.scrollRestoration=e)}scrollToElement(e){const t=e.getBoundingClientRect(),i=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(i-s[0],r-s[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}class GF{}class Z9 extends r${constructor(){super(...arguments),this.supportsDOMEvents=!0}}class QA extends Z9{static makeCurrent(){!function i$(n){RA||(RA=n)}(new QA)}onAndCancel(e,t,i){return e.addEventListener(t,i),()=>{e.removeEventListener(t,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function J9(){return vy=vy||document.querySelector("base"),vy?vy.getAttribute("href"):null}();return null==t?null:function Q9(n){sE=sE||document.createElement("a"),sE.setAttribute("href",n);const e=sE.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){vy=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return LF(document.cookie,e)}}let sE,vy=null,t7=(()=>{class n{build(){return new XMLHttpRequest}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Je({token:n,factory:n.\u0275fac})}return n})();const e1=new Ye("EventManagerPlugins");let XF=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>{r.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(s=>s.supports(t)),!i)throw new ae(5101,!1);return this._eventNameToPlugin.set(t,i),i}static#e=this.\u0275fac=function(i){return new(i||n)(Oe(e1),Oe(Mn))};static#t=this.\u0275prov=Je({token:n,factory:n.\u0275fac})}return n})();class YF{constructor(e){this._doc=e}}const t1="ng-app-id";let KF=(()=>{class n{constructor(t,i,r,s={}){this.doc=t,this.appId=i,this.nonce=r,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=zF(s),this.resetHostNodes()}addStyles(t){for(const i of t)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(t){for(const i of t)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){const t=this.styleNodesInDOM;t&&(t.forEach(i=>i.remove()),t.clear());for(const i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const i of this.getAllStyles())this.addStyleToHost(t,i)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(const i of this.hostNodes)this.addStyleToHost(i,t)}onStyleRemoved(t){const i=this.styleRef;i.get(t)?.elements?.forEach(r=>r.remove()),i.delete(t)}collectServerRenderedStyles(){const t=this.doc.head?.querySelectorAll(`style[${t1}="${this.appId}"]`);if(t?.length){const i=new Map;return t.forEach(r=>{null!=r.textContent&&i.set(r.textContent,r)}),i}return null}changeUsageCount(t,i){const r=this.styleRef;if(r.has(t)){const s=r.get(t);return s.usage+=i,s.usage}return r.set(t,{usage:i,elements:[]}),i}getStyleElement(t,i){const r=this.styleNodesInDOM,s=r?.get(i);if(s?.parentNode===t)return r.delete(i),s.removeAttribute(t1),s;{const o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=i,this.platformIsServer&&o.setAttribute(t1,this.appId),o}}addStyleToHost(t,i){const r=this.getStyleElement(t,i);t.appendChild(r);const s=this.styleRef,o=s.get(i)?.elements;o?o.push(r):s.set(i,{elements:[r],usage:1})}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}static#e=this.\u0275fac=function(i){return new(i||n)(Oe(Vr),Oe(ep),Oe(cb,8),Oe(Va))};static#t=this.\u0275prov=Je({token:n,factory:n.\u0275fac})}return n})();const n1={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},i1=/%COMP%/g,s7=new Ye("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function JF(n,e){return e.map(t=>t.replace(i1,n))}let r1=(()=>{class n{constructor(t,i,r,s,o,a,l,c=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=a,this.ngZone=l,this.nonce=c,this.rendererByCompId=new Map,this.platformIsServer=zF(a),this.defaultRenderer=new s1(t,o,l,this.platformIsServer)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===xs.ShadowDom&&(i={...i,encapsulation:xs.Emulated});const r=this.getOrCreateRenderer(t,i);return r instanceof ek?r.applyToHost(t):r instanceof o1&&r.applyStyles(),r}getOrCreateRenderer(t,i){const r=this.rendererByCompId;let s=r.get(i.id);if(!s){const o=this.doc,a=this.ngZone,l=this.eventManager,c=this.sharedStylesHost,h=this.removeStylesOnCompDestroy,d=this.platformIsServer;switch(i.encapsulation){case xs.Emulated:s=new ek(l,c,i,this.appId,h,o,a,d);break;case xs.ShadowDom:return new c7(l,c,t,i,o,a,this.nonce,d);default:s=new o1(l,c,i,h,o,a,d)}r.set(i.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static#e=this.\u0275fac=function(i){return new(i||n)(Oe(XF),Oe(KF),Oe(ep),Oe(s7),Oe(Vr),Oe(Va),Oe(Mn),Oe(cb))};static#t=this.\u0275prov=Je({token:n,factory:n.\u0275fac})}return n})();class s1{constructor(e,t,i,r){this.eventManager=e,this.doc=t,this.ngZone=i,this.platformIsServer=r,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(n1[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(QF(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(QF(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?this.doc.querySelector(e):e;if(!i)throw new ae(-5104,!1);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const s=n1[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=n1[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(Fa.DashCase|Fa.Important)?e.style.setProperty(t,i,r&Fa.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&Fa.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e[t]=i}setValue(e,t){e.nodeValue=t}listen(e,t,i){if("string"==typeof e&&!(e=tu().getGlobalEventTarget(this.doc,e)))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(i))}decoratePreventDefault(e){return t=>{if("__ngUnwrap__"===t)return e;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))&&t.preventDefault()}}}function QF(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class c7 extends s1{constructor(e,t,i,r,s,o,a,l){super(e,s,o,l),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const c=JF(r.id,r.styles);for(const h of c){const d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=h,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class o1 extends s1{constructor(e,t,i,r,s,o,a,l){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r,this.styles=l?JF(l,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class ek extends o1{constructor(e,t,i,r,s,o,a,l){const c=r+"-"+i.id;super(e,t,i,s,o,a,l,c),this.contentAttr=function o7(n){return"_ngcontent-%COMP%".replace(i1,n)}(c),this.hostAttr=function a7(n){return"_nghost-%COMP%".replace(i1,n)}(c)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}let u7=(()=>{class n extends YF{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}static#e=this.\u0275fac=function(i){return new(i||n)(Oe(Vr))};static#t=this.\u0275prov=Je({token:n,factory:n.\u0275fac})}return n})();const tk=["alt","control","meta","shift"],h7={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},d7={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let f7=(()=>{class n extends YF{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,r){const s=n.parseEventName(i),o=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>tu().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=n._normalizeKey(i.pop());let o="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),o="code."),tk.forEach(c=>{const h=i.indexOf(c);h>-1&&(i.splice(h,1),o+=c+".")}),o+=s,0!=i.length||0===s.length)return null;const l={};return l.domEventName=r,l.fullKey=o,l}static matchEventFullKeyCode(t,i){let r=h7[t.key]||t.key,s="";return i.indexOf("code.")>-1&&(r=t.code,s="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),tk.forEach(o=>{o!==r&&(0,d7[o])(t)&&(s+=o+".")}),s+=r,s===i)}static eventCallback(t,i,r){return s=>{n.matchEventFullKeyCode(s,t)&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}static#e=this.\u0275fac=function(i){return new(i||n)(Oe(Vr))};static#t=this.\u0275prov=Je({token:n,factory:n.\u0275fac})}return n})();const ik=[{provide:Va,useValue:HF},{provide:ab,useValue:function p7(){QA.makeCurrent()},multi:!0},{provide:Vr,useFactory:function g7(){return function Gw(n){kr=n}(document),document},deps:[]}],_7=K2(G6,"browser",ik),y7=new Ye(""),rk=[{provide:Bb,useClass:class e7{addToWindow(e){on.getAngularTestability=(i,r=!0)=>{const s=e.findTestabilityInTree(i,r);if(null==s)throw new ae(5103,!1);return s},on.getAllAngularTestabilities=()=>e.getAllTestabilities(),on.getAllAngularRootElements=()=>e.getAllRootElements(),on.frameworkStabilizers||(on.frameworkStabilizers=[]),on.frameworkStabilizers.push(i=>{const r=on.getAllAngularTestabilities();let s=r.length,o=!1;const a=function(l){o=o||l,s--,0==s&&i(o)};r.forEach(l=>{l.whenStable(a)})})}findTestabilityInTree(e,t,i){return null==t?null:e.getTestability(t)??(i?tu().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:j2,useClass:wA,deps:[Mn,bA,Bb]},{provide:wA,useClass:wA,deps:[Mn,bA,Bb]}],sk=[{provide:N_,useValue:"root"},{provide:Al,useFactory:function m7(){return new Al},deps:[]},{provide:e1,useClass:u7,multi:!0,deps:[Vr,Mn,Va]},{provide:e1,useClass:f7,multi:!0,deps:[Vr]},r1,KF,XF,{provide:kn,useExisting:r1},{provide:GF,useClass:t7,deps:[]},[]];let ok=(()=>{class n{constructor(t){}static withServerTransition(t){return{ngModule:n,providers:[{provide:ep,useValue:t.appId}]}}static#e=this.\u0275fac=function(i){return new(i||n)(Oe(y7,12))};static#t=this.\u0275mod=ki({type:n});static#n=this.\u0275inj=Ti({providers:[...sk,...rk],imports:[Mp,W6]})}return n})(),a1=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static#e=this.\u0275fac=function(i){return new(i||n)(Oe(Vr))};static#t=this.\u0275prov=Je({token:n,factory:function(i){let r=null;return r=i?new i:function w7(){return new a1(Oe(Vr))}(),r},providedIn:"root"})}return n})();typeof window<"u"&&window;class uk{}class x7{}const kl="*";function hk(n,e=null){return{type:2,steps:n,options:e}}function dk(n){return{type:6,styles:n,offset:null}}class wy{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class fk{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,i=0,r=0;const s=this.players.length;0==s?queueMicrotask(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++t==s&&this._onFinish()}),o.onDestroy(()=>{++i==s&&this._onDestroy()}),o.onStart(()=>{++r==s&&this._onStart()})}),this.totalTime=this.players.reduce((o,a)=>Math.max(o,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,t/i.totalTime):1;i.setPosition(r)})}getPosition(){const e=this.players.reduce((t,i)=>null===t||i.totalTime>t.totalTime?i:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}function pk(n){return new ae(3e3,!1)}function iu(n){switch(n.length){case 0:return new wy;case 1:return n[0];default:return new fk(n)}}function mk(n,e,t=new Map,i=new Map){const r=[],s=[];let o=-1,a=null;if(e.forEach(l=>{const c=l.get("offset"),h=c==o,d=h&&a||new Map;l.forEach((p,m)=>{let g=m,v=p;if("offset"!==m)switch(g=n.normalizePropertyName(g,r),v){case"!":v=t.get(m);break;case kl:v=i.get(m);break;default:v=n.normalizeStyleValue(m,g,v,r)}d.set(g,v)}),h||s.push(d),a=d,o=c}),r.length)throw function X7(n){return new ae(3502,!1)}();return s}function u1(n,e,t,i){switch(e){case"start":n.onStart(()=>i(t&&h1(t,"start",n)));break;case"done":n.onDone(()=>i(t&&h1(t,"done",n)));break;case"destroy":n.onDestroy(()=>i(t&&h1(t,"destroy",n)))}}function h1(n,e,t){const s=d1(n.element,n.triggerName,n.fromState,n.toState,e||n.phaseName,t.totalTime??n.totalTime,!!t.disabled),o=n._data;return null!=o&&(s._data=o),s}function d1(n,e,t,i,r="",s=0,o){return{element:n,triggerName:e,fromState:t,toState:i,phaseName:r,totalTime:s,disabled:!!o}}function eo(n,e,t){let i=n.get(e);return i||n.set(e,i=t),i}function gk(n){const e=n.indexOf(":");return[n.substring(1,e),n.slice(e+1)]}const oq=(()=>typeof document>"u"?null:document.documentElement)();function f1(n){const e=n.parentNode||n.host||null;return e===oq?null:e}let Rh=null,_k=!1;function yk(n,e){for(;e;){if(e===n)return!0;e=f1(e)}return!1}function vk(n,e,t){if(t)return Array.from(n.querySelectorAll(e));const i=n.querySelector(e);return i?[i]:[]}let wk=(()=>{class n{validateStyleProperty(t){return function lq(n){Rh||(Rh=function cq(){return typeof document<"u"?document.body:null}()||{},_k=!!Rh.style&&"WebkitAppearance"in Rh.style);let e=!0;return Rh.style&&!function aq(n){return"ebkit"==n.substring(1,6)}(n)&&(e=n in Rh.style,!e&&_k&&(e="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in Rh.style)),e}(t)}matchesElement(t,i){return!1}containsElement(t,i){return yk(t,i)}getParentElement(t){return f1(t)}query(t,i,r){return vk(t,i,r)}computeStyle(t,i,r){return r||""}animate(t,i,r,s,o,a=[],l){return new wy(r,s)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Je({token:n,factory:n.\u0275fac})}return n})(),p1=(()=>{class n{static#e=this.NOOP=new wk}return n})();const uq=1e3,m1="ng-enter",oE="ng-leave",aE="ng-trigger",lE=".ng-trigger",Ek="ng-animating",g1=".ng-animating";function Ul(n){if("number"==typeof n)return n;const e=n.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:_1(parseFloat(e[1]),e[2])}function _1(n,e){return"s"===e?n*uq:n}function cE(n,e,t){return n.hasOwnProperty("duration")?n:function dq(n,e,t){let r,s=0,o="";if("string"==typeof n){const a=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return e.push(pk()),{duration:0,delay:0,easing:""};r=_1(parseFloat(a[1]),a[2]);const l=a[3];null!=l&&(s=_1(parseFloat(l),a[4]));const c=a[5];c&&(o=c)}else r=n;if(!t){let a=!1,l=e.length;r<0&&(e.push(function M7(){return new ae(3100,!1)}()),a=!0),s<0&&(e.push(function T7(){return new ae(3101,!1)}()),a=!0),a&&e.splice(l,0,pk())}return{duration:r,delay:s,easing:o}}(n,e,t)}function by(n,e={}){return Object.keys(n).forEach(t=>{e[t]=n[t]}),e}function Sk(n){const e=new Map;return Object.keys(n).forEach(t=>{e.set(t,n[t])}),e}function ru(n,e=new Map,t){if(t)for(let[i,r]of t)e.set(i,r);for(let[i,r]of n)e.set(i,r);return e}function $a(n,e,t){e.forEach((i,r)=>{const s=v1(r);t&&!t.has(r)&&t.set(r,n.style[s]),n.style[s]=i})}function Ph(n,e){e.forEach((t,i)=>{const r=v1(i);n.style[r]=""})}function Ey(n){return Array.isArray(n)?1==n.length?n[0]:hk(n):n}const y1=new RegExp("{{\\s*(.+?)\\s*}}","g");function xk(n){let e=[];if("string"==typeof n){let t;for(;t=y1.exec(n);)e.push(t[1]);y1.lastIndex=0}return e}function Sy(n,e,t){const i=n.toString(),r=i.replace(y1,(s,o)=>{let a=e[o];return null==a&&(t.push(function D7(n){return new ae(3003,!1)}()),a=""),a.toString()});return r==i?n:r}function uE(n){const e=[];let t=n.next();for(;!t.done;)e.push(t.value),t=n.next();return e}const mq=/-+([a-z0-9])/g;function v1(n){return n.replace(mq,(...e)=>e[1].toUpperCase())}function to(n,e,t){switch(e.type){case 7:return n.visitTrigger(e,t);case 0:return n.visitState(e,t);case 1:return n.visitTransition(e,t);case 2:return n.visitSequence(e,t);case 3:return n.visitGroup(e,t);case 4:return n.visitAnimate(e,t);case 5:return n.visitKeyframes(e,t);case 6:return n.visitStyle(e,t);case 8:return n.visitReference(e,t);case 9:return n.visitAnimateChild(e,t);case 10:return n.visitAnimateRef(e,t);case 11:return n.visitQuery(e,t);case 12:return n.visitStagger(e,t);default:throw function I7(n){return new ae(3004,!1)}()}}function Mk(n,e){return window.getComputedStyle(n)[e]}const hE="*";function yq(n,e){const t=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(i=>function vq(n,e,t){if(":"==n[0]){const l=function wq(n,e){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,i)=>parseFloat(i)>parseFloat(t);case":decrement":return(t,i)=>parseFloat(i)<parseFloat(t);default:return e.push(function W7(n){return new ae(3016,!1)}()),"* => *"}}(n,t);if("function"==typeof l)return void e.push(l);n=l}const i=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return t.push(function G7(n){return new ae(3015,!1)}()),e;const r=i[1],s=i[2],o=i[3];e.push(Tk(r,o));"<"==s[0]&&!(r==hE&&o==hE)&&e.push(Tk(o,r))}(i,t,e)):t.push(n),t}const dE=new Set(["true","1"]),fE=new Set(["false","0"]);function Tk(n,e){const t=dE.has(n)||fE.has(n),i=dE.has(e)||fE.has(e);return(r,s)=>{let o=n==hE||n==r,a=e==hE||e==s;return!o&&t&&"boolean"==typeof r&&(o=r?dE.has(n):fE.has(n)),!a&&i&&"boolean"==typeof s&&(a=s?dE.has(e):fE.has(e)),o&&a}}const bq=new RegExp("s*:selfs*,?","g");function w1(n,e,t,i){return new Eq(n).build(e,t,i)}class Eq{constructor(e){this._driver=e}build(e,t,i){const r=new xq(t);return this._resetContextStyleTimingState(r),to(this,Ey(e),r)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles=new Map,e.collectedStyles.set("",new Map),e.currentTime=0}visitTrigger(e,t){let i=t.queryCount=0,r=t.depCount=0;const s=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push(function P7(){return new ae(3006,!1)}()),e.definitions.forEach(a=>{if(this._resetContextStyleTimingState(t),0==a.type){const l=a,c=l.name;c.toString().split(/\s*,\s*/).forEach(h=>{l.name=h,s.push(this.visitState(l,t))}),l.name=c}else if(1==a.type){const l=this.visitTransition(a,t);i+=l.queryCount,r+=l.depCount,o.push(l)}else t.errors.push(function N7(){return new ae(3007,!1)}())}),{type:7,name:e.name,states:s,transitions:o,queryCount:i,depCount:r,options:null}}visitState(e,t){const i=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(i.containsDynamicStyles){const s=new Set,o=r||{};i.styles.forEach(a=>{a instanceof Map&&a.forEach(l=>{xk(l).forEach(c=>{o.hasOwnProperty(c)||s.add(c)})})}),s.size&&(uE(s.values()),t.errors.push(function L7(n,e){return new ae(3008,!1)}()))}return{type:0,name:e.name,style:i,options:r?{params:r}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const i=to(this,Ey(e.animation),t);return{type:1,matchers:yq(e.expr,t.errors),animation:i,queryCount:t.queryCount,depCount:t.depCount,options:Nh(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(i=>to(this,i,t)),options:Nh(e.options)}}visitGroup(e,t){const i=t.currentTime;let r=0;const s=e.steps.map(o=>{t.currentTime=i;const a=to(this,o,t);return r=Math.max(r,t.currentTime),a});return t.currentTime=r,{type:3,steps:s,options:Nh(e.options)}}visitAnimate(e,t){const i=function Tq(n,e){if(n.hasOwnProperty("duration"))return n;if("number"==typeof n)return b1(cE(n,e).duration,0,"");const t=n;if(t.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=b1(0,0,"");return s.dynamic=!0,s.strValue=t,s}const r=cE(t,e);return b1(r.duration,r.delay,r.easing)}(e.timings,t.errors);t.currentAnimateTimings=i;let r,s=e.styles?e.styles:dk({});if(5==s.type)r=this.visitKeyframes(s,t);else{let o=e.styles,a=!1;if(!o){a=!0;const c={};i.easing&&(c.easing=i.easing),o=dk(c)}t.currentTime+=i.duration+i.delay;const l=this.visitStyle(o,t);l.isEmptyStep=a,r=l}return t.currentAnimateTimings=null,{type:4,timings:i,style:r,options:null}}visitStyle(e,t){const i=this._makeStyleAst(e,t);return this._validateStyleAst(i,t),i}_makeStyleAst(e,t){const i=[],r=Array.isArray(e.styles)?e.styles:[e.styles];for(let a of r)"string"==typeof a?a===kl?i.push(a):t.errors.push(new ae(3002,!1)):i.push(Sk(a));let s=!1,o=null;return i.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(o=a.get("easing"),a.delete("easing")),!s))for(let l of a.values())if(l.toString().indexOf("{{")>=0){s=!0;break}}),{type:6,styles:i,easing:o,offset:e.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(e,t){const i=t.currentAnimateTimings;let r=t.currentTime,s=t.currentTime;i&&s>0&&(s-=i.duration+i.delay),e.styles.forEach(o=>{"string"!=typeof o&&o.forEach((a,l)=>{const c=t.collectedStyles.get(t.currentQuerySelector),h=c.get(l);let d=!0;h&&(s!=r&&s>=h.startTime&&r<=h.endTime&&(t.errors.push(function F7(n,e,t,i,r){return new ae(3010,!1)}()),d=!1),s=h.startTime),d&&c.set(l,{startTime:s,endTime:r}),t.options&&function pq(n,e,t){const i=e.params||{},r=xk(n);r.length&&r.forEach(s=>{i.hasOwnProperty(s)||t.push(function A7(n){return new ae(3001,!1)}())})}(a,t.options,t.errors)})})}visitKeyframes(e,t){const i={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function k7(){return new ae(3011,!1)}()),i;let s=0;const o=[];let a=!1,l=!1,c=0;const h=e.steps.map(y=>{const b=this._makeStyleAst(y,t);let E=null!=b.offset?b.offset:function Mq(n){if("string"==typeof n)return null;let e=null;if(Array.isArray(n))n.forEach(t=>{if(t instanceof Map&&t.has("offset")){const i=t;e=parseFloat(i.get("offset")),i.delete("offset")}});else if(n instanceof Map&&n.has("offset")){const t=n;e=parseFloat(t.get("offset")),t.delete("offset")}return e}(b.styles),C=0;return null!=E&&(s++,C=b.offset=E),l=l||C<0||C>1,a=a||C<c,c=C,o.push(C),b});l&&t.errors.push(function U7(){return new ae(3012,!1)}()),a&&t.errors.push(function B7(){return new ae(3200,!1)}());const d=e.steps.length;let p=0;s>0&&s<d?t.errors.push(function V7(){return new ae(3202,!1)}()):0==s&&(p=1/(d-1));const m=d-1,g=t.currentTime,v=t.currentAnimateTimings,w=v.duration;return h.forEach((y,b)=>{const E=p>0?b==m?1:p*b:o[b],C=E*w;t.currentTime=g+v.delay+C,v.duration=C,this._validateStyleAst(y,t),y.offset=E,i.styles.push(y)}),i}visitReference(e,t){return{type:8,animation:to(this,Ey(e.animation),t),options:Nh(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:Nh(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:Nh(e.options)}}visitQuery(e,t){const i=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;const[s,o]=function Sq(n){const e=!!n.split(/\s*,\s*/).find(t=>":self"==t);return e&&(n=n.replace(bq,"")),n=n.replace(/@\*/g,lE).replace(/@\w+/g,t=>lE+"-"+t.slice(1)).replace(/:animating/g,g1),[n,e]}(e.selector);t.currentQuerySelector=i.length?i+" "+s:s,eo(t.collectedStyles,t.currentQuerySelector,new Map);const a=to(this,Ey(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=i,{type:11,selector:s,limit:r.limit||0,optional:!!r.optional,includeSelf:o,animation:a,originalSelector:e.selector,options:Nh(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function H7(){return new ae(3013,!1)}());const i="full"===e.timings?{duration:0,delay:0,easing:"full"}:cE(e.timings,t.errors,!0);return{type:12,animation:to(this,Ey(e.animation),t),timings:i,options:null}}}class xq{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function Nh(n){return n?(n=by(n)).params&&(n.params=function Cq(n){return n?by(n):null}(n.params)):n={},n}function b1(n,e,t){return{duration:n,delay:e,easing:t}}function E1(n,e,t,i,r,s,o=null,a=!1){return{type:1,element:n,keyframes:e,preStyleProps:t,postStyleProps:i,duration:r,delay:s,totalTime:r+s,easing:o,subTimeline:a}}class pE{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let i=this._map.get(e);i||this._map.set(e,i=[]),i.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const Iq=new RegExp(":enter","g"),Pq=new RegExp(":leave","g");function S1(n,e,t,i,r,s=new Map,o=new Map,a,l,c=[]){return(new Nq).buildKeyframes(n,e,t,i,r,s,o,a,l,c)}class Nq{buildKeyframes(e,t,i,r,s,o,a,l,c,h=[]){c=c||new pE;const d=new C1(e,t,c,r,s,h,[]);d.options=l;const p=l.delay?Ul(l.delay):0;d.currentTimeline.delayNextStep(p),d.currentTimeline.setStyles([o],null,d.errors,l),to(this,i,d);const m=d.timelines.filter(g=>g.containsAnimation());if(m.length&&a.size){let g;for(let v=m.length-1;v>=0;v--){const w=m[v];if(w.element===t){g=w;break}}g&&!g.allowOnlyTimelineStyles()&&g.setStyles([a],null,d.errors,l)}return m.length?m.map(g=>g.buildKeyframes()):[E1(t,[],[],[],0,p,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const i=t.subInstructions.get(t.element);if(i){const r=t.createSubContext(e.options),s=t.currentTimeline.currentTime,o=this._visitSubInstructions(i,r,r.options);s!=o&&t.transformIntoNewTimeline(o)}t.previousNode=e}visitAnimateRef(e,t){const i=t.createSubContext(e.options);i.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],t,i),this.visitReference(e.animation,i),t.transformIntoNewTimeline(i.currentTimeline.currentTime),t.previousNode=e}_applyAnimationRefDelays(e,t,i){for(const r of e){const s=r?.delay;if(s){const o="number"==typeof s?s:Ul(Sy(s,r?.params??{},t.errors));i.delayNextStep(o)}}}_visitSubInstructions(e,t,i){let s=t.currentTimeline.currentTime;const o=null!=i.duration?Ul(i.duration):null,a=null!=i.delay?Ul(i.delay):null;return 0!==o&&e.forEach(l=>{const c=t.appendInstructionToTimeline(l,o,a);s=Math.max(s,c.duration+c.delay)}),s}visitReference(e,t){t.updateOptions(e.options,!0),to(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const i=t.subContextCount;let r=t;const s=e.options;if(s&&(s.params||s.delay)&&(r=t.createSubContext(s),r.transformIntoNewTimeline(),null!=s.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=mE);const o=Ul(s.delay);r.delayNextStep(o)}e.steps.length&&(e.steps.forEach(o=>to(this,o,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const i=[];let r=t.currentTimeline.currentTime;const s=e.options&&e.options.delay?Ul(e.options.delay):0;e.steps.forEach(o=>{const a=t.createSubContext(e.options);s&&a.delayNextStep(s),to(this,o,a),r=Math.max(r,a.currentTimeline.currentTime),i.push(a.currentTimeline)}),i.forEach(o=>t.currentTimeline.mergeTimelineCollectedStyles(o)),t.transformIntoNewTimeline(r),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const i=e.strValue;return cE(t.params?Sy(i,t.params,t.errors):i,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const i=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;i.delay&&(t.incrementTime(i.delay),r.snapshotCurrentStyles());const s=e.style;5==s.type?this.visitKeyframes(s,t):(t.incrementTime(i.duration),this.visitStyle(s,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const i=t.currentTimeline,r=t.currentAnimateTimings;!r&&i.hasCurrentStyleProperties()&&i.forwardFrame();const s=r&&r.easing||e.easing;e.isEmptyStep?i.applyEmptyStep(s):i.setStyles(e.styles,s,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const i=t.currentAnimateTimings,r=t.currentTimeline.duration,s=i.duration,a=t.createSubContext().currentTimeline;a.easing=i.easing,e.styles.forEach(l=>{a.forwardTime((l.offset||0)*s),a.setStyles(l.styles,l.easing,t.errors,t.options),a.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(r+s),t.previousNode=e}visitQuery(e,t){const i=t.currentTimeline.currentTime,r=e.options||{},s=r.delay?Ul(r.delay):0;s&&(6===t.previousNode.type||0==i&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=mE);let o=i;const a=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!r.optional,t.errors);t.currentQueryTotal=a.length;let l=null;a.forEach((c,h)=>{t.currentQueryIndex=h;const d=t.createSubContext(e.options,c);s&&d.delayNextStep(s),c===t.element&&(l=d.currentTimeline),to(this,e.animation,d),d.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,d.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),l&&(t.currentTimeline.mergeTimelineCollectedStyles(l),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const i=t.parentContext,r=t.currentTimeline,s=e.timings,o=Math.abs(s.duration),a=o*(t.currentQueryTotal-1);let l=o*t.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":l=a-l;break;case"full":l=i.currentStaggerTime}const h=t.currentTimeline;l&&h.delayNextStep(l);const d=h.currentTime;to(this,e.animation,t),t.previousNode=e,i.currentStaggerTime=r.currentTime-d+(r.startTime-i.currentTimeline.startTime)}}const mE={};class C1{constructor(e,t,i,r,s,o,a,l){this._driver=e,this.element=t,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=s,this.errors=o,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=mE,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=l||new gE(this._driver,t,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const i=e;let r=this.options;null!=i.duration&&(r.duration=Ul(i.duration)),null!=i.delay&&(r.delay=Ul(i.delay));const s=i.params;if(s){let o=r.params;o||(o=this.options.params={}),Object.keys(s).forEach(a=>{(!t||!o.hasOwnProperty(a))&&(o[a]=Sy(s[a],o,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const i=e.params={};Object.keys(t).forEach(r=>{i[r]=t[r]})}}return e}createSubContext(e=null,t,i){const r=t||this.element,s=new C1(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(e),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(e){return this.previousNode=mE,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,i){const r={duration:t??e.duration,delay:this.currentTimeline.currentTime+(i??0)+e.delay,easing:""},s=new Lq(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(s),r}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,i,r,s,o){let a=[];if(r&&a.push(this.element),e.length>0){e=(e=e.replace(Iq,"."+this._enterClassName)).replace(Pq,"."+this._leaveClassName);let c=this._driver.query(this.element,e,1!=i);0!==i&&(c=i<0?c.slice(c.length+i,c.length):c.slice(0,i)),a.push(...c)}return!s&&0==a.length&&o.push(function z7(n){return new ae(3014,!1)}()),a}}class gE{constructor(e,t,i,r){this._driver=e,this.element=t,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new gE(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,i]of this._globalTimelineStyles)this._backFill.set(t,i||kl),this._currentKeyframe.set(t,kl);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,i,r){t&&this._previousKeyframe.set("easing",t);const s=r&&r.params||{},o=function Oq(n,e){const t=new Map;let i;return n.forEach(r=>{if("*"===r){i=i||e.keys();for(let s of i)t.set(s,kl)}else ru(r,t)}),t}(e,this._globalTimelineStyles);for(let[a,l]of o){const c=Sy(l,s,i);this._pendingStyles.set(a,c),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??kl),this._updateStyle(a,c)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,i)=>{const r=this._styleSummary.get(i);(!r||t.time>r.time)&&this._updateStyle(i,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((a,l)=>{const c=ru(a,new Map,this._backFill);c.forEach((h,d)=>{"!"===h?e.add(d):h===kl&&t.add(d)}),i||c.set("offset",l/this.duration),r.push(c)});const s=e.size?uE(e.values()):[],o=t.size?uE(t.values()):[];if(i){const a=r[0],l=new Map(a);a.set("offset",0),l.set("offset",1),r=[a,l]}return E1(this.element,r,s,o,this.duration,this.startTime,this.easing,!1)}}class Lq extends gE{constructor(e,t,i,r,s,o,a=!1){super(e,t,o.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=s,this._stretchStartingKeyframe=a,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&t){const s=[],o=i+t,a=t/o,l=ru(e[0]);l.set("offset",0),s.push(l);const c=ru(e[0]);c.set("offset",Ik(a)),s.push(c);const h=e.length-1;for(let d=1;d<=h;d++){let p=ru(e[d]);const m=p.get("offset");p.set("offset",Ik((t+m*i)/o)),s.push(p)}i=o,t=0,r="",e=s}return E1(this.element,e,this.preStyleProps,this.postStyleProps,i,t,r,!0)}}function Ik(n,e=3){const t=Math.pow(10,e-1);return Math.round(n*t)/t}class x1{}const Fq=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class kq extends x1{normalizePropertyName(e,t){return v1(e)}normalizeStyleValue(e,t,i,r){let s="";const o=i.toString().trim();if(Fq.has(t)&&0!==i&&"0"!==i)if("number"==typeof i)s="px";else{const a=i.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&r.push(function R7(n,e){return new ae(3005,!1)}())}return o+s}}function Rk(n,e,t,i,r,s,o,a,l,c,h,d,p){return{type:0,element:n,triggerName:e,isRemovalTransition:r,fromState:t,fromStyles:s,toState:i,toStyles:o,timelines:a,queriedElements:l,preStyleProps:c,postStyleProps:h,totalTime:d,errors:p}}const M1={};class Pk{constructor(e,t,i){this._triggerName=e,this.ast=t,this._stateStyles=i}match(e,t,i,r){return function Uq(n,e,t,i,r){return n.some(s=>s(e,t,i,r))}(this.ast.matchers,e,t,i,r)}buildStyles(e,t,i){let r=this._stateStyles.get("*");return void 0!==e&&(r=this._stateStyles.get(e?.toString())||r),r?r.buildStyles(t,i):new Map}build(e,t,i,r,s,o,a,l,c,h){const d=[],p=this.ast.options&&this.ast.options.params||M1,g=this.buildStyles(i,a&&a.params||M1,d),v=l&&l.params||M1,w=this.buildStyles(r,v,d),y=new Set,b=new Map,E=new Map,C="void"===r,x={params:Bq(v,p),delay:this.ast.options?.delay},A=h?[]:S1(e,t,this.ast.animation,s,o,g,w,x,c,d);let D=0;if(A.forEach(T=>{D=Math.max(T.duration+T.delay,D)}),d.length)return Rk(t,this._triggerName,i,r,C,g,w,[],[],b,E,D,d);A.forEach(T=>{const R=T.element,$=eo(b,R,new Set);T.preStyleProps.forEach(se=>$.add(se));const ee=eo(E,R,new Set);T.postStyleProps.forEach(se=>ee.add(se)),R!==t&&y.add(R)});const O=uE(y.values());return Rk(t,this._triggerName,i,r,C,g,w,A,O,b,E,D)}}function Bq(n,e){const t=by(e);for(const i in n)n.hasOwnProperty(i)&&null!=n[i]&&(t[i]=n[i]);return t}class Vq{constructor(e,t,i){this.styles=e,this.defaultParams=t,this.normalizer=i}buildStyles(e,t){const i=new Map,r=by(this.defaultParams);return Object.keys(e).forEach(s=>{const o=e[s];null!==o&&(r[s]=o)}),this.styles.styles.forEach(s=>{"string"!=typeof s&&s.forEach((o,a)=>{o&&(o=Sy(o,r,t));const l=this.normalizer.normalizePropertyName(a,t);o=this.normalizer.normalizeStyleValue(a,l,o,t),i.set(a,o)})}),i}}class zq{constructor(e,t,i){this.name=e,this.ast=t,this._normalizer=i,this.transitionFactories=[],this.states=new Map,t.states.forEach(r=>{this.states.set(r.name,new Vq(r.style,r.options&&r.options.params||{},i))}),Nk(this.states,"true","1"),Nk(this.states,"false","0"),t.transitions.forEach(r=>{this.transitionFactories.push(new Pk(e,r,this.states))}),this.fallbackTransition=function Gq(n,e,t){return new Pk(n,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,a)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,i,r){return this.transitionFactories.find(o=>o.match(e,t,i,r))||null}matchStyles(e,t,i){return this.fallbackTransition.buildStyles(e,t,i)}}function Nk(n,e,t){n.has(e)?n.has(t)||n.set(t,n.get(e)):n.has(t)&&n.set(e,n.get(t))}const Wq=new pE;class jq{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,t){const i=[],s=w1(this._driver,t,i,[]);if(i.length)throw function Y7(n){return new ae(3503,!1)}();this._animations.set(e,s)}_buildPlayer(e,t,i){const r=e.element,s=mk(this._normalizer,e.keyframes,t,i);return this._driver.animate(r,s,e.duration,e.delay,e.easing,[],!0)}create(e,t,i={}){const r=[],s=this._animations.get(e);let o;const a=new Map;if(s?(o=S1(this._driver,t,s,m1,oE,new Map,new Map,i,Wq,r),o.forEach(h=>{const d=eo(a,h.element,new Map);h.postStyleProps.forEach(p=>d.set(p,null))})):(r.push(function K7(){return new ae(3300,!1)}()),o=[]),r.length)throw function Z7(n){return new ae(3504,!1)}();a.forEach((h,d)=>{h.forEach((p,m)=>{h.set(m,this._driver.computeStyle(d,m,kl))})});const c=iu(o.map(h=>{const d=a.get(h.element);return this._buildPlayer(h,new Map,d)}));return this._playersById.set(e,c),c.onDestroy(()=>this.destroy(e)),this.players.push(c),c}destroy(e){const t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);const i=this.players.indexOf(t);i>=0&&this.players.splice(i,1)}_getPlayer(e){const t=this._playersById.get(e);if(!t)throw function J7(n){return new ae(3301,!1)}();return t}listen(e,t,i,r){const s=d1(t,"","","");return u1(this._getPlayer(e),i,s,r),()=>{}}command(e,t,i,r){if("register"==i)return void this.register(e,r[0]);if("create"==i)return void this.create(e,t,r[0]||{});const s=this._getPlayer(e);switch(i){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}}const Lk="ng-animate-queued",T1="ng-animate-disabled",Kq=[],Ok={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Zq={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},la="__ng_removed";class A1{get params(){return this.options.params}constructor(e,t=""){this.namespaceId=t;const i=e&&e.hasOwnProperty("value");if(this.value=function tX(n){return n??null}(i?e.value:e),i){const s=by(e);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){const t=e.params;if(t){const i=this.options.params;Object.keys(t).forEach(r=>{null==i[r]&&(i[r]=t[r])})}}}const Cy="void",D1=new A1(Cy);class Jq{constructor(e,t,i){this.id=e,this.hostElement=t,this._engine=i,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,Ao(t,this._hostClassName)}listen(e,t,i,r){if(!this._triggers.has(t))throw function Q7(n,e){return new ae(3302,!1)}();if(null==i||0==i.length)throw function eq(n){return new ae(3303,!1)}();if(!function nX(n){return"start"==n||"done"==n}(i))throw function tq(n,e){return new ae(3400,!1)}();const s=eo(this._elementListeners,e,[]),o={name:t,phase:i,callback:r};s.push(o);const a=eo(this._engine.statesByElement,e,new Map);return a.has(t)||(Ao(e,aE),Ao(e,aE+"-"+t),a.set(t,D1)),()=>{this._engine.afterFlush(()=>{const l=s.indexOf(o);l>=0&&s.splice(l,1),this._triggers.has(t)||a.delete(t)})}}register(e,t){return!this._triggers.has(e)&&(this._triggers.set(e,t),!0)}_getTrigger(e){const t=this._triggers.get(e);if(!t)throw function nq(n){return new ae(3401,!1)}();return t}trigger(e,t,i,r=!0){const s=this._getTrigger(t),o=new I1(this.id,t,e);let a=this._engine.statesByElement.get(e);a||(Ao(e,aE),Ao(e,aE+"-"+t),this._engine.statesByElement.set(e,a=new Map));let l=a.get(t);const c=new A1(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&l&&c.absorbOptions(l.options),a.set(t,c),l||(l=D1),c.value!==Cy&&l.value===c.value){if(!function sX(n,e){const t=Object.keys(n),i=Object.keys(e);if(t.length!=i.length)return!1;for(let r=0;r<t.length;r++){const s=t[r];if(!e.hasOwnProperty(s)||n[s]!==e[s])return!1}return!0}(l.params,c.params)){const v=[],w=s.matchStyles(l.value,l.params,v),y=s.matchStyles(c.value,c.params,v);v.length?this._engine.reportError(v):this._engine.afterFlush(()=>{Ph(e,w),$a(e,y)})}return}const p=eo(this._engine.playersByElement,e,[]);p.forEach(v=>{v.namespaceId==this.id&&v.triggerName==t&&v.queued&&v.destroy()});let m=s.matchTransition(l.value,c.value,e,c.params),g=!1;if(!m){if(!r)return;m=s.fallbackTransition,g=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:m,fromState:l,toState:c,player:o,isFallbackTransition:g}),g||(Ao(e,Lk),o.onStart(()=>{Tp(e,Lk)})),o.onDone(()=>{let v=this.players.indexOf(o);v>=0&&this.players.splice(v,1);const w=this._engine.playersByElement.get(e);if(w){let y=w.indexOf(o);y>=0&&w.splice(y,1)}}),this.players.push(o),p.push(o),o}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,i)=>{this._elementListeners.set(i,t.filter(r=>r.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(i=>i.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const i=this._engine.driver.query(e,lE,!0);i.forEach(r=>{if(r[la])return;const s=this._engine.fetchNamespacesByElement(r);s.size?s.forEach(o=>o.triggerLeaveAnimation(r,t,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(e,t,i,r){const s=this._engine.statesByElement.get(e),o=new Map;if(s){const a=[];if(s.forEach((l,c)=>{if(o.set(c,l.value),this._triggers.has(c)){const h=this.trigger(e,c,Cy,r);h&&a.push(h)}}),a.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,o),i&&iu(a).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),i=this._engine.statesByElement.get(e);if(t&&i){const r=new Set;t.forEach(s=>{const o=s.name;if(r.has(o))return;r.add(o);const l=this._triggers.get(o).fallbackTransition,c=i.get(o)||D1,h=new A1(Cy),d=new I1(this.id,o,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:o,transition:l,fromState:c,toState:h,player:d,isFallbackTransition:!0})})}}removeNode(e,t){const i=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let r=!1;if(i.totalAnimations){const s=i.players.length?i.playersByQueriedElement.get(e):[];if(s&&s.length)r=!0;else{let o=e;for(;o=o.parentNode;)if(i.statesByElement.get(o)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(e),r)i.markElementAsRemoved(this.id,e,!1,t);else{const s=e[la];(!s||s===Ok)&&(i.afterFlush(()=>this.clearElementCache(e)),i.destroyInnerAnimations(e),i._onRemovalComplete(e,t))}}insertNode(e,t){Ao(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const s=i.element,o=this._elementListeners.get(s);o&&o.forEach(a=>{if(a.name==i.triggerName){const l=d1(s,i.triggerName,i.fromState.value,i.toState.value);l._data=e,u1(i.player,a.phase,l,a.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):t.push(i)}),this._queue=[],t.sort((i,r)=>{const s=i.transition.ast.depCount,o=r.transition.ast.depCount;return 0==s||0==o?s-o:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}}class Qq{_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}constructor(e,t,i){this.bodyNode=e,this.driver=t,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,s)=>{}}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(i=>{i.queued&&e.push(i)})}),e}createNamespace(e,t){const i=new Jq(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(i,t):(this.newHostElements.set(t,i),this.collectEnterElement(t)),this._namespaceLookup[e]=i}_balanceNamespaceList(e,t){const i=this._namespaceList,r=this.namespacesByHostElement;if(i.length-1>=0){let o=!1,a=this.driver.getParentElement(t);for(;a;){const l=r.get(a);if(l){const c=i.indexOf(l);i.splice(c+1,0,e),o=!0;break}a=this.driver.getParentElement(a)}o||i.unshift(e)}else i.push(e);return r.set(t,e),e}register(e,t){let i=this._namespaceLookup[e];return i||(i=this.createNamespace(e,t)),i}registerTrigger(e,t,i){let r=this._namespaceLookup[e];r&&r.register(t,i)&&this.totalAnimations++}destroy(e,t){e&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const i=this._fetchNamespace(e);this.namespacesByHostElement.delete(i.hostElement);const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1),i.destroy(t),delete this._namespaceLookup[e]}))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,i=this.statesByElement.get(e);if(i)for(let r of i.values())if(r.namespaceId){const s=this._fetchNamespace(r.namespaceId);s&&t.add(s)}return t}trigger(e,t,i,r){if(_E(t)){const s=this._fetchNamespace(e);if(s)return s.trigger(t,i,r),!0}return!1}insertNode(e,t,i,r){if(!_E(t))return;const s=t[la];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const o=this.collectedLeaveElements.indexOf(t);o>=0&&this.collectedLeaveElements.splice(o,1)}if(e){const o=this._fetchNamespace(e);o&&o.insertNode(t,i)}r&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),Ao(e,T1)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),Tp(e,T1))}removeNode(e,t,i){if(_E(t)){const r=e?this._fetchNamespace(e):null;r?r.removeNode(t,i):this.markElementAsRemoved(e,t,!1,i);const s=this.namespacesByHostElement.get(t);s&&s.id!==e&&s.removeNode(t,i)}else this._onRemovalComplete(t,i)}markElementAsRemoved(e,t,i,r,s){this.collectedLeaveElements.push(t),t[la]={namespaceId:e,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:s}}listen(e,t,i,r,s){return _E(t)?this._fetchNamespace(e).listen(t,i,r,s):()=>{}}_buildInstruction(e,t,i,r,s){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,i,r,e.fromState.options,e.toState.options,t,s)}destroyInnerAnimations(e){let t=this.driver.query(e,lE,!0);t.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,g1,!0),t.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return iu(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e[la];if(t&&t.setForRemoval){if(e[la]=Ok,t.namespaceId){this.destroyInnerAnimations(e);const i=this._fetchNamespace(t.namespaceId);i&&i.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(T1)&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)Ao(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{t=this._flushAnimations(i,e)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],t.length?iu(t).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(e){throw function iq(n){return new ae(3402,!1)}()}_flushAnimations(e,t){const i=new pE,r=[],s=new Map,o=[],a=new Map,l=new Map,c=new Map,h=new Set;this.disabledNodes.forEach(G=>{h.add(G);const X=this.driver.query(G,".ng-animate-queued",!0);for(let Q=0;Q<X.length;Q++)h.add(X[Q])});const d=this.bodyNode,p=Array.from(this.statesByElement.keys()),m=Uk(p,this.collectedEnterElements),g=new Map;let v=0;m.forEach((G,X)=>{const Q=m1+v++;g.set(X,Q),G.forEach(Z=>Ao(Z,Q))});const w=[],y=new Set,b=new Set;for(let G=0;G<this.collectedLeaveElements.length;G++){const X=this.collectedLeaveElements[G],Q=X[la];Q&&Q.setForRemoval&&(w.push(X),y.add(X),Q.hasAnimation?this.driver.query(X,".ng-star-inserted",!0).forEach(Z=>y.add(Z)):b.add(X))}const E=new Map,C=Uk(p,Array.from(y));C.forEach((G,X)=>{const Q=oE+v++;E.set(X,Q),G.forEach(Z=>Ao(Z,Q))}),e.push(()=>{m.forEach((G,X)=>{const Q=g.get(X);G.forEach(Z=>Tp(Z,Q))}),C.forEach((G,X)=>{const Q=E.get(X);G.forEach(Z=>Tp(Z,Q))}),w.forEach(G=>{this.processLeaveNode(G)})});const x=[],A=[];for(let G=this._namespaceList.length-1;G>=0;G--)this._namespaceList[G].drainQueuedTransitions(t).forEach(Q=>{const Z=Q.player,le=Q.element;if(x.push(Z),this.collectedEnterElements.length){const Be=le[la];if(Be&&Be.setForMove){if(Be.previousTriggersValues&&Be.previousTriggersValues.has(Q.triggerName)){const Xe=Be.previousTriggersValues.get(Q.triggerName),dt=this.statesByElement.get(Q.element);if(dt&&dt.has(Q.triggerName)){const St=dt.get(Q.triggerName);St.value=Xe,dt.set(Q.triggerName,St)}}return void Z.destroy()}}const q=!d||!this.driver.containsElement(d,le),oe=E.get(le),Se=g.get(le),ve=this._buildInstruction(Q,i,Se,oe,q);if(ve.errors&&ve.errors.length)return void A.push(ve);if(q)return Z.onStart(()=>Ph(le,ve.fromStyles)),Z.onDestroy(()=>$a(le,ve.toStyles)),void r.push(Z);if(Q.isFallbackTransition)return Z.onStart(()=>Ph(le,ve.fromStyles)),Z.onDestroy(()=>$a(le,ve.toStyles)),void r.push(Z);const Ne=[];ve.timelines.forEach(Be=>{Be.stretchStartingKeyframe=!0,this.disabledNodes.has(Be.element)||Ne.push(Be)}),ve.timelines=Ne,i.append(le,ve.timelines),o.push({instruction:ve,player:Z,element:le}),ve.queriedElements.forEach(Be=>eo(a,Be,[]).push(Z)),ve.preStyleProps.forEach((Be,Xe)=>{if(Be.size){let dt=l.get(Xe);dt||l.set(Xe,dt=new Set),Be.forEach((St,nt)=>dt.add(nt))}}),ve.postStyleProps.forEach((Be,Xe)=>{let dt=c.get(Xe);dt||c.set(Xe,dt=new Set),Be.forEach((St,nt)=>dt.add(nt))})});if(A.length){const G=[];A.forEach(X=>{G.push(function rq(n,e){return new ae(3505,!1)}())}),x.forEach(X=>X.destroy()),this.reportError(G)}const D=new Map,O=new Map;o.forEach(G=>{const X=G.element;i.has(X)&&(O.set(X,X),this._beforeAnimationBuild(G.player.namespaceId,G.instruction,D))}),r.forEach(G=>{const X=G.element;this._getPreviousPlayers(X,!1,G.namespaceId,G.triggerName,null).forEach(Z=>{eo(D,X,[]).push(Z),Z.destroy()})});const T=w.filter(G=>Vk(G,l,c)),R=new Map;kk(R,this.driver,b,c,kl).forEach(G=>{Vk(G,l,c)&&T.push(G)});const ee=new Map;m.forEach((G,X)=>{kk(ee,this.driver,new Set(G),l,"!")}),T.forEach(G=>{const X=R.get(G),Q=ee.get(G);R.set(G,new Map([...X?.entries()??[],...Q?.entries()??[]]))});const se=[],V=[],J={};o.forEach(G=>{const{element:X,player:Q,instruction:Z}=G;if(i.has(X)){if(h.has(X))return Q.onDestroy(()=>$a(X,Z.toStyles)),Q.disabled=!0,Q.overrideTotalTime(Z.totalTime),void r.push(Q);let le=J;if(O.size>1){let oe=X;const Se=[];for(;oe=oe.parentNode;){const ve=O.get(oe);if(ve){le=ve;break}Se.push(oe)}Se.forEach(ve=>O.set(ve,le))}const q=this._buildAnimation(Q.namespaceId,Z,D,s,ee,R);if(Q.setRealPlayer(q),le===J)se.push(Q);else{const oe=this.playersByElement.get(le);oe&&oe.length&&(Q.parentPlayer=iu(oe)),r.push(Q)}}else Ph(X,Z.fromStyles),Q.onDestroy(()=>$a(X,Z.toStyles)),V.push(Q),h.has(X)&&r.push(Q)}),V.forEach(G=>{const X=s.get(G.element);if(X&&X.length){const Q=iu(X);G.setRealPlayer(Q)}}),r.forEach(G=>{G.parentPlayer?G.syncPlayerEvents(G.parentPlayer):G.destroy()});for(let G=0;G<w.length;G++){const X=w[G],Q=X[la];if(Tp(X,oE),Q&&Q.hasAnimation)continue;let Z=[];if(a.size){let q=a.get(X);q&&q.length&&Z.push(...q);let oe=this.driver.query(X,g1,!0);for(let Se=0;Se<oe.length;Se++){let ve=a.get(oe[Se]);ve&&ve.length&&Z.push(...ve)}}const le=Z.filter(q=>!q.destroyed);le.length?iX(this,X,le):this.processLeaveNode(X)}return w.length=0,se.forEach(G=>{this.players.push(G),G.onDone(()=>{G.destroy();const X=this.players.indexOf(G);this.players.splice(X,1)}),G.play()}),se}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,i,r,s){let o=[];if(t){const a=this.playersByQueriedElement.get(e);a&&(o=a)}else{const a=this.playersByElement.get(e);if(a){const l=!s||s==Cy;a.forEach(c=>{c.queued||!l&&c.triggerName!=r||o.push(c)})}}return(i||r)&&(o=o.filter(a=>!(i&&i!=a.namespaceId||r&&r!=a.triggerName))),o}_beforeAnimationBuild(e,t,i){const s=t.element,o=t.isRemovalTransition?void 0:e,a=t.isRemovalTransition?void 0:t.triggerName;for(const l of t.timelines){const c=l.element,h=c!==s,d=eo(i,c,[]);this._getPreviousPlayers(c,h,o,a,t.toState).forEach(m=>{const g=m.getRealPlayer();g.beforeDestroy&&g.beforeDestroy(),m.destroy(),d.push(m)})}Ph(s,t.fromStyles)}_buildAnimation(e,t,i,r,s,o){const a=t.triggerName,l=t.element,c=[],h=new Set,d=new Set,p=t.timelines.map(g=>{const v=g.element;h.add(v);const w=v[la];if(w&&w.removedBeforeQueried)return new wy(g.duration,g.delay);const y=v!==l,b=function rX(n){const e=[];return Bk(n,e),e}((i.get(v)||Kq).map(D=>D.getRealPlayer())).filter(D=>!!D.element&&D.element===v),E=s.get(v),C=o.get(v),x=mk(this._normalizer,g.keyframes,E,C),A=this._buildPlayer(g,x,b);if(g.subTimeline&&r&&d.add(v),y){const D=new I1(e,a,v);D.setRealPlayer(A),c.push(D)}return A});c.forEach(g=>{eo(this.playersByQueriedElement,g.element,[]).push(g),g.onDone(()=>function eX(n,e,t){let i=n.get(e);if(i){if(i.length){const r=i.indexOf(t);i.splice(r,1)}0==i.length&&n.delete(e)}return i}(this.playersByQueriedElement,g.element,g))}),h.forEach(g=>Ao(g,Ek));const m=iu(p);return m.onDestroy(()=>{h.forEach(g=>Tp(g,Ek)),$a(l,t.toStyles)}),d.forEach(g=>{eo(r,g,[]).push(m)}),m}_buildPlayer(e,t,i){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,i):new wy(e.duration,e.delay)}}class I1{constructor(e,t,i){this.namespaceId=e,this.triggerName=t,this.element=i,this._player=new wy,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,i)=>{t.forEach(r=>u1(e,i,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){eo(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function _E(n){return n&&1===n.nodeType}function Fk(n,e){const t=n.style.display;return n.style.display=e??"none",t}function kk(n,e,t,i,r){const s=[];t.forEach(l=>s.push(Fk(l)));const o=[];i.forEach((l,c)=>{const h=new Map;l.forEach(d=>{const p=e.computeStyle(c,d,r);h.set(d,p),(!p||0==p.length)&&(c[la]=Zq,o.push(c))}),n.set(c,h)});let a=0;return t.forEach(l=>Fk(l,s[a++])),o}function Uk(n,e){const t=new Map;if(n.forEach(a=>t.set(a,[])),0==e.length)return t;const r=new Set(e),s=new Map;function o(a){if(!a)return 1;let l=s.get(a);if(l)return l;const c=a.parentNode;return l=t.has(c)?c:r.has(c)?1:o(c),s.set(a,l),l}return e.forEach(a=>{const l=o(a);1!==l&&t.get(l).push(a)}),t}function Ao(n,e){n.classList?.add(e)}function Tp(n,e){n.classList?.remove(e)}function iX(n,e,t){iu(t).onDone(()=>n.processLeaveNode(e))}function Bk(n,e){for(let t=0;t<n.length;t++){const i=n[t];i instanceof fk?Bk(i.players,e):e.push(i)}}function Vk(n,e,t){const i=t.get(n);if(!i)return!1;let r=e.get(n);return r?i.forEach(s=>r.add(s)):e.set(n,i),t.delete(n),!0}class yE{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(r,s)=>{},this._transitionEngine=new Qq(e,t,i),this._timelineEngine=new jq(e,t,i),this._transitionEngine.onRemovalComplete=(r,s)=>this.onRemovalComplete(r,s)}registerTrigger(e,t,i,r,s){const o=e+"-"+r;let a=this._triggerCache[o];if(!a){const l=[],h=w1(this._driver,s,l,[]);if(l.length)throw function q7(n,e){return new ae(3404,!1)}();a=function Hq(n,e,t){return new zq(n,e,t)}(r,h,this._normalizer),this._triggerCache[o]=a}this._transitionEngine.registerTrigger(t,r,a)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,i,r){this._transitionEngine.insertNode(e,t,i,r)}onRemove(e,t,i){this._transitionEngine.removeNode(e,t,i)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,i,r){if("@"==i.charAt(0)){const[s,o]=gk(i);this._timelineEngine.command(s,t,o,r)}else this._transitionEngine.trigger(e,t,i,r)}listen(e,t,i,r,s){if("@"==i.charAt(0)){const[o,a]=gk(i);return this._timelineEngine.listen(o,t,a,s)}return this._transitionEngine.listen(e,t,i,r,s)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(e){this._transitionEngine.afterFlushAnimationsDone(e)}}let aX=(()=>{class n{static#e=this.initialStylesByElement=new WeakMap;constructor(t,i,r){this._element=t,this._startStyles=i,this._endStyles=r,this._state=0;let s=n.initialStylesByElement.get(t);s||n.initialStylesByElement.set(t,s=new Map),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&$a(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&($a(this._element,this._initialStyles),this._endStyles&&($a(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(Ph(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Ph(this._element,this._endStyles),this._endStyles=null),$a(this._element,this._initialStyles),this._state=3)}}return n})();function R1(n){let e=null;return n.forEach((t,i)=>{(function lX(n){return"display"===n||"position"===n})(i)&&(e=e||new Map,e.set(i,t))}),e}class Hk{constructor(e,t,i,r){this.element=e,this.keyframes=t,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){const t=[];return e.forEach(i=>{t.push(Object.fromEntries(i))}),t}_triggerWebAnimation(e,t,i){return e.animate(this._convertKeyframesToObject(t),i)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((i,r)=>{"offset"!==r&&e.set(r,this._finished?i:Mk(this.element,r))}),this.currentSnapshot=e}triggerCallback(e){const t="start"===e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class cX{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}matchesElement(e,t){return!1}containsElement(e,t){return yk(e,t)}getParentElement(e){return f1(e)}query(e,t,i){return vk(e,t,i)}computeStyle(e,t,i){return window.getComputedStyle(e)[t]}animate(e,t,i,r,s,o=[]){const l={duration:i,delay:r,fill:0==r?"both":"forwards"};s&&(l.easing=s);const c=new Map,h=o.filter(m=>m instanceof Hk);(function gq(n,e){return 0===n||0===e})(i,r)&&h.forEach(m=>{m.currentSnapshot.forEach((g,v)=>c.set(v,g))});let d=function fq(n){return n.length?n[0]instanceof Map?n:n.map(e=>Sk(e)):[]}(t).map(m=>ru(m));d=function _q(n,e,t){if(t.size&&e.length){let i=e[0],r=[];if(t.forEach((s,o)=>{i.has(o)||r.push(o),i.set(o,s)}),r.length)for(let s=1;s<e.length;s++){let o=e[s];r.forEach(a=>o.set(a,Mk(n,a)))}}return e}(e,d,c);const p=function oX(n,e){let t=null,i=null;return Array.isArray(e)&&e.length?(t=R1(e[0]),e.length>1&&(i=R1(e[e.length-1]))):e instanceof Map&&(t=R1(e)),t||i?new aX(n,t,i):null}(e,d);return new Hk(e,d,l,p)}}let uX=(()=>{class n extends uk{constructor(t,i){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(i.body,{id:"0",encapsulation:xs.None,styles:[],data:{animation:[]}})}build(t){const i=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(t)?hk(t):t;return zk(this._renderer,null,i,"register",[r]),new hX(i,this._renderer)}static#e=this.\u0275fac=function(i){return new(i||n)(Oe(kn),Oe(Vr))};static#t=this.\u0275prov=Je({token:n,factory:n.\u0275fac})}return n})();class hX extends x7{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new dX(this._id,e,t||{},this._renderer)}}class dX{constructor(e,t,i,r){this.id=e,this.element=t,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return zk(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function zk(n,e,t,i,r){return n.setProperty(e,`@@${t}:${i}`,r)}const Gk="@.disabled";let fX=(()=>{class n{constructor(t,i,r){this.delegate=t,this.engine=i,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,i.onRemovalComplete=(s,o)=>{const a=o?.parentNode(s);a&&o.removeChild(a,s)}}createRenderer(t,i){const s=this.delegate.createRenderer(t,i);if(!(t&&i&&i.data&&i.data.animation)){let h=this._rendererCache.get(s);return h||(h=new Wk("",s,this.engine,()=>this._rendererCache.delete(s)),this._rendererCache.set(s,h)),h}const o=i.id,a=i.id+"-"+this._currentId;this._currentId++,this.engine.register(a,t);const l=h=>{Array.isArray(h)?h.forEach(l):this.engine.registerTrigger(o,a,t,h.name,h)};return i.data.animation.forEach(l),new pX(this,a,s,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(t,i,r){t>=0&&t<this._microtaskId?this._zone.run(()=>i(r)):(0==this._animationCallbacksBuffer.length&&queueMicrotask(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(s=>{const[o,a]=s;o(a)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}static#e=this.\u0275fac=function(i){return new(i||n)(Oe(kn),Oe(yE),Oe(Mn))};static#t=this.\u0275prov=Je({token:n,factory:n.\u0275fac})}return n})();class Wk{constructor(e,t,i,r){this.namespaceId=e,this.delegate=t,this.engine=i,this._onDestroy=r}get data(){return this.delegate.data}destroyNode(e){this.delegate.destroyNode?.(e)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,i,r=!0){this.delegate.insertBefore(e,t,i),this.engine.onInsert(this.namespaceId,t,e,r)}removeChild(e,t,i){this.engine.onRemove(this.namespaceId,t,this.delegate)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,i,r){this.delegate.setAttribute(e,t,i,r)}removeAttribute(e,t,i){this.delegate.removeAttribute(e,t,i)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,i,r){this.delegate.setStyle(e,t,i,r)}removeStyle(e,t,i){this.delegate.removeStyle(e,t,i)}setProperty(e,t,i){"@"==t.charAt(0)&&t==Gk?this.disableAnimations(e,!!i):this.delegate.setProperty(e,t,i)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,i){return this.delegate.listen(e,t,i)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class pX extends Wk{constructor(e,t,i,r,s){super(t,i,r,s),this.factory=e,this.namespaceId=t}setProperty(e,t,i){"@"==t.charAt(0)?"."==t.charAt(1)&&t==Gk?this.disableAnimations(e,i=void 0===i||!!i):this.engine.process(this.namespaceId,e,t.slice(1),i):this.delegate.setProperty(e,t,i)}listen(e,t,i){if("@"==t.charAt(0)){const r=function mX(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(e);let s=t.slice(1),o="";return"@"!=s.charAt(0)&&([s,o]=function gX(n){const e=n.indexOf(".");return[n.substring(0,e),n.slice(e+1)]}(s)),this.engine.listen(this.namespaceId,r,s,o,a=>{this.factory.scheduleListenerCallback(a._data||-1,i,a)})}return this.delegate.listen(e,t,i)}}let _X=(()=>{class n extends yE{constructor(t,i,r,s){super(t.body,i,r)}ngOnDestroy(){this.flush()}static#e=this.\u0275fac=function(i){return new(i||n)(Oe(Vr),Oe(p1),Oe(x1),Oe(Ah))};static#t=this.\u0275prov=Je({token:n,factory:n.\u0275fac})}return n})();const jk=[{provide:uk,useClass:uX},{provide:x1,useFactory:function yX(){return new kq}},{provide:yE,useClass:_X},{provide:kn,useFactory:function vX(n,e,t){return new fX(n,e,t)},deps:[r1,yE,Mn]}],P1=[{provide:p1,useFactory:()=>new cX},{provide:lb,useValue:"BrowserAnimations"},...jk],$k=[{provide:p1,useClass:wk},{provide:lb,useValue:"NoopAnimations"},...jk];let wX=(()=>{class n{static withConfig(t){return{ngModule:n,providers:t.disableAnimations?$k:P1}}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=ki({type:n});static#n=this.\u0275inj=Ti({providers:P1,imports:[ok]})}return n})();const{isArray:bX}=Array,{getPrototypeOf:EX,prototype:SX,keys:CX}=Object;function qk(n){if(1===n.length){const e=n[0];if(bX(e))return{args:e,keys:null};if(function xX(n){return n&&"object"==typeof n&&EX(n)===SX}(e)){const t=CX(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}const{isArray:MX}=Array;function Xk(n){return Jt(e=>function TX(n,e){return MX(e)?n(...e):n(e)}(n,e))}function Yk(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}let Kk=(()=>{class n{constructor(t,i){this._renderer=t,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static#e=this.\u0275fac=function(i){return new(i||n)(ce(yi),ce(En))};static#t=this.\u0275dir=pt({type:n})}return n})(),Lh=(()=>{class n extends Kk{static#e=this.\u0275fac=function(){let t;return function(r){return(t||(t=gi(n)))(r||n)}}();static#t=this.\u0275dir=pt({type:n,features:[gn]})}return n})();const ca=new Ye("NgValueAccessor"),IX={provide:ca,useExisting:pn(()=>wE),multi:!0},PX=new Ye("CompositionEventMode");let wE=(()=>{class n extends Kk{constructor(t,i,r){super(t,i),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function RX(){const n=tu()?tu().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(t){this.setProperty("value",t??"")}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static#e=this.\u0275fac=function(i){return new(i||n)(ce(yi),ce(En),ce(PX,8))};static#t=this.\u0275dir=pt({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,r){1&i&&yn("input",function(o){return r._handleInput(o.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(o){return r._compositionEnd(o.target.value)})},features:[Un([IX]),gn]})}return n})();const Hr=new Ye("NgValidators"),ou=new Ye("NgAsyncValidators");function aU(n){return null!=n}function lU(n){return ey(n)?mi(n):n}function cU(n){let e={};return n.forEach(t=>{e=null!=t?{...e,...t}:e}),0===Object.keys(e).length?null:e}function uU(n,e){return e.map(t=>t(n))}function hU(n){return n.map(e=>function LX(n){return!n.validate}(e)?e:t=>e.validate(t))}function N1(n){return null!=n?function dU(n){if(!n)return null;const e=n.filter(aU);return 0==e.length?null:function(t){return cU(uU(t,e))}}(hU(n)):null}function L1(n){return null!=n?function fU(n){if(!n)return null;const e=n.filter(aU);return 0==e.length?null:function(t){return function AX(...n){const e=Nu(n),{args:t,keys:i}=qk(n),r=new Cn(s=>{const{length:o}=t;if(!o)return void s.complete();const a=new Array(o);let l=o,c=o;for(let h=0;h<o;h++){let d=!1;Qr(t[h]).subscribe(Jn(s,p=>{d||(d=!0,c--),a[h]=p},()=>l--,void 0,()=>{(!l||!d)&&(c||s.next(i?Yk(i,a):a),s.complete())}))}});return e?r.pipe(Xk(e)):r}(uU(t,e).map(lU)).pipe(Jt(cU))}}(hU(n)):null}function pU(n,e){return null===n?[e]:Array.isArray(n)?[...n,e]:[n,e]}function O1(n){return n?Array.isArray(n)?n:[n]:[]}function EE(n,e){return Array.isArray(n)?n.includes(e):n===e}function _U(n,e){const t=O1(e);return O1(n).forEach(r=>{EE(t,r)||t.push(r)}),t}function yU(n,e){return O1(e).filter(t=>!EE(n,t))}class vU{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=N1(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=L1(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class ps extends vU{get formDirective(){return null}get path(){return null}}class au extends vU{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class wU{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let bU=(()=>{class n extends wU{constructor(t){super(t)}static#e=this.\u0275fac=function(i){return new(i||n)(ce(au,2))};static#t=this.\u0275dir=pt({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,r){2&i&&ty("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[gn]})}return n})();const xy="VALID",CE="INVALID",Ap="PENDING",My="DISABLED";function xE(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}class xU{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===xy}get invalid(){return this.status===CE}get pending(){return this.status==Ap}get disabled(){return this.status===My}get enabled(){return this.status!==My}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(_U(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(_U(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(yU(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(yU(e,this._rawAsyncValidators))}hasValidator(e){return EE(this._rawValidators,e)}hasAsyncValidator(e){return EE(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=Ap,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=My,this.errors=null,this._forEachChild(i=>{i.disable({...e,onlySelf:!0})}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=xy,this._forEachChild(i=>{i.enable({...e,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===xy||this.status===Ap)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?My:xy}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=Ap,this._hasOwnPendingAsyncValidator=!0;const t=lU(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){let t=e;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((i,r)=>i&&i._find(r),this)}getError(e,t){const i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new qn,this.statusChanges=new qn}_calculateStatus(){return this._allControlsDisabled()?My:this.errors?CE:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Ap)?Ap:this._anyControlsHaveStatus(CE)?CE:xy}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){xE(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=function BX(n){return Array.isArray(n)?N1(n):n||null}(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=function VX(n){return Array.isArray(n)?L1(n):n||null}(this._rawAsyncValidators)}}const Dp=new Ye("CallSetDisabledState",{providedIn:"root",factory:()=>ME}),ME="always";function Ty(n,e,t=ME){(function H1(n,e){const t=function mU(n){return n._rawValidators}(n);null!==e.validator?n.setValidators(pU(t,e.validator)):"function"==typeof t&&n.setValidators([t]);const i=function gU(n){return n._rawAsyncValidators}(n);null!==e.asyncValidator?n.setAsyncValidators(pU(i,e.asyncValidator)):"function"==typeof i&&n.setAsyncValidators([i]);const r=()=>n.updateValueAndValidity();DE(e._rawValidators,r),DE(e._rawAsyncValidators,r)})(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||"always"===t)&&e.valueAccessor.setDisabledState?.(n.disabled),function GX(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&MU(n,e)})}(n,e),function jX(n,e){const t=(i,r)=>{e.valueAccessor.writeValue(i),r&&e.viewToModelUpdate(i)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}(n,e),function WX(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&MU(n,e),"submit"!==n.updateOn&&n.markAsTouched()})}(n,e),function zX(n,e){if(e.valueAccessor.setDisabledState){const t=i=>{e.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}(n,e)}function DE(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function MU(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function DU(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}function IU(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}const RU=class extends xU{constructor(e=null,t,i){super(function U1(n){return(xE(n)?n.validators:n)||null}(t),function B1(n,e){return(xE(e)?e.asyncValidators:n)||null}(i,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),xE(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=IU(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){DU(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){DU(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){IU(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}},QX={provide:au,useExisting:pn(()=>$1)},LU=(()=>Promise.resolve())();let $1=(()=>{class n extends au{constructor(t,i,r,s,o,a){super(),this._changeDetectorRef=o,this.callSetDisabledState=a,this.control=new RU,this._registered=!1,this.name="",this.update=new qn,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=function W1(n,e){if(!e)return null;let t,i,r;return Array.isArray(e),e.forEach(s=>{s.constructor===wE?t=s:function XX(n){return Object.getPrototypeOf(n.constructor)===Lh}(s)?i=s:r=s}),r||i||t||null}(0,s)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){const i=t.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),function G1(n,e){if(!n.hasOwnProperty("model"))return!1;const t=n.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Ty(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){LU.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){const i=t.isDisabled.currentValue,r=0!==i&&function Cp(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}(i);LU.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?function TE(n,e){return[...e.path,n]}(t,this._parent):[t]}static#e=this.\u0275fac=function(i){return new(i||n)(ce(ps,9),ce(Hr,10),ce(ou,10),ce(ca,10),ce(fy,8),ce(Dp,8))};static#t=this.\u0275dir=pt({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Un([QX]),gn,Hi]})}return n})(),FU=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=ki({type:n});static#n=this.\u0275inj=Ti({})}return n})(),CY=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=ki({type:n});static#n=this.\u0275inj=Ti({imports:[FU]})}return n})(),MY=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:Dp,useValue:t.callSetDisabledState??ME}]}}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=ki({type:n});static#n=this.\u0275inj=Ti({imports:[CY]})}return n})();function Q1(...n){const e=Lu(n),t=Nu(n),{args:i,keys:r}=qk(n);if(0===i.length)return mi([],e);const s=new Cn(function AY(n,e,t=Bo){return i=>{e3(e,()=>{const{length:r}=n,s=new Array(r);let o=r,a=r;for(let l=0;l<r;l++)e3(e,()=>{const c=mi(n[l],e);let h=!1;c.subscribe(Jn(i,d=>{s[l]=d,h||(h=!0,a--),a||i.next(t(s.slice()))},()=>{--o||i.complete()}))},i)},i)}}(i,e,r?o=>Yk(r,o):Bo));return t?s.pipe(Xk(t)):s}function e3(n,e,t){n?po(t,n,e):e()}const RE=B(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function eD(...n){return function DY(){return gc(1)}()(mi(n,Lu(n)))}function t3(n){return new Cn(e=>{Qr(n()).subscribe(e)})}function Dy(n,e){const t=fn(n)?n:()=>n,i=r=>r.error(t());return new Cn(e?r=>e.schedule(i,0,r):i)}function tD(){return zn((n,e)=>{let t=null;n._refCount++;const i=Jn(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const r=n._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});n.subscribe(i),i.closed||(t=n.connect())})}class n3 extends Cn{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,qv(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Yr;const t=this.getSubject();e.add(this.source.subscribe(Jn(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Yr.EMPTY)}return e}refCount(){return tD()(this)}}function Ip(n){return n<=0?()=>mo:zn((e,t)=>{let i=0;e.subscribe(Jn(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function Bl(n,e){return zn((t,i)=>{let r=0;t.subscribe(Jn(i,s=>n.call(e,s,r++)&&i.next(s)))})}function PE(n){return zn((e,t)=>{let i=!1;e.subscribe(Jn(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function i3(n=RY){return zn((e,t)=>{let i=!1;e.subscribe(Jn(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function RY(){return new RE}function Fh(n,e){const t=arguments.length>=2;return i=>i.pipe(n?Bl((r,s)=>n(r,s,i)):Bo,Ip(1),t?PE(e):i3(()=>new RE))}function Rp(n,e){return fn(e)?Zi(n,e,1):Zi(n,1)}function zr(n,e,t){const i=fn(n)||e||t?{next:n,error:e,complete:t}:n;return i?zn((r,s)=>{var o;null===(o=i.subscribe)||void 0===o||o.call(i);let a=!0;r.subscribe(Jn(s,l=>{var c;null===(c=i.next)||void 0===c||c.call(i,l),s.next(l)},()=>{var l;a=!1,null===(l=i.complete)||void 0===l||l.call(i),s.complete()},l=>{var c;a=!1,null===(c=i.error)||void 0===c||c.call(i,l),s.error(l)},()=>{var l,c;a&&(null===(l=i.unsubscribe)||void 0===l||l.call(i)),null===(c=i.finalize)||void 0===c||c.call(i)}))}):Bo}function kh(n){return zn((e,t)=>{let s,i=null,r=!1;i=e.subscribe(Jn(t,void 0,void 0,o=>{s=Qr(n(o,kh(n)(e))),i?(i.unsubscribe(),i=null,s.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,s.subscribe(t))})}function nD(n){return n<=0?()=>mo:zn((e,t)=>{let i=[];e.subscribe(Jn(t,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(const r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function Iy(n){return zn((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function r3(n){return zn((e,t)=>{Qr(n).subscribe(Jn(t,()=>t.complete(),bd)),!t.closed&&e.subscribe(t)})}const zt="primary",Ry=Symbol("RouteTitle");class FY{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function Pp(n){return new FY(n)}function kY(n,e,t){const i=t.path.split("/");if(i.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||i.length<n.length))return null;const r={};for(let s=0;s<i.length;s++){const o=i[s],a=n[s];if(o.startsWith(":"))r[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function qa(n,e){const t=n?Object.keys(n):void 0,i=e?Object.keys(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!s3(n[r],e[r]))return!1;return!0}function s3(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),i=[...e].sort();return t.every((r,s)=>i[s]===r)}return n===e}function o3(n){return n.length>0?n[n.length-1]:null}function lu(n){return function TY(n){return!!n&&(n instanceof Cn||fn(n.lift)&&fn(n.subscribe))}(n)?n:ey(n)?mi(Promise.resolve(n)):mt(n)}const BY={exact:function c3(n,e,t){if(!Uh(n.segments,e.segments)||!NE(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const i in e.children)if(!n.children[i]||!c3(n.children[i],e.children[i],t))return!1;return!0},subset:u3},a3={exact:function VY(n,e){return qa(n,e)},subset:function HY(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>s3(n[t],e[t]))},ignored:()=>!0};function l3(n,e,t){return BY[t.paths](n.root,e.root,t.matrixParams)&&a3[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function u3(n,e,t){return h3(n,e,e.segments,t)}function h3(n,e,t,i){if(n.segments.length>t.length){const r=n.segments.slice(0,t.length);return!(!Uh(r,t)||e.hasChildren()||!NE(r,t,i))}if(n.segments.length===t.length){if(!Uh(n.segments,t)||!NE(n.segments,t,i))return!1;for(const r in e.children)if(!n.children[r]||!u3(n.children[r],e.children[r],i))return!1;return!0}{const r=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!!(Uh(n.segments,r)&&NE(n.segments,r,i)&&n.children[zt])&&h3(n.children[zt],e,s,i)}}function NE(n,e,t){return e.every((i,r)=>a3[t](n[r].parameters,i.parameters))}class Np{constructor(e=new An([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Pp(this.queryParams)),this._queryParamMap}toString(){return WY.serialize(this)}}class An{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return LE(this)}}class Py{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=Pp(this.parameters)),this._parameterMap}toString(){return p3(this)}}function Uh(n,e){return n.length===e.length&&n.every((t,i)=>t.path===e[i].path)}let Ny=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Je({token:n,factory:function(){return new iD},providedIn:"root"})}return n})();class iD{parse(e){const t=new tK(e);return new Np(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${Ly(e.root,!0)}`,i=function qY(n){const e=Object.keys(n).map(t=>{const i=n[t];return Array.isArray(i)?i.map(r=>`${OE(t)}=${OE(r)}`).join("&"):`${OE(t)}=${OE(i)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${i}${"string"==typeof e.fragment?`#${function jY(n){return encodeURI(n)}(e.fragment)}`:""}`}}const WY=new iD;function LE(n){return n.segments.map(e=>p3(e)).join("/")}function Ly(n,e){if(!n.hasChildren())return LE(n);if(e){const t=n.children[zt]?Ly(n.children[zt],!1):"",i=[];return Object.entries(n.children).forEach(([r,s])=>{r!==zt&&i.push(`${r}:${Ly(s,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}{const t=function GY(n,e){let t=[];return Object.entries(n.children).forEach(([i,r])=>{i===zt&&(t=t.concat(e(r,i)))}),Object.entries(n.children).forEach(([i,r])=>{i!==zt&&(t=t.concat(e(r,i)))}),t}(n,(i,r)=>r===zt?[Ly(n.children[zt],!1)]:[`${r}:${Ly(i,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[zt]?`${LE(n)}/${t[0]}`:`${LE(n)}/(${t.join("//")})`}}function d3(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function OE(n){return d3(n).replace(/%3B/gi,";")}function rD(n){return d3(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function FE(n){return decodeURIComponent(n)}function f3(n){return FE(n.replace(/\+/g,"%20"))}function p3(n){return`${rD(n.path)}${function $Y(n){return Object.keys(n).map(e=>`;${rD(e)}=${rD(n[e])}`).join("")}(n.parameters)}`}const XY=/^[^\/()?;#]+/;function sD(n){const e=n.match(XY);return e?e[0]:""}const YY=/^[^\/()?;=#]+/,ZY=/^[^=?&#]+/,QY=/^[^&#]+/;class tK{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new An([],{}):new An([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[zt]=new An(e,t)),i}parseSegment(){const e=sD(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new ae(4009,!1);return this.capture(e),new Py(FE(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=function KY(n){const e=n.match(YY);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const r=sD(this.remaining);r&&(i=r,this.capture(i))}e[FE(t)]=FE(i)}parseQueryParam(e){const t=function JY(n){const e=n.match(ZY);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const o=function eK(n){const e=n.match(QY);return e?e[0]:""}(this.remaining);o&&(i=o,this.capture(i))}const r=f3(t),s=f3(i);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=sD(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new ae(4010,!1);let s;i.indexOf(":")>-1?(s=i.slice(0,i.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=zt);const o=this.parseChildren();t[s]=1===Object.keys(o).length?o[zt]:new An([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new ae(4011,!1)}}function m3(n){return n.segments.length>0?new An([],{[zt]:n}):n}function g3(n){const e={};for(const i of Object.keys(n.children)){const s=g3(n.children[i]);if(i===zt&&0===s.segments.length&&s.hasChildren())for(const[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[i]=s)}return function nK(n){if(1===n.numberOfChildren&&n.children[zt]){const e=n.children[zt];return new An(n.segments.concat(e.segments),e.children)}return n}(new An(n.segments,e))}function Bh(n){return n instanceof Np}function _3(n){let e;const r=m3(function t(s){const o={};for(const l of s.children){const c=t(l);o[l.outlet]=c}const a=new An(s.url,o);return s===n&&(e=a),a}(n.root));return e??r}function y3(n,e,t,i){let r=n;for(;r.parent;)r=r.parent;if(0===e.length)return oD(r,r,r,t,i);const s=function rK(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new w3(!0,0,n);let e=0,t=!1;const i=n.reduce((r,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return Object.entries(s.outlets).forEach(([l,c])=>{a[l]="string"==typeof c?c.split("/"):c}),[...r,{outlets:a}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===o?(s.split("/").forEach((a,l)=>{0==l&&"."===a||(0==l&&""===a?t=!0:".."===a?e++:""!=a&&r.push(a))}),r):[...r,s]},[]);return new w3(t,e,i)}(e);if(s.toRoot())return oD(r,r,new An([],{}),t,i);const o=function sK(n,e,t){if(n.isAbsolute)return new UE(e,!0,0);if(!t)return new UE(e,!1,NaN);if(null===t.parent)return new UE(t,!0,0);const i=kE(n.commands[0])?0:1;return function oK(n,e,t){let i=n,r=e,s=t;for(;s>r;){if(s-=r,i=i.parent,!i)throw new ae(4005,!1);r=i.segments.length}return new UE(i,!1,r-s)}(t,t.segments.length-1+i,n.numberOfDoubleDots)}(s,r,n),a=o.processChildren?Fy(o.segmentGroup,o.index,s.commands):b3(o.segmentGroup,o.index,s.commands);return oD(r,o.segmentGroup,a,t,i)}function kE(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function Oy(n){return"object"==typeof n&&null!=n&&n.outlets}function oD(n,e,t,i,r){let o,s={};i&&Object.entries(i).forEach(([l,c])=>{s[l]=Array.isArray(c)?c.map(h=>`${h}`):`${c}`}),o=n===e?t:v3(n,e,t);const a=m3(g3(o));return new Np(a,s,r)}function v3(n,e,t){const i={};return Object.entries(n.children).forEach(([r,s])=>{i[r]=s===e?t:v3(s,e,t)}),new An(n.segments,i)}class w3{constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&kE(i[0]))throw new ae(4003,!1);const r=i.find(Oy);if(r&&r!==o3(i))throw new ae(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class UE{constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}}function b3(n,e,t){if(n||(n=new An([],{})),0===n.segments.length&&n.hasChildren())return Fy(n,e,t);const i=function lK(n,e,t){let i=0,r=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return s;const o=n.segments[r],a=t[i];if(Oy(a))break;const l=`${a}`,c=i<t.length-1?t[i+1]:null;if(r>0&&void 0===l)break;if(l&&c&&"object"==typeof c&&void 0===c.outlets){if(!S3(l,c,o))return s;i+=2}else{if(!S3(l,{},o))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){const s=new An(n.segments.slice(0,i.pathIndex),{});return s.children[zt]=new An(n.segments.slice(i.pathIndex),n.children),Fy(s,0,r)}return i.match&&0===r.length?new An(n.segments,{}):i.match&&!n.hasChildren()?aD(n,e,t):i.match?Fy(n,0,r):aD(n,e,t)}function Fy(n,e,t){if(0===t.length)return new An(n.segments,{});{const i=function aK(n){return Oy(n[0])?n[0].outlets:{[zt]:n}}(t),r={};if(Object.keys(i).some(s=>s!==zt)&&n.children[zt]&&1===n.numberOfChildren&&0===n.children[zt].segments.length){const s=Fy(n.children[zt],e,t);return new An(n.segments,s.children)}return Object.entries(i).forEach(([s,o])=>{"string"==typeof o&&(o=[o]),null!==o&&(r[s]=b3(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{void 0===i[s]&&(r[s]=o)}),new An(n.segments,r)}}function aD(n,e,t){const i=n.segments.slice(0,e);let r=0;for(;r<t.length;){const s=t[r];if(Oy(s)){const l=cK(s.outlets);return new An(i,l)}if(0===r&&kE(t[0])){i.push(new Py(n.segments[e].path,E3(t[0]))),r++;continue}const o=Oy(s)?s.outlets[zt]:`${s}`,a=r<t.length-1?t[r+1]:null;o&&a&&kE(a)?(i.push(new Py(o,E3(a))),r+=2):(i.push(new Py(o,{})),r++)}return new An(i,{})}function cK(n){const e={};return Object.entries(n).forEach(([t,i])=>{"string"==typeof i&&(i=[i]),null!==i&&(e[t]=aD(new An([],{}),0,i))}),e}function E3(n){const e={};return Object.entries(n).forEach(([t,i])=>e[t]=`${i}`),e}function S3(n,e,t){return n==t.path&&qa(e,t.parameters)}const ky="imperative";class Xa{constructor(e,t){this.id=e,this.url=t}}class BE extends Xa{constructor(e,t,i="imperative",r=null){super(e,t),this.type=0,this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class cu extends Xa{constructor(e,t,i){super(e,t),this.urlAfterRedirects=i,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Uy extends Xa{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Lp extends Xa{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=16}}class VE extends Xa{constructor(e,t,i,r){super(e,t),this.error=i,this.target=r,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class C3 extends Xa{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class uK extends Xa{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class hK extends Xa{constructor(e,t,i,r,s){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class dK extends Xa{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class fK extends Xa{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class pK{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class mK{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class gK{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class _K{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class yK{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class vK{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class x3{constructor(e,t,i){this.routerEvent=e,this.position=t,this.anchor=i,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class lD{}class cD{constructor(e){this.url=e}}class wK{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new By,this.attachRef=null}}let By=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(t,i){const r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){const i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new wK,this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class M3{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=uD(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){const t=uD(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=hD(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return hD(e,this._root).map(t=>t.value)}}function uD(n,e){if(n===e.value)return e;for(const t of e.children){const i=uD(n,t);if(i)return i}return null}function hD(n,e){if(n===e.value)return[e];for(const t of e.children){const i=hD(n,t);if(i.length)return i.unshift(e),i}return[]}class Vl{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function Op(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class T3 extends M3{constructor(e,t){super(e),this.snapshot=t,dD(this,e)}toString(){return this.snapshot.toString()}}function A3(n,e){const t=function bK(n,e){const o=new HE([],{},{},"",{},zt,e,null,{});return new I3("",new Vl(o,[]))}(0,e),i=new Pr([new Py("",{})]),r=new Pr({}),s=new Pr({}),o=new Pr({}),a=new Pr(""),l=new Hl(i,r,o,a,s,zt,e,t.root);return l.snapshot=t.root,new T3(new Vl(l,[]),t)}class Hl{constructor(e,t,i,r,s,o,a,l){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(Jt(c=>c[Ry]))??mt(void 0),this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(Jt(e=>Pp(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Jt(e=>Pp(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function D3(n,e="emptyOnly"){const t=n.pathFromRoot;let i=0;if("always"!==e)for(i=t.length-1;i>=1;){const r=t[i],s=t[i-1];if(r.routeConfig&&""===r.routeConfig.path)i--;else{if(s.component)break;i--}}return function EK(n){return n.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(i))}class HE{get title(){return this.data?.[Ry]}constructor(e,t,i,r,s,o,a,l,c){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.routeConfig=l,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Pp(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Pp(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class I3 extends M3{constructor(e,t){super(t),this.url=e,dD(this,t)}toString(){return R3(this._root)}}function dD(n,e){e.value._routerState=n,e.children.forEach(t=>dD(n,t))}function R3(n){const e=n.children.length>0?` { ${n.children.map(R3).join(", ")} } `:"";return`${n.value}${e}`}function fD(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,qa(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),qa(e.params,t.params)||n.paramsSubject.next(t.params),function UY(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!qa(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.urlSubject.next(t.url),qa(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function pD(n,e){const t=qa(n.params,e.params)&&function zY(n,e){return Uh(n,e)&&n.every((t,i)=>qa(t.parameters,e[i].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||pD(n.parent,e.parent))}let mD=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=zt,this.activateEvents=new qn,this.deactivateEvents=new qn,this.attachEvents=new qn,this.detachEvents=new qn,this.parentContexts=ze(By),this.location=ze(sa),this.changeDetector=ze(fy),this.environmentInjector=ze(cs),this.inputBinder=ze(zE,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){const{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ae(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ae(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ae(4012,!1);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new ae(4013,!1);this._activatedRoute=t;const r=this.location,o=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,l=new SK(t,a,r.injector);this.activated=r.createComponent(o,{index:r.length,injector:l,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275dir=pt({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Hi]})}return n})();class SK{constructor(e,t,i){this.route=e,this.childContexts=t,this.parent=i}get(e,t){return e===Hl?this.route:e===By?this.childContexts:this.parent.get(e,t)}}const zE=new Ye("");let P3=(()=>{class n{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){const{activatedRoute:i}=t,r=Q1([i.queryParams,i.params,i.data]).pipe(Es(([s,o,a],l)=>(a={...s,...o,...a},0===l?mt(a):Promise.resolve(a)))).subscribe(s=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==i||null===i.component)return void this.unsubscribeFromRouteData(t);const o=function n$(n){const e=Yt(n);if(!e)return null;const t=new Y_(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}(i.component);if(o)for(const{templateName:a}of o.inputs)t.activatedComponentRef.setInput(a,s[a]);else this.unsubscribeFromRouteData(t)});this.outletDataSubscriptions.set(t,r)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Je({token:n,factory:n.\u0275fac})}return n})();function Vy(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const i=t.value;i._futureSnapshot=e.value;const r=function xK(n,e,t){return e.children.map(i=>{for(const r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return Vy(n,i,r);return Vy(n,i)})}(n,e,t);return new Vl(i,r)}{if(n.shouldAttach(e.value)){const s=n.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Vy(n,a)),o}}const i=function MK(n){return new Hl(new Pr(n.url),new Pr(n.params),new Pr(n.queryParams),new Pr(n.fragment),new Pr(n.data),n.outlet,n.component,n)}(e.value),r=e.children.map(s=>Vy(n,s));return new Vl(i,r)}}const gD="ngNavigationCancelingError";function N3(n,e){const{redirectTo:t,navigationBehaviorOptions:i}=Bh(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=L3(!1,0,e);return r.url=t,r.navigationBehaviorOptions=i,r}function L3(n,e,t){const i=new Error("NavigationCancelingError: "+(n||""));return i[gD]=!0,i.cancellationCode=e,t&&(i.url=t),i}function O3(n){return n&&n[gD]}let F3=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=Ji({type:n,selectors:[["ng-component"]],standalone:!0,features:[ly],decls:1,vars:0,template:function(i,r){1&i&&Br(0,"router-outlet")},dependencies:[mD],encapsulation:2})}return n})();function _D(n){const e=n.children&&n.children.map(_D),t=e?{...n,children:e}:{...n};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==zt&&(t.component=F3),t}function ua(n){return n.outlet||zt}function Hy(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class LK{constructor(e,t,i,r,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=s}activate(e){const t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),fD(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){const r=Op(t);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,r[o],i),delete r[o]}),Object.values(r).forEach(s=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(r===s)if(r.component){const o=i.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,i);else s&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=Op(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);if(i&&i.outlet){const o=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=Op(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(e,t,i){const r=Op(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new vK(s.value.snapshot))}),e.children.length&&this.forwardEvent(new _K(e.value.snapshot))}activateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(fD(r),r===s)if(r.component){const o=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,i);else if(r.component){const o=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),fD(a.route.value),this.activateChildRoutes(e,null,o.children)}else{const a=Hy(r.snapshot);o.attachRef=null,o.route=r,o.injector=a,o.outlet&&o.outlet.activateWith(r,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,i)}}class k3{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class GE{constructor(e,t){this.component=e,this.route=t}}function OK(n,e,t){const i=n._root;return zy(i,e?e._root:null,t,[i.value])}function Fp(n,e){const t=Symbol(),i=e.get(n,t);return i===t?"function"!=typeof n||function p0(n){return null!==va(n)}(n)?e.get(n):n:i}function zy(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=Op(e);return n.children.forEach(o=>{(function kK(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const l=function UK(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!Uh(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Uh(n.url,e.url)||!qa(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!pD(n,e)||!qa(n.queryParams,e.queryParams);default:return!pD(n,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new k3(i)):(s.data=o.data,s._resolvedData=o._resolvedData),zy(n,e,s.component?a?a.children:null:t,i,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new GE(a.outlet.component,o))}else o&&Gy(e,a,r),r.canActivateChecks.push(new k3(i)),zy(n,null,s.component?a?a.children:null:t,i,r)})(o,s[o.value.outlet],t,i.concat([o.value]),r),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>Gy(a,t.getContext(o),r)),r}function Gy(n,e,t){const i=Op(n),r=n.value;Object.entries(i).forEach(([s,o])=>{Gy(o,r.component?e?e.children.getContext(s):null:e,t)}),t.canDeactivateChecks.push(new GE(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}function Wy(n){return"function"==typeof n}function U3(n){return n instanceof RE||"EmptyError"===n?.name}const WE=Symbol("INITIAL_VALUE");function kp(){return Es(n=>Q1(n.map(e=>e.pipe(Ip(1),function IY(...n){const e=Lu(n);return zn((t,i)=>{(e?eD(n,t,e):eD(n,t)).subscribe(i)})}(WE)))).pipe(Jt(e=>{for(const t of e)if(!0!==t){if(t===WE)return WE;if(!1===t||t instanceof Np)return t}return!0}),Bl(e=>e!==WE),Ip(1)))}function B3(n){return function zC(...n){return jv(n)}(zr(e=>{if(Bh(e))throw N3(0,e)}),Jt(e=>!0===e))}class jE{constructor(e){this.segmentGroup=e||null}}class V3{constructor(e){this.urlTree=e}}function Up(n){return Dy(new jE(n))}function H3(n){return Dy(new V3(n))}class rZ{constructor(e,t){this.urlSerializer=e,this.urlTree=t}noMatchError(e){return new ae(4002,!1)}lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return mt(i);if(r.numberOfChildren>1||!r.children[zt])return Dy(new ae(4e3,!1));r=r.children[zt]}}applyRedirectCommands(e,t,i){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,i)}applyRedirectCreateUrlTree(e,t,i,r){const s=this.createSegmentGroup(e,t.root,i,r);return new Np(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const i={};return Object.entries(e).forEach(([r,s])=>{if("string"==typeof s&&s.startsWith(":")){const a=s.substring(1);i[r]=t[a]}else i[r]=s}),i}createSegmentGroup(e,t,i,r){const s=this.createSegments(e,t.segments,i,r);let o={};return Object.entries(t.children).forEach(([a,l])=>{o[a]=this.createSegmentGroup(e,l,i,r)}),new An(s,o)}createSegments(e,t,i,r){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,r):this.findOrReturn(s,i))}findPosParam(e,t,i){const r=i[t.path.substring(1)];if(!r)throw new ae(4001,!1);return r}findOrReturn(e,t){let i=0;for(const r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}}const yD={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function sZ(n,e,t,i,r){const s=vD(n,e,t);return s.matched?(i=function AK(n,e){return n.providers&&!n._injector&&(n._injector=tA(n.providers,e,`Route: ${n.path}`)),n._injector??e}(e,i),function tZ(n,e,t,i){const r=e.canMatch;return r&&0!==r.length?mt(r.map(o=>{const a=Fp(o,n);return lu(function WK(n){return n&&Wy(n.canMatch)}(a)?a.canMatch(e,t):n.runInContext(()=>a(e,t)))})).pipe(kp(),B3()):mt(!0)}(i,e,t).pipe(Jt(o=>!0===o?s:{...yD}))):mt(s)}function vD(n,e,t){if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?{...yD}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const r=(e.matcher||kY)(t,n,e);if(!r)return{...yD};const s={};Object.entries(r.posParams??{}).forEach(([a,l])=>{s[a]=l.path});const o=r.consumed.length>0?{...s,...r.consumed[r.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:o,positionalParamSegments:r.posParams??{}}}function z3(n,e,t,i){return t.length>0&&function lZ(n,e,t){return t.some(i=>$E(n,e,i)&&ua(i)!==zt)}(n,t,i)?{segmentGroup:new An(e,aZ(i,new An(t,n.children))),slicedSegments:[]}:0===t.length&&function cZ(n,e,t){return t.some(i=>$E(n,e,i))}(n,t,i)?{segmentGroup:new An(n.segments,oZ(n,0,t,i,n.children)),slicedSegments:t}:{segmentGroup:new An(n.segments,n.children),slicedSegments:t}}function oZ(n,e,t,i,r){const s={};for(const o of i)if($E(n,t,o)&&!r[ua(o)]){const a=new An([],{});s[ua(o)]=a}return{...r,...s}}function aZ(n,e){const t={};t[zt]=e;for(const i of n)if(""===i.path&&ua(i)!==zt){const r=new An([],{});t[ua(i)]=r}return t}function $E(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}class fZ{constructor(e,t,i,r,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=i,this.config=r,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.allowRedirects=!0,this.applyRedirects=new rZ(this.urlSerializer,this.urlTree)}noMatchError(e){return new ae(4002,!1)}recognize(){const e=z3(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,zt).pipe(kh(t=>{if(t instanceof V3)return this.allowRedirects=!1,this.urlTree=t.urlTree,this.match(t.urlTree);throw t instanceof jE?this.noMatchError(t):t}),Jt(t=>{const i=new HE([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},zt,this.rootComponentType,null,{}),r=new Vl(i,t),s=new I3("",r),o=function iK(n,e,t=null,i=null){return y3(_3(n),e,t,i)}(i,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e.root,zt).pipe(kh(i=>{throw i instanceof jE?this.noMatchError(i):i}))}inheritParamsAndData(e){const t=e.value,i=D3(t,this.paramsInheritanceStrategy);t.params=Object.freeze(i.params),t.data=Object.freeze(i.data),e.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(e,t,i,r){return 0===i.segments.length&&i.hasChildren()?this.processChildren(e,t,i):this.processSegment(e,t,i,i.segments,r,!0)}processChildren(e,t,i){const r=[];for(const s of Object.keys(i.children))"primary"===s?r.unshift(s):r.push(s);return mi(r).pipe(Rp(s=>{const o=i.children[s],a=function PK(n,e){const t=n.filter(i=>ua(i)===e);return t.push(...n.filter(i=>ua(i)!==e)),t}(t,s);return this.processSegmentGroup(e,a,o,s)}),function NY(n,e){return zn(function PY(n,e,t,i,r){return(s,o)=>{let a=t,l=e,c=0;s.subscribe(Jn(o,h=>{const d=c++;l=a?n(l,h,d):(a=!0,h),i&&o.next(l)},r&&(()=>{a&&o.next(l),o.complete()})))}}(n,e,arguments.length>=2,!0))}((s,o)=>(s.push(...o),s)),PE(null),function LY(n,e){const t=arguments.length>=2;return i=>i.pipe(n?Bl((r,s)=>n(r,s,i)):Bo,nD(1),t?PE(e):i3(()=>new RE))}(),Zi(s=>{if(null===s)return Up(i);const o=G3(s);return function pZ(n){n.sort((e,t)=>e.value.outlet===zt?-1:t.value.outlet===zt?1:e.value.outlet.localeCompare(t.value.outlet))}(o),mt(o)}))}processSegment(e,t,i,r,s,o){return mi(t).pipe(Rp(a=>this.processSegmentAgainstRoute(a._injector??e,t,a,i,r,s,o).pipe(kh(l=>{if(l instanceof jE)return mt(null);throw l}))),Fh(a=>!!a),kh(a=>{if(U3(a))return function hZ(n,e,t){return 0===e.length&&!n.children[t]}(i,r,s)?mt([]):Up(i);throw a}))}processSegmentAgainstRoute(e,t,i,r,s,o,a){return function uZ(n,e,t,i){return!!(ua(n)===i||i!==zt&&$E(e,t,n))&&("**"===n.path||vD(e,n,t).matched)}(i,r,s,o)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(e,r,i,s,o,a):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,r,t,i,s,o):Up(r):Up(r)}expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,i,r,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,i,r){const s=this.applyRedirects.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?H3(s):this.applyRedirects.lineralizeSegments(i,s).pipe(Zi(o=>{const a=new An(o,{});return this.processSegment(e,t,a,o,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o){const{matched:a,consumedSegments:l,remainingSegments:c,positionalParamSegments:h}=vD(t,r,s);if(!a)return Up(t);const d=this.applyRedirects.applyRedirectCommands(l,r.redirectTo,h);return r.redirectTo.startsWith("/")?H3(d):this.applyRedirects.lineralizeSegments(r,d).pipe(Zi(p=>this.processSegment(e,i,t,p.concat(c),o,!1)))}matchSegmentAgainstRoute(e,t,i,r,s,o){let a;if("**"===i.path){const l=r.length>0?o3(r).parameters:{};a=mt({snapshot:new HE(r,l,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,W3(i),ua(i),i.component??i._loadedComponent??null,i,j3(i)),consumedSegments:[],remainingSegments:[]}),t.children={}}else a=sZ(t,i,r,e).pipe(Jt(({matched:l,consumedSegments:c,remainingSegments:h,parameters:d})=>l?{snapshot:new HE(c,d,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,W3(i),ua(i),i.component??i._loadedComponent??null,i,j3(i)),consumedSegments:c,remainingSegments:h}:null));return a.pipe(Es(l=>null===l?Up(t):this.getChildConfig(e=i._injector??e,i,r).pipe(Es(({routes:c})=>{const h=i._loadedInjector??e,{snapshot:d,consumedSegments:p,remainingSegments:m}=l,{segmentGroup:g,slicedSegments:v}=z3(t,p,m,c);if(0===v.length&&g.hasChildren())return this.processChildren(h,c,g).pipe(Jt(y=>null===y?null:[new Vl(d,y)]));if(0===c.length&&0===v.length)return mt([new Vl(d,[])]);const w=ua(i)===s;return this.processSegment(h,c,g,v,w?zt:s,!0).pipe(Jt(y=>[new Vl(d,y)]))}))))}getChildConfig(e,t,i){return t.children?mt({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?mt({routes:t._loadedRoutes,injector:t._loadedInjector}):function eZ(n,e,t,i){const r=e.canLoad;return void 0===r||0===r.length?mt(!0):mt(r.map(o=>{const a=Fp(o,n);return lu(function VK(n){return n&&Wy(n.canLoad)}(a)?a.canLoad(e,t):n.runInContext(()=>a(e,t)))})).pipe(kp(),B3())}(e,t,i).pipe(Zi(r=>r?this.configLoader.loadChildren(e,t).pipe(zr(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):function iZ(n){return Dy(L3(!1,3))}())):mt({routes:[],injector:e})}}function mZ(n){const e=n.value.routeConfig;return e&&""===e.path}function G3(n){const e=[],t=new Set;for(const i of n){if(!mZ(i)){e.push(i);continue}const r=e.find(s=>i.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...i.children),t.add(r)):e.push(i)}for(const i of t){const r=G3(i.children);e.push(new Vl(i.value,r))}return e.filter(i=>!t.has(i))}function W3(n){return n.data||{}}function j3(n){return n.resolve||{}}function $3(n){return"string"==typeof n.title||null===n.title}function wD(n){return Es(e=>{const t=n(e);return t?mi(t).pipe(Jt(()=>e)):mt(e)})}const Bp=new Ye("ROUTES");let bD=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=ze(H2)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return mt(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const i=lu(t.loadComponent()).pipe(Jt(q3),zr(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),Iy(()=>{this.componentLoaders.delete(t)})),r=new n3(i,()=>new Jr).pipe(tD());return this.componentLoaders.set(t,r),r}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return mt({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const s=function EZ(n,e,t,i){return lu(n.loadChildren()).pipe(Jt(q3),Zi(r=>r instanceof YO||Array.isArray(r)?mt(r):mi(e.compileModuleAsync(r))),Jt(r=>{i&&i(n);let s,o,a=!1;return Array.isArray(r)?(o=r,!0):(s=r.create(t).injector,o=s.get(Bp,[],{optional:!0,self:!0}).flat()),{routes:o.map(_D),injector:s}}))}(i,this.compiler,t,this.onLoadEndListener).pipe(Iy(()=>{this.childrenLoaders.delete(i)})),o=new n3(s,()=>new Jr).pipe(tD());return this.childrenLoaders.set(i,o),o}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function q3(n){return function SZ(n){return n&&"object"==typeof n&&"default"in n}(n)?n.default:n}let qE=(()=>{class n{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Jr,this.transitionAbortSubject=new Jr,this.configLoader=ze(bD),this.environmentInjector=ze(cs),this.urlSerializer=ze(Ny),this.rootContexts=ze(By),this.inputBindingEnabled=null!==ze(zE,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>mt(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=r=>this.events.next(new mK(r)),this.configLoader.onLoadStartListener=r=>this.events.next(new pK(r))}complete(){this.transitions?.complete()}handleNavigationRequest(t){const i=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:i})}setupNavigations(t,i,r){return this.transitions=new Pr({id:0,currentUrlTree:i,currentRawUrl:i,currentBrowserUrl:i,extractedUrl:t.urlHandlingStrategy.extract(i),urlAfterRedirects:t.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:ky,restoredState:null,currentSnapshot:r.snapshot,targetSnapshot:null,currentRouterState:r,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Bl(s=>0!==s.id),Jt(s=>({...s,extractedUrl:t.urlHandlingStrategy.extract(s.rawUrl)})),Es(s=>{this.currentTransition=s;let o=!1,a=!1;return mt(s).pipe(zr(l=>{this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),Es(l=>{const c=l.currentBrowserUrl.toString(),h=!t.navigated||l.extractedUrl.toString()!==c||c!==l.currentUrlTree.toString();if(!h&&"reload"!==(l.extras.onSameUrlNavigation??t.onSameUrlNavigation)){const p="";return this.events.next(new Lp(l.id,this.urlSerializer.serialize(l.rawUrl),p,0)),l.resolve(null),mo}if(t.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return mt(l).pipe(Es(p=>{const m=this.transitions?.getValue();return this.events.next(new BE(p.id,this.urlSerializer.serialize(p.extractedUrl),p.source,p.restoredState)),m!==this.transitions?.getValue()?mo:Promise.resolve(p)}),function gZ(n,e,t,i,r,s){return Zi(o=>function dZ(n,e,t,i,r,s,o="emptyOnly"){return new fZ(n,e,t,i,r,o,s).recognize()}(n,e,t,i,o.extractedUrl,r,s).pipe(Jt(({state:a,tree:l})=>({...o,targetSnapshot:a,urlAfterRedirects:l}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,t.paramsInheritanceStrategy),zr(p=>{s.targetSnapshot=p.targetSnapshot,s.urlAfterRedirects=p.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:p.urlAfterRedirects};const m=new C3(p.id,this.urlSerializer.serialize(p.extractedUrl),this.urlSerializer.serialize(p.urlAfterRedirects),p.targetSnapshot);this.events.next(m)}));if(h&&t.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){const{id:p,extractedUrl:m,source:g,restoredState:v,extras:w}=l,y=new BE(p,this.urlSerializer.serialize(m),g,v);this.events.next(y);const b=A3(0,this.rootComponentType).snapshot;return this.currentTransition=s={...l,targetSnapshot:b,urlAfterRedirects:m,extras:{...w,skipLocationChange:!1,replaceUrl:!1}},mt(s)}{const p="";return this.events.next(new Lp(l.id,this.urlSerializer.serialize(l.extractedUrl),p,1)),l.resolve(null),mo}}),zr(l=>{const c=new uK(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(c)}),Jt(l=>(this.currentTransition=s={...l,guards:OK(l.targetSnapshot,l.currentSnapshot,this.rootContexts)},s)),function $K(n,e){return Zi(t=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return 0===o.length&&0===s.length?mt({...t,guardsResult:!0}):function qK(n,e,t,i){return mi(n).pipe(Zi(r=>function QK(n,e,t,i,r){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?mt(s.map(a=>{const l=Hy(e)??r,c=Fp(a,l);return lu(function GK(n){return n&&Wy(n.canDeactivate)}(c)?c.canDeactivate(n,e,t,i):l.runInContext(()=>c(n,e,t,i))).pipe(Fh())})).pipe(kp()):mt(!0)}(r.component,r.route,t,e,i)),Fh(r=>!0!==r,!0))}(o,i,r,n).pipe(Zi(a=>a&&function BK(n){return"boolean"==typeof n}(a)?function XK(n,e,t,i){return mi(e).pipe(Rp(r=>eD(function KK(n,e){return null!==n&&e&&e(new gK(n)),mt(!0)}(r.route.parent,i),function YK(n,e){return null!==n&&e&&e(new yK(n)),mt(!0)}(r.route,i),function JK(n,e,t){const i=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function FK(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(o)).filter(o=>null!==o).map(o=>t3(()=>mt(o.guards.map(l=>{const c=Hy(o.node)??t,h=Fp(l,c);return lu(function zK(n){return n&&Wy(n.canActivateChild)}(h)?h.canActivateChild(i,n):c.runInContext(()=>h(i,n))).pipe(Fh())})).pipe(kp())));return mt(s).pipe(kp())}(n,r.path,t),function ZK(n,e,t){const i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||0===i.length)return mt(!0);const r=i.map(s=>t3(()=>{const o=Hy(e)??t,a=Fp(s,o);return lu(function HK(n){return n&&Wy(n.canActivate)}(a)?a.canActivate(e,n):o.runInContext(()=>a(e,n))).pipe(Fh())}));return mt(r).pipe(kp())}(n,r.route,t))),Fh(r=>!0!==r,!0))}(i,s,n,e):mt(a)),Jt(a=>({...t,guardsResult:a})))})}(this.environmentInjector,l=>this.events.next(l)),zr(l=>{if(s.guardsResult=l.guardsResult,Bh(l.guardsResult))throw N3(0,l.guardsResult);const c=new hK(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(c)}),Bl(l=>!!l.guardsResult||(this.cancelNavigationTransition(l,"",3),!1)),wD(l=>{if(l.guards.canActivateChecks.length)return mt(l).pipe(zr(c=>{const h=new dK(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(h)}),Es(c=>{let h=!1;return mt(c).pipe(function _Z(n,e){return Zi(t=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return mt(t);let s=0;return mi(r).pipe(Rp(o=>function yZ(n,e,t,i){const r=n.routeConfig,s=n._resolve;return void 0!==r?.title&&!$3(r)&&(s[Ry]=r.title),function vZ(n,e,t,i){const r=function wZ(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===r.length)return mt({});const s={};return mi(r).pipe(Zi(o=>function bZ(n,e,t,i){const r=Hy(e)??i,s=Fp(n,r);return lu(s.resolve?s.resolve(e,t):r.runInContext(()=>s(e,t)))}(n[o],e,t,i).pipe(Fh(),zr(a=>{s[o]=a}))),nD(1),function OY(n){return Jt(()=>n)}(s),kh(o=>U3(o)?mo:Dy(o)))}(s,n,e,i).pipe(Jt(o=>(n._resolvedData=o,n.data=D3(n,t).resolve,r&&$3(r)&&(n.data[Ry]=r.title),null)))}(o.route,i,n,e)),zr(()=>s++),nD(1),Zi(o=>s===r.length?mt(t):mo))})}(t.paramsInheritanceStrategy,this.environmentInjector),zr({next:()=>h=!0,complete:()=>{h||this.cancelNavigationTransition(c,"",2)}}))}),zr(c=>{const h=new fK(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(h)}))}),wD(l=>{const c=h=>{const d=[];h.routeConfig?.loadComponent&&!h.routeConfig._loadedComponent&&d.push(this.configLoader.loadComponent(h.routeConfig).pipe(zr(p=>{h.component=p}),Jt(()=>{})));for(const p of h.children)d.push(...c(p));return d};return Q1(c(l.targetSnapshot.root)).pipe(PE(),Ip(1))}),wD(()=>this.afterPreactivation()),Jt(l=>{const c=function CK(n,e,t){const i=Vy(n,e._root,t?t._root:void 0);return new T3(i,e)}(t.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=s={...l,targetRouterState:c},s}),zr(()=>{this.events.next(new lD)}),((n,e,t,i)=>Jt(r=>(new LK(e,r.targetRouterState,r.currentRouterState,t,i).activate(n),r)))(this.rootContexts,t.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),Ip(1),zr({next:l=>{o=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new cu(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),t.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{o=!0}}),r3(this.transitionAbortSubject.pipe(zr(l=>{throw l}))),Iy(()=>{o||a||this.cancelNavigationTransition(s,"",1),this.currentNavigation?.id===s.id&&(this.currentNavigation=null)}),kh(l=>{if(a=!0,O3(l))this.events.next(new Uy(s.id,this.urlSerializer.serialize(s.extractedUrl),l.message,l.cancellationCode)),function TK(n){return O3(n)&&Bh(n.url)}(l)?this.events.next(new cD(l.url)):s.resolve(!1);else{this.events.next(new VE(s.id,this.urlSerializer.serialize(s.extractedUrl),l,s.targetSnapshot??void 0));try{s.resolve(t.errorHandler(l))}catch(c){s.reject(c)}}return mo}))}))}cancelNavigationTransition(t,i,r){const s=new Uy(t.id,this.urlSerializer.serialize(t.extractedUrl),i,r);this.events.next(s),t.resolve(!1)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function X3(n){return n!==ky}let Y3=(()=>{class n{buildTitle(t){let i,r=t.root;for(;void 0!==r;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(s=>s.outlet===zt);return i}getResolvedTitleForRoute(t){return t.data[Ry]}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Je({token:n,factory:function(){return ze(CZ)},providedIn:"root"})}return n})(),CZ=(()=>{class n extends Y3{constructor(t){super(),this.title=t}updateTitle(t){const i=this.buildTitle(t);void 0!==i&&this.title.setTitle(i)}static#e=this.\u0275fac=function(i){return new(i||n)(Oe(a1))};static#t=this.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),xZ=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Je({token:n,factory:function(){return ze(TZ)},providedIn:"root"})}return n})();class MZ{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let TZ=(()=>{class n extends MZ{static#e=this.\u0275fac=function(){let t;return function(r){return(t||(t=gi(n)))(r||n)}}();static#t=this.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const XE=new Ye("",{providedIn:"root",factory:()=>({})});let AZ=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Je({token:n,factory:function(){return ze(DZ)},providedIn:"root"})}return n})(),DZ=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var jy=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(jy||{});function K3(n,e){n.events.pipe(Bl(t=>t instanceof cu||t instanceof Uy||t instanceof VE||t instanceof Lp),Jt(t=>t instanceof cu||t instanceof Lp?jy.COMPLETE:t instanceof Uy&&(0===t.code||1===t.code)?jy.REDIRECTING:jy.FAILED),Bl(t=>t!==jy.REDIRECTING),Ip(1)).subscribe(()=>{e()})}function IZ(n){throw n}function RZ(n,e,t){return e.parse("/")}const PZ={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},NZ={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Mr=(()=>{class n{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.location.getState()?.\u0275routerPageId??this.currentPageId}get events(){return this._events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=ze(V2),this.isNgZoneEnabled=!1,this._events=new Jr,this.options=ze(XE,{optional:!0})||{},this.pendingTasks=ze(kb),this.errorHandler=this.options.errorHandler||IZ,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||RZ,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=ze(AZ),this.routeReuseStrategy=ze(xZ),this.titleStrategy=ze(Y3),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=ze(Bp,{optional:!0})?.flat()??[],this.navigationTransitions=ze(qE),this.urlSerializer=ze(Ny),this.location=ze(LA),this.componentInputBindingEnabled=!!ze(zE,{optional:!0}),this.eventsSubscription=new Yr,this.isNgZoneEnabled=ze(Mn)instanceof Mn&&Mn.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new Np,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=A3(0,null),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe(t=>{this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const t=this.navigationTransitions.events.subscribe(i=>{try{const{currentTransition:r}=this.navigationTransitions;if(null===r)return void(Z3(i)&&this._events.next(i));if(i instanceof BE)X3(r.source)&&(this.browserUrlTree=r.extractedUrl);else if(i instanceof Lp)this.rawUrlTree=r.rawUrl;else if(i instanceof C3){if("eager"===this.urlUpdateStrategy){if(!r.extras.skipLocationChange){const s=this.urlHandlingStrategy.merge(r.urlAfterRedirects,r.rawUrl);this.setBrowserUrl(s,r)}this.browserUrlTree=r.urlAfterRedirects}}else if(i instanceof lD)this.currentUrlTree=r.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(r.urlAfterRedirects,r.rawUrl),this.routerState=r.targetRouterState,"deferred"===this.urlUpdateStrategy&&(r.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,r),this.browserUrlTree=r.urlAfterRedirects);else if(i instanceof Uy)0!==i.code&&1!==i.code&&(this.navigated=!0),(3===i.code||2===i.code)&&this.restoreHistory(r);else if(i instanceof cD){const s=this.urlHandlingStrategy.merge(i.url,r.currentRawUrl),o={skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||X3(r.source)};this.scheduleNavigation(s,ky,null,o,{resolve:r.resolve,reject:r.reject,promise:r.promise})}i instanceof VE&&this.restoreHistory(r,!0),i instanceof cu&&(this.navigated=!0),Z3(i)&&this._events.next(i)}catch(r){this.navigationTransitions.transitionAbortSubject.next(r)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const t=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),ky,t)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const i="popstate"===t.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{this.navigateToSyncWithBrowser(t.url,i,t.state)},0)}))}navigateToSyncWithBrowser(t,i,r){const s={replaceUrl:!0},o=r?.navigationId?r:null;if(r){const l={...r};delete l.navigationId,delete l.\u0275routerPageId,0!==Object.keys(l).length&&(s.state=l)}const a=this.parseUrl(t);this.scheduleNavigation(a,i,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(_D),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,i={}){const{relativeTo:r,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:l}=i,c=l?this.currentUrlTree.fragment:o;let d,h=null;switch(a){case"merge":h={...this.currentUrlTree.queryParams,...s};break;case"preserve":h=this.currentUrlTree.queryParams;break;default:h=s||null}null!==h&&(h=this.removeEmptyProps(h));try{d=_3(r?r.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof t[0]||!t[0].startsWith("/"))&&(t=[]),d=this.currentUrlTree.root}return y3(d,t,h,c??null)}navigateByUrl(t,i={skipLocationChange:!1}){const r=Bh(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,ky,null,i)}navigate(t,i={skipLocationChange:!1}){return function LZ(n){for(let e=0;e<n.length;e++)if(null==n[e])throw new ae(4008,!1)}(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let i;try{i=this.urlSerializer.parse(t)}catch(r){i=this.malformedUriErrorHandler(r,this.urlSerializer,t)}return i}isActive(t,i){let r;if(r=!0===i?{...PZ}:!1===i?{...NZ}:i,Bh(t))return l3(this.currentUrlTree,t,r);const s=this.parseUrl(t);return l3(this.currentUrlTree,s,r)}removeEmptyProps(t){return Object.keys(t).reduce((i,r)=>{const s=t[r];return null!=s&&(i[r]=s),i},{})}scheduleNavigation(t,i,r,s,o){if(this.disposed)return Promise.resolve(!1);let a,l,c;o?(a=o.resolve,l=o.reject,c=o.promise):c=new Promise((d,p)=>{a=d,l=p});const h=this.pendingTasks.add();return K3(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(h))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,currentBrowserUrl:this.browserUrlTree,rawUrl:t,extras:s,resolve:a,reject:l,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(d=>Promise.reject(d))}setBrowserUrl(t,i){const r=this.urlSerializer.serialize(t);if(this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl){const o={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId)};this.location.replaceState(r,"",o)}else{const s={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId+1)};this.location.go(r,"",s)}}restoreHistory(t,i=!1){if("computed"===this.canceledNavigationResolution){const s=this.currentPageId-this.browserPageId;0!==s?this.location.historyGo(s):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===s&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Z3(n){return!(n instanceof lD||n instanceof cD)}class J3{}let kZ=(()=>{class n{constructor(t,i,r,s,o){this.router=t,this.injector=r,this.preloadingStrategy=s,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(Bl(t=>t instanceof cu),Rp(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,i){const r=[];for(const s of i){s.providers&&!s._injector&&(s._injector=tA(s.providers,t,`Route: ${s.path}`));const o=s._injector??t,a=s._loadedInjector??o;(s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent)&&r.push(this.preloadConfig(o,s)),(s.children||s._loadedRoutes)&&r.push(this.processRoutes(a,s.children??s._loadedRoutes))}return mi(r).pipe(gc())}preloadConfig(t,i){return this.preloadingStrategy.preload(i,()=>{let r;r=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(t,i):mt(null);const s=r.pipe(Zi(o=>null===o?mt(void 0):(i._loadedRoutes=o.routes,i._loadedInjector=o.injector,this.processRoutes(o.injector??t,o.routes))));return i.loadComponent&&!i._loadedComponent?mi([s,this.loader.loadComponent(i)]).pipe(gc()):s})}static#e=this.\u0275fac=function(i){return new(i||n)(Oe(Mr),Oe(H2),Oe(cs),Oe(J3),Oe(bD))};static#t=this.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const SD=new Ye("");let Q3=(()=>{class n{constructor(t,i,r,s,o={}){this.urlSerializer=t,this.transitions=i,this.viewportScroller=r,this.zone=s,this.options=o,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},o.scrollPositionRestoration=o.scrollPositionRestoration||"disabled",o.anchorScrolling=o.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof BE?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof cu?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof Lp&&0===t.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof x3&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new x3(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static#e=this.\u0275fac=function(i){!function kN(){throw new Error("invalid")}()};static#t=this.\u0275prov=Je({token:n,factory:n.\u0275fac})}return n})();function zl(n,e){return{\u0275kind:n,\u0275providers:e}}function tB(){const n=ze(Zs);return e=>{const t=n.get(Ah);if(e!==t.components[0])return;const i=n.get(Mr),r=n.get(nB);1===n.get(CD)&&i.initialNavigation(),n.get(iB,null,$t.Optional)?.setUpPreloading(),n.get(SD,null,$t.Optional)?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}const nB=new Ye("",{factory:()=>new Jr}),CD=new Ye("",{providedIn:"root",factory:()=>1}),iB=new Ye("");function HZ(n){return zl(0,[{provide:iB,useExisting:kZ},{provide:J3,useExisting:n}])}const rB=new Ye("ROUTER_FORROOT_GUARD"),GZ=[LA,{provide:Ny,useClass:iD},Mr,By,{provide:Hl,useFactory:function eB(n){return n.routerState.root},deps:[Mr]},bD,[]];function WZ(){return new X2("Router",Mr)}let sB=(()=>{class n{constructor(t){}static forRoot(t,i){return{ngModule:n,providers:[GZ,[],{provide:Bp,multi:!0,useValue:t},{provide:rB,useFactory:XZ,deps:[[Mr,new Mf,new Tf]]},{provide:XE,useValue:i||{}},i?.useHash?{provide:Ih,useClass:a$}:{provide:Ih,useClass:CF},{provide:SD,useFactory:()=>{const n=ze(M9),e=ze(Mn),t=ze(XE),i=ze(qE),r=ze(Ny);return t.scrollOffset&&n.setOffset(t.scrollOffset),new Q3(r,i,n,e,t)}},i?.preloadingStrategy?HZ(i.preloadingStrategy).\u0275providers:[],{provide:X2,multi:!0,useFactory:WZ},i?.initialNavigation?YZ(i):[],i?.bindToComponentInputs?zl(8,[P3,{provide:zE,useExisting:P3}]).\u0275providers:[],[{provide:oB,useFactory:tB},{provide:CA,multi:!0,useExisting:oB}]]}}static forChild(t){return{ngModule:n,providers:[{provide:Bp,multi:!0,useValue:t}]}}static#e=this.\u0275fac=function(i){return new(i||n)(Oe(rB,8))};static#t=this.\u0275mod=ki({type:n});static#n=this.\u0275inj=Ti({})}return n})();function XZ(n){return"guarded"}function YZ(n){return["disabled"===n.initialNavigation?zl(3,[{provide:gA,multi:!0,useFactory:()=>{const e=ze(Mr);return()=>{e.setUpLocationChangeListener()}}},{provide:CD,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?zl(2,[{provide:CD,useValue:0},{provide:gA,multi:!0,deps:[Zs],useFactory:e=>{const t=e.get(s$,Promise.resolve());return()=>t.then(()=>new Promise(i=>{const r=e.get(Mr),s=e.get(nB);K3(r,()=>{i(!0)}),e.get(qE).afterPreactivation=()=>(i(!0),s.closed?mt(void 0):s),r.initialNavigation()}))}}]).\u0275providers:[]]}const oB=new Ye("");function aB(n,e,t,i,r,s,o){try{var a=n[s](o),l=a.value}catch(c){return void t(c)}a.done?e(l):Promise.resolve(l).then(i,r)}function Pn(n){return function(){var e=this,t=arguments;return new Promise(function(i,r){var s=n.apply(e,t);function o(l){aB(s,i,r,o,a,"next",l)}function a(l){aB(s,i,r,o,a,"throw",l)}o(void 0)})}}const cB=1,QZ=2,Gl=3,YE=0,vJ=1,wJ=2,hu=0,bJ=1,EJ=2,SJ=3,CJ=4,xJ=5,du=301,Vh=302,$y=306,Hh=1e3,Gr=1001,Li=1003,hi=1006,jl=1008,fu=1009,pu=1014,$l=1015,Yy=1016,zh=1020,Do=1023,Gh=1026,Wp=1027,Ky=2300,jp=2301,Wh=3001,di="srgb",Tr="srgb-linear",UD="display-p3",eS="display-p3-linear",tS="linear",ni="srgb",nS="rec709",iS="p3",ZB="300 es",ql=2e3;class $h{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const r=this._listeners[e];if(void 0!==r){const s=r.indexOf(t);-1!==s&&r.splice(s,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const i=this._listeners[e.type];if(void 0!==i){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const Wr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];const qh=Math.PI/180,Xp=180/Math.PI;function no(){const n=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(Wr[255&n]+Wr[n>>8&255]+Wr[n>>16&255]+Wr[n>>24&255]+"-"+Wr[255&e]+Wr[e>>8&255]+"-"+Wr[e>>16&15|64]+Wr[e>>24&255]+"-"+Wr[63&t|128]+Wr[t>>8&255]+"-"+Wr[t>>16&255]+Wr[t>>24&255]+Wr[255&i]+Wr[i>>8&255]+Wr[i>>16&255]+Wr[i>>24&255]).toLowerCase()}function wi(n,e,t){return Math.max(e,Math.min(t,n))}function HD(n,e){return(n%e+e)%e}function Zy(n,e,t){return(1-t)*n+t*e}function zD(n){return 0==(n&n-1)&&0!==n}function QB(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function oS(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function Ls(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function jt(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(4294967295*n);case Uint16Array:return Math.round(65535*n);case Uint8Array:return Math.round(255*n);case Int32Array:return Math.round(2147483647*n);case Int16Array:return Math.round(32767*n);case Int8Array:return Math.round(127*n);default:throw new Error("Invalid component type.")}}const mu_DEG2RAD=qh,mu_degToRad=function aQ(n){return n*qh},mu_radToDeg=function lQ(n){return n*Xp};class fe{constructor(e=0,t=0){fe.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(wi(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Kt{constructor(e,t,i,r,s,o,a,l,c){Kt.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,i,r,s,o,a,l,c)}set(e,t,i,r,s,o,a,l,c){const h=this.elements;return h[0]=e,h[1]=r,h[2]=a,h[3]=t,h[4]=s,h[5]=l,h[6]=i,h[7]=o,h[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[3],l=i[6],c=i[1],h=i[4],d=i[7],p=i[2],m=i[5],g=i[8],v=r[0],w=r[3],y=r[6],b=r[1],E=r[4],C=r[7],x=r[2],A=r[5],D=r[8];return s[0]=o*v+a*b+l*x,s[3]=o*w+a*E+l*A,s[6]=o*y+a*C+l*D,s[1]=c*v+h*b+d*x,s[4]=c*w+h*E+d*A,s[7]=c*y+h*C+d*D,s[2]=p*v+m*b+g*x,s[5]=p*w+m*E+g*A,s[8]=p*y+m*C+g*D,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],h=e[8];return t*o*h-t*a*c-i*s*h+i*a*l+r*s*c-r*o*l}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],h=e[8],d=h*o-a*c,p=a*l-h*s,m=c*s-o*l,g=t*d+i*p+r*m;if(0===g)return this.set(0,0,0,0,0,0,0,0,0);const v=1/g;return e[0]=d*v,e[1]=(r*c-h*i)*v,e[2]=(a*i-r*o)*v,e[3]=p*v,e[4]=(h*t-r*l)*v,e[5]=(r*s-a*t)*v,e[6]=m*v,e[7]=(i*l-c*t)*v,e[8]=(o*t-i*s)*v,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(i*l,i*c,-i*(l*o+c*a)+o+e,-r*c,r*l,-r*(-c*o+l*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(GD.makeScale(e,t)),this}rotate(e){return this.premultiply(GD.makeRotation(-e)),this}translate(e,t){return this.premultiply(GD.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const GD=new Kt;function eV(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function Jy(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function hQ(){const n=Jy("canvas");return n.style.display="block",n}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const tV={};function Qy(n){n in tV||(tV[n]=!0,console.warn(n))}const nV=(new Kt).set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),iV=(new Kt).set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),aS={[Tr]:{transfer:tS,primaries:nS,toReference:n=>n,fromReference:n=>n},[di]:{transfer:ni,primaries:nS,toReference:n=>n.convertSRGBToLinear(),fromReference:n=>n.convertLinearToSRGB()},[eS]:{transfer:tS,primaries:iS,toReference:n=>n.applyMatrix3(iV),fromReference:n=>n.applyMatrix3(nV)},[UD]:{transfer:ni,primaries:iS,toReference:n=>n.convertSRGBToLinear().applyMatrix3(iV),fromReference:n=>n.applyMatrix3(nV).convertLinearToSRGB()}},dQ=new Set([Tr,eS]),Sn={enabled:!0,_workingColorSpace:Tr,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(n){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!n},get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(n){if(!dQ.has(n))throw new Error(`Unsupported working color space, "${n}".`);this._workingColorSpace=n},convert:function(n,e,t){return!1!==this.enabled&&e!==t&&e&&t?(0,aS[t].fromReference)((0,aS[e].toReference)(n)):n},fromWorkingColorSpace:function(n,e){return this.convert(n,this._workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this._workingColorSpace)},getPrimaries:function(n){return aS[n].primaries},getTransfer:function(n){return""===n?tS:aS[n].transfer}};function Kp(n){return n<.04045?.0773993808*n:Math.pow(.9478672986*n+.0521327014,2.4)}function WD(n){return n<.0031308?12.92*n:1.055*Math.pow(n,.41666)-.055}let Zp;class rV{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===Zp&&(Zp=Jy("canvas")),Zp.width=e.width,Zp.height=e.height;const i=Zp.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=Zp}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=Jy("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=255*Kp(s[o]/255);return i.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t[i]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*Kp(t[i]/255)):Kp(t[i]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let fQ=0;class Jp{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:fQ++}),this.uuid=no(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(null!==r){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)s.push(jD(r[o].isDataTexture?r[o].image:r[o]))}else s=jD(r);i.url=s}return t||(e.images[this.uuid]=i),i}}function jD(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?rV.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let pQ=0,Ro=(()=>{class n extends $h{constructor(t=n.DEFAULT_IMAGE,i=n.DEFAULT_MAPPING,r=Gr,s=Gr,o=hi,a=jl,l=Do,c=fu,h=n.DEFAULT_ANISOTROPY,d=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:pQ++}),this.uuid=no(),this.name="",this.source=new Jp(t),this.mipmaps=[],this.mapping=i,this.channel=0,this.wrapS=r,this.wrapT=s,this.magFilter=o,this.minFilter=a,this.anisotropy=h,this.format=l,this.internalFormat=null,this.type=c,this.offset=new fe(0,0),this.repeat=new fe(1,1),this.center=new fe(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Kt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,"string"==typeof d?this.colorSpace=d:(Qy("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=d===Wh?di:""),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const i=void 0===t||"string"==typeof t;if(!i&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),i||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Hh:t.x=t.x-Math.floor(t.x);break;case Gr:t.x=t.x<0?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case Hh:t.y=t.y-Math.floor(t.y);break;case Gr:t.y=t.y<0?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return Qy("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===di?Wh:3e3}set encoding(t){Qy("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=t===Wh?di:""}}return n.DEFAULT_IMAGE=null,n.DEFAULT_MAPPING=300,n.DEFAULT_ANISOTROPY=1,n})();class Nn{constructor(e=0,t=0,i=0,r=1){Nn.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*i+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,s;const l=e.elements,c=l[0],h=l[4],d=l[8],p=l[1],m=l[5],g=l[9],v=l[2],w=l[6],y=l[10];if(Math.abs(h-p)<.01&&Math.abs(d-v)<.01&&Math.abs(g-w)<.01){if(Math.abs(h+p)<.1&&Math.abs(d+v)<.1&&Math.abs(g+w)<.1&&Math.abs(c+m+y-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const E=(c+1)/2,C=(m+1)/2,x=(y+1)/2,A=(h+p)/4,D=(d+v)/4,O=(g+w)/4;return E>C&&E>x?E<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(E),r=A/i,s=D/i):C>x?C<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(C),i=A/r,s=O/r):x<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(x),i=D/s,r=O/s),this.set(i,r,s,t),this}let b=Math.sqrt((w-g)*(w-g)+(d-v)*(d-v)+(p-h)*(p-h));return Math.abs(b)<.001&&(b=1),this.x=(w-g)/b,this.y=(d-v)/b,this.z=(p-h)/b,this.w=Math.acos((c+m+y-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class mQ extends $h{constructor(e=1,t=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Nn(0,0,e,t),this.scissorTest=!1,this.viewport=new Nn(0,0,e,t);const r={width:e,height:t,depth:1};void 0!==i.encoding&&(Qy("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),i.colorSpace=i.encoding===Wh?di:""),i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:hi,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},i),this.texture=new Ro(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps,this.texture.internalFormat=i.internalFormat,this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.depthTexture=i.depthTexture,this.samples=i.samples}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new Jp(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Xh extends mQ{constructor(e=1,t=1,i={}){super(e,t,i),this.isWebGLRenderTarget=!0}}class $D extends Ro{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=Li,this.minFilter=Li,this.wrapR=Gr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class sV extends Ro{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=Li,this.minFilter=Li,this.wrapR=Gr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Vn{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,s,o,a){let l=i[r+0],c=i[r+1],h=i[r+2],d=i[r+3];const p=s[o+0],m=s[o+1],g=s[o+2],v=s[o+3];if(0===a)return e[t+0]=l,e[t+1]=c,e[t+2]=h,void(e[t+3]=d);if(1===a)return e[t+0]=p,e[t+1]=m,e[t+2]=g,void(e[t+3]=v);if(d!==v||l!==p||c!==m||h!==g){let w=1-a;const y=l*p+c*m+h*g+d*v,b=y>=0?1:-1,E=1-y*y;if(E>Number.EPSILON){const x=Math.sqrt(E),A=Math.atan2(x,y*b);w=Math.sin(w*A)/x,a=Math.sin(a*A)/x}const C=a*b;if(l=l*w+p*C,c=c*w+m*C,h=h*w+g*C,d=d*w+v*C,w===1-a){const x=1/Math.sqrt(l*l+c*c+h*h+d*d);l*=x,c*=x,h*=x,d*=x}}e[t]=l,e[t+1]=c,e[t+2]=h,e[t+3]=d}static multiplyQuaternionsFlat(e,t,i,r,s,o){const a=i[r],l=i[r+1],c=i[r+2],h=i[r+3],d=s[o],p=s[o+1],m=s[o+2],g=s[o+3];return e[t]=a*g+h*d+l*m-c*p,e[t+1]=l*g+h*p+c*d-a*m,e[t+2]=c*g+h*m+a*p-l*d,e[t+3]=h*g-a*d-l*p-c*m,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,c=a(i/2),h=a(r/2),d=a(s/2),p=l(i/2),m=l(r/2),g=l(s/2);switch(o){case"XYZ":this._x=p*h*d+c*m*g,this._y=c*m*d-p*h*g,this._z=c*h*g+p*m*d,this._w=c*h*d-p*m*g;break;case"YXZ":this._x=p*h*d+c*m*g,this._y=c*m*d-p*h*g,this._z=c*h*g-p*m*d,this._w=c*h*d+p*m*g;break;case"ZXY":this._x=p*h*d-c*m*g,this._y=c*m*d+p*h*g,this._z=c*h*g+p*m*d,this._w=c*h*d-p*m*g;break;case"ZYX":this._x=p*h*d-c*m*g,this._y=c*m*d+p*h*g,this._z=c*h*g-p*m*d,this._w=c*h*d+p*m*g;break;case"YZX":this._x=p*h*d+c*m*g,this._y=c*m*d+p*h*g,this._z=c*h*g-p*m*d,this._w=c*h*d-p*m*g;break;case"XZY":this._x=p*h*d-c*m*g,this._y=c*m*d-p*h*g,this._z=c*h*g+p*m*d,this._w=c*h*d+p*m*g;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],s=t[8],o=t[1],a=t[5],l=t[9],c=t[2],h=t[6],d=t[10],p=i+a+d;if(p>0){const m=.5/Math.sqrt(p+1);this._w=.25/m,this._x=(h-l)*m,this._y=(s-c)*m,this._z=(o-r)*m}else if(i>a&&i>d){const m=2*Math.sqrt(1+i-a-d);this._w=(h-l)/m,this._x=.25*m,this._y=(r+o)/m,this._z=(s+c)/m}else if(a>d){const m=2*Math.sqrt(1+a-i-d);this._w=(s-c)/m,this._x=(r+o)/m,this._y=.25*m,this._z=(l+h)/m}else{const m=2*Math.sqrt(1+d-i-a);this._w=(o-r)/m,this._x=(s+c)/m,this._y=(l+h)/m,this._z=.25*m}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(wi(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(0===i)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,s=e._z,o=e._w,a=t._x,l=t._y,c=t._z,h=t._w;return this._x=i*h+o*a+r*c-s*l,this._y=r*h+o*l+s*a-i*c,this._z=s*h+o*c+i*l-r*a,this._w=o*h-i*a-r*l-s*c,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const i=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const m=1-t;return this._w=m*o+t*this._w,this._x=m*i+t*this._x,this._y=m*r+t*this._y,this._z=m*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const c=Math.sqrt(l),h=Math.atan2(c,a),d=Math.sin((1-t)*h)/c,p=Math.sin(t*h)/c;return this._w=o*d+this._w*p,this._x=i*d+this._x*p,this._y=r*d+this._y*p,this._z=s*d+this._z*p,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(r),i*Math.sin(s),i*Math.cos(s),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class L{constructor(e=0,t=0,i=0){L.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return void 0===i&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(oV.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(oV.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*r,this.y=s[1]*t+s[4]*i+s[7]*r,this.z=s[2]*t+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=l*t+o*r-a*i,h=l*i+a*t-s*r,d=l*r+s*i-o*t,p=-s*t-o*i-a*r;return this.x=c*l+p*-s+h*-a-d*-o,this.y=h*l+p*-o+d*-s-c*-a,this.z=d*l+p*-a+c*-o-h*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r,this.y=s[1]*t+s[5]*i+s[9]*r,this.z=s[2]*t+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=r*l-s*a,this.y=s*o-i*l,this.z=i*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return qD.copy(this).projectOnVector(e),this.sub(qD)}reflect(e){return this.sub(qD.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(wi(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const qD=new L,oV=new Vn;class Ya{constructor(e=new L(1/0,1/0,1/0),t=new L(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(Yl.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(Yl.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=Yl.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){if(e.updateWorldMatrix(!1,!1),void 0!==e.boundingBox)null===e.boundingBox&&e.computeBoundingBox(),Qp.copy(e.boundingBox),Qp.applyMatrix4(e.matrixWorld),this.union(Qp);else{const r=e.geometry;if(void 0!==r)if(t&&void 0!==r.attributes&&void 0!==r.attributes.position){const s=r.attributes.position;for(let o=0,a=s.count;o<a;o++)Yl.fromBufferAttribute(s,o).applyMatrix4(e.matrixWorld),this.expandByPoint(Yl)}else null===r.boundingBox&&r.computeBoundingBox(),Qp.copy(r.boundingBox),Qp.applyMatrix4(e.matrixWorld),this.union(Qp)}const i=e.children;for(let r=0,s=i.length;r<s;r++)this.expandByObject(i[r],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Yl),Yl.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(ev),lS.subVectors(this.max,ev),em.subVectors(e.a,ev),tm.subVectors(e.b,ev),nm.subVectors(e.c,ev),gu.subVectors(tm,em),_u.subVectors(nm,tm),Yh.subVectors(em,nm);let t=[0,-gu.z,gu.y,0,-_u.z,_u.y,0,-Yh.z,Yh.y,gu.z,0,-gu.x,_u.z,0,-_u.x,Yh.z,0,-Yh.x,-gu.y,gu.x,0,-_u.y,_u.x,0,-Yh.y,Yh.x,0];return!(!XD(t,em,tm,nm,lS)||(t=[1,0,0,0,1,0,0,0,1],!XD(t,em,tm,nm,lS)))&&(cS.crossVectors(gu,_u),t=[cS.x,cS.y,cS.z],XD(t,em,tm,nm,lS))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Yl).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(Yl).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(Xl[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Xl[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Xl[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Xl[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Xl[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Xl[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Xl[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Xl[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Xl)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Xl=[new L,new L,new L,new L,new L,new L,new L,new L],Yl=new L,Qp=new Ya,em=new L,tm=new L,nm=new L,gu=new L,_u=new L,Yh=new L,ev=new L,lS=new L,cS=new L,Kh=new L;function XD(n,e,t,i,r){for(let s=0,o=n.length-3;s<=o;s+=3){Kh.fromArray(n,s);const a=r.x*Math.abs(Kh.x)+r.y*Math.abs(Kh.y)+r.z*Math.abs(Kh.z),l=e.dot(Kh),c=t.dot(Kh),h=i.dot(Kh);if(Math.max(-Math.max(l,c,h),Math.min(l,c,h))>a)return!1}return!0}const gQ=new Ya,tv=new L,YD=new L;class da{constructor(e=new L,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;void 0!==t?i.copy(t):gQ.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;tv.subVectors(e,this.center);const t=tv.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=.5*(i-this.radius);this.center.addScaledVector(tv,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(YD.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(tv.copy(e.center).add(YD)),this.expandByPoint(tv.copy(e.center).sub(YD))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Kl=new L,KD=new L,uS=new L,yu=new L,ZD=new L,hS=new L,JD=new L;class im{constructor(e=new L,t=new L(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Kl)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Kl.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Kl.copy(this.origin).addScaledVector(this.direction,t),Kl.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){KD.copy(e).add(t).multiplyScalar(.5),uS.copy(t).sub(e).normalize(),yu.copy(this.origin).sub(KD);const s=.5*e.distanceTo(t),o=-this.direction.dot(uS),a=yu.dot(this.direction),l=-yu.dot(uS),c=yu.lengthSq(),h=Math.abs(1-o*o);let d,p,m,g;if(h>0)if(d=o*l-a,p=o*a-l,g=s*h,d>=0)if(p>=-g)if(p<=g){const v=1/h;d*=v,p*=v,m=d*(d+o*p+2*a)+p*(o*d+p+2*l)+c}else p=s,d=Math.max(0,-(o*p+a)),m=-d*d+p*(p+2*l)+c;else p=-s,d=Math.max(0,-(o*p+a)),m=-d*d+p*(p+2*l)+c;else p<=-g?(d=Math.max(0,-(-o*s+a)),p=d>0?-s:Math.min(Math.max(-s,-l),s),m=-d*d+p*(p+2*l)+c):p<=g?(d=0,p=Math.min(Math.max(-s,-l),s),m=p*(p+2*l)+c):(d=Math.max(0,-(o*s+a)),p=d>0?s:Math.min(Math.max(-s,-l),s),m=-d*d+p*(p+2*l)+c);else p=o>0?-s:s,d=Math.max(0,-(o*p+a)),m=-d*d+p*(p+2*l)+c;return i&&i.copy(this.origin).addScaledVector(this.direction,d),r&&r.copy(KD).addScaledVector(uS,p),m}intersectSphere(e,t){Kl.subVectors(e.center,this.origin);const i=Kl.dot(this.direction),r=Kl.dot(Kl)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=i-o,l=i+o;return l<0?null:this.at(a<0?l:a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return null===i?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,s,o,a,l;const c=1/this.direction.x,h=1/this.direction.y,d=1/this.direction.z,p=this.origin;return c>=0?(i=(e.min.x-p.x)*c,r=(e.max.x-p.x)*c):(i=(e.max.x-p.x)*c,r=(e.min.x-p.x)*c),h>=0?(s=(e.min.y-p.y)*h,o=(e.max.y-p.y)*h):(s=(e.max.y-p.y)*h,o=(e.min.y-p.y)*h),i>o||s>r||((s>i||isNaN(i))&&(i=s),(o<r||isNaN(r))&&(r=o),d>=0?(a=(e.min.z-p.z)*d,l=(e.max.z-p.z)*d):(a=(e.max.z-p.z)*d,l=(e.min.z-p.z)*d),i>l||a>r)||((a>i||i!=i)&&(i=a),(l<r||r!=r)&&(r=l),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return null!==this.intersectBox(e,Kl)}intersectTriangle(e,t,i,r,s){ZD.subVectors(t,e),hS.subVectors(i,e),JD.crossVectors(ZD,hS);let a,o=this.direction.dot(JD);if(o>0){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}yu.subVectors(this.origin,e);const l=a*this.direction.dot(hS.crossVectors(yu,hS));if(l<0)return null;const c=a*this.direction.dot(ZD.cross(yu));if(c<0||l+c>o)return null;const h=-a*yu.dot(JD);return h<0?null:this.at(h/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class wt{constructor(e,t,i,r,s,o,a,l,c,h,d,p,m,g,v,w){wt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,i,r,s,o,a,l,c,h,d,p,m,g,v,w)}set(e,t,i,r,s,o,a,l,c,h,d,p,m,g,v,w){const y=this.elements;return y[0]=e,y[4]=t,y[8]=i,y[12]=r,y[1]=s,y[5]=o,y[9]=a,y[13]=l,y[2]=c,y[6]=h,y[10]=d,y[14]=p,y[3]=m,y[7]=g,y[11]=v,y[15]=w,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new wt).fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/rm.setFromMatrixColumn(e,0).length(),s=1/rm.setFromMatrixColumn(e,1).length(),o=1/rm.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),l=Math.cos(r),c=Math.sin(r),h=Math.cos(s),d=Math.sin(s);if("XYZ"===e.order){const p=o*h,m=o*d,g=a*h,v=a*d;t[0]=l*h,t[4]=-l*d,t[8]=c,t[1]=m+g*c,t[5]=p-v*c,t[9]=-a*l,t[2]=v-p*c,t[6]=g+m*c,t[10]=o*l}else if("YXZ"===e.order){const p=l*h,m=l*d,g=c*h,v=c*d;t[0]=p+v*a,t[4]=g*a-m,t[8]=o*c,t[1]=o*d,t[5]=o*h,t[9]=-a,t[2]=m*a-g,t[6]=v+p*a,t[10]=o*l}else if("ZXY"===e.order){const p=l*h,m=l*d,g=c*h,v=c*d;t[0]=p-v*a,t[4]=-o*d,t[8]=g+m*a,t[1]=m+g*a,t[5]=o*h,t[9]=v-p*a,t[2]=-o*c,t[6]=a,t[10]=o*l}else if("ZYX"===e.order){const p=o*h,m=o*d,g=a*h,v=a*d;t[0]=l*h,t[4]=g*c-m,t[8]=p*c+v,t[1]=l*d,t[5]=v*c+p,t[9]=m*c-g,t[2]=-c,t[6]=a*l,t[10]=o*l}else if("YZX"===e.order){const p=o*l,m=o*c,g=a*l,v=a*c;t[0]=l*h,t[4]=v-p*d,t[8]=g*d+m,t[1]=d,t[5]=o*h,t[9]=-a*h,t[2]=-c*h,t[6]=m*d+g,t[10]=p-v*d}else if("XZY"===e.order){const p=o*l,m=o*c,g=a*l,v=a*c;t[0]=l*h,t[4]=-d,t[8]=c*h,t[1]=p*d+v,t[5]=o*h,t[9]=m*d-g,t[2]=g*d-m,t[6]=a*h,t[10]=v*d+p}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(_Q,e,yQ)}lookAt(e,t,i){const r=this.elements;return io.subVectors(e,t),0===io.lengthSq()&&(io.z=1),io.normalize(),vu.crossVectors(i,io),0===vu.lengthSq()&&(1===Math.abs(i.z)?io.x+=1e-4:io.z+=1e-4,io.normalize(),vu.crossVectors(i,io)),vu.normalize(),dS.crossVectors(io,vu),r[0]=vu.x,r[4]=dS.x,r[8]=io.x,r[1]=vu.y,r[5]=dS.y,r[9]=io.y,r[2]=vu.z,r[6]=dS.z,r[10]=io.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[4],l=i[8],c=i[12],h=i[1],d=i[5],p=i[9],m=i[13],g=i[2],v=i[6],w=i[10],y=i[14],b=i[3],E=i[7],C=i[11],x=i[15],A=r[0],D=r[4],O=r[8],T=r[12],R=r[1],$=r[5],ee=r[9],se=r[13],V=r[2],J=r[6],G=r[10],X=r[14],Q=r[3],Z=r[7],le=r[11],q=r[15];return s[0]=o*A+a*R+l*V+c*Q,s[4]=o*D+a*$+l*J+c*Z,s[8]=o*O+a*ee+l*G+c*le,s[12]=o*T+a*se+l*X+c*q,s[1]=h*A+d*R+p*V+m*Q,s[5]=h*D+d*$+p*J+m*Z,s[9]=h*O+d*ee+p*G+m*le,s[13]=h*T+d*se+p*X+m*q,s[2]=g*A+v*R+w*V+y*Q,s[6]=g*D+v*$+w*J+y*Z,s[10]=g*O+v*ee+w*G+y*le,s[14]=g*T+v*se+w*X+y*q,s[3]=b*A+E*R+C*V+x*Q,s[7]=b*D+E*$+C*J+x*Z,s[11]=b*O+E*ee+C*G+x*le,s[15]=b*T+E*se+C*X+x*q,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],h=e[2],d=e[6],p=e[10],m=e[14];return e[3]*(+s*l*d-r*c*d-s*a*p+i*c*p+r*a*m-i*l*m)+e[7]*(+t*l*m-t*c*p+s*o*p-r*o*m+r*c*h-s*l*h)+e[11]*(+t*c*d-t*a*m-s*o*d+i*o*m+s*a*h-i*c*h)+e[15]*(-r*a*h-t*l*d+t*a*p+r*o*d-i*o*p+i*l*h)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],h=e[8],d=e[9],p=e[10],m=e[11],g=e[12],v=e[13],w=e[14],y=e[15],b=d*w*c-v*p*c+v*l*m-a*w*m-d*l*y+a*p*y,E=g*p*c-h*w*c-g*l*m+o*w*m+h*l*y-o*p*y,C=h*v*c-g*d*c+g*a*m-o*v*m-h*a*y+o*d*y,x=g*d*l-h*v*l-g*a*p+o*v*p+h*a*w-o*d*w,A=t*b+i*E+r*C+s*x;if(0===A)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const D=1/A;return e[0]=b*D,e[1]=(v*p*s-d*w*s-v*r*m+i*w*m+d*r*y-i*p*y)*D,e[2]=(a*w*s-v*l*s+v*r*c-i*w*c-a*r*y+i*l*y)*D,e[3]=(d*l*s-a*p*s-d*r*c+i*p*c+a*r*m-i*l*m)*D,e[4]=E*D,e[5]=(h*w*s-g*p*s+g*r*m-t*w*m-h*r*y+t*p*y)*D,e[6]=(g*l*s-o*w*s-g*r*c+t*w*c+o*r*y-t*l*y)*D,e[7]=(o*p*s-h*l*s+h*r*c-t*p*c-o*r*m+t*l*m)*D,e[8]=C*D,e[9]=(g*d*s-h*v*s-g*i*m+t*v*m+h*i*y-t*d*y)*D,e[10]=(o*v*s-g*a*s+g*i*c-t*v*c-o*i*y+t*a*y)*D,e[11]=(h*a*s-o*d*s-h*i*c+t*d*c+o*i*m-t*a*m)*D,e[12]=x*D,e[13]=(h*v*r-g*d*r+g*i*p-t*v*p-h*i*w+t*d*w)*D,e[14]=(g*a*r-o*v*r-g*i*l+t*v*l+o*i*w-t*a*w)*D,e[15]=(o*d*r-h*a*r+h*i*l-t*d*l-o*i*p+t*a*p)*D,this}scale(e){const t=this.elements,i=e.x,r=e.y,s=e.z;return t[0]*=i,t[4]*=r,t[8]*=s,t[1]*=i,t[5]*=r,t[9]*=s,t[2]*=i,t[6]*=r,t[10]*=s,t[3]*=i,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),s=1-i,o=e.x,a=e.y,l=e.z,c=s*o,h=s*a;return this.set(c*o+i,c*a-r*l,c*l+r*a,0,c*a+r*l,h*a+i,h*l-r*o,0,c*l-r*a,h*l+r*o,s*l*l+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,c=s+s,h=o+o,d=a+a,p=s*c,m=s*h,g=s*d,v=o*h,w=o*d,y=a*d,b=l*c,E=l*h,C=l*d,x=i.x,A=i.y,D=i.z;return r[0]=(1-(v+y))*x,r[1]=(m+C)*x,r[2]=(g-E)*x,r[3]=0,r[4]=(m-C)*A,r[5]=(1-(p+y))*A,r[6]=(w+b)*A,r[7]=0,r[8]=(g+E)*D,r[9]=(w-b)*D,r[10]=(1-(p+v))*D,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let s=rm.set(r[0],r[1],r[2]).length();const o=rm.set(r[4],r[5],r[6]).length(),a=rm.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],fa.copy(this);const c=1/s,h=1/o,d=1/a;return fa.elements[0]*=c,fa.elements[1]*=c,fa.elements[2]*=c,fa.elements[4]*=h,fa.elements[5]*=h,fa.elements[6]*=h,fa.elements[8]*=d,fa.elements[9]*=d,fa.elements[10]*=d,t.setFromRotationMatrix(fa),i.x=s,i.y=o,i.z=a,this}makePerspective(e,t,i,r,s,o,a=ql){const l=this.elements,c=2*s/(t-e),h=2*s/(i-r),d=(t+e)/(t-e),p=(i+r)/(i-r);let m,g;if(a===ql)m=-(o+s)/(o-s),g=-2*o*s/(o-s);else{if(2001!==a)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);m=-o/(o-s),g=-o*s/(o-s)}return l[0]=c,l[4]=0,l[8]=d,l[12]=0,l[1]=0,l[5]=h,l[9]=p,l[13]=0,l[2]=0,l[6]=0,l[10]=m,l[14]=g,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,i,r,s,o,a=ql){const l=this.elements,c=1/(t-e),h=1/(i-r),d=1/(o-s),p=(t+e)*c,m=(i+r)*h;let g,v;if(a===ql)g=(o+s)*d,v=-2*d;else{if(2001!==a)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);g=s*d,v=-1*d}return l[0]=2*c,l[4]=0,l[8]=0,l[12]=-p,l[1]=0,l[5]=2*h,l[9]=0,l[13]=-m,l[2]=0,l[6]=0,l[10]=v,l[14]=-g,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const rm=new L,fa=new wt,_Q=new L(0,0,0),yQ=new L(1,1,1),vu=new L,dS=new L,io=new L,aV=new wt,lV=new Vn;let cV=(()=>{class n{constructor(t=0,i=0,r=0,s=n.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=i,this._z=r,this._order=s}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,i,r,s=this._order){return this._x=t,this._y=i,this._z=r,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,i=this._order,r=!0){const s=t.elements,o=s[0],a=s[4],l=s[8],c=s[1],h=s[5],d=s[9],p=s[2],m=s[6],g=s[10];switch(i){case"XYZ":this._y=Math.asin(wi(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-d,g),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(m,h),this._z=0);break;case"YXZ":this._x=Math.asin(-wi(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(l,g),this._z=Math.atan2(c,h)):(this._y=Math.atan2(-p,o),this._z=0);break;case"ZXY":this._x=Math.asin(wi(m,-1,1)),Math.abs(m)<.9999999?(this._y=Math.atan2(-p,g),this._z=Math.atan2(-a,h)):(this._y=0,this._z=Math.atan2(c,o));break;case"ZYX":this._y=Math.asin(-wi(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(m,g),this._z=Math.atan2(c,o)):(this._x=0,this._z=Math.atan2(-a,h));break;case"YZX":this._z=Math.asin(wi(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-d,h),this._y=Math.atan2(-p,o)):(this._x=0,this._y=Math.atan2(l,g));break;case"XZY":this._z=Math.asin(-wi(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(m,h),this._y=Math.atan2(l,o)):(this._x=Math.atan2(-d,g),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,!0===r&&this._onChangeCallback(),this}setFromQuaternion(t,i,r){return aV.makeRotationFromQuaternion(t),this.setFromRotationMatrix(aV,i,r)}setFromVector3(t,i=this._order){return this.set(t.x,t.y,t.z,i)}reorder(t){return lV.setFromEuler(this),this.setFromQuaternion(lV,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],i=0){return t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return n.DEFAULT_ORDER="XYZ",n})();class QD{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let vQ=0;const uV=new L,sm=new Vn,Zl=new wt,fS=new L,nv=new L,wQ=new L,bQ=new Vn,hV=new L(1,0,0),dV=new L(0,1,0),fV=new L(0,0,1),EQ={type:"added"},SQ={type:"removed"};let fi=(()=>{class n extends $h{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:vQ++}),this.uuid=no(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=n.DEFAULT_UP.clone();const t=new L,i=new cV,r=new Vn,s=new L(1,1,1);i._onChange(function o(){r.setFromEuler(i,!1)}),r._onChange(function a(){i.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new wt},normalMatrix:{value:new Kt}}),this.matrix=new wt,this.matrixWorld=new wt,this.matrixAutoUpdate=n.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new QD,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,i){this.quaternion.setFromAxisAngle(t,i)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,i){return sm.setFromAxisAngle(t,i),this.quaternion.multiply(sm),this}rotateOnWorldAxis(t,i){return sm.setFromAxisAngle(t,i),this.quaternion.premultiply(sm),this}rotateX(t){return this.rotateOnAxis(hV,t)}rotateY(t){return this.rotateOnAxis(dV,t)}rotateZ(t){return this.rotateOnAxis(fV,t)}translateOnAxis(t,i){return uV.copy(t).applyQuaternion(this.quaternion),this.position.add(uV.multiplyScalar(i)),this}translateX(t){return this.translateOnAxis(hV,t)}translateY(t){return this.translateOnAxis(dV,t)}translateZ(t){return this.translateOnAxis(fV,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(Zl.copy(this.matrixWorld).invert())}lookAt(t,i,r){t.isVector3?fS.copy(t):fS.set(t,i,r);const s=this.parent;this.updateWorldMatrix(!0,!1),nv.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Zl.lookAt(nv,fS,this.up):Zl.lookAt(fS,nv,this.up),this.quaternion.setFromRotationMatrix(Zl),s&&(Zl.extractRotation(s.matrixWorld),sm.setFromRotationMatrix(Zl),this.quaternion.premultiply(sm.invert()))}add(t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(EQ)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const i=this.children.indexOf(t);return-1!==i&&(t.parent=null,this.children.splice(i,1),t.dispatchEvent(SQ)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),Zl.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),Zl.multiply(t.parent.matrixWorld)),t.applyMatrix4(Zl),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,i){if(this[t]===i)return this;for(let r=0,s=this.children.length;r<s;r++){const a=this.children[r].getObjectByProperty(t,i);if(void 0!==a)return a}}getObjectsByProperty(t,i){let r=[];this[t]===i&&r.push(this);for(let s=0,o=this.children.length;s<o;s++){const a=this.children[s].getObjectsByProperty(t,i);a.length>0&&(r=r.concat(a))}return r}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(nv,t,wQ),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(nv,bQ,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return t.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(t){t(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].traverseVisible(t)}traverseAncestors(t){const i=this.parent;null!==i&&(t(i),i.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const i=this.children;for(let r=0,s=i.length;r<s;r++){const o=i[r];(!0===o.matrixWorldAutoUpdate||!0===t)&&o.updateMatrixWorld(t)}}updateWorldMatrix(t,i){const r=this.parent;if(!0===t&&null!==r&&!0===r.matrixWorldAutoUpdate&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===i){const s=this.children;for(let o=0,a=s.length;o<a;o++){const l=s[o];!0===l.matrixWorldAutoUpdate&&l.updateWorldMatrix(!1,!0)}}}toJSON(t){const i=void 0===t||"string"==typeof t,r={};i&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const s={};function o(l,c){return void 0===l[c.uuid]&&(l[c.uuid]=c.toJSON(t)),c.uuid}if(s.uuid=this.uuid,s.type=this.type,""!==this.name&&(s.name=this.name),!0===this.castShadow&&(s.castShadow=!0),!0===this.receiveShadow&&(s.receiveShadow=!0),!1===this.visible&&(s.visible=!1),!1===this.frustumCulled&&(s.frustumCulled=!1),0!==this.renderOrder&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(s.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(s.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=o(t.geometries,this.geometry);const l=this.geometry.parameters;if(void 0!==l&&void 0!==l.shapes){const c=l.shapes;if(Array.isArray(c))for(let h=0,d=c.length;h<d;h++)o(t.shapes,c[h]);else o(t.shapes,c)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(o(t.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const l=[];for(let c=0,h=this.material.length;c<h;c++)l.push(o(t.materials,this.material[c]));s.material=l}else s.material=o(t.materials,this.material);if(this.children.length>0){s.children=[];for(let l=0;l<this.children.length;l++)s.children.push(this.children[l].toJSON(t).object)}if(this.animations.length>0){s.animations=[];for(let l=0;l<this.animations.length;l++)s.animations.push(o(t.animations,this.animations[l]))}if(i){const l=a(t.geometries),c=a(t.materials),h=a(t.textures),d=a(t.images),p=a(t.shapes),m=a(t.skeletons),g=a(t.animations),v=a(t.nodes);l.length>0&&(r.geometries=l),c.length>0&&(r.materials=c),h.length>0&&(r.textures=h),d.length>0&&(r.images=d),p.length>0&&(r.shapes=p),m.length>0&&(r.skeletons=m),g.length>0&&(r.animations=g),v.length>0&&(r.nodes=v)}return r.object=s,r;function a(l){const c=[];for(const h in l){const d=l[h];delete d.metadata,c.push(d)}return c}}clone(t){return(new this.constructor).copy(this,t)}copy(t,i=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),!0===i)for(let r=0;r<t.children.length;r++)this.add(t.children[r].clone());return this}}return n.DEFAULT_UP=new L(0,1,0),n.DEFAULT_MATRIX_AUTO_UPDATE=!0,n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,n})();const pa=new L,Jl=new L,eI=new L,Ql=new L,om=new L,am=new L,pV=new L,tI=new L,nI=new L,iI=new L;let pS=!1;class ro{constructor(e=new L,t=new L,i=new L){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),pa.subVectors(e,t),r.cross(pa);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,i,r,s){pa.subVectors(r,t),Jl.subVectors(i,t),eI.subVectors(e,t);const o=pa.dot(pa),a=pa.dot(Jl),l=pa.dot(eI),c=Jl.dot(Jl),h=Jl.dot(eI),d=o*c-a*a;if(0===d)return s.set(-2,-1,-1);const p=1/d,m=(c*l-a*h)*p,g=(o*h-a*l)*p;return s.set(1-m-g,g,m)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,Ql),Ql.x>=0&&Ql.y>=0&&Ql.x+Ql.y<=1}static getUV(e,t,i,r,s,o,a,l){return!1===pS&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),pS=!0),this.getInterpolation(e,t,i,r,s,o,a,l)}static getInterpolation(e,t,i,r,s,o,a,l){return this.getBarycoord(e,t,i,r,Ql),l.setScalar(0),l.addScaledVector(s,Ql.x),l.addScaledVector(o,Ql.y),l.addScaledVector(a,Ql.z),l}static isFrontFacing(e,t,i,r){return pa.subVectors(i,t),Jl.subVectors(e,t),pa.cross(Jl).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return pa.subVectors(this.c,this.b),Jl.subVectors(this.a,this.b),.5*pa.cross(Jl).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return ro.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return ro.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,r,s){return!1===pS&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),pS=!0),ro.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}getInterpolation(e,t,i,r,s){return ro.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}containsPoint(e){return ro.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return ro.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,s=this.c;let o,a;om.subVectors(r,i),am.subVectors(s,i),tI.subVectors(e,i);const l=om.dot(tI),c=am.dot(tI);if(l<=0&&c<=0)return t.copy(i);nI.subVectors(e,r);const h=om.dot(nI),d=am.dot(nI);if(h>=0&&d<=h)return t.copy(r);const p=l*d-h*c;if(p<=0&&l>=0&&h<=0)return o=l/(l-h),t.copy(i).addScaledVector(om,o);iI.subVectors(e,s);const m=om.dot(iI),g=am.dot(iI);if(g>=0&&m<=g)return t.copy(s);const v=m*c-l*g;if(v<=0&&c>=0&&g<=0)return a=c/(c-g),t.copy(i).addScaledVector(am,a);const w=h*g-m*d;if(w<=0&&d-h>=0&&m-g>=0)return pV.subVectors(s,r),a=(d-h)/(d-h+(m-g)),t.copy(r).addScaledVector(pV,a);const y=1/(w+v+p);return o=v*y,a=p*y,t.copy(i).addScaledVector(om,o).addScaledVector(am,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let CQ=0;class gs extends $h{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:CQ++}),this.uuid=no(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const i=e[t];if(void 0===i){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i:console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`)}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),void 0!==this.sheen&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(i.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(i.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(i.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(i.combine=this.combine)),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(i.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(i.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(i.size=this.size),null!==this.shadowSide&&(i.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(i.blending=this.blending),0!==this.side&&(i.side=this.side),!0===this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=!0),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.alphaHash&&(i.alphaHash=!0),!0===this.alphaToCoverage&&(i.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=!0),!0===this.forceSinglePass&&(i.forceSinglePass=!0),!0===this.wireframe&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(i.flatShading=!0),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),!1===this.fog&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData),t){const s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(null!==t){const r=t.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=t[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}const mV={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},wu={h:0,s:0,l:0},mS={h:0,s:0,l:0};function rI(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+6*(e-n)*t:t<.5?e:t<2/3?n+6*(e-n)*(2/3-t):n}class We{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(void 0===t&&void 0===i){const r=e;r&&r.isColor?this.copy(r):"number"==typeof r?this.setHex(r):"string"==typeof r&&this.setStyle(r)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=di){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,Sn.toWorkingColorSpace(this,t),this}setRGB(e,t,i,r=Sn.workingColorSpace){return this.r=e,this.g=t,this.b=i,Sn.toWorkingColorSpace(this,r),this}setHSL(e,t,i,r=Sn.workingColorSpace){if(e=HD(e,1),t=wi(t,0,1),i=wi(i,0,1),0===t)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+t):i+t-i*t,o=2*i-s;this.r=rI(o,s,e+1/3),this.g=rI(o,s,e),this.b=rI(o,s,e-1/3)}return Sn.toWorkingColorSpace(this,r),this}setStyle(e,t=di){function i(s){void 0!==s&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const a=r[2];switch(r[1]){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(3===o)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(6===o)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=di){const i=mV[e.toLowerCase()];return void 0!==i?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Kp(e.r),this.g=Kp(e.g),this.b=Kp(e.b),this}copyLinearToSRGB(e){return this.r=WD(e.r),this.g=WD(e.g),this.b=WD(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=di){return Sn.fromWorkingColorSpace(jr.copy(this),e),65536*Math.round(wi(255*jr.r,0,255))+256*Math.round(wi(255*jr.g,0,255))+Math.round(wi(255*jr.b,0,255))}getHexString(e=di){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Sn.workingColorSpace){Sn.fromWorkingColorSpace(jr.copy(this),t);const i=jr.r,r=jr.g,s=jr.b,o=Math.max(i,r,s),a=Math.min(i,r,s);let l,c;const h=(a+o)/2;if(a===o)l=0,c=0;else{const d=o-a;switch(c=h<=.5?d/(o+a):d/(2-o-a),o){case i:l=(r-s)/d+(r<s?6:0);break;case r:l=(s-i)/d+2;break;case s:l=(i-r)/d+4}l/=6}return e.h=l,e.s=c,e.l=h,e}getRGB(e,t=Sn.workingColorSpace){return Sn.fromWorkingColorSpace(jr.copy(this),t),e.r=jr.r,e.g=jr.g,e.b=jr.b,e}getStyle(e=di){Sn.fromWorkingColorSpace(jr.copy(this),e);const t=jr.r,i=jr.g,r=jr.b;return e!==di?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(255*t)},${Math.round(255*i)},${Math.round(255*r)})`}offsetHSL(e,t,i){return this.getHSL(wu),this.setHSL(wu.h+e,wu.s+t,wu.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(wu),e.getHSL(mS);const i=Zy(wu.h,mS.h,t),r=Zy(wu.s,mS.s,t),s=Zy(wu.l,mS.l,t);return this.setHSL(i,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,i=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*i+s[6]*r,this.g=s[1]*t+s[4]*i+s[7]*r,this.b=s[2]*t+s[5]*i+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const jr=new We;We.NAMES=mV;class bi extends gs{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new We(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=YE,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const qi=new L,gS=new fe;class Kn{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=i,this.usage=35044,this.updateRange={offset:0,count:-1},this.gpuType=$l,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,i=this.count;t<i;t++)gS.fromBufferAttribute(this,t),gS.applyMatrix3(e),this.setXY(t,gS.x,gS.y);else if(3===this.itemSize)for(let t=0,i=this.count;t<i;t++)qi.fromBufferAttribute(this,t),qi.applyMatrix3(e),this.setXYZ(t,qi.x,qi.y,qi.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)qi.fromBufferAttribute(this,t),qi.applyMatrix4(e),this.setXYZ(t,qi.x,qi.y,qi.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)qi.fromBufferAttribute(this,t),qi.applyNormalMatrix(e),this.setXYZ(t,qi.x,qi.y,qi.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)qi.fromBufferAttribute(this,t),qi.transformDirection(e),this.setXYZ(t,qi.x,qi.y,qi.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=Ls(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=jt(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Ls(t,this.array)),t}setX(e,t){return this.normalized&&(t=jt(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Ls(t,this.array)),t}setY(e,t){return this.normalized&&(t=jt(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Ls(t,this.array)),t}setZ(e,t){return this.normalized&&(t=jt(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Ls(t,this.array)),t}setW(e,t){return this.normalized&&(t=jt(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=jt(t,this.array),i=jt(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=jt(t,this.array),i=jt(i,this.array),r=jt(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=jt(t,this.array),i=jt(i,this.array),r=jt(r,this.array),s=jt(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}}class gV extends Kn{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class _V extends Kn{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class Ke extends Kn{constructor(e,t,i){super(new Float32Array(e),t,i)}}let MQ=0;const Po=new wt,sI=new fi,lm=new L,so=new Ya,rv=new Ya,mr=new L;class Rt extends $h{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:MQ++}),this.uuid=no(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(eV(e)?_V:gV)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(void 0!==i){const s=(new Kt).getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return Po.makeRotationFromQuaternion(e),this.applyMatrix4(Po),this}rotateX(e){return Po.makeRotationX(e),this.applyMatrix4(Po),this}rotateY(e){return Po.makeRotationY(e),this.applyMatrix4(Po),this}rotateZ(e){return Po.makeRotationZ(e),this.applyMatrix4(Po),this}translate(e,t,i){return Po.makeTranslation(e,t,i),this.applyMatrix4(Po),this}scale(e,t,i){return Po.makeScale(e,t,i),this.applyMatrix4(Po),this}lookAt(e){return sI.lookAt(e),sI.updateMatrix(),this.applyMatrix4(sI.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(lm).negate(),this.translate(lm.x,lm.y,lm.z),this}setFromPoints(e){const t=[];for(let i=0,r=e.length;i<r;i++){const s=e[i];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new Ke(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Ya);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new L(-1/0,-1/0,-1/0),new L(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++)so.setFromBufferAttribute(t[i]),this.morphTargetsRelative?(mr.addVectors(this.boundingBox.min,so.min),this.boundingBox.expandByPoint(mr),mr.addVectors(this.boundingBox.max,so.max),this.boundingBox.expandByPoint(mr)):(this.boundingBox.expandByPoint(so.min),this.boundingBox.expandByPoint(so.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new da);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new L,1/0);if(e){const i=this.boundingSphere.center;if(so.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++)rv.setFromBufferAttribute(t[s]),this.morphTargetsRelative?(mr.addVectors(so.min,rv.min),so.expandByPoint(mr),mr.addVectors(so.max,rv.max),so.expandByPoint(mr)):(so.expandByPoint(rv.min),so.expandByPoint(rv.max));so.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)mr.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(mr));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let c=0,h=a.count;c<h;c++)mr.fromBufferAttribute(a,c),l&&(lm.fromBufferAttribute(e,c),mr.add(lm)),r=Math.max(r,i.distanceToSquared(mr))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const i=e.array,r=t.position.array,s=t.normal.array,o=t.uv.array,a=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new Kn(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,c=[],h=[];for(let R=0;R<a;R++)c[R]=new L,h[R]=new L;const d=new L,p=new L,m=new L,g=new fe,v=new fe,w=new fe,y=new L,b=new L;function E(R,$,ee){d.fromArray(r,3*R),p.fromArray(r,3*$),m.fromArray(r,3*ee),g.fromArray(o,2*R),v.fromArray(o,2*$),w.fromArray(o,2*ee),p.sub(d),m.sub(d),v.sub(g),w.sub(g);const se=1/(v.x*w.y-w.x*v.y);isFinite(se)&&(y.copy(p).multiplyScalar(w.y).addScaledVector(m,-v.y).multiplyScalar(se),b.copy(m).multiplyScalar(v.x).addScaledVector(p,-w.x).multiplyScalar(se),c[R].add(y),c[$].add(y),c[ee].add(y),h[R].add(b),h[$].add(b),h[ee].add(b))}let C=this.groups;0===C.length&&(C=[{start:0,count:i.length}]);for(let R=0,$=C.length;R<$;++R){const ee=C[R],se=ee.start;for(let J=se,G=se+ee.count;J<G;J+=3)E(i[J+0],i[J+1],i[J+2])}const x=new L,A=new L,D=new L,O=new L;function T(R){D.fromArray(s,3*R),O.copy(D);const $=c[R];x.copy($),x.sub(D.multiplyScalar(D.dot($))).normalize(),A.crossVectors(O,$);const se=A.dot(h[R])<0?-1:1;l[4*R]=x.x,l[4*R+1]=x.y,l[4*R+2]=x.z,l[4*R+3]=se}for(let R=0,$=C.length;R<$;++R){const ee=C[R],se=ee.start;for(let J=se,G=se+ee.count;J<G;J+=3)T(i[J+0]),T(i[J+1]),T(i[J+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let i=this.getAttribute("normal");if(void 0===i)i=new Kn(new Float32Array(3*t.count),3),this.setAttribute("normal",i);else for(let p=0,m=i.count;p<m;p++)i.setXYZ(p,0,0,0);const r=new L,s=new L,o=new L,a=new L,l=new L,c=new L,h=new L,d=new L;if(e)for(let p=0,m=e.count;p<m;p+=3){const g=e.getX(p+0),v=e.getX(p+1),w=e.getX(p+2);r.fromBufferAttribute(t,g),s.fromBufferAttribute(t,v),o.fromBufferAttribute(t,w),h.subVectors(o,s),d.subVectors(r,s),h.cross(d),a.fromBufferAttribute(i,g),l.fromBufferAttribute(i,v),c.fromBufferAttribute(i,w),a.add(h),l.add(h),c.add(h),i.setXYZ(g,a.x,a.y,a.z),i.setXYZ(v,l.x,l.y,l.z),i.setXYZ(w,c.x,c.y,c.z)}else for(let p=0,m=t.count;p<m;p+=3)r.fromBufferAttribute(t,p+0),s.fromBufferAttribute(t,p+1),o.fromBufferAttribute(t,p+2),h.subVectors(o,s),d.subVectors(r,s),h.cross(d),i.setXYZ(p+0,h.x,h.y,h.z),i.setXYZ(p+1,h.x,h.y,h.z),i.setXYZ(p+2,h.x,h.y,h.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)mr.fromBufferAttribute(e,t),mr.normalize(),e.setXYZ(t,mr.x,mr.y,mr.z)}toNonIndexed(){function e(a,l){const c=a.array,h=a.itemSize,d=a.normalized,p=new c.constructor(l.length*h);let m=0,g=0;for(let v=0,w=l.length;v<w;v++){m=a.isInterleavedBufferAttribute?l[v]*a.data.stride+a.offset:l[v]*h;for(let y=0;y<h;y++)p[g++]=c[m++]}return new Kn(p,h,d)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Rt,i=this.index.array,r=this.attributes;for(const a in r){const c=e(r[a],i);t.setAttribute(a,c)}const s=this.morphAttributes;for(const a in s){const l=[],c=s[a];for(let h=0,d=c.length;h<d;h++){const m=e(c[h],i);l.push(m)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const c=o[a];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const l=this.parameters;for(const c in l)void 0!==l[c]&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const l in i)e.data.attributes[l]=i[l].toJSON(e.data);const r={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],h=[];for(let d=0,p=c.length;d<p;d++)h.push(c[d].toJSON(e.data));h.length>0&&(r[l]=h,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return null!==a&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;null!==i&&this.setIndex(i.clone(t));const r=e.attributes;for(const c in r)this.setAttribute(c,r[c].clone(t));const s=e.morphAttributes;for(const c in s){const h=[],d=s[c];for(let p=0,m=d.length;p<m;p++)h.push(d[p].clone(t));this.morphAttributes[c]=h}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let c=0,h=o.length;c<h;c++){const d=o[c];this.addGroup(d.start,d.count,d.materialIndex)}const a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());const l=e.boundingSphere;return null!==l&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const yV=new wt,Zh=new im,_S=new da,vV=new L,cm=new L,um=new L,hm=new L,oI=new L,yS=new L,vS=new fe,wS=new fe,bS=new fe,wV=new L,bV=new L,EV=new L,ES=new L,SS=new L;class Me extends fi{constructor(e=new Rt,t=new bi){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){const i=this.geometry,s=i.morphAttributes.position,o=i.morphTargetsRelative;t.fromBufferAttribute(i.attributes.position,e);const a=this.morphTargetInfluences;if(s&&a){yS.set(0,0,0);for(let l=0,c=s.length;l<c;l++){const h=a[l];0!==h&&(oI.fromBufferAttribute(s[l],e),yS.addScaledVector(o?oI:oI.sub(t),h))}t.add(yS)}return t}raycast(e,t){const i=this.geometry,s=this.matrixWorld;void 0!==this.material&&(null===i.boundingSphere&&i.computeBoundingSphere(),_S.copy(i.boundingSphere),_S.applyMatrix4(s),Zh.copy(e.ray).recast(e.near),(!1!==_S.containsPoint(Zh.origin)||!(null===Zh.intersectSphere(_S,vV)||Zh.origin.distanceToSquared(vV)>(e.far-e.near)**2))&&(yV.copy(s).invert(),Zh.copy(e.ray).applyMatrix4(yV),(null===i.boundingBox||!1!==Zh.intersectsBox(i.boundingBox))&&this._computeIntersections(e,t,Zh)))}_computeIntersections(e,t,i){let r;const s=this.geometry,o=this.material,a=s.index,l=s.attributes.position,c=s.attributes.uv,h=s.attributes.uv1,d=s.attributes.normal,p=s.groups,m=s.drawRange;if(null!==a)if(Array.isArray(o))for(let g=0,v=p.length;g<v;g++){const w=p[g],y=o[w.materialIndex];for(let C=Math.max(w.start,m.start),x=Math.min(a.count,Math.min(w.start+w.count,m.start+m.count));C<x;C+=3)r=CS(this,y,e,i,c,h,d,a.getX(C),a.getX(C+1),a.getX(C+2)),r&&(r.faceIndex=Math.floor(C/3),r.face.materialIndex=w.materialIndex,t.push(r))}else for(let w=Math.max(0,m.start),y=Math.min(a.count,m.start+m.count);w<y;w+=3)r=CS(this,o,e,i,c,h,d,a.getX(w),a.getX(w+1),a.getX(w+2)),r&&(r.faceIndex=Math.floor(w/3),t.push(r));else if(void 0!==l)if(Array.isArray(o))for(let g=0,v=p.length;g<v;g++){const w=p[g],y=o[w.materialIndex];for(let C=Math.max(w.start,m.start),x=Math.min(l.count,Math.min(w.start+w.count,m.start+m.count));C<x;C+=3)r=CS(this,y,e,i,c,h,d,C,C+1,C+2),r&&(r.faceIndex=Math.floor(C/3),r.face.materialIndex=w.materialIndex,t.push(r))}else for(let w=Math.max(0,m.start),y=Math.min(l.count,m.start+m.count);w<y;w+=3)r=CS(this,o,e,i,c,h,d,w,w+1,w+2),r&&(r.faceIndex=Math.floor(w/3),t.push(r))}}function CS(n,e,t,i,r,s,o,a,l,c){n.getVertexPosition(a,cm),n.getVertexPosition(l,um),n.getVertexPosition(c,hm);const h=function TQ(n,e,t,i,r,s,o,a){let l;if(l=1===e.side?i.intersectTriangle(o,s,r,!0,a):i.intersectTriangle(r,s,o,0===e.side,a),null===l)return null;SS.copy(a),SS.applyMatrix4(n.matrixWorld);const c=t.ray.origin.distanceTo(SS);return c<t.near||c>t.far?null:{distance:c,point:SS.clone(),object:n}}(n,e,t,i,cm,um,hm,ES);if(h){r&&(vS.fromBufferAttribute(r,a),wS.fromBufferAttribute(r,l),bS.fromBufferAttribute(r,c),h.uv=ro.getInterpolation(ES,cm,um,hm,vS,wS,bS,new fe)),s&&(vS.fromBufferAttribute(s,a),wS.fromBufferAttribute(s,l),bS.fromBufferAttribute(s,c),h.uv1=ro.getInterpolation(ES,cm,um,hm,vS,wS,bS,new fe),h.uv2=h.uv1),o&&(wV.fromBufferAttribute(o,a),bV.fromBufferAttribute(o,l),EV.fromBufferAttribute(o,c),h.normal=ro.getInterpolation(ES,cm,um,hm,wV,bV,EV,new L),h.normal.dot(i.direction)>0&&h.normal.multiplyScalar(-1));const d={a,b:l,c,normal:new L,materialIndex:0};ro.getNormal(cm,um,hm,d.normal),h.face=d}return h}class oi extends Rt{constructor(e=1,t=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],c=[],h=[],d=[];let p=0,m=0;function g(v,w,y,b,E,C,x,A,D,O,T){const R=C/D,$=x/O,ee=C/2,se=x/2,V=A/2,J=D+1,G=O+1;let X=0,Q=0;const Z=new L;for(let le=0;le<G;le++){const q=le*$-se;for(let oe=0;oe<J;oe++)Z[v]=(oe*R-ee)*b,Z[w]=q*E,Z[y]=V,c.push(Z.x,Z.y,Z.z),Z[v]=0,Z[w]=0,Z[y]=A>0?1:-1,h.push(Z.x,Z.y,Z.z),d.push(oe/D),d.push(1-le/O),X+=1}for(let le=0;le<O;le++)for(let q=0;q<D;q++){const Se=p+q+J*(le+1),ve=p+(q+1)+J*(le+1),Ne=p+(q+1)+J*le;l.push(p+q+J*le,Se,Ne),l.push(Se,ve,Ne),Q+=6}a.addGroup(m,Q,T),m+=Q,p+=X}g("z","y","x",-1,-1,i,t,e,o,s,0),g("z","y","x",1,-1,i,t,-e,o,s,1),g("x","z","y",1,1,e,i,t,r,o,2),g("x","z","y",1,-1,e,i,-t,r,o,3),g("x","y","z",1,-1,e,t,i,r,s,4),g("x","y","z",-1,-1,e,t,-i,r,s,5),this.setIndex(l),this.setAttribute("position",new Ke(c,3)),this.setAttribute("normal",new Ke(h,3)),this.setAttribute("uv",new Ke(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new oi(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function dm(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=r.clone():e[t][i]=Array.isArray(r)?r.slice():r}}return e}function _s(n){const e={};for(let t=0;t<n.length;t++){const i=dm(n[t]);for(const r in i)e[r]=i[r]}return e}function SV(n){return null===n.getRenderTarget()?n.outputColorSpace:Sn.workingColorSpace}const DQ={clone:dm,merge:_s};class tc extends gs{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=dm(e.uniforms),this.uniformsGroups=function AQ(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;t.uniforms[r]=o&&o.isTexture?{type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?{type:"c",value:o.getHex()}:o&&o.isVector2?{type:"v2",value:o.toArray()}:o&&o.isVector3?{type:"v3",value:o.toArray()}:o&&o.isVector4?{type:"v4",value:o.toArray()}:o&&o.isMatrix3?{type:"m3",value:o.toArray()}:o&&o.isMatrix4?{type:"m4",value:o.toArray()}:{value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const i={};for(const r in this.extensions)!0===this.extensions[r]&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class aI extends fi{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new wt,this.projectionMatrix=new wt,this.projectionMatrixInverse=new wt,this.coordinateSystem=ql}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class ir extends aI{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*Xp*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*qh*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*Xp*Math.atan(Math.tan(.5*qh*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,r,s,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*qh*this.fov)/this.zoom,i=2*t,r=this.aspect*i,s=-.5*r;const o=this.view;if(null!==this.view&&this.view.enabled){const l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*r/l,t-=o.offsetY*i/c,r*=o.width/l,i*=o.height/c}const a=this.filmOffset;0!==a&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class PQ extends fi{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new ir(-90,1,e,t);r.layers=this.layers,this.add(r);const s=new ir(-90,1,e,t);s.layers=this.layers,this.add(s);const o=new ir(-90,1,e,t);o.layers=this.layers,this.add(o);const a=new ir(-90,1,e,t);a.layers=this.layers,this.add(a);const l=new ir(-90,1,e,t);l.layers=this.layers,this.add(l);const c=new ir(-90,1,e,t);c.layers=this.layers,this.add(c)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[i,r,s,o,a,l]=t;for(const c of t)this.remove(c);if(e===ql)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else{if(2001!==e)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1)}for(const c of t)this.add(c),c.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,o,a,l,c,h]=this.children,d=e.getRenderTarget(),p=e.getActiveCubeFace(),m=e.getActiveMipmapLevel(),g=e.xr.enabled;e.xr.enabled=!1;const v=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,r),e.render(t,s),e.setRenderTarget(i,1,r),e.render(t,o),e.setRenderTarget(i,2,r),e.render(t,a),e.setRenderTarget(i,3,r),e.render(t,l),e.setRenderTarget(i,4,r),e.render(t,c),i.texture.generateMipmaps=v,e.setRenderTarget(i,5,r),e.render(t,h),e.setRenderTarget(d,p,m),e.xr.enabled=g,i.texture.needsPMREMUpdate=!0}}class xS extends Ro{constructor(e,t,i,r,s,o,a,l,c,h){super(e=void 0!==e?e:[],t=void 0!==t?t:du,i,r,s,o,a,l,c,h),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class NQ extends Xh{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];void 0!==t.encoding&&(Qy("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),t.colorSpace=t.encoding===Wh?di:""),this.texture=new xS(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:hi}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i_uniforms={tEquirect:{value:null}},i_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",r=new oi(5,5,5),s=new tc({name:"CubemapFromEquirect",uniforms:dm(i_uniforms),vertexShader:i_vertexShader,fragmentShader:i_fragmentShader,side:1,blending:0});s.uniforms.tEquirect.value=t;const o=new Me(r,s),a=t.minFilter;return t.minFilter===jl&&(t.minFilter=hi),new PQ(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,i,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,i,r);e.setRenderTarget(s)}}const lI=new L,LQ=new L,OQ=new Kt;class nc{constructor(e=new L(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=lI.subVectors(i,t).cross(LQ.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(lI),r=this.normal.dot(i);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(i,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||OQ.getNormalMatrix(e),r=this.coplanarPoint(lI).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const Jh=new da,MS=new L;class cI{constructor(e=new nc,t=new nc,i=new nc,r=new nc,s=new nc,o=new nc){this.planes=[e,t,i,r,s,o]}set(e,t,i,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=ql){const i=this.planes,r=e.elements,s=r[0],o=r[1],a=r[2],l=r[3],c=r[4],h=r[5],d=r[6],p=r[7],m=r[8],g=r[9],v=r[10],w=r[11],y=r[12],b=r[13],E=r[14],C=r[15];if(i[0].setComponents(l-s,p-c,w-m,C-y).normalize(),i[1].setComponents(l+s,p+c,w+m,C+y).normalize(),i[2].setComponents(l+o,p+h,w+g,C+b).normalize(),i[3].setComponents(l-o,p-h,w-g,C-b).normalize(),i[4].setComponents(l-a,p-d,w-v,C-E).normalize(),t===ql)i[5].setComponents(l+a,p+d,w+v,C+E).normalize();else{if(2001!==t)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);i[5].setComponents(a,d,v,E).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),Jh.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),Jh.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Jh)}intersectsSprite(e){return Jh.center.set(0,0,0),Jh.radius=.7071067811865476,Jh.applyMatrix4(e.matrixWorld),this.intersectsSphere(Jh)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(MS.x=r.normal.x>0?e.max.x:e.min.x,MS.y=r.normal.y>0?e.max.y:e.min.y,MS.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(MS)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function CV(){let n=null,e=!1,t=null,i=null;function r(s,o){t(s,o),i=n.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==t&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function FQ(n,e){const t=e.isWebGL2,i=new WeakMap;return{get:function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),i.get(c)},remove:function a(c){c.isInterleavedBufferAttribute&&(c=c.data);const h=i.get(c);h&&(n.deleteBuffer(h.buffer),i.delete(c))},update:function l(c,h){if(c.isGLBufferAttribute){const p=i.get(c);return void((!p||p.version<c.version)&&i.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version}))}c.isInterleavedBufferAttribute&&(c=c.data);const d=i.get(c);void 0===d?i.set(c,function r(c,h){const d=c.array,p=c.usage,m=n.createBuffer();let g;if(n.bindBuffer(h,m),n.bufferData(h,d,p),c.onUploadCallback(),d instanceof Float32Array)g=n.FLOAT;else if(d instanceof Uint16Array)if(c.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");g=n.HALF_FLOAT}else g=n.UNSIGNED_SHORT;else if(d instanceof Int16Array)g=n.SHORT;else if(d instanceof Uint32Array)g=n.UNSIGNED_INT;else if(d instanceof Int32Array)g=n.INT;else if(d instanceof Int8Array)g=n.BYTE;else if(d instanceof Uint8Array)g=n.UNSIGNED_BYTE;else{if(!(d instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+d);g=n.UNSIGNED_BYTE}return{buffer:m,type:g,bytesPerElement:d.BYTES_PER_ELEMENT,version:c.version}}(c,h)):d.version<c.version&&(function s(c,h,d){const p=h.array,m=h.updateRange;n.bindBuffer(d,c),-1===m.count?n.bufferSubData(d,0,p):(t?n.bufferSubData(d,m.offset*p.BYTES_PER_ELEMENT,p,m.offset,m.count):n.bufferSubData(d,m.offset*p.BYTES_PER_ELEMENT,p.subarray(m.offset,m.offset+m.count)),m.count=-1),h.onUploadCallback()}(d.buffer,c,h),d.version=c.version)}}}class mm extends Rt{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(i),l=Math.floor(r),c=a+1,h=l+1,d=e/a,p=t/l,m=[],g=[],v=[],w=[];for(let y=0;y<h;y++){const b=y*p-o;for(let E=0;E<c;E++)g.push(E*d-s,-b,0),v.push(0,0,1),w.push(E/a),w.push(1-y/l)}for(let y=0;y<l;y++)for(let b=0;b<a;b++){const C=b+c*(y+1),x=b+1+c*(y+1),A=b+1+c*y;m.push(b+c*y,C,A),m.push(C,x,A)}this.setIndex(m),this.setAttribute("position",new Ke(g,3)),this.setAttribute("normal",new Ke(v,3)),this.setAttribute("uv",new Ke(w,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new mm(e.width,e.height,e.widthSegments,e.heightSegments)}}const qt={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"\nconst mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(\n\tvec3( 0.8224621, 0.177538, 0.0 ),\n\tvec3( 0.0331941, 0.9668058, 0.0 ),\n\tvec3( 0.0170827, 0.0723974, 0.9105199 )\n);\nconst mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.2249401, - 0.2249404, 0.0 ),\n\tvec3( - 0.0420569, 1.0420571, 0.0 ),\n\tvec3( - 0.0196376, - 0.0786361, 1.0982735 )\n);\nvec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );\n}\nvec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );\n}\nvec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn sRGBTransferOETF( value );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tanisotropyV /= material.anisotropy;\n\tmaterial.anisotropy = saturate( material.anisotropy );\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x - tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x + tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal;\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},Ge={common:{diffuse:{value:new We(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Kt},alphaMap:{value:null},alphaMapTransform:{value:new Kt},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Kt}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Kt}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Kt}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Kt},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Kt},normalScale:{value:new fe(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Kt},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Kt}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Kt}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Kt}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new We(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new We(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Kt},alphaTest:{value:0},uvTransform:{value:new Kt}},sprite:{diffuse:{value:new We(16777215)},opacity:{value:1},center:{value:new fe(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Kt},alphaMap:{value:null},alphaMapTransform:{value:new Kt},alphaTest:{value:0}}},Ka={basic:{uniforms:_s([Ge.common,Ge.specularmap,Ge.envmap,Ge.aomap,Ge.lightmap,Ge.fog]),vertexShader:qt.meshbasic_vert,fragmentShader:qt.meshbasic_frag},lambert:{uniforms:_s([Ge.common,Ge.specularmap,Ge.envmap,Ge.aomap,Ge.lightmap,Ge.emissivemap,Ge.bumpmap,Ge.normalmap,Ge.displacementmap,Ge.fog,Ge.lights,{emissive:{value:new We(0)}}]),vertexShader:qt.meshlambert_vert,fragmentShader:qt.meshlambert_frag},phong:{uniforms:_s([Ge.common,Ge.specularmap,Ge.envmap,Ge.aomap,Ge.lightmap,Ge.emissivemap,Ge.bumpmap,Ge.normalmap,Ge.displacementmap,Ge.fog,Ge.lights,{emissive:{value:new We(0)},specular:{value:new We(1118481)},shininess:{value:30}}]),vertexShader:qt.meshphong_vert,fragmentShader:qt.meshphong_frag},standard:{uniforms:_s([Ge.common,Ge.envmap,Ge.aomap,Ge.lightmap,Ge.emissivemap,Ge.bumpmap,Ge.normalmap,Ge.displacementmap,Ge.roughnessmap,Ge.metalnessmap,Ge.fog,Ge.lights,{emissive:{value:new We(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:qt.meshphysical_vert,fragmentShader:qt.meshphysical_frag},toon:{uniforms:_s([Ge.common,Ge.aomap,Ge.lightmap,Ge.emissivemap,Ge.bumpmap,Ge.normalmap,Ge.displacementmap,Ge.gradientmap,Ge.fog,Ge.lights,{emissive:{value:new We(0)}}]),vertexShader:qt.meshtoon_vert,fragmentShader:qt.meshtoon_frag},matcap:{uniforms:_s([Ge.common,Ge.bumpmap,Ge.normalmap,Ge.displacementmap,Ge.fog,{matcap:{value:null}}]),vertexShader:qt.meshmatcap_vert,fragmentShader:qt.meshmatcap_frag},points:{uniforms:_s([Ge.points,Ge.fog]),vertexShader:qt.points_vert,fragmentShader:qt.points_frag},dashed:{uniforms:_s([Ge.common,Ge.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:qt.linedashed_vert,fragmentShader:qt.linedashed_frag},depth:{uniforms:_s([Ge.common,Ge.displacementmap]),vertexShader:qt.depth_vert,fragmentShader:qt.depth_frag},normal:{uniforms:_s([Ge.common,Ge.bumpmap,Ge.normalmap,Ge.displacementmap,{opacity:{value:1}}]),vertexShader:qt.meshnormal_vert,fragmentShader:qt.meshnormal_frag},sprite:{uniforms:_s([Ge.sprite,Ge.fog]),vertexShader:qt.sprite_vert,fragmentShader:qt.sprite_frag},background:{uniforms:{uvTransform:{value:new Kt},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:qt.background_vert,fragmentShader:qt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:qt.backgroundCube_vert,fragmentShader:qt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:qt.cube_vert,fragmentShader:qt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:qt.equirect_vert,fragmentShader:qt.equirect_frag},distanceRGBA:{uniforms:_s([Ge.common,Ge.displacementmap,{referencePosition:{value:new L},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:qt.distanceRGBA_vert,fragmentShader:qt.distanceRGBA_frag},shadow:{uniforms:_s([Ge.lights,Ge.fog,{color:{value:new We(0)},opacity:{value:1}}]),vertexShader:qt.shadow_vert,fragmentShader:qt.shadow_frag}};Ka.physical={uniforms:_s([Ka.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Kt},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Kt},clearcoatNormalScale:{value:new fe(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Kt},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Kt},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Kt},sheen:{value:0},sheenColor:{value:new We(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Kt},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Kt},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Kt},transmissionSamplerSize:{value:new fe},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Kt},attenuationDistance:{value:0},attenuationColor:{value:new We(0)},specularColor:{value:new We(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Kt},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Kt},anisotropyVector:{value:new fe},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Kt}}]),vertexShader:qt.meshphysical_vert,fragmentShader:qt.meshphysical_frag};const TS={r:0,b:0,g:0};function Lte(n,e,t,i,r,s,o){const a=new We(0);let c,h,l=!0===s?0:1,d=null,p=0,m=null;function v(w,y){w.getRGB(TS,SV(n)),i.buffers.color.setClear(TS.r,TS.g,TS.b,y,o)}return{getClearColor:function(){return a},setClearColor:function(w,y=1){a.set(w),l=y,v(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(w){l=w,v(a,l)},render:function g(w,y){let b=!1,E=!0===y.isScene?y.background:null;E&&E.isTexture&&(E=(y.backgroundBlurriness>0?t:e).get(E)),null===E?v(a,l):E&&E.isColor&&(v(E,1),b=!0);const C=n.xr.getEnvironmentBlendMode();"additive"===C?i.buffers.color.setClear(0,0,0,1,o):"alpha-blend"===C&&i.buffers.color.setClear(0,0,0,0,o),(n.autoClear||b)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),E&&(E.isCubeTexture||E.mapping===$y)?(void 0===h&&(h=new Me(new oi(1,1,1),new tc({name:"BackgroundCubeMaterial",uniforms:dm(Ka.backgroundCube.uniforms),vertexShader:Ka.backgroundCube.vertexShader,fragmentShader:Ka.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),h.geometry.deleteAttribute("uv"),h.onBeforeRender=function(x,A,D){this.matrixWorld.copyPosition(D.matrixWorld)},Object.defineProperty(h.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(h)),h.material.uniforms.envMap.value=E,h.material.uniforms.flipEnvMap.value=E.isCubeTexture&&!1===E.isRenderTargetTexture?-1:1,h.material.uniforms.backgroundBlurriness.value=y.backgroundBlurriness,h.material.uniforms.backgroundIntensity.value=y.backgroundIntensity,h.material.toneMapped=Sn.getTransfer(E.colorSpace)!==ni,(d!==E||p!==E.version||m!==n.toneMapping)&&(h.material.needsUpdate=!0,d=E,p=E.version,m=n.toneMapping),h.layers.enableAll(),w.unshift(h,h.geometry,h.material,0,0,null)):E&&E.isTexture&&(void 0===c&&(c=new Me(new mm(2,2),new tc({name:"BackgroundMaterial",uniforms:dm(Ka.background.uniforms),vertexShader:Ka.background.vertexShader,fragmentShader:Ka.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=E,c.material.uniforms.backgroundIntensity.value=y.backgroundIntensity,c.material.toneMapped=Sn.getTransfer(E.colorSpace)!==ni,!0===E.matrixAutoUpdate&&E.updateMatrix(),c.material.uniforms.uvTransform.value.copy(E.matrix),(d!==E||p!==E.version||m!==n.toneMapping)&&(c.material.needsUpdate=!0,d=E,p=E.version,m=n.toneMapping),c.layers.enableAll(),w.unshift(c,c.geometry,c.material,0,0,null))}}}function Ote(n,e,t,i){const r=n.getParameter(n.MAX_VERTEX_ATTRIBS),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),o=i.isWebGL2||null!==s,a={},l=w(null);let c=l,h=!1;function m(V){return i.isWebGL2?n.bindVertexArray(V):s.bindVertexArrayOES(V)}function g(V){return i.isWebGL2?n.deleteVertexArray(V):s.deleteVertexArrayOES(V)}function w(V){const J=[],G=[],X=[];for(let Q=0;Q<r;Q++)J[Q]=0,G[Q]=0,X[Q]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:J,enabledAttributes:G,attributeDivisors:X,object:V,attributes:{},index:null}}function E(){const V=c.newAttributes;for(let J=0,G=V.length;J<G;J++)V[J]=0}function C(V){x(V,0)}function x(V,J){const X=c.enabledAttributes,Q=c.attributeDivisors;c.newAttributes[V]=1,0===X[V]&&(n.enableVertexAttribArray(V),X[V]=1),Q[V]!==J&&((i.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](V,J),Q[V]=J)}function A(){const V=c.newAttributes,J=c.enabledAttributes;for(let G=0,X=J.length;G<X;G++)J[G]!==V[G]&&(n.disableVertexAttribArray(G),J[G]=0)}function D(V,J,G,X,Q,Z,le){!0===le?n.vertexAttribIPointer(V,J,G,Q,Z):n.vertexAttribPointer(V,J,G,X,Q,Z)}function ee(){se(),h=!0,c!==l&&(c=l,m(c.object))}function se(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function d(V,J,G,X,Q){let Z=!1;if(o){const le=function v(V,J,G){const X=!0===G.wireframe;let Q=a[V.id];void 0===Q&&(Q={},a[V.id]=Q);let Z=Q[J.id];void 0===Z&&(Z={},Q[J.id]=Z);let le=Z[X];return void 0===le&&(le=w(function p(){return i.isWebGL2?n.createVertexArray():s.createVertexArrayOES()}()),Z[X]=le),le}(X,G,J);c!==le&&(c=le,m(c.object)),Z=function y(V,J,G,X){const Q=c.attributes,Z=J.attributes;let le=0;const q=G.getAttributes();for(const oe in q)if(q[oe].location>=0){const ve=Q[oe];let Ne=Z[oe];if(void 0===Ne&&("instanceMatrix"===oe&&V.instanceMatrix&&(Ne=V.instanceMatrix),"instanceColor"===oe&&V.instanceColor&&(Ne=V.instanceColor)),void 0===ve||ve.attribute!==Ne||Ne&&ve.data!==Ne.data)return!0;le++}return c.attributesNum!==le||c.index!==X}(V,X,G,Q),Z&&function b(V,J,G,X){const Q={},Z=J.attributes;let le=0;const q=G.getAttributes();for(const oe in q)if(q[oe].location>=0){let ve=Z[oe];void 0===ve&&("instanceMatrix"===oe&&V.instanceMatrix&&(ve=V.instanceMatrix),"instanceColor"===oe&&V.instanceColor&&(ve=V.instanceColor));const Ne={};Ne.attribute=ve,ve&&ve.data&&(Ne.data=ve.data),Q[oe]=Ne,le++}c.attributes=Q,c.attributesNum=le,c.index=X}(V,X,G,Q)}else{const le=!0===J.wireframe;(c.geometry!==X.id||c.program!==G.id||c.wireframe!==le)&&(c.geometry=X.id,c.program=G.id,c.wireframe=le,Z=!0)}null!==Q&&t.update(Q,n.ELEMENT_ARRAY_BUFFER),(Z||h)&&(h=!1,function O(V,J,G,X){if(!1===i.isWebGL2&&(V.isInstancedMesh||X.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;E();const Q=X.attributes,Z=G.getAttributes(),le=J.defaultAttributeValues;for(const q in Z){const oe=Z[q];if(oe.location>=0){let Se=Q[q];if(void 0===Se&&("instanceMatrix"===q&&V.instanceMatrix&&(Se=V.instanceMatrix),"instanceColor"===q&&V.instanceColor&&(Se=V.instanceColor)),void 0!==Se){const ve=Se.normalized,Ne=Se.itemSize,$e=t.get(Se);if(void 0===$e)continue;const Be=$e.buffer,Xe=$e.type,dt=$e.bytesPerElement,St=!0===i.isWebGL2&&(Xe===n.INT||Xe===n.UNSIGNED_INT||1013===Se.gpuType);if(Se.isInterleavedBufferAttribute){const nt=Se.data,z=nt.stride,Le=Se.offset;if(nt.isInstancedInterleavedBuffer){for(let ye=0;ye<oe.locationSize;ye++)x(oe.location+ye,nt.meshPerAttribute);!0!==V.isInstancedMesh&&void 0===X._maxInstanceCount&&(X._maxInstanceCount=nt.meshPerAttribute*nt.count)}else for(let ye=0;ye<oe.locationSize;ye++)C(oe.location+ye);n.bindBuffer(n.ARRAY_BUFFER,Be);for(let ye=0;ye<oe.locationSize;ye++)D(oe.location+ye,Ne/oe.locationSize,Xe,ve,z*dt,(Le+Ne/oe.locationSize*ye)*dt,St)}else{if(Se.isInstancedBufferAttribute){for(let nt=0;nt<oe.locationSize;nt++)x(oe.location+nt,Se.meshPerAttribute);!0!==V.isInstancedMesh&&void 0===X._maxInstanceCount&&(X._maxInstanceCount=Se.meshPerAttribute*Se.count)}else for(let nt=0;nt<oe.locationSize;nt++)C(oe.location+nt);n.bindBuffer(n.ARRAY_BUFFER,Be);for(let nt=0;nt<oe.locationSize;nt++)D(oe.location+nt,Ne/oe.locationSize,Xe,ve,Ne*dt,Ne/oe.locationSize*nt*dt,St)}}else if(void 0!==le){const ve=le[q];if(void 0!==ve)switch(ve.length){case 2:n.vertexAttrib2fv(oe.location,ve);break;case 3:n.vertexAttrib3fv(oe.location,ve);break;case 4:n.vertexAttrib4fv(oe.location,ve);break;default:n.vertexAttrib1fv(oe.location,ve)}}}}A()}(V,J,G,X),null!==Q&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.get(Q).buffer))},reset:ee,resetDefaultState:se,dispose:function T(){ee();for(const V in a){const J=a[V];for(const G in J){const X=J[G];for(const Q in X)g(X[Q].object),delete X[Q];delete J[G]}delete a[V]}},releaseStatesOfGeometry:function R(V){if(void 0===a[V.id])return;const J=a[V.id];for(const G in J){const X=J[G];for(const Q in X)g(X[Q].object),delete X[Q];delete J[G]}delete a[V.id]},releaseStatesOfProgram:function $(V){for(const J in a){const G=a[J];if(void 0===G[V.id])continue;const X=G[V.id];for(const Q in X)g(X[Q].object),delete X[Q];delete G[V.id]}},initAttributes:E,enableAttribute:C,disableUnusedAttributes:A}}function Fte(n,e,t,i){const r=i.isWebGL2;let s;this.setMode=function o(c){s=c},this.render=function a(c,h){n.drawArrays(s,c,h),t.update(h,s,1)},this.renderInstances=function l(c,h,d){if(0===d)return;let p,m;if(r)p=n,m="drawArraysInstanced";else if(p=e.get("ANGLE_instanced_arrays"),m="drawArraysInstancedANGLE",null===p)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");p[m](s,c,h,d),t.update(h,s,d)}}function kte(n,e,t){let i;function s(D){if("highp"===D){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";D="mediump"}return"mediump"===D&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&"WebGL2RenderingContext"===n.constructor.name;let a=void 0!==t.precision?t.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const c=o||e.has("WEBGL_draw_buffers"),h=!0===t.logarithmicDepthBuffer,d=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),p=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),m=n.getParameter(n.MAX_TEXTURE_SIZE),g=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),v=n.getParameter(n.MAX_VERTEX_ATTRIBS),w=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),y=n.getParameter(n.MAX_VARYING_VECTORS),b=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),E=p>0,C=o||e.has("OES_texture_float");return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:function r(){if(void 0!==i)return i;if(!0===e.has("EXT_texture_filter_anisotropic")){const D=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(D.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:s,precision:a,logarithmicDepthBuffer:h,maxTextures:d,maxVertexTextures:p,maxTextureSize:m,maxCubemapSize:g,maxAttributes:v,maxVertexUniforms:w,maxVaryings:y,maxFragmentUniforms:b,vertexTextures:E,floatFragmentTextures:C,floatVertexTextures:E&&C,maxSamples:o?n.getParameter(n.MAX_SAMPLES):0}}function Ute(n){const e=this;let t=null,i=0,r=!1,s=!1;const o=new nc,a=new Kt,l={value:null,needsUpdate:!1};function h(d,p,m,g){const v=null!==d?d.length:0;let w=null;if(0!==v){if(w=l.value,!0!==g||null===w){const y=m+4*v,b=p.matrixWorldInverse;a.getNormalMatrix(b),(null===w||w.length<y)&&(w=new Float32Array(y));for(let E=0,C=m;E!==v;++E,C+=4)o.copy(d[E]).applyMatrix4(b,a),o.normal.toArray(w,C),w[C+3]=o.constant}l.value=w,l.needsUpdate=!0}return e.numPlanes=v,e.numIntersection=0,w}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(d,p){const m=0!==d.length||p||0!==i||r;return r=p,i=d.length,m},this.beginShadows=function(){s=!0,h(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(d,p){t=h(d,p,0)},this.setState=function(d,p,m){const g=d.clippingPlanes,v=d.clipIntersection,w=d.clipShadows,y=n.get(d);if(!r||null===g||0===g.length||s&&!w)s?h(null):function c(){l.value!==t&&(l.value=t,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}();else{const b=s?0:i,E=4*b;let C=y.clippingState||null;l.value=C,C=h(g,p,E,m);for(let x=0;x!==E;++x)C[x]=t[x];y.clippingState=C,this.numIntersection=v?this.numPlanes:0,this.numPlanes+=b}}}function Bte(n){let e=new WeakMap;function t(o,a){return 303===a?o.mapping=du:304===a&&(o.mapping=Vh),o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=e.get(a);void 0!==l&&(e.delete(a),l.dispose())}return{get:function i(o){if(o&&o.isTexture&&!1===o.isRenderTargetTexture){const a=o.mapping;if(303===a||304===a){if(e.has(o))return t(e.get(o).texture,o.mapping);{const l=o.image;if(l&&l.height>0){const c=new NQ(l.height/2);return c.fromEquirectangularTexture(n,o),e.set(o,c),o.addEventListener("dispose",r),t(c.texture,o.mapping)}return null}}}return o},dispose:function s(){e=new WeakMap}}}class AS extends aI{constructor(e=-1,t=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,s,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,o=i+e,a=r+t,l=r-t;if(null!==this.view&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,h=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=h*this.view.offsetY,l=a-h*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const xV=[.125,.215,.35,.446,.526,.582],uI=new AS,MV=new We;let hI=null;const ed=(1+Math.sqrt(5))/2,_m=1/ed,TV=[new L(1,1,1),new L(-1,1,1),new L(1,1,-1),new L(-1,1,-1),new L(0,ed,_m),new L(0,ed,-_m),new L(_m,0,ed),new L(-_m,0,ed),new L(ed,_m,0),new L(-ed,_m,0)];class dI{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){hI=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=IV(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=DV(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(hI),e.scissorTest=!1,DS(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(e.mapping===du||e.mapping===Vh?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),hI=this._renderer.getRenderTarget();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:hi,minFilter:hi,generateMipmaps:!1,type:Yy,format:Do,colorSpace:Tr,depthBuffer:!1},r=AV(e,t,i);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=AV(e,t,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function Vte(n){const e=[],t=[],i=[];let r=n;const s=n-4+1+xV.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let l=1/a;o>n-4?l=xV[o-n+4-1]:0===o&&(l=0),i.push(l);const c=1/(a-2),h=-c,d=1+c,p=[h,h,d,h,d,d,h,h,d,d,h,d],m=6,g=6,v=3,w=2,y=1,b=new Float32Array(v*g*m),E=new Float32Array(w*g*m),C=new Float32Array(y*g*m);for(let A=0;A<m;A++){const D=A%3*2/3-1,O=A>2?0:-1;b.set([D,O,0,D+2/3,O,0,D+2/3,O+1,0,D,O,0,D+2/3,O+1,0,D,O+1,0],v*g*A),E.set(p,w*g*A),C.set([A,A,A,A,A,A],y*g*A)}const x=new Rt;x.setAttribute("position",new Kn(b,v)),x.setAttribute("uv",new Kn(E,w)),x.setAttribute("faceIndex",new Kn(C,y)),e.push(x),r>4&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}(s)),this._blurMaterial=function Hte(n,e,t){const i=new Float32Array(20),r=new L(0,1,0);return new tc({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(s,e,t)}return r}_compileMaterial(e){const t=new Me(this._lodPlanes[0],e);this._renderer.compile(t,uI)}_sceneToCubeUV(e,t,i,r){const a=new ir(90,1,t,i),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],h=this._renderer,d=h.autoClear,p=h.toneMapping;h.getClearColor(MV),h.toneMapping=hu,h.autoClear=!1;const m=new bi({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),g=new Me(new oi,m);let v=!1;const w=e.background;w?w.isColor&&(m.color.copy(w),e.background=null,v=!0):(m.color.copy(MV),v=!0);for(let y=0;y<6;y++){const b=y%3;0===b?(a.up.set(0,l[y],0),a.lookAt(c[y],0,0)):1===b?(a.up.set(0,0,l[y]),a.lookAt(0,c[y],0)):(a.up.set(0,l[y],0),a.lookAt(0,0,c[y]));const E=this._cubeSize;DS(r,b*E,y>2?E:0,E,E),h.setRenderTarget(r),v&&h.render(g,a),h.render(e,a)}g.geometry.dispose(),g.material.dispose(),h.toneMapping=p,h.autoClear=d,e.background=w}_textureToCubeUV(e,t){const i=this._renderer,r=e.mapping===du||e.mapping===Vh;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=IV()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=DV());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new Me(this._lodPlanes[0],s);s.uniforms.envMap.value=e;const l=this._cubeSize;DS(t,0,0,3*l,2*l),i.setRenderTarget(t),i.render(o,uI)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]);this._blur(e,r-1,r,s,TV[(r-1)%TV.length])}t.autoClear=i}_blur(e,t,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,o,a){const l=this._renderer,c=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const d=new Me(this._lodPlanes[r],c),p=c.uniforms,m=this._sizeLods[i]-1,g=isFinite(s)?Math.PI/(2*m):2*Math.PI/39,v=s/g,w=isFinite(s)?1+Math.floor(3*v):20;w>20&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${w} samples when the maximum is set to 20`);const y=[];let b=0;for(let D=0;D<20;++D){const O=D/v,T=Math.exp(-O*O/2);y.push(T),0===D?b+=T:D<w&&(b+=2*T)}for(let D=0;D<y.length;D++)y[D]=y[D]/b;p.envMap.value=e.texture,p.samples.value=w,p.weights.value=y,p.latitudinal.value="latitudinal"===o,a&&(p.poleAxis.value=a);const{_lodMax:E}=this;p.dTheta.value=g,p.mipInt.value=E-i;const C=this._sizeLods[r];DS(t,3*C*(r>E-4?r-E+4:0),4*(this._cubeSize-C),3*C,2*C),l.setRenderTarget(t),l.render(d,uI)}}function AV(n,e,t){const i=new Xh(n,e,t);return i.texture.mapping=$y,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function DS(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function DV(){return new tc({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function IV(){return new tc({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function zte(n){let e=new WeakMap,t=null;function s(a){const l=a.target;l.removeEventListener("dispose",s);const c=e.get(l);void 0!==c&&(e.delete(l),c.dispose())}return{get:function i(a){if(a&&a.isTexture){const l=a.mapping,c=303===l||304===l,h=l===du||l===Vh;if(c||h){if(a.isRenderTargetTexture&&!0===a.needsPMREMUpdate){a.needsPMREMUpdate=!1;let d=e.get(a);return null===t&&(t=new dI(n)),d=c?t.fromEquirectangular(a,d):t.fromCubemap(a,d),e.set(a,d),d.texture}if(e.has(a))return e.get(a).texture;{const d=a.image;if(c&&d&&d.height>0||h&&d&&function r(a){let l=0;for(let h=0;h<6;h++)void 0!==a[h]&&l++;return 6===l}(d)){null===t&&(t=new dI(n));const p=c?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,p),a.addEventListener("dispose",s),p.texture}return null}}}return a},dispose:function o(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function Gte(n){const e={};function t(i){if(void 0!==e[i])return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return null!==t(i)},init:function(i){i.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){const r=t(i);return null===r&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function Wte(n,e,t,i){const r={},s=new WeakMap;function o(d){const p=d.target;null!==p.index&&e.remove(p.index);for(const g in p.attributes)e.remove(p.attributes[g]);for(const g in p.morphAttributes){const v=p.morphAttributes[g];for(let w=0,y=v.length;w<y;w++)e.remove(v[w])}p.removeEventListener("dispose",o),delete r[p.id];const m=s.get(p);m&&(e.remove(m),s.delete(p)),i.releaseStatesOfGeometry(p),!0===p.isInstancedBufferGeometry&&delete p._maxInstanceCount,t.memory.geometries--}function c(d){const p=[],m=d.index,g=d.attributes.position;let v=0;if(null!==m){const b=m.array;v=m.version;for(let E=0,C=b.length;E<C;E+=3){const x=b[E+0],A=b[E+1],D=b[E+2];p.push(x,A,A,D,D,x)}}else{if(void 0===g)return;v=g.version;for(let E=0,C=g.array.length/3-1;E<C;E+=3){const x=E+0,A=E+1,D=E+2;p.push(x,A,A,D,D,x)}}const w=new(eV(p)?_V:gV)(p,1);w.version=v;const y=s.get(d);y&&e.remove(y),s.set(d,w)}return{get:function a(d,p){return!0===r[p.id]||(p.addEventListener("dispose",o),r[p.id]=!0,t.memory.geometries++),p},update:function l(d){const p=d.attributes;for(const g in p)e.update(p[g],n.ARRAY_BUFFER);const m=d.morphAttributes;for(const g in m){const v=m[g];for(let w=0,y=v.length;w<y;w++)e.update(v[w],n.ARRAY_BUFFER)}},getWireframeAttribute:function h(d){const p=s.get(d);if(p){const m=d.index;null!==m&&p.version<m.version&&c(d)}else c(d);return s.get(d)}}}function jte(n,e,t,i){const r=i.isWebGL2;let s,a,l;this.setMode=function o(p){s=p},this.setIndex=function c(p){a=p.type,l=p.bytesPerElement},this.render=function h(p,m){n.drawElements(s,m,a,p*l),t.update(m,s,1)},this.renderInstances=function d(p,m,g){if(0===g)return;let v,w;if(r)v=n,w="drawElementsInstanced";else if(v=e.get("ANGLE_instanced_arrays"),w="drawElementsInstancedANGLE",null===v)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");v[w](s,m,a,p*l,g),t.update(m,s,g)}}function $te(n){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function i(s,o,a){switch(t.calls++,o){case n.TRIANGLES:t.triangles+=a*(s/3);break;case n.LINES:t.lines+=a*(s/2);break;case n.LINE_STRIP:t.lines+=a*(s-1);break;case n.LINE_LOOP:t.lines+=a*s;break;case n.POINTS:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o)}}}}function qte(n,e){return n[0]-e[0]}function Xte(n,e){return Math.abs(e[1])-Math.abs(n[1])}function Yte(n,e,t){const i={},r=new Float32Array(8),s=new WeakMap,o=new Nn,a=[];for(let c=0;c<8;c++)a[c]=[c,0];return{update:function l(c,h,d){const p=c.morphTargetInfluences;if(!0===e.isWebGL2){const m=h.morphAttributes.position||h.morphAttributes.normal||h.morphAttributes.color,g=void 0!==m?m.length:0;let v=s.get(h);if(void 0===v||v.count!==g){let V=function(){ee.dispose(),s.delete(h),h.removeEventListener("dispose",V)};void 0!==v&&v.texture.dispose();const b=void 0!==h.morphAttributes.position,E=void 0!==h.morphAttributes.normal,C=void 0!==h.morphAttributes.color,x=h.morphAttributes.position||[],A=h.morphAttributes.normal||[],D=h.morphAttributes.color||[];let O=0;!0===b&&(O=1),!0===E&&(O=2),!0===C&&(O=3);let T=h.attributes.position.count*O,R=1;T>e.maxTextureSize&&(R=Math.ceil(T/e.maxTextureSize),T=e.maxTextureSize);const $=new Float32Array(T*R*4*g),ee=new $D($,T,R,g);ee.type=$l,ee.needsUpdate=!0;const se=4*O;for(let J=0;J<g;J++){const G=x[J],X=A[J],Q=D[J],Z=T*R*4*J;for(let le=0;le<G.count;le++){const q=le*se;!0===b&&(o.fromBufferAttribute(G,le),$[Z+q+0]=o.x,$[Z+q+1]=o.y,$[Z+q+2]=o.z,$[Z+q+3]=0),!0===E&&(o.fromBufferAttribute(X,le),$[Z+q+4]=o.x,$[Z+q+5]=o.y,$[Z+q+6]=o.z,$[Z+q+7]=0),!0===C&&(o.fromBufferAttribute(Q,le),$[Z+q+8]=o.x,$[Z+q+9]=o.y,$[Z+q+10]=o.z,$[Z+q+11]=4===Q.itemSize?o.w:1)}}v={count:g,texture:ee,size:new fe(T,R)},s.set(h,v),h.addEventListener("dispose",V)}let w=0;for(let b=0;b<p.length;b++)w+=p[b];const y=h.morphTargetsRelative?1:1-w;d.getUniforms().setValue(n,"morphTargetBaseInfluence",y),d.getUniforms().setValue(n,"morphTargetInfluences",p),d.getUniforms().setValue(n,"morphTargetsTexture",v.texture,t),d.getUniforms().setValue(n,"morphTargetsTextureSize",v.size)}else{const m=void 0===p?0:p.length;let g=i[h.id];if(void 0===g||g.length!==m){g=[];for(let E=0;E<m;E++)g[E]=[E,0];i[h.id]=g}for(let E=0;E<m;E++){const C=g[E];C[0]=E,C[1]=p[E]}g.sort(Xte);for(let E=0;E<8;E++)E<m&&g[E][1]?(a[E][0]=g[E][0],a[E][1]=g[E][1]):(a[E][0]=Number.MAX_SAFE_INTEGER,a[E][1]=0);a.sort(qte);const v=h.morphAttributes.position,w=h.morphAttributes.normal;let y=0;for(let E=0;E<8;E++){const C=a[E],x=C[0],A=C[1];x!==Number.MAX_SAFE_INTEGER&&A?(v&&h.getAttribute("morphTarget"+E)!==v[x]&&h.setAttribute("morphTarget"+E,v[x]),w&&h.getAttribute("morphNormal"+E)!==w[x]&&h.setAttribute("morphNormal"+E,w[x]),r[E]=A,y+=A):(v&&!0===h.hasAttribute("morphTarget"+E)&&h.deleteAttribute("morphTarget"+E),w&&!0===h.hasAttribute("morphNormal"+E)&&h.deleteAttribute("morphNormal"+E),r[E]=0)}const b=h.morphTargetsRelative?1:1-y;d.getUniforms().setValue(n,"morphTargetBaseInfluence",b),d.getUniforms().setValue(n,"morphTargetInfluences",r)}}}}function Kte(n,e,t,i){let r=new WeakMap;function a(l){const c=l.target;c.removeEventListener("dispose",a),t.remove(c.instanceMatrix),null!==c.instanceColor&&t.remove(c.instanceColor)}return{update:function s(l){const c=i.render.frame,d=e.get(l,l.geometry);if(r.get(d)!==c&&(e.update(d),r.set(d,c)),l.isInstancedMesh&&(!1===l.hasEventListener("dispose",a)&&l.addEventListener("dispose",a),r.get(l)!==c&&(t.update(l.instanceMatrix,n.ARRAY_BUFFER),null!==l.instanceColor&&t.update(l.instanceColor,n.ARRAY_BUFFER),r.set(l,c))),l.isSkinnedMesh){const p=l.skeleton;r.get(p)!==c&&(p.update(),r.set(p,c))}return d},dispose:function o(){r=new WeakMap}}}const RV=new Ro,PV=new $D,NV=new sV,LV=new xS,OV=[],FV=[],kV=new Float32Array(16),UV=new Float32Array(9),BV=new Float32Array(4);function ym(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let s=OV[r];if(void 0===s&&(s=new Float32Array(r),OV[r]=s),0!==e){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function rr(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function sr(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function IS(n,e){let t=FV[e];void 0===t&&(t=new Int32Array(e),FV[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function Zte(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function Jte(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(rr(t,e))return;n.uniform2fv(this.addr,e),sr(t,e)}}function Qte(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(rr(t,e))return;n.uniform3fv(this.addr,e),sr(t,e)}}function ene(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(rr(t,e))return;n.uniform4fv(this.addr,e),sr(t,e)}}function tne(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(rr(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),sr(t,e)}else{if(rr(t,i))return;BV.set(i),n.uniformMatrix2fv(this.addr,!1,BV),sr(t,i)}}function nne(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(rr(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),sr(t,e)}else{if(rr(t,i))return;UV.set(i),n.uniformMatrix3fv(this.addr,!1,UV),sr(t,i)}}function ine(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(rr(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),sr(t,e)}else{if(rr(t,i))return;kV.set(i),n.uniformMatrix4fv(this.addr,!1,kV),sr(t,i)}}function rne(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function sne(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(rr(t,e))return;n.uniform2iv(this.addr,e),sr(t,e)}}function one(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(rr(t,e))return;n.uniform3iv(this.addr,e),sr(t,e)}}function ane(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(rr(t,e))return;n.uniform4iv(this.addr,e),sr(t,e)}}function lne(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function cne(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(rr(t,e))return;n.uniform2uiv(this.addr,e),sr(t,e)}}function une(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(rr(t,e))return;n.uniform3uiv(this.addr,e),sr(t,e)}}function hne(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(rr(t,e))return;n.uniform4uiv(this.addr,e),sr(t,e)}}function dne(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2D(e||RV,r)}function fne(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||NV,r)}function pne(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||LV,r)}function mne(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||PV,r)}function _ne(n,e){n.uniform1fv(this.addr,e)}function yne(n,e){const t=ym(e,this.size,2);n.uniform2fv(this.addr,t)}function vne(n,e){const t=ym(e,this.size,3);n.uniform3fv(this.addr,t)}function wne(n,e){const t=ym(e,this.size,4);n.uniform4fv(this.addr,t)}function bne(n,e){const t=ym(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function Ene(n,e){const t=ym(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function Sne(n,e){const t=ym(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function Cne(n,e){n.uniform1iv(this.addr,e)}function xne(n,e){n.uniform2iv(this.addr,e)}function Mne(n,e){n.uniform3iv(this.addr,e)}function Tne(n,e){n.uniform4iv(this.addr,e)}function Ane(n,e){n.uniform1uiv(this.addr,e)}function Dne(n,e){n.uniform2uiv(this.addr,e)}function Ine(n,e){n.uniform3uiv(this.addr,e)}function Rne(n,e){n.uniform4uiv(this.addr,e)}function Pne(n,e,t){const i=this.cache,r=e.length,s=IS(t,r);rr(i,s)||(n.uniform1iv(this.addr,s),sr(i,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||RV,s[o])}function Nne(n,e,t){const i=this.cache,r=e.length,s=IS(t,r);rr(i,s)||(n.uniform1iv(this.addr,s),sr(i,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||NV,s[o])}function Lne(n,e,t){const i=this.cache,r=e.length,s=IS(t,r);rr(i,s)||(n.uniform1iv(this.addr,s),sr(i,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||LV,s[o])}function One(n,e,t){const i=this.cache,r=e.length,s=IS(t,r);rr(i,s)||(n.uniform1iv(this.addr,s),sr(i,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||PV,s[o])}class kne{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.setValue=function gne(n){switch(n){case 5126:return Zte;case 35664:return Jte;case 35665:return Qte;case 35666:return ene;case 35674:return tne;case 35675:return nne;case 35676:return ine;case 5124:case 35670:return rne;case 35667:case 35671:return sne;case 35668:case 35672:return one;case 35669:case 35673:return ane;case 5125:return lne;case 36294:return cne;case 36295:return une;case 36296:return hne;case 35678:case 36198:case 36298:case 36306:case 35682:return dne;case 35679:case 36299:case 36307:return fne;case 35680:case 36300:case 36308:case 36293:return pne;case 36289:case 36303:case 36311:case 36292:return mne}}(t.type)}}class Une{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.size=t.size,this.setValue=function Fne(n){switch(n){case 5126:return _ne;case 35664:return yne;case 35665:return vne;case 35666:return wne;case 35674:return bne;case 35675:return Ene;case 35676:return Sne;case 5124:case 35670:return Cne;case 35667:case 35671:return xne;case 35668:case 35672:return Mne;case 35669:case 35673:return Tne;case 5125:return Ane;case 36294:return Dne;case 36295:return Ine;case 36296:return Rne;case 35678:case 36198:case 36298:case 36306:case 35682:return Pne;case 35679:case 36299:case 36307:return Nne;case 35680:case 36300:case 36308:case 36293:return Lne;case 36289:case 36303:case 36311:case 36292:return One}}(t.type)}}class Bne{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,t[a.id],i)}}}const pI=/(\w+)(\])?(\[|\.)?/g;function VV(n,e){n.seq.push(e),n.map[e.id]=e}function Vne(n,e,t){const i=n.name,r=i.length;for(pI.lastIndex=0;;){const s=pI.exec(i);let a=s[1];const c=s[3];if("]"===s[2]&&(a|=0),void 0===c||"["===c&&pI.lastIndex+2===r){VV(t,void 0===c?new kne(a,n,e):new Une(a,n,e));break}{let d=t.map[a];void 0===d&&(d=new Bne(a),VV(t,d)),t=d}}}class RS{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<i;++r){const s=e.getActiveUniform(t,r);Vne(s,e.getUniformLocation(t,s.name),this)}}setValue(e,t,i,r){const s=this.map[t];void 0!==s&&s.setValue(e,i,r)}setOptional(e,t,i){const r=t[i];void 0!==r&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let s=0,o=t.length;s!==o;++s){const a=t[s],l=i[a.id];!1!==l.needsUpdate&&a.setValue(e,l.value,r)}}static seqWithValue(e,t){const i=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&i.push(o)}return i}}function HV(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}let Hne=0;function zV(n,e,t){const i=n.getShaderParameter(e,n.COMPILE_STATUS),r=n.getShaderInfoLog(e).trim();if(i&&""===r)return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return t.toUpperCase()+"\n\n"+r+"\n\n"+function zne(n,e){const t=n.split("\n"),i=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const a=o+1;i.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return i.join("\n")}(n.getShaderSource(e),o)}return r}function Wne(n,e){const t=function Gne(n){const e=Sn.getPrimaries(Sn.workingColorSpace),t=Sn.getPrimaries(n);let i;switch(e===t?i="":e===iS&&t===nS?i="LinearDisplayP3ToLinearSRGB":e===nS&&t===iS&&(i="LinearSRGBToLinearDisplayP3"),n){case Tr:case eS:return[i,"LinearTransferOETF"];case di:case UD:return[i,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",n),[i,"LinearTransferOETF"]}}(e);return`vec4 ${n}( vec4 value ) { return ${t[0]}( ${t[1]}( value ) ); }`}function jne(n,e){let t;switch(e){case bJ:t="Linear";break;case EJ:t="Reinhard";break;case SJ:t="OptimizedCineon";break;case CJ:t="ACESFilmic";break;case xJ:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function sv(n){return""!==n}function GV(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function WV(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Yne=/^[ \t]*#include +<([\w\d./]+)>/gm;function mI(n){return n.replace(Yne,Zne)}const Kne=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function Zne(n,e){let t=qt[e];if(void 0===t){const i=Kne.get(e);if(void 0===i)throw new Error("Can not resolve #include <"+e+">");t=qt[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i)}return mI(t)}const Jne=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function jV(n){return n.replace(Jne,Qne)}function Qne(n,e,t,i){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function $V(n){let e="precision "+n.precision+" float;\nprecision "+n.precision+" int;";return"highp"===n.precision?e+="\n#define HIGH_PRECISION":"mediump"===n.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===n.precision&&(e+="\n#define LOW_PRECISION"),e}function sie(n,e,t,i){const r=n.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=function eie(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===cB?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===QZ?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===Gl&&(e="SHADOWMAP_TYPE_VSM"),e}(t),c=function tie(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case du:case Vh:e="ENVMAP_TYPE_CUBE";break;case $y:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),h=function nie(n){let e="ENVMAP_MODE_REFLECTION";return n.envMap&&n.envMapMode===Vh&&(e="ENVMAP_MODE_REFRACTION"),e}(t),d=function iie(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case YE:e="ENVMAP_BLENDING_MULTIPLY";break;case vJ:e="ENVMAP_BLENDING_MIX";break;case wJ:e="ENVMAP_BLENDING_ADD"}return e}(t),p=function rie(n){const e=n.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:i,maxMip:t}}(t),m=t.isWebGL2?"":function $ne(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.normalMapTangentSpace||n.clearcoatNormalMap||n.flatShading||"physical"===n.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(sv).join("\n")}(t),g=function qne(n){const e=[];for(const t in n){const i=n[t];!1!==i&&e.push("#define "+t+" "+i)}return e.join("\n")}(s),v=r.createProgram();let w,y,b=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(w=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,g].filter(sv).join("\n"),w.length>0&&(w+="\n"),y=[m,"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,g].filter(sv).join("\n"),y.length>0&&(y+="\n")):(w=[$V(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,g,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+h:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(sv).join("\n"),y=[m,$V(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,g,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+h:"",t.envMap?"#define "+d:"",p?"#define CUBEUV_TEXEL_WIDTH "+p.texelWidth:"",p?"#define CUBEUV_TEXEL_HEIGHT "+p.texelHeight:"",p?"#define CUBEUV_MAX_MIP "+p.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==hu?"#define TONE_MAPPING":"",t.toneMapping!==hu?qt.tonemapping_pars_fragment:"",t.toneMapping!==hu?jne("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",qt.colorspace_pars_fragment,Wne("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(sv).join("\n")),o=mI(o),o=GV(o,t),o=WV(o,t),a=mI(a),a=GV(a,t),a=WV(a,t),o=jV(o),a=jV(a),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(b="#version 300 es\n",w=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+w,y=["#define varying in",t.glslVersion===ZB?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===ZB?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+y);const C=b+y+a,x=HV(r,r.VERTEX_SHADER,b+w+o),A=HV(r,r.FRAGMENT_SHADER,C);if(r.attachShader(v,x),r.attachShader(v,A),void 0!==t.index0AttributeName?r.bindAttribLocation(v,0,t.index0AttributeName):!0===t.morphTargets&&r.bindAttribLocation(v,0,"position"),r.linkProgram(v),n.debug.checkShaderErrors){const T=r.getProgramInfoLog(v).trim(),R=r.getShaderInfoLog(x).trim(),$=r.getShaderInfoLog(A).trim();let ee=!0,se=!0;if(!1===r.getProgramParameter(v,r.LINK_STATUS))if(ee=!1,"function"==typeof n.debug.onShaderError)n.debug.onShaderError(r,v,x,A);else{const V=zV(r,x,"vertex"),J=zV(r,A,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(v,r.VALIDATE_STATUS)+"\n\nProgram Info Log: "+T+"\n"+V+"\n"+J)}else""!==T?console.warn("THREE.WebGLProgram: Program Info Log:",T):(""===R||""===$)&&(se=!1);se&&(this.diagnostics={runnable:ee,programLog:T,vertexShader:{log:R,prefix:w},fragmentShader:{log:$,prefix:y}})}let D,O;return r.deleteShader(x),r.deleteShader(A),this.getUniforms=function(){return void 0===D&&(D=new RS(r,v)),D},this.getAttributes=function(){return void 0===O&&(O=function Xne(n,e){const t={},i=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const s=n.getActiveAttrib(e,r),o=s.name;let a=1;s.type===n.FLOAT_MAT2&&(a=2),s.type===n.FLOAT_MAT3&&(a=3),s.type===n.FLOAT_MAT4&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}(r,v)),O},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(v),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=Hne++,this.cacheKey=e,this.usedTimes=1,this.program=v,this.vertexShader=x,this.fragmentShader=A,this}let oie=0;class aie{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.fragmentShader,r=this._getShaderStage(e.vertexShader),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return!1===o.has(r)&&(o.add(r),r.usedTimes++),!1===o.has(s)&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,0===i.usedTimes&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return void 0===i&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return void 0===i&&(i=new lie(e),t.set(e,i)),i}}class lie{constructor(e){this.id=oie++,this.code=e,this.usedTimes=0}}function cie(n,e,t,i,r,s,o){const a=new QD,l=new aie,c=[],h=r.isWebGL2,d=r.logarithmicDepthBuffer,p=r.vertexTextures;let m=r.precision;const g={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function v(T){return 0===T?"uv":`uv${T}`}return{getParameters:function w(T,R,$,ee,se){const V=ee.fog,J=se.geometry,X=(T.isMeshStandardMaterial?t:e).get(T.envMap||(T.isMeshStandardMaterial?ee.environment:null)),Q=X&&X.mapping===$y?X.image.height:null,Z=g[T.type];null!==T.precision&&(m=r.getMaxPrecision(T.precision),m!==T.precision&&console.warn("THREE.WebGLProgram.getParameters:",T.precision,"not supported, using",m,"instead."));const le=J.morphAttributes.position||J.morphAttributes.normal||J.morphAttributes.color,q=void 0!==le?le.length:0;let Se,ve,Ne,$e,oe=0;if(void 0!==J.morphAttributes.position&&(oe=1),void 0!==J.morphAttributes.normal&&(oe=2),void 0!==J.morphAttributes.color&&(oe=3),Z){const ri=Ka[Z];Se=ri.vertexShader,ve=ri.fragmentShader}else Se=T.vertexShader,ve=T.fragmentShader,l.update(T),Ne=l.getVertexShaderID(T),$e=l.getFragmentShaderID(T);const Be=n.getRenderTarget(),Xe=!0===se.isInstancedMesh,dt=!!T.map,nt=!!X,z=!!T.aoMap,Le=!!T.lightMap,ye=!!T.bumpMap,Ae=!!T.normalMap,Ee=!!T.displacementMap,ot=!!T.emissiveMap,Ze=!!T.metalnessMap,Qe=!!T.roughnessMap,bt=T.anisotropy>0,en=T.clearcoat>0,li=T.iridescence>0,k=T.sheen>0,P=T.transmission>0,ie=bt&&!!T.anisotropyMap,Te=en&&!!T.clearcoatMap,xe=en&&!!T.clearcoatNormalMap,De=en&&!!T.clearcoatRoughnessMap,rt=li&&!!T.iridescenceMap,Ie=li&&!!T.iridescenceThicknessMap,qe=k&&!!T.sheenColorMap,W=k&&!!T.sheenRoughnessMap,Re=!!T.specularMap,we=!!T.specularColorMap,Ct=!!T.specularIntensityMap,at=P&&!!T.transmissionMap,ft=P&&!!T.thicknessMap,H=!!T.alphaMap,je=!!T.extensions,ke=!!J.attributes.uv1,Ce=!!J.attributes.uv2,it=!!J.attributes.uv3;let Tt=hu;return T.toneMapped&&(null===Be||!0===Be.isXRRenderTarget)&&(Tt=n.toneMapping),{isWebGL2:h,shaderID:Z,shaderType:T.type,shaderName:T.name,vertexShader:Se,fragmentShader:ve,defines:T.defines,customVertexShaderID:Ne,customFragmentShaderID:$e,isRawShaderMaterial:!0===T.isRawShaderMaterial,glslVersion:T.glslVersion,precision:m,instancing:Xe,instancingColor:Xe&&null!==se.instanceColor,supportsVertexTextures:p,outputColorSpace:null===Be?n.outputColorSpace:!0===Be.isXRRenderTarget?Be.texture.colorSpace:Tr,map:dt,matcap:!!T.matcap,envMap:nt,envMapMode:nt&&X.mapping,envMapCubeUVHeight:Q,aoMap:z,lightMap:Le,bumpMap:ye,normalMap:Ae,displacementMap:p&&Ee,emissiveMap:ot,normalMapObjectSpace:Ae&&1===T.normalMapType,normalMapTangentSpace:Ae&&0===T.normalMapType,metalnessMap:Ze,roughnessMap:Qe,anisotropy:bt,anisotropyMap:ie,clearcoat:en,clearcoatMap:Te,clearcoatNormalMap:xe,clearcoatRoughnessMap:De,iridescence:li,iridescenceMap:rt,iridescenceThicknessMap:Ie,sheen:k,sheenColorMap:qe,sheenRoughnessMap:W,specularMap:Re,specularColorMap:we,specularIntensityMap:Ct,transmission:P,transmissionMap:at,thicknessMap:ft,gradientMap:!!T.gradientMap,opaque:!1===T.transparent&&1===T.blending,alphaMap:H,alphaTest:T.alphaTest>0,alphaHash:!!T.alphaHash,combine:T.combine,mapUv:dt&&v(T.map.channel),aoMapUv:z&&v(T.aoMap.channel),lightMapUv:Le&&v(T.lightMap.channel),bumpMapUv:ye&&v(T.bumpMap.channel),normalMapUv:Ae&&v(T.normalMap.channel),displacementMapUv:Ee&&v(T.displacementMap.channel),emissiveMapUv:ot&&v(T.emissiveMap.channel),metalnessMapUv:Ze&&v(T.metalnessMap.channel),roughnessMapUv:Qe&&v(T.roughnessMap.channel),anisotropyMapUv:ie&&v(T.anisotropyMap.channel),clearcoatMapUv:Te&&v(T.clearcoatMap.channel),clearcoatNormalMapUv:xe&&v(T.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:De&&v(T.clearcoatRoughnessMap.channel),iridescenceMapUv:rt&&v(T.iridescenceMap.channel),iridescenceThicknessMapUv:Ie&&v(T.iridescenceThicknessMap.channel),sheenColorMapUv:qe&&v(T.sheenColorMap.channel),sheenRoughnessMapUv:W&&v(T.sheenRoughnessMap.channel),specularMapUv:Re&&v(T.specularMap.channel),specularColorMapUv:we&&v(T.specularColorMap.channel),specularIntensityMapUv:Ct&&v(T.specularIntensityMap.channel),transmissionMapUv:at&&v(T.transmissionMap.channel),thicknessMapUv:ft&&v(T.thicknessMap.channel),alphaMapUv:H&&v(T.alphaMap.channel),vertexTangents:!!J.attributes.tangent&&(Ae||bt),vertexColors:T.vertexColors,vertexAlphas:!0===T.vertexColors&&!!J.attributes.color&&4===J.attributes.color.itemSize,vertexUv1s:ke,vertexUv2s:Ce,vertexUv3s:it,pointsUvs:!0===se.isPoints&&!!J.attributes.uv&&(dt||H),fog:!!V,useFog:!0===T.fog,fogExp2:V&&V.isFogExp2,flatShading:!0===T.flatShading,sizeAttenuation:!0===T.sizeAttenuation,logarithmicDepthBuffer:d,skinning:!0===se.isSkinnedMesh,morphTargets:void 0!==J.morphAttributes.position,morphNormals:void 0!==J.morphAttributes.normal,morphColors:void 0!==J.morphAttributes.color,morphTargetsCount:q,morphTextureStride:oe,numDirLights:R.directional.length,numPointLights:R.point.length,numSpotLights:R.spot.length,numSpotLightMaps:R.spotLightMap.length,numRectAreaLights:R.rectArea.length,numHemiLights:R.hemi.length,numDirLightShadows:R.directionalShadowMap.length,numPointLightShadows:R.pointShadowMap.length,numSpotLightShadows:R.spotShadowMap.length,numSpotLightShadowsWithMaps:R.numSpotLightShadowsWithMaps,numLightProbes:R.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:T.dithering,shadowMapEnabled:n.shadowMap.enabled&&$.length>0,shadowMapType:n.shadowMap.type,toneMapping:Tt,useLegacyLights:n._useLegacyLights,decodeVideoTexture:dt&&!0===T.map.isVideoTexture&&Sn.getTransfer(T.map.colorSpace)===ni,premultipliedAlpha:T.premultipliedAlpha,doubleSided:2===T.side,flipSided:1===T.side,useDepthPacking:T.depthPacking>=0,depthPacking:T.depthPacking||0,index0AttributeName:T.index0AttributeName,extensionDerivatives:je&&!0===T.extensions.derivatives,extensionFragDepth:je&&!0===T.extensions.fragDepth,extensionDrawBuffers:je&&!0===T.extensions.drawBuffers,extensionShaderTextureLOD:je&&!0===T.extensions.shaderTextureLOD,rendererExtensionFragDepth:h||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:h||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:h||i.has("EXT_shader_texture_lod"),customProgramCacheKey:T.customProgramCacheKey()}},getProgramCacheKey:function y(T){const R=[];if(T.shaderID?R.push(T.shaderID):(R.push(T.customVertexShaderID),R.push(T.customFragmentShaderID)),void 0!==T.defines)for(const $ in T.defines)R.push($),R.push(T.defines[$]);return!1===T.isRawShaderMaterial&&(function b(T,R){T.push(R.precision),T.push(R.outputColorSpace),T.push(R.envMapMode),T.push(R.envMapCubeUVHeight),T.push(R.mapUv),T.push(R.alphaMapUv),T.push(R.lightMapUv),T.push(R.aoMapUv),T.push(R.bumpMapUv),T.push(R.normalMapUv),T.push(R.displacementMapUv),T.push(R.emissiveMapUv),T.push(R.metalnessMapUv),T.push(R.roughnessMapUv),T.push(R.anisotropyMapUv),T.push(R.clearcoatMapUv),T.push(R.clearcoatNormalMapUv),T.push(R.clearcoatRoughnessMapUv),T.push(R.iridescenceMapUv),T.push(R.iridescenceThicknessMapUv),T.push(R.sheenColorMapUv),T.push(R.sheenRoughnessMapUv),T.push(R.specularMapUv),T.push(R.specularColorMapUv),T.push(R.specularIntensityMapUv),T.push(R.transmissionMapUv),T.push(R.thicknessMapUv),T.push(R.combine),T.push(R.fogExp2),T.push(R.sizeAttenuation),T.push(R.morphTargetsCount),T.push(R.morphAttributeCount),T.push(R.numDirLights),T.push(R.numPointLights),T.push(R.numSpotLights),T.push(R.numSpotLightMaps),T.push(R.numHemiLights),T.push(R.numRectAreaLights),T.push(R.numDirLightShadows),T.push(R.numPointLightShadows),T.push(R.numSpotLightShadows),T.push(R.numSpotLightShadowsWithMaps),T.push(R.numLightProbes),T.push(R.shadowMapType),T.push(R.toneMapping),T.push(R.numClippingPlanes),T.push(R.numClipIntersection),T.push(R.depthPacking)}(R,T),function E(T,R){a.disableAll(),R.isWebGL2&&a.enable(0),R.supportsVertexTextures&&a.enable(1),R.instancing&&a.enable(2),R.instancingColor&&a.enable(3),R.matcap&&a.enable(4),R.envMap&&a.enable(5),R.normalMapObjectSpace&&a.enable(6),R.normalMapTangentSpace&&a.enable(7),R.clearcoat&&a.enable(8),R.iridescence&&a.enable(9),R.alphaTest&&a.enable(10),R.vertexColors&&a.enable(11),R.vertexAlphas&&a.enable(12),R.vertexUv1s&&a.enable(13),R.vertexUv2s&&a.enable(14),R.vertexUv3s&&a.enable(15),R.vertexTangents&&a.enable(16),R.anisotropy&&a.enable(17),T.push(a.mask),a.disableAll(),R.fog&&a.enable(0),R.useFog&&a.enable(1),R.flatShading&&a.enable(2),R.logarithmicDepthBuffer&&a.enable(3),R.skinning&&a.enable(4),R.morphTargets&&a.enable(5),R.morphNormals&&a.enable(6),R.morphColors&&a.enable(7),R.premultipliedAlpha&&a.enable(8),R.shadowMapEnabled&&a.enable(9),R.useLegacyLights&&a.enable(10),R.doubleSided&&a.enable(11),R.flipSided&&a.enable(12),R.useDepthPacking&&a.enable(13),R.dithering&&a.enable(14),R.transmission&&a.enable(15),R.sheen&&a.enable(16),R.opaque&&a.enable(17),R.pointsUvs&&a.enable(18),R.decodeVideoTexture&&a.enable(19),T.push(a.mask)}(R,T),R.push(n.outputColorSpace)),R.push(T.customProgramCacheKey),R.join()},getUniforms:function C(T){const R=g[T.type];let $;return $=R?DQ.clone(Ka[R].uniforms):T.uniforms,$},acquireProgram:function x(T,R){let $;for(let ee=0,se=c.length;ee<se;ee++){const V=c[ee];if(V.cacheKey===R){$=V,++$.usedTimes;break}}return void 0===$&&($=new sie(n,R,T,s),c.push($)),$},releaseProgram:function A(T){if(0==--T.usedTimes){const R=c.indexOf(T);c[R]=c[c.length-1],c.pop(),T.destroy()}},releaseShaderCache:function D(T){l.remove(T)},programs:c,dispose:function O(){l.dispose()}}}function uie(){let n=new WeakMap;return{get:function e(s){let o=n.get(s);return void 0===o&&(o={},n.set(s,o)),o},remove:function t(s){n.delete(s)},update:function i(s,o,a){n.get(s)[o]=a},dispose:function r(){n=new WeakMap}}}function hie(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function qV(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function XV(){const n=[];let e=0;const t=[],i=[],r=[];function o(d,p,m,g,v,w){let y=n[e];return void 0===y?(y={id:d.id,object:d,geometry:p,material:m,groupOrder:g,renderOrder:d.renderOrder,z:v,group:w},n[e]=y):(y.id=d.id,y.object=d,y.geometry=p,y.material=m,y.groupOrder=g,y.renderOrder=d.renderOrder,y.z=v,y.group=w),e++,y}return{opaque:t,transmissive:i,transparent:r,init:function s(){e=0,t.length=0,i.length=0,r.length=0},push:function a(d,p,m,g,v,w){const y=o(d,p,m,g,v,w);m.transmission>0?i.push(y):!0===m.transparent?r.push(y):t.push(y)},unshift:function l(d,p,m,g,v,w){const y=o(d,p,m,g,v,w);m.transmission>0?i.unshift(y):!0===m.transparent?r.unshift(y):t.unshift(y)},finish:function h(){for(let d=e,p=n.length;d<p;d++){const m=n[d];if(null===m.id)break;m.id=null,m.object=null,m.geometry=null,m.material=null,m.group=null}},sort:function c(d,p){t.length>1&&t.sort(d||hie),i.length>1&&i.sort(p||qV),r.length>1&&r.sort(p||qV)}}}function die(){let n=new WeakMap;return{get:function e(i,r){const s=n.get(i);let o;return void 0===s?(o=new XV,n.set(i,[o])):r>=s.length?(o=new XV,s.push(o)):o=s[r],o},dispose:function t(){n=new WeakMap}}}function fie(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new L,color:new We};break;case"SpotLight":t={position:new L,direction:new L,color:new We,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new L,color:new We,distance:0,decay:0};break;case"HemisphereLight":t={direction:new L,skyColor:new We,groundColor:new We};break;case"RectAreaLight":t={color:new We,position:new L,halfWidth:new L,halfHeight:new L}}return n[e.id]=t,t}}}let mie=0;function gie(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function _ie(n,e){const t=new fie,i=function pie(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new fe};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new fe,shadowCameraNear:1,shadowCameraFar:1e3}}return n[e.id]=t,t}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let h=0;h<9;h++)r.probe.push(new L);const s=new L,o=new wt,a=new wt;return{setup:function l(h,d){let p=0,m=0,g=0;for(let ee=0;ee<9;ee++)r.probe[ee].set(0,0,0);let v=0,w=0,y=0,b=0,E=0,C=0,x=0,A=0,D=0,O=0,T=0;h.sort(gie);const R=!0===d?Math.PI:1;for(let ee=0,se=h.length;ee<se;ee++){const V=h[ee],J=V.color,G=V.intensity,X=V.distance,Q=V.shadow&&V.shadow.map?V.shadow.map.texture:null;if(V.isAmbientLight)p+=J.r*G*R,m+=J.g*G*R,g+=J.b*G*R;else if(V.isLightProbe){for(let Z=0;Z<9;Z++)r.probe[Z].addScaledVector(V.sh.coefficients[Z],G);T++}else if(V.isDirectionalLight){const Z=t.get(V);if(Z.color.copy(V.color).multiplyScalar(V.intensity*R),V.castShadow){const le=V.shadow,q=i.get(V);q.shadowBias=le.bias,q.shadowNormalBias=le.normalBias,q.shadowRadius=le.radius,q.shadowMapSize=le.mapSize,r.directionalShadow[v]=q,r.directionalShadowMap[v]=Q,r.directionalShadowMatrix[v]=V.shadow.matrix,C++}r.directional[v]=Z,v++}else if(V.isSpotLight){const Z=t.get(V);Z.position.setFromMatrixPosition(V.matrixWorld),Z.color.copy(J).multiplyScalar(G*R),Z.distance=X,Z.coneCos=Math.cos(V.angle),Z.penumbraCos=Math.cos(V.angle*(1-V.penumbra)),Z.decay=V.decay,r.spot[y]=Z;const le=V.shadow;if(V.map&&(r.spotLightMap[D]=V.map,D++,le.updateMatrices(V),V.castShadow&&O++),r.spotLightMatrix[y]=le.matrix,V.castShadow){const q=i.get(V);q.shadowBias=le.bias,q.shadowNormalBias=le.normalBias,q.shadowRadius=le.radius,q.shadowMapSize=le.mapSize,r.spotShadow[y]=q,r.spotShadowMap[y]=Q,A++}y++}else if(V.isRectAreaLight){const Z=t.get(V);Z.color.copy(J).multiplyScalar(G),Z.halfWidth.set(.5*V.width,0,0),Z.halfHeight.set(0,.5*V.height,0),r.rectArea[b]=Z,b++}else if(V.isPointLight){const Z=t.get(V);if(Z.color.copy(V.color).multiplyScalar(V.intensity*R),Z.distance=V.distance,Z.decay=V.decay,V.castShadow){const le=V.shadow,q=i.get(V);q.shadowBias=le.bias,q.shadowNormalBias=le.normalBias,q.shadowRadius=le.radius,q.shadowMapSize=le.mapSize,q.shadowCameraNear=le.camera.near,q.shadowCameraFar=le.camera.far,r.pointShadow[w]=q,r.pointShadowMap[w]=Q,r.pointShadowMatrix[w]=V.shadow.matrix,x++}r.point[w]=Z,w++}else if(V.isHemisphereLight){const Z=t.get(V);Z.skyColor.copy(V.color).multiplyScalar(G*R),Z.groundColor.copy(V.groundColor).multiplyScalar(G*R),r.hemi[E]=Z,E++}}b>0&&(e.isWebGL2||!0===n.has("OES_texture_float_linear")?(r.rectAreaLTC1=Ge.LTC_FLOAT_1,r.rectAreaLTC2=Ge.LTC_FLOAT_2):!0===n.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=Ge.LTC_HALF_1,r.rectAreaLTC2=Ge.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=p,r.ambient[1]=m,r.ambient[2]=g;const $=r.hash;($.directionalLength!==v||$.pointLength!==w||$.spotLength!==y||$.rectAreaLength!==b||$.hemiLength!==E||$.numDirectionalShadows!==C||$.numPointShadows!==x||$.numSpotShadows!==A||$.numSpotMaps!==D||$.numLightProbes!==T)&&(r.directional.length=v,r.spot.length=y,r.rectArea.length=b,r.point.length=w,r.hemi.length=E,r.directionalShadow.length=C,r.directionalShadowMap.length=C,r.pointShadow.length=x,r.pointShadowMap.length=x,r.spotShadow.length=A,r.spotShadowMap.length=A,r.directionalShadowMatrix.length=C,r.pointShadowMatrix.length=x,r.spotLightMatrix.length=A+D-O,r.spotLightMap.length=D,r.numSpotLightShadowsWithMaps=O,r.numLightProbes=T,$.directionalLength=v,$.pointLength=w,$.spotLength=y,$.rectAreaLength=b,$.hemiLength=E,$.numDirectionalShadows=C,$.numPointShadows=x,$.numSpotShadows=A,$.numSpotMaps=D,$.numLightProbes=T,r.version=mie++)},setupView:function c(h,d){let p=0,m=0,g=0,v=0,w=0;const y=d.matrixWorldInverse;for(let b=0,E=h.length;b<E;b++){const C=h[b];if(C.isDirectionalLight){const x=r.directional[p];x.direction.setFromMatrixPosition(C.matrixWorld),s.setFromMatrixPosition(C.target.matrixWorld),x.direction.sub(s),x.direction.transformDirection(y),p++}else if(C.isSpotLight){const x=r.spot[g];x.position.setFromMatrixPosition(C.matrixWorld),x.position.applyMatrix4(y),x.direction.setFromMatrixPosition(C.matrixWorld),s.setFromMatrixPosition(C.target.matrixWorld),x.direction.sub(s),x.direction.transformDirection(y),g++}else if(C.isRectAreaLight){const x=r.rectArea[v];x.position.setFromMatrixPosition(C.matrixWorld),x.position.applyMatrix4(y),a.identity(),o.copy(C.matrixWorld),o.premultiply(y),a.extractRotation(o),x.halfWidth.set(.5*C.width,0,0),x.halfHeight.set(0,.5*C.height,0),x.halfWidth.applyMatrix4(a),x.halfHeight.applyMatrix4(a),v++}else if(C.isPointLight){const x=r.point[m];x.position.setFromMatrixPosition(C.matrixWorld),x.position.applyMatrix4(y),m++}else if(C.isHemisphereLight){const x=r.hemi[w];x.direction.setFromMatrixPosition(C.matrixWorld),x.direction.transformDirection(y),w++}}},state:r}}function YV(n,e){const t=new _ie(n,e),i=[],r=[];return{init:function s(){i.length=0,r.length=0},state:{lightsArray:i,shadowsArray:r,lights:t},setupLights:function l(d){t.setup(i,d)},setupLightsView:function c(d){t.setupView(i,d)},pushLight:function o(d){i.push(d)},pushShadow:function a(d){r.push(d)}}}function yie(n,e){let t=new WeakMap;return{get:function i(s,o=0){const a=t.get(s);let l;return void 0===a?(l=new YV(n,e),t.set(s,[l])):o>=a.length?(l=new YV(n,e),a.push(l)):l=a[o],l},dispose:function r(){t=new WeakMap}}}class KV extends gs{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class ZV extends gs{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function bie(n,e,t){let i=new cI;const r=new fe,s=new fe,o=new Nn,a=new KV({depthPacking:3201}),l=new ZV,c={},h=t.maxTextureSize,d={0:1,1:0,2:2},p=new tc({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new fe},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),m=p.clone();m.defines.HORIZONTAL_PASS=1;const g=new Rt;g.setAttribute("position",new Kn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const v=new Me(g,p),w=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=cB;let y=this.type;function b(x,A){const D=e.update(v);p.defines.VSM_SAMPLES!==x.blurSamples&&(p.defines.VSM_SAMPLES=x.blurSamples,m.defines.VSM_SAMPLES=x.blurSamples,p.needsUpdate=!0,m.needsUpdate=!0),null===x.mapPass&&(x.mapPass=new Xh(r.x,r.y)),p.uniforms.shadow_pass.value=x.map.texture,p.uniforms.resolution.value=x.mapSize,p.uniforms.radius.value=x.radius,n.setRenderTarget(x.mapPass),n.clear(),n.renderBufferDirect(A,null,D,p,v,null),m.uniforms.shadow_pass.value=x.mapPass.texture,m.uniforms.resolution.value=x.mapSize,m.uniforms.radius.value=x.radius,n.setRenderTarget(x.map),n.clear(),n.renderBufferDirect(A,null,D,m,v,null)}function E(x,A,D,O){let T=null;const R=!0===D.isPointLight?x.customDistanceMaterial:x.customDepthMaterial;if(void 0!==R)T=R;else if(T=!0===D.isPointLight?l:a,n.localClippingEnabled&&!0===A.clipShadows&&Array.isArray(A.clippingPlanes)&&0!==A.clippingPlanes.length||A.displacementMap&&0!==A.displacementScale||A.alphaMap&&A.alphaTest>0||A.map&&A.alphaTest>0){const $=T.uuid,ee=A.uuid;let se=c[$];void 0===se&&(se={},c[$]=se);let V=se[ee];void 0===V&&(V=T.clone(),se[ee]=V),T=V}return T.visible=A.visible,T.wireframe=A.wireframe,T.side=O===Gl?null!==A.shadowSide?A.shadowSide:A.side:null!==A.shadowSide?A.shadowSide:d[A.side],T.alphaMap=A.alphaMap,T.alphaTest=A.alphaTest,T.map=A.map,T.clipShadows=A.clipShadows,T.clippingPlanes=A.clippingPlanes,T.clipIntersection=A.clipIntersection,T.displacementMap=A.displacementMap,T.displacementScale=A.displacementScale,T.displacementBias=A.displacementBias,T.wireframeLinewidth=A.wireframeLinewidth,T.linewidth=A.linewidth,!0===D.isPointLight&&!0===T.isMeshDistanceMaterial&&(n.properties.get(T).light=D),T}function C(x,A,D,O,T){if(!1===x.visible)return;if(x.layers.test(A.layers)&&(x.isMesh||x.isLine||x.isPoints)&&(x.castShadow||x.receiveShadow&&T===Gl)&&(!x.frustumCulled||i.intersectsObject(x))){x.modelViewMatrix.multiplyMatrices(D.matrixWorldInverse,x.matrixWorld);const ee=e.update(x),se=x.material;if(Array.isArray(se)){const V=ee.groups;for(let J=0,G=V.length;J<G;J++){const X=V[J],Q=se[X.materialIndex];if(Q&&Q.visible){const Z=E(x,Q,O,T);n.renderBufferDirect(D,null,ee,Z,x,X)}}}else if(se.visible){const V=E(x,se,O,T);n.renderBufferDirect(D,null,ee,V,x,null)}}const $=x.children;for(let ee=0,se=$.length;ee<se;ee++)C($[ee],A,D,O,T)}this.render=function(x,A,D){if(!1===w.enabled||!1===w.autoUpdate&&!1===w.needsUpdate||0===x.length)return;const O=n.getRenderTarget(),T=n.getActiveCubeFace(),R=n.getActiveMipmapLevel(),$=n.state;$.setBlending(0),$.buffers.color.setClear(1,1,1,1),$.buffers.depth.setTest(!0),$.setScissorTest(!1);const ee=y!==Gl&&this.type===Gl,se=y===Gl&&this.type!==Gl;for(let V=0,J=x.length;V<J;V++){const G=x[V],X=G.shadow;if(void 0===X){console.warn("THREE.WebGLShadowMap:",G,"has no shadow.");continue}if(!1===X.autoUpdate&&!1===X.needsUpdate)continue;r.copy(X.mapSize);const Q=X.getFrameExtents();if(r.multiply(Q),s.copy(X.mapSize),(r.x>h||r.y>h)&&(r.x>h&&(s.x=Math.floor(h/Q.x),r.x=s.x*Q.x,X.mapSize.x=s.x),r.y>h&&(s.y=Math.floor(h/Q.y),r.y=s.y*Q.y,X.mapSize.y=s.y)),null===X.map||!0===ee||!0===se){const le=this.type!==Gl?{minFilter:Li,magFilter:Li}:{};null!==X.map&&X.map.dispose(),X.map=new Xh(r.x,r.y,le),X.map.texture.name=G.name+".shadowMap",X.camera.updateProjectionMatrix()}n.setRenderTarget(X.map),n.clear();const Z=X.getViewportCount();for(let le=0;le<Z;le++){const q=X.getViewport(le);o.set(s.x*q.x,s.y*q.y,s.x*q.z,s.y*q.w),$.viewport(o),X.updateMatrices(G,le),i=X.getFrustum(),C(A,D,X.camera,G,this.type)}!0!==X.isPointLightShadow&&this.type===Gl&&b(X,D),X.needsUpdate=!1}y=this.type,w.needsUpdate=!1,n.setRenderTarget(O,T,R)}}function Eie(n,e,t){const i=t.isWebGL2,a=new function r(){let H=!1;const Fe=new Nn;let Pe=null;const je=new Nn(0,0,0,0);return{setMask:function(ke){Pe!==ke&&!H&&(n.colorMask(ke,ke,ke,ke),Pe=ke)},setLocked:function(ke){H=ke},setClear:function(ke,Ce,it,Tt,Xi){!0===Xi&&(ke*=Tt,Ce*=Tt,it*=Tt),Fe.set(ke,Ce,it,Tt),!1===je.equals(Fe)&&(n.clearColor(ke,Ce,it,Tt),je.copy(Fe))},reset:function(){H=!1,Pe=null,je.set(-1,0,0,0)}}},l=new function s(){let H=!1,Fe=null,Pe=null,je=null;return{setTest:function(ke){ke?Be(n.DEPTH_TEST):Xe(n.DEPTH_TEST)},setMask:function(ke){Fe!==ke&&!H&&(n.depthMask(ke),Fe=ke)},setFunc:function(ke){if(Pe!==ke){switch(ke){case 0:n.depthFunc(n.NEVER);break;case 1:n.depthFunc(n.ALWAYS);break;case 2:n.depthFunc(n.LESS);break;case 3:default:n.depthFunc(n.LEQUAL);break;case 4:n.depthFunc(n.EQUAL);break;case 5:n.depthFunc(n.GEQUAL);break;case 6:n.depthFunc(n.GREATER);break;case 7:n.depthFunc(n.NOTEQUAL)}Pe=ke}},setLocked:function(ke){H=ke},setClear:function(ke){je!==ke&&(n.clearDepth(ke),je=ke)},reset:function(){H=!1,Fe=null,Pe=null,je=null}}},c=new function o(){let H=!1,Fe=null,Pe=null,je=null,ke=null,Ce=null,it=null,Tt=null,Xi=null;return{setTest:function(ri){H||(ri?Be(n.STENCIL_TEST):Xe(n.STENCIL_TEST))},setMask:function(ri){Fe!==ri&&!H&&(n.stencilMask(ri),Fe=ri)},setFunc:function(ri,il,ws){(Pe!==ri||je!==il||ke!==ws)&&(n.stencilFunc(ri,il,ws),Pe=ri,je=il,ke=ws)},setOp:function(ri,il,ws){(Ce!==ri||it!==il||Tt!==ws)&&(n.stencilOp(ri,il,ws),Ce=ri,it=il,Tt=ws)},setLocked:function(ri){H=ri},setClear:function(ri){Xi!==ri&&(n.clearStencil(ri),Xi=ri)},reset:function(){H=!1,Fe=null,Pe=null,je=null,ke=null,Ce=null,it=null,Tt=null,Xi=null}}},h=new WeakMap,d=new WeakMap;let p={},m={},g=new WeakMap,v=[],w=null,y=!1,b=null,E=null,C=null,x=null,A=null,D=null,O=null,T=!1,R=null,$=null,ee=null,se=null,V=null;const J=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let G=!1,X=0;const Q=n.getParameter(n.VERSION);-1!==Q.indexOf("WebGL")?(X=parseFloat(/^WebGL (\d)/.exec(Q)[1]),G=X>=1):-1!==Q.indexOf("OpenGL ES")&&(X=parseFloat(/^OpenGL ES (\d)/.exec(Q)[1]),G=X>=2);let Z=null,le={};const q=n.getParameter(n.SCISSOR_BOX),oe=n.getParameter(n.VIEWPORT),Se=(new Nn).fromArray(q),ve=(new Nn).fromArray(oe);function Ne(H,Fe,Pe,je){const ke=new Uint8Array(4),Ce=n.createTexture();n.bindTexture(H,Ce),n.texParameteri(H,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(H,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let it=0;it<Pe;it++)!i||H!==n.TEXTURE_3D&&H!==n.TEXTURE_2D_ARRAY?n.texImage2D(Fe+it,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,ke):n.texImage3D(Fe,0,n.RGBA,1,1,je,0,n.RGBA,n.UNSIGNED_BYTE,ke);return Ce}const $e={};function Be(H){!0!==p[H]&&(n.enable(H),p[H]=!0)}function Xe(H){!1!==p[H]&&(n.disable(H),p[H]=!1)}$e[n.TEXTURE_2D]=Ne(n.TEXTURE_2D,n.TEXTURE_2D,1),$e[n.TEXTURE_CUBE_MAP]=Ne(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),i&&($e[n.TEXTURE_2D_ARRAY]=Ne(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),$e[n.TEXTURE_3D]=Ne(n.TEXTURE_3D,n.TEXTURE_3D,1,1)),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),Be(n.DEPTH_TEST),l.setFunc(3),Ee(!1),ot(1),Be(n.CULL_FACE),ye(0);const z={100:n.FUNC_ADD,101:n.FUNC_SUBTRACT,102:n.FUNC_REVERSE_SUBTRACT};if(i)z[103]=n.MIN,z[104]=n.MAX;else{const H=e.get("EXT_blend_minmax");null!==H&&(z[103]=H.MIN_EXT,z[104]=H.MAX_EXT)}const Le={200:n.ZERO,201:n.ONE,202:n.SRC_COLOR,204:n.SRC_ALPHA,210:n.SRC_ALPHA_SATURATE,208:n.DST_COLOR,206:n.DST_ALPHA,203:n.ONE_MINUS_SRC_COLOR,205:n.ONE_MINUS_SRC_ALPHA,209:n.ONE_MINUS_DST_COLOR,207:n.ONE_MINUS_DST_ALPHA};function ye(H,Fe,Pe,je,ke,Ce,it,Tt){if(0!==H){if(!1===y&&(Be(n.BLEND),y=!0),5===H)ke=ke||Fe,Ce=Ce||Pe,it=it||je,(Fe!==E||ke!==A)&&(n.blendEquationSeparate(z[Fe],z[ke]),E=Fe,A=ke),(Pe!==C||je!==x||Ce!==D||it!==O)&&(n.blendFuncSeparate(Le[Pe],Le[je],Le[Ce],Le[it]),C=Pe,x=je,D=Ce,O=it),b=H,T=!1;else if(H!==b||Tt!==T){if((100!==E||100!==A)&&(n.blendEquation(n.FUNC_ADD),E=100,A=100),Tt)switch(H){case 1:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case 2:n.blendFunc(n.ONE,n.ONE);break;case 3:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case 4:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",H)}else switch(H){case 1:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case 2:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case 3:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case 4:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",H)}C=null,x=null,D=null,O=null,b=H,T=Tt}}else!0===y&&(Xe(n.BLEND),y=!1)}function Ee(H){R!==H&&(n.frontFace(H?n.CW:n.CCW),R=H)}function ot(H){0!==H?(Be(n.CULL_FACE),H!==$&&n.cullFace(1===H?n.BACK:2===H?n.FRONT:n.FRONT_AND_BACK)):Xe(n.CULL_FACE),$=H}function Qe(H,Fe,Pe){H?(Be(n.POLYGON_OFFSET_FILL),(se!==Fe||V!==Pe)&&(n.polygonOffset(Fe,Pe),se=Fe,V=Pe)):Xe(n.POLYGON_OFFSET_FILL)}return{buffers:{color:a,depth:l,stencil:c},enable:Be,disable:Xe,bindFramebuffer:function dt(H,Fe){return m[H]!==Fe&&(n.bindFramebuffer(H,Fe),m[H]=Fe,i&&(H===n.DRAW_FRAMEBUFFER&&(m[n.FRAMEBUFFER]=Fe),H===n.FRAMEBUFFER&&(m[n.DRAW_FRAMEBUFFER]=Fe)),!0)},drawBuffers:function St(H,Fe){let Pe=v,je=!1;if(H)if(Pe=g.get(Fe),void 0===Pe&&(Pe=[],g.set(Fe,Pe)),H.isWebGLMultipleRenderTargets){const ke=H.texture;if(Pe.length!==ke.length||Pe[0]!==n.COLOR_ATTACHMENT0){for(let Ce=0,it=ke.length;Ce<it;Ce++)Pe[Ce]=n.COLOR_ATTACHMENT0+Ce;Pe.length=ke.length,je=!0}}else Pe[0]!==n.COLOR_ATTACHMENT0&&(Pe[0]=n.COLOR_ATTACHMENT0,je=!0);else Pe[0]!==n.BACK&&(Pe[0]=n.BACK,je=!0);je&&(t.isWebGL2?n.drawBuffers(Pe):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Pe))},useProgram:function nt(H){return w!==H&&(n.useProgram(H),w=H,!0)},setBlending:ye,setMaterial:function Ae(H,Fe){2===H.side?Xe(n.CULL_FACE):Be(n.CULL_FACE);let Pe=1===H.side;Fe&&(Pe=!Pe),Ee(Pe),1===H.blending&&!1===H.transparent?ye(0):ye(H.blending,H.blendEquation,H.blendSrc,H.blendDst,H.blendEquationAlpha,H.blendSrcAlpha,H.blendDstAlpha,H.premultipliedAlpha),l.setFunc(H.depthFunc),l.setTest(H.depthTest),l.setMask(H.depthWrite),a.setMask(H.colorWrite);const je=H.stencilWrite;c.setTest(je),je&&(c.setMask(H.stencilWriteMask),c.setFunc(H.stencilFunc,H.stencilRef,H.stencilFuncMask),c.setOp(H.stencilFail,H.stencilZFail,H.stencilZPass)),Qe(H.polygonOffset,H.polygonOffsetFactor,H.polygonOffsetUnits),!0===H.alphaToCoverage?Be(n.SAMPLE_ALPHA_TO_COVERAGE):Xe(n.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:Ee,setCullFace:ot,setLineWidth:function Ze(H){H!==ee&&(G&&n.lineWidth(H),ee=H)},setPolygonOffset:Qe,setScissorTest:function bt(H){H?Be(n.SCISSOR_TEST):Xe(n.SCISSOR_TEST)},activeTexture:function en(H){void 0===H&&(H=n.TEXTURE0+J-1),Z!==H&&(n.activeTexture(H),Z=H)},bindTexture:function li(H,Fe,Pe){void 0===Pe&&(Pe=null===Z?n.TEXTURE0+J-1:Z);let je=le[Pe];void 0===je&&(je={type:void 0,texture:void 0},le[Pe]=je),(je.type!==H||je.texture!==Fe)&&(Z!==Pe&&(n.activeTexture(Pe),Z=Pe),n.bindTexture(H,Fe||$e[H]),je.type=H,je.texture=Fe)},unbindTexture:function k(){const H=le[Z];void 0!==H&&void 0!==H.type&&(n.bindTexture(H.type,null),H.type=void 0,H.texture=void 0)},compressedTexImage2D:function P(){try{n.compressedTexImage2D.apply(n,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},compressedTexImage3D:function ie(){try{n.compressedTexImage3D.apply(n,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},texImage2D:function W(){try{n.texImage2D.apply(n,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},texImage3D:function Re(){try{n.texImage3D.apply(n,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},updateUBOMapping:function at(H,Fe){let Pe=d.get(Fe);void 0===Pe&&(Pe=new WeakMap,d.set(Fe,Pe));let je=Pe.get(H);void 0===je&&(je=n.getUniformBlockIndex(Fe,H.name),Pe.set(H,je))},uniformBlockBinding:function ft(H,Fe){const je=d.get(Fe).get(H);h.get(Fe)!==je&&(n.uniformBlockBinding(Fe,je,H.__bindingPointIndex),h.set(Fe,je))},texStorage2D:function Ie(){try{n.texStorage2D.apply(n,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},texStorage3D:function qe(){try{n.texStorage3D.apply(n,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},texSubImage2D:function Te(){try{n.texSubImage2D.apply(n,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},texSubImage3D:function xe(){try{n.texSubImage3D.apply(n,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},compressedTexSubImage2D:function De(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},compressedTexSubImage3D:function rt(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},scissor:function we(H){!1===Se.equals(H)&&(n.scissor(H.x,H.y,H.z,H.w),Se.copy(H))},viewport:function Ct(H){!1===ve.equals(H)&&(n.viewport(H.x,H.y,H.z,H.w),ve.copy(H))},reset:function st(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),!0===i&&(n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),p={},Z=null,le={},m={},g=new WeakMap,v=[],w=null,y=!1,b=null,E=null,C=null,x=null,A=null,D=null,O=null,T=!1,R=null,$=null,ee=null,se=null,V=null,Se.set(0,0,n.canvas.width,n.canvas.height),ve.set(0,0,n.canvas.width,n.canvas.height),a.reset(),l.reset(),c.reset()}}}function Sie(n,e,t,i,r,s,o){const a=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,h=r.maxTextureSize,d=r.maxSamples,p=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,m=!(typeof navigator>"u")&&/OculusBrowser/g.test(navigator.userAgent),g=new WeakMap;let v;const w=new WeakMap;let y=!1;try{y=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function b(k,P){return y?new OffscreenCanvas(k,P):Jy("canvas")}function E(k,P,ie,Te){let xe=1;if((k.width>Te||k.height>Te)&&(xe=Te/Math.max(k.width,k.height)),xe<1||!0===P){if(typeof HTMLImageElement<"u"&&k instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&k instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&k instanceof ImageBitmap){const De=P?oS:Math.floor,rt=De(xe*k.width),Ie=De(xe*k.height);void 0===v&&(v=b(rt,Ie));const qe=ie?b(rt,Ie):v;return qe.width=rt,qe.height=Ie,qe.getContext("2d").drawImage(k,0,0,rt,Ie),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+k.width+"x"+k.height+") to ("+rt+"x"+Ie+")."),qe}return"data"in k&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+k.width+"x"+k.height+")."),k}return k}function C(k){return zD(k.width)&&zD(k.height)}function A(k,P){return k.generateMipmaps&&P&&k.minFilter!==Li&&k.minFilter!==hi}function D(k){n.generateMipmap(k)}function O(k,P,ie,Te,xe=!1){if(!1===a)return P;if(null!==k){if(void 0!==n[k])return n[k];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+k+"'")}let De=P;if(P===n.RED&&(ie===n.FLOAT&&(De=n.R32F),ie===n.HALF_FLOAT&&(De=n.R16F),ie===n.UNSIGNED_BYTE&&(De=n.R8)),P===n.RED_INTEGER&&(ie===n.UNSIGNED_BYTE&&(De=n.R8UI),ie===n.UNSIGNED_SHORT&&(De=n.R16UI),ie===n.UNSIGNED_INT&&(De=n.R32UI),ie===n.BYTE&&(De=n.R8I),ie===n.SHORT&&(De=n.R16I),ie===n.INT&&(De=n.R32I)),P===n.RG&&(ie===n.FLOAT&&(De=n.RG32F),ie===n.HALF_FLOAT&&(De=n.RG16F),ie===n.UNSIGNED_BYTE&&(De=n.RG8)),P===n.RGBA){const rt=xe?tS:Sn.getTransfer(Te);ie===n.FLOAT&&(De=n.RGBA32F),ie===n.HALF_FLOAT&&(De=n.RGBA16F),ie===n.UNSIGNED_BYTE&&(De=rt===ni?n.SRGB8_ALPHA8:n.RGBA8),ie===n.UNSIGNED_SHORT_4_4_4_4&&(De=n.RGBA4),ie===n.UNSIGNED_SHORT_5_5_5_1&&(De=n.RGB5_A1)}return(De===n.R16F||De===n.R32F||De===n.RG16F||De===n.RG32F||De===n.RGBA16F||De===n.RGBA32F)&&e.get("EXT_color_buffer_float"),De}function T(k,P,ie){return!0===A(k,ie)||k.isFramebufferTexture&&k.minFilter!==Li&&k.minFilter!==hi?Math.log2(Math.max(P.width,P.height))+1:void 0!==k.mipmaps&&k.mipmaps.length>0?k.mipmaps.length:k.isCompressedTexture&&Array.isArray(k.image)?P.mipmaps.length:1}function R(k){return k===Li||1004===k||1005===k?n.NEAREST:n.LINEAR}function $(k){const P=k.target;P.removeEventListener("dispose",$),function se(k){const P=i.get(k);if(void 0===P.__webglInit)return;const ie=k.source,Te=w.get(ie);if(Te){const xe=Te[P.__cacheKey];xe.usedTimes--,0===xe.usedTimes&&V(k),0===Object.keys(Te).length&&w.delete(ie)}i.remove(k)}(P),P.isVideoTexture&&g.delete(P)}function ee(k){const P=k.target;P.removeEventListener("dispose",ee),function J(k){const P=k.texture,ie=i.get(k),Te=i.get(P);if(void 0!==Te.__webglTexture&&(n.deleteTexture(Te.__webglTexture),o.memory.textures--),k.depthTexture&&k.depthTexture.dispose(),k.isWebGLCubeRenderTarget)for(let xe=0;xe<6;xe++){if(Array.isArray(ie.__webglFramebuffer[xe]))for(let De=0;De<ie.__webglFramebuffer[xe].length;De++)n.deleteFramebuffer(ie.__webglFramebuffer[xe][De]);else n.deleteFramebuffer(ie.__webglFramebuffer[xe]);ie.__webglDepthbuffer&&n.deleteRenderbuffer(ie.__webglDepthbuffer[xe])}else{if(Array.isArray(ie.__webglFramebuffer))for(let xe=0;xe<ie.__webglFramebuffer.length;xe++)n.deleteFramebuffer(ie.__webglFramebuffer[xe]);else n.deleteFramebuffer(ie.__webglFramebuffer);if(ie.__webglDepthbuffer&&n.deleteRenderbuffer(ie.__webglDepthbuffer),ie.__webglMultisampledFramebuffer&&n.deleteFramebuffer(ie.__webglMultisampledFramebuffer),ie.__webglColorRenderbuffer)for(let xe=0;xe<ie.__webglColorRenderbuffer.length;xe++)ie.__webglColorRenderbuffer[xe]&&n.deleteRenderbuffer(ie.__webglColorRenderbuffer[xe]);ie.__webglDepthRenderbuffer&&n.deleteRenderbuffer(ie.__webglDepthRenderbuffer)}if(k.isWebGLMultipleRenderTargets)for(let xe=0,De=P.length;xe<De;xe++){const rt=i.get(P[xe]);rt.__webglTexture&&(n.deleteTexture(rt.__webglTexture),o.memory.textures--),i.remove(P[xe])}i.remove(P),i.remove(k)}(P)}function V(k){const P=i.get(k);n.deleteTexture(P.__webglTexture),delete w.get(k.source)[P.__cacheKey],o.memory.textures--}let G=0;function le(k,P){const ie=i.get(k);if(k.isVideoTexture&&function en(k){const P=o.render.frame;g.get(k)!==P&&(g.set(k,P),k.update())}(k),!1===k.isRenderTargetTexture&&k.version>0&&ie.__version!==k.version){const Te=k.image;if(null===Te)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==Te.complete)return void dt(ie,k,P);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.bindTexture(n.TEXTURE_2D,ie.__webglTexture,n.TEXTURE0+P)}const ve={[Hh]:n.REPEAT,[Gr]:n.CLAMP_TO_EDGE,1002:n.MIRRORED_REPEAT},Ne={[Li]:n.NEAREST,1004:n.NEAREST_MIPMAP_NEAREST,1005:n.NEAREST_MIPMAP_LINEAR,[hi]:n.LINEAR,1007:n.LINEAR_MIPMAP_NEAREST,[jl]:n.LINEAR_MIPMAP_LINEAR},$e={512:n.NEVER,519:n.ALWAYS,513:n.LESS,515:n.LEQUAL,514:n.EQUAL,518:n.GEQUAL,516:n.GREATER,517:n.NOTEQUAL};function Be(k,P,ie){if(ie?(n.texParameteri(k,n.TEXTURE_WRAP_S,ve[P.wrapS]),n.texParameteri(k,n.TEXTURE_WRAP_T,ve[P.wrapT]),(k===n.TEXTURE_3D||k===n.TEXTURE_2D_ARRAY)&&n.texParameteri(k,n.TEXTURE_WRAP_R,ve[P.wrapR]),n.texParameteri(k,n.TEXTURE_MAG_FILTER,Ne[P.magFilter]),n.texParameteri(k,n.TEXTURE_MIN_FILTER,Ne[P.minFilter])):(n.texParameteri(k,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(k,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),(k===n.TEXTURE_3D||k===n.TEXTURE_2D_ARRAY)&&n.texParameteri(k,n.TEXTURE_WRAP_R,n.CLAMP_TO_EDGE),(P.wrapS!==Gr||P.wrapT!==Gr)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(k,n.TEXTURE_MAG_FILTER,R(P.magFilter)),n.texParameteri(k,n.TEXTURE_MIN_FILTER,R(P.minFilter)),P.minFilter!==Li&&P.minFilter!==hi&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),P.compareFunction&&(n.texParameteri(k,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(k,n.TEXTURE_COMPARE_FUNC,$e[P.compareFunction])),!0===e.has("EXT_texture_filter_anisotropic")){const Te=e.get("EXT_texture_filter_anisotropic");if(P.magFilter===Li||1005!==P.minFilter&&P.minFilter!==jl||P.type===$l&&!1===e.has("OES_texture_float_linear")||!1===a&&P.type===Yy&&!1===e.has("OES_texture_half_float_linear"))return;(P.anisotropy>1||i.get(P).__currentAnisotropy)&&(n.texParameterf(k,Te.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(P.anisotropy,r.getMaxAnisotropy())),i.get(P).__currentAnisotropy=P.anisotropy)}}function Xe(k,P){let ie=!1;void 0===k.__webglInit&&(k.__webglInit=!0,P.addEventListener("dispose",$));const Te=P.source;let xe=w.get(Te);void 0===xe&&(xe={},w.set(Te,xe));const De=function Z(k){const P=[];return P.push(k.wrapS),P.push(k.wrapT),P.push(k.wrapR||0),P.push(k.magFilter),P.push(k.minFilter),P.push(k.anisotropy),P.push(k.internalFormat),P.push(k.format),P.push(k.type),P.push(k.generateMipmaps),P.push(k.premultiplyAlpha),P.push(k.flipY),P.push(k.unpackAlignment),P.push(k.colorSpace),P.join()}(P);if(De!==k.__cacheKey){void 0===xe[De]&&(xe[De]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,ie=!0),xe[De].usedTimes++;const rt=xe[k.__cacheKey];void 0!==rt&&(xe[k.__cacheKey].usedTimes--,0===rt.usedTimes&&V(P)),k.__cacheKey=De,k.__webglTexture=xe[De].texture}return ie}function dt(k,P,ie){let Te=n.TEXTURE_2D;(P.isDataArrayTexture||P.isCompressedArrayTexture)&&(Te=n.TEXTURE_2D_ARRAY),P.isData3DTexture&&(Te=n.TEXTURE_3D);const xe=Xe(k,P),De=P.source;t.bindTexture(Te,k.__webglTexture,n.TEXTURE0+ie);const rt=i.get(De);if(De.version!==rt.__version||!0===xe){t.activeTexture(n.TEXTURE0+ie);const Ie=Sn.getPrimaries(Sn.workingColorSpace),qe=""===P.colorSpace?null:Sn.getPrimaries(P.colorSpace),W=""===P.colorSpace||Ie===qe?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,P.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,P.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,P.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,W);const Re=function x(k){return!a&&(k.wrapS!==Gr||k.wrapT!==Gr||k.minFilter!==Li&&k.minFilter!==hi)}(P)&&!1===C(P.image);let we=E(P.image,Re,!1,h);we=li(P,we);const Ct=C(we)||a,at=s.convert(P.format,P.colorSpace);let H,ft=s.convert(P.type),st=O(P.internalFormat,at,ft,P.colorSpace,P.isVideoTexture);Be(Te,P,Ct);const Fe=P.mipmaps,Pe=a&&!0!==P.isVideoTexture,je=void 0===rt.__version||!0===xe,ke=T(P,we,Ct);if(P.isDepthTexture)st=n.DEPTH_COMPONENT,a?st=P.type===$l?n.DEPTH_COMPONENT32F:P.type===pu?n.DEPTH_COMPONENT24:P.type===zh?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT16:P.type===$l&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),P.format===Gh&&st===n.DEPTH_COMPONENT&&1012!==P.type&&P.type!==pu&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),P.type=pu,ft=s.convert(P.type)),P.format===Wp&&st===n.DEPTH_COMPONENT&&(st=n.DEPTH_STENCIL,P.type!==zh&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),P.type=zh,ft=s.convert(P.type))),je&&(Pe?t.texStorage2D(n.TEXTURE_2D,1,st,we.width,we.height):t.texImage2D(n.TEXTURE_2D,0,st,we.width,we.height,0,at,ft,null));else if(P.isDataTexture)if(Fe.length>0&&Ct){Pe&&je&&t.texStorage2D(n.TEXTURE_2D,ke,st,Fe[0].width,Fe[0].height);for(let Ce=0,it=Fe.length;Ce<it;Ce++)H=Fe[Ce],Pe?t.texSubImage2D(n.TEXTURE_2D,Ce,0,0,H.width,H.height,at,ft,H.data):t.texImage2D(n.TEXTURE_2D,Ce,st,H.width,H.height,0,at,ft,H.data);P.generateMipmaps=!1}else Pe?(je&&t.texStorage2D(n.TEXTURE_2D,ke,st,we.width,we.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,we.width,we.height,at,ft,we.data)):t.texImage2D(n.TEXTURE_2D,0,st,we.width,we.height,0,at,ft,we.data);else if(P.isCompressedTexture)if(P.isCompressedArrayTexture){Pe&&je&&t.texStorage3D(n.TEXTURE_2D_ARRAY,ke,st,Fe[0].width,Fe[0].height,we.depth);for(let Ce=0,it=Fe.length;Ce<it;Ce++)H=Fe[Ce],P.format!==Do?null!==at?Pe?t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,Ce,0,0,0,H.width,H.height,we.depth,at,H.data,0,0):t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,Ce,st,H.width,H.height,we.depth,0,H.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Pe?t.texSubImage3D(n.TEXTURE_2D_ARRAY,Ce,0,0,0,H.width,H.height,we.depth,at,ft,H.data):t.texImage3D(n.TEXTURE_2D_ARRAY,Ce,st,H.width,H.height,we.depth,0,at,ft,H.data)}else{Pe&&je&&t.texStorage2D(n.TEXTURE_2D,ke,st,Fe[0].width,Fe[0].height);for(let Ce=0,it=Fe.length;Ce<it;Ce++)H=Fe[Ce],P.format!==Do?null!==at?Pe?t.compressedTexSubImage2D(n.TEXTURE_2D,Ce,0,0,H.width,H.height,at,H.data):t.compressedTexImage2D(n.TEXTURE_2D,Ce,st,H.width,H.height,0,H.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Pe?t.texSubImage2D(n.TEXTURE_2D,Ce,0,0,H.width,H.height,at,ft,H.data):t.texImage2D(n.TEXTURE_2D,Ce,st,H.width,H.height,0,at,ft,H.data)}else if(P.isDataArrayTexture)Pe?(je&&t.texStorage3D(n.TEXTURE_2D_ARRAY,ke,st,we.width,we.height,we.depth),t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,we.width,we.height,we.depth,at,ft,we.data)):t.texImage3D(n.TEXTURE_2D_ARRAY,0,st,we.width,we.height,we.depth,0,at,ft,we.data);else if(P.isData3DTexture)Pe?(je&&t.texStorage3D(n.TEXTURE_3D,ke,st,we.width,we.height,we.depth),t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,we.width,we.height,we.depth,at,ft,we.data)):t.texImage3D(n.TEXTURE_3D,0,st,we.width,we.height,we.depth,0,at,ft,we.data);else if(P.isFramebufferTexture){if(je)if(Pe)t.texStorage2D(n.TEXTURE_2D,ke,st,we.width,we.height);else{let Ce=we.width,it=we.height;for(let Tt=0;Tt<ke;Tt++)t.texImage2D(n.TEXTURE_2D,Tt,st,Ce,it,0,at,ft,null),Ce>>=1,it>>=1}}else if(Fe.length>0&&Ct){Pe&&je&&t.texStorage2D(n.TEXTURE_2D,ke,st,Fe[0].width,Fe[0].height);for(let Ce=0,it=Fe.length;Ce<it;Ce++)H=Fe[Ce],Pe?t.texSubImage2D(n.TEXTURE_2D,Ce,0,0,at,ft,H):t.texImage2D(n.TEXTURE_2D,Ce,st,at,ft,H);P.generateMipmaps=!1}else Pe?(je&&t.texStorage2D(n.TEXTURE_2D,ke,st,we.width,we.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,at,ft,we)):t.texImage2D(n.TEXTURE_2D,0,st,at,ft,we);A(P,Ct)&&D(Te),rt.__version=De.version,P.onUpdate&&P.onUpdate(P)}k.__version=P.version}function nt(k,P,ie,Te,xe,De){const rt=s.convert(ie.format,ie.colorSpace),Ie=s.convert(ie.type),qe=O(ie.internalFormat,rt,Ie,ie.colorSpace);if(!i.get(P).__hasExternalTextures){const Re=Math.max(1,P.width>>De),we=Math.max(1,P.height>>De);xe===n.TEXTURE_3D||xe===n.TEXTURE_2D_ARRAY?t.texImage3D(xe,De,qe,Re,we,P.depth,0,rt,Ie,null):t.texImage2D(xe,De,qe,Re,we,0,rt,Ie,null)}t.bindFramebuffer(n.FRAMEBUFFER,k),bt(P)?p.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,Te,xe,i.get(ie).__webglTexture,0,Qe(P)):(xe===n.TEXTURE_2D||xe>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&xe<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,Te,xe,i.get(ie).__webglTexture,De),t.bindFramebuffer(n.FRAMEBUFFER,null)}function z(k,P,ie){if(n.bindRenderbuffer(n.RENDERBUFFER,k),P.depthBuffer&&!P.stencilBuffer){let Te=!0===a?n.DEPTH_COMPONENT24:n.DEPTH_COMPONENT16;if(ie||bt(P)){const xe=P.depthTexture;xe&&xe.isDepthTexture&&(xe.type===$l?Te=n.DEPTH_COMPONENT32F:xe.type===pu&&(Te=n.DEPTH_COMPONENT24));const De=Qe(P);bt(P)?p.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,De,Te,P.width,P.height):n.renderbufferStorageMultisample(n.RENDERBUFFER,De,Te,P.width,P.height)}else n.renderbufferStorage(n.RENDERBUFFER,Te,P.width,P.height);n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,k)}else if(P.depthBuffer&&P.stencilBuffer){const Te=Qe(P);ie&&!1===bt(P)?n.renderbufferStorageMultisample(n.RENDERBUFFER,Te,n.DEPTH24_STENCIL8,P.width,P.height):bt(P)?p.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Te,n.DEPTH24_STENCIL8,P.width,P.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,P.width,P.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,k)}else{const Te=!0===P.isWebGLMultipleRenderTargets?P.texture:[P.texture];for(let xe=0;xe<Te.length;xe++){const De=Te[xe],rt=s.convert(De.format,De.colorSpace),Ie=s.convert(De.type),qe=O(De.internalFormat,rt,Ie,De.colorSpace),W=Qe(P);ie&&!1===bt(P)?n.renderbufferStorageMultisample(n.RENDERBUFFER,W,qe,P.width,P.height):bt(P)?p.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,W,qe,P.width,P.height):n.renderbufferStorage(n.RENDERBUFFER,qe,P.width,P.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function ye(k){const P=i.get(k),ie=!0===k.isWebGLCubeRenderTarget;if(k.depthTexture&&!P.__autoAllocateDepthBuffer){if(ie)throw new Error("target.depthTexture not supported in Cube render targets");!function Le(k,P){if(P&&P.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,k),!P.depthTexture||!P.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(P.depthTexture).__webglTexture||P.depthTexture.image.width!==P.width||P.depthTexture.image.height!==P.height)&&(P.depthTexture.image.width=P.width,P.depthTexture.image.height=P.height,P.depthTexture.needsUpdate=!0),le(P.depthTexture,0);const Te=i.get(P.depthTexture).__webglTexture,xe=Qe(P);if(P.depthTexture.format===Gh)bt(P)?p.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,Te,0,xe):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,Te,0);else{if(P.depthTexture.format!==Wp)throw new Error("Unknown depthTexture format");bt(P)?p.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,Te,0,xe):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,Te,0)}}(P.__webglFramebuffer,k)}else if(ie){P.__webglDepthbuffer=[];for(let Te=0;Te<6;Te++)t.bindFramebuffer(n.FRAMEBUFFER,P.__webglFramebuffer[Te]),P.__webglDepthbuffer[Te]=n.createRenderbuffer(),z(P.__webglDepthbuffer[Te],k,!1)}else t.bindFramebuffer(n.FRAMEBUFFER,P.__webglFramebuffer),P.__webglDepthbuffer=n.createRenderbuffer(),z(P.__webglDepthbuffer,k,!1);t.bindFramebuffer(n.FRAMEBUFFER,null)}function Qe(k){return Math.min(d,k.samples)}function bt(k){const P=i.get(k);return a&&k.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==P.__useRenderToTexture}function li(k,P){const ie=k.colorSpace,Te=k.format,xe=k.type;return!0===k.isCompressedTexture||!0===k.isVideoTexture||1035===k.format||ie!==Tr&&""!==ie&&(Sn.getTransfer(ie)===ni?!1===a?!0===e.has("EXT_sRGB")&&Te===Do?(k.format=1035,k.minFilter=hi,k.generateMipmaps=!1):P=rV.sRGBToLinear(P):(Te!==Do||xe!==fu)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",ie)),P}this.allocateTextureUnit=function Q(){const k=G;return k>=l&&console.warn("THREE.WebGLTextures: Trying to use "+k+" texture units while this GPU supports only "+l),G+=1,k},this.resetTextureUnits=function X(){G=0},this.setTexture2D=le,this.setTexture2DArray=function q(k,P){const ie=i.get(k);k.version>0&&ie.__version!==k.version?dt(ie,k,P):t.bindTexture(n.TEXTURE_2D_ARRAY,ie.__webglTexture,n.TEXTURE0+P)},this.setTexture3D=function oe(k,P){const ie=i.get(k);k.version>0&&ie.__version!==k.version?dt(ie,k,P):t.bindTexture(n.TEXTURE_3D,ie.__webglTexture,n.TEXTURE0+P)},this.setTextureCube=function Se(k,P){const ie=i.get(k);k.version>0&&ie.__version!==k.version?function St(k,P,ie){if(6!==P.image.length)return;const Te=Xe(k,P),xe=P.source;t.bindTexture(n.TEXTURE_CUBE_MAP,k.__webglTexture,n.TEXTURE0+ie);const De=i.get(xe);if(xe.version!==De.__version||!0===Te){t.activeTexture(n.TEXTURE0+ie);const rt=Sn.getPrimaries(Sn.workingColorSpace),Ie=""===P.colorSpace?null:Sn.getPrimaries(P.colorSpace),qe=""===P.colorSpace||rt===Ie?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,P.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,P.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,P.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,qe);const W=P.isCompressedTexture||P.image[0].isCompressedTexture,Re=P.image[0]&&P.image[0].isDataTexture,we=[];for(let Ce=0;Ce<6;Ce++)we[Ce]=W||Re?Re?P.image[Ce].image:P.image[Ce]:E(P.image[Ce],!1,!0,c),we[Ce]=li(P,we[Ce]);const Ct=we[0],at=C(Ct)||a,ft=s.convert(P.format,P.colorSpace),st=s.convert(P.type),H=O(P.internalFormat,ft,st,P.colorSpace),Fe=a&&!0!==P.isVideoTexture,Pe=void 0===De.__version||!0===Te;let ke,je=T(P,Ct,at);if(Be(n.TEXTURE_CUBE_MAP,P,at),W){Fe&&Pe&&t.texStorage2D(n.TEXTURE_CUBE_MAP,je,H,Ct.width,Ct.height);for(let Ce=0;Ce<6;Ce++){ke=we[Ce].mipmaps;for(let it=0;it<ke.length;it++){const Tt=ke[it];P.format!==Do?null!==ft?Fe?t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,it,0,0,Tt.width,Tt.height,ft,Tt.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,it,H,Tt.width,Tt.height,0,Tt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Fe?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,it,0,0,Tt.width,Tt.height,ft,st,Tt.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,it,H,Tt.width,Tt.height,0,ft,st,Tt.data)}}}else{ke=P.mipmaps,Fe&&Pe&&(ke.length>0&&je++,t.texStorage2D(n.TEXTURE_CUBE_MAP,je,H,we[0].width,we[0].height));for(let Ce=0;Ce<6;Ce++)if(Re){Fe?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,0,0,0,we[Ce].width,we[Ce].height,ft,st,we[Ce].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,0,H,we[Ce].width,we[Ce].height,0,ft,st,we[Ce].data);for(let it=0;it<ke.length;it++){const Xi=ke[it].image[Ce].image;Fe?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,it+1,0,0,Xi.width,Xi.height,ft,st,Xi.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,it+1,H,Xi.width,Xi.height,0,ft,st,Xi.data)}}else{Fe?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,0,0,0,ft,st,we[Ce]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,0,H,ft,st,we[Ce]);for(let it=0;it<ke.length;it++){const Tt=ke[it];Fe?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,it+1,0,0,ft,st,Tt.image[Ce]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,it+1,H,ft,st,Tt.image[Ce])}}}A(P,at)&&D(n.TEXTURE_CUBE_MAP),De.__version=xe.version,P.onUpdate&&P.onUpdate(P)}k.__version=P.version}(ie,k,P):t.bindTexture(n.TEXTURE_CUBE_MAP,ie.__webglTexture,n.TEXTURE0+P)},this.rebindTextures=function Ae(k,P,ie){const Te=i.get(k);void 0!==P&&nt(Te.__webglFramebuffer,k,k.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),void 0!==ie&&ye(k)},this.setupRenderTarget=function Ee(k){const P=k.texture,ie=i.get(k),Te=i.get(P);k.addEventListener("dispose",ee),!0!==k.isWebGLMultipleRenderTargets&&(void 0===Te.__webglTexture&&(Te.__webglTexture=n.createTexture()),Te.__version=P.version,o.memory.textures++);const xe=!0===k.isWebGLCubeRenderTarget,De=!0===k.isWebGLMultipleRenderTargets,rt=C(k)||a;if(xe){ie.__webglFramebuffer=[];for(let Ie=0;Ie<6;Ie++)if(a&&P.mipmaps&&P.mipmaps.length>0){ie.__webglFramebuffer[Ie]=[];for(let qe=0;qe<P.mipmaps.length;qe++)ie.__webglFramebuffer[Ie][qe]=n.createFramebuffer()}else ie.__webglFramebuffer[Ie]=n.createFramebuffer()}else{if(a&&P.mipmaps&&P.mipmaps.length>0){ie.__webglFramebuffer=[];for(let Ie=0;Ie<P.mipmaps.length;Ie++)ie.__webglFramebuffer[Ie]=n.createFramebuffer()}else ie.__webglFramebuffer=n.createFramebuffer();if(De)if(r.drawBuffers){const Ie=k.texture;for(let qe=0,W=Ie.length;qe<W;qe++){const Re=i.get(Ie[qe]);void 0===Re.__webglTexture&&(Re.__webglTexture=n.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&k.samples>0&&!1===bt(k)){const Ie=De?P:[P];ie.__webglMultisampledFramebuffer=n.createFramebuffer(),ie.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,ie.__webglMultisampledFramebuffer);for(let qe=0;qe<Ie.length;qe++){const W=Ie[qe];ie.__webglColorRenderbuffer[qe]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,ie.__webglColorRenderbuffer[qe]);const Re=s.convert(W.format,W.colorSpace),we=s.convert(W.type),Ct=O(W.internalFormat,Re,we,W.colorSpace,!0===k.isXRRenderTarget),at=Qe(k);n.renderbufferStorageMultisample(n.RENDERBUFFER,at,Ct,k.width,k.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+qe,n.RENDERBUFFER,ie.__webglColorRenderbuffer[qe])}n.bindRenderbuffer(n.RENDERBUFFER,null),k.depthBuffer&&(ie.__webglDepthRenderbuffer=n.createRenderbuffer(),z(ie.__webglDepthRenderbuffer,k,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(xe){t.bindTexture(n.TEXTURE_CUBE_MAP,Te.__webglTexture),Be(n.TEXTURE_CUBE_MAP,P,rt);for(let Ie=0;Ie<6;Ie++)if(a&&P.mipmaps&&P.mipmaps.length>0)for(let qe=0;qe<P.mipmaps.length;qe++)nt(ie.__webglFramebuffer[Ie][qe],k,P,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Ie,qe);else nt(ie.__webglFramebuffer[Ie],k,P,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Ie,0);A(P,rt)&&D(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(De){const Ie=k.texture;for(let qe=0,W=Ie.length;qe<W;qe++){const Re=Ie[qe],we=i.get(Re);t.bindTexture(n.TEXTURE_2D,we.__webglTexture),Be(n.TEXTURE_2D,Re,rt),nt(ie.__webglFramebuffer,k,Re,n.COLOR_ATTACHMENT0+qe,n.TEXTURE_2D,0),A(Re,rt)&&D(n.TEXTURE_2D)}t.unbindTexture()}else{let Ie=n.TEXTURE_2D;if((k.isWebGL3DRenderTarget||k.isWebGLArrayRenderTarget)&&(a?Ie=k.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(Ie,Te.__webglTexture),Be(Ie,P,rt),a&&P.mipmaps&&P.mipmaps.length>0)for(let qe=0;qe<P.mipmaps.length;qe++)nt(ie.__webglFramebuffer[qe],k,P,n.COLOR_ATTACHMENT0,Ie,qe);else nt(ie.__webglFramebuffer,k,P,n.COLOR_ATTACHMENT0,Ie,0);A(P,rt)&&D(Ie),t.unbindTexture()}k.depthBuffer&&ye(k)},this.updateRenderTargetMipmap=function ot(k){const P=C(k)||a,ie=!0===k.isWebGLMultipleRenderTargets?k.texture:[k.texture];for(let Te=0,xe=ie.length;Te<xe;Te++){const De=ie[Te];if(A(De,P)){const rt=k.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D,Ie=i.get(De).__webglTexture;t.bindTexture(rt,Ie),D(rt),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function Ze(k){if(a&&k.samples>0&&!1===bt(k)){const P=k.isWebGLMultipleRenderTargets?k.texture:[k.texture],ie=k.width,Te=k.height;let xe=n.COLOR_BUFFER_BIT;const De=[],rt=k.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Ie=i.get(k),qe=!0===k.isWebGLMultipleRenderTargets;if(qe)for(let W=0;W<P.length;W++)t.bindFramebuffer(n.FRAMEBUFFER,Ie.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+W,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,Ie.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+W,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,Ie.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Ie.__webglFramebuffer);for(let W=0;W<P.length;W++){De.push(n.COLOR_ATTACHMENT0+W),k.depthBuffer&&De.push(rt);const Re=void 0!==Ie.__ignoreDepthValues&&Ie.__ignoreDepthValues;if(!1===Re&&(k.depthBuffer&&(xe|=n.DEPTH_BUFFER_BIT),k.stencilBuffer&&(xe|=n.STENCIL_BUFFER_BIT)),qe&&n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,Ie.__webglColorRenderbuffer[W]),!0===Re&&(n.invalidateFramebuffer(n.READ_FRAMEBUFFER,[rt]),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[rt])),qe){const we=i.get(P[W]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,we,0)}n.blitFramebuffer(0,0,ie,Te,0,0,ie,Te,xe,n.NEAREST),m&&n.invalidateFramebuffer(n.READ_FRAMEBUFFER,De)}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),qe)for(let W=0;W<P.length;W++){t.bindFramebuffer(n.FRAMEBUFFER,Ie.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+W,n.RENDERBUFFER,Ie.__webglColorRenderbuffer[W]);const Re=i.get(P[W]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,Ie.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+W,n.TEXTURE_2D,Re,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Ie.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=ye,this.setupFrameBufferTexture=nt,this.useMultisampledRTT=bt}function Cie(n,e,t){const i=t.isWebGL2;return{convert:function r(s,o=""){let a;const l=Sn.getTransfer(o);if(s===fu)return n.UNSIGNED_BYTE;if(1017===s)return n.UNSIGNED_SHORT_4_4_4_4;if(1018===s)return n.UNSIGNED_SHORT_5_5_5_1;if(1010===s)return n.BYTE;if(1011===s)return n.SHORT;if(1012===s)return n.UNSIGNED_SHORT;if(1013===s)return n.INT;if(s===pu)return n.UNSIGNED_INT;if(s===$l)return n.FLOAT;if(s===Yy)return i?n.HALF_FLOAT:(a=e.get("OES_texture_half_float"),null!==a?a.HALF_FLOAT_OES:null);if(1021===s)return n.ALPHA;if(s===Do)return n.RGBA;if(1024===s)return n.LUMINANCE;if(1025===s)return n.LUMINANCE_ALPHA;if(s===Gh)return n.DEPTH_COMPONENT;if(s===Wp)return n.DEPTH_STENCIL;if(1035===s)return a=e.get("EXT_sRGB"),null!==a?a.SRGB_ALPHA_EXT:null;if(1028===s)return n.RED;if(1029===s)return n.RED_INTEGER;if(1030===s)return n.RG;if(1031===s)return n.RG_INTEGER;if(1033===s)return n.RGBA_INTEGER;if(33776===s||33777===s||33778===s||33779===s)if(l===ni){if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===a)return null;if(33776===s)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(a=e.get("WEBGL_compressed_texture_s3tc"),null===a)return null;if(33776===s)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===s)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===s)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===s)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===s||35841===s||35842===s||35843===s){if(a=e.get("WEBGL_compressed_texture_pvrtc"),null===a)return null;if(35840===s)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===s)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===s)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===s)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===s)return a=e.get("WEBGL_compressed_texture_etc1"),null!==a?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===s||37496===s){if(a=e.get("WEBGL_compressed_texture_etc"),null===a)return null;if(37492===s)return l===ni?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(37496===s)return l===ni?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}if(37808===s||37809===s||37810===s||37811===s||37812===s||37813===s||37814===s||37815===s||37816===s||37817===s||37818===s||37819===s||37820===s||37821===s){if(a=e.get("WEBGL_compressed_texture_astc"),null===a)return null;if(37808===s)return l===ni?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===s)return l===ni?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===s)return l===ni?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===s)return l===ni?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===s)return l===ni?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===s)return l===ni?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===s)return l===ni?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===s)return l===ni?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===s)return l===ni?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===s)return l===ni?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===s)return l===ni?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===s)return l===ni?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===s)return l===ni?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===s)return l===ni?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===s||36494===s||36495===s){if(a=e.get("EXT_texture_compression_bptc"),null===a)return null;if(36492===s)return l===ni?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(36494===s)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(36495===s)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(36283===s||36284===s||36285===s||36286===s){if(a=e.get("EXT_texture_compression_rgtc"),null===a)return null;if(36492===s)return a.COMPRESSED_RED_RGTC1_EXT;if(36284===s)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===s)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===s)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return s===zh?i?n.UNSIGNED_INT_24_8:(a=e.get("WEBGL_depth_texture"),null!==a?a.UNSIGNED_INT_24_8_WEBGL:null):void 0!==n[s]?n[s]:null}}}class xie extends ir{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Za extends fi{constructor(){super(),this.isGroup=!0,this.type="Group"}}const Mie={type:"move"};class gI{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Za,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Za,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new L,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new L),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Za,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new L,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new L),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,i){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,c=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(c&&e.hand){o=!0;for(const v of e.hand.values()){const w=t.getJointPose(v,i),y=this._getHandJoint(c,v);null!==w&&(y.matrix.fromArray(w.transform.matrix),y.matrix.decompose(y.position,y.rotation,y.scale),y.matrixWorldNeedsUpdate=!0,y.jointRadius=w.radius),y.visible=null!==w}const p=c.joints["index-finger-tip"].position.distanceTo(c.joints["thumb-tip"].position),m=.02,g=.005;c.inputState.pinching&&p>m+g?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&p<=m-g&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==l&&e.gripSpace&&(s=t.getPose(e.gripSpace,i),null!==s&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));null!==a&&(r=t.getPose(e.targetRaySpace,i),null===r&&null!==s&&(r=s),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(Mie)))}return null!==a&&(a.visible=null!==r),null!==l&&(l.visible=null!==s),null!==c&&(c.visible=null!==o),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const i=new Za;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}class Tie extends Ro{constructor(e,t,i,r,s,o,a,l,c,h){if((h=void 0!==h?h:Gh)!==Gh&&h!==Wp)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&h===Gh&&(i=pu),void 0===i&&h===Wp&&(i=zh),super(null,r,s,o,a,l,h,i,c),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==a?a:Li,this.minFilter=void 0!==l?l:Li,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}class Aie extends $h{constructor(e,t){super();const i=this;let r=null,s=1,o=null,a="local-floor",l=1,c=null,h=null,d=null,p=null,m=null,g=null;const v=t.getContextAttributes();let w=null,y=null;const b=[],E=[],C=new ir;C.layers.enable(1),C.viewport=new Nn;const x=new ir;x.layers.enable(2),x.viewport=new Nn;const A=[C,x],D=new xie;D.layers.enable(1),D.layers.enable(2);let O=null,T=null;function R(q){const oe=E.indexOf(q.inputSource);if(-1===oe)return;const Se=b[oe];void 0!==Se&&(Se.update(q.inputSource,q.frame,c||o),Se.dispatchEvent({type:q.type,data:q.inputSource}))}function $(){r.removeEventListener("select",R),r.removeEventListener("selectstart",R),r.removeEventListener("selectend",R),r.removeEventListener("squeeze",R),r.removeEventListener("squeezestart",R),r.removeEventListener("squeezeend",R),r.removeEventListener("end",$),r.removeEventListener("inputsourceschange",ee);for(let q=0;q<b.length;q++){const oe=E[q];null!==oe&&(E[q]=null,b[q].disconnect(oe))}O=null,T=null,e.setRenderTarget(w),m=null,p=null,d=null,r=null,y=null,le.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}function ee(q){for(let oe=0;oe<q.removed.length;oe++){const Se=q.removed[oe],ve=E.indexOf(Se);ve>=0&&(E[ve]=null,b[ve].disconnect(Se))}for(let oe=0;oe<q.added.length;oe++){const Se=q.added[oe];let ve=E.indexOf(Se);if(-1===ve){for(let $e=0;$e<b.length;$e++){if($e>=E.length){E.push(Se),ve=$e;break}if(null===E[$e]){E[$e]=Se,ve=$e;break}}if(-1===ve)break}const Ne=b[ve];Ne&&Ne.connect(Se)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(q){let oe=b[q];return void 0===oe&&(oe=new gI,b[q]=oe),oe.getTargetRaySpace()},this.getControllerGrip=function(q){let oe=b[q];return void 0===oe&&(oe=new gI,b[q]=oe),oe.getGripSpace()},this.getHand=function(q){let oe=b[q];return void 0===oe&&(oe=new gI,b[q]=oe),oe.getHandSpace()},this.setFramebufferScaleFactor=function(q){s=q,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(q){a=q,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||o},this.setReferenceSpace=function(q){c=q},this.getBaseLayer=function(){return null!==p?p:m},this.getBinding=function(){return d},this.getFrame=function(){return g},this.getSession=function(){return r},this.setSession=function(){var q=Pn(function*(oe){if(r=oe,null!==r){if(w=e.getRenderTarget(),r.addEventListener("select",R),r.addEventListener("selectstart",R),r.addEventListener("selectend",R),r.addEventListener("squeeze",R),r.addEventListener("squeezestart",R),r.addEventListener("squeezeend",R),r.addEventListener("end",$),r.addEventListener("inputsourceschange",ee),!0!==v.xrCompatible&&(yield t.makeXRCompatible()),void 0===r.renderState.layers||!1===e.capabilities.isWebGL2)m=new XRWebGLLayer(r,t,{antialias:void 0!==r.renderState.layers||v.antialias,alpha:!0,depth:v.depth,stencil:v.stencil,framebufferScaleFactor:s}),r.updateRenderState({baseLayer:m}),y=new Xh(m.framebufferWidth,m.framebufferHeight,{format:Do,type:fu,colorSpace:e.outputColorSpace,stencilBuffer:v.stencil});else{let Se=null,ve=null,Ne=null;v.depth&&(Ne=v.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,Se=v.stencil?Wp:Gh,ve=v.stencil?zh:pu);const $e={colorFormat:t.RGBA8,depthFormat:Ne,scaleFactor:s};d=new XRWebGLBinding(r,t),p=d.createProjectionLayer($e),r.updateRenderState({layers:[p]}),y=new Xh(p.textureWidth,p.textureHeight,{format:Do,type:fu,depthTexture:new Tie(p.textureWidth,p.textureHeight,ve,void 0,void 0,void 0,void 0,void 0,void 0,Se),stencilBuffer:v.stencil,colorSpace:e.outputColorSpace,samples:v.antialias?4:0}),e.properties.get(y).__ignoreDepthValues=p.ignoreDepthValues}y.isXRRenderTarget=!0,this.setFoveation(l),c=null,o=yield r.requestReferenceSpace(a),le.setContext(r),le.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}});return function(oe){return q.apply(this,arguments)}}(),this.getEnvironmentBlendMode=function(){if(null!==r)return r.environmentBlendMode};const se=new L,V=new L;function G(q,oe){null===oe?q.matrixWorld.copy(q.matrix):q.matrixWorld.multiplyMatrices(oe.matrixWorld,q.matrix),q.matrixWorldInverse.copy(q.matrixWorld).invert()}this.updateCamera=function(q){if(null===r)return;D.near=x.near=C.near=q.near,D.far=x.far=C.far=q.far,(O!==D.near||T!==D.far)&&(r.updateRenderState({depthNear:D.near,depthFar:D.far}),O=D.near,T=D.far);const oe=q.parent,Se=D.cameras;G(D,oe);for(let ve=0;ve<Se.length;ve++)G(Se[ve],oe);2===Se.length?function J(q,oe,Se){se.setFromMatrixPosition(oe.matrixWorld),V.setFromMatrixPosition(Se.matrixWorld);const ve=se.distanceTo(V),Ne=oe.projectionMatrix.elements,$e=Se.projectionMatrix.elements,Be=Ne[14]/(Ne[10]-1),Xe=Ne[14]/(Ne[10]+1),dt=(Ne[9]+1)/Ne[5],St=(Ne[9]-1)/Ne[5],nt=(Ne[8]-1)/Ne[0],z=($e[8]+1)/$e[0],Le=Be*nt,ye=Be*z,Ae=ve/(-nt+z),Ee=Ae*-nt;oe.matrixWorld.decompose(q.position,q.quaternion,q.scale),q.translateX(Ee),q.translateZ(Ae),q.matrixWorld.compose(q.position,q.quaternion,q.scale),q.matrixWorldInverse.copy(q.matrixWorld).invert();const ot=Be+Ae,Ze=Xe+Ae;q.projectionMatrix.makePerspective(Le-Ee,ye+(ve-Ee),dt*Xe/Ze*ot,St*Xe/Ze*ot,ot,Ze),q.projectionMatrixInverse.copy(q.projectionMatrix).invert()}(D,C,x):D.projectionMatrix.copy(C.projectionMatrix),function X(q,oe,Se){null===Se?q.matrix.copy(oe.matrixWorld):(q.matrix.copy(Se.matrixWorld),q.matrix.invert(),q.matrix.multiply(oe.matrixWorld)),q.matrix.decompose(q.position,q.quaternion,q.scale),q.updateMatrixWorld(!0),q.projectionMatrix.copy(oe.projectionMatrix),q.projectionMatrixInverse.copy(oe.projectionMatrixInverse),q.isPerspectiveCamera&&(q.fov=2*Xp*Math.atan(1/q.projectionMatrix.elements[5]),q.zoom=1)}(q,D,oe)},this.getCamera=function(){return D},this.getFoveation=function(){if(null!==p||null!==m)return l},this.setFoveation=function(q){l=q,null!==p&&(p.fixedFoveation=q),null!==m&&void 0!==m.fixedFoveation&&(m.fixedFoveation=q)};let Q=null;const le=new CV;le.setAnimationLoop(function Z(q,oe){if(h=oe.getViewerPose(c||o),g=oe,null!==h){const Se=h.views;null!==m&&(e.setRenderTargetFramebuffer(y,m.framebuffer),e.setRenderTarget(y));let ve=!1;Se.length!==D.cameras.length&&(D.cameras.length=0,ve=!0);for(let Ne=0;Ne<Se.length;Ne++){const $e=Se[Ne];let Be=null;if(null!==m)Be=m.getViewport($e);else{const dt=d.getViewSubImage(p,$e);Be=dt.viewport,0===Ne&&(e.setRenderTargetTextures(y,dt.colorTexture,p.ignoreDepthValues?void 0:dt.depthStencilTexture),e.setRenderTarget(y))}let Xe=A[Ne];void 0===Xe&&(Xe=new ir,Xe.layers.enable(Ne),Xe.viewport=new Nn,A[Ne]=Xe),Xe.matrix.fromArray($e.transform.matrix),Xe.matrix.decompose(Xe.position,Xe.quaternion,Xe.scale),Xe.projectionMatrix.fromArray($e.projectionMatrix),Xe.projectionMatrixInverse.copy(Xe.projectionMatrix).invert(),Xe.viewport.set(Be.x,Be.y,Be.width,Be.height),0===Ne&&(D.matrix.copy(Xe.matrix),D.matrix.decompose(D.position,D.quaternion,D.scale)),!0===ve&&D.cameras.push(Xe)}}for(let Se=0;Se<b.length;Se++){const ve=E[Se],Ne=b[Se];null!==ve&&void 0!==Ne&&Ne.update(ve,oe,c||o)}Q&&Q(q,oe),oe.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:oe}),g=null}),this.setAnimationLoop=function(q){Q=q},this.dispose=function(){}}}function Die(n,e){function t(w,y){!0===w.matrixAutoUpdate&&w.updateMatrix(),y.value.copy(w.matrix)}function s(w,y){w.opacity.value=y.opacity,y.color&&w.diffuse.value.copy(y.color),y.emissive&&w.emissive.value.copy(y.emissive).multiplyScalar(y.emissiveIntensity),y.map&&(w.map.value=y.map,t(y.map,w.mapTransform)),y.alphaMap&&(w.alphaMap.value=y.alphaMap,t(y.alphaMap,w.alphaMapTransform)),y.bumpMap&&(w.bumpMap.value=y.bumpMap,t(y.bumpMap,w.bumpMapTransform),w.bumpScale.value=y.bumpScale,1===y.side&&(w.bumpScale.value*=-1)),y.normalMap&&(w.normalMap.value=y.normalMap,t(y.normalMap,w.normalMapTransform),w.normalScale.value.copy(y.normalScale),1===y.side&&w.normalScale.value.negate()),y.displacementMap&&(w.displacementMap.value=y.displacementMap,t(y.displacementMap,w.displacementMapTransform),w.displacementScale.value=y.displacementScale,w.displacementBias.value=y.displacementBias),y.emissiveMap&&(w.emissiveMap.value=y.emissiveMap,t(y.emissiveMap,w.emissiveMapTransform)),y.specularMap&&(w.specularMap.value=y.specularMap,t(y.specularMap,w.specularMapTransform)),y.alphaTest>0&&(w.alphaTest.value=y.alphaTest);const b=e.get(y).envMap;if(b&&(w.envMap.value=b,w.flipEnvMap.value=b.isCubeTexture&&!1===b.isRenderTargetTexture?-1:1,w.reflectivity.value=y.reflectivity,w.ior.value=y.ior,w.refractionRatio.value=y.refractionRatio),y.lightMap){w.lightMap.value=y.lightMap;const E=!0===n._useLegacyLights?Math.PI:1;w.lightMapIntensity.value=y.lightMapIntensity*E,t(y.lightMap,w.lightMapTransform)}y.aoMap&&(w.aoMap.value=y.aoMap,w.aoMapIntensity.value=y.aoMapIntensity,t(y.aoMap,w.aoMapTransform))}return{refreshFogUniforms:function i(w,y){y.color.getRGB(w.fogColor.value,SV(n)),y.isFog?(w.fogNear.value=y.near,w.fogFar.value=y.far):y.isFogExp2&&(w.fogDensity.value=y.density)},refreshMaterialUniforms:function r(w,y,b,E,C){y.isMeshBasicMaterial||y.isMeshLambertMaterial?s(w,y):y.isMeshToonMaterial?(s(w,y),function d(w,y){y.gradientMap&&(w.gradientMap.value=y.gradientMap)}(w,y)):y.isMeshPhongMaterial?(s(w,y),function h(w,y){w.specular.value.copy(y.specular),w.shininess.value=Math.max(y.shininess,1e-4)}(w,y)):y.isMeshStandardMaterial?(s(w,y),function p(w,y){w.metalness.value=y.metalness,y.metalnessMap&&(w.metalnessMap.value=y.metalnessMap,t(y.metalnessMap,w.metalnessMapTransform)),w.roughness.value=y.roughness,y.roughnessMap&&(w.roughnessMap.value=y.roughnessMap,t(y.roughnessMap,w.roughnessMapTransform)),e.get(y).envMap&&(w.envMapIntensity.value=y.envMapIntensity)}(w,y),y.isMeshPhysicalMaterial&&function m(w,y,b){w.ior.value=y.ior,y.sheen>0&&(w.sheenColor.value.copy(y.sheenColor).multiplyScalar(y.sheen),w.sheenRoughness.value=y.sheenRoughness,y.sheenColorMap&&(w.sheenColorMap.value=y.sheenColorMap,t(y.sheenColorMap,w.sheenColorMapTransform)),y.sheenRoughnessMap&&(w.sheenRoughnessMap.value=y.sheenRoughnessMap,t(y.sheenRoughnessMap,w.sheenRoughnessMapTransform))),y.clearcoat>0&&(w.clearcoat.value=y.clearcoat,w.clearcoatRoughness.value=y.clearcoatRoughness,y.clearcoatMap&&(w.clearcoatMap.value=y.clearcoatMap,t(y.clearcoatMap,w.clearcoatMapTransform)),y.clearcoatRoughnessMap&&(w.clearcoatRoughnessMap.value=y.clearcoatRoughnessMap,t(y.clearcoatRoughnessMap,w.clearcoatRoughnessMapTransform)),y.clearcoatNormalMap&&(w.clearcoatNormalMap.value=y.clearcoatNormalMap,t(y.clearcoatNormalMap,w.clearcoatNormalMapTransform),w.clearcoatNormalScale.value.copy(y.clearcoatNormalScale),1===y.side&&w.clearcoatNormalScale.value.negate())),y.iridescence>0&&(w.iridescence.value=y.iridescence,w.iridescenceIOR.value=y.iridescenceIOR,w.iridescenceThicknessMinimum.value=y.iridescenceThicknessRange[0],w.iridescenceThicknessMaximum.value=y.iridescenceThicknessRange[1],y.iridescenceMap&&(w.iridescenceMap.value=y.iridescenceMap,t(y.iridescenceMap,w.iridescenceMapTransform)),y.iridescenceThicknessMap&&(w.iridescenceThicknessMap.value=y.iridescenceThicknessMap,t(y.iridescenceThicknessMap,w.iridescenceThicknessMapTransform))),y.transmission>0&&(w.transmission.value=y.transmission,w.transmissionSamplerMap.value=b.texture,w.transmissionSamplerSize.value.set(b.width,b.height),y.transmissionMap&&(w.transmissionMap.value=y.transmissionMap,t(y.transmissionMap,w.transmissionMapTransform)),w.thickness.value=y.thickness,y.thicknessMap&&(w.thicknessMap.value=y.thicknessMap,t(y.thicknessMap,w.thicknessMapTransform)),w.attenuationDistance.value=y.attenuationDistance,w.attenuationColor.value.copy(y.attenuationColor)),y.anisotropy>0&&(w.anisotropyVector.value.set(y.anisotropy*Math.cos(y.anisotropyRotation),y.anisotropy*Math.sin(y.anisotropyRotation)),y.anisotropyMap&&(w.anisotropyMap.value=y.anisotropyMap,t(y.anisotropyMap,w.anisotropyMapTransform))),w.specularIntensity.value=y.specularIntensity,w.specularColor.value.copy(y.specularColor),y.specularColorMap&&(w.specularColorMap.value=y.specularColorMap,t(y.specularColorMap,w.specularColorMapTransform)),y.specularIntensityMap&&(w.specularIntensityMap.value=y.specularIntensityMap,t(y.specularIntensityMap,w.specularIntensityMapTransform))}(w,y,C)):y.isMeshMatcapMaterial?(s(w,y),function g(w,y){y.matcap&&(w.matcap.value=y.matcap)}(w,y)):y.isMeshDepthMaterial?s(w,y):y.isMeshDistanceMaterial?(s(w,y),function v(w,y){const b=e.get(y).light;w.referencePosition.value.setFromMatrixPosition(b.matrixWorld),w.nearDistance.value=b.shadow.camera.near,w.farDistance.value=b.shadow.camera.far}(w,y)):y.isMeshNormalMaterial?s(w,y):y.isLineBasicMaterial?(function o(w,y){w.diffuse.value.copy(y.color),w.opacity.value=y.opacity,y.map&&(w.map.value=y.map,t(y.map,w.mapTransform))}(w,y),y.isLineDashedMaterial&&function a(w,y){w.dashSize.value=y.dashSize,w.totalSize.value=y.dashSize+y.gapSize,w.scale.value=y.scale}(w,y)):y.isPointsMaterial?function l(w,y,b,E){w.diffuse.value.copy(y.color),w.opacity.value=y.opacity,w.size.value=y.size*b,w.scale.value=.5*E,y.map&&(w.map.value=y.map,t(y.map,w.uvTransform)),y.alphaMap&&(w.alphaMap.value=y.alphaMap,t(y.alphaMap,w.alphaMapTransform)),y.alphaTest>0&&(w.alphaTest.value=y.alphaTest)}(w,y,b,E):y.isSpriteMaterial?function c(w,y){w.diffuse.value.copy(y.color),w.opacity.value=y.opacity,w.rotation.value=y.rotation,y.map&&(w.map.value=y.map,t(y.map,w.mapTransform)),y.alphaMap&&(w.alphaMap.value=y.alphaMap,t(y.alphaMap,w.alphaMapTransform)),y.alphaTest>0&&(w.alphaTest.value=y.alphaTest)}(w,y):y.isShadowMaterial?(w.color.value.copy(y.color),w.opacity.value=y.opacity):y.isShaderMaterial&&(y.uniformsNeedUpdate=!1)}}}function Iie(n,e,t,i){let r={},s={},o=[];const a=t.isWebGL2?n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS):0;function m(b,E,C){const x=b.value;if(void 0===C[E]){if("number"==typeof x)C[E]=x;else{const A=Array.isArray(x)?x:[x],D=[];for(let O=0;O<A.length;O++)D.push(A[O].clone());C[E]=D}return!0}if("number"==typeof x){if(C[E]!==x)return C[E]=x,!0}else{const A=Array.isArray(C[E])?C[E]:[C[E]],D=Array.isArray(x)?x:[x];for(let O=0;O<A.length;O++){const T=A[O];if(!1===T.equals(D[O]))return T.copy(D[O]),!0}}return!1}function v(b){const E={boundary:0,storage:0};return"number"==typeof b?(E.boundary=4,E.storage=4):b.isVector2?(E.boundary=8,E.storage=8):b.isVector3||b.isColor?(E.boundary=16,E.storage=12):b.isVector4?(E.boundary=16,E.storage=16):b.isMatrix3?(E.boundary=48,E.storage=48):b.isMatrix4?(E.boundary=64,E.storage=64):b.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",b),E}function w(b){const E=b.target;E.removeEventListener("dispose",w);const C=o.indexOf(E.__bindingPointIndex);o.splice(C,1),n.deleteBuffer(r[E.id]),delete r[E.id],delete s[E.id]}return{bind:function l(b,E){i.uniformBlockBinding(b,E.program)},update:function c(b,E){let C=r[b.id];void 0===C&&(function g(b){const E=b.uniforms;let C=0;let A=0;for(let D=0,O=E.length;D<O;D++){const T=E[D],R={boundary:0,storage:0},$=Array.isArray(T.value)?T.value:[T.value];for(let ee=0,se=$.length;ee<se;ee++){const J=v($[ee]);R.boundary+=J.boundary,R.storage+=J.storage}T.__data=new Float32Array(R.storage/Float32Array.BYTES_PER_ELEMENT),T.__offset=C,D>0&&(A=C%16,0!==A&&16-A-R.boundary<0&&(C+=16-A,T.__offset=C)),C+=R.storage}A=C%16,A>0&&(C+=16-A),b.__size=C,b.__cache={}}(b),C=function h(b){const E=function d(){for(let b=0;b<a;b++)if(-1===o.indexOf(b))return o.push(b),b;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();b.__bindingPointIndex=E;const C=n.createBuffer(),x=b.__size,A=b.usage;return n.bindBuffer(n.UNIFORM_BUFFER,C),n.bufferData(n.UNIFORM_BUFFER,x,A),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,E,C),C}(b),r[b.id]=C,b.addEventListener("dispose",w)),i.updateUBOMapping(b,E.program);const A=e.render.frame;s[b.id]!==A&&(function p(b){const C=b.uniforms,x=b.__cache;n.bindBuffer(n.UNIFORM_BUFFER,r[b.id]);for(let A=0,D=C.length;A<D;A++){const O=C[A];if(!0===m(O,A,x)){const T=O.__offset,R=Array.isArray(O.value)?O.value:[O.value];let $=0;for(let ee=0;ee<R.length;ee++){const se=R[ee],V=v(se);"number"==typeof se?(O.__data[0]=se,n.bufferSubData(n.UNIFORM_BUFFER,T+$,O.__data)):se.isMatrix3?(O.__data[0]=se.elements[0],O.__data[1]=se.elements[1],O.__data[2]=se.elements[2],O.__data[3]=se.elements[0],O.__data[4]=se.elements[3],O.__data[5]=se.elements[4],O.__data[6]=se.elements[5],O.__data[7]=se.elements[0],O.__data[8]=se.elements[6],O.__data[9]=se.elements[7],O.__data[10]=se.elements[8],O.__data[11]=se.elements[0]):(se.toArray(O.__data,$),$+=V.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,T,O.__data)}}n.bindBuffer(n.UNIFORM_BUFFER,null)}(b),s[b.id]=A)},dispose:function y(){for(const b in r)n.deleteBuffer(r[b]);o=[],r={},s={}}}}class _I{constructor(e={}){const{canvas:t=hQ(),context:i=null,depth:r=!0,stencil:s=!0,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:c=!1,powerPreference:h="default",failIfMajorPerformanceCaveat:d=!1}=e;let p;this.isWebGLRenderer=!0,p=null!==i?i.getContextAttributes().alpha:o;const m=new Uint32Array(4),g=new Int32Array(4);let v=null,w=null;const y=[],b=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=di,this._useLegacyLights=!1,this.toneMapping=hu,this.toneMappingExposure=1;const E=this;let C=!1,x=0,A=0,D=null,O=-1,T=null;const R=new Nn,$=new Nn;let ee=null;const se=new We(0);let V=0,J=t.width,G=t.height,X=1,Q=null,Z=null;const le=new Nn(0,0,J,G),q=new Nn(0,0,J,G);let oe=!1;const Se=new cI;let ve=!1,Ne=!1,$e=null;const Be=new wt,Xe=new fe,dt=new L,St={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function nt(){return null===D?X:1}let ye,Ae,Ee,ot,Ze,Qe,bt,en,li,k,P,ie,Te,xe,De,rt,Ie,qe,W,Re,we,Ct,at,ft,z=i;function Le(F,te){for(let he=0;he<F.length;he++){const de=t.getContext(F[he],te);if(null!==de)return de}return null}try{const F={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:h,failIfMajorPerformanceCaveat:d};if("setAttribute"in t&&t.setAttribute("data-engine","three.js r157"),t.addEventListener("webglcontextlost",Fe,!1),t.addEventListener("webglcontextrestored",Pe,!1),t.addEventListener("webglcontextcreationerror",je,!1),null===z){const te=["webgl2","webgl","experimental-webgl"];if(!0===E.isWebGL1Renderer&&te.shift(),z=Le(te,F),null===z)throw Le(te)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&z instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),void 0===z.getShaderPrecisionFormat&&(z.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(F){throw console.error("THREE.WebGLRenderer: "+F.message),F}function st(){ye=new Gte(z),Ae=new kte(z,ye,e),ye.init(Ae),Ct=new Cie(z,ye,Ae),Ee=new Eie(z,ye,Ae),ot=new $te(z),Ze=new uie,Qe=new Sie(z,ye,Ee,Ze,Ae,Ct,ot),bt=new Bte(E),en=new zte(E),li=new FQ(z,Ae),at=new Ote(z,ye,li,Ae),k=new Wte(z,li,ot,at),P=new Kte(z,k,li,ot),W=new Yte(z,Ae,Qe),rt=new Ute(Ze),ie=new cie(E,bt,en,ye,Ae,at,rt),Te=new Die(E,Ze),xe=new die,De=new yie(ye,Ae),qe=new Lte(E,bt,en,Ee,P,p,l),Ie=new bie(E,P,Ae),ft=new Iie(z,ot,Ae,Ee),Re=new Fte(z,ye,ot,Ae),we=new jte(z,ye,ot,Ae),ot.programs=ie.programs,E.capabilities=Ae,E.extensions=ye,E.properties=Ze,E.renderLists=xe,E.shadowMap=Ie,E.state=Ee,E.info=ot}st();const H=new Aie(E,z);function Fe(F){F.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),C=!0}function Pe(){console.log("THREE.WebGLRenderer: Context Restored."),C=!1;const F=ot.autoReset,te=Ie.enabled,he=Ie.autoUpdate,ne=Ie.needsUpdate,de=Ie.type;st(),ot.autoReset=F,Ie.enabled=te,Ie.autoUpdate=he,Ie.needsUpdate=ne,Ie.type=de}function je(F){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",F.statusMessage)}function ke(F){const te=F.target;te.removeEventListener("dispose",ke),function Ce(F){(function it(F){const te=Ze.get(F).programs;void 0!==te&&(te.forEach(function(he){ie.releaseProgram(he)}),F.isShaderMaterial&&ie.releaseShaderCache(F))})(F),Ze.remove(F)}(te)}this.xr=H,this.getContext=function(){return z},this.getContextAttributes=function(){return z.getContextAttributes()},this.forceContextLoss=function(){const F=ye.get("WEBGL_lose_context");F&&F.loseContext()},this.forceContextRestore=function(){const F=ye.get("WEBGL_lose_context");F&&F.restoreContext()},this.getPixelRatio=function(){return X},this.setPixelRatio=function(F){void 0!==F&&(X=F,this.setSize(J,G,!1))},this.getSize=function(F){return F.set(J,G)},this.setSize=function(F,te,he=!0){H.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(J=F,G=te,t.width=Math.floor(F*X),t.height=Math.floor(te*X),!0===he&&(t.style.width=F+"px",t.style.height=te+"px"),this.setViewport(0,0,F,te))},this.getDrawingBufferSize=function(F){return F.set(J*X,G*X).floor()},this.setDrawingBufferSize=function(F,te,he){J=F,G=te,X=he,t.width=Math.floor(F*he),t.height=Math.floor(te*he),this.setViewport(0,0,F,te)},this.getCurrentViewport=function(F){return F.copy(R)},this.getViewport=function(F){return F.copy(le)},this.setViewport=function(F,te,he,ne){F.isVector4?le.set(F.x,F.y,F.z,F.w):le.set(F,te,he,ne),Ee.viewport(R.copy(le).multiplyScalar(X).floor())},this.getScissor=function(F){return F.copy(q)},this.setScissor=function(F,te,he,ne){F.isVector4?q.set(F.x,F.y,F.z,F.w):q.set(F,te,he,ne),Ee.scissor($.copy(q).multiplyScalar(X).floor())},this.getScissorTest=function(){return oe},this.setScissorTest=function(F){Ee.setScissorTest(oe=F)},this.setOpaqueSort=function(F){Q=F},this.setTransparentSort=function(F){Z=F},this.getClearColor=function(F){return F.copy(qe.getClearColor())},this.setClearColor=function(){qe.setClearColor.apply(qe,arguments)},this.getClearAlpha=function(){return qe.getClearAlpha()},this.setClearAlpha=function(){qe.setClearAlpha.apply(qe,arguments)},this.clear=function(F=!0,te=!0,he=!0){let ne=0;if(F){let de=!1;if(null!==D){const et=D.texture.format;de=1033===et||1031===et||1029===et}if(de){const et=D.texture.type,yt=et===fu||et===pu||1012===et||et===zh||1017===et||1018===et,Ot=qe.getClearColor(),Ft=qe.getClearAlpha(),tn=Ot.r,Pt=Ot.g,Xt=Ot.b;yt?(m[0]=tn,m[1]=Pt,m[2]=Xt,m[3]=Ft,z.clearBufferuiv(z.COLOR,0,m)):(g[0]=tn,g[1]=Pt,g[2]=Xt,g[3]=Ft,z.clearBufferiv(z.COLOR,0,g))}else ne|=z.COLOR_BUFFER_BIT}te&&(ne|=z.DEPTH_BUFFER_BIT),he&&(ne|=z.STENCIL_BUFFER_BIT),z.clear(ne)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Fe,!1),t.removeEventListener("webglcontextrestored",Pe,!1),t.removeEventListener("webglcontextcreationerror",je,!1),xe.dispose(),De.dispose(),Ze.dispose(),bt.dispose(),en.dispose(),P.dispose(),at.dispose(),ft.dispose(),ie.dispose(),H.dispose(),H.removeEventListener("sessionstart",ri),H.removeEventListener("sessionend",il),$e&&($e.dispose(),$e=null),ws.stop()},this.renderBufferDirect=function(F,te,he,ne,de,et){null===te&&(te=St);const yt=de.isMesh&&de.matrixWorld.determinant()<0,Ot=function xce(F,te,he,ne,de){!0!==te.isScene&&(te=St),Qe.resetTextureUnits();const et=te.fog,Ot=null===D?E.outputColorSpace:!0===D.isXRRenderTarget?D.texture.colorSpace:Tr,Ft=(ne.isMeshStandardMaterial?en:bt).get(ne.envMap||(ne.isMeshStandardMaterial?te.environment:null)),tn=!0===ne.vertexColors&&!!he.attributes.color&&4===he.attributes.color.itemSize,Pt=!!he.attributes.tangent&&(!!ne.normalMap||ne.anisotropy>0),Xt=!!he.morphAttributes.position,xi=!!he.morphAttributes.normal,Fi=!!he.morphAttributes.color;let Oo=hu;ne.toneMapped&&(null===D||!0===D.isXRRenderTarget)&&(Oo=E.toneMapping);const ac=he.morphAttributes.position||he.morphAttributes.normal||he.morphAttributes.color,Yi=void 0!==ac?ac.length:0,sn=Ze.get(ne),QR=w.state.lights;!0!==ve||!0!==Ne&&F===T||rt.setState(ne,F,F===T&&ne.id===O);let Ki=!1;ne.version===sn.__version?(sn.needsLights&&sn.lightsStateVersion!==QR.state.version||sn.outputColorSpace!==Ot||de.isInstancedMesh&&!1===sn.instancing||!de.isInstancedMesh&&!0===sn.instancing||de.isSkinnedMesh&&!1===sn.skinning||!de.isSkinnedMesh&&!0===sn.skinning||de.isInstancedMesh&&!0===sn.instancingColor&&null===de.instanceColor||de.isInstancedMesh&&!1===sn.instancingColor&&null!==de.instanceColor||sn.envMap!==Ft||!0===ne.fog&&sn.fog!==et||void 0!==sn.numClippingPlanes&&(sn.numClippingPlanes!==rt.numPlanes||sn.numIntersection!==rt.numIntersection)||sn.vertexAlphas!==tn||sn.vertexTangents!==Pt||sn.morphTargets!==Xt||sn.morphNormals!==xi||sn.morphColors!==Fi||sn.toneMapping!==Oo||!0===Ae.isWebGL2&&sn.morphTargetsCount!==Yi)&&(Ki=!0):(Ki=!0,sn.__version=ne.version);let _d=sn.currentProgram;!0===Ki&&(_d=BC(ne,te,de));let XG=!1,Gv=!1,eP=!1;const bs=_d.getUniforms(),yd=sn.uniforms;if(Ee.useProgram(_d.program)&&(XG=!0,Gv=!0,eP=!0),ne.id!==O&&(O=ne.id,Gv=!0),XG||T!==F){bs.setValue(z,"projectionMatrix",F.projectionMatrix),bs.setValue(z,"viewMatrix",F.matrixWorldInverse);const lo=bs.map.cameraPosition;void 0!==lo&&lo.setValue(z,dt.setFromMatrixPosition(F.matrixWorld)),Ae.logarithmicDepthBuffer&&bs.setValue(z,"logDepthBufFC",2/(Math.log(F.far+1)/Math.LN2)),(ne.isMeshPhongMaterial||ne.isMeshToonMaterial||ne.isMeshLambertMaterial||ne.isMeshBasicMaterial||ne.isMeshStandardMaterial||ne.isShaderMaterial)&&bs.setValue(z,"isOrthographic",!0===F.isOrthographicCamera),T!==F&&(T=F,Gv=!0,eP=!0)}if(de.isSkinnedMesh){bs.setOptional(z,de,"bindMatrix"),bs.setOptional(z,de,"bindMatrixInverse");const lo=de.skeleton;lo&&(Ae.floatVertexTextures?(null===lo.boneTexture&&lo.computeBoneTexture(),bs.setValue(z,"boneTexture",lo.boneTexture,Qe),bs.setValue(z,"boneTextureSize",lo.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const tP=he.morphAttributes;if((void 0!==tP.position||void 0!==tP.normal||void 0!==tP.color&&!0===Ae.isWebGL2)&&W.update(de,he,_d),(Gv||sn.receiveShadow!==de.receiveShadow)&&(sn.receiveShadow=de.receiveShadow,bs.setValue(z,"receiveShadow",de.receiveShadow)),ne.isMeshGouraudMaterial&&null!==ne.envMap&&(yd.envMap.value=Ft,yd.flipEnvMap.value=Ft.isCubeTexture&&!1===Ft.isRenderTargetTexture?-1:1),Gv&&(bs.setValue(z,"toneMappingExposure",E.toneMappingExposure),sn.needsLights&&function Mce(F,te){F.ambientLightColor.needsUpdate=te,F.lightProbe.needsUpdate=te,F.directionalLights.needsUpdate=te,F.directionalLightShadows.needsUpdate=te,F.pointLights.needsUpdate=te,F.pointLightShadows.needsUpdate=te,F.spotLights.needsUpdate=te,F.spotLightShadows.needsUpdate=te,F.rectAreaLights.needsUpdate=te,F.hemisphereLights.needsUpdate=te}(yd,eP),et&&!0===ne.fog&&Te.refreshFogUniforms(yd,et),Te.refreshMaterialUniforms(yd,ne,X,G,$e),RS.upload(z,sn.uniformsList,yd,Qe)),ne.isShaderMaterial&&!0===ne.uniformsNeedUpdate&&(RS.upload(z,sn.uniformsList,yd,Qe),ne.uniformsNeedUpdate=!1),ne.isSpriteMaterial&&bs.setValue(z,"center",de.center),bs.setValue(z,"modelViewMatrix",de.modelViewMatrix),bs.setValue(z,"normalMatrix",de.normalMatrix),bs.setValue(z,"modelMatrix",de.matrixWorld),ne.isShaderMaterial||ne.isRawShaderMaterial){const lo=ne.uniformsGroups;for(let nP=0,Ace=lo.length;nP<Ace;nP++)if(Ae.isWebGL2){const YG=lo[nP];ft.update(YG,_d),ft.bind(YG,_d)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return _d}(F,te,he,ne,de);Ee.setMaterial(ne,yt);let Ft=he.index,tn=1;if(!0===ne.wireframe){if(Ft=k.getWireframeAttribute(he),void 0===Ft)return;tn=2}const Pt=he.drawRange,Xt=he.attributes.position;let xi=Pt.start*tn,Fi=(Pt.start+Pt.count)*tn;null!==et&&(xi=Math.max(xi,et.start*tn),Fi=Math.min(Fi,(et.start+et.count)*tn)),null!==Ft?(xi=Math.max(xi,0),Fi=Math.min(Fi,Ft.count)):null!=Xt&&(xi=Math.max(xi,0),Fi=Math.min(Fi,Xt.count));const Oo=Fi-xi;if(Oo<0||Oo===1/0)return;at.setup(de,ne,Ot,he,Ft);let ac,Yi=Re;if(null!==Ft&&(ac=li.get(Ft),Yi=we,Yi.setIndex(ac)),de.isMesh)!0===ne.wireframe?(Ee.setLineWidth(ne.wireframeLinewidth*nt()),Yi.setMode(z.LINES)):Yi.setMode(z.TRIANGLES);else if(de.isLine){let sn=ne.linewidth;void 0===sn&&(sn=1),Ee.setLineWidth(sn*nt()),Yi.setMode(de.isLineSegments?z.LINES:de.isLineLoop?z.LINE_LOOP:z.LINE_STRIP)}else de.isPoints?Yi.setMode(z.POINTS):de.isSprite&&Yi.setMode(z.TRIANGLES);if(de.isInstancedMesh)Yi.renderInstances(xi,Oo,de.count);else if(he.isInstancedBufferGeometry){const QR=Math.min(he.instanceCount,void 0!==he._maxInstanceCount?he._maxInstanceCount:1/0);Yi.renderInstances(xi,Oo,QR)}else Yi.render(xi,Oo)},this.compile=function(F,te){function he(ne,de,et){!0===ne.transparent&&2===ne.side&&!1===ne.forceSinglePass?(ne.side=1,ne.needsUpdate=!0,BC(ne,de,et),ne.side=0,ne.needsUpdate=!0,BC(ne,de,et),ne.side=2):BC(ne,de,et)}w=De.get(F),w.init(),b.push(w),F.traverseVisible(function(ne){ne.isLight&&ne.layers.test(te.layers)&&(w.pushLight(ne),ne.castShadow&&w.pushShadow(ne))}),w.setupLights(E._useLegacyLights),F.traverse(function(ne){const de=ne.material;if(de)if(Array.isArray(de))for(let et=0;et<de.length;et++)he(de[et],F,ne);else he(de,F,ne)}),b.pop(),w=null};let Tt=null;function ri(){ws.stop()}function il(){ws.start()}const ws=new CV;function WG(F,te,he,ne){if(!1===F.visible)return;if(F.layers.test(te.layers))if(F.isGroup)he=F.renderOrder;else if(F.isLOD)!0===F.autoUpdate&&F.update(te);else if(F.isLight)w.pushLight(F),F.castShadow&&w.pushShadow(F);else if(F.isSprite){if(!F.frustumCulled||Se.intersectsSprite(F)){ne&&dt.setFromMatrixPosition(F.matrixWorld).applyMatrix4(Be);const yt=P.update(F),Ot=F.material;Ot.visible&&v.push(F,yt,Ot,he,dt.z,null)}}else if((F.isMesh||F.isLine||F.isPoints)&&(!F.frustumCulled||Se.intersectsObject(F))){const yt=P.update(F),Ot=F.material;if(ne&&(void 0!==F.boundingSphere?(null===F.boundingSphere&&F.computeBoundingSphere(),dt.copy(F.boundingSphere.center)):(null===yt.boundingSphere&&yt.computeBoundingSphere(),dt.copy(yt.boundingSphere.center)),dt.applyMatrix4(F.matrixWorld).applyMatrix4(Be)),Array.isArray(Ot)){const Ft=yt.groups;for(let tn=0,Pt=Ft.length;tn<Pt;tn++){const Xt=Ft[tn],xi=Ot[Xt.materialIndex];xi&&xi.visible&&v.push(F,yt,xi,he,dt.z,Xt)}}else Ot.visible&&v.push(F,yt,Ot,he,dt.z,null)}const et=F.children;for(let yt=0,Ot=et.length;yt<Ot;yt++)WG(et[yt],te,he,ne)}function jG(F,te,he,ne){const de=F.opaque,et=F.transmissive,yt=F.transparent;w.setupLightsView(he),!0===ve&&rt.setGlobalState(E.clippingPlanes,he),et.length>0&&function Cce(F,te,he,ne){const de=Ae.isWebGL2;null===$e&&($e=new Xh(1,1,{generateMipmaps:!0,type:ye.has("EXT_color_buffer_half_float")?Yy:fu,minFilter:jl,samples:de?4:0})),E.getDrawingBufferSize(Xe),de?$e.setSize(Xe.x,Xe.y):$e.setSize(oS(Xe.x),oS(Xe.y));const et=E.getRenderTarget();E.setRenderTarget($e),E.getClearColor(se),V=E.getClearAlpha(),V<1&&E.setClearColor(16777215,.5),E.clear();const yt=E.toneMapping;E.toneMapping=hu,UC(F,he,ne),Qe.updateMultisampleRenderTarget($e),Qe.updateRenderTargetMipmap($e);let Ot=!1;for(let Ft=0,tn=te.length;Ft<tn;Ft++){const Pt=te[Ft],Xt=Pt.object,xi=Pt.geometry,Fi=Pt.material,Oo=Pt.group;if(2===Fi.side&&Xt.layers.test(ne.layers)){const ac=Fi.side;Fi.side=1,Fi.needsUpdate=!0,$G(Xt,he,ne,xi,Fi,Oo),Fi.side=ac,Fi.needsUpdate=!0,Ot=!0}}!0===Ot&&(Qe.updateMultisampleRenderTarget($e),Qe.updateRenderTargetMipmap($e)),E.setRenderTarget(et),E.setClearColor(se,V),E.toneMapping=yt}(de,et,te,he),ne&&Ee.viewport(R.copy(ne)),de.length>0&&UC(de,te,he),et.length>0&&UC(et,te,he),yt.length>0&&UC(yt,te,he),Ee.buffers.depth.setTest(!0),Ee.buffers.depth.setMask(!0),Ee.buffers.color.setMask(!0),Ee.setPolygonOffset(!1)}function UC(F,te,he){const ne=!0===te.isScene?te.overrideMaterial:null;for(let de=0,et=F.length;de<et;de++){const yt=F[de],Ot=yt.object,Ft=yt.geometry,tn=null===ne?yt.material:ne,Pt=yt.group;Ot.layers.test(he.layers)&&$G(Ot,te,he,Ft,tn,Pt)}}function $G(F,te,he,ne,de,et){F.onBeforeRender(E,te,he,ne,de,et),F.modelViewMatrix.multiplyMatrices(he.matrixWorldInverse,F.matrixWorld),F.normalMatrix.getNormalMatrix(F.modelViewMatrix),de.onBeforeRender(E,te,he,ne,F,et),!0===de.transparent&&2===de.side&&!1===de.forceSinglePass?(de.side=1,de.needsUpdate=!0,E.renderBufferDirect(he,te,ne,de,F,et),de.side=0,de.needsUpdate=!0,E.renderBufferDirect(he,te,ne,de,F,et),de.side=2):E.renderBufferDirect(he,te,ne,de,F,et),F.onAfterRender(E,te,he,ne,de,et)}function BC(F,te,he){!0!==te.isScene&&(te=St);const ne=Ze.get(F),de=w.state.lights,yt=de.state.version,Ot=ie.getParameters(F,de.state,w.state.shadowsArray,te,he),Ft=ie.getProgramCacheKey(Ot);let tn=ne.programs;ne.environment=F.isMeshStandardMaterial?te.environment:null,ne.fog=te.fog,ne.envMap=(F.isMeshStandardMaterial?en:bt).get(F.envMap||ne.environment),void 0===tn&&(F.addEventListener("dispose",ke),tn=new Map,ne.programs=tn);let Pt=tn.get(Ft);if(void 0!==Pt){if(ne.currentProgram===Pt&&ne.lightsStateVersion===yt)return qG(F,Ot),Pt}else Ot.uniforms=ie.getUniforms(F),F.onBuild(he,Ot,E),F.onBeforeCompile(Ot,E),Pt=ie.acquireProgram(Ot,Ft),tn.set(Ft,Pt),ne.uniforms=Ot.uniforms;const Xt=ne.uniforms;(!F.isShaderMaterial&&!F.isRawShaderMaterial||!0===F.clipping)&&(Xt.clippingPlanes=rt.uniform),qG(F,Ot),ne.needsLights=function Tce(F){return F.isMeshLambertMaterial||F.isMeshToonMaterial||F.isMeshPhongMaterial||F.isMeshStandardMaterial||F.isShadowMaterial||F.isShaderMaterial&&!0===F.lights}(F),ne.lightsStateVersion=yt,ne.needsLights&&(Xt.ambientLightColor.value=de.state.ambient,Xt.lightProbe.value=de.state.probe,Xt.directionalLights.value=de.state.directional,Xt.directionalLightShadows.value=de.state.directionalShadow,Xt.spotLights.value=de.state.spot,Xt.spotLightShadows.value=de.state.spotShadow,Xt.rectAreaLights.value=de.state.rectArea,Xt.ltc_1.value=de.state.rectAreaLTC1,Xt.ltc_2.value=de.state.rectAreaLTC2,Xt.pointLights.value=de.state.point,Xt.pointLightShadows.value=de.state.pointShadow,Xt.hemisphereLights.value=de.state.hemi,Xt.directionalShadowMap.value=de.state.directionalShadowMap,Xt.directionalShadowMatrix.value=de.state.directionalShadowMatrix,Xt.spotShadowMap.value=de.state.spotShadowMap,Xt.spotLightMatrix.value=de.state.spotLightMatrix,Xt.spotLightMap.value=de.state.spotLightMap,Xt.pointShadowMap.value=de.state.pointShadowMap,Xt.pointShadowMatrix.value=de.state.pointShadowMatrix);const xi=Pt.getUniforms(),Fi=RS.seqWithValue(xi.seq,Xt);return ne.currentProgram=Pt,ne.uniformsList=Fi,Pt}function qG(F,te){const he=Ze.get(F);he.outputColorSpace=te.outputColorSpace,he.instancing=te.instancing,he.instancingColor=te.instancingColor,he.skinning=te.skinning,he.morphTargets=te.morphTargets,he.morphNormals=te.morphNormals,he.morphColors=te.morphColors,he.morphTargetsCount=te.morphTargetsCount,he.numClippingPlanes=te.numClippingPlanes,he.numIntersection=te.numClipIntersection,he.vertexAlphas=te.vertexAlphas,he.vertexTangents=te.vertexTangents,he.toneMapping=te.toneMapping}ws.setAnimationLoop(function Xi(F){Tt&&Tt(F)}),typeof self<"u"&&ws.setContext(self),this.setAnimationLoop=function(F){Tt=F,H.setAnimationLoop(F),null===F?ws.stop():ws.start()},H.addEventListener("sessionstart",ri),H.addEventListener("sessionend",il),this.render=function(F,te){if(void 0===te||!0===te.isCamera){if(!0!==C){if(!0===F.matrixWorldAutoUpdate&&F.updateMatrixWorld(),null===te.parent&&!0===te.matrixWorldAutoUpdate&&te.updateMatrixWorld(),!0===H.enabled&&!0===H.isPresenting&&(!0===H.cameraAutoUpdate&&H.updateCamera(te),te=H.getCamera()),!0===F.isScene&&F.onBeforeRender(E,F,te,D),w=De.get(F,b.length),w.init(),b.push(w),Be.multiplyMatrices(te.projectionMatrix,te.matrixWorldInverse),Se.setFromProjectionMatrix(Be),Ne=this.localClippingEnabled,ve=rt.init(this.clippingPlanes,Ne),v=xe.get(F,y.length),v.init(),y.push(v),WG(F,te,0,E.sortObjects),v.finish(),!0===E.sortObjects&&v.sort(Q,Z),this.info.render.frame++,!0===ve&&rt.beginShadows(),Ie.render(w.state.shadowsArray,F,te),!0===ve&&rt.endShadows(),!0===this.info.autoReset&&this.info.reset(),qe.render(v,F),w.setupLights(E._useLegacyLights),te.isArrayCamera){const ne=te.cameras;for(let de=0,et=ne.length;de<et;de++){const yt=ne[de];jG(v,F,yt,yt.viewport)}}else jG(v,F,te);null!==D&&(Qe.updateMultisampleRenderTarget(D),Qe.updateRenderTargetMipmap(D)),!0===F.isScene&&F.onAfterRender(E,F,te),at.resetDefaultState(),O=-1,T=null,b.pop(),w=b.length>0?b[b.length-1]:null,y.pop(),v=y.length>0?y[y.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return x},this.getActiveMipmapLevel=function(){return A},this.getRenderTarget=function(){return D},this.setRenderTargetTextures=function(F,te,he){Ze.get(F.texture).__webglTexture=te,Ze.get(F.depthTexture).__webglTexture=he;const ne=Ze.get(F);ne.__hasExternalTextures=!0,ne.__hasExternalTextures&&(ne.__autoAllocateDepthBuffer=void 0===he,ne.__autoAllocateDepthBuffer||!0===ye.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),ne.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(F,te){const he=Ze.get(F);he.__webglFramebuffer=te,he.__useDefaultFramebuffer=void 0===te},this.setRenderTarget=function(F,te=0,he=0){D=F,x=te,A=he;let ne=!0,de=null,et=!1,yt=!1;if(F){const Ft=Ze.get(F);void 0!==Ft.__useDefaultFramebuffer?(Ee.bindFramebuffer(z.FRAMEBUFFER,null),ne=!1):void 0===Ft.__webglFramebuffer?Qe.setupRenderTarget(F):Ft.__hasExternalTextures&&Qe.rebindTextures(F,Ze.get(F.texture).__webglTexture,Ze.get(F.depthTexture).__webglTexture);const tn=F.texture;(tn.isData3DTexture||tn.isDataArrayTexture||tn.isCompressedArrayTexture)&&(yt=!0);const Pt=Ze.get(F).__webglFramebuffer;F.isWebGLCubeRenderTarget?(de=Array.isArray(Pt[te])?Pt[te][he]:Pt[te],et=!0):de=Ae.isWebGL2&&F.samples>0&&!1===Qe.useMultisampledRTT(F)?Ze.get(F).__webglMultisampledFramebuffer:Array.isArray(Pt)?Pt[he]:Pt,R.copy(F.viewport),$.copy(F.scissor),ee=F.scissorTest}else R.copy(le).multiplyScalar(X).floor(),$.copy(q).multiplyScalar(X).floor(),ee=oe;if(Ee.bindFramebuffer(z.FRAMEBUFFER,de)&&Ae.drawBuffers&&ne&&Ee.drawBuffers(F,de),Ee.viewport(R),Ee.scissor($),Ee.setScissorTest(ee),et){const Ft=Ze.get(F.texture);z.framebufferTexture2D(z.FRAMEBUFFER,z.COLOR_ATTACHMENT0,z.TEXTURE_CUBE_MAP_POSITIVE_X+te,Ft.__webglTexture,he)}else if(yt){const Ft=Ze.get(F.texture);z.framebufferTextureLayer(z.FRAMEBUFFER,z.COLOR_ATTACHMENT0,Ft.__webglTexture,he||0,te||0)}O=-1},this.readRenderTargetPixels=function(F,te,he,ne,de,et,yt){if(!F||!F.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Ot=Ze.get(F).__webglFramebuffer;if(F.isWebGLCubeRenderTarget&&void 0!==yt&&(Ot=Ot[yt]),Ot){Ee.bindFramebuffer(z.FRAMEBUFFER,Ot);try{const Ft=F.texture,tn=Ft.format,Pt=Ft.type;if(tn!==Do&&Ct.convert(tn)!==z.getParameter(z.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const Xt=Pt===Yy&&(ye.has("EXT_color_buffer_half_float")||Ae.isWebGL2&&ye.has("EXT_color_buffer_float"));if(!(Pt===fu||Ct.convert(Pt)===z.getParameter(z.IMPLEMENTATION_COLOR_READ_TYPE)||Pt===$l&&(Ae.isWebGL2||ye.has("OES_texture_float")||ye.has("WEBGL_color_buffer_float"))||Xt))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");te>=0&&te<=F.width-ne&&he>=0&&he<=F.height-de&&z.readPixels(te,he,ne,de,Ct.convert(tn),Ct.convert(Pt),et)}finally{const Ft=null!==D?Ze.get(D).__webglFramebuffer:null;Ee.bindFramebuffer(z.FRAMEBUFFER,Ft)}}},this.copyFramebufferToTexture=function(F,te,he=0){const ne=Math.pow(2,-he),de=Math.floor(te.image.width*ne),et=Math.floor(te.image.height*ne);Qe.setTexture2D(te,0),z.copyTexSubImage2D(z.TEXTURE_2D,he,0,0,F.x,F.y,de,et),Ee.unbindTexture()},this.copyTextureToTexture=function(F,te,he,ne=0){const de=te.image.width,et=te.image.height,yt=Ct.convert(he.format),Ot=Ct.convert(he.type);Qe.setTexture2D(he,0),z.pixelStorei(z.UNPACK_FLIP_Y_WEBGL,he.flipY),z.pixelStorei(z.UNPACK_PREMULTIPLY_ALPHA_WEBGL,he.premultiplyAlpha),z.pixelStorei(z.UNPACK_ALIGNMENT,he.unpackAlignment),te.isDataTexture?z.texSubImage2D(z.TEXTURE_2D,ne,F.x,F.y,de,et,yt,Ot,te.image.data):te.isCompressedTexture?z.compressedTexSubImage2D(z.TEXTURE_2D,ne,F.x,F.y,te.mipmaps[0].width,te.mipmaps[0].height,yt,te.mipmaps[0].data):z.texSubImage2D(z.TEXTURE_2D,ne,F.x,F.y,yt,Ot,te.image),0===ne&&he.generateMipmaps&&z.generateMipmap(z.TEXTURE_2D),Ee.unbindTexture()},this.copyTextureToTexture3D=function(F,te,he,ne,de=0){if(E.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const et=F.max.x-F.min.x+1,yt=F.max.y-F.min.y+1,Ot=F.max.z-F.min.z+1,Ft=Ct.convert(ne.format),tn=Ct.convert(ne.type);let Pt;if(ne.isData3DTexture)Qe.setTexture3D(ne,0),Pt=z.TEXTURE_3D;else{if(!ne.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");Qe.setTexture2DArray(ne,0),Pt=z.TEXTURE_2D_ARRAY}z.pixelStorei(z.UNPACK_FLIP_Y_WEBGL,ne.flipY),z.pixelStorei(z.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ne.premultiplyAlpha),z.pixelStorei(z.UNPACK_ALIGNMENT,ne.unpackAlignment);const Xt=z.getParameter(z.UNPACK_ROW_LENGTH),xi=z.getParameter(z.UNPACK_IMAGE_HEIGHT),Fi=z.getParameter(z.UNPACK_SKIP_PIXELS),Oo=z.getParameter(z.UNPACK_SKIP_ROWS),ac=z.getParameter(z.UNPACK_SKIP_IMAGES),Yi=he.isCompressedTexture?he.mipmaps[0]:he.image;z.pixelStorei(z.UNPACK_ROW_LENGTH,Yi.width),z.pixelStorei(z.UNPACK_IMAGE_HEIGHT,Yi.height),z.pixelStorei(z.UNPACK_SKIP_PIXELS,F.min.x),z.pixelStorei(z.UNPACK_SKIP_ROWS,F.min.y),z.pixelStorei(z.UNPACK_SKIP_IMAGES,F.min.z),he.isDataTexture||he.isData3DTexture?z.texSubImage3D(Pt,de,te.x,te.y,te.z,et,yt,Ot,Ft,tn,Yi.data):he.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),z.compressedTexSubImage3D(Pt,de,te.x,te.y,te.z,et,yt,Ot,Ft,Yi.data)):z.texSubImage3D(Pt,de,te.x,te.y,te.z,et,yt,Ot,Ft,tn,Yi),z.pixelStorei(z.UNPACK_ROW_LENGTH,Xt),z.pixelStorei(z.UNPACK_IMAGE_HEIGHT,xi),z.pixelStorei(z.UNPACK_SKIP_PIXELS,Fi),z.pixelStorei(z.UNPACK_SKIP_ROWS,Oo),z.pixelStorei(z.UNPACK_SKIP_IMAGES,ac),0===de&&ne.generateMipmaps&&z.generateMipmap(Pt),Ee.unbindTexture()},this.initTexture=function(F){F.isCubeTexture?Qe.setTextureCube(F,0):F.isData3DTexture?Qe.setTexture3D(F,0):F.isDataArrayTexture||F.isCompressedArrayTexture?Qe.setTexture2DArray(F,0):Qe.setTexture2D(F,0),Ee.unbindTexture()},this.resetState=function(){x=0,A=0,D=null,Ee.reset(),at.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return ql}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=e===UD?"display-p3":"srgb",t.unpackColorSpace=Sn.workingColorSpace===eS?"display-p3":"srgb"}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(e){console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!e}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===di?Wh:3e3}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===Wh?di:Tr}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}(class Rie extends _I{}).prototype.isWebGL1Renderer=!0;class PS extends fi{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t}}class wI{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=no()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=no()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=no()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const ys=new L;class td{constructor(e,t,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)ys.fromBufferAttribute(this,t),ys.applyMatrix4(e),this.setXYZ(t,ys.x,ys.y,ys.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)ys.fromBufferAttribute(this,t),ys.applyNormalMatrix(e),this.setXYZ(t,ys.x,ys.y,ys.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)ys.fromBufferAttribute(this,t),ys.transformDirection(e),this.setXYZ(t,ys.x,ys.y,ys.z);return this}setX(e,t){return this.normalized&&(t=jt(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=jt(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=jt(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=jt(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Ls(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Ls(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Ls(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Ls(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=jt(t,this.array),i=jt(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=jt(t,this.array),i=jt(i,this.array),r=jt(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=jt(t,this.array),i=jt(i,this.array),r=jt(r,this.array),s=jt(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new Kn(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new td(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}const iH=new L,rH=new Nn,sH=new Nn,Lie=new L,oH=new wt,Sm=new L,EI=new da,aH=new wt,SI=new im;class lH extends Me{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new wt,this.bindMatrixInverse=new wt,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;null===this.boundingBox&&(this.boundingBox=new Ya),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)Sm.fromBufferAttribute(t,i),this.applyBoneTransform(i,Sm),this.boundingBox.expandByPoint(Sm)}computeBoundingSphere(){const e=this.geometry;null===this.boundingSphere&&(this.boundingSphere=new da),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)Sm.fromBufferAttribute(t,i),this.applyBoneTransform(i,Sm),this.boundingSphere.expandByPoint(Sm)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const r=this.matrixWorld;void 0!==this.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),EI.copy(this.boundingSphere),EI.applyMatrix4(r),!1!==e.ray.intersectsSphere(EI)&&(aH.copy(r).invert(),SI.copy(e.ray).applyMatrix4(aH),(null===this.boundingBox||!1!==SI.intersectsBox(this.boundingBox))&&this._computeIntersections(e,t,SI)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Nn,t=this.geometry.attributes.skinWeight;for(let i=0,r=t.count;i<r;i++){e.fromBufferAttribute(t,i);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const i=this.skeleton,r=this.geometry;rH.fromBufferAttribute(r.attributes.skinIndex,e),sH.fromBufferAttribute(r.attributes.skinWeight,e),iH.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=sH.getComponent(s);if(0!==o){const a=rH.getComponent(s);oH.multiplyMatrices(i.bones[a].matrixWorld,i.boneInverses[a]),t.addScaledVector(Lie.copy(iH).applyMatrix4(oH),o)}}return t.applyMatrix4(this.bindMatrixInverse)}boneTransform(e,t){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,t)}}class CI extends fi{constructor(){super(),this.isBone=!0,this.type="Bone"}}class cv extends Ro{constructor(e=null,t=1,i=1,r,s,o,a,l,c=Li,h=Li,d,p){super(null,o,a,l,c,h,r,s,d,p),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const cH=new wt,Oie=new wt;class kS{constructor(e=[],t=[]){this.uuid=no(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new wt)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const i=new wt;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,t=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++)cH.multiplyMatrices(e[s]?e[s].matrixWorld:Oie,t[s]),cH.toArray(i,16*s);null!==r&&(r.needsUpdate=!0)}clone(){return new kS(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=QB(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const i=new cv(t,e,e,Do,$l);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const s=e.bones[i];let o=t[s];void 0===o&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new CI),this.bones.push(o),this.boneInverses.push((new wt).fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,i=this.boneInverses;for(let r=0,s=t.length;r<s;r++)e.bones.push(t[r].uuid),e.boneInverses.push(i[r].toArray());return e}}class uv extends Kn{constructor(e,t,i,r=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Cm=new wt,uH=new wt,US=[],hH=new Ya,Fie=new wt,hv=new Me,dv=new da;class dH extends Me{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new uv(new Float32Array(16*i),16),this.instanceColor=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<i;r++)this.setMatrixAt(r,Fie)}computeBoundingBox(){const e=this.geometry,t=this.count;null===this.boundingBox&&(this.boundingBox=new Ya),null===e.boundingBox&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,Cm),hH.copy(e.boundingBox).applyMatrix4(Cm),this.boundingBox.union(hH)}computeBoundingSphere(){const e=this.geometry,t=this.count;null===this.boundingSphere&&(this.boundingSphere=new da),null===e.boundingSphere&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,Cm),dv.copy(e.boundingSphere).applyMatrix4(Cm),this.boundingSphere.union(dv)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const i=this.matrixWorld,r=this.count;if(hv.geometry=this.geometry,hv.material=this.material,void 0!==hv.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),dv.copy(this.boundingSphere),dv.applyMatrix4(i),!1!==e.ray.intersectsSphere(dv)))for(let s=0;s<r;s++){this.getMatrixAt(s,Cm),uH.multiplyMatrices(i,Cm),hv.matrixWorld=uH,hv.raycast(e,US);for(let o=0,a=US.length;o<a;o++){const l=US[o];l.instanceId=s,l.object=this,t.push(l)}US.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new uv(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class gr extends gs{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new We(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const fH=new L,pH=new L,mH=new wt,xI=new im,BS=new da;class $r extends fi{constructor(e=new Rt,t=new gr){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,i=[0];for(let r=1,s=t.count;r<s;r++)fH.fromBufferAttribute(t,r-1),pH.fromBufferAttribute(t,r),i[r]=i[r-1],i[r]+=fH.distanceTo(pH);e.setAttribute("lineDistance",new Ke(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),BS.copy(i.boundingSphere),BS.applyMatrix4(r),BS.radius+=s,!1===e.ray.intersectsSphere(BS))return;mH.copy(r).invert(),xI.copy(e.ray).applyMatrix4(mH);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=new L,h=new L,d=new L,p=new L,m=this.isLineSegments?2:1,g=i.index,w=i.attributes.position;if(null!==g)for(let E=Math.max(0,o.start),C=Math.min(g.count,o.start+o.count)-1;E<C;E+=m){const x=g.getX(E),A=g.getX(E+1);if(c.fromBufferAttribute(w,x),h.fromBufferAttribute(w,A),xI.distanceSqToSegment(c,h,p,d)>l)continue;p.applyMatrix4(this.matrixWorld);const O=e.ray.origin.distanceTo(p);O<e.near||O>e.far||t.push({distance:O,point:d.clone().applyMatrix4(this.matrixWorld),index:E,face:null,faceIndex:null,object:this})}else for(let E=Math.max(0,o.start),C=Math.min(w.count,o.start+o.count)-1;E<C;E+=m){if(c.fromBufferAttribute(w,E),h.fromBufferAttribute(w,E+1),xI.distanceSqToSegment(c,h,p,d)>l)continue;p.applyMatrix4(this.matrixWorld);const A=e.ray.origin.distanceTo(p);A<e.near||A>e.far||t.push({distance:A,point:d.clone().applyMatrix4(this.matrixWorld),index:E,face:null,faceIndex:null,object:this})}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}const gH=new L,_H=new L;class xm extends $r{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,i=[];for(let r=0,s=t.count;r<s;r+=2)gH.fromBufferAttribute(t,r),_H.fromBufferAttribute(t,r+1),i[r]=0===r?0:i[r-1],i[r+1]=i[r]+gH.distanceTo(_H);e.setAttribute("lineDistance",new Ke(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class yH extends $r{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class nd extends gs{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new We(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const vH=new wt,MI=new im,VS=new da,HS=new L;class fv extends fi{constructor(e=new Rt,t=new nd){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),VS.copy(i.boundingSphere),VS.applyMatrix4(r),VS.radius+=s,!1===e.ray.intersectsSphere(VS))return;vH.copy(r).invert(),MI.copy(e.ray).applyMatrix4(vH);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=i.index,d=i.attributes.position;if(null!==c)for(let g=Math.max(0,o.start),v=Math.min(c.count,o.start+o.count);g<v;g++){const w=c.getX(g);HS.fromBufferAttribute(d,w),wH(HS,w,l,r,e,t,this)}else for(let g=Math.max(0,o.start),v=Math.min(d.count,o.start+o.count);g<v;g++)HS.fromBufferAttribute(d,g),wH(HS,g,l,r,e,t,this)}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function wH(n,e,t,i,r,s,o){const a=MI.distanceSqToPoint(n);if(a<t){const l=new L;MI.closestPointToPoint(n,l),l.applyMatrix4(i);const c=r.ray.origin.distanceTo(l);if(c<r.near||c>r.far)return;s.push({distance:c,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,object:o})}}class Uie extends Ro{constructor(e,t,i,r,s,o,a,l,c){super(e,t,i,r,s,o,a,l,c),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Ja{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const i=this.getUtoTmapping(e);return this.getPoint(i,t)}getPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return t}getSpacedPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let i,r=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)i=this.getPoint(o/e),s+=i.distanceTo(r),t.push(s),r=i;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const i=this.getLengths();let r=0;const s=i.length;let o;o=t||e*i[s-1];let c,a=0,l=s-1;for(;a<=l;)if(r=Math.floor(a+(l-a)/2),c=i[r]-o,c<0)a=r+1;else{if(!(c>0)){l=r;break}l=r-1}if(r=l,i[r]===o)return r/(s-1);const h=i[r];return(r+(o-h)/(i[r+1]-h))/(s-1)}getTangent(e,t){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const o=this.getPoint(r),a=this.getPoint(s),l=t||(o.isVector2?new fe:new L);return l.copy(a).sub(o).normalize(),l}getTangentAt(e,t){const i=this.getUtoTmapping(e);return this.getTangent(i,t)}computeFrenetFrames(e,t){const i=new L,r=[],s=[],o=[],a=new L,l=new wt;for(let m=0;m<=e;m++)r[m]=this.getTangentAt(m/e,new L);s[0]=new L,o[0]=new L;let c=Number.MAX_VALUE;const h=Math.abs(r[0].x),d=Math.abs(r[0].y),p=Math.abs(r[0].z);h<=c&&(c=h,i.set(1,0,0)),d<=c&&(c=d,i.set(0,1,0)),p<=c&&i.set(0,0,1),a.crossVectors(r[0],i).normalize(),s[0].crossVectors(r[0],a),o[0].crossVectors(r[0],s[0]);for(let m=1;m<=e;m++){if(s[m]=s[m-1].clone(),o[m]=o[m-1].clone(),a.crossVectors(r[m-1],r[m]),a.length()>Number.EPSILON){a.normalize();const g=Math.acos(wi(r[m-1].dot(r[m]),-1,1));s[m].applyMatrix4(l.makeRotationAxis(a,g))}o[m].crossVectors(r[m],s[m])}if(!0===t){let m=Math.acos(wi(s[0].dot(s[e]),-1,1));m/=e,r[0].dot(a.crossVectors(s[0],s[e]))>0&&(m=-m);for(let g=1;g<=e;g++)s[g].applyMatrix4(l.makeRotationAxis(r[g],m*g)),o[g].crossVectors(r[g],s[g])}return{tangents:r,normals:s,binormals:o}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class TI extends Ja{constructor(e=0,t=0,i=1,r=1,s=0,o=2*Math.PI,a=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(e,t){const i=t||new fe,r=2*Math.PI;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(s=o?0:r),!0===this.aClockwise&&!o&&(s===r?s=-r:s-=r);const a=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(a),c=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){const h=Math.cos(this.aRotation),d=Math.sin(this.aRotation),p=l-this.aX,m=c-this.aY;l=p*h-m*d+this.aX,c=p*d+m*h+this.aY}return i.set(l,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}function AI(){let n=0,e=0,t=0,i=0;function r(s,o,a,l){n=s,e=a,t=-3*s+3*o-2*a-l,i=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,c){r(o,a,c*(a-s),c*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,c,h,d){let p=(o-s)/c-(a-s)/(c+h)+(a-o)/h,m=(a-o)/h-(l-o)/(h+d)+(l-a)/d;p*=h,m*=h,r(o,a,p,m)},calc:function(s){const o=s*s;return n+e*s+t*o+i*(o*s)}}}const zS=new L,DI=new AI,II=new AI,RI=new AI;function bH(n,e,t,i,r){const s=.5*(i-e),o=.5*(r-t),a=n*n;return(2*t-2*i+s+o)*(n*a)+(-3*t+3*i-2*s-o)*a+s*n+t}function pv(n,e,t,i){return function Hie(n,e){const t=1-n;return t*t*e}(n,e)+function zie(n,e){return 2*(1-n)*n*e}(n,t)+function Gie(n,e){return n*n*e}(n,i)}function mv(n,e,t,i,r){return function Wie(n,e){const t=1-n;return t*t*t*e}(n,e)+function jie(n,e){const t=1-n;return 3*t*t*n*e}(n,t)+function $ie(n,e){return 3*(1-n)*n*n*e}(n,i)+function qie(n,e){return n*n*n*e}(n,r)}class EH extends Ja{constructor(e=new fe,t=new fe,i=new fe,r=new fe){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new fe){const i=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(mv(e,r.x,s.x,o.x,a.x),mv(e,r.y,s.y,o.y,a.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class SH extends Ja{constructor(e=new fe,t=new fe){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new fe){const i=t;return 1===e?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new fe){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class CH extends Ja{constructor(e=new fe,t=new fe,i=new fe){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new fe){const i=t,r=this.v0,s=this.v1,o=this.v2;return i.set(pv(e,r.x,s.x,o.x),pv(e,r.y,s.y,o.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class MH extends Ja{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new fe){const i=t,r=this.points,s=(r.length-1)*e,o=Math.floor(s),a=s-o,l=r[0===o?o:o-1],c=r[o],h=r[o>r.length-2?r.length-1:o+1],d=r[o>r.length-3?r.length-1:o+2];return i.set(bH(a,l.x,c.x,h.x,d.x),bH(a,l.y,c.y,h.y,d.y)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++)this.points.push(e.points[t].clone());return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++)e.points.push(this.points[t].toArray());return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push((new fe).fromArray(r))}return this}}var GS=Object.freeze({__proto__:null,ArcCurve:class Bie extends TI{constructor(e,t,i,r,s,o){super(e,t,i,i,r,s,o),this.isArcCurve=!0,this.type="ArcCurve"}},CatmullRomCurve3:class Vie extends Ja{constructor(e=[],t=!1,i="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=i,this.tension=r}getPoint(e,t=new L){const i=t,r=this.points,s=r.length,o=(s-(this.closed?0:1))*e;let c,h,a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:0===l&&a===s-1&&(a=s-2,l=1),this.closed||a>0?c=r[(a-1)%s]:(zS.subVectors(r[0],r[1]).add(r[0]),c=zS);const d=r[a%s],p=r[(a+1)%s];if(this.closed||a+2<s?h=r[(a+2)%s]:(zS.subVectors(r[s-1],r[s-2]).add(r[s-1]),h=zS),"centripetal"===this.curveType||"chordal"===this.curveType){const m="chordal"===this.curveType?.5:.25;let g=Math.pow(c.distanceToSquared(d),m),v=Math.pow(d.distanceToSquared(p),m),w=Math.pow(p.distanceToSquared(h),m);v<1e-4&&(v=1),g<1e-4&&(g=v),w<1e-4&&(w=v),DI.initNonuniformCatmullRom(c.x,d.x,p.x,h.x,g,v,w),II.initNonuniformCatmullRom(c.y,d.y,p.y,h.y,g,v,w),RI.initNonuniformCatmullRom(c.z,d.z,p.z,h.z,g,v,w)}else"catmullrom"===this.curveType&&(DI.initCatmullRom(c.x,d.x,p.x,h.x,this.tension),II.initCatmullRom(c.y,d.y,p.y,h.y,this.tension),RI.initCatmullRom(c.z,d.z,p.z,h.z,this.tension));return i.set(DI.calc(l),II.calc(l),RI.calc(l)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++)this.points.push(e.points[t].clone());return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++)e.points.push(this.points[t].toArray());return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push((new L).fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}},CubicBezierCurve:EH,CubicBezierCurve3:class Xie extends Ja{constructor(e=new L,t=new L,i=new L,r=new L){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new L){const i=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(mv(e,r.x,s.x,o.x,a.x),mv(e,r.y,s.y,o.y,a.y),mv(e,r.z,s.z,o.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},EllipseCurve:TI,LineCurve:SH,LineCurve3:class Yie extends Ja{constructor(e=new L,t=new L){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new L){const i=t;return 1===e?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new L){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},QuadraticBezierCurve:CH,QuadraticBezierCurve3:class xH extends Ja{constructor(e=new L,t=new L,i=new L){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new L){const i=t,r=this.v0,s=this.v1,o=this.v2;return i.set(pv(e,r.x,s.x,o.x),pv(e,r.y,s.y,o.y),pv(e,r.z,s.z,o.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},SplineCurve:MH});class Kie extends Ja{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);return e.equals(t)||this.curves.push(new GS[!0===e.isVector2?"LineCurve":"LineCurve3"](t,e)),this}getPoint(e,t){const i=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=i){const o=r[s]-i,a=this.curves[s],l=a.getLength();return a.getPointAt(0===l?0:1-o/l,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let i=0,r=this.curves.length;i<r;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let i;for(let r=0,s=this.curves;r<s.length;r++){const o=s[r],l=o.getPoints(o.isEllipseCurve?2*e:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e);for(let c=0;c<l.length;c++){const h=l[c];i&&i.equals(h)||(t.push(h),i=h)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,i=e.curves.length;t<i;t++)this.curves.push(e.curves[t].clone());return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,i=this.curves.length;t<i;t++)e.curves.push(this.curves[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const r=e.curves[t];this.curves.push((new GS[r.type]).fromJSON(r))}return this}}class WS extends Kie{constructor(e){super(),this.type="Path",this.currentPoint=new fe,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const i=new SH(this.currentPoint.clone(),new fe(e,t));return this.curves.push(i),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,i,r){const s=new CH(this.currentPoint.clone(),new fe(e,t),new fe(i,r));return this.curves.push(s),this.currentPoint.set(i,r),this}bezierCurveTo(e,t,i,r,s,o){const a=new EH(this.currentPoint.clone(),new fe(e,t),new fe(i,r),new fe(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),i=new MH(t);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,i,r,s,o){return this.absarc(e+this.currentPoint.x,t+this.currentPoint.y,i,r,s,o),this}absarc(e,t,i,r,s,o){return this.absellipse(e,t,i,i,r,s,o),this}ellipse(e,t,i,r,s,o,a,l){return this.absellipse(e+this.currentPoint.x,t+this.currentPoint.y,i,r,s,o,a,l),this}absellipse(e,t,i,r,s,o,a,l){const c=new TI(e,t,i,r,s,o,a,l);if(this.curves.length>0){const d=c.getPoint(0);d.equals(this.currentPoint)||this.lineTo(d.x,d.y)}this.curves.push(c);const h=c.getPoint(1);return this.currentPoint.copy(h),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class or extends Rt{constructor(e=1,t=1,i=1,r=32,s=1,o=!1,a=0,l=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l};const c=this;r=Math.floor(r),s=Math.floor(s);const h=[],d=[],p=[],m=[];let g=0;const v=[],w=i/2;let y=0;function E(C){const x=g,A=new fe,D=new L;let O=0;const T=!0===C?e:t,R=!0===C?1:-1;for(let ee=1;ee<=r;ee++)d.push(0,w*R,0),p.push(0,R,0),m.push(.5,.5),g++;const $=g;for(let ee=0;ee<=r;ee++){const V=ee/r*l+a,J=Math.cos(V),G=Math.sin(V);D.x=T*G,D.y=w*R,D.z=T*J,d.push(D.x,D.y,D.z),p.push(0,R,0),A.x=.5*J+.5,A.y=.5*G*R+.5,m.push(A.x,A.y),g++}for(let ee=0;ee<r;ee++){const se=x+ee,V=$+ee;!0===C?h.push(V,V+1,se):h.push(V+1,V,se),O+=3}c.addGroup(y,O,!0===C?1:2),y+=O}(function b(){const C=new L,x=new L;let A=0;const D=(t-e)/i;for(let O=0;O<=s;O++){const T=[],R=O/s,$=R*(t-e)+e;for(let ee=0;ee<=r;ee++){const se=ee/r,V=se*l+a,J=Math.sin(V),G=Math.cos(V);x.x=$*J,x.y=-R*i+w,x.z=$*G,d.push(x.x,x.y,x.z),C.set(J,D,G).normalize(),p.push(C.x,C.y,C.z),m.push(se,1-R),T.push(g++)}v.push(T)}for(let O=0;O<r;O++)for(let T=0;T<s;T++){const $=v[T+1][O],ee=v[T+1][O+1],se=v[T][O+1];h.push(v[T][O],$,se),h.push($,ee,se),A+=6}c.addGroup(y,A,0),y+=A})(),!1===o&&(e>0&&E(!0),t>0&&E(!1)),this.setIndex(h),this.setAttribute("position",new Ke(d,3)),this.setAttribute("normal",new Ke(p,3)),this.setAttribute("uv",new Ke(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new or(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class id extends Rt{constructor(e=[],t=[],i=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:r};const s=[],o=[];function l(b,E,C,x){const A=x+1,D=[];for(let O=0;O<=A;O++){D[O]=[];const T=b.clone().lerp(C,O/A),R=E.clone().lerp(C,O/A),$=A-O;for(let ee=0;ee<=$;ee++)D[O][ee]=0===ee&&O===A?T:T.clone().lerp(R,ee/$)}for(let O=0;O<A;O++)for(let T=0;T<2*(A-O)-1;T++){const R=Math.floor(T/2);T%2==0?(p(D[O][R+1]),p(D[O+1][R]),p(D[O][R])):(p(D[O][R+1]),p(D[O+1][R+1]),p(D[O+1][R]))}}function p(b){s.push(b.x,b.y,b.z)}function m(b,E){const C=3*b;E.x=e[C+0],E.y=e[C+1],E.z=e[C+2]}function v(b,E,C,x){x<0&&1===b.x&&(o[E]=b.x-1),0===C.x&&0===C.z&&(o[E]=x/2/Math.PI+.5)}function w(b){return Math.atan2(b.z,-b.x)}function y(b){return Math.atan2(-b.y,Math.sqrt(b.x*b.x+b.z*b.z))}(function a(b){const E=new L,C=new L,x=new L;for(let A=0;A<t.length;A+=3)m(t[A+0],E),m(t[A+1],C),m(t[A+2],x),l(E,C,x,b)})(r),function c(b){const E=new L;for(let C=0;C<s.length;C+=3)E.x=s[C+0],E.y=s[C+1],E.z=s[C+2],E.normalize().multiplyScalar(b),s[C+0]=E.x,s[C+1]=E.y,s[C+2]=E.z}(i),function h(){const b=new L;for(let E=0;E<s.length;E+=3){b.x=s[E+0],b.y=s[E+1],b.z=s[E+2];const C=w(b)/2/Math.PI+.5,x=y(b)/Math.PI+.5;o.push(C,1-x)}(function g(){const b=new L,E=new L,C=new L,x=new L,A=new fe,D=new fe,O=new fe;for(let T=0,R=0;T<s.length;T+=9,R+=6){b.set(s[T+0],s[T+1],s[T+2]),E.set(s[T+3],s[T+4],s[T+5]),C.set(s[T+6],s[T+7],s[T+8]),A.set(o[R+0],o[R+1]),D.set(o[R+2],o[R+3]),O.set(o[R+4],o[R+5]),x.copy(b).add(E).add(C).divideScalar(3);const $=w(x);v(A,R+0,b,$),v(D,R+2,E,$),v(O,R+4,C,$)}})(),function d(){for(let b=0;b<o.length;b+=6){const E=o[b+0],C=o[b+2],x=o[b+4],A=Math.max(E,C,x),D=Math.min(E,C,x);A>.9&&D<.1&&(E<.2&&(o[b+0]+=1),C<.2&&(o[b+2]+=1),x<.2&&(o[b+4]+=1))}}()}(),this.setAttribute("position",new Ke(s,3)),this.setAttribute("normal",new Ke(s.slice(),3)),this.setAttribute("uv",new Ke(o,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new id(e.vertices,e.indices,e.radius,e.details)}}class Mm extends WS{constructor(e){super(e),this.uuid=no(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let i=0,r=this.holes.length;i<r;i++)t[i]=this.holes[i].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,i=e.holes.length;t<i;t++)this.holes.push(e.holes[t].clone());return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,i=this.holes.length;t<i;t++)e.holes.push(this.holes[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const r=e.holes[t];this.holes.push((new WS).fromJSON(r))}return this}}function TH(n,e,t,i,r){let s,o;if(r===function pre(n,e,t,i){let r=0;for(let s=e,o=t-i;s<t;s+=i)r+=(n[o]-n[s])*(n[s+1]+n[o+1]),o=s;return r}(n,e,t,i)>0)for(s=e;s<t;s+=i)o=IH(s,n[s],n[s+1],o);else for(s=t-i;s>=e;s-=i)o=IH(s,n[s],n[s+1],o);return o&&YS(o,o.next)&&(yv(o),o=o.next),o}function rd(n,e){if(!n)return n;e||(e=n);let i,t=n;do{if(i=!1,t.steiner||!YS(t,t.next)&&0!==pi(t.prev,t,t.next))t=t.next;else{if(yv(t),t=e=t.prev,t===t.next)break;i=!0}}while(i||t!==e);return e}function gv(n,e,t,i,r,s,o){if(!n)return;!o&&s&&function lre(n,e,t,i){let r=n;do{0===r.z&&(r.z=kI(r.x,r.y,e,t,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==n);r.prevZ.nextZ=null,r.prevZ=null,function cre(n){let e,t,i,r,s,o,a,l,c=1;do{for(t=n,n=null,s=null,o=0;t;){for(o++,i=t,a=0,e=0;e<c&&(a++,i=i.nextZ,i);e++);for(l=c;a>0||l>0&&i;)0!==a&&(0===l||!i||t.z<=i.z)?(r=t,t=t.nextZ,a--):(r=i,i=i.nextZ,l--),s?s.nextZ=r:n=r,r.prevZ=s,s=r;t=i}s.nextZ=null,c*=2}while(o>1)}(r)}(n,i,r,s);let l,c,a=n;for(;n.prev!==n.next;)if(l=n.prev,c=n.next,s?ere(n,i,r,s):Qie(n))e.push(l.i/t|0),e.push(n.i/t|0),e.push(c.i/t|0),yv(n),n=c.next,a=c.next;else if((n=c)===a){o?1===o?gv(n=tre(rd(n),e,t),e,t,i,r,s,2):2===o&&nre(n,e,t,i,r,s):gv(rd(n),e,t,i,r,s,1);break}}function Qie(n){const e=n.prev,t=n,i=n.next;if(pi(e,t,i)>=0)return!1;const r=e.x,s=t.x,o=i.x,a=e.y,l=t.y,c=i.y,h=r<s?r<o?r:o:s<o?s:o,d=a<l?a<c?a:c:l<c?l:c,p=r>s?r>o?r:o:s>o?s:o,m=a>l?a>c?a:c:l>c?l:c;let g=i.next;for(;g!==e;){if(g.x>=h&&g.x<=p&&g.y>=d&&g.y<=m&&Tm(r,a,s,l,o,c,g.x,g.y)&&pi(g.prev,g,g.next)>=0)return!1;g=g.next}return!0}function ere(n,e,t,i){const r=n.prev,s=n,o=n.next;if(pi(r,s,o)>=0)return!1;const a=r.x,l=s.x,c=o.x,h=r.y,d=s.y,p=o.y,m=a<l?a<c?a:c:l<c?l:c,g=h<d?h<p?h:p:d<p?d:p,v=a>l?a>c?a:c:l>c?l:c,w=h>d?h>p?h:p:d>p?d:p,y=kI(m,g,e,t,i),b=kI(v,w,e,t,i);let E=n.prevZ,C=n.nextZ;for(;E&&E.z>=y&&C&&C.z<=b;){if(E.x>=m&&E.x<=v&&E.y>=g&&E.y<=w&&E!==r&&E!==o&&Tm(a,h,l,d,c,p,E.x,E.y)&&pi(E.prev,E,E.next)>=0||(E=E.prevZ,C.x>=m&&C.x<=v&&C.y>=g&&C.y<=w&&C!==r&&C!==o&&Tm(a,h,l,d,c,p,C.x,C.y)&&pi(C.prev,C,C.next)>=0))return!1;C=C.nextZ}for(;E&&E.z>=y;){if(E.x>=m&&E.x<=v&&E.y>=g&&E.y<=w&&E!==r&&E!==o&&Tm(a,h,l,d,c,p,E.x,E.y)&&pi(E.prev,E,E.next)>=0)return!1;E=E.prevZ}for(;C&&C.z<=b;){if(C.x>=m&&C.x<=v&&C.y>=g&&C.y<=w&&C!==r&&C!==o&&Tm(a,h,l,d,c,p,C.x,C.y)&&pi(C.prev,C,C.next)>=0)return!1;C=C.nextZ}return!0}function tre(n,e,t){let i=n;do{const r=i.prev,s=i.next.next;!YS(r,s)&&AH(r,i,i.next,s)&&_v(r,s)&&_v(s,r)&&(e.push(r.i/t|0),e.push(i.i/t|0),e.push(s.i/t|0),yv(i),yv(i.next),i=n=s),i=i.next}while(i!==n);return rd(i)}function nre(n,e,t,i,r,s){let o=n;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&hre(o,a)){let l=DH(o,a);return o=rd(o,o.next),l=rd(l,l.next),gv(o,e,t,i,r,s,0),void gv(l,e,t,i,r,s,0)}a=a.next}o=o.next}while(o!==n)}function rre(n,e){return n.x-e.x}function sre(n,e){const t=function ore(n,e){let r,t=e,i=-1/0;const s=n.x,o=n.y;do{if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){const p=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(p<=s&&p>i&&(i=p,r=t.x<t.next.x?t:t.next,p===s))return r}t=t.next}while(t!==e);if(!r)return null;const a=r,l=r.x,c=r.y;let d,h=1/0;t=r;do{s>=t.x&&t.x>=l&&s!==t.x&&Tm(o<c?s:i,o,l,c,o<c?i:s,o,t.x,t.y)&&(d=Math.abs(o-t.y)/(s-t.x),_v(t,n)&&(d<h||d===h&&(t.x>r.x||t.x===r.x&&are(r,t)))&&(r=t,h=d)),t=t.next}while(t!==a);return r}(n,e);if(!t)return e;const i=DH(t,n);return rd(i,i.next),rd(t,t.next)}function are(n,e){return pi(n.prev,n,e.prev)<0&&pi(e.next,n,n.next)<0}function kI(n,e,t,i,r){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-t)*r|0)|n<<8))|n<<4))|n<<2))|n<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-i)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function ure(n){let e=n,t=n;do{(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next}while(e!==n);return t}function Tm(n,e,t,i,r,s,o,a){return(r-o)*(e-a)>=(n-o)*(s-a)&&(n-o)*(i-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(r-o)*(i-a)}function hre(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!function dre(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&AH(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}(n,e)&&(_v(n,e)&&_v(e,n)&&function fre(n,e){let t=n,i=!1;const r=(n.x+e.x)/2,s=(n.y+e.y)/2;do{t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next}while(t!==n);return i}(n,e)&&(pi(n.prev,n,e.prev)||pi(n,e.prev,e))||YS(n,e)&&pi(n.prev,n,n.next)>0&&pi(e.prev,e,e.next)>0)}function pi(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function YS(n,e){return n.x===e.x&&n.y===e.y}function AH(n,e,t,i){const r=ZS(pi(n,e,t)),s=ZS(pi(n,e,i)),o=ZS(pi(t,i,n)),a=ZS(pi(t,i,e));return!!(r!==s&&o!==a||0===r&&KS(n,t,e)||0===s&&KS(n,i,e)||0===o&&KS(t,n,i)||0===a&&KS(t,e,i))}function KS(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function ZS(n){return n>0?1:n<0?-1:0}function _v(n,e){return pi(n.prev,n,n.next)<0?pi(n,e,n.next)>=0&&pi(n,n.prev,e)>=0:pi(n,e,n.prev)<0||pi(n,n.next,e)<0}function DH(n,e){const t=new UI(n.i,n.x,n.y),i=new UI(e.i,e.x,e.y),r=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=r,r.prev=t,i.next=t,t.prev=i,s.next=i,i.prev=s,i}function IH(n,e,t,i){const r=new UI(n,e,t);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function yv(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function UI(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}class ic{static area(e){const t=e.length;let i=0;for(let r=t-1,s=0;s<t;r=s++)i+=e[r].x*e[s].y-e[s].x*e[r].y;return.5*i}static isClockWise(e){return ic.area(e)<0}static triangulateShape(e,t){const i=[],r=[],s=[];RH(e),PH(i,e);let o=e.length;t.forEach(RH);for(let l=0;l<t.length;l++)r.push(o),o+=t[l].length,PH(i,t[l]);const a=function(n,e,t=2){const i=e&&e.length,r=i?e[0]*t:n.length;let s=TH(n,0,r,t,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,c,h,d,p,m;if(i&&(s=function ire(n,e,t,i){const r=[];let s,o,a,l,c;for(s=0,o=e.length;s<o;s++)a=e[s]*i,l=s<o-1?e[s+1]*i:n.length,c=TH(n,a,l,i,!1),c===c.next&&(c.steiner=!0),r.push(ure(c));for(r.sort(rre),s=0;s<r.length;s++)t=sre(r[s],t);return t}(n,e,s,t)),n.length>80*t){a=c=n[0],l=h=n[1];for(let g=t;g<r;g+=t)d=n[g],p=n[g+1],d<a&&(a=d),p<l&&(l=p),d>c&&(c=d),p>h&&(h=p);m=Math.max(c-a,h-l),m=0!==m?32767/m:0}return gv(s,o,t,a,l,m,0),o}(i,r);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}}function RH(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function PH(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class JS extends Rt{constructor(e=new Mm([new fe(.5,.5),new fe(-.5,.5),new fe(-.5,-.5),new fe(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const i=this,r=[],s=[];for(let a=0,l=e.length;a<l;a++)o(e[a]);function o(a){const l=[],c=void 0!==t.curveSegments?t.curveSegments:12,h=void 0!==t.steps?t.steps:1,d=void 0!==t.depth?t.depth:1;let p=void 0===t.bevelEnabled||t.bevelEnabled,m=void 0!==t.bevelThickness?t.bevelThickness:.2,g=void 0!==t.bevelSize?t.bevelSize:m-.1,v=void 0!==t.bevelOffset?t.bevelOffset:0,w=void 0!==t.bevelSegments?t.bevelSegments:3;const y=t.extrudePath,b=void 0!==t.UVGenerator?t.UVGenerator:mre;let E,x,A,D,O,C=!1;y&&(E=y.getSpacedPoints(h),C=!0,p=!1,x=y.computeFrenetFrames(h,!1),A=new L,D=new L,O=new L),p||(w=0,m=0,g=0,v=0);const T=a.extractPoints(c);let R=T.shape;const $=T.holes;if(!ic.isClockWise(R)){R=R.reverse();for(let z=0,Le=$.length;z<Le;z++){const ye=$[z];ic.isClockWise(ye)&&($[z]=ye.reverse())}}const se=ic.triangulateShape(R,$),V=R;for(let z=0,Le=$.length;z<Le;z++)R=R.concat($[z]);function J(z,Le,ye){return Le||console.error("THREE.ExtrudeGeometry: vec does not exist"),z.clone().addScaledVector(Le,ye)}const G=R.length,X=se.length;function Q(z,Le,ye){let Ae,Ee,ot;const Ze=z.x-Le.x,Qe=z.y-Le.y,bt=ye.x-z.x,en=ye.y-z.y,li=Ze*Ze+Qe*Qe;if(Math.abs(Ze*en-Qe*bt)>Number.EPSILON){const P=Math.sqrt(li),ie=Math.sqrt(bt*bt+en*en),Te=Le.x-Qe/P,xe=Le.y+Ze/P,Ie=((ye.x-en/ie-Te)*en-(ye.y+bt/ie-xe)*bt)/(Ze*en-Qe*bt);Ae=Te+Ze*Ie-z.x,Ee=xe+Qe*Ie-z.y;const qe=Ae*Ae+Ee*Ee;if(qe<=2)return new fe(Ae,Ee);ot=Math.sqrt(qe/2)}else{let P=!1;Ze>Number.EPSILON?bt>Number.EPSILON&&(P=!0):Ze<-Number.EPSILON?bt<-Number.EPSILON&&(P=!0):Math.sign(Qe)===Math.sign(en)&&(P=!0),P?(Ae=-Qe,Ee=Ze,ot=Math.sqrt(li)):(Ae=Ze,Ee=Qe,ot=Math.sqrt(li/2))}return new fe(Ae/ot,Ee/ot)}const Z=[];for(let z=0,Le=V.length,ye=Le-1,Ae=z+1;z<Le;z++,ye++,Ae++)ye===Le&&(ye=0),Ae===Le&&(Ae=0),Z[z]=Q(V[z],V[ye],V[Ae]);const le=[];let q,oe=Z.concat();for(let z=0,Le=$.length;z<Le;z++){const ye=$[z];q=[];for(let Ae=0,Ee=ye.length,ot=Ee-1,Ze=Ae+1;Ae<Ee;Ae++,ot++,Ze++)ot===Ee&&(ot=0),Ze===Ee&&(Ze=0),q[Ae]=Q(ye[Ae],ye[ot],ye[Ze]);le.push(q),oe=oe.concat(q)}for(let z=0;z<w;z++){const Le=z/w,ye=m*Math.cos(Le*Math.PI/2),Ae=g*Math.sin(Le*Math.PI/2)+v;for(let Ee=0,ot=V.length;Ee<ot;Ee++){const Ze=J(V[Ee],Z[Ee],Ae);Be(Ze.x,Ze.y,-ye)}for(let Ee=0,ot=$.length;Ee<ot;Ee++){const Ze=$[Ee];q=le[Ee];for(let Qe=0,bt=Ze.length;Qe<bt;Qe++){const en=J(Ze[Qe],q[Qe],Ae);Be(en.x,en.y,-ye)}}}const Se=g+v;for(let z=0;z<G;z++){const Le=p?J(R[z],oe[z],Se):R[z];C?(D.copy(x.normals[0]).multiplyScalar(Le.x),A.copy(x.binormals[0]).multiplyScalar(Le.y),O.copy(E[0]).add(D).add(A),Be(O.x,O.y,O.z)):Be(Le.x,Le.y,0)}for(let z=1;z<=h;z++)for(let Le=0;Le<G;Le++){const ye=p?J(R[Le],oe[Le],Se):R[Le];C?(D.copy(x.normals[z]).multiplyScalar(ye.x),A.copy(x.binormals[z]).multiplyScalar(ye.y),O.copy(E[z]).add(D).add(A),Be(O.x,O.y,O.z)):Be(ye.x,ye.y,d/h*z)}for(let z=w-1;z>=0;z--){const Le=z/w,ye=m*Math.cos(Le*Math.PI/2),Ae=g*Math.sin(Le*Math.PI/2)+v;for(let Ee=0,ot=V.length;Ee<ot;Ee++){const Ze=J(V[Ee],Z[Ee],Ae);Be(Ze.x,Ze.y,d+ye)}for(let Ee=0,ot=$.length;Ee<ot;Ee++){const Ze=$[Ee];q=le[Ee];for(let Qe=0,bt=Ze.length;Qe<bt;Qe++){const en=J(Ze[Qe],q[Qe],Ae);C?Be(en.x,en.y+E[h-1].y,E[h-1].x+ye):Be(en.x,en.y,d+ye)}}}function $e(z,Le){let ye=z.length;for(;--ye>=0;){const Ae=ye;let Ee=ye-1;Ee<0&&(Ee=z.length-1);for(let ot=0,Ze=h+2*w;ot<Ze;ot++){const Qe=G*ot,bt=G*(ot+1);dt(Le+Ae+Qe,Le+Ee+Qe,Le+Ee+bt,Le+Ae+bt)}}}function Be(z,Le,ye){l.push(z),l.push(Le),l.push(ye)}function Xe(z,Le,ye){St(z),St(Le),St(ye);const Ae=r.length/3,Ee=b.generateTopUV(i,r,Ae-3,Ae-2,Ae-1);nt(Ee[0]),nt(Ee[1]),nt(Ee[2])}function dt(z,Le,ye,Ae){St(z),St(Le),St(Ae),St(Le),St(ye),St(Ae);const Ee=r.length/3,ot=b.generateSideWallUV(i,r,Ee-6,Ee-3,Ee-2,Ee-1);nt(ot[0]),nt(ot[1]),nt(ot[3]),nt(ot[1]),nt(ot[2]),nt(ot[3])}function St(z){r.push(l[3*z+0]),r.push(l[3*z+1]),r.push(l[3*z+2])}function nt(z){s.push(z.x),s.push(z.y)}(function ve(){const z=r.length/3;if(p){let Le=0,ye=G*Le;for(let Ae=0;Ae<X;Ae++){const Ee=se[Ae];Xe(Ee[2]+ye,Ee[1]+ye,Ee[0]+ye)}Le=h+2*w,ye=G*Le;for(let Ae=0;Ae<X;Ae++){const Ee=se[Ae];Xe(Ee[0]+ye,Ee[1]+ye,Ee[2]+ye)}}else{for(let Le=0;Le<X;Le++){const ye=se[Le];Xe(ye[2],ye[1],ye[0])}for(let Le=0;Le<X;Le++){const ye=se[Le];Xe(ye[0]+G*h,ye[1]+G*h,ye[2]+G*h)}}i.addGroup(z,r.length/3-z,0)})(),function Ne(){const z=r.length/3;let Le=0;$e(V,Le),Le+=V.length;for(let ye=0,Ae=$.length;ye<Ae;ye++){const Ee=$[ye];$e(Ee,Le),Le+=Ee.length}i.addGroup(z,r.length/3-z,1)}()}this.setAttribute("position",new Ke(r,3)),this.setAttribute("uv",new Ke(s,2)),this.computeVertexNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return function gre(n,e,t){if(t.shapes=[],Array.isArray(n))for(let i=0,r=n.length;i<r;i++)t.shapes.push(n[i].uuid);else t.shapes.push(n.uuid);return t.options=Object.assign({},e),void 0!==e.extrudePath&&(t.options.extrudePath=e.extrudePath.toJSON()),t}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){const i=[];for(let s=0,o=e.shapes.length;s<o;s++)i.push(t[e.shapes[s]]);const r=e.options.extrudePath;return void 0!==r&&(e.options.extrudePath=(new GS[r.type]).fromJSON(r)),new JS(i,e.options)}}const mre={generateTopUV:function(n,e,t,i,r){const a=e[3*i],l=e[3*i+1],c=e[3*r],h=e[3*r+1];return[new fe(e[3*t],e[3*t+1]),new fe(a,l),new fe(c,h)]},generateSideWallUV:function(n,e,t,i,r,s){const o=e[3*t],a=e[3*t+1],l=e[3*t+2],c=e[3*i],h=e[3*i+1],d=e[3*i+2],p=e[3*r],m=e[3*r+1],g=e[3*r+2],v=e[3*s],w=e[3*s+1],y=e[3*s+2];return Math.abs(a-h)<Math.abs(o-c)?[new fe(o,1-l),new fe(c,1-d),new fe(p,1-g),new fe(v,1-y)]:[new fe(a,1-l),new fe(h,1-d),new fe(m,1-g),new fe(w,1-y)]}};class bu extends id{constructor(e=1,t=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new bu(e.radius,e.detail)}}class Am extends Rt{constructor(e=1,t=32,i=16,r=0,s=2*Math.PI,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));const l=Math.min(o+a,Math.PI);let c=0;const h=[],d=new L,p=new L,m=[],g=[],v=[],w=[];for(let y=0;y<=i;y++){const b=[],E=y/i;let C=0;0===y&&0===o?C=.5/t:y===i&&l===Math.PI&&(C=-.5/t);for(let x=0;x<=t;x++){const A=x/t;d.x=-e*Math.cos(r+A*s)*Math.sin(o+E*a),d.y=e*Math.cos(o+E*a),d.z=e*Math.sin(r+A*s)*Math.sin(o+E*a),g.push(d.x,d.y,d.z),p.copy(d).normalize(),v.push(p.x,p.y,p.z),w.push(A+C,1-E),b.push(c++)}h.push(b)}for(let y=0;y<i;y++)for(let b=0;b<t;b++){const C=h[y][b],x=h[y+1][b],A=h[y+1][b+1];(0!==y||o>0)&&m.push(h[y][b+1],C,A),(y!==i-1||l<Math.PI)&&m.push(C,x,A)}this.setIndex(m),this.setAttribute("position",new Ke(g,3)),this.setAttribute("normal",new Ke(v,3)),this.setAttribute("uv",new Ke(w,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Am(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Eu extends Rt{constructor(e=1,t=.4,i=12,r=48,s=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:r,arc:s},i=Math.floor(i),r=Math.floor(r);const o=[],a=[],l=[],c=[],h=new L,d=new L,p=new L;for(let m=0;m<=i;m++)for(let g=0;g<=r;g++){const v=g/r*s,w=m/i*Math.PI*2;d.x=(e+t*Math.cos(w))*Math.cos(v),d.y=(e+t*Math.cos(w))*Math.sin(v),d.z=t*Math.sin(w),a.push(d.x,d.y,d.z),h.x=e*Math.cos(v),h.y=e*Math.sin(v),p.subVectors(d,h).normalize(),l.push(p.x,p.y,p.z),c.push(g/r),c.push(m/i)}for(let m=1;m<=i;m++)for(let g=1;g<=r;g++){const w=(r+1)*(m-1)+g-1,y=(r+1)*(m-1)+g,b=(r+1)*m+g;o.push((r+1)*m+g-1,w,b),o.push(w,y,b)}this.setIndex(o),this.setAttribute("position",new Ke(a,3)),this.setAttribute("normal",new Ke(l,3)),this.setAttribute("uv",new Ke(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Eu(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class Dm extends gs{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new We(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new We(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new fe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class rc extends Dm{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new fe(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return wi(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new We(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new We(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new We(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class jI extends gs{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new We(16777215),this.specular=new We(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new We(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new fe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=YE,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class OH extends gs{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new fe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}function sd(n,e,t){return!n||!t&&n.constructor===e?n:"number"==typeof e.BYTES_PER_ELEMENT?new e(n):Array.prototype.slice.call(n)}function kH(n){const t=n.length,i=new Array(t);for(let r=0;r!==t;++r)i[r]=r;return i.sort(function e(r,s){return n[r]-n[s]}),i}function $I(n,e,t){const i=n.length,r=new n.constructor(i);for(let s=0,o=0;o!==i;++s){const a=t[s]*e;for(let l=0;l!==e;++l)r[o++]=n[a+l]}return r}function qI(n,e,t,i){let r=1,s=n[0];for(;void 0!==s&&void 0===s[i];)s=n[r++];if(void 0===s)return;let o=s[i];if(void 0!==o)if(Array.isArray(o))do{o=s[i],void 0!==o&&(e.push(s.time),t.push.apply(t,o)),s=n[r++]}while(void 0!==s);else if(void 0!==o.toArray)do{o=s[i],void 0!==o&&(e.push(s.time),o.toArray(t,t.length)),s=n[r++]}while(void 0!==s);else do{o=s[i],void 0!==o&&(e.push(s.time),t.push(o)),s=n[r++]}while(void 0!==s)}class vv{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,r=t[i],s=t[i-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=i+2;;){if(void 0===r){if(e<s)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(s=r,r=t[++i],e<r)break t}o=t.length;break n}if(e>=s)break e;{const a=t[1];e<a&&(i=2,s=a);for(let l=i-2;;){if(void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(i===l)break;if(r=s,s=t[--i-1],e>=s)break t}o=i,i=0}}for(;i<o;){const a=i+o>>>1;e<t[a]?o=a:i=a+1}if(r=t[i],s=t[i-1],void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=i[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class Tre extends vv{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(e,t,i){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],l=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case 2401:s=e,a=2*t-i;break;case 2402:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=i}if(void 0===l)switch(this.getSettings_().endingEnd){case 2401:o=e,l=2*i-t;break;case 2402:o=1,l=i+r[1]-r[0];break;default:o=e-1,l=t}const c=.5*(i-t),h=this.valueSize;this._weightPrev=c/(t-a),this._weightNext=c/(l-i),this._offsetPrev=s*h,this._offsetNext=o*h}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,h=this._offsetPrev,d=this._offsetNext,p=this._weightPrev,m=this._weightNext,g=(i-t)/(r-t),v=g*g,w=v*g,y=-p*w+2*p*v-p*g,b=(1+p)*w+(-1.5-2*p)*v+(-.5+p)*g+1,E=(-1-m)*w+(1.5+m)*v+.5*g,C=m*w-m*v;for(let x=0;x!==a;++x)s[x]=y*o[h+x]+b*o[c+x]+E*o[l+x]+C*o[d+x];return s}}class UH extends vv{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,h=(i-t)/(r-t),d=1-h;for(let p=0;p!==a;++p)s[p]=o[c+p]*d+o[l+p]*h;return s}}class Are extends vv{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class Qa{constructor(e,t,i,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=sd(t,this.TimeBufferType),this.values=sd(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:sd(e.times,Array),values:sd(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new Are(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new UH(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Tre(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Ky:t=this.InterpolantFactoryMethodDiscrete;break;case jp:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Ky;case this.InterpolantFactoryMethodLinear:return jp;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){const i=this.times,r=i.length;let s=0,o=r-1;for(;s!==r&&i[s]<e;)++s;for(;-1!==o&&i[o]>t;)--o;if(++o,0!==s||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=i.slice(s,o),this.values=this.values.slice(s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;0===s&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=i[a];if("number"==typeof l&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(null!==o&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(void 0!==r&&function FH(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}(r))for(let a=0,l=r.length;a!==l;++a){const c=r[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),i=this.getValueSize(),r=2302===this.getInterpolation(),s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const c=e[a];if(c!==e[a+1]&&(1!==a||c!==e[0]))if(r)l=!0;else{const d=a*i,p=d-i,m=d+i;for(let g=0;g!==i;++g){const v=t[d+g];if(v!==t[p+g]||v!==t[m+g]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const d=a*i,p=o*i;for(let m=0;m!==i;++m)t[p+m]=t[d+m]}++o}}if(s>0){e[o]=e[s];for(let a=s*i,l=o*i,c=0;c!==i;++c)t[l+c]=t[a+c];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*i)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}Qa.prototype.TimeBufferType=Float32Array,Qa.prototype.ValueBufferType=Float32Array,Qa.prototype.DefaultInterpolation=jp;class Im extends Qa{}Im.prototype.ValueTypeName="bool",Im.prototype.ValueBufferType=Array,Im.prototype.DefaultInterpolation=Ky,Im.prototype.InterpolantFactoryMethodLinear=void 0,Im.prototype.InterpolantFactoryMethodSmooth=void 0;class BH extends Qa{}BH.prototype.ValueTypeName="color";class Rm extends Qa{}Rm.prototype.ValueTypeName="number";class Dre extends vv{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(i-t)/(r-t);let c=e*a;for(let h=c+a;c!==h;c+=4)Vn.slerpFlat(s,0,o,c-a,o,c,l);return s}}class od extends Qa{InterpolantFactoryMethodLinear(e){return new Dre(this.times,this.values,this.getValueSize(),e)}}od.prototype.ValueTypeName="quaternion",od.prototype.DefaultInterpolation=jp,od.prototype.InterpolantFactoryMethodSmooth=void 0;class Pm extends Qa{}Pm.prototype.ValueTypeName="string",Pm.prototype.ValueBufferType=Array,Pm.prototype.DefaultInterpolation=Ky,Pm.prototype.InterpolantFactoryMethodLinear=void 0,Pm.prototype.InterpolantFactoryMethodSmooth=void 0;class Nm extends Qa{}Nm.prototype.ValueTypeName="vector";class wv{constructor(e,t=-1,i,r=2500){this.name=e,this.tracks=i,this.duration=t,this.blendMode=r,this.uuid=no(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,r=1/(e.fps||1);for(let o=0,a=i.length;o!==a;++o)t.push(Rre(i[o]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=i.length;s!==o;++s)t.push(Qa.toJSON(i[s]));return r}static CreateFromMorphTargetSequence(e,t,i,r){const s=t.length,o=[];for(let a=0;a<s;a++){let l=[],c=[];l.push((a+s-1)%s,a,(a+1)%s),c.push(0,1,0);const h=kH(l);l=$I(l,1,h),c=$I(c,1,h),!r&&0===l[0]&&(l.push(s),c.push(c[0])),o.push(new Rm(".morphTargetInfluences["+t[a].name+"]",l,c).scale(1/i))}return new this(e,-1,o)}static findByName(e,t){let i=e;Array.isArray(e)||(i=e.geometry&&e.geometry.animations||e.animations);for(let r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const c=e[a],h=c.name.match(s);if(h&&h.length>1){const d=h[1];let p=r[d];p||(r[d]=p=[]),p.push(c)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],t,i));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(d,p,m,g,v){if(0!==m.length){const w=[],y=[];qI(m,w,y,g),0!==w.length&&v.push(new d(p,w,y))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let l=e.length||-1;const c=e.hierarchy||[];for(let d=0;d<c.length;d++){const p=c[d].keys;if(p&&0!==p.length)if(p[0].morphTargets){const m={};let g;for(g=0;g<p.length;g++)if(p[g].morphTargets)for(let v=0;v<p[g].morphTargets.length;v++)m[p[g].morphTargets[v]]=-1;for(const v in m){const w=[],y=[];for(let b=0;b!==p[g].morphTargets.length;++b){const E=p[g];w.push(E.time),y.push(E.morphTarget===v?1:0)}r.push(new Rm(".morphTargetInfluence["+v+"]",w,y))}l=m.length*o}else{const m=".bones["+t[d].name+"]";i(Nm,m+".position",p,"pos",r),i(od,m+".quaternion",p,"rot",r),i(Nm,m+".scale",p,"scl",r)}}return 0===r.length?null:new this(s,l,r,a)}resetDuration(){let t=0;for(let i=0,r=this.tracks.length;i!==r;++i){const s=this.tracks[i];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Rre(n){if(void 0===n.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function Ire(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Rm;case"vector":case"vector2":case"vector3":case"vector4":return Nm;case"color":return BH;case"quaternion":return od;case"bool":case"boolean":return Im;case"string":return Pm}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}(n.type);if(void 0===n.times){const t=[],i=[];qI(n.keys,t,i,"value"),n.times=t,n.values=i}return void 0!==e.parse?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const Lm={enabled:!1,files:{},add:function(n,e){!1!==this.enabled&&(this.files[n]=e)},get:function(n){if(!1!==this.enabled)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class VH{constructor(e,t,i){const r=this;let l,s=!1,o=0,a=0;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(h){a++,!1===s&&void 0!==r.onStart&&r.onStart(h,o,a),s=!0},this.itemEnd=function(h){o++,void 0!==r.onProgress&&r.onProgress(h,o,a),o===a&&(s=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(h){void 0!==r.onError&&r.onError(h)},this.resolveURL=function(h){return l?l(h):h},this.setURLModifier=function(h){return l=h,this},this.addHandler=function(h,d){return c.push(h,d),this},this.removeHandler=function(h){const d=c.indexOf(h);return-1!==d&&c.splice(d,2),this},this.getHandler=function(h){for(let d=0,p=c.length;d<p;d+=2){const m=c[d],g=c[d+1];if(m.global&&(m.lastIndex=0),m.test(h))return g}return null}}}const Pre=new VH;let sc=(()=>{class n{constructor(t){this.manager=void 0!==t?t:Pre,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,i){const r=this;return new Promise(function(s,o){r.load(t,s,i,o)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}return n.DEFAULT_MATERIAL_NAME="__DEFAULT",n})();const oc={};class Nre extends Error{constructor(e,t){super(e),this.response=t}}class Fs extends sc{constructor(e){super(e)}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=Lm.get(e);if(void 0!==s)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(void 0!==oc[e])return void oc[e].push({onLoad:t,onProgress:i,onError:r});oc[e]=[],oc[e].push({onLoad:t,onProgress:i,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(c=>{if(200===c.status||0===c.status){if(0===c.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||void 0===c.body||void 0===c.body.getReader)return c;const h=oc[e],d=c.body.getReader(),p=c.headers.get("Content-Length")||c.headers.get("X-File-Size"),m=p?parseInt(p):0,g=0!==m;let v=0;const w=new ReadableStream({start(y){!function b(){d.read().then(({done:E,value:C})=>{if(E)y.close();else{v+=C.byteLength;const x=new ProgressEvent("progress",{lengthComputable:g,loaded:v,total:m});for(let A=0,D=h.length;A<D;A++){const O=h[A];O.onProgress&&O.onProgress(x)}y.enqueue(C),b()}})}()}});return new Response(w)}throw new Nre(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`,c)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(h=>(new DOMParser).parseFromString(h,a));case"json":return c.json();default:if(void 0===a)return c.text();{const d=/charset="?([^;"\s]*)"?/i.exec(a),p=d&&d[1]?d[1].toLowerCase():void 0,m=new TextDecoder(p);return c.arrayBuffer().then(g=>m.decode(g))}}}).then(c=>{Lm.add(e,c);const h=oc[e];delete oc[e];for(let d=0,p=h.length;d<p;d++){const m=h[d];m.onLoad&&m.onLoad(c)}}).catch(c=>{const h=oc[e];if(void 0===h)throw this.manager.itemError(e),c;delete oc[e];for(let d=0,p=h.length;d<p;d++){const m=h[d];m.onError&&m.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class QS extends sc{constructor(e){super(e)}load(e,t,i,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Lm.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=Jy("img");function l(){h(),Lm.add(e,this),t&&t(this),s.manager.itemEnd(e)}function c(d){h(),r&&r(d),s.manager.itemError(e),s.manager.itemEnd(e)}function h(){a.removeEventListener("load",l,!1),a.removeEventListener("error",c,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",c,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class Lre extends sc{constructor(e){super(e)}load(e,t,i,r){const s=new xS;s.colorSpace=di;const o=new QS(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function l(c){o.load(e[c],function(h){s.images[c]=h,a++,6===a&&(s.needsUpdate=!0,t&&t(s))},void 0,r)}for(let c=0;c<e.length;++c)l(c);return s}}class XI extends sc{constructor(e){super(e)}load(e,t,i,r){const s=new Ro,o=new QS(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,void 0!==t&&t(s)},i,r),s}}class YI extends fi{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new We(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}const KI=new wt,HH=new L,zH=new L;class ZI{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new fe(512,512),this.map=null,this.mapPass=null,this.matrix=new wt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new cI,this._frameExtents=new fe(1,1),this._viewportCount=1,this._viewports=[new Nn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;HH.setFromMatrixPosition(e.matrixWorld),t.position.copy(HH),zH.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(zH),t.updateMatrixWorld(),KI.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(KI),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(KI)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Fre extends ZI{constructor(){super(new ir(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,i=2*Xp*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(i!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=i,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class GH extends YI{constructor(e,t,i=0,r=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(fi.DEFAULT_UP),this.updateMatrix(),this.target=new fi,this.distance=i,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new Fre}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const WH=new wt,bv=new L,JI=new L;class kre extends ZI{constructor(){super(new ir(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new fe(4,2),this._viewportCount=6,this._viewports=[new Nn(2,1,1,1),new Nn(0,1,1,1),new Nn(3,1,1,1),new Nn(1,1,1,1),new Nn(3,0,1,1),new Nn(1,0,1,1)],this._cubeDirections=[new L(1,0,0),new L(-1,0,0),new L(0,0,1),new L(0,0,-1),new L(0,1,0),new L(0,-1,0)],this._cubeUps=[new L(0,1,0),new L(0,1,0),new L(0,1,0),new L(0,1,0),new L(0,0,1),new L(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),bv.setFromMatrixPosition(e.matrixWorld),i.position.copy(bv),JI.copy(i.position),JI.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(JI),i.updateMatrixWorld(),r.makeTranslation(-bv.x,-bv.y,-bv.z),WH.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(WH)}}class QI extends YI{constructor(e,t,i=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new kre}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class Ure extends ZI{constructor(){super(new AS(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class jH extends YI{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(fi.DEFAULT_UP),this.updateMatrix(),this.target=new fi,this.shadow=new Ure}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class Ev{static decodeText(e){if(typeof TextDecoder<"u")return(new TextDecoder).decode(e);let t="";for(let i=0,r=e.length;i<r;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class $re extends sc{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Lm.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a={};a.credentials="anonymous"===this.crossOrigin?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(l){Lm.add(e,l),t&&t(l),s.manager.itemEnd(e)}).catch(function(l){r&&r(l),s.manager.itemError(e),s.manager.itemEnd(e)}),s.manager.itemStart(e)}}const tR="\\[\\]\\.:\\/",Zre=new RegExp("["+tR+"]","g"),nR="[^"+tR+"]",Jre="[^"+tR.replace("\\.","")+"]",ise=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",nR)+/(WCOD+)?/.source.replace("WCOD",Jre)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",nR)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",nR)+"$"),rse=["material","materials","bones","map"];class sse{constructor(e,t,i){const r=i||Zn.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}let Zn=(()=>{class n{constructor(t,i,r){this.path=i,this.parsedPath=r||n.parseTrackName(i),this.node=n.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,i,r){return t&&t.isAnimationObjectGroup?new n.Composite(t,i,r):new n(t,i,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(Zre,"")}static parseTrackName(t){const i=ise.exec(t);if(null===i)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},s=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==s&&-1!==s){const o=r.nodeName.substring(s+1);-1!==rse.indexOf(o)&&(r.nodeName=r.nodeName.substring(0,s),r.objectName=o)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,i){if(void 0===i||""===i||"."===i||-1===i||i===t.name||i===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(i);if(void 0!==r)return r}if(t.children){const r=function(o){for(let a=0;a<o.length;a++){const l=o[a];if(l.name===i||l.uuid===i)return l;const c=r(l.children);if(c)return c}return null},s=r(t.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,i){t[i]=this.targetObject[this.propertyName]}_getValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)t[i++]=r[s]}_getValue_arrayElement(t,i){t[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,i){this.resolvedProperty.toArray(t,i)}_setValue_direct(t,i){this.targetObject[this.propertyName]=t[i]}_setValue_direct_setNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++]}_setValue_array_setNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,i){this.resolvedProperty[this.propertyIndex]=t[i]}_setValue_arrayElement_setNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,i){this.resolvedProperty.fromArray(t,i)}_setValue_fromArray_setNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,i){this.bind(),this.getValue(t,i)}_setValue_unbound(t,i){this.bind(),this.setValue(t,i)}bind(){let t=this.node;const i=this.parsedPath,r=i.objectName,s=i.propertyName;let o=i.propertyIndex;if(t||(t=n.findNode(this.rootNode,i.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(r){let h=i.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let d=0;d<t.length;d++)if(t[d].name===h){h=d;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==h){if(void 0===t[h])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[h]}}const a=t[s];if(void 0===a)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+i.nodeName+"."+s+" but it wasn't found.",t);let l=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?l=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(void 0!==o){if("morphTargetInfluences"===s){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[o]&&(o=t.morphTargetDictionary[o])}c=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=o}else void 0!==a.fromArray&&void 0!==a.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(c=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=s;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return n.Composite=sse,n})();Zn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Zn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Zn.prototype.GetterByBindingType=[Zn.prototype._getValue_direct,Zn.prototype._getValue_array,Zn.prototype._getValue_arrayElement,Zn.prototype._getValue_toArray],Zn.prototype.SetterByBindingTypeAndVersioning=[[Zn.prototype._setValue_direct,Zn.prototype._setValue_direct_setNeedsUpdate,Zn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Zn.prototype._setValue_array,Zn.prototype._setValue_array_setNeedsUpdate,Zn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Zn.prototype._setValue_arrayElement,Zn.prototype._setValue_arrayElement_setNeedsUpdate,Zn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Zn.prototype._setValue_fromArray,Zn.prototype._setValue_fromArray_setNeedsUpdate,Zn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],new Float32Array(1);class iR{constructor(e,t,i=0,r=1/0){this.ray=new im(e,t),this.near=i,this.far=r,this.camera=null,this.layers=new QD,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,i=[]){return rR(e,this,i,t),i.sort(tz),i}intersectObjects(e,t=!0,i=[]){for(let r=0,s=e.length;r<s;r++)rR(e[r],this,i,t);return i.sort(tz),i}}function tz(n,e){return n.distance-e.distance}function rR(n,e,t,i){if(n.layers.test(e.layers)&&n.raycast(e,t),!0===i){const r=n.children;for(let s=0,o=r.length;s<o;s++)rR(r[s],e,t,!0)}}class nz{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(wi(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}class use extends xm{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=new Rt;r.setAttribute("position",new Ke(t,3)),r.setAttribute("color",new Ke([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),super(r,new gr({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,t,i){const r=new We,s=this.geometry.attributes.color.array;return r.set(e),r.toArray(s,0),r.toArray(s,3),r.set(t),r.toArray(s,6),r.toArray(s,9),r.set(i),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class hse{constructor(){this.type="ShapePath",this.color=new We,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new WS,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,i,r){return this.currentPath.quadraticCurveTo(e,t,i,r),this}bezierCurveTo(e,t,i,r,s,o){return this.currentPath.bezierCurveTo(e,t,i,r,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function i(y,b){const E=b.length;let C=!1;for(let x=E-1,A=0;A<E;x=A++){let D=b[x],O=b[A],T=O.x-D.x,R=O.y-D.y;if(Math.abs(R)>Number.EPSILON){if(R<0&&(D=b[A],T=-T,O=b[x],R=-R),y.y<D.y||y.y>O.y)continue;if(y.y===D.y){if(y.x===D.x)return!0}else{const $=R*(y.x-D.x)-T*(y.y-D.y);if(0===$)return!0;if($<0)continue;C=!C}}else{if(y.y!==D.y)continue;if(O.x<=y.x&&y.x<=D.x||D.x<=y.x&&y.x<=O.x)return!0}}return C}const r=ic.isClockWise,s=this.subPaths;if(0===s.length)return[];let o,a,l;const c=[];if(1===s.length)return a=s[0],l=new Mm,l.curves=a.curves,c.push(l),c;let h=!r(s[0].getPoints());h=e?!h:h;const d=[],p=[];let v,w,m=[],g=0;p[g]=void 0,m[g]=[];for(let y=0,b=s.length;y<b;y++)a=s[y],v=a.getPoints(),o=r(v),o=e?!o:o,o?(!h&&p[g]&&g++,p[g]={s:new Mm,p:v},p[g].s.curves=a.curves,h&&g++,m[g]=[]):m[g].push({h:a,p:v[0]});if(!p[0])return function t(y){const b=[];for(let E=0,C=y.length;E<C;E++){const x=y[E],A=new Mm;A.curves=x.curves,b.push(A)}return b}(s);if(p.length>1){let y=!1,b=0;for(let E=0,C=p.length;E<C;E++)d[E]=[];for(let E=0,C=p.length;E<C;E++){const x=m[E];for(let A=0;A<x.length;A++){const D=x[A];let O=!0;for(let T=0;T<p.length;T++)i(D.p,p[T].p)&&(E!==T&&b++,O?(O=!1,d[T].push(D)):y=!0);O&&d[E].push(D)}}b>0&&!1===y&&(m=d)}for(let y=0,b=p.length;y<b;y++){l=p[y].s,c.push(l),w=m[y];for(let E=0,C=w.length;E<C;E++)l.holes.push(w[E].h)}return c}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"157"}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="157");const dz={type:"change"},aR={type:"start"},fz={type:"end"},aC=new im,pz=new nc,dse=Math.cos(70*mu_DEG2RAD);class mz extends $h{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new L,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:0,MIDDLE:1,RIGHT:2},this.touches={ONE:0,TWO:2},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return a.phi},this.getAzimuthalAngle=function(){return a.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(W){W.addEventListener("keydown",P),this._domElementKeyEvents=W},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",P),this._domElementKeyEvents=null},this.saveState=function(){i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=function(){i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(dz),i.update(),s=r.NONE},this.update=function(){const W=new L,Re=(new Vn).setFromUnitVectors(e.up,new L(0,1,0)),we=Re.clone().invert(),Ct=new L,at=new Vn,ft=new L,st=2*Math.PI;return function(Fe=null){const Pe=i.object.position;W.copy(Pe).sub(i.target),W.applyQuaternion(Re),a.setFromVector3(W),i.autoRotate&&s===r.NONE&&$(function T(W){return null!==W?2*Math.PI/60*i.autoRotateSpeed*W:2*Math.PI/60/60*i.autoRotateSpeed}(Fe)),i.enableDamping?(a.theta+=l.theta*i.dampingFactor,a.phi+=l.phi*i.dampingFactor):(a.theta+=l.theta,a.phi+=l.phi);let je=i.minAzimuthAngle,ke=i.maxAzimuthAngle;isFinite(je)&&isFinite(ke)&&(je<-Math.PI?je+=st:je>Math.PI&&(je-=st),ke<-Math.PI?ke+=st:ke>Math.PI&&(ke-=st),a.theta=je<=ke?Math.max(je,Math.min(ke,a.theta)):a.theta>(je+ke)/2?Math.max(je,a.theta):Math.min(ke,a.theta)),a.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,a.phi)),a.makeSafe(),!0===i.enableDamping?i.target.addScaledVector(h,i.dampingFactor):i.target.add(h),a.radius=Z(i.zoomToCursor&&A||i.object.isOrthographicCamera?a.radius:a.radius*c),W.setFromSpherical(a),W.applyQuaternion(we),Pe.copy(i.target).add(W),i.object.lookAt(i.target),!0===i.enableDamping?(l.theta*=1-i.dampingFactor,l.phi*=1-i.dampingFactor,h.multiplyScalar(1-i.dampingFactor)):(l.set(0,0,0),h.set(0,0,0));let Ce=!1;if(i.zoomToCursor&&A){let it=null;if(i.object.isPerspectiveCamera){const Tt=W.length();it=Z(Tt*c),i.object.position.addScaledVector(C,Tt-it),i.object.updateMatrixWorld()}else if(i.object.isOrthographicCamera){const Tt=new L(x.x,x.y,0);Tt.unproject(i.object),i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/c)),i.object.updateProjectionMatrix(),Ce=!0;const Xi=new L(x.x,x.y,0);Xi.unproject(i.object),i.object.position.sub(Xi).add(Tt),i.object.updateMatrixWorld(),it=W.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),i.zoomToCursor=!1;null!==it&&(this.screenSpacePanning?i.target.set(0,0,-1).transformDirection(i.object.matrix).multiplyScalar(it).add(i.object.position):(aC.origin.copy(i.object.position),aC.direction.set(0,0,-1).transformDirection(i.object.matrix),Math.abs(i.object.up.dot(aC.direction))<dse?e.lookAt(i.target):(pz.setFromNormalAndCoplanarPoint(i.object.up,i.target),aC.intersectPlane(pz,i.target))))}else i.object.isOrthographicCamera&&(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/c)),i.object.updateProjectionMatrix(),Ce=!0);return c=1,A=!1,!!(Ce||Ct.distanceToSquared(i.object.position)>o||8*(1-at.dot(i.object.quaternion))>o||ft.distanceToSquared(i.target)>0)&&(i.dispatchEvent(dz),Ct.copy(i.object.position),at.copy(i.object.quaternion),ft.copy(i.target),Ce=!1,!0)}}(),this.dispose=function(){i.domElement.removeEventListener("contextmenu",xe),i.domElement.removeEventListener("pointerdown",Ze),i.domElement.removeEventListener("pointercancel",bt),i.domElement.removeEventListener("wheel",k),i.domElement.removeEventListener("pointermove",Qe),i.domElement.removeEventListener("pointerup",bt),null!==i._domElementKeyEvents&&(i._domElementKeyEvents.removeEventListener("keydown",P),i._domElementKeyEvents=null)};const i=this,r={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let s=r.NONE;const o=1e-6,a=new nz,l=new nz;let c=1;const h=new L,d=new fe,p=new fe,m=new fe,g=new fe,v=new fe,w=new fe,y=new fe,b=new fe,E=new fe,C=new L,x=new fe;let A=!1;const D=[],O={};function R(){return Math.pow(.95,i.zoomSpeed)}function $(W){l.theta-=W}function ee(W){l.phi-=W}const se=function(){const W=new L;return function(we,Ct){W.setFromMatrixColumn(Ct,0),W.multiplyScalar(-we),h.add(W)}}(),V=function(){const W=new L;return function(we,Ct){!0===i.screenSpacePanning?W.setFromMatrixColumn(Ct,1):(W.setFromMatrixColumn(Ct,0),W.crossVectors(i.object.up,W)),W.multiplyScalar(we),h.add(W)}}(),J=function(){const W=new L;return function(we,Ct){const at=i.domElement;if(i.object.isPerspectiveCamera){W.copy(i.object.position).sub(i.target);let st=W.length();st*=Math.tan(i.object.fov/2*Math.PI/180),se(2*we*st/at.clientHeight,i.object.matrix),V(2*Ct*st/at.clientHeight,i.object.matrix)}else i.object.isOrthographicCamera?(se(we*(i.object.right-i.object.left)/i.object.zoom/at.clientWidth,i.object.matrix),V(Ct*(i.object.top-i.object.bottom)/i.object.zoom/at.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}}();function G(W){i.object.isPerspectiveCamera||i.object.isOrthographicCamera?c/=W:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function X(W){i.object.isPerspectiveCamera||i.object.isOrthographicCamera?c*=W:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function Q(W){if(!i.zoomToCursor)return;A=!0;const Re=i.domElement.getBoundingClientRect(),Ct=W.clientY-Re.top,ft=Re.height;x.x=(W.clientX-Re.left)/Re.width*2-1,x.y=-Ct/ft*2+1,C.set(x.x,x.y,1).unproject(i.object).sub(i.object.position).normalize()}function Z(W){return Math.max(i.minDistance,Math.min(i.maxDistance,W))}function le(W){d.set(W.clientX,W.clientY)}function oe(W){g.set(W.clientX,W.clientY)}function Xe(){1===D.length?d.set(D[0].pageX,D[0].pageY):d.set(.5*(D[0].pageX+D[1].pageX),.5*(D[0].pageY+D[1].pageY))}function dt(){1===D.length?g.set(D[0].pageX,D[0].pageY):g.set(.5*(D[0].pageX+D[1].pageX),.5*(D[0].pageY+D[1].pageY))}function St(){const W=D[0].pageX-D[1].pageX,Re=D[0].pageY-D[1].pageY,we=Math.sqrt(W*W+Re*Re);y.set(0,we)}function Le(W){if(1==D.length)p.set(W.pageX,W.pageY);else{const we=qe(W);p.set(.5*(W.pageX+we.x),.5*(W.pageY+we.y))}m.subVectors(p,d).multiplyScalar(i.rotateSpeed);const Re=i.domElement;$(2*Math.PI*m.x/Re.clientHeight),ee(2*Math.PI*m.y/Re.clientHeight),d.copy(p)}function ye(W){if(1===D.length)v.set(W.pageX,W.pageY);else{const Re=qe(W);v.set(.5*(W.pageX+Re.x),.5*(W.pageY+Re.y))}w.subVectors(v,g).multiplyScalar(i.panSpeed),J(w.x,w.y),g.copy(v)}function Ae(W){const Re=qe(W),we=W.pageX-Re.x,Ct=W.pageY-Re.y,at=Math.sqrt(we*we+Ct*Ct);b.set(0,at),E.set(0,Math.pow(b.y/y.y,i.zoomSpeed)),G(E.y),y.copy(b)}function Ze(W){!1!==i.enabled&&(0===D.length&&(i.domElement.setPointerCapture(W.pointerId),i.domElement.addEventListener("pointermove",Qe),i.domElement.addEventListener("pointerup",bt)),function De(W){D.push(W)}(W),"touch"===W.pointerType?function ie(W){switch(Ie(W),D.length){case 1:switch(i.touches.ONE){case 0:if(!1===i.enableRotate)return;Xe(),s=r.TOUCH_ROTATE;break;case 1:if(!1===i.enablePan)return;dt(),s=r.TOUCH_PAN;break;default:s=r.NONE}break;case 2:switch(i.touches.TWO){case 2:if(!1===i.enableZoom&&!1===i.enablePan)return;(function nt(){i.enableZoom&&St(),i.enablePan&&dt()})(),s=r.TOUCH_DOLLY_PAN;break;case 3:if(!1===i.enableZoom&&!1===i.enableRotate)return;(function z(){i.enableZoom&&St(),i.enableRotate&&Xe()})(),s=r.TOUCH_DOLLY_ROTATE;break;default:s=r.NONE}break;default:s=r.NONE}s!==r.NONE&&i.dispatchEvent(aR)}(W):function en(W){let Re;switch(W.button){case 0:Re=i.mouseButtons.LEFT;break;case 1:Re=i.mouseButtons.MIDDLE;break;case 2:Re=i.mouseButtons.RIGHT;break;default:Re=-1}switch(Re){case 1:if(!1===i.enableZoom)return;(function q(W){Q(W),y.set(W.clientX,W.clientY)})(W),s=r.DOLLY;break;case 0:if(W.ctrlKey||W.metaKey||W.shiftKey){if(!1===i.enablePan)return;oe(W),s=r.PAN}else{if(!1===i.enableRotate)return;le(W),s=r.ROTATE}break;case 2:if(W.ctrlKey||W.metaKey||W.shiftKey){if(!1===i.enableRotate)return;le(W),s=r.ROTATE}else{if(!1===i.enablePan)return;oe(W),s=r.PAN}break;default:s=r.NONE}s!==r.NONE&&i.dispatchEvent(aR)}(W))}function Qe(W){!1!==i.enabled&&("touch"===W.pointerType?function Te(W){switch(Ie(W),s){case r.TOUCH_ROTATE:if(!1===i.enableRotate)return;Le(W),i.update();break;case r.TOUCH_PAN:if(!1===i.enablePan)return;ye(W),i.update();break;case r.TOUCH_DOLLY_PAN:if(!1===i.enableZoom&&!1===i.enablePan)return;(function Ee(W){i.enableZoom&&Ae(W),i.enablePan&&ye(W)})(W),i.update();break;case r.TOUCH_DOLLY_ROTATE:if(!1===i.enableZoom&&!1===i.enableRotate)return;(function ot(W){i.enableZoom&&Ae(W),i.enableRotate&&Le(W)})(W),i.update();break;default:s=r.NONE}}(W):function li(W){switch(s){case r.ROTATE:if(!1===i.enableRotate)return;!function Se(W){p.set(W.clientX,W.clientY),m.subVectors(p,d).multiplyScalar(i.rotateSpeed);const Re=i.domElement;$(2*Math.PI*m.x/Re.clientHeight),ee(2*Math.PI*m.y/Re.clientHeight),d.copy(p),i.update()}(W);break;case r.DOLLY:if(!1===i.enableZoom)return;!function ve(W){b.set(W.clientX,W.clientY),E.subVectors(b,y),E.y>0?G(R()):E.y<0&&X(R()),y.copy(b),i.update()}(W);break;case r.PAN:if(!1===i.enablePan)return;!function Ne(W){v.set(W.clientX,W.clientY),w.subVectors(v,g).multiplyScalar(i.panSpeed),J(w.x,w.y),g.copy(v),i.update()}(W)}}(W))}function bt(W){(function rt(W){delete O[W.pointerId];for(let Re=0;Re<D.length;Re++)if(D[Re].pointerId==W.pointerId)return void D.splice(Re,1)})(W),0===D.length&&(i.domElement.releasePointerCapture(W.pointerId),i.domElement.removeEventListener("pointermove",Qe),i.domElement.removeEventListener("pointerup",bt)),i.dispatchEvent(fz),s=r.NONE}function k(W){!1===i.enabled||!1===i.enableZoom||s!==r.NONE||(W.preventDefault(),i.dispatchEvent(aR),function $e(W){Q(W),W.deltaY<0?X(R()):W.deltaY>0&&G(R()),i.update()}(W),i.dispatchEvent(fz))}function P(W){!1===i.enabled||!1===i.enablePan||function Be(W){let Re=!1;switch(W.code){case i.keys.UP:W.ctrlKey||W.metaKey||W.shiftKey?ee(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):J(0,i.keyPanSpeed),Re=!0;break;case i.keys.BOTTOM:W.ctrlKey||W.metaKey||W.shiftKey?ee(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):J(0,-i.keyPanSpeed),Re=!0;break;case i.keys.LEFT:W.ctrlKey||W.metaKey||W.shiftKey?$(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):J(i.keyPanSpeed,0),Re=!0;break;case i.keys.RIGHT:W.ctrlKey||W.metaKey||W.shiftKey?$(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):J(-i.keyPanSpeed,0),Re=!0}Re&&(W.preventDefault(),i.update())}(W)}function xe(W){!1!==i.enabled&&W.preventDefault()}function Ie(W){let Re=O[W.pointerId];void 0===Re&&(Re=new fe,O[W.pointerId]=Re),Re.set(W.pageX,W.pageY)}function qe(W){return O[(W.pointerId===D[0].pointerId?D[1]:D[0]).pointerId]}i.domElement.addEventListener("contextmenu",xe),i.domElement.addEventListener("pointerdown",Ze),i.domElement.addEventListener("pointercancel",bt),i.domElement.addEventListener("wheel",k,{passive:!1}),this.update()}}function gz(n,e){if(0===e)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),n;if(2===e||1===e){let t=n.getIndex();if(null===t){const o=[],a=n.getAttribute("position");if(void 0===a)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n;for(let l=0;l<a.count;l++)o.push(l);n.setIndex(o),t=n.getIndex()}const i=t.count-2,r=[];if(2===e)for(let o=1;o<=i;o++)r.push(t.getX(0)),r.push(t.getX(o)),r.push(t.getX(o+1));else for(let o=0;o<i;o++)o%2==0?(r.push(t.getX(o)),r.push(t.getX(o+1)),r.push(t.getX(o+2))):(r.push(t.getX(o+2)),r.push(t.getX(o+1)),r.push(t.getX(o)));r.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=n.clone();return s.setIndex(r),s.clearGroups(),s}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),n}class _z extends sc{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new yse(t)}),this.register(function(t){return new Mse(t)}),this.register(function(t){return new Tse(t)}),this.register(function(t){return new Ase(t)}),this.register(function(t){return new wse(t)}),this.register(function(t){return new bse(t)}),this.register(function(t){return new Ese(t)}),this.register(function(t){return new Sse(t)}),this.register(function(t){return new _se(t)}),this.register(function(t){return new Cse(t)}),this.register(function(t){return new vse(t)}),this.register(function(t){return new xse(t)}),this.register(function(t){return new mse(t)}),this.register(function(t){return new Dse(t)}),this.register(function(t){return new Ise(t)})}load(e,t,i,r){const s=this;let o;o=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:Ev.extractUrlBase(e),this.manager.itemStart(e);const a=function(c){r?r(c):console.error(c),s.manager.itemError(e),s.manager.itemEnd(e)},l=new Fs(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(c){try{s.parse(c,o,function(h){t(h),s.manager.itemEnd(e)},a)}catch(h){a(h)}},i,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,r){let s;const o={},a={},l=new TextDecoder;if("string"==typeof e)s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(l.decode(new Uint8Array(e,0,4))===yz){try{o[ln.KHR_BINARY_GLTF]=new Rse(e)}catch(d){return void(r&&r(d))}s=JSON.parse(o[ln.KHR_BINARY_GLTF].content)}else s=JSON.parse(l.decode(e));else s=e;if(void 0===s.asset||s.asset.version[0]<2)return void(r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const c=new Wse(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});c.fileLoader.setRequestHeader(this.requestHeader);for(let h=0;h<this.pluginCallbacks.length;h++){const d=this.pluginCallbacks[h](c);a[d.name]=d,o[d.name]=!0}if(s.extensionsUsed)for(let h=0;h<s.extensionsUsed.length;++h){const d=s.extensionsUsed[h],p=s.extensionsRequired||[];switch(d){case ln.KHR_MATERIALS_UNLIT:o[d]=new gse;break;case ln.KHR_DRACO_MESH_COMPRESSION:o[d]=new Pse(s,this.dracoLoader);break;case ln.KHR_TEXTURE_TRANSFORM:o[d]=new Nse;break;case ln.KHR_MESH_QUANTIZATION:o[d]=new Lse;break;default:p.indexOf(d)>=0&&void 0===a[d]&&console.warn('THREE.GLTFLoader: Unknown extension "'+d+'".')}}c.setExtensions(o),c.setPlugins(a),c.parse(i,r)}parseAsync(e,t){const i=this;return new Promise(function(r,s){i.parse(e,t,r,s)})}}function pse(){let n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}const ln={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class mse{constructor(e){this.parser=e,this.name=ln.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let i=0,r=t.length;i<r;i++){const s=t[i];s.extensions&&s.extensions[this.name]&&void 0!==s.extensions[this.name].light&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,i="light:"+e;let r=t.cache.get(i);if(r)return r;const s=t.json,l=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let c;const h=new We(16777215);void 0!==l.color&&h.setRGB(l.color[0],l.color[1],l.color[2],Tr);const d=void 0!==l.range?l.range:0;switch(l.type){case"directional":c=new jH(h),c.target.position.set(0,0,-1),c.add(c.target);break;case"point":c=new QI(h),c.distance=d;break;case"spot":c=new GH(h),c.distance=d,l.spot=l.spot||{},l.spot.innerConeAngle=void 0!==l.spot.innerConeAngle?l.spot.innerConeAngle:0,l.spot.outerConeAngle=void 0!==l.spot.outerConeAngle?l.spot.outerConeAngle:Math.PI/4,c.angle=l.spot.outerConeAngle,c.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,c.target.position.set(0,0,-1),c.add(c.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return c.position.set(0,0,0),c.decay=2,xu(c,l),void 0!==l.intensity&&(c.intensity=l.intensity),c.name=t.createUniqueName(l.name||"light_"+e),r=Promise.resolve(c),t.cache.add(i,r),r}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){const t=this,i=this.parser,s=i.json.nodes[e],a=(s.extensions&&s.extensions[this.name]||{}).light;return void 0===a?null:this._loadLight(a).then(function(l){return i._getNodeRef(t.cache,a,l)})}}class gse{constructor(){this.name=ln.KHR_MATERIALS_UNLIT}getMaterialType(){return bi}extendParams(e,t,i){const r=[];e.color=new We(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.setRGB(o[0],o[1],o[2],Tr),e.opacity=o[3]}void 0!==s.baseColorTexture&&r.push(i.assignTexture(e,"map",s.baseColorTexture,di))}return Promise.all(r)}}class _se{constructor(e){this.parser=e,this.name=ln.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name].emissiveStrength;return void 0!==s&&(t.emissiveIntensity=s),Promise.resolve()}}class yse{constructor(e){this.parser=e,this.name=ln.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?rc:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];if(void 0!==o.clearcoatFactor&&(t.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&s.push(i.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&s.push(i.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(s.push(i.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){const a=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new fe(a,a)}return Promise.all(s)}}class vse{constructor(e){this.parser=e,this.name=ln.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?rc:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.iridescenceFactor&&(t.iridescence=o.iridescenceFactor),void 0!==o.iridescenceTexture&&s.push(i.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),void 0!==o.iridescenceIor&&(t.iridescenceIOR=o.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==o.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),void 0!==o.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),void 0!==o.iridescenceThicknessTexture&&s.push(i.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}}class wse{constructor(e){this.parser=e,this.name=ln.KHR_MATERIALS_SHEEN}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?rc:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new We(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=r.extensions[this.name];if(void 0!==o.sheenColorFactor){const a=o.sheenColorFactor;t.sheenColor.setRGB(a[0],a[1],a[2],Tr)}return void 0!==o.sheenRoughnessFactor&&(t.sheenRoughness=o.sheenRoughnessFactor),void 0!==o.sheenColorTexture&&s.push(i.assignTexture(t,"sheenColorMap",o.sheenColorTexture,di)),void 0!==o.sheenRoughnessTexture&&s.push(i.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class bse{constructor(e){this.parser=e,this.name=ln.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?rc:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.transmissionFactor&&(t.transmission=o.transmissionFactor),void 0!==o.transmissionTexture&&s.push(i.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class Ese{constructor(e){this.parser=e,this.name=ln.KHR_MATERIALS_VOLUME}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?rc:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.thickness=void 0!==o.thicknessFactor?o.thicknessFactor:0,void 0!==o.thicknessTexture&&s.push(i.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;const a=o.attenuationColor||[1,1,1];return t.attenuationColor=(new We).setRGB(a[0],a[1],a[2],Tr),Promise.all(s)}}class Sse{constructor(e){this.parser=e,this.name=ln.KHR_MATERIALS_IOR}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?rc:null}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return t.ior=void 0!==s.ior?s.ior:1.5,Promise.resolve()}}class Cse{constructor(e){this.parser=e,this.name=ln.KHR_MATERIALS_SPECULAR}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?rc:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.specularIntensity=void 0!==o.specularFactor?o.specularFactor:1,void 0!==o.specularTexture&&s.push(i.assignTexture(t,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return t.specularColor=(new We).setRGB(a[0],a[1],a[2],Tr),void 0!==o.specularColorTexture&&s.push(i.assignTexture(t,"specularColorMap",o.specularColorTexture,di)),Promise.all(s)}}class xse{constructor(e){this.parser=e,this.name=ln.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?rc:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.anisotropyStrength&&(t.anisotropy=o.anisotropyStrength),void 0!==o.anisotropyRotation&&(t.anisotropyRotation=o.anisotropyRotation),void 0!==o.anisotropyTexture&&s.push(i.assignTexture(t,"anisotropyMap",o.anisotropyTexture)),Promise.all(s)}}class Mse{constructor(e){this.parser=e,this.name=ln.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,i=t.json,r=i.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,o)}}class Tse{constructor(e){this.parser=e,this.name=ln.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let l=i.textureLoader;if(a.uri){const c=i.options.manager.getHandler(a.uri);null!==c&&(l=c)}return this.detectSupport().then(function(c){if(c)return i.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class Ase{constructor(e){this.parser=e,this.name=ln.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let l=i.textureLoader;if(a.uri){const c=i.options.manager.getHandler(a.uri);null!==c&&(l=c)}return this.detectSupport().then(function(c){if(c)return i.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class Dse{constructor(e){this.name=ln.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){const r=i.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(a){const h=r.count,d=r.byteStride,p=new Uint8Array(a,r.byteOffset||0,r.byteLength||0);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(h,d,p,r.mode,r.filter).then(function(m){return m.buffer}):o.ready.then(function(){const m=new ArrayBuffer(h*d);return o.decodeGltfBuffer(new Uint8Array(m),h,d,p,r.mode,r.filter),m})})}return null}}class Ise{constructor(e){this.name=ln.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,i=t.nodes[e];if(!i.extensions||!i.extensions[this.name]||void 0===i.mesh)return null;const r=t.meshes[i.mesh];for(const c of r.primitives)if(c.mode!==No.TRIANGLES&&c.mode!==No.TRIANGLE_STRIP&&c.mode!==No.TRIANGLE_FAN&&void 0!==c.mode)return null;const o=i.extensions[this.name].attributes,a=[],l={};for(const c in o)a.push(this.parser.getDependency("accessor",o[c]).then(h=>(l[c]=h,l[c])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(c=>{const h=c.pop(),d=h.isGroup?h.children:[h],p=c[0].count,m=[];for(const g of d){const v=new wt,w=new L,y=new Vn,b=new L(1,1,1),E=new dH(g.geometry,g.material,p);for(let C=0;C<p;C++)l.TRANSLATION&&w.fromBufferAttribute(l.TRANSLATION,C),l.ROTATION&&y.fromBufferAttribute(l.ROTATION,C),l.SCALE&&b.fromBufferAttribute(l.SCALE,C),E.setMatrixAt(C,v.compose(w,y,b));for(const C in l)"TRANSLATION"!==C&&"ROTATION"!==C&&"SCALE"!==C&&g.geometry.setAttribute(C,l[C]);fi.prototype.copy.call(E,g),this.parser.assignFinalMaterial(E),m.push(E)}return h.isGroup?(h.clear(),h.add(...m),h):m[0]}))}}const yz="glTF";class Rse{constructor(e){this.name=ln.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12),i=new TextDecoder;if(this.header={magic:i.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==yz)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-12,s=new DataView(e,12);let o=0;for(;o<r;){const a=s.getUint32(o,!0);o+=4;const l=s.getUint32(o,!0);if(o+=4,1313821514===l){const c=new Uint8Array(e,12+o,a);this.content=i.decode(c)}else if(5130562===l){const c=12+o;this.body=e.slice(c,c+a)}o+=a}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Pse{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=ln.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const i=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},l={},c={};for(const h in o){const d=hR[h]||h.toLowerCase();a[d]=o[h]}for(const h in e.attributes){const d=hR[h]||h.toLowerCase();if(void 0!==o[h]){const p=i.accessors[e.attributes[h]];c[d]=Om[p.componentType].name,l[d]=!0===p.normalized}}return t.getDependency("bufferView",s).then(function(h){return new Promise(function(d){r.decodeDracoFile(h,function(p){for(const m in p.attributes){const v=l[m];void 0!==v&&(p.attributes[m].normalized=v)}d(p)},a,c)})})}}class Nse{constructor(){this.name=ln.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(void 0===t.texCoord||t.texCoord===e.channel)&&void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.texCoord&&(e.channel=t.texCoord),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class Lse{constructor(){this.name=ln.KHR_MESH_QUANTIZATION}}class wz extends vv{constructor(e,t,i,r){super(e,t,i,r)}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let o=0;o!==r;o++)t[o]=i[s+o];return t}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=2*a,c=3*a,h=r-t,d=(i-t)/h,p=d*d,m=p*d,g=e*c,v=g-c,w=-2*m+3*p,y=m-p,b=1-w,E=y-p+d;for(let C=0;C!==a;C++)s[C]=b*o[v+C+a]+E*(o[v+C+l]*h)+w*o[g+C+a]+y*(o[g+C]*h);return s}}const Ose=new Vn;class Fse extends wz{interpolate_(e,t,i,r){const s=super.interpolate_(e,t,i,r);return Ose.fromArray(s).normalize().toArray(s),s}}const No={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Om={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},bz={9728:Li,9729:hi,9984:1004,9985:1007,9986:1005,9987:jl},Ez={33071:Gr,33648:1002,10497:Hh},uR={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},hR={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Cu={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},kse={CUBICSPLINE:void 0,LINEAR:jp,STEP:Ky};function dd(n,e,t){for(const i in t.extensions)void 0===n[i]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=t.extensions[i])}function xu(n,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(n.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function Vse(n,e){if(n.updateMorphTargets(),void 0!==e.weights)for(let t=0,i=e.weights.length;t<i;t++)n.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(n.morphTargetInfluences.length===t.length){n.morphTargetDictionary={};for(let i=0,r=t.length;i<r;i++)n.morphTargetDictionary[t[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Hse(n){let e;const t=n.extensions&&n.extensions[ln.KHR_DRACO_MESH_COMPRESSION];if(e=t?"draco:"+t.bufferView+":"+t.indices+":"+fR(t.attributes):n.indices+":"+fR(n.attributes)+":"+n.mode,void 0!==n.targets)for(let i=0,r=n.targets.length;i<r;i++)e+=":"+fR(n.targets[i]);return e}function fR(n){let e="";const t=Object.keys(n).sort();for(let i=0,r=t.length;i<r;i++)e+=t[i]+":"+n[t[i]]+";";return e}function pR(n){switch(n){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const Gse=new wt;class Wse{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new pse,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,r=!1,s=-1;typeof navigator<"u"&&(i=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),r=navigator.userAgent.indexOf("Firefox")>-1,s=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),this.textureLoader=typeof createImageBitmap>"u"||i||r&&s<98?new XI(this.options.manager):new $re(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Fs(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const i=this,r=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(o){const a={scene:o[0][r.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:r.asset,parser:i,userData:{}};return dd(s,a,r),xu(a,r),Promise.all(i._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){e(a)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){const o=t[r].joints;for(let a=0,l=o.length;a<l;a++)e[o[a]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const o=e[r];void 0!==o.mesh&&(this._addNodeRef(this.meshCache,o.mesh),void 0!==o.skin&&(i[o.mesh].isSkinnedMesh=!0)),void 0!==o.camera&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;const r=i.clone(),s=(o,a)=>{const l=this.associations.get(o);null!=l&&this.associations.set(a,l);for(const[c,h]of o.children.entries())s(h,a.children[c])};return s(i,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){const r=e(t[i]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const i=[];for(let r=0;r<t.length;r++){const s=e(t[r]);s&&i.push(s)}return i}getDependency(e,t){const i=e+":"+t;let r=this.cache.get(i);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!r)throw new Error("Unknown type: "+e)}this.cache.add(i,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const i=this;t=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map(function(s,o){return i.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],i=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[ln.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,o){i.load(Ev.resolveURL(t.uri,r.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(i){const s=t.byteOffset||0;return i.slice(s,s+(t.byteLength||0))})}loadAccessor(e){const t=this,i=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse){const o=uR[r.type],l=!0===r.normalized,c=new(0,Om[r.componentType])(r.count*o);return Promise.resolve(new Kn(c,o,l))}const s=[];return s.push(void 0!==r.bufferView?this.getDependency("bufferView",r.bufferView):null),void 0!==r.sparse&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(o){const a=o[0],l=uR[r.type],c=Om[r.componentType],h=c.BYTES_PER_ELEMENT,p=r.byteOffset||0,m=void 0!==r.bufferView?i.bufferViews[r.bufferView].byteStride:void 0,g=!0===r.normalized;let v,w;if(m&&m!==h*l){const y=Math.floor(p/m),b="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+y+":"+r.count;let E=t.cache.get(b);E||(v=new c(a,y*m,r.count*m/h),E=new wI(v,m/h),t.cache.add(b,E)),w=new td(E,l,p%m/h,g)}else v=null===a?new c(r.count*l):new c(a,p,r.count*l),w=new Kn(v,l,g);if(void 0!==r.sparse){const C=r.sparse.values.byteOffset||0,x=new(0,Om[r.sparse.indices.componentType])(o[1],r.sparse.indices.byteOffset||0,r.sparse.count*uR.SCALAR),A=new c(o[2],C,r.sparse.count*l);null!==a&&(w=new Kn(w.array.slice(),w.itemSize,w.normalized));for(let D=0,O=x.length;D<O;D++){const T=x[D];if(w.setX(T,A[D*l]),l>=2&&w.setY(T,A[D*l+1]),l>=3&&w.setZ(T,A[D*l+2]),l>=4&&w.setW(T,A[D*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return w})}loadTexture(e){const t=this.json,s=t.textures[e].source,o=t.images[s];let a=this.textureLoader;if(o.uri){const l=this.options.manager.getHandler(o.uri);null!==l&&(a=l)}return this.loadTextureImage(e,s,a)}loadTextureImage(e,t,i){const r=this,s=this.json,o=s.textures[e],a=s.images[t],l=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[l])return this.textureCache[l];const c=this.loadImageSource(t,i).then(function(h){h.flipY=!1,h.name=o.name||a.name||"",""===h.name&&"string"==typeof a.uri&&!1===a.uri.startsWith("data:image/")&&(h.name=a.uri);const p=(s.samplers||{})[o.sampler]||{};return h.magFilter=bz[p.magFilter]||hi,h.minFilter=bz[p.minFilter]||jl,h.wrapS=Ez[p.wrapS]||Hh,h.wrapT=Ez[p.wrapT]||Hh,r.associations.set(h,{textures:e}),h}).catch(function(){return null});return this.textureCache[l]=c,c}loadImageSource(e,t){const r=this.json,s=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(d=>d.clone());const o=r.images[e],a=self.URL||self.webkitURL;let l=o.uri||"",c=!1;if(void 0!==o.bufferView)l=this.getDependency("bufferView",o.bufferView).then(function(d){c=!0;const p=new Blob([d],{type:o.mimeType});return l=a.createObjectURL(p),l});else if(void 0===o.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const h=Promise.resolve(l).then(function(d){return new Promise(function(p,m){let g=p;!0===t.isImageBitmapLoader&&(g=function(v){const w=new Ro(v);w.needsUpdate=!0,p(w)}),t.load(Ev.resolveURL(d,s.path),g,void 0,m)})}).then(function(d){return!0===c&&a.revokeObjectURL(l),d.userData.mimeType=o.mimeType||function zse(n){return n.search(/\.jpe?g($|\?)/i)>0||0===n.search(/^data\:image\/jpeg/)?"image/jpeg":n.search(/\.webp($|\?)/i)>0||0===n.search(/^data\:image\/webp/)?"image/webp":"image/png"}(o.uri),d}).catch(function(d){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),d});return this.sourceCache[e]=h,h}assignTexture(e,t,i,r){const s=this;return this.getDependency("texture",i.index).then(function(o){if(!o)return null;if(void 0!==i.texCoord&&i.texCoord>0&&((o=o.clone()).channel=i.texCoord),s.extensions[ln.KHR_TEXTURE_TRANSFORM]){const a=void 0!==i.extensions?i.extensions[ln.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const l=s.associations.get(o);o=s.extensions[ln.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),s.associations.set(o,l)}}return void 0!==r&&(o.colorSpace=r),e[t]=o,o})}assignFinalMaterial(e){const t=e.geometry;let i=e.material;const r=void 0===t.attributes.tangent,s=void 0!==t.attributes.color,o=void 0===t.attributes.normal;if(e.isPoints){const a="PointsMaterial:"+i.uuid;let l=this.cache.get(a);l||(l=new nd,gs.prototype.copy.call(l,i),l.color.copy(i.color),l.map=i.map,l.sizeAttenuation=!1,this.cache.add(a,l)),i=l}else if(e.isLine){const a="LineBasicMaterial:"+i.uuid;let l=this.cache.get(a);l||(l=new gr,gs.prototype.copy.call(l,i),l.color.copy(i.color),l.map=i.map,this.cache.add(a,l)),i=l}if(r||s||o){let a="ClonedMaterial:"+i.uuid+":";r&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=i.clone(),s&&(l.vertexColors=!0),o&&(l.flatShading=!0),r&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(i))),i=l}e.material=i}getMaterialType(){return Dm}loadMaterial(e){const t=this,r=this.extensions,s=this.json.materials[e];let o;const a={},c=[];if((s.extensions||{})[ln.KHR_MATERIALS_UNLIT]){const d=r[ln.KHR_MATERIALS_UNLIT];o=d.getMaterialType(),c.push(d.extendParams(a,s,t))}else{const d=s.pbrMetallicRoughness||{};if(a.color=new We(1,1,1),a.opacity=1,Array.isArray(d.baseColorFactor)){const p=d.baseColorFactor;a.color.setRGB(p[0],p[1],p[2],Tr),a.opacity=p[3]}void 0!==d.baseColorTexture&&c.push(t.assignTexture(a,"map",d.baseColorTexture,di)),a.metalness=void 0!==d.metallicFactor?d.metallicFactor:1,a.roughness=void 0!==d.roughnessFactor?d.roughnessFactor:1,void 0!==d.metallicRoughnessTexture&&(c.push(t.assignTexture(a,"metalnessMap",d.metallicRoughnessTexture)),c.push(t.assignTexture(a,"roughnessMap",d.metallicRoughnessTexture))),o=this._invokeOne(function(p){return p.getMaterialType&&p.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(p){return p.extendMaterialParams&&p.extendMaterialParams(e,a)})))}!0===s.doubleSided&&(a.side=2);const h=s.alphaMode||"OPAQUE";if("BLEND"===h?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,"MASK"===h&&(a.alphaTest=void 0!==s.alphaCutoff?s.alphaCutoff:.5)),void 0!==s.normalTexture&&o!==bi&&(c.push(t.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new fe(1,1),void 0!==s.normalTexture.scale)){const d=s.normalTexture.scale;a.normalScale.set(d,d)}if(void 0!==s.occlusionTexture&&o!==bi&&(c.push(t.assignTexture(a,"aoMap",s.occlusionTexture)),void 0!==s.occlusionTexture.strength&&(a.aoMapIntensity=s.occlusionTexture.strength)),void 0!==s.emissiveFactor&&o!==bi){const d=s.emissiveFactor;a.emissive=(new We).setRGB(d[0],d[1],d[2],Tr)}return void 0!==s.emissiveTexture&&o!==bi&&c.push(t.assignTexture(a,"emissiveMap",s.emissiveTexture,di)),Promise.all(c).then(function(){const d=new o(a);return s.name&&(d.name=s.name),xu(d,s),t.associations.set(d,{materials:e}),s.extensions&&dd(r,d,s),d})}createUniqueName(e){const t=Zn.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,i=this.extensions,r=this.primitiveCache;function s(a){return i[ln.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(l){return Sz(l,a,t)})}const o=[];for(let a=0,l=e.length;a<l;a++){const c=e[a],h=Hse(c),d=r[h];if(d)o.push(d.promise);else{let p;p=c.extensions&&c.extensions[ln.KHR_DRACO_MESH_COMPRESSION]?s(c):Sz(new Rt,c,t),r[h]={primitive:c,promise:p},o.push(p)}}return Promise.all(o)}loadMesh(e){const t=this,r=this.extensions,s=this.json.meshes[e],o=s.primitives,a=[];for(let l=0,c=o.length;l<c;l++){const h=void 0===o[l].material?(void 0===(n=this.cache).DefaultMaterial&&(n.DefaultMaterial=new Dm({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:0})),n.DefaultMaterial):this.getDependency("material",o[l].material);a.push(h)}var n;return a.push(t.loadGeometries(o)),Promise.all(a).then(function(l){const c=l.slice(0,l.length-1),h=l[l.length-1],d=[];for(let m=0,g=h.length;m<g;m++){const v=h[m],w=o[m];let y;const b=c[m];if(w.mode===No.TRIANGLES||w.mode===No.TRIANGLE_STRIP||w.mode===No.TRIANGLE_FAN||void 0===w.mode)y=!0===s.isSkinnedMesh?new lH(v,b):new Me(v,b),!0===y.isSkinnedMesh&&y.normalizeSkinWeights(),w.mode===No.TRIANGLE_STRIP?y.geometry=gz(y.geometry,1):w.mode===No.TRIANGLE_FAN&&(y.geometry=gz(y.geometry,2));else if(w.mode===No.LINES)y=new xm(v,b);else if(w.mode===No.LINE_STRIP)y=new $r(v,b);else if(w.mode===No.LINE_LOOP)y=new yH(v,b);else{if(w.mode!==No.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+w.mode);y=new fv(v,b)}Object.keys(y.geometry.morphAttributes).length>0&&Vse(y,s),y.name=t.createUniqueName(s.name||"mesh_"+e),xu(y,s),w.extensions&&dd(r,y,w),t.assignFinalMaterial(y),d.push(y)}for(let m=0,g=d.length;m<g;m++)t.associations.set(d[m],{meshes:e,primitives:m});if(1===d.length)return s.extensions&&dd(r,d[0],s),d[0];const p=new Za;s.extensions&&dd(r,p,s),t.associations.set(p,{meshes:e});for(let m=0,g=d.length;m<g;m++)p.add(d[m]);return p})}loadCamera(e){let t;const i=this.json.cameras[e],r=i[i.type];if(r)return"perspective"===i.type?t=new ir(mu_radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===i.type&&(t=new AS(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),xu(t,i),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],i=[];for(let r=0,s=t.joints.length;r<s;r++)i.push(this._loadNodeShallow(t.joints[r]));return i.push(void 0!==t.inverseBindMatrices?this.getDependency("accessor",t.inverseBindMatrices):null),Promise.all(i).then(function(r){const s=r.pop(),o=r,a=[],l=[];for(let c=0,h=o.length;c<h;c++){const d=o[c];if(d){a.push(d);const p=new wt;null!==s&&p.fromArray(s.array,16*c),l.push(p)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[c])}return new kS(a,l)})}loadAnimation(e){const i=this,r=this.json.animations[e],s=r.name?r.name:"animation_"+e,o=[],a=[],l=[],c=[],h=[];for(let d=0,p=r.channels.length;d<p;d++){const m=r.channels[d],g=r.samplers[m.sampler],v=m.target,y=void 0!==r.parameters?r.parameters[g.input]:g.input,b=void 0!==r.parameters?r.parameters[g.output]:g.output;void 0!==v.node&&(o.push(this.getDependency("node",v.node)),a.push(this.getDependency("accessor",y)),l.push(this.getDependency("accessor",b)),c.push(g),h.push(v))}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l),Promise.all(c),Promise.all(h)]).then(function(d){const p=d[0],m=d[1],g=d[2],v=d[3],w=d[4],y=[];for(let b=0,E=p.length;b<E;b++){const C=p[b],x=m[b],A=g[b],D=v[b],O=w[b];if(void 0===C)continue;C.updateMatrix&&C.updateMatrix();const T=i._createAnimationTracks(C,x,A,D,O);if(T)for(let R=0;R<T.length;R++)y.push(T[R])}return new wv(s,void 0,y)})}createNodeMesh(e){const i=this,r=this.json.nodes[e];return void 0===r.mesh?null:i.getDependency("mesh",r.mesh).then(function(s){const o=i._getNodeRef(i.meshCache,r.mesh,s);return void 0!==r.weights&&o.traverse(function(a){if(a.isMesh)for(let l=0,c=r.weights.length;l<c;l++)a.morphTargetInfluences[l]=r.weights[l]}),o})}loadNode(e){const i=this,r=this.json.nodes[e],s=i._loadNodeShallow(e),o=[],a=r.children||[];for(let c=0,h=a.length;c<h;c++)o.push(i.getDependency("node",a[c]));const l=void 0===r.skin?Promise.resolve(null):i.getDependency("skin",r.skin);return Promise.all([s,Promise.all(o),l]).then(function(c){const h=c[0],d=c[1],p=c[2];null!==p&&h.traverse(function(m){m.isSkinnedMesh&&m.bind(p,Gse)});for(let m=0,g=d.length;m<g;m++)h.add(d[m]);return h})}_loadNodeShallow(e){const i=this.extensions,r=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];const s=this.json.nodes[e],o=s.name?r.createUniqueName(s.name):"",a=[],l=r._invokeOne(function(c){return c.createNodeMesh&&c.createNodeMesh(e)});return l&&a.push(l),void 0!==s.camera&&a.push(r.getDependency("camera",s.camera).then(function(c){return r._getNodeRef(r.cameraCache,s.camera,c)})),r._invokeAll(function(c){return c.createNodeAttachment&&c.createNodeAttachment(e)}).forEach(function(c){a.push(c)}),this.nodeCache[e]=Promise.all(a).then(function(c){let h;if(h=!0===s.isBone?new CI:c.length>1?new Za:1===c.length?c[0]:new fi,h!==c[0])for(let d=0,p=c.length;d<p;d++)h.add(c[d]);if(s.name&&(h.userData.name=s.name,h.name=o),xu(h,s),s.extensions&&dd(i,h,s),void 0!==s.matrix){const d=new wt;d.fromArray(s.matrix),h.applyMatrix4(d)}else void 0!==s.translation&&h.position.fromArray(s.translation),void 0!==s.rotation&&h.quaternion.fromArray(s.rotation),void 0!==s.scale&&h.scale.fromArray(s.scale);return r.associations.has(h)||r.associations.set(h,{}),r.associations.get(h).nodes=e,h}),this.nodeCache[e]}loadScene(e){const t=this.extensions,i=this.json.scenes[e],r=this,s=new Za;i.name&&(s.name=r.createUniqueName(i.name)),xu(s,i),i.extensions&&dd(t,s,i);const o=i.nodes||[],a=[];for(let l=0,c=o.length;l<c;l++)a.push(r.getDependency("node",o[l]));return Promise.all(a).then(function(l){for(let h=0,d=l.length;h<d;h++)s.add(l[h]);return r.associations=(h=>{const d=new Map;for(const[p,m]of r.associations)(p instanceof gs||p instanceof Ro)&&d.set(p,m);return h.traverse(p=>{const m=r.associations.get(p);null!=m&&d.set(p,m)}),d})(s),s})}_createAnimationTracks(e,t,i,r,s){const o=[],a=e.name?e.name:e.uuid,l=[];let c;switch(Cu[s.path]===Cu.weights?e.traverse(function(p){p.morphTargetInfluences&&l.push(p.name?p.name:p.uuid)}):l.push(a),Cu[s.path]){case Cu.weights:c=Rm;break;case Cu.rotation:c=od;break;case Cu.position:case Cu.scale:c=Nm;break;default:c=1===i.itemSize?Rm:Nm}const h=void 0!==r.interpolation?kse[r.interpolation]:jp,d=this._getArrayFromAccessor(i);for(let p=0,m=l.length;p<m;p++){const g=new c(l[p]+"."+Cu[s.path],t.array,d,h);"CUBICSPLINE"===r.interpolation&&this._createCubicSplineTrackInterpolant(g),o.push(g)}return o}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const i=pR(t.constructor),r=new Float32Array(t.length);for(let s=0,o=t.length;s<o;s++)r[s]=t[s]*i;t=r}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(i){return new(this instanceof od?Fse:wz)(this.times,this.values,this.getValueSize()/3,i)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function Sz(n,e,t){const i=e.attributes,r=[];function s(o,a){return t.getDependency("accessor",o).then(function(l){n.setAttribute(a,l)})}for(const o in i){const a=hR[o]||o.toLowerCase();a in n.attributes||r.push(s(i[o],a))}if(void 0!==e.indices&&!n.index){const o=t.getDependency("accessor",e.indices).then(function(a){n.setIndex(a)});r.push(o)}return Sn.workingColorSpace!==Tr&&"COLOR_0"in i&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${Sn.workingColorSpace}" not supported.`),xu(n,e),function jse(n,e,t){const i=e.attributes,r=new Ya;if(void 0===i.POSITION)return;{const a=t.json.accessors[i.POSITION],l=a.min,c=a.max;if(void 0===l||void 0===c)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(r.set(new L(l[0],l[1],l[2]),new L(c[0],c[1],c[2])),a.normalized){const h=pR(Om[a.componentType]);r.min.multiplyScalar(h),r.max.multiplyScalar(h)}}const s=e.targets;if(void 0!==s){const a=new L,l=new L;for(let c=0,h=s.length;c<h;c++){const d=s[c];if(void 0!==d.POSITION){const p=t.json.accessors[d.POSITION],m=p.min,g=p.max;if(void 0!==m&&void 0!==g){if(l.setX(Math.max(Math.abs(m[0]),Math.abs(g[0]))),l.setY(Math.max(Math.abs(m[1]),Math.abs(g[1]))),l.setZ(Math.max(Math.abs(m[2]),Math.abs(g[2]))),p.normalized){const v=pR(Om[p.componentType]);l.multiplyScalar(v)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(a)}n.boundingBox=r;const o=new da;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,n.boundingSphere=o}(n,e,t),Promise.all(r).then(function(){return void 0!==e.targets?function Bse(n,e,t){let i=!1,r=!1,s=!1;for(let c=0,h=e.length;c<h;c++){const d=e[c];if(void 0!==d.POSITION&&(i=!0),void 0!==d.NORMAL&&(r=!0),void 0!==d.COLOR_0&&(s=!0),i&&r&&s)break}if(!i&&!r&&!s)return Promise.resolve(n);const o=[],a=[],l=[];for(let c=0,h=e.length;c<h;c++){const d=e[c];if(i){const p=void 0!==d.POSITION?t.getDependency("accessor",d.POSITION):n.attributes.position;o.push(p)}if(r){const p=void 0!==d.NORMAL?t.getDependency("accessor",d.NORMAL):n.attributes.normal;a.push(p)}if(s){const p=void 0!==d.COLOR_0?t.getDependency("accessor",d.COLOR_0):n.attributes.color;l.push(p)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(c){const d=c[1],p=c[2];return i&&(n.morphAttributes.position=c[0]),r&&(n.morphAttributes.normal=d),s&&(n.morphAttributes.color=p),n.morphTargetsRelative=!0,n})}(n,e.targets,t):n})}var Cz=class{target;name;intersected;wasIntersected=!1;distance;constructor(n,e){this.target=n,this.name=e,this.intersected=!1,this.distance=0}},ks=class{type;cancelBubble;originalEvent;coords=new fe(0,0);distance=0;intersected=!1;constructor(n,e=null){this.cancelBubble=!1,this.type=n,this.originalEvent=e}stopPropagation(){this.cancelBubble=!0}},Fm=vd(990);class Cv{constructor(e,t,i){this.x=e,this.y=t,this.z=i}static FromJson(e){return new Cv(e.x,e.y,e.z)}}var n,km=Object.freeze({Linear:Object.freeze({None:function(n){return n},In:function(n){return this.None(n)},Out:function(n){return this.None(n)},InOut:function(n){return this.None(n)}}),Quadratic:Object.freeze({In:function(n){return n*n},Out:function(n){return n*(2-n)},InOut:function(n){return(n*=2)<1?.5*n*n:-.5*(--n*(n-2)-1)}}),Cubic:Object.freeze({In:function(n){return n*n*n},Out:function(n){return--n*n*n+1},InOut:function(n){return(n*=2)<1?.5*n*n*n:.5*((n-=2)*n*n+2)}}),Quartic:Object.freeze({In:function(n){return n*n*n*n},Out:function(n){return 1- --n*n*n*n},InOut:function(n){return(n*=2)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2)}}),Quintic:Object.freeze({In:function(n){return n*n*n*n*n},Out:function(n){return--n*n*n*n*n+1},InOut:function(n){return(n*=2)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2)}}),Sinusoidal:Object.freeze({In:function(n){return 1-Math.sin((1-n)*Math.PI/2)},Out:function(n){return Math.sin(n*Math.PI/2)},InOut:function(n){return.5*(1-Math.sin(Math.PI*(.5-n)))}}),Exponential:Object.freeze({In:function(n){return 0===n?0:Math.pow(1024,n-1)},Out:function(n){return 1===n?1:1-Math.pow(2,-10*n)},InOut:function(n){return 0===n?0:1===n?1:(n*=2)<1?.5*Math.pow(1024,n-1):.5*(2-Math.pow(2,-10*(n-1)))}}),Circular:Object.freeze({In:function(n){return 1-Math.sqrt(1-n*n)},Out:function(n){return Math.sqrt(1- --n*n)},InOut:function(n){return(n*=2)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1)}}),Elastic:Object.freeze({In:function(n){return 0===n?0:1===n?1:-Math.pow(2,10*(n-1))*Math.sin(5*(n-1.1)*Math.PI)},Out:function(n){return 0===n?0:1===n?1:Math.pow(2,-10*n)*Math.sin(5*(n-.1)*Math.PI)+1},InOut:function(n){return 0===n?0:1===n?1:(n*=2)<1?-.5*Math.pow(2,10*(n-1))*Math.sin(5*(n-1.1)*Math.PI):.5*Math.pow(2,-10*(n-1))*Math.sin(5*(n-1.1)*Math.PI)+1}}),Back:Object.freeze({In:function(n){var e=1.70158;return 1===n?1:n*n*((e+1)*n-e)},Out:function(n){var e=1.70158;return 0===n?0:--n*n*((e+1)*n+e)+1},InOut:function(n){var e=2.5949095;return(n*=2)<1?n*n*((e+1)*n-e)*.5:.5*((n-=2)*n*((e+1)*n+e)+2)}}),Bounce:Object.freeze({In:function(n){return 1-km.Bounce.Out(1-n)},Out:function(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},InOut:function(n){return n<.5?.5*km.Bounce.In(2*n):.5*km.Bounce.Out(2*n-1)+.5}}),generatePow:function(n){return void 0===n&&(n=4),n=(n=n<Number.EPSILON?Number.EPSILON:n)>1e4?1e4:n,{In:function(e){return Math.pow(e,n)},Out:function(e){return 1-Math.pow(1-e,n)},InOut:function(e){return e<.5?Math.pow(2*e,n)/2:(1-Math.pow(2-2*e,n))/2+.5}}}}),Um=function(){return performance.now()},xz=function(){function n(){this._tweens={},this._tweensAddedDuringUpdate={}}return n.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map(function(t){return e._tweens[t]})},n.prototype.removeAll=function(){this._tweens={}},n.prototype.add=function(e){this._tweens[e.getId()]=e,this._tweensAddedDuringUpdate[e.getId()]=e},n.prototype.remove=function(e){delete this._tweens[e.getId()],delete this._tweensAddedDuringUpdate[e.getId()]},n.prototype.update=function(e,t){void 0===e&&(e=Um()),void 0===t&&(t=!1);var i=Object.keys(this._tweens);if(0===i.length)return!1;for(;i.length>0;){this._tweensAddedDuringUpdate={};for(var r=0;r<i.length;r++){var s=this._tweens[i[r]];s&&!1===s.update(e,!t)&&!t&&delete this._tweens[i[r]]}i=Object.keys(this._tweensAddedDuringUpdate)}return!0},n}(),fd={Linear:function(n,e){var t=n.length-1,i=t*e,r=Math.floor(i),s=fd.Utils.Linear;return e<0?s(n[0],n[1],i):e>1?s(n[t],n[t-1],t-i):s(n[r],n[r+1>t?t:r+1],i-r)},Bezier:function(n,e){for(var t=0,i=n.length-1,r=Math.pow,s=fd.Utils.Bernstein,o=0;o<=i;o++)t+=r(1-e,i-o)*r(e,o)*n[o]*s(i,o);return t},CatmullRom:function(n,e){var t=n.length-1,i=t*e,r=Math.floor(i),s=fd.Utils.CatmullRom;return n[0]===n[t]?(e<0&&(r=Math.floor(i=t*(1+e))),s(n[(r-1+t)%t],n[r],n[(r+1)%t],n[(r+2)%t],i-r)):e<0?n[0]-(s(n[0],n[0],n[1],n[1],-i)-n[0]):e>1?n[t]-(s(n[t],n[t],n[t-1],n[t-1],i-t)-n[t]):s(n[r?r-1:0],n[r],n[t<r+1?t:r+1],n[t<r+2?t:r+2],i-r)},Utils:{Linear:function(n,e,t){return(e-n)*t+n},Bernstein:function(n,e){var t=fd.Utils.Factorial;return t(n)/t(e)/t(n-e)},Factorial:(n=[1],function(e){var t=1;if(n[e])return n[e];for(var i=e;i>1;i--)t*=i;return n[e]=t,t}),CatmullRom:function(n,e,t,i,r){var s=.5*(t-n),o=.5*(i-e),a=r*r;return(2*e-2*t+s+o)*(r*a)+(-3*e+3*t-2*s-o)*a+s*r+e}}},mR=function(){function n(){}return n.nextId=function(){return n._nextId++},n._nextId=0,n}(),gR=new xz,lC=function(){function n(e,t){void 0===t&&(t=gR),this._object=e,this._group=t,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=km.Linear.None,this._interpolationFunction=fd.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=mR.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1}return n.prototype.getId=function(){return this._id},n.prototype.isPlaying=function(){return this._isPlaying},n.prototype.isPaused=function(){return this._isPaused},n.prototype.to=function(e,t){if(void 0===t&&(t=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=t,this},n.prototype.duration=function(e){return void 0===e&&(e=1e3),this._duration=e,this},n.prototype.dynamic=function(e){return void 0===e&&(e=!1),this._isDynamic=e,this},n.prototype.start=function(e,t){if(void 0===e&&(e=Um()),void 0===t&&(t=!1),this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed)for(var i in this._reversed=!1,this._valuesStartRepeat)this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i];if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||t){if(this._propertiesAreSetUp=!0,!this._isDynamic){var r={};for(var s in this._valuesEnd)r[s]=this._valuesEnd[s];this._valuesEnd=r}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,t)}return this},n.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},n.prototype._setupProperties=function(e,t,i,r,s){for(var o in i){var a=e[o],l=Array.isArray(a),c=l?"array":typeof a,h=!l&&Array.isArray(i[o]);if("undefined"!==c&&"function"!==c){if(h){if(0===(d=i[o]).length)continue;for(var p=[a],m=0,g=d.length;m<g;m+=1){var v=this._handleRelativeValue(a,d[m]);if(isNaN(v)){h=!1,console.warn("Found invalid interpolation list. Skipping.");break}p.push(v)}h&&(i[o]=p)}if("object"!==c&&!l||!a||h)(typeof t[o]>"u"||s)&&(t[o]=a),l||(t[o]*=1),r[o]=h?i[o].slice().reverse():t[o]||0;else{t[o]=l?[]:{};var w=a;for(var y in w)t[o][y]=w[y];r[o]=l?[]:{};var d=i[o];if(!this._isDynamic){var b={};for(var y in d)b[y]=d[y];i[o]=d=b}this._setupProperties(w,t[o],d,r[o],s)}}}},n.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},n.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},n.prototype.pause=function(e){return void 0===e&&(e=Um()),this._isPaused||!this._isPlaying||(this._isPaused=!0,this._pauseStart=e,this._group&&this._group.remove(this)),this},n.prototype.resume=function(e){return void 0===e&&(e=Um()),this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this):this},n.prototype.stopChainedTweens=function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop();return this},n.prototype.group=function(e){return void 0===e&&(e=gR),this._group=e,this},n.prototype.delay=function(e){return void 0===e&&(e=0),this._delayTime=e,this},n.prototype.repeat=function(e){return void 0===e&&(e=0),this._initialRepeat=e,this._repeat=e,this},n.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},n.prototype.yoyo=function(e){return void 0===e&&(e=!1),this._yoyo=e,this},n.prototype.easing=function(e){return void 0===e&&(e=km.Linear.None),this._easingFunction=e,this},n.prototype.interpolation=function(e){return void 0===e&&(e=fd.Linear),this._interpolationFunction=e,this},n.prototype.chain=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._chainedTweens=e,this},n.prototype.onStart=function(e){return this._onStartCallback=e,this},n.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},n.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},n.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},n.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},n.prototype.onStop=function(e){return this._onStopCallback=e,this},n.prototype.update=function(e,t){if(void 0===e&&(e=Um()),void 0===t&&(t=!0),this._isPaused)return!0;var i,r;if(!this._goToEnd&&!this._isPlaying){if(e>this._startTime+this._duration)return!1;t&&this.start(e,!0)}if(this._goToEnd=!1,e<this._startTime)return!0;!1===this._onStartCallbackFired&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),!1===this._onEveryStartCallbackFired&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0),r=(e-this._startTime)/this._duration;var o=this._easingFunction(r=0===this._duration||r>1?1:r);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,o),this._onUpdateCallback&&this._onUpdateCallback(this._object,r),1===r){if(this._repeat>0){for(i in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat)!this._yoyo&&"string"==typeof this._valuesEnd[i]&&(this._valuesStartRepeat[i]=this._valuesStartRepeat[i]+parseFloat(this._valuesEnd[i])),this._yoyo&&this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i];return this._yoyo&&(this._reversed=!this._reversed),this._startTime=void 0!==this._repeatDelayTime?e+this._repeatDelayTime:e+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var a=0,l=this._chainedTweens.length;a<l;a++)this._chainedTweens[a].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},n.prototype._updateProperties=function(e,t,i,r){for(var s in i)if(void 0!==t[s]){var o=t[s]||0,a=i[s],l=Array.isArray(e[s]),c=Array.isArray(a);!l&&c?e[s]=this._interpolationFunction(a,r):"object"==typeof a&&a?this._updateProperties(e[s],o,a,r):"number"==typeof(a=this._handleRelativeValue(o,a))&&(e[s]=o+(a-o)*r)}},n.prototype._handleRelativeValue=function(e,t){return"string"!=typeof t?t:"+"===t.charAt(0)||"-"===t.charAt(0)?e+parseFloat(t):parseFloat(t)},n.prototype._swapEndStartRepeatValues=function(e){var t=this._valuesStartRepeat[e],i=this._valuesEnd[e];this._valuesStartRepeat[e]="string"==typeof i?this._valuesStartRepeat[e]+parseFloat(i):this._valuesEnd[e],this._valuesEnd[e]=t},n}(),el=gR,Mz=(el.getAll.bind(el),el.removeAll.bind(el),el.add.bind(el),el.remove.bind(el),el.update.bind(el));const Si={Handedness:Object.freeze({NONE:"none",LEFT:"left",RIGHT:"right"}),ComponentState:Object.freeze({DEFAULT:"default",TOUCHED:"touched",PRESSED:"pressed"}),ComponentProperty:Object.freeze({BUTTON:"button",X_AXIS:"xAxis",Y_AXIS:"yAxis",STATE:"state"}),ComponentType:Object.freeze({TRIGGER:"trigger",SQUEEZE:"squeeze",TOUCHPAD:"touchpad",THUMBSTICK:"thumbstick",BUTTON:"button"}),ButtonTouchThreshold:.05,AxisTouchThreshold:.1,VisualResponseProperty:Object.freeze({TRANSFORM:"transform",VISIBILITY:"visibility"})};function Tz(n){return _R.apply(this,arguments)}function _R(){return _R=Pn(function*(n){const e=yield fetch(n);if(e.ok)return e.json();throw new Error(e.statusText)}),_R.apply(this,arguments)}function yR(){return yR=Pn(function*(n){if(!n)throw new Error("No basePath supplied");return yield Tz(`${n}/profilesList.json`)}),yR.apply(this,arguments)}function vR(){return vR=Pn(function*(n,e,t=null,i=!0){if(!n)throw new Error("No xrInputSource supplied");if(!e)throw new Error("No basePath supplied");const r=yield function Qse(n){return yR.apply(this,arguments)}(e);let s;if(n.profiles.some(l=>{const c=r[l];return c&&(s={profileId:l,profilePath:`${e}/${c.path}`,deprecated:!!c.deprecated}),!!s}),!s){if(!t)throw new Error("No matching profile name found");const l=r[t];if(!l)throw new Error(`No matching profile name found and default profile "${t}" missing.`);s={profileId:t,profilePath:`${e}/${l.path}`,deprecated:!!l.deprecated}}const o=yield Tz(s.profilePath);let a;if(i){let l;if(l="any"===n.handedness?o.layouts[Object.keys(o.layouts)[0]]:o.layouts[n.handedness],!l)throw new Error(`No matching handedness, ${n.handedness}, in profile ${s.profileId}`);l.assetPath&&(a=s.profilePath.replace("profile.json",l.assetPath))}return{profile:o,assetPath:a}}),vR.apply(this,arguments)}const toe={xAxis:0,yAxis:0,button:0,state:Si.ComponentState.DEFAULT};class ioe{constructor(e){this.componentProperty=e.componentProperty,this.states=e.states,this.valueNodeName=e.valueNodeName,this.valueNodeProperty=e.valueNodeProperty,this.valueNodeProperty===Si.VisualResponseProperty.TRANSFORM&&(this.minNodeName=e.minNodeName,this.maxNodeName=e.maxNodeName),this.value=0,this.updateFromComponent(toe)}updateFromComponent({xAxis:e,yAxis:t,button:i,state:r}){const{normalizedXAxis:s,normalizedYAxis:o}=function noe(n=0,e=0){let t=n,i=e;if(Math.sqrt(n*n+e*e)>1){const o=Math.atan2(e,n);t=Math.cos(o),i=Math.sin(o)}return{normalizedXAxis:.5*t+.5,normalizedYAxis:.5*i+.5}}(e,t);switch(this.componentProperty){case Si.ComponentProperty.X_AXIS:this.value=this.states.includes(r)?s:.5;break;case Si.ComponentProperty.Y_AXIS:this.value=this.states.includes(r)?o:.5;break;case Si.ComponentProperty.BUTTON:this.value=this.states.includes(r)?i:0;break;case Si.ComponentProperty.STATE:this.value=this.valueNodeProperty===Si.VisualResponseProperty.VISIBILITY?this.states.includes(r):this.states.includes(r)?1:0;break;default:throw new Error(`Unexpected visualResponse componentProperty ${this.componentProperty}`)}}}class roe{constructor(e,t){if(!(e&&t&&t.visualResponses&&t.gamepadIndices&&0!==Object.keys(t.gamepadIndices).length))throw new Error("Invalid arguments supplied");this.id=e,this.type=t.type,this.rootNodeName=t.rootNodeName,this.touchPointNodeName=t.touchPointNodeName,this.visualResponses={},Object.keys(t.visualResponses).forEach(i=>{const r=new ioe(t.visualResponses[i]);this.visualResponses[i]=r}),this.gamepadIndices=Object.assign({},t.gamepadIndices),this.values={state:Si.ComponentState.DEFAULT,button:void 0!==this.gamepadIndices.button?0:void 0,xAxis:void 0!==this.gamepadIndices.xAxis?0:void 0,yAxis:void 0!==this.gamepadIndices.yAxis?0:void 0}}get data(){return{id:this.id,...this.values}}updateFromGamepad(e){if(this.values.state=Si.ComponentState.DEFAULT,void 0!==this.gamepadIndices.button&&e.buttons.length>this.gamepadIndices.button){const t=e.buttons[this.gamepadIndices.button];this.values.button=t.value,this.values.button=this.values.button<0?0:this.values.button,this.values.button=this.values.button>1?1:this.values.button,t.pressed||1===this.values.button?this.values.state=Si.ComponentState.PRESSED:(t.touched||this.values.button>Si.ButtonTouchThreshold)&&(this.values.state=Si.ComponentState.TOUCHED)}void 0!==this.gamepadIndices.xAxis&&e.axes.length>this.gamepadIndices.xAxis&&(this.values.xAxis=e.axes[this.gamepadIndices.xAxis],this.values.xAxis=this.values.xAxis<-1?-1:this.values.xAxis,this.values.xAxis=this.values.xAxis>1?1:this.values.xAxis,this.values.state===Si.ComponentState.DEFAULT&&Math.abs(this.values.xAxis)>Si.AxisTouchThreshold&&(this.values.state=Si.ComponentState.TOUCHED)),void 0!==this.gamepadIndices.yAxis&&e.axes.length>this.gamepadIndices.yAxis&&(this.values.yAxis=e.axes[this.gamepadIndices.yAxis],this.values.yAxis=this.values.yAxis<-1?-1:this.values.yAxis,this.values.yAxis=this.values.yAxis>1?1:this.values.yAxis,this.values.state===Si.ComponentState.DEFAULT&&Math.abs(this.values.yAxis)>Si.AxisTouchThreshold&&(this.values.state=Si.ComponentState.TOUCHED)),Object.values(this.visualResponses).forEach(t=>{t.updateFromComponent(this.values)})}}class soe{constructor(e,t,i){if(!e)throw new Error("No xrInputSource supplied");if(!t)throw new Error("No profile supplied");this.xrInputSource=e,this.assetUrl=i,this.id=t.profileId,this.layoutDescription=t.layouts[e.handedness],this.components={},Object.keys(this.layoutDescription.components).forEach(r=>{this.components[r]=new roe(r,this.layoutDescription.components[r])}),this.updateFromGamepad()}get gripSpace(){return this.xrInputSource.gripSpace}get targetRaySpace(){return this.xrInputSource.targetRaySpace}get data(){const e=[];return Object.values(this.components).forEach(t=>{e.push(t.data)}),e}updateFromGamepad(){Object.values(this.components).forEach(e=>{e.updateFromGamepad(this.xrInputSource.gamepad)})}}class loe extends fi{constructor(){super(),this.motionController=null,this.envMap=null}setEnvironmentMap(e){return this.envMap==e||(this.envMap=e,this.traverse(t=>{t.isMesh&&(t.material.envMap=this.envMap,t.material.needsUpdate=!0)})),this}updateMatrixWorld(e){super.updateMatrixWorld(e),this.motionController&&(this.motionController.updateFromGamepad(),Object.values(this.motionController.components).forEach(t=>{Object.values(t.visualResponses).forEach(i=>{const{valueNode:r,minNode:s,maxNode:o,value:a,valueNodeProperty:l}=i;r&&(l===Si.VisualResponseProperty.VISIBILITY?r.visible=a:l===Si.VisualResponseProperty.TRANSFORM&&(r.quaternion.slerpQuaternions(s.quaternion,o.quaternion,a),r.position.lerpVectors(s.position,o.position,a)))})}))}}function Az(n,e){(function coe(n,e){Object.values(n.components).forEach(t=>{const{type:i,touchPointNodeName:r,visualResponses:s}=t;if(i===Si.ComponentType.TOUCHPAD)if(t.touchPointNode=e.getObjectByName(r),t.touchPointNode){const o=new Am(.001),a=new bi({color:255}),l=new Me(o,a);t.touchPointNode.add(l)}else console.warn(`Could not find touch dot, ${t.touchPointNodeName}, in touchpad component ${t.id}`);Object.values(s).forEach(o=>{const{valueNodeName:a,minNodeName:l,maxNodeName:c,valueNodeProperty:h}=o;if(h===Si.VisualResponseProperty.TRANSFORM){if(o.minNode=e.getObjectByName(l),o.maxNode=e.getObjectByName(c),!o.minNode)return void console.warn(`Could not find ${l} in the model`);if(!o.maxNode)return void console.warn(`Could not find ${c} in the model`)}o.valueNode=e.getObjectByName(a),o.valueNode||console.warn(`Could not find ${a} in the model`)})})})(n.motionController,e),n.envMap&&e.traverse(t=>{t.isMesh&&(t.material.envMap=n.envMap,t.material.needsUpdate=!0)}),n.add(e)}class uoe{constructor(e=null){this.gltfLoader=e,this.path="https://cdn.jsdelivr.net/npm/@webxr-input-profiles/assets@1.0/dist/profiles",this._assetCache={},this.gltfLoader||(this.gltfLoader=new _z)}createControllerModel(e){const t=new loe;let i=null;return e.addEventListener("connected",r=>{const s=r.data;"tracked-pointer"!==s.targetRayMode||!s.gamepad||function eoe(n,e){return vR.apply(this,arguments)}(s,this.path,"generic-trigger").then(({profile:o,assetPath:a})=>{t.motionController=new soe(s,o,a);const l=this._assetCache[t.motionController.assetUrl];if(l)i=l.scene.clone(),Az(t,i);else{if(!this.gltfLoader)throw new Error("GLTFLoader not set.");this.gltfLoader.setPath(""),this.gltfLoader.load(t.motionController.assetUrl,c=>{this._assetCache[t.motionController.assetUrl]=c,i=c.scene.clone(),Az(t,i)},null,()=>{throw new Error(`Asset ${t.motionController.assetUrl} missing or malformed.`)})}}).catch(o=>{console.warn(o)})}),e.addEventListener("disconnected",()=>{t.motionController=null,t.remove(i),i=null}),t}}let cC=(()=>{class n{constructor(){this.destroy$=new Jr,this.takeUntilDestroy=t=>t.pipe(r3(this.destroy$))}ngOnDestroy(){console.log("UnsubscriberService","ngOnDestroy"),this.destroy$.next(),this.destroy$.complete()}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Je({token:n,factory:n.\u0275fac})}return n})();class hoe extends PS{constructor(e=null){super();const t=new oi;t.deleteAttribute("uv");const i=new Dm({side:1}),r=new Dm;let s=5;null!==e&&!1===e._useLegacyLights&&(s=900);const o=new QI(16777215,s,28,2);o.position.set(.418,16.199,.3),this.add(o);const a=new Me(t,i);a.position.set(-.757,13.219,.717),a.scale.set(31.713,28.305,28.591),this.add(a);const l=new Me(t,r);l.position.set(-10.906,2.009,1.846),l.rotation.set(0,-.195,0),l.scale.set(2.328,7.905,4.651),this.add(l);const c=new Me(t,r);c.position.set(-5.607,-.754,-.758),c.rotation.set(0,.994,0),c.scale.set(1.97,1.534,3.955),this.add(c);const h=new Me(t,r);h.position.set(6.167,.857,7.803),h.rotation.set(0,.561,0),h.scale.set(3.927,6.285,3.687),this.add(h);const d=new Me(t,r);d.position.set(-2.017,.018,6.124),d.rotation.set(0,.333,0),d.scale.set(2.002,4.566,2.064),this.add(d);const p=new Me(t,r);p.position.set(2.291,-.756,-2.621),p.rotation.set(0,-.286,0),p.scale.set(1.546,1.552,1.496),this.add(p);const m=new Me(t,r);m.position.set(-2.193,-.369,-5.547),m.rotation.set(0,.516,0),m.scale.set(3.875,3.487,2.986),this.add(m);const g=new Me(t,Bm(50));g.position.set(-16.116,14.37,8.208),g.scale.set(.1,2.428,2.739),this.add(g);const v=new Me(t,Bm(50));v.position.set(-16.109,18.021,-8.207),v.scale.set(.1,2.425,2.751),this.add(v);const w=new Me(t,Bm(17));w.position.set(14.904,12.198,-1.832),w.scale.set(.15,4.265,6.331),this.add(w);const y=new Me(t,Bm(43));y.position.set(-.462,8.89,14.52),y.scale.set(4.38,5.441,.088),this.add(y);const b=new Me(t,Bm(20));b.position.set(3.235,11.486,-12.541),b.scale.set(2.5,2,.1),this.add(b);const E=new Me(t,Bm(100));E.position.set(0,20,0),E.scale.set(1,.1,1),this.add(E)}dispose(){const e=new Set;this.traverse(t=>{t.isMesh&&(e.add(t.geometry),e.add(t.material))});for(const t of e)t.dispose()}}function Bm(n){const e=new bi;return e.color.setScalar(n),e}class doe extends sc{constructor(e){super(e)}load(e,t,i,r){const s=this,o=new Fs(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{t(s.parse(a))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}parse(e){function i(c,h,d){for(let p=0,m=c.length;p<m;p++)if(c[p]!==h.getUint8(d+p))return!1;return!0}const l=function a(c){if("string"==typeof c){const h=new Uint8Array(c.length);for(let d=0;d<c.length;d++)h[d]=255&c.charCodeAt(d);return h.buffer||h}return c}(e);return function t(c){const h=new DataView(c);if(84+50*h.getUint32(80,!0)===h.byteLength)return!0;const g=[115,111,108,105,100];for(let v=0;v<5;v++)if(i(g,h,v))return!1;return!0}(l)?function r(c){const h=new DataView(c),d=h.getUint32(80,!0);let p,m,g,w,y,b,E,C,v=!1;for(let $=0;$<70;$++)1129270351==h.getUint32($,!1)&&82==h.getUint8($+4)&&61==h.getUint8($+5)&&(v=!0,w=new Float32Array(3*d*3),y=h.getUint8($+6)/255,b=h.getUint8($+7)/255,E=h.getUint8($+8)/255,C=h.getUint8($+9)/255);const D=new Rt,O=new Float32Array(3*d*3),T=new Float32Array(3*d*3),R=new We;for(let $=0;$<d;$++){const ee=84+50*$,se=h.getFloat32(ee,!0),V=h.getFloat32(ee+4,!0),J=h.getFloat32(ee+8,!0);if(v){const G=h.getUint16(ee+48,!0);32768&G?(p=y,m=b,g=E):(p=(31&G)/31,m=(G>>5&31)/31,g=(G>>10&31)/31)}for(let G=1;G<=3;G++){const X=ee+12*G,Q=3*$*3+3*(G-1);O[Q]=h.getFloat32(X,!0),O[Q+1]=h.getFloat32(X+4,!0),O[Q+2]=h.getFloat32(X+8,!0),T[Q]=se,T[Q+1]=V,T[Q+2]=J,v&&(R.set(p,m,g).convertSRGBToLinear(),w[Q]=R.r,w[Q+1]=R.g,w[Q+2]=R.b)}}return D.setAttribute("position",new Kn(O,3)),D.setAttribute("normal",new Kn(T,3)),v&&(D.setAttribute("color",new Kn(w,3)),D.hasColors=!0,D.alpha=C),D}(l):function s(c){const h=new Rt,d=/solid([\s\S]*?)endsolid/g,p=/facet([\s\S]*?)endfacet/g,m=/solid\s(.+)/;let g=0;const v=/[\s]+([+-]?(?:\d*)(?:\.\d*)?(?:[eE][+-]?\d+)?)/.source,w=new RegExp("vertex"+v+v+v,"g"),y=new RegExp("normal"+v+v+v,"g"),b=[],E=[],C=[],x=new L;let A,D=0,O=0,T=0;for(;null!==(A=d.exec(c));){O=T;const R=A[0],$=null!==(A=m.exec(R))?A[1]:"";for(C.push($);null!==(A=p.exec(R));){let V=0,J=0;const G=A[0];for(;null!==(A=y.exec(G));)x.x=parseFloat(A[1]),x.y=parseFloat(A[2]),x.z=parseFloat(A[3]),J++;for(;null!==(A=w.exec(G));)b.push(parseFloat(A[1]),parseFloat(A[2]),parseFloat(A[3])),E.push(x.x,x.y,x.z),V++,T++;1!==J&&console.error("THREE.STLLoader: Something isn't right with the normal of face number "+g),3!==V&&console.error("THREE.STLLoader: Something isn't right with the vertices of face number "+g),g++}const ee=O,se=T-O;h.userData.groupNames=C,h.addGroup(ee,se,D),D++}return h.setAttribute("position",new Ke(b,3)),h.setAttribute("normal",new Ke(E,3)),h}(function o(c){return"string"!=typeof c?(new TextDecoder).decode(c):c}(e))}}const foe=/^[og]\s*(.+)?/,poe=/^mtllib /,moe=/^usemtl /,goe=/^usemap /,Dz=/\s+/,Iz=new L,wR=new L,Rz=new L,Pz=new L,Lo=new L,uC=new We;function _oe(){const n={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(e,t){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=e,void(this.object.fromDeclaration=!1!==t);const i=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:!1!==t,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(r,s){const o=this._finalize(!1);o&&(o.inherited||o.groupCount<=0)&&this.materials.splice(o.index,1);const a={index:this.materials.length,name:r||"",mtllib:Array.isArray(s)&&s.length>0?s[s.length-1]:"",smooth:void 0!==o?o.smooth:this.smooth,groupStart:void 0!==o?o.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(l){const c={index:"number"==typeof l?l:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return c.clone=this.clone.bind(c),c}};return this.materials.push(a),a},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(r){const s=this.currentMaterial();if(s&&-1===s.groupEnd&&(s.groupEnd=this.geometry.vertices.length/3,s.groupCount=s.groupEnd-s.groupStart,s.inherited=!1),r&&this.materials.length>1)for(let o=this.materials.length-1;o>=0;o--)this.materials[o].groupCount<=0&&this.materials.splice(o,1);return r&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),s}},i&&i.name&&"function"==typeof i.clone){const r=i.clone(0);r.inherited=!0,this.object.materials.push(r)}this.objects.push(this.object)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(e,t){const i=parseInt(e,10);return 3*(i>=0?i-1:i+t/3)},parseNormalIndex:function(e,t){const i=parseInt(e,10);return 3*(i>=0?i-1:i+t/3)},parseUVIndex:function(e,t){const i=parseInt(e,10);return 2*(i>=0?i-1:i+t/2)},addVertex:function(e,t,i){const r=this.vertices,s=this.object.geometry.vertices;s.push(r[e+0],r[e+1],r[e+2]),s.push(r[t+0],r[t+1],r[t+2]),s.push(r[i+0],r[i+1],r[i+2])},addVertexPoint:function(e){const t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){const t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,i){const r=this.normals,s=this.object.geometry.normals;s.push(r[e+0],r[e+1],r[e+2]),s.push(r[t+0],r[t+1],r[t+2]),s.push(r[i+0],r[i+1],r[i+2])},addFaceNormal:function(e,t,i){const r=this.vertices,s=this.object.geometry.normals;Iz.fromArray(r,e),wR.fromArray(r,t),Rz.fromArray(r,i),Lo.subVectors(Rz,wR),Pz.subVectors(Iz,wR),Lo.cross(Pz),Lo.normalize(),s.push(Lo.x,Lo.y,Lo.z),s.push(Lo.x,Lo.y,Lo.z),s.push(Lo.x,Lo.y,Lo.z)},addColor:function(e,t,i){const r=this.colors,s=this.object.geometry.colors;void 0!==r[e]&&s.push(r[e+0],r[e+1],r[e+2]),void 0!==r[t]&&s.push(r[t+0],r[t+1],r[t+2]),void 0!==r[i]&&s.push(r[i+0],r[i+1],r[i+2])},addUV:function(e,t,i){const r=this.uvs,s=this.object.geometry.uvs;s.push(r[e+0],r[e+1]),s.push(r[t+0],r[t+1]),s.push(r[i+0],r[i+1])},addDefaultUV:function(){const e=this.object.geometry.uvs;e.push(0,0),e.push(0,0),e.push(0,0)},addUVLine:function(e){const t=this.uvs;this.object.geometry.uvs.push(t[e+0],t[e+1])},addFace:function(e,t,i,r,s,o,a,l,c){const h=this.vertices.length;let d=this.parseVertexIndex(e,h),p=this.parseVertexIndex(t,h),m=this.parseVertexIndex(i,h);if(this.addVertex(d,p,m),this.addColor(d,p,m),void 0!==a&&""!==a){const g=this.normals.length;d=this.parseNormalIndex(a,g),p=this.parseNormalIndex(l,g),m=this.parseNormalIndex(c,g),this.addNormal(d,p,m)}else this.addFaceNormal(d,p,m);if(void 0!==r&&""!==r){const g=this.uvs.length;d=this.parseUVIndex(r,g),p=this.parseUVIndex(s,g),m=this.parseUVIndex(o,g),this.addUV(d,p,m),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(e){this.object.geometry.type="Points";const t=this.vertices.length;for(let i=0,r=e.length;i<r;i++){const s=this.parseVertexIndex(e[i],t);this.addVertexPoint(s),this.addColor(s)}},addLineGeometry:function(e,t){this.object.geometry.type="Line";const i=this.vertices.length,r=this.uvs.length;for(let s=0,o=e.length;s<o;s++)this.addVertexLine(this.parseVertexIndex(e[s],i));for(let s=0,o=t.length;s<o;s++)this.addUVLine(this.parseUVIndex(t[s],r))}};return n.startObject("",!1),n}class yoe extends sc{constructor(e){super(e),this.materials=null}load(e,t,i,r){const s=this,o=new Fs(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{t(s.parse(a))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}setMaterials(e){return this.materials=e,this}parse(e){const t=new _oe;-1!==e.indexOf("\r\n")&&(e=e.replace(/\r\n/g,"\n")),-1!==e.indexOf("\\\n")&&(e=e.replace(/\\\n/g,""));const i=e.split("\n");let r=[];for(let a=0,l=i.length;a<l;a++){const c=i[a].trimStart();if(0===c.length)continue;const h=c.charAt(0);if("#"!==h)if("v"===h){const d=c.split(Dz);switch(d[0]){case"v":t.vertices.push(parseFloat(d[1]),parseFloat(d[2]),parseFloat(d[3])),d.length>=7?(uC.setRGB(parseFloat(d[4]),parseFloat(d[5]),parseFloat(d[6])).convertSRGBToLinear(),t.colors.push(uC.r,uC.g,uC.b)):t.colors.push(void 0,void 0,void 0);break;case"vn":t.normals.push(parseFloat(d[1]),parseFloat(d[2]),parseFloat(d[3]));break;case"vt":t.uvs.push(parseFloat(d[1]),parseFloat(d[2]))}}else if("f"===h){const p=c.slice(1).trim().split(Dz),m=[];for(let v=0,w=p.length;v<w;v++){const y=p[v];if(y.length>0){const b=y.split("/");m.push(b)}}const g=m[0];for(let v=1,w=m.length-1;v<w;v++){const y=m[v],b=m[v+1];t.addFace(g[0],y[0],b[0],g[1],y[1],b[1],g[2],y[2],b[2])}}else if("l"===h){const d=c.substring(1).trim().split(" ");let p=[];const m=[];if(-1===c.indexOf("/"))p=d;else for(let g=0,v=d.length;g<v;g++){const w=d[g].split("/");""!==w[0]&&p.push(w[0]),""!==w[1]&&m.push(w[1])}t.addLineGeometry(p,m)}else if("p"===h){const p=c.slice(1).trim().split(" ");t.addPointGeometry(p)}else if(null!==(r=foe.exec(c))){const d=(" "+r[0].slice(1).trim()).slice(1);t.startObject(d)}else if(moe.test(c))t.object.startMaterial(c.substring(7).trim(),t.materialLibraries);else if(poe.test(c))t.materialLibraries.push(c.substring(7).trim());else if(goe.test(c))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if("s"===h){if(r=c.split(" "),r.length>1){const p=r[1].trim().toLowerCase();t.object.smooth="0"!==p&&"off"!==p}else t.object.smooth=!0;const d=t.object.currentMaterial();d&&(d.smooth=t.object.smooth)}else{if("\0"===c)continue;console.warn('THREE.OBJLoader: Unexpected line: "'+c+'"')}}t.finalize();const s=new Za;if(s.materialLibraries=[].concat(t.materialLibraries),1==!(1===t.objects.length&&0===t.objects[0].geometry.vertices.length))for(let a=0,l=t.objects.length;a<l;a++){const c=t.objects[a],h=c.geometry,d=c.materials,p="Line"===h.type,m="Points"===h.type;let g=!1;if(0===h.vertices.length)continue;const v=new Rt;v.setAttribute("position",new Ke(h.vertices,3)),h.normals.length>0&&v.setAttribute("normal",new Ke(h.normals,3)),h.colors.length>0&&(g=!0,v.setAttribute("color",new Ke(h.colors,3))),!0===h.hasUVIndices&&v.setAttribute("uv",new Ke(h.uvs,2));const w=[];for(let b=0,E=d.length;b<E;b++){const C=d[b],x=C.name+"_"+C.smooth+"_"+g;let A=t.materials[x];if(null!==this.materials)if(A=this.materials.create(C.name),!p||!A||A instanceof gr){if(m&&A&&!(A instanceof nd)){const D=new nd({size:10,sizeAttenuation:!1});gs.prototype.copy.call(D,A),D.color.copy(A.color),D.map=A.map,A=D}}else{const D=new gr;gs.prototype.copy.call(D,A),D.color.copy(A.color),A=D}void 0===A&&(A=p?new gr:m?new nd({size:1,sizeAttenuation:!1}):new jI,A.name=C.name,A.flatShading=!C.smooth,A.vertexColors=g,t.materials[x]=A),w.push(A)}let y;if(w.length>1){for(let b=0,E=d.length;b<E;b++){const C=d[b];v.addGroup(C.groupStart,C.groupCount,b)}y=p?new xm(v,w):m?new fv(v,w):new Me(v,w)}else y=p?new xm(v,w[0]):m?new fv(v,w[0]):new Me(v,w[0]);y.name=c.name,s.add(y)}else if(t.vertices.length>0){const a=new nd({size:1,sizeAttenuation:!1}),l=new Rt;l.setAttribute("position",new Ke(t.vertices,3)),t.colors.length>0&&void 0!==t.colors[0]&&(l.setAttribute("color",new Ke(t.colors,3)),a.vertexColors=!0);const c=new fv(l,a);s.add(c)}return s}}class voe extends sc{constructor(e){super(e)}load(e,t,i,r){const s=this,o=new Fs(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){const l=s.parse(JSON.parse(a));t&&t(l)},i,r)}parse(e){return new woe(e)}}class woe{constructor(e){this.isFont=!0,this.type="Font",this.data=e}generateShapes(e,t=100){const i=[],r=function boe(n,e,t){const i=Array.from(n),r=e/t.resolution,s=(t.boundingBox.yMax-t.boundingBox.yMin+t.underlineThickness)*r,o=[];let a=0,l=0;for(let c=0;c<i.length;c++){const h=i[c];if("\n"===h)a=0,l-=s;else{const d=Eoe(h,r,a,l,t);a+=d.offsetX,o.push(d.path)}}return o}(e,t,this.data);for(let s=0,o=r.length;s<o;s++)i.push(...r[s].toShapes());return i}}function Eoe(n,e,t,i,r){const s=r.glyphs[n]||r.glyphs["?"];if(!s)return void console.error('THREE.Font: character "'+n+'" does not exists in font family '+r.familyName+".");const o=new hse;let a,l,c,h,d,p,m,g;if(s.o){const v=s._cachedOutline||(s._cachedOutline=s.o.split(" "));for(let w=0,y=v.length;w<y;)switch(v[w++]){case"m":a=v[w++]*e+t,l=v[w++]*e+i,o.moveTo(a,l);break;case"l":a=v[w++]*e+t,l=v[w++]*e+i,o.lineTo(a,l);break;case"q":c=v[w++]*e+t,h=v[w++]*e+i,d=v[w++]*e+t,p=v[w++]*e+i,o.quadraticCurveTo(d,p,c,h);break;case"b":c=v[w++]*e+t,h=v[w++]*e+i,d=v[w++]*e+t,p=v[w++]*e+i,m=v[w++]*e+t,g=v[w++]*e+i,o.bezierCurveTo(d,p,m,g,c,h)}}return{offsetX:s.ha*e,path:o}}class Soe extends JS{constructor(e,t={}){const i=t.font;if(void 0===i)super();else{const r=i.generateShapes(e,t.size);t.depth=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),super(r,t)}this.type="TextGeometry"}}var Ar={d:(n,e)=>{for(var t in e)Ar.o(e,t)&&!Ar.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})},o:(n,e)=>Object.prototype.hasOwnProperty.call(n,e),r:n=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})}},oo={};Ar.d(oo,{g1:()=>dC,gO:()=>Dv,km:()=>hC,zV:()=>Tv,ol:()=>VR,uM:()=>fC,N1:()=>sG,xv:()=>BR,PH:()=>mC,UH:()=>pC,ZP:()=>Zoe,Vx:()=>oG});var hC={};Ar.r(hC),Ar.d(hC,{COLUMN:()=>gC,COLUMN_REVERSE:()=>Lz,ROW:()=>xv,ROW_REVERSE:()=>Nz,contentDirection:()=>Oz});var dC={};Ar.r(dC),Ar.d(dC,{CENTER:()=>ER,END:()=>SR,START:()=>bR,STRETCH:()=>Fz,alignItems:()=>kz,warnAboutDeprecatedAlignItems:()=>Uz});var fC={};Ar.r(fC),Ar.d(fC,{CENTER:()=>xR,END:()=>MR,SPACE_AROUND:()=>TR,SPACE_BETWEEN:()=>AR,SPACE_EVENLY:()=>DR,START:()=>CR,justifyContent:()=>Bz});var pC={};Ar.r(pC),Ar.d(pC,{NORMAL:()=>Mv,NOWRAP:()=>Vm,PRE:()=>_C,PRE_LINE:()=>Hm,PRE_WRAP:()=>yC,WHITE_CHARS:()=>RR,collapseWhitespaceOnInlines:()=>Gz,collapseWhitespaceOnString:()=>Vz,newlineBreakability:()=>Hz,shouldBreak:()=>zz});var mC={};Ar.r(mC),Ar.d(mC,{CENTER:()=>PR,JUSTIFY:()=>NR,JUSTIFY_CENTER:()=>Kz,JUSTIFY_LEFT:()=>Yz,JUSTIFY_RIGHT:()=>vC,LEFT:()=>qz,RIGHT:()=>Xz,textAlign:()=>Zz});const rn=(n=>{var e={};return Ar.d(e,n),e})({BufferAttribute:()=>Kn,BufferGeometry:()=>Rt,CanvasTexture:()=>Uie,Color:()=>We,FileLoader:()=>Fs,LinearFilter:()=>hi,Mesh:()=>Me,Object3D:()=>fi,Plane:()=>nc,PlaneGeometry:()=>mm,ShaderMaterial:()=>tc,TextureLoader:()=>XI,Vector2:()=>fe,Vector3:()=>L}),xv="row",Nz="row-reverse",gC="column",Lz="column-reverse";function Oz(n,e,t,i){let r=t,s="getWidth",o="x",a="y";0===e.indexOf(gC)&&(s="getHeight",o="y",a="x");for(let l=0;l<n.childrenBoxes.length;l++){const c=n.childrenBoxes[l],h=c.id,d=c[s](),p=c.margin||0;r+=p*i,n.childrenPos[h]={[o]:r+d/2*i,[a]:0},r+=i*(d+p)}}const bR="start",ER="center",SR="end",Fz="stretch";function kz(n,e){const t=n.getAlignItems();-1===xoe.indexOf(t)&&console.warn(`alignItems === '${t}' is not supported`);let i="getWidth",r="x";0===e.indexOf(xv)&&(i="getHeight",r="y");const s=n[i]()/2-(n.padding||0);n.childrenBoxes.forEach(o=>{let a;switch(t){case SR:case"right":case"bottom":a=0===e.indexOf(xv)?-s+o[i]()/2+(o.margin||0):s-o[i]()/2-(o.margin||0);break;case bR:case"left":case"top":a=0===e.indexOf(xv)?s-o[i]()/2-(o.margin||0):-s+o[i]()/2+(o.margin||0)}n.childrenPos[o.id][r]=a||0})}function Uz(n){-1!==Moe.indexOf(n)&&console.warn(`alignItems === '${n}' is deprecated and will be remove in 7.x.x. Fallback are 'start'|'end'`)}const xoe=[bR,ER,SR,Fz,"top","right","bottom","left"],Moe=["top","right","bottom","left"],CR="start",xR="center",MR="end",TR="space-around",AR="space-between",DR="space-evenly";function Bz(n,e,t,i){const r=n.getJustifyContent();-1===Toe.indexOf(r)&&console.warn(`justifyContent === '${r}' is not supported`);const s=0===e.indexOf("row")?"width":"height",o=n.getChildrenSideSum(s),l=("width"===s?n.getInnerWidth():n.getInnerHeight())-o,h=function Aoe(n,e){switch(n){case MR:return e;case xR:return e/2}return 0}(r,2*t-o*Math.sign(t)),d=function Doe(n,e,t,i){const r=Array(n.length).fill(0);if(e>0)switch(t){case AR:if(n.length>1){const s=e/(n.length-1)*i;r[0]=0;for(let o=1;o<n.length;o++)r[o]=s*o}break;case DR:if(n.length>1){const s=e/(n.length+1)*i;for(let o=0;o<n.length;o++)r[o]=s*(o+1)}break;case TR:if(n.length>1){const s=e/n.length*i,o=s/2;r[0]=o;for(let a=1;a<n.length;a++)r[a]=o+s*a}}return r}(n.childrenBoxes,l,r,i),p=0===e.indexOf("row")?"x":"y";n.childrenBoxes.forEach((m,g)=>{n.childrenPos[m.id][p]-=h-d[g]})}const Toe=[CR,xR,MR,TR,AR,DR];function IR(n){return class extends n{constructor(t){super(t),this.isBoxComponent=!0,this.childrenPos={}}getInnerWidth(){const t=this.getContentDirection();switch(t){case"row":case"row-reverse":return this.width-(2*this.padding||0)||this.getChildrenSideSum("width");case"column":case"column-reverse":return this.getHighestChildSizeOn("width");default:console.error(`Invalid contentDirection : ${t}`)}}getInnerHeight(){const t=this.getContentDirection();switch(t){case"row":case"row-reverse":return this.getHighestChildSizeOn("height");case"column":case"column-reverse":return this.height-(2*this.padding||0)||this.getChildrenSideSum("height");default:console.error(`Invalid contentDirection : ${t}`)}}getChildrenSideSum(t){return this.childrenBoxes.reduce((i,r)=>{const s=2*r.margin||0;return i+("width"===t?r.getWidth()+s:r.getHeight()+s)},0)}setPosFromParentRecords(){this.parentUI&&this.parentUI.childrenPos[this.id]&&(this.position.x=this.parentUI.childrenPos[this.id].x,this.position.y=this.parentUI.childrenPos[this.id].y)}computeChildrenPosition(){if(this.children.length>0){const t=this.getContentDirection();let i;switch(t){case xv:i=-this.getInnerWidth()/2;break;case Nz:i=this.getInnerWidth()/2;break;case gC:i=this.getInnerHeight()/2;break;case Lz:i=-this.getInnerHeight()/2}const r=-Math.sign(i);Oz(this,t,i,r),Bz(this,t,i,r),kz(this,t)}}getHighestChildSizeOn(t){return this.childrenBoxes.reduce((i,r)=>{const s=r.margin||0,o="width"===t?r.getWidth()+2*s:r.getHeight()+2*s;return Math.max(i,o)},0)}getWidth(){return this.parentUI&&"stretch"===this.parentUI.getAlignItems()&&-1!==this.parentUI.getContentDirection().indexOf("column")?this.parentUI.getWidth()-(2*this.parentUI.padding||0):this.width||this.getInnerWidth()+(2*this.padding||0)}getHeight(){return this.parentUI&&"stretch"===this.parentUI.getAlignItems()&&-1!==this.parentUI.getContentDirection().indexOf("row")?this.parentUI.getHeight()-(2*this.parentUI.padding||0):this.height||this.getInnerHeight()+(2*this.padding||0)}}}const RR={"\t":"\t","\n":"\n","\r":"\r"," ":" "},Mv="normal",Vm="nowrap",_C="pre",Hm="pre-line",yC="pre-wrap",Vz=function(n,e){switch(e){case Vm:case Mv:n=n.replace(/\n/g," ");case Hm:n=n.replace(/[ ]{2,}/g," ")}return n},Hz=function(n){switch(n){case _C:case yC:case Hm:return"mandatory"}},zz=function(n,e,t,i){const r=n[e];switch(i.WHITESPACE){case Mv:case Hm:case yC:if("mandatory"===r.lineBreak)return!0;if(t+(r.xadvance?r.xadvance:r.width)+(r.xoffset?r.xoffset:0)+(r.kerning?r.kerning:0)>i.INNER_WIDTH)return!0;const l=$z(n,e,i);return function Ioe(n,e,t,i){return!(!n||!n.glyph||e+t<i.INNER_WIDTH)&&i.BREAKON.indexOf(n.glyph)>-1}(n[e-1],t,l,i);case _C:return"mandatory"===r.lineBreak;default:return!1}},Gz=function(n,e){const t=n[0],i=n[n.length-1];switch(e){case yC:t.glyph&&"\n"===t.glyph&&n.length>1&&jz([t],n[1]),i.glyph&&"\n"===i.glyph&&n.length>1&&Wz([i],n[n.length-2]);break;case Hm:case Vm:case Mv:let s,r=[];for(let o=0;o<n.length;o++){const a=n[o];if(!(a.glyph&&RR[a.glyph]&&n.length>o))break;r.push(a),s=n[o+1]}jz(r,s),r=[],s=null;for(let o=n.length-1;o>0;o--){const a=n[o];if(!(a.glyph&&RR[a.glyph]&&o>0))break;r.push(a),s=n[o-1]}Wz(r,s);break;case _C:break;default:return console.warn(`whiteSpace: '${e}' is not valid`),0}return t.offsetX};function Wz(n,e){if(e)for(let t=0;t<n.length;t++){const i=n[t];i.width=0,i.height=0,i.offsetX=e.offsetX+e.width}}function jz(n,e){if(e)for(let t=0;t<n.length;t++){const i=n[t];i.width=0,i.height=0,i.offsetX=e.offsetX}}function $z(n,e,t,i){if(i=i||0,!n[e])return i;const r=n[e],a=r.xadvance?r.xadvance:r.width;return r.lineBreak?i+a:$z(n,e+1,t,i+a+t.LETTERSPACING+(r.xoffset?r.xoffset:0)+(r.kerning?r.kerning:0))}const qz="left",Xz="right",PR="center",NR="justify",Yz="justify-left",vC="justify-right",Kz="justify-center";function Zz(n,e,t){for(let i=0;i<n.length;i++){const r=n[i],s=Roe(r,e,t,i===n.length-1);for(let o=0;o<r.length;o++)r[o].offsetX+=s;r.x=s}if(0===e.indexOf(NR))for(let i=0;i<n.length;i++){const r=n[i];if(-1!==e.indexOf("-")&&i===n.length-1)return;const s=t-r.width;if(s<=0)return;let o=0;for(let h=1;h<r.length-1;h++)o+=" "===r[h].glyph?1:0;const a=s/o;let l=1;e===vC&&(r.reverse(),l=-1);let c=0;for(let h=1;h<=r.length-1;h++){const d=r[h];d.offsetX+=c*l,c+=" "===d.glyph?a:0}e===vC&&r.reverse()}}const Roe=(n,e,t,i)=>{switch(e){case Yz:case NR:case qz:return-t/2;case vC:case Xz:return t/2-n.width;case PR:return-n.width/2;case Kz:return i?-n.width/2:-t/2;default:console.warn(`textAlign: '${e}' is not valid`)}};function Jz(n){return class extends n{computeInlinesPosition(){const t=this.getWidth()-(2*this.padding||0),i=this.getHeight()-(2*this.padding||0),r=this.getJustifyContent(),s=this.getTextAlign(),o=this.getInterLine(),a=this.computeLines();a.interLine=o;const l=Math.abs(a.height),c=(()=>{switch(r){case"start":return i/2;case"end":return l-i/2;case"center":return l/2;default:console.warn(`justifyContent: '${r}' is not valid`)}})();a.forEach(h=>{h.y+=c,h.forEach(d=>{d.offsetY+=c})}),Zz(a,s,t),this.lines=a}calculateBestFit(t){if(0!==this.childrenInlines.length)switch(t){case"grow":this.calculateGrowFit();break;case"shrink":this.calculateShrinkFit();break;case"auto":this.calculateAutoFit()}}calculateGrowFit(){const t=this.getHeight()-(2*this.padding||0);let i=1;const s=this.childrenInlines.find(h=>h.isText);let c,o=1,a=2,l=s._fitFontSize?s._fitFontSize/s.getFontSize():1;do{if(c=this.calculateHeight(l),c>t){if(l<=o){this.childrenInlines.forEach(h=>{h.isInlineBlock||(h._fitFontSize=h.getFontSize())});break}a=l,l-=(a-o)/2}else{if(Math.abs(t-c)<.075)break;Math.abs(l-a)<5e-10&&(a*=2),o=l,l+=(a-o)/2}}while(++i<=10)}calculateShrinkFit(){const t=this.getHeight()-(2*this.padding||0);let i=1;const s=this.childrenInlines.find(h=>h.isText);let c,o=0,a=1,l=s._fitFontSize?s._fitFontSize/s.getFontSize():1;do{if(c=this.calculateHeight(l),c>t)a=l,l-=(a-o)/2;else{if(l>=a){this.childrenInlines.forEach(h=>{h.isInlineBlock||(h._fitFontSize=h.getFontSize())});break}if(Math.abs(t-c)<.075)break;o=l,l+=(a-o)/2}}while(++i<=10)}calculateAutoFit(){const t=this.getHeight()-(2*this.padding||0);let i=1;const s=this.childrenInlines.find(h=>h.isText);let c,o=0,a=2,l=s._fitFontSize?s._fitFontSize/s.getFontSize():1;do{if(c=this.calculateHeight(l),c>t)a=l,l-=(a-o)/2;else{if(Math.abs(t-c)<.075)break;Math.abs(l-a)<5e-10&&(a*=2),o=l,l+=(a-o)/2}}while(++i<=10)}computeLines(){const t=this.getWidth()-(2*this.padding||0),i=[[]];i.height=0;const r=this.getInterLine();this.childrenInlines.reduce((l,c)=>{if(!c.inlines)return;const h=c._fitFontSize||c.getFontSize(),d=c.isText?c.getLetterSpacing()*h:0,p=c.getWhiteSpace(),m=c.getBreakOn(),g={WHITESPACE:p,LETTERSPACING:d,BREAKON:m,INNER_WIDTH:t};return c.inlines.reduce((w,y,b,E)=>{const C=y.kerning?y.kerning:0,x=y.xoffset?y.xoffset:0,A=y.xadvance?y.xadvance:y.width;return zz(E,b,w,g)?(i.push([y]),y.offsetX=x,0===y.width?0:A+d):(i[i.length-1].push(y),y.offsetX=w+x+C,w+A+C+d)},l)},0);let s=0,o=0,a=-r/2;return i.forEach(l=>{if(l.lineHeight=l.reduce((h,d)=>Math.max(h,void 0!==d.lineHeight?d.lineHeight:d.height),0),l.lineBase=l.reduce((h,d)=>Math.max(h,void 0!==d.lineBase?d.lineBase:d.height),0),l.width=0,l.height=l.lineHeight,l[0]){const h=this.getWhiteSpace(),d=Gz(l,h);l.forEach(p=>{p.offsetX-=d}),l.width=this.computeLineWidth(l),l.width>s&&(s=l.width),l.forEach(p=>{p.offsetY=a-p.height-p.anchor,p.lineHeight<l.lineHeight&&(p.offsetY-=l.lineBase-p.lineBase)}),l.y=a,o+=l.lineHeight+r,a-=l.lineHeight+r}}),i.height=o,i.width=s,i}calculateHeight(t){this.childrenInlines.forEach(r=>{r.isInlineBlock||(r._fitFontSize=r.getFontSize()*t,r.calculateInlines(r._fitFontSize))});const i=this.computeLines();return Math.abs(i.height)}computeLineWidth(t){const r=t[t.length-1];return r.offsetX+r.width+t[0].offsetX}}}const Poe=new rn.FileLoader,LR=[],wC={},Noe=new rn.TextureLoader,OR=[],bC={},qr={};function FR(n){if(n._kernings)return;const e={};for(let t=0;t<n.kernings.length;t++){const i=n.kernings[t];0!==i.amount&&(e[String.fromCharCode(i.first,i.second)]=i.amount)}n._kernings=e}const Tv={setFontFamily:function Loe(n,e){"string"==typeof e?function Foe(n,e){-1===LR.indexOf(e)&&(LR.push(e),Poe.load(e,t=>{const i=JSON.parse(t);FR(i),wC[e]=i;for(const r of Object.keys(qr))e===qr[r].jsonURL&&qr[r].component._updateFontFamily(i)})),qr[n.id]||(qr[n.id]={component:n}),qr[n.id].jsonURL=e,wC[e]&&n._updateFontFamily(wC[e])}(n,e):(qr[n.id]||(qr[n.id]={component:n}),FR(e),qr[n.id].json=e,n._updateFontFamily(e))},setFontTexture:function Ooe(n,e){-1===OR.indexOf(e)&&(OR.push(e),Noe.load(e,t=>{t.generateMipmaps=!1,t.minFilter=rn.LinearFilter,t.magFilter=rn.LinearFilter,bC[e]=t;for(const i of Object.keys(qr))e===qr[i].textureURL&&qr[i].component._updateFontTexture(t)})),qr[n.id]||(qr[n.id]={component:n}),qr[n.id].textureURL=e,bC[e]&&n._updateFontTexture(bC[e])},getFontOf:function Qz(n){const e=qr[n.id];return!e&&n.parentUI?Qz(n.parentUI):e},addFont:function koe(n,e,t){t.generateMipmaps=!1,t.minFilter=rn.LinearFilter,t.magFilter=rn.LinearFilter,LR.push(n),wC[n]=e,FR(e),t&&(OR.push(n),bC[n]=t)}};let Av=(()=>{class n{static requestUpdate(t,i,r,s){t.traverse(o=>{o.isUI&&(this.requestedUpdates[o.id]?(i&&(this.requestedUpdates[o.id].updateParsing=!0),r&&(this.requestedUpdates[o.id].updateLayout=!0),s&&(this.requestedUpdates[o.id].updateInner=!0)):this.requestedUpdates[o.id]={updateParsing:i,updateLayout:r,updateInner:s,needCallback:i||r||s})})}static register(t){this.components.includes(t)||this.components.push(t)}static disposeOf(t){const i=this.components.indexOf(t);i>-1&&this.components.splice(i,1)}static update(){if(Object.keys(this.requestedUpdates).length>0){const t=this.components.filter(i=>!i.parentUI);t.forEach(i=>this.traverseParsing(i)),t.forEach(i=>this.traverseUpdates(i))}}static traverseParsing(t){const i=this.requestedUpdates[t.id];i&&i.updateParsing&&(t.parseParams(),i.updateParsing=!1),t.childrenUIs.forEach(r=>this.traverseParsing(r))}static traverseUpdates(t){const i=this.requestedUpdates[t.id];delete this.requestedUpdates[t.id],i&&i.updateLayout&&(i.updateLayout=!1,t.updateLayout()),i&&i.updateInner&&(i.updateInner=!1,t.updateInner()),t.childrenUIs.forEach(r=>{this.traverseUpdates(r)}),i&&i.needCallback&&t.onAfterUpdate()}}return n.components=[],n.requestedUpdates={},n})();const Dr={container:null,fontFamily:null,fontSize:.05,fontKerning:"normal",bestFit:"none",offset:.01,interLine:.01,breakOn:"- ,.:?!\n",whiteSpace:Hm,contentDirection:gC,alignItems:ER,justifyContent:CR,textAlign:PR,textType:"MSDF",fontColor:new rn.Color(16777215),fontOpacity:1,fontPXRange:4,fontSupersampling:!0,borderRadius:.01,borderWidth:0,borderColor:new rn.Color("black"),borderOpacity:1,backgroundSize:"cover",backgroundColor:new rn.Color(2236962),backgroundWhiteColor:new rn.Color(16777215),backgroundOpacity:.8,backgroundOpaqueOpacity:1,getDefaultTexture:function Uoe(){if(!EC){const n=document.createElement("canvas").getContext("2d");n.canvas.width=1,n.canvas.height=1,n.fillStyle="#ffffff",n.fillRect(0,0,1,1),EC=new rn.CanvasTexture(n.canvas),EC.isDefault=!0}return EC},hiddenOverflow:!1,letterSpacing:0};let EC;function SC(n){return class extends n{constructor(t){super(t),this.states={},this.currentState=void 0,this.isUI=!0,this.autoLayout=!0,this.childrenUIs=[],this.childrenBoxes=[],this.childrenTexts=[],this.childrenInlines=[],this.parentUI=null,this.addEventListener("added",this._rebuildParentUI),this.addEventListener("removed",this._rebuildParentUI)}getClippingPlanes(){const t=[];if(this.parentUI){if(this.isBlock&&this.parentUI.getHiddenOverflow()){const i=this.parentUI.getHeight()/2-(this.parentUI.padding||0),r=this.parentUI.getWidth()/2-(this.parentUI.padding||0),s=[new rn.Plane(new rn.Vector3(0,1,0),i),new rn.Plane(new rn.Vector3(0,-1,0),i),new rn.Plane(new rn.Vector3(1,0,0),r),new rn.Plane(new rn.Vector3(-1,0,0),r)];s.forEach(o=>{o.applyMatrix4(this.parent.matrixWorld)}),t.push(...s)}this.parentUI.parentUI&&t.push(...this.parentUI.getClippingPlanes())}return t}getHighestParent(){return this.parentUI?this.parent.getHighestParent():this}_getProperty(t){return void 0===this[t]&&this.parentUI?this.parent._getProperty(t):void 0!==this[t]?this[t]:Dr[t]}getFontSize(){return this._getProperty("fontSize")}getFontKerning(){return this._getProperty("fontKerning")}getLetterSpacing(){return this._getProperty("letterSpacing")}getFontTexture(){return void 0===this.fontTexture&&this.parentUI?this.parent._getProperty("fontTexture"):void 0!==this.fontTexture?this.fontTexture:Dr.getDefaultTexture()}getFontFamily(){return this._getProperty("fontFamily")}getBreakOn(){return this._getProperty("breakOn")}getWhiteSpace(){return this._getProperty("whiteSpace")}getTextAlign(){return this._getProperty("textAlign")}getTextType(){return this._getProperty("textType")}getFontColor(){return this._getProperty("fontColor")}getFontSupersampling(){return this._getProperty("fontSupersampling")}getFontOpacity(){return this._getProperty("fontOpacity")}getFontPXRange(){return this._getProperty("fontPXRange")}getBorderRadius(){return this._getProperty("borderRadius")}getBorderWidth(){return this._getProperty("borderWidth")}getBorderColor(){return this._getProperty("borderColor")}getBorderOpacity(){return this._getProperty("borderOpacity")}getContainer(){return!this.threeOBJ&&this.parent?this.parent.getContainer():this.threeOBJ?this:Dr.container}getParentsNumber(t){return t=t||0,this.parentUI?this.parentUI.getParentsNumber(t+1):t}getBackgroundOpacity(){return this.backgroundOpacity||0===this.backgroundOpacity?this.backgroundOpacity:Dr.backgroundOpacity}getBackgroundColor(){return this.backgroundColor||Dr.backgroundColor}getBackgroundTexture(){return this.backgroundTexture||Dr.getDefaultTexture()}getAlignContent(){return this.alignContent||Dr.alignContent}getAlignItems(){return this.alignItems||Dr.alignItems}getContentDirection(){return this.contentDirection||Dr.contentDirection}getJustifyContent(){return this.justifyContent||Dr.justifyContent}getInterLine(){return void 0===this.interLine?Dr.interLine:this.interLine}getOffset(){return void 0===this.offset?Dr.offset:this.offset}getBackgroundSize(){return void 0===this.backgroundSize?Dr.backgroundSize:this.backgroundSize}getHiddenOverflow(){return void 0===this.hiddenOverflow?Dr.hiddenOverflow:this.hiddenOverflow}getBestFit(){return void 0===this.bestFit?Dr.bestFit:this.bestFit}_rebuildChildrenLists(){this.childrenUIs=this.children.filter(t=>t.isUI),this.childrenBoxes=this.children.filter(t=>t.isBoxComponent),this.childrenInlines=this.children.filter(t=>t.isInline),this.childrenTexts=this.children.filter(t=>t.isText)}_rebuildParentUI=()=>{this.parentUI=this.parent&&this.parent.isUI?this.parent:null};add(){for(const i of Object.keys(arguments))arguments[i].isInline&&this.update(null,!0);const t=super.add(...arguments);return this._rebuildChildrenLists(),t}remove(){for(const i of Object.keys(arguments))arguments[i].isInline&&this.update(null,!0);const t=super.remove(...arguments);return this._rebuildChildrenLists(),t}update(t,i,r){Av.requestUpdate(this,t,i,r)}onAfterUpdate(){}_updateFontFamily(t){this.fontFamily=t,this.traverse(i=>{i.isUI&&i.update(!0,!0,!1)}),this.getHighestParent().update(!1,!0,!1)}_updateFontTexture(t){this.fontTexture=t,this.getHighestParent().update(!1,!0,!1)}set(t){let i,r,s;if(Av.register(this),t&&JSON.stringify(t)!==JSON.stringify({})){t.alignContent&&(t.alignItems=t.alignContent,t.textAlign||(t.textAlign=t.alignContent),console.warn("`alignContent` property has been deprecated, please rely on `alignItems` and `textAlign` instead."),delete t.alignContent),t.alignItems&&Uz(t.alignItems);for(const o of Object.keys(t))if(this[o]!=t[o])switch(o){case"content":case"fontSize":case"fontKerning":case"breakOn":case"whiteSpace":this.isText&&(i=!0),r=!0,this[o]=t[o];break;case"bestFit":this.isBlock&&(i=!0,r=!0),this[o]=t[o];break;case"width":case"height":case"padding":(this.isInlineBlock||this.isBlock&&"none"!=this.getBestFit())&&(i=!0),r=!0,this[o]=t[o];break;case"letterSpacing":case"interLine":this.isBlock&&"none"!=this.getBestFit()&&(i=!0),r=!0,this[o]=t[o];break;case"margin":case"contentDirection":case"justifyContent":case"alignContent":case"alignItems":case"textAlign":case"textType":r=!0,this[o]=t[o];break;case"fontColor":case"fontOpacity":case"fontSupersampling":case"offset":case"backgroundColor":case"backgroundOpacity":case"backgroundTexture":case"backgroundSize":case"borderRadius":case"borderWidth":case"borderColor":case"borderOpacity":s=!0,this[o]=t[o];break;case"hiddenOverflow":this[o]=t[o]}t.fontFamily&&Tv.setFontFamily(this,t.fontFamily),t.fontTexture&&Tv.setFontTexture(this,t.fontTexture),this.parentUI&&"none"!=this.parentUI.getBestFit()&&this.parentUI.update(!0,!0,!1),this.update(i,r,s),r&&this.getHighestParent().update(!1,!0,!1)}}setupState(t){this.states[t.state]={attributes:t.attributes,onSet:t.onSet}}setState(t){const i=this.states[t];i?t!==this.currentState&&(this.currentState=t,i.onSet&&i.onSet(),i.attributes&&this.set(i.attributes)):console.warn(`state "${t}" does not exist within this component:`,this.name)}clear(){this.traverse(t=>{Av.disposeOf(t),t.material&&t.material.dispose(),t.geometry&&t.geometry.dispose()})}}}function kR(n){return class extends n{constructor(t){super(t),this.textUniforms={u_texture:{value:this.getFontTexture()},u_color:{value:this.getFontColor()},u_opacity:{value:this.getFontOpacity()},u_pxRange:{value:this.getFontPXRange()},u_useRGSS:{value:this.getFontSupersampling()}},this.backgroundUniforms={u_texture:{value:this.getBackgroundTexture()},u_color:{value:this.getBackgroundColor()},u_opacity:{value:this.getBackgroundOpacity()},u_backgroundMapping:{value:this.getBackgroundSize()},u_borderWidth:{value:this.getBorderWidth()},u_borderColor:{value:this.getBorderColor()},u_borderRadiusTopLeft:{value:this.getBorderRadius()},u_borderRadiusTopRight:{value:this.getBorderRadius()},u_borderRadiusBottomRight:{value:this.getBorderRadius()},u_borderRadiusBottomLeft:{value:this.getBorderRadius()},u_borderOpacity:{value:this.getBorderOpacity()},u_size:{value:new rn.Vector2(1,1)},u_tSize:{value:new rn.Vector2(1,1)}}}updateBackgroundMaterial(){this.backgroundUniforms.u_texture.value=this.getBackgroundTexture(),this.backgroundUniforms.u_tSize.value.set(this.backgroundUniforms.u_texture.value.image.width,this.backgroundUniforms.u_texture.value.image.height),this.size&&this.backgroundUniforms.u_size.value.copy(this.size),this.backgroundUniforms.u_texture.value.isDefault?(this.backgroundUniforms.u_color.value=this.getBackgroundColor(),this.backgroundUniforms.u_opacity.value=this.getBackgroundOpacity()):(this.backgroundUniforms.u_color.value=this.backgroundColor||Dr.backgroundWhiteColor,this.backgroundUniforms.u_opacity.value=this.backgroundOpacity||0===this.backgroundOpacity?this.backgroundOpacity:Dr.backgroundOpaqueOpacity),this.backgroundUniforms.u_backgroundMapping.value=(()=>{switch(this.getBackgroundSize()){case"stretch":return 0;case"contain":return 1;case"cover":return 2}})();const t=this.getBorderRadius();this.backgroundUniforms.u_borderWidth.value=this.getBorderWidth(),this.backgroundUniforms.u_borderColor.value=this.getBorderColor(),this.backgroundUniforms.u_borderOpacity.value=this.getBorderOpacity(),Array.isArray(t)?(this.backgroundUniforms.u_borderRadiusTopLeft.value=t[0],this.backgroundUniforms.u_borderRadiusTopRight.value=t[1],this.backgroundUniforms.u_borderRadiusBottomRight.value=t[2],this.backgroundUniforms.u_borderRadiusBottomLeft.value=t[3]):(this.backgroundUniforms.u_borderRadiusTopLeft.value=t,this.backgroundUniforms.u_borderRadiusTopRight.value=t,this.backgroundUniforms.u_borderRadiusBottomRight.value=t,this.backgroundUniforms.u_borderRadiusBottomLeft.value=t)}updateTextMaterial(){this.textUniforms.u_texture.value=this.getFontTexture(),this.textUniforms.u_color.value=this.getFontColor(),this.textUniforms.u_opacity.value=this.getFontOpacity(),this.textUniforms.u_pxRange.value=this.getFontPXRange(),this.textUniforms.u_useRGSS.value=this.getFontSupersampling()}getBackgroundMaterial(){return(!this.backgroundMaterial||!this.backgroundUniforms)&&(this.backgroundMaterial=this._makeBackgroundMaterial()),this.backgroundMaterial}getFontMaterial(){return(!this.fontMaterial||!this.textUniforms)&&(this.fontMaterial=this._makeTextMaterial()),this.fontMaterial}_makeTextMaterial(){return new rn.ShaderMaterial({uniforms:this.textUniforms,transparent:!0,clipping:!0,vertexShader:Boe,fragmentShader:Voe,extensions:{derivatives:!0}})}_makeBackgroundMaterial(){return new rn.ShaderMaterial({uniforms:this.backgroundUniforms,transparent:!0,clipping:!0,vertexShader:Hoe,fragmentShader:zoe,extensions:{derivatives:!0}})}updateClippingPlanes(t){const i=void 0!==t?t:this.getClippingPlanes();JSON.stringify(i)!==JSON.stringify(this.clippingPlanes)&&(this.clippingPlanes=i,this.fontMaterial&&(this.fontMaterial.clippingPlanes=this.clippingPlanes),this.backgroundMaterial&&(this.backgroundMaterial.clippingPlanes=this.clippingPlanes))}}}const Boe="\nvarying vec2 vUv;\n\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\tvUv = uv;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\tgl_Position.z -= 0.00001;\n\n\t#include <clipping_planes_vertex>\n\n}\n",Voe="\n\nuniform sampler2D u_texture;\nuniform vec3 u_color;\nuniform float u_opacity;\nuniform float u_pxRange;\nuniform bool u_useRGSS;\n\nvarying vec2 vUv;\n\n#include <clipping_planes_pars_fragment>\n\n// functions from the original msdf repo:\n// https://github.com/Chlumsky/msdfgen#using-a-multi-channel-distance-field\n\nfloat median(float r, float g, float b) {\n\treturn max(min(r, g), min(max(r, g), b));\n}\n\nfloat screenPxRange() {\n\tvec2 unitRange = vec2(u_pxRange)/vec2(textureSize(u_texture, 0));\n\tvec2 screenTexSize = vec2(1.0)/fwidth(vUv);\n\treturn max(0.5*dot(unitRange, screenTexSize), 1.0);\n}\n\nfloat tap(vec2 offsetUV) {\n\tvec3 msd = texture( u_texture, offsetUV ).rgb;\n\tfloat sd = median(msd.r, msd.g, msd.b);\n\tfloat screenPxDistance = screenPxRange() * (sd - 0.5);\n\tfloat alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\n\treturn alpha;\n}\n\nvoid main() {\n\n\tfloat alpha;\n\n\tif ( u_useRGSS ) {\n\n\t\t// shader-based supersampling based on https://bgolus.medium.com/sharper-mipmapping-using-shader-based-supersampling-ed7aadb47bec\n\t\t// per pixel partial derivatives\n\t\tvec2 dx = dFdx(vUv);\n\t\tvec2 dy = dFdy(vUv);\n\n\t\t// rotated grid uv offsets\n\t\tvec2 uvOffsets = vec2(0.125, 0.375);\n\t\tvec2 offsetUV = vec2(0.0, 0.0);\n\n\t\t// supersampled using 2x2 rotated grid\n\t\talpha = 0.0;\n\t\toffsetUV.xy = vUv + uvOffsets.x * dx + uvOffsets.y * dy;\n\t\talpha += tap(offsetUV);\n\t\toffsetUV.xy = vUv - uvOffsets.x * dx - uvOffsets.y * dy;\n\t\talpha += tap(offsetUV);\n\t\toffsetUV.xy = vUv + uvOffsets.y * dx - uvOffsets.x * dy;\n\t\talpha += tap(offsetUV);\n\t\toffsetUV.xy = vUv - uvOffsets.y * dx + uvOffsets.x * dy;\n\t\talpha += tap(offsetUV);\n\t\talpha *= 0.25;\n\n\t} else {\n\n\t\talpha = tap( vUv );\n\n\t}\n\n\n\t// apply the opacity\n\talpha *= u_opacity;\n\n\t// this is useful to avoid z-fighting when quads overlap because of kerning\n\tif ( alpha < 0.02) discard;\n\n\n\tgl_FragColor = vec4( u_color, alpha );\n\n\t#include <clipping_planes_fragment>\n\n}\n",Hoe="\nvarying vec2 vUv;\n\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\tvUv = uv;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\n\t#include <clipping_planes_vertex>\n\n}\n",zoe="\n\nuniform sampler2D u_texture;\nuniform vec3 u_color;\nuniform float u_opacity;\n\nuniform float u_borderRadiusTopLeft;\nuniform float u_borderRadiusTopRight;\nuniform float u_borderRadiusBottomLeft;\nuniform float u_borderRadiusBottomRight;\nuniform float u_borderWidth;\nuniform vec3 u_borderColor;\nuniform float u_borderOpacity;\nuniform vec2 u_size;\nuniform vec2 u_tSize;\nuniform int u_backgroundMapping;\n\nvarying vec2 vUv;\n\n#include <clipping_planes_pars_fragment>\n\nfloat getEdgeDist() {\n\tvec2 ndc = vec2( vUv.x * 2.0 - 1.0, vUv.y * 2.0 - 1.0 );\n\tvec2 planeSpaceCoord = vec2( u_size.x * 0.5 * ndc.x, u_size.y * 0.5 * ndc.y );\n\tvec2 corner = u_size * 0.5;\n\tvec2 offsetCorner = corner - abs( planeSpaceCoord );\n\tfloat innerRadDist = min( offsetCorner.x, offsetCorner.y ) * -1.0;\n\tif (vUv.x < 0.5 && vUv.y >= 0.5) {\n\t\tfloat roundedDist = length( max( abs( planeSpaceCoord ) - u_size * 0.5 + u_borderRadiusTopLeft, 0.0 ) ) - u_borderRadiusTopLeft;\n\t\tfloat s = step( innerRadDist * -1.0, u_borderRadiusTopLeft );\n\t\treturn mix( innerRadDist, roundedDist, s );\n\t}\n\tif (vUv.x >= 0.5 && vUv.y >= 0.5) {\n\t\tfloat roundedDist = length( max( abs( planeSpaceCoord ) - u_size * 0.5 + u_borderRadiusTopRight, 0.0 ) ) - u_borderRadiusTopRight;\n\t\tfloat s = step( innerRadDist * -1.0, u_borderRadiusTopRight );\n\t\treturn mix( innerRadDist, roundedDist, s );\n\t}\n\tif (vUv.x >= 0.5 && vUv.y < 0.5) {\n\t\tfloat roundedDist = length( max( abs( planeSpaceCoord ) - u_size * 0.5 + u_borderRadiusBottomRight, 0.0 ) ) - u_borderRadiusBottomRight;\n\t\tfloat s = step( innerRadDist * -1.0, u_borderRadiusBottomRight );\n\t\treturn mix( innerRadDist, roundedDist, s );\n\t}\n\tif (vUv.x < 0.5 && vUv.y < 0.5) {\n\t\tfloat roundedDist = length( max( abs( planeSpaceCoord ) - u_size * 0.5 + u_borderRadiusBottomLeft, 0.0 ) ) - u_borderRadiusBottomLeft;\n\t\tfloat s = step( innerRadDist * -1.0, u_borderRadiusBottomLeft );\n\t\treturn mix( innerRadDist, roundedDist, s );\n\t}\n}\n\nvec4 sampleTexture() {\n\tfloat textureRatio = u_tSize.x / u_tSize.y;\n\tfloat panelRatio = u_size.x / u_size.y;\n\tvec2 uv = vUv;\n\tif ( u_backgroundMapping == 1 ) { // contain\n\t\tif ( textureRatio < panelRatio ) { // repeat on X\n\t\t\tfloat newX = uv.x * ( panelRatio / textureRatio );\n\t\t\tnewX += 0.5 - 0.5 * ( panelRatio / textureRatio );\n\t\t\tuv.x = newX;\n\t\t} else { // repeat on Y\n\t\t\tfloat newY = uv.y * ( textureRatio / panelRatio );\n\t\t\tnewY += 0.5 - 0.5 * ( textureRatio / panelRatio );\n\t\t\tuv.y = newY;\n\t\t}\n\t} else if ( u_backgroundMapping == 2 ) { // cover\n\t\tif ( textureRatio < panelRatio ) { // stretch on Y\n\t\t\tfloat newY = uv.y * ( textureRatio / panelRatio );\n\t\t\tnewY += 0.5 - 0.5 * ( textureRatio / panelRatio );\n\t\t\tuv.y = newY;\n\t\t} else { // stretch on X\n\t\t\tfloat newX = uv.x * ( panelRatio / textureRatio );\n\t\t\tnewX += 0.5 - 0.5 * ( panelRatio / textureRatio );\n\t\t\tuv.x = newX;\n\t\t}\n\t}\n\treturn texture2D( u_texture, uv ).rgba;\n}\n\nvoid main() {\n\n\tfloat edgeDist = getEdgeDist();\n\tfloat change = fwidth( edgeDist );\n\n\tvec4 textureSample = sampleTexture();\n\tvec3 blendedColor = textureSample.rgb * u_color;\n\n\tfloat alpha = smoothstep( change, 0.0, edgeDist );\n\tfloat blendedOpacity = u_opacity * textureSample.a * alpha;\n\n\tvec4 frameColor = vec4( blendedColor, blendedOpacity );\n\n\tif ( u_borderWidth <= 0.0 ) {\n\t\tgl_FragColor = frameColor;\n\t} else {\n\t\tvec4 borderColor = vec4( u_borderColor, u_borderOpacity * alpha );\n\t\tfloat stp = smoothstep( edgeDist + change, edgeDist, u_borderWidth * -1.0 );\n\t\tgl_FragColor = mix( frameColor, borderColor, stp );\n\t}\n\n\t#include <clipping_planes_fragment>\n}\n";class eG extends rn.Mesh{constructor(e){super(new rn.PlaneGeometry,e),this.castShadow=!0,this.receiveShadow=!0,this.name="MeshUI-Frame"}}let CC=null;function zm(...n){if(!CC)throw new Error("Cannot use mixins with Base null");let e=CC;CC=null;let i,t=n.length;for(;--t>=0;)i=n[t],e=i(e);return e}zm.withBase=n=>(CC=n,zm);class Dv extends(zm.withBase(rn.Object3D)(IR,Jz,kR,SC)){constructor(e){super(e),this.isBlock=!0,this.size=new rn.Vector2(1,1),this.frame=new eG(this.getBackgroundMaterial()),this.frame.onBeforeRender=()=>{this.updateClippingPlanes&&this.updateClippingPlanes()},this.add(this.frame),this.set(e)}parseParams(){const e=this.getBestFit();"none"!=e&&this.childrenTexts.length?this.calculateBestFit(e):this.childrenTexts.forEach(t=>{t._fitFontSize=void 0})}updateLayout(){const e=this.getWidth(),t=this.getHeight();e&&t?(this.size.set(e,t),this.frame.scale.set(e,t,1),this.frame&&this.updateBackgroundMaterial(),this.frame.renderOrder=this.getParentsNumber(),this.autoLayout&&this.setPosFromParentRecords(),this.childrenInlines.length&&this.computeInlinesPosition(),this.computeChildrenPosition(),this.parentUI&&(this.position.z=this.getOffset())):console.warn("Block got no dimension from its parameters or from children parameters")}updateInner(){this.parentUI&&(this.position.z=this.getOffset()),this.frame&&this.updateBackgroundMaterial()}}function tG(n){return class extends n{constructor(t){super(t),this.isInline=!0}}}function nG(n){let e,t,i,r=0;for(let a=0;a<n.length;++a){const l=n[a];if(l.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(void 0===e&&(e=l.array.constructor),e!==l.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(void 0===t&&(t=l.itemSize),t!==l.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(void 0===i&&(i=l.normalized),i!==l.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;r+=l.array.length}const s=new e(r);let o=0;for(let a=0;a<n.length;++a)s.set(n[a].array,o),o+=n[a].array.length;return new rn.BufferAttribute(s,t,i)}class Woe extends rn.PlaneGeometry{constructor(e,t){const i=e.glyph,r=e.fontSize;super(e.width,e.height),null===i.match(/\s/g)?(-1===t.info.charset.indexOf(i)&&console.error(`The character '${i}' is not included in the font characters set.`),this.mapUVs(t,i),this.transformGeometry(e)):(this.nullifyUVs(),this.scale(0,0,1),this.translate(0,r/2,0))}mapUVs(e,t){const i=e.chars.find(h=>h.char===t),r=e.common,s=i.x/r.scaleW,o=(i.x+i.width)/r.scaleW,a=1-(i.y+i.height)/r.scaleH,l=1-i.y/r.scaleH,c=this.attributes.uv;for(let h=0;h<c.count;h++){let d=c.getX(h),p=c.getY(h);[d,p]=(()=>{switch(h){case 0:return[s,l];case 1:return[o,l];case 2:return[s,a];case 3:return[o,a]}})(),c.setXY(h,d,p)}}nullifyUVs(){const e=this.attributes.uv;for(let t=0;t<e.count;t++)e.setXY(t,0,0)}transformGeometry(e){this.translate(e.width/2,e.height/2,0)}}const UR={getGlyphDimensions:function joe(n){const e=n.font,t=n.fontSize,i=n.glyph,r=t/e.info.size,s=e.chars.find(d=>d.char===i);let o=s?s.width*r:t/3,a=s?s.height*r:0;return 0===o&&(o=s?s.xadvance*r:t),0===a&&(a=.7*t),"\n"===i&&(o=0),{width:o,height:a,anchor:s?s.yoffset*r:0,xadvance:s?s.xadvance*r:o,xoffset:s?s.xoffset*r:0}},getGlyphPairKerning:function $oe(n,e){const t=n._kernings;return t[e]?t[e]:0},buildText:function qoe(){const n=[];this.inlines.forEach((i,r)=>{n[r]=new Woe(i,this.getFontFamily()),n[r].translate(i.offsetX,i.offsetY,0)});const e=function Goe(n,e=!1){const t=null!==n[0].index,i=new Set(Object.keys(n[0].attributes)),r=new Set(Object.keys(n[0].morphAttributes)),s={},o={},a=n[0].morphTargetsRelative,l=new rn.BufferGeometry;let c=0;for(let h=0;h<n.length;++h){const d=n[h];let p=0;if(t!==(null!==d.index))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const m in d.attributes){if(!i.has(m))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+'. All geometries must have compatible attributes; make sure "'+m+'" attribute exists among all geometries, or in none of them.'),null;void 0===s[m]&&(s[m]=[]),s[m].push(d.attributes[m]),p++}if(p!==i.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". Make sure all geometries have the same number of attributes."),null;if(a!==d.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const m in d.morphAttributes){if(!r.has(m))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+".  .morphAttributes must be consistent throughout all geometries."),null;void 0===o[m]&&(o[m]=[]),o[m].push(d.morphAttributes[m])}if(l.userData.mergedUserData=l.userData.mergedUserData||[],l.userData.mergedUserData.push(d.userData),e){let m;if(t)m=d.index.count;else{if(void 0===d.attributes.position)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". The geometry must have either an index or a position attribute"),null;m=d.attributes.position.count}l.addGroup(c,m,h),c+=m}}if(t){let h=0;const d=[];for(let p=0;p<n.length;++p){const m=n[p].index;for(let g=0;g<m.count;++g)d.push(m.getX(g)+h);h+=n[p].attributes.position.count}l.setIndex(d)}for(const h in s){const d=nG(s[h]);if(!d)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+h+" attribute."),null;l.setAttribute(h,d)}for(const h in o){const d=o[h][0].length;if(0===d)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[h]=[];for(let p=0;p<d;++p){const m=[];for(let v=0;v<o[h].length;++v)m.push(o[h][v][p]);const g=nG(m);if(!g)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+h+" morphAttribute."),null;l.morphAttributes[h].push(g)}}return l}(n);return new rn.Mesh(e,this.getFontMaterial())}};function Xoe(n){return class extends n{createText(){const t=this,i=(()=>{if("MSDF"===this.getTextType())return UR.buildText.call(this);console.warn(`'${this.getTextType()}' is not a supported text type.\nSee https://github.com/felixmariotto/three-mesh-ui/wiki/Using-a-custom-text-type`)})();return i.renderOrder=1/0,i.onBeforeRender=function(){t.updateClippingPlanes&&t.updateClippingPlanes()},i}getGlyphDimensions(t){if("MSDF"===t.textType)return UR.getGlyphDimensions(t);console.warn(`'${t.textType}' is not a supported text type.\nSee https://github.com/felixmariotto/three-mesh-ui/wiki/Using-a-custom-text-type`)}getGlyphPairKerning(t,i,r){if("MSDF"===t)return UR.getGlyphPairKerning(i,r);console.warn(`'${t}' is not a supported text type.\nSee https://github.com/felixmariotto/three-mesh-ui/wiki/Using-a-custom-text-type`)}}}const Yoe=function rG(n){n.children.forEach(e=>{e.children.length>0&&rG(e),n.remove(e),Av.disposeOf(e),e.material&&e.material.dispose(),e.geometry&&e.geometry.dispose()}),n.children=[]};class BR extends(zm.withBase(rn.Object3D)(tG,Xoe,kR,SC)){constructor(e){super(e),this.isText=!0,this.set(e)}parseParams(){this.calculateInlines(this._fitFontSize||this.getFontSize())}updateLayout(){Yoe(this),this.inlines&&(this.textContent=this.createText(),this.updateTextMaterial(),this.add(this.textContent)),this.position.z=this.getOffset()}updateInner(){this.position.z=this.getOffset(),this.textContent&&this.updateTextMaterial()}calculateInlines(e){const t=this.content,i=this.getFontFamily(),r=this.getBreakOn(),s=this.getTextType(),o=this.getWhiteSpace();if(!i||"string"==typeof i)return void(Tv.getFontOf(this)||console.warn("no font was found"));if(!this.content)return void(this.inlines=null);if(!s)return void console.error("You must provide a 'textType' attribute so three-mesh-ui knows how to render your text.\n See https://github.com/felixmariotto/three-mesh-ui/wiki/Using-a-custom-text-type");const a=Vz(t,o),l=Array.from?Array.from(a):String(a).split(""),c=e/i.info.size,h=i.common.lineHeight*c,d=i.common.base*c,p=l.map(m=>{const g=this.getGlyphDimensions({textType:s,glyph:m,font:i,fontSize:e});let v=null;return o!==Vm&&(r.includes(m)||m.match(/\s/g))&&(v="possible"),m.match(/\n/g)&&(v=Hz(o)),{height:g.height,width:g.width,anchor:g.anchor,xadvance:g.xadvance,xoffset:g.xoffset,lineBreak:v,glyph:m,fontSize:e,lineHeight:h,lineBase:d}});if("none"!==this.getFontKerning())for(let m=1;m<p.length;m++){const g=p[m],w=this.getGlyphPairKerning(s,i,p[m-1].glyph+p[m].glyph);g.kerning=w*(e/i.info.size)}this.inlines=p}}class VR extends(zm.withBase(rn.Object3D)(tG,IR,Jz,kR,SC)){constructor(e){super(e),this.isInlineBlock=!0,this.size=new rn.Vector2(1,1),this.frame=new eG(this.getBackgroundMaterial()),this.frame.onBeforeRender=()=>{this.updateClippingPlanes&&this.updateClippingPlanes()},this.add(this.frame),this.set(e)}parseParams(){this.width||console.warn("inlineBlock has no width. Set to 0.3 by default"),this.height||console.warn("inlineBlock has no height. Set to 0.3 by default"),this.inlines=[{height:this.height||.3,width:this.width||.3,anchor:0,lineBreak:"possible"}]}updateLayout(){const e=this.getWidth(),t=this.getHeight();if(this.inlines){const i=this.inlines[0];this.position.set(i.width/2,i.height/2,0),this.position.x+=i.offsetX,this.position.y+=i.offsetY}this.size.set(e,t),this.frame.scale.set(e,t,1),this.frame&&this.updateBackgroundMaterial(),this.frame.renderOrder=this.getParentsNumber(),this.childrenInlines.length&&this.computeInlinesPosition(),this.computeChildrenPosition(),this.position.z=this.getOffset()}updateInner(){this.position.z=this.getOffset(),this.frame&&this.updateBackgroundMaterial()}}const Mu_fr=[[[{width:.1,chars:[{lowerCase:"a",upperCase:"A"}]},{width:.1,chars:[{lowerCase:"z",upperCase:"Z"}]},{width:.1,chars:[{lowerCase:"e",upperCase:"E"}]},{width:.1,chars:[{lowerCase:"r",upperCase:"R"}]},{width:.1,chars:[{lowerCase:"t",upperCase:"T"}]},{width:.1,chars:[{lowerCase:"y",upperCase:"Y"}]},{width:.1,chars:[{lowerCase:"u",upperCase:"U"}]},{width:.1,chars:[{lowerCase:"i",upperCase:"I"}]},{width:.1,chars:[{lowerCase:"o",upperCase:"O"}]},{width:.1,chars:[{lowerCase:"p",upperCase:"P"}]}],[{width:.1,chars:[{lowerCase:"q",upperCase:"Q"}]},{width:.1,chars:[{lowerCase:"s",upperCase:"S"}]},{width:.1,chars:[{lowerCase:"d",upperCase:"D"}]},{width:.1,chars:[{lowerCase:"f",upperCase:"F"}]},{width:.1,chars:[{lowerCase:"g",upperCase:"G"}]},{width:.1,chars:[{lowerCase:"h",upperCase:"H"}]},{width:.1,chars:[{lowerCase:"j",upperCase:"J"}]},{width:.1,chars:[{lowerCase:"k",upperCase:"K"}]},{width:.1,chars:[{lowerCase:"l",upperCase:"L"}]},{width:.1,chars:[{lowerCase:"m",upperCase:"M"}]}],[{width:.2,command:"shift",chars:[{icon:"shift"}]},{width:.1,chars:[{lowerCase:"w",upperCase:"W"}]},{width:.1,chars:[{lowerCase:"x",upperCase:"X"}]},{width:.1,chars:[{lowerCase:"c",upperCase:"C"}]},{width:.1,chars:[{lowerCase:"v",upperCase:"V"}]},{width:.1,chars:[{lowerCase:"b",upperCase:"B"}]},{width:.1,chars:[{lowerCase:"n",upperCase:"N"}]},{width:.2,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]],[[{width:.1,chars:[{lowerCase:"1"}]},{width:.1,chars:[{lowerCase:"2"}]},{width:.1,chars:[{lowerCase:"3"}]},{width:.1,chars:[{lowerCase:"4"}]},{width:.1,chars:[{lowerCase:"5"}]},{width:.1,chars:[{lowerCase:"6"}]},{width:.1,chars:[{lowerCase:"7"}]},{width:.1,chars:[{lowerCase:"8"}]},{width:.1,chars:[{lowerCase:"9"}]},{width:.1,chars:[{lowerCase:"0"}]}],[{width:.1,chars:[{lowerCase:"@"}]},{width:.1,chars:[{lowerCase:"#"}]},{width:.1,chars:[{lowerCase:"|"}]},{width:.1,chars:[{lowerCase:"_"}]},{width:.1,chars:[{lowerCase:"&"}]},{width:.1,chars:[{lowerCase:"-"}]},{width:.1,chars:[{lowerCase:"+"}]},{width:.1,chars:[{lowerCase:"("}]},{width:.1,chars:[{lowerCase:")"}]},{width:.1,chars:[{lowerCase:"/"}]}],[{width:.1,chars:[{lowerCase:"="}]},{width:.1,chars:[{lowerCase:"*"}]},{width:.1,chars:[{lowerCase:'"'}]},{width:.1,chars:[{lowerCase:"'"}]},{width:.1,chars:[{lowerCase:":"}]},{width:.1,chars:[{lowerCase:";"}]},{width:.1,chars:[{lowerCase:"!"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]]],Mu_eng=[[[{width:.1,chars:[{lowerCase:"q",upperCase:"Q"}]},{width:.1,chars:[{lowerCase:"w",upperCase:"W"}]},{width:.1,chars:[{lowerCase:"e",upperCase:"E"}]},{width:.1,chars:[{lowerCase:"r",upperCase:"R"}]},{width:.1,chars:[{lowerCase:"t",upperCase:"T"}]},{width:.1,chars:[{lowerCase:"y",upperCase:"Y"}]},{width:.1,chars:[{lowerCase:"u",upperCase:"U"}]},{width:.1,chars:[{lowerCase:"i",upperCase:"I"}]},{width:.1,chars:[{lowerCase:"o",upperCase:"O"}]},{width:.1,chars:[{lowerCase:"p",upperCase:"P"}]}],[{width:.1,chars:[{lowerCase:"a",upperCase:"A"}]},{width:.1,chars:[{lowerCase:"s",upperCase:"S"}]},{width:.1,chars:[{lowerCase:"d",upperCase:"D"}]},{width:.1,chars:[{lowerCase:"f",upperCase:"F"}]},{width:.1,chars:[{lowerCase:"g",upperCase:"G"}]},{width:.1,chars:[{lowerCase:"h",upperCase:"H"}]},{width:.1,chars:[{lowerCase:"j",upperCase:"J"}]},{width:.1,chars:[{lowerCase:"k",upperCase:"K"}]},{width:.1,chars:[{lowerCase:"l",upperCase:"L"}]}],[{width:.15,command:"shift",chars:[{icon:"shift"}]},{width:.1,chars:[{lowerCase:"z",upperCase:"Z"}]},{width:.1,chars:[{lowerCase:"x",upperCase:"X"}]},{width:.1,chars:[{lowerCase:"c",upperCase:"C"}]},{width:.1,chars:[{lowerCase:"v",upperCase:"V"}]},{width:.1,chars:[{lowerCase:"b",upperCase:"B"}]},{width:.1,chars:[{lowerCase:"n",upperCase:"N"}]},{width:.1,chars:[{lowerCase:"m",upperCase:"M"}]},{width:.15,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]],[[{width:.1,chars:[{lowerCase:"1"}]},{width:.1,chars:[{lowerCase:"2"}]},{width:.1,chars:[{lowerCase:"3"}]},{width:.1,chars:[{lowerCase:"4"}]},{width:.1,chars:[{lowerCase:"5"}]},{width:.1,chars:[{lowerCase:"6"}]},{width:.1,chars:[{lowerCase:"7"}]},{width:.1,chars:[{lowerCase:"8"}]},{width:.1,chars:[{lowerCase:"9"}]},{width:.1,chars:[{lowerCase:"0"}]}],[{width:.1,chars:[{lowerCase:"@"}]},{width:.1,chars:[{lowerCase:"#"}]},{width:.1,chars:[{lowerCase:"|"}]},{width:.1,chars:[{lowerCase:"_"}]},{width:.1,chars:[{lowerCase:"&"}]},{width:.1,chars:[{lowerCase:"-"}]},{width:.1,chars:[{lowerCase:"+"}]},{width:.1,chars:[{lowerCase:"("}]},{width:.1,chars:[{lowerCase:")"}]},{width:.1,chars:[{lowerCase:"/"}]}],[{width:.1,chars:[{lowerCase:"="}]},{width:.1,chars:[{lowerCase:"*"}]},{width:.1,chars:[{lowerCase:'"'}]},{width:.1,chars:[{lowerCase:"'"}]},{width:.1,chars:[{lowerCase:":"}]},{width:.1,chars:[{lowerCase:";"}]},{width:.1,chars:[{lowerCase:"!"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]]],Mu_ru=[[[{width:1/12,chars:[{lowerCase:"\u0439",upperCase:"\u0419"},{lowerCase:"q",upperCase:"Q"}]},{width:1/12,chars:[{lowerCase:"\u0446",upperCase:"\u0426"},{lowerCase:"w",upperCase:"W"}]},{width:1/12,chars:[{lowerCase:"\u0443",upperCase:"\u0423"},{lowerCase:"e",upperCase:"E"}]},{width:1/12,chars:[{lowerCase:"\u043a",upperCase:"\u041a"},{lowerCase:"r",upperCase:"R"}]},{width:1/12,chars:[{lowerCase:"\u0435",upperCase:"\u0415"},{lowerCase:"t",upperCase:"T"}]},{width:1/12,chars:[{lowerCase:"\u043d",upperCase:"\u041d"},{lowerCase:"y",upperCase:"Y"}]},{width:1/12,chars:[{lowerCase:"\u0433",upperCase:"\u0413"},{lowerCase:"u",upperCase:"U"}]},{width:1/12,chars:[{lowerCase:"\u0448",upperCase:"\u0428"},{lowerCase:"i",upperCase:"I"}]},{width:1/12,chars:[{lowerCase:"\u0449",upperCase:"\u0429"},{lowerCase:"o",upperCase:"O"}]},{width:1/12,chars:[{lowerCase:"\u0437",upperCase:"\u0417"},{lowerCase:"p",upperCase:"P"}]},{width:1/12,chars:[{lowerCase:"\u0445",upperCase:"\u0425"},{lowerCase:"{",upperCase:"["}]},{width:1/12,chars:[{lowerCase:"\u044a",upperCase:"\u042a"},{lowerCase:"}",upperCase:"]"}]}],[{width:1/12,chars:[{lowerCase:"\u0444",upperCase:"\u0424"},{lowerCase:"a",upperCase:"A"}]},{width:1/12,chars:[{lowerCase:"\u044b",upperCase:"\u042b"},{lowerCase:"s",upperCase:"S"}]},{width:1/12,chars:[{lowerCase:"\u0432",upperCase:"\u0412"},{lowerCase:"d",upperCase:"D"}]},{width:1/12,chars:[{lowerCase:"\u0430",upperCase:"\u0410"},{lowerCase:"f",upperCase:"F"}]},{width:1/12,chars:[{lowerCase:"\u043f",upperCase:"\u041f"},{lowerCase:"g",upperCase:"G"}]},{width:1/12,chars:[{lowerCase:"\u0440",upperCase:"\u0420"},{lowerCase:"h",upperCase:"H"}]},{width:1/12,chars:[{lowerCase:"\u043e",upperCase:"\u041e"},{lowerCase:"j",upperCase:"J"}]},{width:1/12,chars:[{lowerCase:"\u043b",upperCase:"\u041b"},{lowerCase:"k",upperCase:"K"}]},{width:1/12,chars:[{lowerCase:"\u0434",upperCase:"\u0414"},{lowerCase:"l",upperCase:"L"}]},{width:1/12,chars:[{lowerCase:"\u0436",upperCase:"\u0416"},{lowerCase:":",upperCase:";"}]},{width:1/12,chars:[{lowerCase:"\u044d",upperCase:"\u042d"},{lowerCase:'"',upperCase:"'"}]},{width:1/12,chars:[{lowerCase:"\u0451",upperCase:"\u0401"},{lowerCase:"|",upperCase:"\\"}]}],[{width:.125,command:"shift",chars:[{icon:"shift"}]},{width:1/12,chars:[{lowerCase:"\u044f",upperCase:"\u042f"},{lowerCase:"z",upperCase:"Z"}]},{width:1/12,chars:[{lowerCase:"\u0447",upperCase:"\u0427"},{lowerCase:"x",upperCase:"X"}]},{width:1/12,chars:[{lowerCase:"\u0441",upperCase:"\u0421"},{lowerCase:"c",upperCase:"C"}]},{width:1/12,chars:[{lowerCase:"\u043c",upperCase:"\u041c"},{lowerCase:"v",upperCase:"V"}]},{width:1/12,chars:[{lowerCase:"\u0438",upperCase:"\u0418"},{lowerCase:"b",upperCase:"B"}]},{width:1/12,chars:[{lowerCase:"\u0442",upperCase:"\u0422"},{lowerCase:"n",upperCase:"N"}]},{width:1/12,chars:[{lowerCase:"\u044c",upperCase:"\u042c"},{lowerCase:"m",upperCase:"M"}]},{width:1/12,chars:[{lowerCase:"\u0431",upperCase:"\u0411"},{lowerCase:",",upperCase:""}]},{width:1/12,chars:[{lowerCase:"\u044e",upperCase:"\u042e"},{lowerCase:".",upperCase:""}]},{width:.125,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.15,command:"switch-set",chars:[{lowerCase:"eng"}]},{width:.15,command:"switch",chars:[{lowerCase:".?12"}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]],[[{width:.1,chars:[{lowerCase:"1"}]},{width:.1,chars:[{lowerCase:"2"}]},{width:.1,chars:[{lowerCase:"3"}]},{width:.1,chars:[{lowerCase:"4"}]},{width:.1,chars:[{lowerCase:"5"}]},{width:.1,chars:[{lowerCase:"6"}]},{width:.1,chars:[{lowerCase:"7"}]},{width:.1,chars:[{lowerCase:"8"}]},{width:.1,chars:[{lowerCase:"9"}]},{width:.1,chars:[{lowerCase:"0"}]}],[{width:.1,chars:[{lowerCase:"@"}]},{width:.1,chars:[{lowerCase:"#"}]},{width:.1,chars:[{lowerCase:"|"}]},{width:.1,chars:[{lowerCase:"_"}]},{width:.1,chars:[{lowerCase:"&"}]},{width:.1,chars:[{lowerCase:"-"}]},{width:.1,chars:[{lowerCase:"+"}]},{width:.1,chars:[{lowerCase:"("}]},{width:.1,chars:[{lowerCase:")"}]},{width:.1,chars:[{lowerCase:"/"}]}],[{width:.1,chars:[{lowerCase:"="}]},{width:.1,chars:[{lowerCase:"*"}]},{width:.1,chars:[{lowerCase:'"'}]},{width:.1,chars:[{lowerCase:"'"}]},{width:.1,chars:[{lowerCase:":"}]},{width:.1,chars:[{lowerCase:";"}]},{width:.1,chars:[{lowerCase:"!"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.3,command:"switch",chars:[{lowerCase:"\u0410\u0411\u0412"}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]]],Mu_de=[[[{width:1/11,chars:[{lowerCase:"q",upperCase:"Q"}]},{width:1/11,chars:[{lowerCase:"w",upperCase:"W"}]},{width:1/11,chars:[{lowerCase:"e",upperCase:"E"}]},{width:1/11,chars:[{lowerCase:"r",upperCase:"R"}]},{width:1/11,chars:[{lowerCase:"t",upperCase:"T"}]},{width:1/11,chars:[{lowerCase:"z",upperCase:"Z"}]},{width:1/11,chars:[{lowerCase:"u",upperCase:"U"}]},{width:1/11,chars:[{lowerCase:"i",upperCase:"I"}]},{width:1/11,chars:[{lowerCase:"o",upperCase:"O"}]},{width:1/11,chars:[{lowerCase:"p",upperCase:"P"}]},{width:1/11,chars:[{lowerCase:"\xfc",upperCase:"\xdc"}]}],[{width:1/11,chars:[{lowerCase:"a",upperCase:"A"}]},{width:1/11,chars:[{lowerCase:"s",upperCase:"S"}]},{width:1/11,chars:[{lowerCase:"d",upperCase:"D"}]},{width:1/11,chars:[{lowerCase:"f",upperCase:"F"}]},{width:1/11,chars:[{lowerCase:"g",upperCase:"G"}]},{width:1/11,chars:[{lowerCase:"h",upperCase:"H"}]},{width:1/11,chars:[{lowerCase:"j",upperCase:"J"}]},{width:1/11,chars:[{lowerCase:"k",upperCase:"K"}]},{width:1/11,chars:[{lowerCase:"l",upperCase:"L"}]},{width:1/11,chars:[{lowerCase:"\xf6",upperCase:"\xd6"}]},{width:1/11,chars:[{lowerCase:"\xe4",upperCase:"\xc4"}]}],[{width:2/11,command:"shift",chars:[{icon:"shift"}]},{width:1/11,chars:[{lowerCase:"y",upperCase:"Y"}]},{width:1/11,chars:[{lowerCase:"x",upperCase:"X"}]},{width:1/11,chars:[{lowerCase:"c",upperCase:"C"}]},{width:1/11,chars:[{lowerCase:"v",upperCase:"V"}]},{width:1/11,chars:[{lowerCase:"b",upperCase:"B"}]},{width:1/11,chars:[{lowerCase:"n",upperCase:"N"}]},{width:1/11,chars:[{lowerCase:"m",upperCase:"M"}]},{width:2/11,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]],[[{width:.1,chars:[{lowerCase:"1"}]},{width:.1,chars:[{lowerCase:"2"}]},{width:.1,chars:[{lowerCase:"3"}]},{width:.1,chars:[{lowerCase:"4"}]},{width:.1,chars:[{lowerCase:"5"}]},{width:.1,chars:[{lowerCase:"6"}]},{width:.1,chars:[{lowerCase:"7"}]},{width:.1,chars:[{lowerCase:"8"}]},{width:.1,chars:[{lowerCase:"9"}]},{width:.1,chars:[{lowerCase:"0"}]}],[{width:.1,chars:[{lowerCase:"@"}]},{width:.1,chars:[{lowerCase:"#"}]},{width:.1,chars:[{lowerCase:"|"}]},{width:.1,chars:[{lowerCase:"_"}]},{width:.1,chars:[{lowerCase:"&"}]},{width:.1,chars:[{lowerCase:"-"}]},{width:.1,chars:[{lowerCase:"+"}]},{width:.1,chars:[{lowerCase:"("}]},{width:.1,chars:[{lowerCase:")"}]},{width:.1,chars:[{lowerCase:"/"}]}],[{width:.1,chars:[{lowerCase:"="}]},{width:.1,chars:[{lowerCase:"*"}]},{width:.1,chars:[{lowerCase:'"'}]},{width:.1,chars:[{lowerCase:"'"}]},{width:.1,chars:[{lowerCase:":"}]},{width:.1,chars:[{lowerCase:";"}]},{width:.1,chars:[{lowerCase:"!"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]]],Mu_es=[[[{width:.1,chars:[{lowerCase:"q",upperCase:"Q"}]},{width:.1,chars:[{lowerCase:"w",upperCase:"W"}]},{width:.1,chars:[{lowerCase:"e",upperCase:"E"}]},{width:.1,chars:[{lowerCase:"r",upperCase:"R"}]},{width:.1,chars:[{lowerCase:"t",upperCase:"T"}]},{width:.1,chars:[{lowerCase:"y",upperCase:"Y"}]},{width:.1,chars:[{lowerCase:"u",upperCase:"U"}]},{width:.1,chars:[{lowerCase:"i",upperCase:"I"}]},{width:.1,chars:[{lowerCase:"o",upperCase:"O"}]},{width:.1,chars:[{lowerCase:"p",upperCase:"P"}]}],[{width:.1,chars:[{lowerCase:"a",upperCase:"A"}]},{width:.1,chars:[{lowerCase:"s",upperCase:"S"}]},{width:.1,chars:[{lowerCase:"d",upperCase:"D"}]},{width:.1,chars:[{lowerCase:"f",upperCase:"F"}]},{width:.1,chars:[{lowerCase:"g",upperCase:"G"}]},{width:.1,chars:[{lowerCase:"h",upperCase:"H"}]},{width:.1,chars:[{lowerCase:"j",upperCase:"J"}]},{width:.1,chars:[{lowerCase:"k",upperCase:"K"}]},{width:.1,chars:[{lowerCase:"l",upperCase:"L"}]},{width:.1,chars:[{lowerCase:"\xf1",upperCase:"\xd1"}]}],[{width:.15,command:"shift",chars:[{icon:"shift"}]},{width:.1,chars:[{lowerCase:"z",upperCase:"Z"}]},{width:.1,chars:[{lowerCase:"x",upperCase:"X"}]},{width:.1,chars:[{lowerCase:"c",upperCase:"C"}]},{width:.1,chars:[{lowerCase:"v",upperCase:"V"}]},{width:.1,chars:[{lowerCase:"b",upperCase:"B"}]},{width:.1,chars:[{lowerCase:"n",upperCase:"N"}]},{width:.1,chars:[{lowerCase:"m",upperCase:"M"}]},{width:.15,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]],[[{width:.1,chars:[{lowerCase:"1"}]},{width:.1,chars:[{lowerCase:"2"}]},{width:.1,chars:[{lowerCase:"3"}]},{width:.1,chars:[{lowerCase:"4"}]},{width:.1,chars:[{lowerCase:"5"}]},{width:.1,chars:[{lowerCase:"6"}]},{width:.1,chars:[{lowerCase:"7"}]},{width:.1,chars:[{lowerCase:"8"}]},{width:.1,chars:[{lowerCase:"9"}]},{width:.1,chars:[{lowerCase:"0"}]}],[{width:.1,chars:[{lowerCase:"@"}]},{width:.1,chars:[{lowerCase:"#"}]},{width:.1,chars:[{lowerCase:"|"}]},{width:.1,chars:[{lowerCase:"_"}]},{width:.1,chars:[{lowerCase:"&"}]},{width:.1,chars:[{lowerCase:"-"}]},{width:.1,chars:[{lowerCase:"+"}]},{width:.1,chars:[{lowerCase:"("}]},{width:.1,chars:[{lowerCase:")"}]},{width:.1,chars:[{lowerCase:"/"}]}],[{width:.1,chars:[{lowerCase:"="}]},{width:.1,chars:[{lowerCase:"*"}]},{width:.1,chars:[{lowerCase:'"'}]},{width:.1,chars:[{lowerCase:"'"}]},{width:.1,chars:[{lowerCase:":"}]},{width:.1,chars:[{lowerCase:";"}]},{width:.1,chars:[{lowerCase:"!"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]]],Mu_el=[[[{width:.1,chars:[{lowerCase:";",upperCase:":"},{lowerCase:"q",upperCase:"Q"}]},{width:.1,chars:[{lowerCase:"\u03c2",upperCase:"\u03c2"},{lowerCase:"w",upperCase:"W"}]},{width:.1,chars:[{lowerCase:"\u03b5",upperCase:"\u0395"},{lowerCase:"e",upperCase:"E"}]},{width:.1,chars:[{lowerCase:"\u03c1",upperCase:"\u03a1"},{lowerCase:"r",upperCase:"R"}]},{width:.1,chars:[{lowerCase:"\u03c4",upperCase:"\u03a4"},{lowerCase:"t",upperCase:"T"}]},{width:.1,chars:[{lowerCase:"\u03c5",upperCase:"\u03a5"},{lowerCase:"y",upperCase:"Y"}]},{width:.1,chars:[{lowerCase:"\u03b8",upperCase:"\u0398"},{lowerCase:"u",upperCase:"U"}]},{width:.1,chars:[{lowerCase:"\u03b9",upperCase:"\u0399"},{lowerCase:"i",upperCase:"I"}]},{width:.1,chars:[{lowerCase:"\u03bf",upperCase:"\u039f"},{lowerCase:"o",upperCase:"O"}]},{width:.1,chars:[{lowerCase:"\u03c0",upperCase:"\u03a0"},{lowerCase:"p",upperCase:"P"}]}],[{width:.1,chars:[{lowerCase:"\u03b1",upperCase:"\u0391"},{lowerCase:"a",upperCase:"A"}]},{width:.1,chars:[{lowerCase:"\u03c3",upperCase:"\u03a3"},{lowerCase:"s",upperCase:"S"}]},{width:.1,chars:[{lowerCase:"\u03b4",upperCase:"\u0394"},{lowerCase:"d",upperCase:"D"}]},{width:.1,chars:[{lowerCase:"\u03c6",upperCase:"\u03a6"},{lowerCase:"f",upperCase:"F"}]},{width:.1,chars:[{lowerCase:"\u03b3",upperCase:"\u0393"},{lowerCase:"g",upperCase:"G"}]},{width:.1,chars:[{lowerCase:"\u03b7",upperCase:"\u0397"},{lowerCase:"h",upperCase:"H"}]},{width:.1,chars:[{lowerCase:"\u03be",upperCase:"\u039e"},{lowerCase:"j",upperCase:"J"}]},{width:.1,chars:[{lowerCase:"\u03ba",upperCase:"\u039a"},{lowerCase:"k",upperCase:"K"}]},{width:.1,chars:[{lowerCase:"\u03bb",upperCase:"\u039b"},{lowerCase:"l",upperCase:"L"}]}],[{width:.15,command:"shift",chars:[{icon:"shift"}]},{width:.1,chars:[{lowerCase:"\u03b6",upperCase:"\u0396"},{lowerCase:"z",upperCase:"Z"}]},{width:.1,chars:[{lowerCase:"\u03c7",upperCase:"\u03a7"},{lowerCase:"x",upperCase:"X"}]},{width:.1,chars:[{lowerCase:"\u03c8",upperCase:"\u03a8"},{lowerCase:"c",upperCase:"C"}]},{width:.1,chars:[{lowerCase:"\u03c9",upperCase:"\u03a9"},{lowerCase:"v",upperCase:"V"}]},{width:.1,chars:[{lowerCase:"\u03b2",upperCase:"\u0392"},{lowerCase:"b",upperCase:"B"}]},{width:.1,chars:[{lowerCase:"\u03bd",upperCase:"\u039d"},{lowerCase:"n",upperCase:"N"}]},{width:.1,chars:[{lowerCase:"\u03bc",upperCase:"\u039c"},{lowerCase:"m",upperCase:"M"}]},{width:.15,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.15,command:"switch-set",chars:[{lowerCase:"eng"}]},{width:.15,command:"switch",chars:[{lowerCase:".?12"}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]],[[{width:.1,chars:[{lowerCase:"1"}]},{width:.1,chars:[{lowerCase:"2"}]},{width:.1,chars:[{lowerCase:"3"}]},{width:.1,chars:[{lowerCase:"4"}]},{width:.1,chars:[{lowerCase:"5"}]},{width:.1,chars:[{lowerCase:"6"}]},{width:.1,chars:[{lowerCase:"7"}]},{width:.1,chars:[{lowerCase:"8"}]},{width:.1,chars:[{lowerCase:"9"}]},{width:.1,chars:[{lowerCase:"0"}]}],[{width:.1,chars:[{lowerCase:"@"}]},{width:.1,chars:[{lowerCase:"#"}]},{width:.1,chars:[{lowerCase:"|"}]},{width:.1,chars:[{lowerCase:"_"}]},{width:.1,chars:[{lowerCase:"&"}]},{width:.1,chars:[{lowerCase:"-"}]},{width:.1,chars:[{lowerCase:"+"}]},{width:.1,chars:[{lowerCase:"("}]},{width:.1,chars:[{lowerCase:")"}]},{width:.1,chars:[{lowerCase:"/"}]}],[{width:.1,chars:[{lowerCase:"="}]},{width:.1,chars:[{lowerCase:"*"}]},{width:.1,chars:[{lowerCase:'"'}]},{width:.1,chars:[{lowerCase:"'"}]},{width:.1,chars:[{lowerCase:":"}]},{width:.1,chars:[{lowerCase:";"}]},{width:.1,chars:[{lowerCase:"!"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]]],Mu_nord=[[[{width:1/11,chars:[{lowerCase:"q",upperCase:"Q"}]},{width:1/11,chars:[{lowerCase:"w",upperCase:"W"}]},{width:1/11,chars:[{lowerCase:"e",upperCase:"E"}]},{width:1/11,chars:[{lowerCase:"r",upperCase:"R"}]},{width:1/11,chars:[{lowerCase:"t",upperCase:"T"}]},{width:1/11,chars:[{lowerCase:"y",upperCase:"Y"}]},{width:1/11,chars:[{lowerCase:"u",upperCase:"U"}]},{width:1/11,chars:[{lowerCase:"i",upperCase:"I"}]},{width:1/11,chars:[{lowerCase:"o",upperCase:"O"}]},{width:1/11,chars:[{lowerCase:"p",upperCase:"P"}]},{width:1/11,chars:[{lowerCase:"\xe5",upperCase:"\xc5"}]}],[{width:1/11,chars:[{lowerCase:"a",upperCase:"A"}]},{width:1/11,chars:[{lowerCase:"s",upperCase:"S"}]},{width:1/11,chars:[{lowerCase:"d",upperCase:"D"}]},{width:1/11,chars:[{lowerCase:"f",upperCase:"F"}]},{width:1/11,chars:[{lowerCase:"g",upperCase:"G"}]},{width:1/11,chars:[{lowerCase:"h",upperCase:"H"}]},{width:1/11,chars:[{lowerCase:"j",upperCase:"J"}]},{width:1/11,chars:[{lowerCase:"k",upperCase:"K"}]},{width:1/11,chars:[{lowerCase:"l",upperCase:"L"}]},{width:1/11,chars:[{lowerCase:"\xe6",upperCase:"\xc6"}]},{width:1/11,chars:[{lowerCase:"\xf8",upperCase:"\xd8"}]}],[{width:2/11,command:"shift",chars:[{icon:"shift"}]},{width:1/11,chars:[{lowerCase:"z",upperCase:"Z"}]},{width:1/11,chars:[{lowerCase:"x",upperCase:"X"}]},{width:1/11,chars:[{lowerCase:"c",upperCase:"C"}]},{width:1/11,chars:[{lowerCase:"v",upperCase:"V"}]},{width:1/11,chars:[{lowerCase:"b",upperCase:"B"}]},{width:1/11,chars:[{lowerCase:"n",upperCase:"N"}]},{width:1/11,chars:[{lowerCase:"m",upperCase:"M"}]},{width:2/11,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]],[[{width:.1,chars:[{lowerCase:"1"}]},{width:.1,chars:[{lowerCase:"2"}]},{width:.1,chars:[{lowerCase:"3"}]},{width:.1,chars:[{lowerCase:"4"}]},{width:.1,chars:[{lowerCase:"5"}]},{width:.1,chars:[{lowerCase:"6"}]},{width:.1,chars:[{lowerCase:"7"}]},{width:.1,chars:[{lowerCase:"8"}]},{width:.1,chars:[{lowerCase:"9"}]},{width:.1,chars:[{lowerCase:"0"}]}],[{width:.1,chars:[{lowerCase:"@"}]},{width:.1,chars:[{lowerCase:"#"}]},{width:.1,chars:[{lowerCase:"|"}]},{width:.1,chars:[{lowerCase:"_"}]},{width:.1,chars:[{lowerCase:"&"}]},{width:.1,chars:[{lowerCase:"-"}]},{width:.1,chars:[{lowerCase:"+"}]},{width:.1,chars:[{lowerCase:"("}]},{width:.1,chars:[{lowerCase:")"}]},{width:.1,chars:[{lowerCase:"/"}]}],[{width:.1,chars:[{lowerCase:"="}]},{width:.1,chars:[{lowerCase:"*"}]},{width:.1,chars:[{lowerCase:'"'}]},{width:.1,chars:[{lowerCase:"'"}]},{width:.1,chars:[{lowerCase:":"}]},{width:.1,chars:[{lowerCase:";"}]},{width:.1,chars:[{lowerCase:"!"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]]],Koe=new rn.TextureLoader;class sG extends(zm.withBase(rn.Object3D)(IR,SC)){constructor(e){let t;if(e||(e={}),e.width||(e.width=1),e.height||(e.height=.4),e.margin||(e.margin=.003),e.padding||(e.padding=.01),super(e),this.currentPanel=0,this.isLowerCase=!0,this.charsetCount=1,e.language||navigator.language)switch(e.language||navigator.language){case"fr":case"fr-CH":case"fr-CA":t=Mu_fr;break;case"ru":this.charsetCount=2,t=Mu_ru;break;case"de":case"de-DE":case"de-AT":case"de-LI":case"de-CH":t=Mu_de;break;case"es":case"es-419":case"es-AR":case"es-CL":case"es-CO":case"es-ES":case"es-CR":case"es-US":case"es-HN":case"es-MX":case"es-PE":case"es-UY":case"es-VE":t=Mu_es;break;case"el":this.charsetCount=2,t=Mu_el;break;case"nord":t=Mu_nord;break;default:t=Mu_eng}else t=Mu_eng;this.keys=[],this.panels=t.map(i=>{const r=e.height/i.length-2*e.margin,s=new Dv({width:e.width+2*e.padding,height:e.height+2*e.padding,offset:0,padding:e.padding,fontFamily:e.fontFamily,fontTexture:e.fontTexture,backgroundColor:e.backgroundColor,backgroundOpacity:e.backgroundOpacity});return s.charset=0,s.add(...i.map(o=>{const a=new Dv({width:e.width,height:r,margin:e.margin,contentDirection:"row",justifyContent:"center"});a.frame.visible=!1;const l=[];return o.forEach(c=>{const h=new Dv({width:e.width*c.width-2*e.margin,height:r,margin:e.margin,justifyContent:"center",offset:0}),d=c.chars[s.charset].lowerCase||c.chars[s.charset].icon||"undif";if("enter"===d&&e.enterTexture||"shift"===d&&e.shiftTexture||"backspace"===d&&e.backspaceTexture){const p=(()=>{switch(d){case"backspace":return e.backspaceTexture;case"enter":return e.enterTexture;case"shift":return e.shiftTexture;default:console.warn("There is no icon image for this key")}})();Koe.load(p,m=>{h.add(new VR({width:.65*h.width,height:.65*h.height,backgroundSize:"contain",backgroundTexture:m}))})}else h.add(new BR({content:d,offset:0}));h.type="Key",h.info=c,h.info.input=d,h.panel=s,l.push(h),this.keys.push(h)}),a.add(...l),a})),s}),this.add(this.panels[0]),this.set(e)}setNextPanel(){this.panels.forEach(e=>{this.remove(e)}),this.currentPanel=(this.currentPanel+1)%this.panels.length,this.add(this.panels[this.currentPanel]),this.update(!0,!0,!0)}setNextCharset(){this.panels[this.currentPanel].charset=(this.panels[this.currentPanel].charset+1)%this.charsetCount,this.keys.forEach(e=>{if(!this.panels[this.currentPanel].getObjectById(e.id))return;const i=e.info.chars[e.panel.charset]||e.info.chars[0],r=this.isLowerCase||!i.upperCase?i.lowerCase:i.upperCase;if(!e.childrenTexts.length)return;const s=e.childrenTexts[0];e.info.input=r,s.set({content:r}),s.update(!0,!0,!0)})}toggleCase(){this.isLowerCase=!this.isLowerCase,this.keys.forEach(e=>{const t=e.info.chars[e.panel.charset]||e.info.chars[0],i=this.isLowerCase||!t.upperCase?t.lowerCase:t.upperCase;if(!e.childrenTexts.length)return;const r=e.childrenTexts[0];e.info.input=i,r.set({content:i}),r.update(!0,!0,!0)})}parseParams(){}updateLayout(){}updateInner(){}}const oG=()=>Av.update(),aG={Block:Dv,Text:BR,InlineBlock:VR,Keyboard:sG,FontLibrary:Tv,update:oG,TextAlign:mC,Whitespace:pC,JustifyContent:fC,AlignItems:dC,ContentDirection:hC};typeof global<"u"&&(global.ThreeMeshUI=aG);const Zoe=aG;var Joe=oo.gO,Qoe=oo.xv,eae=oo.Vx;const tae=[0,2e3,1e4,3e4,null];class lG{constructor(e){this._retryDelays=void 0!==e?[...e,null]:tae}nextRetryDelayInMilliseconds(e){return this._retryDelays[e.previousRetryCount]}}let Iv=(()=>{class n{}return n.Authorization="Authorization",n.Cookie="Cookie",n})();class cG{constructor(e,t,i){this.statusCode=e,this.statusText=t,this.content=i}}class xC{get(e,t){return this.send({...t,method:"GET",url:e})}post(e,t){return this.send({...t,method:"POST",url:e})}delete(e,t){return this.send({...t,method:"DELETE",url:e})}getCookieString(e){return""}}class nae extends xC{constructor(e,t){super(),this._innerClient=e,this._accessTokenFactory=t}send(e){var t=this;return Pn(function*(){let i=!0;t._accessTokenFactory&&(!t._accessToken||e.url&&e.url.indexOf("/negotiate?")>0)&&(i=!1,t._accessToken=yield t._accessTokenFactory()),t._setAuthorizationHeader(e);const r=yield t._innerClient.send(e);return i&&401===r.statusCode&&t._accessTokenFactory?(t._accessToken=yield t._accessTokenFactory(),t._setAuthorizationHeader(e),yield t._innerClient.send(e)):r})()}_setAuthorizationHeader(e){e.headers||(e.headers={}),this._accessToken?e.headers[Iv.Authorization]=`Bearer ${this._accessToken}`:this._accessTokenFactory&&e.headers[Iv.Authorization]&&delete e.headers[Iv.Authorization]}getCookieString(e){return this._innerClient.getCookieString(e)}}class Gm extends Error{constructor(e,t){const i=new.target.prototype;super(`${e}: Status code '${t}'`),this.statusCode=t,this.__proto__=i}}class HR extends Error{constructor(e="A timeout occurred."){const t=new.target.prototype;super(e),this.__proto__=t}}class ma extends Error{constructor(e="An abort occurred."){const t=new.target.prototype;super(e),this.__proto__=t}}class iae extends Error{constructor(e,t){const i=new.target.prototype;super(e),this.transport=t,this.errorType="UnsupportedTransportError",this.__proto__=i}}class rae extends Error{constructor(e,t){const i=new.target.prototype;super(e),this.transport=t,this.errorType="DisabledTransportError",this.__proto__=i}}class sae extends Error{constructor(e,t){const i=new.target.prototype;super(e),this.transport=t,this.errorType="FailedToStartTransportError",this.__proto__=i}}class oae extends Error{constructor(e){const t=new.target.prototype;super(e),this.errorType="FailedToNegotiateWithServerError",this.__proto__=t}}class aae extends Error{constructor(e,t){const i=new.target.prototype;super(e),this.innerErrors=t,this.__proto__=i}}var _e=function(n){return n[n.Trace=0]="Trace",n[n.Debug=1]="Debug",n[n.Information=2]="Information",n[n.Warning=3]="Warning",n[n.Error=4]="Error",n[n.Critical=5]="Critical",n[n.None=6]="None",n}(_e||{});class Rv{constructor(){}log(e,t){}}Rv.instance=new Rv;const lae="7.0.12";class _r{static isRequired(e,t){if(null==e)throw new Error(`The '${t}' argument is required.`)}static isNotEmpty(e,t){if(!e||e.match(/^\s*$/))throw new Error(`The '${t}' argument should not be empty.`)}static isIn(e,t,i){if(!(e in t))throw new Error(`Unknown ${i} value: ${e}.`)}}class yr{static get isBrowser(){return"object"==typeof window&&"object"==typeof window.document}static get isWebWorker(){return"object"==typeof self&&"importScripts"in self}static get isReactNative(){return"object"==typeof window&&typeof window.document>"u"}static get isNode(){return!this.isBrowser&&!this.isWebWorker&&!this.isReactNative}}function Pv(n,e){let t="";return Nv(n)?(t=`Binary data of length ${n.byteLength}`,e&&(t+=`. Content: '${function cae(n){const e=new Uint8Array(n);let t="";return e.forEach(i=>{t+=`0x${i<16?"0":""}${i.toString(16)} `}),t.substr(0,t.length-1)}(n)}'`)):"string"==typeof n&&(t=`String data of length ${n.length}`,e&&(t+=`. Content: '${n}'`)),t}function Nv(n){return n&&typeof ArrayBuffer<"u"&&(n instanceof ArrayBuffer||n.constructor&&"ArrayBuffer"===n.constructor.name)}function uG(n,e,t,i,r,s){return zR.apply(this,arguments)}function zR(){return zR=Pn(function*(n,e,t,i,r,s){const o={},[a,l]=Wm();o[a]=l,n.log(_e.Trace,`(${e} transport) sending data. ${Pv(r,s.logMessageContent)}.`);const c=Nv(r)?"arraybuffer":"text",h=yield t.post(i,{content:r,headers:{...o,...s.headers},responseType:c,timeout:s.timeout,withCredentials:s.withCredentials});n.log(_e.Trace,`(${e} transport) request complete. Response status: ${h.statusCode}.`)}),zR.apply(this,arguments)}class hae{constructor(e,t){this._subject=e,this._observer=t}dispose(){const e=this._subject.observers.indexOf(this._observer);e>-1&&this._subject.observers.splice(e,1),0===this._subject.observers.length&&this._subject.cancelCallback&&this._subject.cancelCallback().catch(t=>{})}}class MC{constructor(e){this._minLevel=e,this.out=console}log(e,t){if(e>=this._minLevel){const i=`[${(new Date).toISOString()}] ${_e[e]}: ${t}`;switch(e){case _e.Critical:case _e.Error:this.out.error(i);break;case _e.Warning:this.out.warn(i);break;case _e.Information:this.out.info(i);break;default:this.out.log(i)}}}}function Wm(){let n="X-SignalR-User-Agent";return yr.isNode&&(n="User-Agent"),[n,dae(lae,fae(),yr.isNode?"NodeJS":"Browser",pae())]}function dae(n,e,t,i){let r="Microsoft SignalR/";const s=n.split(".");return r+=`${s[0]}.${s[1]}`,r+=` (${n}; `,r+=e&&""!==e?`${e}; `:"Unknown OS; ",r+=`${t}`,r+=i?`; ${i}`:"; Unknown Runtime Version",r+=")",r}function fae(){if(!yr.isNode)return"";switch(process.platform){case"win32":return"Windows NT";case"darwin":return"macOS";case"linux":return"Linux";default:return process.platform}}function pae(){if(yr.isNode)return process.versions.node}function hG(n){return n.stack?n.stack:n.message?n.message:`${n}`}class _ae extends xC{constructor(e){if(super(),this._logger=e,typeof fetch>"u"){const t=require;this._jar=new(t("tough-cookie").CookieJar),this._fetchType=t("node-fetch"),this._fetchType=t("fetch-cookie")(this._fetchType,this._jar)}else this._fetchType=fetch.bind(function gae(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("could not find global")}());if(typeof AbortController>"u"){const t=require;this._abortControllerType=t("abort-controller")}else this._abortControllerType=AbortController}send(e){var t=this;return Pn(function*(){if(e.abortSignal&&e.abortSignal.aborted)throw new ma;if(!e.method)throw new Error("No method defined.");if(!e.url)throw new Error("No url defined.");const i=new t._abortControllerType;let r;e.abortSignal&&(e.abortSignal.onabort=()=>{i.abort(),r=new ma});let o,s=null;e.timeout&&(s=setTimeout(()=>{i.abort(),t._logger.log(_e.Warning,"Timeout from HTTP request."),r=new HR},e.timeout)),""===e.content&&(e.content=void 0),e.content&&(e.headers=e.headers||{},e.headers["Content-Type"]=Nv(e.content)?"application/octet-stream":"text/plain;charset=UTF-8");try{o=yield t._fetchType(e.url,{body:e.content,cache:"no-cache",credentials:!0===e.withCredentials?"include":"same-origin",headers:{"X-Requested-With":"XMLHttpRequest",...e.headers},method:e.method,mode:"cors",redirect:"follow",signal:i.signal})}catch(c){throw r||(t._logger.log(_e.Warning,`Error from HTTP request. ${c}.`),c)}finally{s&&clearTimeout(s),e.abortSignal&&(e.abortSignal.onabort=null)}if(!o.ok){const c=yield dG(o,"text");throw new Gm(c||o.statusText,o.status)}const l=yield dG(o,e.responseType);return new cG(o.status,o.statusText,l)})()}getCookieString(e){let t="";return yr.isNode&&this._jar&&this._jar.getCookies(e,(i,r)=>t=r.join("; ")),t}}function dG(n,e){let t;switch(e){case"arraybuffer":t=n.arrayBuffer();break;case"text":default:t=n.text();break;case"blob":case"document":case"json":throw new Error(`${e} is not supported.`)}return t}class yae extends xC{constructor(e){super(),this._logger=e}send(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new ma):e.method?e.url?new Promise((t,i)=>{const r=new XMLHttpRequest;r.open(e.method,e.url,!0),r.withCredentials=void 0===e.withCredentials||e.withCredentials,r.setRequestHeader("X-Requested-With","XMLHttpRequest"),""===e.content&&(e.content=void 0),e.content&&(Nv(e.content)?r.setRequestHeader("Content-Type","application/octet-stream"):r.setRequestHeader("Content-Type","text/plain;charset=UTF-8"));const s=e.headers;s&&Object.keys(s).forEach(o=>{r.setRequestHeader(o,s[o])}),e.responseType&&(r.responseType=e.responseType),e.abortSignal&&(e.abortSignal.onabort=()=>{r.abort(),i(new ma)}),e.timeout&&(r.timeout=e.timeout),r.onload=()=>{e.abortSignal&&(e.abortSignal.onabort=null),r.status>=200&&r.status<300?t(new cG(r.status,r.statusText,r.response||r.responseText)):i(new Gm(r.response||r.responseText||r.statusText,r.status))},r.onerror=()=>{this._logger.log(_e.Warning,`Error from HTTP request. ${r.status}: ${r.statusText}.`),i(new Gm(r.statusText,r.status))},r.ontimeout=()=>{this._logger.log(_e.Warning,"Timeout from HTTP request."),i(new HR)},r.send(e.content)}):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}}class vae extends xC{constructor(e){if(super(),typeof fetch<"u"||yr.isNode)this._httpClient=new _ae(e);else{if(!(typeof XMLHttpRequest<"u"))throw new Error("No usable HttpClient found.");this._httpClient=new yae(e)}}send(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new ma):e.method?e.url?this._httpClient.send(e):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}getCookieString(e){return this._httpClient.getCookieString(e)}}var Ir=function(n){return n[n.None=0]="None",n[n.WebSockets=1]="WebSockets",n[n.ServerSentEvents=2]="ServerSentEvents",n[n.LongPolling=4]="LongPolling",n}(Ir||{}),vs=function(n){return n[n.Text=1]="Text",n[n.Binary=2]="Binary",n}(vs||{});class wae{constructor(){this._isAborted=!1,this.onabort=null}abort(){this._isAborted||(this._isAborted=!0,this.onabort&&this.onabort())}get signal(){return this}get aborted(){return this._isAborted}}class fG{constructor(e,t,i){this._httpClient=e,this._logger=t,this._pollAbort=new wae,this._options=i,this._running=!1,this.onreceive=null,this.onclose=null}get pollAborted(){return this._pollAbort.aborted}connect(e,t){var i=this;return Pn(function*(){if(_r.isRequired(e,"url"),_r.isRequired(t,"transferFormat"),_r.isIn(t,vs,"transferFormat"),i._url=e,i._logger.log(_e.Trace,"(LongPolling transport) Connecting."),t===vs.Binary&&typeof XMLHttpRequest<"u"&&"string"!=typeof(new XMLHttpRequest).responseType)throw new Error("Binary protocols over XmlHttpRequest not implementing advanced features are not supported.");const[r,s]=Wm(),o={[r]:s,...i._options.headers},a={abortSignal:i._pollAbort.signal,headers:o,timeout:1e5,withCredentials:i._options.withCredentials};t===vs.Binary&&(a.responseType="arraybuffer");const l=`${e}&_=${Date.now()}`;i._logger.log(_e.Trace,`(LongPolling transport) polling: ${l}.`);const c=yield i._httpClient.get(l,a);200!==c.statusCode?(i._logger.log(_e.Error,`(LongPolling transport) Unexpected response code: ${c.statusCode}.`),i._closeError=new Gm(c.statusText||"",c.statusCode),i._running=!1):i._running=!0,i._receiving=i._poll(i._url,a)})()}_poll(e,t){var i=this;return Pn(function*(){try{for(;i._running;)try{const r=`${e}&_=${Date.now()}`;i._logger.log(_e.Trace,`(LongPolling transport) polling: ${r}.`);const s=yield i._httpClient.get(r,t);204===s.statusCode?(i._logger.log(_e.Information,"(LongPolling transport) Poll terminated by server."),i._running=!1):200!==s.statusCode?(i._logger.log(_e.Error,`(LongPolling transport) Unexpected response code: ${s.statusCode}.`),i._closeError=new Gm(s.statusText||"",s.statusCode),i._running=!1):s.content?(i._logger.log(_e.Trace,`(LongPolling transport) data received. ${Pv(s.content,i._options.logMessageContent)}.`),i.onreceive&&i.onreceive(s.content)):i._logger.log(_e.Trace,"(LongPolling transport) Poll timed out, reissuing.")}catch(r){i._running?r instanceof HR?i._logger.log(_e.Trace,"(LongPolling transport) Poll timed out, reissuing."):(i._closeError=r,i._running=!1):i._logger.log(_e.Trace,`(LongPolling transport) Poll errored after shutdown: ${r.message}`)}}finally{i._logger.log(_e.Trace,"(LongPolling transport) Polling complete."),i.pollAborted||i._raiseOnClose()}})()}send(e){var t=this;return Pn(function*(){return t._running?uG(t._logger,"LongPolling",t._httpClient,t._url,e,t._options):Promise.reject(new Error("Cannot send until the transport is connected"))})()}stop(){var e=this;return Pn(function*(){e._logger.log(_e.Trace,"(LongPolling transport) Stopping polling."),e._running=!1,e._pollAbort.abort();try{yield e._receiving,e._logger.log(_e.Trace,`(LongPolling transport) sending DELETE request to ${e._url}.`);const t={},[i,r]=Wm();t[i]=r;const s={headers:{...t,...e._options.headers},timeout:e._options.timeout,withCredentials:e._options.withCredentials};yield e._httpClient.delete(e._url,s),e._logger.log(_e.Trace,"(LongPolling transport) DELETE request sent.")}finally{e._logger.log(_e.Trace,"(LongPolling transport) Stop finished."),e._raiseOnClose()}})()}_raiseOnClose(){if(this.onclose){let e="(LongPolling transport) Firing onclose event.";this._closeError&&(e+=" Error: "+this._closeError),this._logger.log(_e.Trace,e),this.onclose(this._closeError)}}}class bae{constructor(e,t,i,r){this._httpClient=e,this._accessToken=t,this._logger=i,this._options=r,this.onreceive=null,this.onclose=null}connect(e,t){var i=this;return Pn(function*(){return _r.isRequired(e,"url"),_r.isRequired(t,"transferFormat"),_r.isIn(t,vs,"transferFormat"),i._logger.log(_e.Trace,"(SSE transport) Connecting."),i._url=e,i._accessToken&&(e+=(e.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(i._accessToken)}`),new Promise((r,s)=>{let a,o=!1;if(t===vs.Text){if(yr.isBrowser||yr.isWebWorker)a=new i._options.EventSource(e,{withCredentials:i._options.withCredentials});else{const l=i._httpClient.getCookieString(e),c={};c.Cookie=l;const[h,d]=Wm();c[h]=d,a=new i._options.EventSource(e,{withCredentials:i._options.withCredentials,headers:{...c,...i._options.headers}})}try{a.onmessage=l=>{if(i.onreceive)try{i._logger.log(_e.Trace,`(SSE transport) data received. ${Pv(l.data,i._options.logMessageContent)}.`),i.onreceive(l.data)}catch(c){return void i._close(c)}},a.onerror=l=>{o?i._close():s(new Error("EventSource failed to connect. The connection could not be found on the server, either the connection ID is not present on the server, or a proxy is refusing/buffering the connection. If you have multiple servers check that sticky sessions are enabled."))},a.onopen=()=>{i._logger.log(_e.Information,`SSE connected to ${i._url}`),i._eventSource=a,o=!0,r()}}catch(l){return void s(l)}}else s(new Error("The Server-Sent Events transport only supports the 'Text' transfer format"))})})()}send(e){var t=this;return Pn(function*(){return t._eventSource?uG(t._logger,"SSE",t._httpClient,t._url,e,t._options):Promise.reject(new Error("Cannot send until the transport is connected"))})()}stop(){return this._close(),Promise.resolve()}_close(e){this._eventSource&&(this._eventSource.close(),this._eventSource=void 0,this.onclose&&this.onclose(e))}}class Eae{constructor(e,t,i,r,s,o){this._logger=i,this._accessTokenFactory=t,this._logMessageContent=r,this._webSocketConstructor=s,this._httpClient=e,this.onreceive=null,this.onclose=null,this._headers=o}connect(e,t){var i=this;return Pn(function*(){let r;return _r.isRequired(e,"url"),_r.isRequired(t,"transferFormat"),_r.isIn(t,vs,"transferFormat"),i._logger.log(_e.Trace,"(WebSockets transport) Connecting."),i._accessTokenFactory&&(r=yield i._accessTokenFactory()),new Promise((s,o)=>{let a;e=e.replace(/^http/,"ws");const l=i._httpClient.getCookieString(e);let c=!1;if(yr.isNode||yr.isReactNative){const h={},[d,p]=Wm();h[d]=p,r&&(h[Iv.Authorization]=`Bearer ${r}`),l&&(h[Iv.Cookie]=l),a=new i._webSocketConstructor(e,void 0,{headers:{...h,...i._headers}})}else r&&(e+=(e.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(r)}`);a||(a=new i._webSocketConstructor(e)),t===vs.Binary&&(a.binaryType="arraybuffer"),a.onopen=h=>{i._logger.log(_e.Information,`WebSocket connected to ${e}.`),i._webSocket=a,c=!0,s()},a.onerror=h=>{let d=null;d=typeof ErrorEvent<"u"&&h instanceof ErrorEvent?h.error:"There was an error with the transport",i._logger.log(_e.Information,`(WebSockets transport) ${d}.`)},a.onmessage=h=>{if(i._logger.log(_e.Trace,`(WebSockets transport) data received. ${Pv(h.data,i._logMessageContent)}.`),i.onreceive)try{i.onreceive(h.data)}catch(d){return void i._close(d)}},a.onclose=h=>{if(c)i._close(h);else{let d=null;d=typeof ErrorEvent<"u"&&h instanceof ErrorEvent?h.error:"WebSocket failed to connect. The connection could not be found on the server, either the endpoint may not be a SignalR endpoint, the connection ID is not present on the server, or there is a proxy blocking WebSockets. If you have multiple servers check that sticky sessions are enabled.",o(new Error(d))}}})})()}send(e){return this._webSocket&&this._webSocket.readyState===this._webSocketConstructor.OPEN?(this._logger.log(_e.Trace,`(WebSockets transport) sending data. ${Pv(e,this._logMessageContent)}.`),this._webSocket.send(e),Promise.resolve()):Promise.reject("WebSocket is not in the OPEN state")}stop(){return this._webSocket&&this._close(void 0),Promise.resolve()}_close(e){this._webSocket&&(this._webSocket.onclose=()=>{},this._webSocket.onmessage=()=>{},this._webSocket.onerror=()=>{},this._webSocket.close(),this._webSocket=void 0),this._logger.log(_e.Trace,"(WebSockets transport) socket closed."),this.onclose&&(!this._isCloseEvent(e)||!1!==e.wasClean&&1e3===e.code?e instanceof Error?this.onclose(e):this.onclose():this.onclose(new Error(`WebSocket closed with status code: ${e.code} (${e.reason||"no reason given"}).`)))}_isCloseEvent(e){return e&&"boolean"==typeof e.wasClean&&"number"==typeof e.code}}class Sae{constructor(e,t={}){if(this._stopPromiseResolver=()=>{},this.features={},this._negotiateVersion=1,_r.isRequired(e,"url"),this._logger=function uae(n){return void 0===n?new MC(_e.Information):null===n?Rv.instance:void 0!==n.log?n:new MC(n)}(t.logger),this.baseUrl=this._resolveUrl(e),(t=t||{}).logMessageContent=void 0!==t.logMessageContent&&t.logMessageContent,"boolean"!=typeof t.withCredentials&&void 0!==t.withCredentials)throw new Error("withCredentials option was not a 'boolean' or 'undefined' value");t.withCredentials=void 0===t.withCredentials||t.withCredentials,t.timeout=void 0===t.timeout?1e5:t.timeout;let i=null,r=null;if(yr.isNode){const s=require;i=s("ws"),r=s("eventsource")}!yr.isNode&&typeof WebSocket<"u"&&!t.WebSocket?t.WebSocket=WebSocket:yr.isNode&&!t.WebSocket&&i&&(t.WebSocket=i),!yr.isNode&&typeof EventSource<"u"&&!t.EventSource?t.EventSource=EventSource:yr.isNode&&!t.EventSource&&typeof r<"u"&&(t.EventSource=r),this._httpClient=new nae(t.httpClient||new vae(this._logger),t.accessTokenFactory),this._connectionState="Disconnected",this._connectionStarted=!1,this._options=t,this.onreceive=null,this.onclose=null}start(e){var t=this;return Pn(function*(){if(_r.isIn(e=e||vs.Binary,vs,"transferFormat"),t._logger.log(_e.Debug,`Starting connection with transfer format '${vs[e]}'.`),"Disconnected"!==t._connectionState)return Promise.reject(new Error("Cannot start an HttpConnection that is not in the 'Disconnected' state."));if(t._connectionState="Connecting",t._startInternalPromise=t._startInternal(e),yield t._startInternalPromise,"Disconnecting"===t._connectionState){const i="Failed to start the HttpConnection before stop() was called.";return t._logger.log(_e.Error,i),yield t._stopPromise,Promise.reject(new ma(i))}if("Connected"!==t._connectionState){const i="HttpConnection.startInternal completed gracefully but didn't enter the connection into the connected state!";return t._logger.log(_e.Error,i),Promise.reject(new ma(i))}t._connectionStarted=!0})()}send(e){return"Connected"!==this._connectionState?Promise.reject(new Error("Cannot send data if the connection is not in the 'Connected' State.")):(this._sendQueue||(this._sendQueue=new GR(this.transport)),this._sendQueue.send(e))}stop(e){var t=this;return Pn(function*(){return"Disconnected"===t._connectionState?(t._logger.log(_e.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnected state.`),Promise.resolve()):"Disconnecting"===t._connectionState?(t._logger.log(_e.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnecting state.`),t._stopPromise):(t._connectionState="Disconnecting",t._stopPromise=new Promise(i=>{t._stopPromiseResolver=i}),yield t._stopInternal(e),void(yield t._stopPromise))})()}_stopInternal(e){var t=this;return Pn(function*(){t._stopError=e;try{yield t._startInternalPromise}catch{}if(t.transport){try{yield t.transport.stop()}catch(i){t._logger.log(_e.Error,`HttpConnection.transport.stop() threw error '${i}'.`),t._stopConnection()}t.transport=void 0}else t._logger.log(_e.Debug,"HttpConnection.transport is undefined in HttpConnection.stop() because start() failed.")})()}_startInternal(e){var t=this;return Pn(function*(){let i=t.baseUrl;t._accessTokenFactory=t._options.accessTokenFactory,t._httpClient._accessTokenFactory=t._accessTokenFactory;try{if(t._options.skipNegotiation){if(t._options.transport!==Ir.WebSockets)throw new Error("Negotiation can only be skipped when using the WebSocket transport directly.");t.transport=t._constructTransport(Ir.WebSockets),yield t._startTransport(i,e)}else{let r=null,s=0;do{if(r=yield t._getNegotiationResponse(i),"Disconnecting"===t._connectionState||"Disconnected"===t._connectionState)throw new ma("The connection was stopped during negotiation.");if(r.error)throw new Error(r.error);if(r.ProtocolVersion)throw new Error("Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.");if(r.url&&(i=r.url),r.accessToken){const o=r.accessToken;t._accessTokenFactory=()=>o,t._httpClient._accessToken=o,t._httpClient._accessTokenFactory=void 0}s++}while(r.url&&s<100);if(100===s&&r.url)throw new Error("Negotiate redirection limit exceeded.");yield t._createTransport(i,t._options.transport,r,e)}t.transport instanceof fG&&(t.features.inherentKeepAlive=!0),"Connecting"===t._connectionState&&(t._logger.log(_e.Debug,"The HttpConnection connected successfully."),t._connectionState="Connected")}catch(r){return t._logger.log(_e.Error,"Failed to start the connection: "+r),t._connectionState="Disconnected",t.transport=void 0,t._stopPromiseResolver(),Promise.reject(r)}})()}_getNegotiationResponse(e){var t=this;return Pn(function*(){const i={},[r,s]=Wm();i[r]=s;const o=t._resolveNegotiateUrl(e);t._logger.log(_e.Debug,`Sending negotiation request: ${o}.`);try{const a=yield t._httpClient.post(o,{content:"",headers:{...i,...t._options.headers},timeout:t._options.timeout,withCredentials:t._options.withCredentials});if(200!==a.statusCode)return Promise.reject(new Error(`Unexpected status code returned from negotiate '${a.statusCode}'`));const l=JSON.parse(a.content);return(!l.negotiateVersion||l.negotiateVersion<1)&&(l.connectionToken=l.connectionId),l}catch(a){let l="Failed to complete negotiation with the server: "+a;return a instanceof Gm&&404===a.statusCode&&(l+=" Either this is not a SignalR endpoint or there is a proxy blocking the connection."),t._logger.log(_e.Error,l),Promise.reject(new oae(l))}})()}_createConnectUrl(e,t){return t?e+(-1===e.indexOf("?")?"?":"&")+`id=${t}`:e}_createTransport(e,t,i,r){var s=this;return Pn(function*(){let o=s._createConnectUrl(e,i.connectionToken);if(s._isITransport(t))return s._logger.log(_e.Debug,"Connection was provided an instance of ITransport, using that directly."),s.transport=t,yield s._startTransport(o,r),void(s.connectionId=i.connectionId);const a=[],l=i.availableTransports||[];let c=i;for(const h of l){const d=s._resolveTransportOrError(h,t,r);if(d instanceof Error)a.push(`${h.transport} failed:`),a.push(d);else if(s._isITransport(d)){if(s.transport=d,!c){try{c=yield s._getNegotiationResponse(e)}catch(p){return Promise.reject(p)}o=s._createConnectUrl(e,c.connectionToken)}try{return yield s._startTransport(o,r),void(s.connectionId=c.connectionId)}catch(p){if(s._logger.log(_e.Error,`Failed to start the transport '${h.transport}': ${p}`),c=void 0,a.push(new sae(`${h.transport} failed: ${p}`,Ir[h.transport])),"Connecting"!==s._connectionState){const m="Failed to select transport before stop() was called.";return s._logger.log(_e.Debug,m),Promise.reject(new ma(m))}}}}return Promise.reject(a.length>0?new aae(`Unable to connect to the server with any of the available transports. ${a.join(" ")}`,a):new Error("None of the transports supported by the client are supported by the server."))})()}_constructTransport(e){switch(e){case Ir.WebSockets:if(!this._options.WebSocket)throw new Error("'WebSocket' is not supported in your environment.");return new Eae(this._httpClient,this._accessTokenFactory,this._logger,this._options.logMessageContent,this._options.WebSocket,this._options.headers||{});case Ir.ServerSentEvents:if(!this._options.EventSource)throw new Error("'EventSource' is not supported in your environment.");return new bae(this._httpClient,this._httpClient._accessToken,this._logger,this._options);case Ir.LongPolling:return new fG(this._httpClient,this._logger,this._options);default:throw new Error(`Unknown transport: ${e}.`)}}_startTransport(e,t){return this.transport.onreceive=this.onreceive,this.transport.onclose=i=>this._stopConnection(i),this.transport.connect(e,t)}_resolveTransportOrError(e,t,i){const r=Ir[e.transport];if(null==r)return this._logger.log(_e.Debug,`Skipping transport '${e.transport}' because it is not supported by this client.`),new Error(`Skipping transport '${e.transport}' because it is not supported by this client.`);if(!function Cae(n,e){return!n||0!=(e&n)}(t,r))return this._logger.log(_e.Debug,`Skipping transport '${Ir[r]}' because it was disabled by the client.`),new rae(`'${Ir[r]}' is disabled by the client.`,r);if(!(e.transferFormats.map(o=>vs[o]).indexOf(i)>=0))return this._logger.log(_e.Debug,`Skipping transport '${Ir[r]}' because it does not support the requested transfer format '${vs[i]}'.`),new Error(`'${Ir[r]}' does not support ${vs[i]}.`);if(r===Ir.WebSockets&&!this._options.WebSocket||r===Ir.ServerSentEvents&&!this._options.EventSource)return this._logger.log(_e.Debug,`Skipping transport '${Ir[r]}' because it is not supported in your environment.'`),new iae(`'${Ir[r]}' is not supported in your environment.`,r);this._logger.log(_e.Debug,`Selecting transport '${Ir[r]}'.`);try{return this._constructTransport(r)}catch(o){return o}}_isITransport(e){return e&&"object"==typeof e&&"connect"in e}_stopConnection(e){if(this._logger.log(_e.Debug,`HttpConnection.stopConnection(${e}) called while in state ${this._connectionState}.`),this.transport=void 0,e=this._stopError||e,this._stopError=void 0,"Disconnected"!==this._connectionState){if("Connecting"===this._connectionState)throw this._logger.log(_e.Warning,`Call to HttpConnection.stopConnection(${e}) was ignored because the connection is still in the connecting state.`),new Error(`HttpConnection.stopConnection(${e}) was called while the connection is still in the connecting state.`);if("Disconnecting"===this._connectionState&&this._stopPromiseResolver(),e?this._logger.log(_e.Error,`Connection disconnected with error '${e}'.`):this._logger.log(_e.Information,"Connection disconnected."),this._sendQueue&&(this._sendQueue.stop().catch(t=>{this._logger.log(_e.Error,`TransportSendQueue.stop() threw error '${t}'.`)}),this._sendQueue=void 0),this.connectionId=void 0,this._connectionState="Disconnected",this._connectionStarted){this._connectionStarted=!1;try{this.onclose&&this.onclose(e)}catch(t){this._logger.log(_e.Error,`HttpConnection.onclose(${e}) threw error '${t}'.`)}}}else this._logger.log(_e.Debug,`Call to HttpConnection.stopConnection(${e}) was ignored because the connection is already in the disconnected state.`)}_resolveUrl(e){if(0===e.lastIndexOf("https://",0)||0===e.lastIndexOf("http://",0))return e;if(!yr.isBrowser)throw new Error(`Cannot resolve '${e}'.`);const t=window.document.createElement("a");return t.href=e,this._logger.log(_e.Information,`Normalizing '${e}' to '${t.href}'.`),t.href}_resolveNegotiateUrl(e){const t=e.indexOf("?");let i=e.substring(0,-1===t?e.length:t);return"/"!==i[i.length-1]&&(i+="/"),i+="negotiate",i+=-1===t?"":e.substring(t),-1===i.indexOf("negotiateVersion")&&(i+=-1===t?"?":"&",i+="negotiateVersion="+this._negotiateVersion),i}}class GR{constructor(e){this._transport=e,this._buffer=[],this._executing=!0,this._sendBufferedData=new TC,this._transportResult=new TC,this._sendLoopPromise=this._sendLoop()}send(e){return this._bufferData(e),this._transportResult||(this._transportResult=new TC),this._transportResult.promise}stop(){return this._executing=!1,this._sendBufferedData.resolve(),this._sendLoopPromise}_bufferData(e){if(this._buffer.length&&typeof this._buffer[0]!=typeof e)throw new Error(`Expected data to be of type ${typeof this._buffer} but was of type ${typeof e}`);this._buffer.push(e),this._sendBufferedData.resolve()}_sendLoop(){var e=this;return Pn(function*(){for(;;){if(yield e._sendBufferedData.promise,!e._executing){e._transportResult&&e._transportResult.reject("Connection stopped.");break}e._sendBufferedData=new TC;const t=e._transportResult;e._transportResult=void 0;const i="string"==typeof e._buffer[0]?e._buffer.join(""):GR._concatBuffers(e._buffer);e._buffer.length=0;try{yield e._transport.send(i),t.resolve()}catch(r){t.reject(r)}}})()}static _concatBuffers(e){const t=e.map(s=>s.byteLength).reduce((s,o)=>s+o),i=new Uint8Array(t);let r=0;for(const s of e)i.set(new Uint8Array(s),r),r+=s.byteLength;return i.buffer}}class TC{constructor(){this.promise=new Promise((e,t)=>[this._resolver,this._rejecter]=[e,t])}resolve(){this._resolver()}reject(e){this._rejecter(e)}}class ao{static write(e){return`${e}${ao.RecordSeparator}`}static parse(e){if(e[e.length-1]!==ao.RecordSeparator)throw new Error("Message is incomplete.");const t=e.split(ao.RecordSeparator);return t.pop(),t}}ao.RecordSeparatorCode=30,ao.RecordSeparator=String.fromCharCode(ao.RecordSeparatorCode);class xae{writeHandshakeRequest(e){return ao.write(JSON.stringify(e))}parseHandshakeResponse(e){let t,i;if(Nv(e)){const a=new Uint8Array(e),l=a.indexOf(ao.RecordSeparatorCode);if(-1===l)throw new Error("Message is incomplete.");const c=l+1;t=String.fromCharCode.apply(null,Array.prototype.slice.call(a.slice(0,c))),i=a.byteLength>c?a.slice(c).buffer:null}else{const a=e,l=a.indexOf(ao.RecordSeparator);if(-1===l)throw new Error("Message is incomplete.");const c=l+1;t=a.substring(0,c),i=a.length>c?a.substring(c):null}const r=ao.parse(t),s=JSON.parse(r[0]);if(s.type)throw new Error("Expected a handshake response from the server.");return[i,s]}}var ii=function(n){return n[n.Invocation=1]="Invocation",n[n.StreamItem=2]="StreamItem",n[n.Completion=3]="Completion",n[n.StreamInvocation=4]="StreamInvocation",n[n.CancelInvocation=5]="CancelInvocation",n[n.Ping=6]="Ping",n[n.Close=7]="Close",n}(ii||{});class Mae{constructor(){this.observers=[]}next(e){for(const t of this.observers)t.next(e)}error(e){for(const t of this.observers)t.error&&t.error(e)}complete(){for(const e of this.observers)e.complete&&e.complete()}subscribe(e){return this.observers.push(e),new hae(this,e)}}var Ci=function(n){return n.Disconnected="Disconnected",n.Connecting="Connecting",n.Connected="Connected",n.Disconnecting="Disconnecting",n.Reconnecting="Reconnecting",n}(Ci||{});class WR{constructor(e,t,i,r){this._nextKeepAlive=0,this._freezeEventListener=()=>{this._logger.log(_e.Warning,"The page is being frozen, this will likely lead to the connection being closed and messages being lost. For more information see the docs at https://docs.microsoft.com/aspnet/core/signalr/javascript-client#bsleep")},_r.isRequired(e,"connection"),_r.isRequired(t,"logger"),_r.isRequired(i,"protocol"),this.serverTimeoutInMilliseconds=3e4,this.keepAliveIntervalInMilliseconds=15e3,this._logger=t,this._protocol=i,this.connection=e,this._reconnectPolicy=r,this._handshakeProtocol=new xae,this.connection.onreceive=s=>this._processIncomingData(s),this.connection.onclose=s=>this._connectionClosed(s),this._callbacks={},this._methods={},this._closedCallbacks=[],this._reconnectingCallbacks=[],this._reconnectedCallbacks=[],this._invocationId=0,this._receivedHandshakeResponse=!1,this._connectionState=Ci.Disconnected,this._connectionStarted=!1,this._cachedPingMessage=this._protocol.writeMessage({type:ii.Ping})}static create(e,t,i,r){return new WR(e,t,i,r)}get state(){return this._connectionState}get connectionId(){return this.connection&&this.connection.connectionId||null}get baseUrl(){return this.connection.baseUrl||""}set baseUrl(e){if(this._connectionState!==Ci.Disconnected&&this._connectionState!==Ci.Reconnecting)throw new Error("The HubConnection must be in the Disconnected or Reconnecting state to change the url.");if(!e)throw new Error("The HubConnection url must be a valid url.");this.connection.baseUrl=e}start(){return this._startPromise=this._startWithStateTransitions(),this._startPromise}_startWithStateTransitions(){var e=this;return Pn(function*(){if(e._connectionState!==Ci.Disconnected)return Promise.reject(new Error("Cannot start a HubConnection that is not in the 'Disconnected' state."));e._connectionState=Ci.Connecting,e._logger.log(_e.Debug,"Starting HubConnection.");try{yield e._startInternal(),yr.isBrowser&&window.document.addEventListener("freeze",e._freezeEventListener),e._connectionState=Ci.Connected,e._connectionStarted=!0,e._logger.log(_e.Debug,"HubConnection connected successfully.")}catch(t){return e._connectionState=Ci.Disconnected,e._logger.log(_e.Debug,`HubConnection failed to start successfully because of error '${t}'.`),Promise.reject(t)}})()}_startInternal(){var e=this;return Pn(function*(){e._stopDuringStartError=void 0,e._receivedHandshakeResponse=!1;const t=new Promise((i,r)=>{e._handshakeResolver=i,e._handshakeRejecter=r});yield e.connection.start(e._protocol.transferFormat);try{const i={protocol:e._protocol.name,version:e._protocol.version};if(e._logger.log(_e.Debug,"Sending handshake request."),yield e._sendMessage(e._handshakeProtocol.writeHandshakeRequest(i)),e._logger.log(_e.Information,`Using HubProtocol '${e._protocol.name}'.`),e._cleanupTimeout(),e._resetTimeoutPeriod(),e._resetKeepAliveInterval(),yield t,e._stopDuringStartError)throw e._stopDuringStartError;e.connection.features.inherentKeepAlive||(yield e._sendMessage(e._cachedPingMessage))}catch(i){throw e._logger.log(_e.Debug,`Hub handshake failed with error '${i}' during start(). Stopping HubConnection.`),e._cleanupTimeout(),e._cleanupPingTimer(),yield e.connection.stop(i),i}})()}stop(){var e=this;return Pn(function*(){const t=e._startPromise;e._stopPromise=e._stopInternal(),yield e._stopPromise;try{yield t}catch{}})()}_stopInternal(e){return this._connectionState===Ci.Disconnected?(this._logger.log(_e.Debug,`Call to HubConnection.stop(${e}) ignored because it is already in the disconnected state.`),Promise.resolve()):this._connectionState===Ci.Disconnecting?(this._logger.log(_e.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnecting state.`),this._stopPromise):(this._connectionState=Ci.Disconnecting,this._logger.log(_e.Debug,"Stopping HubConnection."),this._reconnectDelayHandle?(this._logger.log(_e.Debug,"Connection stopped during reconnect delay. Done reconnecting."),clearTimeout(this._reconnectDelayHandle),this._reconnectDelayHandle=void 0,this._completeClose(),Promise.resolve()):(this._cleanupTimeout(),this._cleanupPingTimer(),this._stopDuringStartError=e||new ma("The connection was stopped before the hub handshake could complete."),this.connection.stop(e)))}stream(e,...t){const[i,r]=this._replaceStreamingParams(t),s=this._createStreamInvocation(e,t,r);let o;const a=new Mae;return a.cancelCallback=()=>{const l=this._createCancelInvocation(s.invocationId);return delete this._callbacks[s.invocationId],o.then(()=>this._sendWithProtocol(l))},this._callbacks[s.invocationId]=(l,c)=>{c?a.error(c):l&&(l.type===ii.Completion?l.error?a.error(new Error(l.error)):a.complete():a.next(l.item))},o=this._sendWithProtocol(s).catch(l=>{a.error(l),delete this._callbacks[s.invocationId]}),this._launchStreams(i,o),a}_sendMessage(e){return this._resetKeepAliveInterval(),this.connection.send(e)}_sendWithProtocol(e){return this._sendMessage(this._protocol.writeMessage(e))}send(e,...t){const[i,r]=this._replaceStreamingParams(t),s=this._sendWithProtocol(this._createInvocation(e,t,!0,r));return this._launchStreams(i,s),s}invoke(e,...t){const[i,r]=this._replaceStreamingParams(t),s=this._createInvocation(e,t,!1,r);return new Promise((a,l)=>{this._callbacks[s.invocationId]=(h,d)=>{d?l(d):h&&(h.type===ii.Completion?h.error?l(new Error(h.error)):a(h.result):l(new Error(`Unexpected message type: ${h.type}`)))};const c=this._sendWithProtocol(s).catch(h=>{l(h),delete this._callbacks[s.invocationId]});this._launchStreams(i,c)})}on(e,t){!e||!t||(e=e.toLowerCase(),this._methods[e]||(this._methods[e]=[]),-1===this._methods[e].indexOf(t)&&this._methods[e].push(t))}off(e,t){if(!e)return;e=e.toLowerCase();const i=this._methods[e];if(i)if(t){const r=i.indexOf(t);-1!==r&&(i.splice(r,1),0===i.length&&delete this._methods[e])}else delete this._methods[e]}onclose(e){e&&this._closedCallbacks.push(e)}onreconnecting(e){e&&this._reconnectingCallbacks.push(e)}onreconnected(e){e&&this._reconnectedCallbacks.push(e)}_processIncomingData(e){if(this._cleanupTimeout(),this._receivedHandshakeResponse||(e=this._processHandshakeResponse(e),this._receivedHandshakeResponse=!0),e){const t=this._protocol.parseMessages(e,this._logger);for(const i of t)switch(i.type){case ii.Invocation:this._invokeClientMethod(i);break;case ii.StreamItem:case ii.Completion:{const r=this._callbacks[i.invocationId];if(r){i.type===ii.Completion&&delete this._callbacks[i.invocationId];try{r(i)}catch(s){this._logger.log(_e.Error,`Stream callback threw error: ${hG(s)}`)}}break}case ii.Ping:break;case ii.Close:{this._logger.log(_e.Information,"Close message received from server.");const r=i.error?new Error("Server returned an error on close: "+i.error):void 0;!0===i.allowReconnect?this.connection.stop(r):this._stopPromise=this._stopInternal(r);break}default:this._logger.log(_e.Warning,`Invalid message type: ${i.type}.`)}}this._resetTimeoutPeriod()}_processHandshakeResponse(e){let t,i;try{[i,t]=this._handshakeProtocol.parseHandshakeResponse(e)}catch(r){const s="Error parsing handshake response: "+r;this._logger.log(_e.Error,s);const o=new Error(s);throw this._handshakeRejecter(o),o}if(t.error){const r="Server returned handshake error: "+t.error;this._logger.log(_e.Error,r);const s=new Error(r);throw this._handshakeRejecter(s),s}return this._logger.log(_e.Debug,"Server handshake complete."),this._handshakeResolver(),i}_resetKeepAliveInterval(){this.connection.features.inherentKeepAlive||(this._nextKeepAlive=(new Date).getTime()+this.keepAliveIntervalInMilliseconds,this._cleanupPingTimer())}_resetTimeoutPeriod(){var e=this;if(!(this.connection.features&&this.connection.features.inherentKeepAlive||(this._timeoutHandle=setTimeout(()=>this.serverTimeout(),this.serverTimeoutInMilliseconds),void 0!==this._pingServerHandle))){let t=this._nextKeepAlive-(new Date).getTime();t<0&&(t=0),this._pingServerHandle=setTimeout(Pn(function*(){if(e._connectionState===Ci.Connected)try{yield e._sendMessage(e._cachedPingMessage)}catch{e._cleanupPingTimer()}}),t)}}serverTimeout(){this.connection.stop(new Error("Server timeout elapsed without receiving a message from the server."))}_invokeClientMethod(e){var t=this;return Pn(function*(){const i=e.target.toLowerCase(),r=t._methods[i];if(!r)return t._logger.log(_e.Warning,`No client method with the name '${i}' found.`),void(e.invocationId&&(t._logger.log(_e.Warning,`No result given for '${i}' method and invocation ID '${e.invocationId}'.`),yield t._sendWithProtocol(t._createCompletionMessage(e.invocationId,"Client didn't provide a result.",null))));const s=r.slice(),o=!!e.invocationId;let a,l,c;for(const h of s)try{const d=a;a=yield h.apply(t,e.arguments),o&&a&&d&&(t._logger.log(_e.Error,`Multiple results provided for '${i}'. Sending error to server.`),c=t._createCompletionMessage(e.invocationId,"Client provided multiple results.",null)),l=void 0}catch(d){l=d,t._logger.log(_e.Error,`A callback for the method '${i}' threw error '${d}'.`)}c?yield t._sendWithProtocol(c):o?(l?c=t._createCompletionMessage(e.invocationId,`${l}`,null):void 0!==a?c=t._createCompletionMessage(e.invocationId,null,a):(t._logger.log(_e.Warning,`No result given for '${i}' method and invocation ID '${e.invocationId}'.`),c=t._createCompletionMessage(e.invocationId,"Client didn't provide a result.",null)),yield t._sendWithProtocol(c)):a&&t._logger.log(_e.Error,`Result given for '${i}' method but server is not expecting a result.`)})()}_connectionClosed(e){this._logger.log(_e.Debug,`HubConnection.connectionClosed(${e}) called while in state ${this._connectionState}.`),this._stopDuringStartError=this._stopDuringStartError||e||new ma("The underlying connection was closed before the hub handshake could complete."),this._handshakeResolver&&this._handshakeResolver(),this._cancelCallbacksWithError(e||new Error("Invocation canceled due to the underlying connection being closed.")),this._cleanupTimeout(),this._cleanupPingTimer(),this._connectionState===Ci.Disconnecting?this._completeClose(e):this._connectionState===Ci.Connected&&this._reconnectPolicy?this._reconnect(e):this._connectionState===Ci.Connected&&this._completeClose(e)}_completeClose(e){if(this._connectionStarted){this._connectionState=Ci.Disconnected,this._connectionStarted=!1,yr.isBrowser&&window.document.removeEventListener("freeze",this._freezeEventListener);try{this._closedCallbacks.forEach(t=>t.apply(this,[e]))}catch(t){this._logger.log(_e.Error,`An onclose callback called with error '${e}' threw error '${t}'.`)}}}_reconnect(e){var t=this;return Pn(function*(){const i=Date.now();let r=0,s=void 0!==e?e:new Error("Attempting to reconnect due to a unknown error."),o=t._getNextRetryDelay(r++,0,s);if(null===o)return t._logger.log(_e.Debug,"Connection not reconnecting because the IRetryPolicy returned null on the first reconnect attempt."),void t._completeClose(e);if(t._connectionState=Ci.Reconnecting,t._logger.log(_e.Information,e?`Connection reconnecting because of error '${e}'.`:"Connection reconnecting."),0!==t._reconnectingCallbacks.length){try{t._reconnectingCallbacks.forEach(a=>a.apply(t,[e]))}catch(a){t._logger.log(_e.Error,`An onreconnecting callback called with error '${e}' threw error '${a}'.`)}if(t._connectionState!==Ci.Reconnecting)return void t._logger.log(_e.Debug,"Connection left the reconnecting state in onreconnecting callback. Done reconnecting.")}for(;null!==o;){if(t._logger.log(_e.Information,`Reconnect attempt number ${r} will start in ${o} ms.`),yield new Promise(a=>{t._reconnectDelayHandle=setTimeout(a,o)}),t._reconnectDelayHandle=void 0,t._connectionState!==Ci.Reconnecting)return void t._logger.log(_e.Debug,"Connection left the reconnecting state during reconnect delay. Done reconnecting.");try{if(yield t._startInternal(),t._connectionState=Ci.Connected,t._logger.log(_e.Information,"HubConnection reconnected successfully."),0!==t._reconnectedCallbacks.length)try{t._reconnectedCallbacks.forEach(a=>a.apply(t,[t.connection.connectionId]))}catch(a){t._logger.log(_e.Error,`An onreconnected callback called with connectionId '${t.connection.connectionId}; threw error '${a}'.`)}return}catch(a){if(t._logger.log(_e.Information,`Reconnect attempt failed because of error '${a}'.`),t._connectionState!==Ci.Reconnecting)return t._logger.log(_e.Debug,`Connection moved to the '${t._connectionState}' from the reconnecting state during reconnect attempt. Done reconnecting.`),void(t._connectionState===Ci.Disconnecting&&t._completeClose());s=a instanceof Error?a:new Error(a.toString()),o=t._getNextRetryDelay(r++,Date.now()-i,s)}}t._logger.log(_e.Information,`Reconnect retries have been exhausted after ${Date.now()-i} ms and ${r} failed attempts. Connection disconnecting.`),t._completeClose()})()}_getNextRetryDelay(e,t,i){try{return this._reconnectPolicy.nextRetryDelayInMilliseconds({elapsedMilliseconds:t,previousRetryCount:e,retryReason:i})}catch(r){return this._logger.log(_e.Error,`IRetryPolicy.nextRetryDelayInMilliseconds(${e}, ${t}) threw error '${r}'.`),null}}_cancelCallbacksWithError(e){const t=this._callbacks;this._callbacks={},Object.keys(t).forEach(i=>{const r=t[i];try{r(null,e)}catch(s){this._logger.log(_e.Error,`Stream 'error' callback called with '${e}' threw error: ${hG(s)}`)}})}_cleanupPingTimer(){this._pingServerHandle&&(clearTimeout(this._pingServerHandle),this._pingServerHandle=void 0)}_cleanupTimeout(){this._timeoutHandle&&clearTimeout(this._timeoutHandle)}_createInvocation(e,t,i,r){if(i)return 0!==r.length?{arguments:t,streamIds:r,target:e,type:ii.Invocation}:{arguments:t,target:e,type:ii.Invocation};{const s=this._invocationId;return this._invocationId++,0!==r.length?{arguments:t,invocationId:s.toString(),streamIds:r,target:e,type:ii.Invocation}:{arguments:t,invocationId:s.toString(),target:e,type:ii.Invocation}}}_launchStreams(e,t){if(0!==e.length){t||(t=Promise.resolve());for(const i in e)e[i].subscribe({complete:()=>{t=t.then(()=>this._sendWithProtocol(this._createCompletionMessage(i)))},error:r=>{let s;s=r instanceof Error?r.message:r&&r.toString?r.toString():"Unknown error",t=t.then(()=>this._sendWithProtocol(this._createCompletionMessage(i,s)))},next:r=>{t=t.then(()=>this._sendWithProtocol(this._createStreamItemMessage(i,r)))}})}}_replaceStreamingParams(e){const t=[],i=[];for(let r=0;r<e.length;r++){const s=e[r];if(this._isObservable(s)){const o=this._invocationId;this._invocationId++,t[o]=s,i.push(o.toString()),e.splice(r,1)}}return[t,i]}_isObservable(e){return e&&e.subscribe&&"function"==typeof e.subscribe}_createStreamInvocation(e,t,i){const r=this._invocationId;return this._invocationId++,0!==i.length?{arguments:t,invocationId:r.toString(),streamIds:i,target:e,type:ii.StreamInvocation}:{arguments:t,invocationId:r.toString(),target:e,type:ii.StreamInvocation}}_createCancelInvocation(e){return{invocationId:e,type:ii.CancelInvocation}}_createStreamItemMessage(e,t){return{invocationId:e,item:t,type:ii.StreamItem}}_createCompletionMessage(e,t,i){return t?{error:t,invocationId:e,type:ii.Completion}:{invocationId:e,result:i,type:ii.Completion}}}class Iae{constructor(){this.name="json",this.version=1,this.transferFormat=vs.Text}parseMessages(e,t){if("string"!=typeof e)throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!e)return[];null===t&&(t=Rv.instance);const i=ao.parse(e),r=[];for(const s of i){const o=JSON.parse(s);if("number"!=typeof o.type)throw new Error("Invalid payload.");switch(o.type){case ii.Invocation:this._isInvocationMessage(o);break;case ii.StreamItem:this._isStreamItemMessage(o);break;case ii.Completion:this._isCompletionMessage(o);break;case ii.Ping:case ii.Close:break;default:t.log(_e.Information,"Unknown message type '"+o.type+"' ignored.");continue}r.push(o)}return r}writeMessage(e){return ao.write(JSON.stringify(e))}_isInvocationMessage(e){this._assertNotEmptyString(e.target,"Invalid payload for Invocation message."),void 0!==e.invocationId&&this._assertNotEmptyString(e.invocationId,"Invalid payload for Invocation message.")}_isStreamItemMessage(e){if(this._assertNotEmptyString(e.invocationId,"Invalid payload for StreamItem message."),void 0===e.item)throw new Error("Invalid payload for StreamItem message.")}_isCompletionMessage(e){if(e.result&&e.error)throw new Error("Invalid payload for Completion message.");!e.result&&e.error&&this._assertNotEmptyString(e.error,"Invalid payload for Completion message."),this._assertNotEmptyString(e.invocationId,"Invalid payload for Completion message.")}_assertNotEmptyString(e,t){if("string"!=typeof e||""===e)throw new Error(t)}}const Rae={trace:_e.Trace,debug:_e.Debug,info:_e.Information,information:_e.Information,warn:_e.Warning,warning:_e.Warning,error:_e.Error,critical:_e.Critical,none:_e.None};class Nae{configureLogging(e){if(_r.isRequired(e,"logging"),function Lae(n){return void 0!==n.log}(e))this.logger=e;else if("string"==typeof e){const t=function Pae(n){const e=Rae[n.toLowerCase()];if(typeof e<"u")return e;throw new Error(`Unknown log level: ${n}`)}(e);this.logger=new MC(t)}else this.logger=new MC(e);return this}withUrl(e,t){return _r.isRequired(e,"url"),_r.isNotEmpty(e,"url"),this.url=e,this.httpConnectionOptions="object"==typeof t?{...this.httpConnectionOptions,...t}:{...this.httpConnectionOptions,transport:t},this}withHubProtocol(e){return _r.isRequired(e,"protocol"),this.protocol=e,this}withAutomaticReconnect(e){if(this.reconnectPolicy)throw new Error("A reconnectPolicy has already been set.");return this.reconnectPolicy=e?Array.isArray(e)?new lG(e):e:new lG,this}build(){const e=this.httpConnectionOptions||{};if(void 0===e.logger&&(e.logger=this.logger),!this.url)throw new Error("The 'HubConnectionBuilder.withUrl' method must be called before building the connection.");const t=new Sae(this.url,e);return WR.create(t,this.logger||Rv.instance,this.protocol||new Iae,this.reconnectPolicy)}}const Lv={appVersion:vd(147).i8,production:!0,serverURL:""};let Ov=(()=>{class n{constructor(){}startConnection(t){this.hubConnection=(new Nae).withUrl(Lv.serverURL+"/notifications").withAutomaticReconnect().build(),this.hubConnection.start().then(()=>{console.log("Connection started"),this.hubConnection.send("SetConnectionIDUser",t)}).catch(i=>console.log("Error while starting connection: "+i))}executeAction(t,i,r,s,o,a,l){this.hubConnection.send("ExecuteAction",{GameId:t,PlayerId:i,ItemId:r,ActionId:s,DragTargetItemId:o,ClientX:a,ClientY:l})}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),jm=(()=>{class n{GenerateGuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const i=16*Math.random()|0;return("x"===t?i:3&i|8).toString(16)})}randomIntFromInterval(t,i){return Math.random()*(i-t+1)+t}deepEqual(t,i){const r=Object.keys(t),s=Object.keys(i);if(r.length!==s.length)return!1;for(const o of r){const a=t[o],l=i[o],c=this.isObject(a)&&this.isObject(l);if(c&&!this.deepEqual(a,l)||!c&&a!==l)return!1}return!0}isObject(t){return null!=t&&"object"==typeof t}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class AC{}class DC{}class tl{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?"string"==typeof e?this.lazyInit=()=>{this.headers=new Map,e.split("\n").forEach(t=>{const i=t.indexOf(":");if(i>0){const r=t.slice(0,i),s=r.toLowerCase(),o=t.slice(i+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,i)=>{this.setHeaderEntries(i,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,i])=>{this.setHeaderEntries(t,i)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof tl?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new tl;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof tl?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(e.name,t);const r=("a"===e.op?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":const s=e.value;if(s){let o=this.headers.get(t);if(!o)return;o=o.filter(a=>-1===s.indexOf(a)),0===o.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}else this.headers.delete(t),this.normalizedNames.delete(t)}}setHeaderEntries(e,t){const i=(Array.isArray(t)?t:[t]).map(s=>s.toString()),r=e.toLowerCase();this.headers.set(r,i),this.maybeSetNormalizedName(e,r)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class Oae{encodeKey(e){return mG(e)}encodeValue(e){return mG(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const kae=/%(\d[a-f0-9])/gi,Uae={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function mG(n){return encodeURIComponent(n).replace(kae,(e,t)=>Uae[t]??e)}function IC(n){return`${n}`}class Tu{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new Oae,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function Fae(n,e){const t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(r=>{const s=r.indexOf("="),[o,a]=-1==s?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,s)),e.decodeValue(r.slice(s+1))],l=t.get(o)||[];l.push(a),t.set(o,l)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const i=e.fromObject[t],r=Array.isArray(i)?i.map(IC):[IC(i)];this.map.set(t,r)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(i=>{const r=e[i];Array.isArray(r)?r.forEach(s=>{t.push({param:i,value:s,op:"a"})}):t.push({param:i,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new Tu({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(IC(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let i=this.map.get(e.param)||[];const r=i.indexOf(IC(e.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(e.param,i):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class Bae{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function gG(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function _G(n){return typeof Blob<"u"&&n instanceof Blob}function yG(n){return typeof FormData<"u"&&n instanceof FormData}class Fv{constructor(e,t,i,r){let s;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function Vae(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,s=r):s=i,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new tl),this.context||(this.context=new Bae),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=t;else{const a=t.indexOf("?");this.urlWithParams=t+(-1===a?"?":a<t.length-1?"&":"")+o}}else this.params=new Tu,this.urlWithParams=t}serializeBody(){return null===this.body?null:gG(this.body)||_G(this.body)||yG(this.body)||function Hae(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Tu?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||yG(this.body)?null:_G(this.body)?this.body.type||null:gG(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Tu?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){const t=e.method||this.method,i=e.url||this.url,r=e.responseType||this.responseType,s=void 0!==e.body?e.body:this.body,o=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,a=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let l=e.headers||this.headers,c=e.params||this.params;const h=e.context??this.context;return void 0!==e.setHeaders&&(l=Object.keys(e.setHeaders).reduce((d,p)=>d.set(p,e.setHeaders[p]),l)),e.setParams&&(c=Object.keys(e.setParams).reduce((d,p)=>d.set(p,e.setParams[p]),c)),new Fv(t,i,s,{params:c,headers:l,context:h,reportProgress:a,responseType:r,withCredentials:o})}}var $m=function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n}($m||{});class jR{constructor(e,t=200,i="OK"){this.headers=e.headers||new tl,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class $R extends jR{constructor(e={}){super(e),this.type=$m.ResponseHeader}clone(e={}){return new $R({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class qm extends jR{constructor(e={}){super(e),this.type=$m.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new qm({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class vG extends jR{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function qR(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let wG=(()=>{class n{constructor(t){this.handler=t}request(t,i,r={}){let s;if(t instanceof Fv)s=t;else{let l,c;l=r.headers instanceof tl?r.headers:new tl(r.headers),r.params&&(c=r.params instanceof Tu?r.params:new Tu({fromObject:r.params})),s=new Fv(t,i,void 0!==r.body?r.body:null,{headers:l,context:r.context,params:c,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const o=mt(s).pipe(Rp(l=>this.handler.handle(l)));if(t instanceof Fv||"events"===r.observe)return o;const a=o.pipe(Bl(l=>l instanceof qm));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(Jt(l=>{if(null!==l.body&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return a.pipe(Jt(l=>{if(null!==l.body&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return a.pipe(Jt(l=>{if(null!==l.body&&"string"!=typeof l.body)throw new Error("Response is not a string.");return l.body}));default:return a.pipe(Jt(l=>l.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:(new Tu).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,r={}){return this.request("PATCH",t,qR(r,i))}post(t,i,r={}){return this.request("POST",t,qR(r,i))}put(t,i,r={}){return this.request("PUT",t,qR(r,i))}static#e=this.\u0275fac=function(i){return new(i||n)(Oe(AC))};static#t=this.\u0275prov=Je({token:n,factory:n.\u0275fac})}return n})();function SG(n,e){return e(n)}function Gae(n,e){return(t,i)=>e.intercept(t,{handle:r=>n(r,i)})}const jae=new Ye(""),kv=new Ye(""),CG=new Ye("");function $ae(){let n=null;return(e,t)=>{null===n&&(n=(ze(jae,{optional:!0})??[]).reduceRight(Gae,SG));const i=ze(kb),r=i.add();return n(e,t).pipe(Iy(()=>i.remove(r)))}}let xG=(()=>{class n extends AC{constructor(t,i){super(),this.backend=t,this.injector=i,this.chain=null,this.pendingTasks=ze(kb)}handle(t){if(null===this.chain){const r=Array.from(new Set([...this.injector.get(kv),...this.injector.get(CG,[])]));this.chain=r.reduceRight((s,o)=>function Wae(n,e,t){return(i,r)=>t.runInContext(()=>e(i,s=>n(s,r)))}(s,o,this.injector),SG)}const i=this.pendingTasks.add();return this.chain(t,r=>this.backend.handle(r)).pipe(Iy(()=>this.pendingTasks.remove(i)))}static#e=this.\u0275fac=function(i){return new(i||n)(Oe(DC),Oe(cs))};static#t=this.\u0275prov=Je({token:n,factory:n.\u0275fac})}return n})();const Kae=/^\)\]\}',?\n/;let TG=(()=>{class n{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new ae(-2800,!1);const i=this.xhrFactory;return(i.\u0275loadImpl?mi(i.\u0275loadImpl()):mt(null)).pipe(Es(()=>new Cn(s=>{const o=i.build();if(o.open(t.method,t.urlWithParams),t.withCredentials&&(o.withCredentials=!0),t.headers.forEach((v,w)=>o.setRequestHeader(v,w.join(","))),t.headers.has("Accept")||o.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const v=t.detectContentTypeHeader();null!==v&&o.setRequestHeader("Content-Type",v)}if(t.responseType){const v=t.responseType.toLowerCase();o.responseType="json"!==v?v:"text"}const a=t.serializeBody();let l=null;const c=()=>{if(null!==l)return l;const v=o.statusText||"OK",w=new tl(o.getAllResponseHeaders()),y=function Zae(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}(o)||t.url;return l=new $R({headers:w,status:o.status,statusText:v,url:y}),l},h=()=>{let{headers:v,status:w,statusText:y,url:b}=c(),E=null;204!==w&&(E=typeof o.response>"u"?o.responseText:o.response),0===w&&(w=E?200:0);let C=w>=200&&w<300;if("json"===t.responseType&&"string"==typeof E){const x=E;E=E.replace(Kae,"");try{E=""!==E?JSON.parse(E):null}catch(A){E=x,C&&(C=!1,E={error:A,text:E})}}C?(s.next(new qm({body:E,headers:v,status:w,statusText:y,url:b||void 0})),s.complete()):s.error(new vG({error:E,headers:v,status:w,statusText:y,url:b||void 0}))},d=v=>{const{url:w}=c(),y=new vG({error:v,status:o.status||0,statusText:o.statusText||"Unknown Error",url:w||void 0});s.error(y)};let p=!1;const m=v=>{p||(s.next(c()),p=!0);let w={type:$m.DownloadProgress,loaded:v.loaded};v.lengthComputable&&(w.total=v.total),"text"===t.responseType&&o.responseText&&(w.partialText=o.responseText),s.next(w)},g=v=>{let w={type:$m.UploadProgress,loaded:v.loaded};v.lengthComputable&&(w.total=v.total),s.next(w)};return o.addEventListener("load",h),o.addEventListener("error",d),o.addEventListener("timeout",d),o.addEventListener("abort",d),t.reportProgress&&(o.addEventListener("progress",m),null!==a&&o.upload&&o.upload.addEventListener("progress",g)),o.send(a),s.next({type:$m.Sent}),()=>{o.removeEventListener("error",d),o.removeEventListener("abort",d),o.removeEventListener("load",h),o.removeEventListener("timeout",d),t.reportProgress&&(o.removeEventListener("progress",m),null!==a&&o.upload&&o.upload.removeEventListener("progress",g)),o.readyState!==o.DONE&&o.abort()}})))}static#e=this.\u0275fac=function(i){return new(i||n)(Oe(GF))};static#t=this.\u0275prov=Je({token:n,factory:n.\u0275fac})}return n})();const XR=new Ye("XSRF_ENABLED"),AG=new Ye("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),DG=new Ye("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class IG{}let ele=(()=>{class n{constructor(t,i,r){this.doc=t,this.platform=i,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=LF(t,this.cookieName),this.lastCookieString=t),this.lastToken}static#e=this.\u0275fac=function(i){return new(i||n)(Oe(Vr),Oe(Va),Oe(AG))};static#t=this.\u0275prov=Je({token:n,factory:n.\u0275fac})}return n})();function tle(n,e){const t=n.url.toLowerCase();if(!ze(XR)||"GET"===n.method||"HEAD"===n.method||t.startsWith("http://")||t.startsWith("https://"))return e(n);const i=ze(IG).getToken(),r=ze(DG);return null!=i&&!n.headers.has(r)&&(n=n.clone({headers:n.headers.set(r,i)})),e(n)}var Au=function(n){return n[n.Interceptors=0]="Interceptors",n[n.LegacyInterceptors=1]="LegacyInterceptors",n[n.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",n[n.NoXsrfProtection=3]="NoXsrfProtection",n[n.JsonpSupport=4]="JsonpSupport",n[n.RequestsMadeViaParent=5]="RequestsMadeViaParent",n[n.Fetch=6]="Fetch",n}(Au||{});function nle(...n){const e=[wG,TG,xG,{provide:AC,useExisting:xG},{provide:DC,useExisting:TG},{provide:kv,useValue:tle,multi:!0},{provide:XR,useValue:!0},{provide:IG,useClass:ele}];for(const t of n)e.push(...t.\u0275providers);return function I_(n){return{\u0275providers:n}}(e)}const RG=new Ye("LEGACY_INTERCEPTOR_FN");function ile(){return function pd(n,e){return{\u0275kind:n,\u0275providers:e}}(Au.LegacyInterceptors,[{provide:RG,useFactory:$ae},{provide:kv,useExisting:RG,multi:!0}])}let rle=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=ki({type:n});static#n=this.\u0275inj=Ti({providers:[nle(ile())]})}return n})(),PC=(()=>{class n{constructor(t){this.http=t,this.baseGameUrl=Lv.serverURL+"/api/Game",this.baseUserUrl=Lv.serverURL+"/api/User"}login(t){return this.http.post(this.baseUserUrl+"/Login",{name:t})}getGameById(t){return this.http.get(this.baseGameUrl+`/GetGameByID?GameId=${t}`)}getGamesList(){return this.http.get(this.baseGameUrl+"/GetGamesList")}createGame(t,i){return this.http.post(this.baseGameUrl+"/CreateGame",{userId:t,gameType:i})}setupGame(t,i){return this.http.post(this.baseGameUrl+"/SetupGame",{gameId:t,userId:i})}startGame(t){return this.http.post(this.baseGameUrl+"/StartGame",{gameId:t})}deleteGame(t){return this.http.post(this.baseGameUrl+"/DeleteGame",{gameId:t})}executeAction(t,i,r,s,o,a){return this.http.post(this.baseGameUrl+"/ExecuteAction",{GameId:t,PlayerId:i,ActionId:r,ItemId:s,ClientX:o,ClientY:a})}joinGame(t,i,r,s){return this.http.post(this.baseGameUrl+"/JoinGame",{gameId:t,playerId:i,user:r,type:s})}static#e=this.\u0275fac=function(i){return new(i||n)(Oe(wG))};static#t=this.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const ule=["rendererContainer"];let hle=(()=>{class n{constructor(t,i,r,s,o,a){this.signalRService=t,this.router=i,this.generalService=r,this.activatedRoute=s,this.unsubscriberService=o,this.dalService=a,this.interactionObjects=[],this.objectUnselectedColor="red",this.objectSelectedColor="blue",this.allItems={},this.gameId="",this.onMeshClickFunc=this.MeshClickFunc.bind(this),this.onMeshMouseOverFunc=this.MeshMouseOverFunc.bind(this),this.onMeshMouseOutFunc=this.MeshMouseOutFunc.bind(this),this.currentSession=null}ngOnInit(){this.gameId=this.activatedRoute.snapshot.paramMap.get("id"),console.log(this.gameId),this.signalRService.hubConnection.off("GameUpdated"),this.signalRService.hubConnection.on("GameUpdated",t=>{console.log("GameUpdated",t),this.updateGame(t)})}ngOnDestroy(){this.signalRService.hubConnection.off("GameUpdated")}ngAfterViewInit(){this.dalService.getGameById(this.gameId).subscribe(t=>{t?(this.gameData=t,this.playerData=this.getPlayerByUserId(this.generalService.User.id),this.initThree()):this.router.navigate([Vs.GamesList])})}getPlayerByUserId(t){return(0,Fm.find)(this.gameData.players,i=>i.user?.id==t)}updateGame(t){console.log("updateGame",t),(0,Fm.forEach)(this.allItems,(i,r)=>{i.markForDelete=!0}),this.updateItem(t.table,null),(0,Fm.forEach)(this.allItems,(i,r)=>{i.markForDelete&&(this.removeAction(i),i.mesh?.parent?.remove(i.mesh),delete this.allItems[i.id])})}updateItem(t,i){console.log("updateItem",t,i);let r=this.allItems[t.id];r?(r.markForDelete=!1,r.clickActions=t.clickActions,r.visible=t.visible,r.hoverActions=t.hoverActions,this.updateItemPosition(r,Cv.FromJson(t.position)),this.updateItemScale(r,Cv.FromJson(t.scale)),this.updateItemRotation(r,Cv.FromJson(t.rotation)),this.updateItemText(r,t.text),(0,Fm.forEach)(t.items,s=>{this.updateItem(s,r.mesh)}),this.handleItemClickActions(r),this.handleItemVisibility(r)):this.createItem(t,i)}updateItemPosition(t,i){console.log("updateItemPosition",t,i),t.position=i,this.generalService.deepEqual(i,t.mesh.position)||new lC(t.mesh.position).to(i,300).start()}updateItemScale(t,i){console.log("updateItemScale",t,i),t.scale=i,this.generalService.deepEqual(i,t.mesh.scale)||new lC(t.mesh.scale).to(i,300).start()}updateItemRotation(t,i){console.log("updateItemRotation",t,i),t.rotation=i,i={x:mu_degToRad(i.x),y:mu_degToRad(i.y),z:mu_degToRad(i.z)},this.generalService.deepEqual(i,{x:t.mesh.rotation.x,y:t.mesh.rotation.y,z:t.mesh.rotation.z})||new lC(t.mesh.rotation).to(i,300).start()}updateItemText(t,i){"TEXTBLOCK"==t.asset&&(t.text=i,t.mesh.childrenTexts[0].set({content:i}))}resizeCanvasToDisplaySize(){const t=this.renderer.domElement,i=t.clientWidth,r=t.clientHeight;this.renderer.setSize(i,r,!1),this.camera.aspect=i/r,this.camera.updateProjectionMatrix()}initThree(){this.scene=new PS,this.scene.background=new We(16777215),this.camera=new ir(75,this.rendererContainer.nativeElement.clientWidth/this.rendererContainer.nativeElement.clientHeight,.1,1e3),this.camera.position.set(-1.8,.6,2.7),this.renderer=new _I({antialias:!0}),this.renderer.xr.enabled=!0,this.renderer.setSize(this.rendererContainer.nativeElement.clientWidth,this.rendererContainer.nativeElement.clientHeight),this.rendererContainer.nativeElement.appendChild(this.renderer.domElement);const t=new dI(this.renderer);this.scene.environment=t.fromScene(new hoe,0).texture,this.orbitControls=new mz(this.camera,this.renderer.domElement),this.orbitControls.addEventListener("change",()=>{this.renderer.render(this.scene,this.camera)}),this.orbitControls.enableZoom=!0,this.orbitControls.update(),this.interactionManager=new class{renderer;camera;domElement;bindEventsOnBodyElement;autoAdd;scene;mouse;supportsPointerEvents;interactiveObjects;closestObject;raycaster;treatTouchEventsAsMouseEvents;constructor(n,e,t,i){this.renderer=n,this.camera=e,this.domElement=t,this.bindEventsOnBodyElement=!(i&&typeof i.bindEventsOnBodyElement<"u")||i.bindEventsOnBodyElement,this.scene=i&&typeof i.scene<"u"?i.scene:null,this.scene&&(this.scene.onBeforeRender=()=>{this.autoAdd&&null!==this.scene&&this.scene.traverse(r=>{this.add(r),r.addEventListener("removed",s=>{this.remove(s.target)})}),this.update()}),this.autoAdd=!!(i&&typeof i.autoAdd<"u")&&i.autoAdd,this.autoAdd&&null===this.scene&&console.error("Attention: Options.scene needs to be set when using options.autoAdd"),this.mouse=new fe(-1,1),this.supportsPointerEvents=!!window.PointerEvent,this.interactiveObjects=[],this.closestObject=null,this.raycaster=new iR,t.addEventListener("click",this.onMouseClick),this.supportsPointerEvents&&(this.bindEventsOnBodyElement?t.ownerDocument.addEventListener("pointermove",this.onDocumentPointerMove):t.addEventListener("pointermove",this.onDocumentPointerMove),t.addEventListener("pointerdown",this.onPointerDown),t.addEventListener("pointerup",this.onPointerUp)),this.bindEventsOnBodyElement?t.ownerDocument.addEventListener("mousemove",this.onDocumentMouseMove):t.addEventListener("mousemove",this.onDocumentMouseMove),t.addEventListener("mousedown",this.onMouseDown),t.addEventListener("mouseup",this.onMouseUp),t.addEventListener("touchstart",this.onTouchStart,{passive:!0}),t.addEventListener("touchmove",this.onTouchMove,{passive:!0}),t.addEventListener("touchend",this.onTouchEnd,{passive:!0}),this.treatTouchEventsAsMouseEvents=!0}dispose=()=>{this.domElement.removeEventListener("click",this.onMouseClick),this.supportsPointerEvents&&(this.bindEventsOnBodyElement?this.domElement.ownerDocument.removeEventListener("pointermove",this.onDocumentPointerMove):this.domElement.removeEventListener("pointermove",this.onDocumentPointerMove),this.domElement.removeEventListener("pointerdown",this.onPointerDown),this.domElement.removeEventListener("pointerup",this.onPointerUp)),this.bindEventsOnBodyElement?this.domElement.ownerDocument.removeEventListener("mousemove",this.onDocumentMouseMove):this.domElement.removeEventListener("mousemove",this.onDocumentMouseMove),this.domElement.removeEventListener("mousedown",this.onMouseDown),this.domElement.removeEventListener("mouseup",this.onMouseUp),this.domElement.removeEventListener("touchstart",this.onTouchStart),this.domElement.removeEventListener("touchmove",this.onTouchMove),this.domElement.removeEventListener("touchend",this.onTouchEnd)};add=(n,e=[])=>{if(n&&!this.interactiveObjects.find(t=>t.target===n))if(e.length>0)e.forEach(t=>{let i=n.getObjectByName(t);if(i){let r=new Cz(i,t);this.interactiveObjects.push(r)}});else{let t=new Cz(n,n.name);this.interactiveObjects.push(t)}};remove=(n,e=[])=>{!n||(e.length>0?e.forEach(t=>{let i=n.getObjectByName(t);i&&(this.interactiveObjects=this.interactiveObjects.filter(r=>r.target!==i))}):this.interactiveObjects=this.interactiveObjects.filter(t=>t.target!==n))};update=()=>{this.raycaster.setFromCamera(this.mouse,this.camera),this.interactiveObjects.forEach(i=>{i.target&&this.checkIntersection(i)}),this.interactiveObjects.sort(function(i,r){return i.distance-r.distance});let e,t,n=this.interactiveObjects.find(i=>i.intersected)??null;if(n!=this.closestObject){if(this.closestObject){let i=new ks("mouseout");this.dispatch(this.closestObject,i)}if(n){let i=new ks("mouseover");this.dispatch(n,i)}this.closestObject=n}this.interactiveObjects.forEach(i=>{!i.intersected&&i.wasIntersected&&(e||(e=new ks("mouseleave")),this.dispatch(i,e))}),this.interactiveObjects.forEach(i=>{i.intersected&&!i.wasIntersected&&(t||(t=new ks("mouseenter")),this.dispatch(i,t))})};checkIntersection=n=>{let e=this.raycaster.intersectObjects([n.target],!0);if(n.wasIntersected=n.intersected,e.length>0){let t=e[0].distance;e.forEach(i=>{i.distance<t&&(t=i.distance)}),n.intersected=!0,n.distance=t}else n.intersected=!1};onDocumentMouseMove=n=>{this.mapPositionToPoint(this.mouse,n.clientX,n.clientY);let e=new ks("mousemove",n);this.interactiveObjects.forEach(t=>{this.dispatch(t,e)})};onDocumentPointerMove=n=>{this.mapPositionToPoint(this.mouse,n.clientX,n.clientY);let e=new ks("pointermove",n);this.interactiveObjects.forEach(t=>{this.dispatch(t,e)})};onTouchMove=n=>{n.touches.length>0&&this.mapPositionToPoint(this.mouse,n.touches[0].clientX,n.touches[0].clientY);let e=new ks(this.treatTouchEventsAsMouseEvents?"mousemove":"touchmove",n);this.interactiveObjects.forEach(t=>{this.dispatch(t,e)})};onMouseClick=n=>{this.update();let e=new ks("click",n);this.interactiveObjects.forEach(t=>{t.intersected&&this.dispatch(t,e)})};onMouseDown=n=>{this.mapPositionToPoint(this.mouse,n.clientX,n.clientY),this.update();let e=new ks("mousedown",n);this.interactiveObjects.forEach(t=>{t.intersected&&this.dispatch(t,e)})};onPointerDown=n=>{this.mapPositionToPoint(this.mouse,n.clientX,n.clientY),this.update();let e=new ks("pointerdown",n);this.interactiveObjects.forEach(t=>{t.intersected&&this.dispatch(t,e)})};onTouchStart=n=>{n.touches.length>0&&this.mapPositionToPoint(this.mouse,n.touches[0].clientX,n.touches[0].clientY),this.update();let e=new ks(this.treatTouchEventsAsMouseEvents?"mousedown":"touchstart",n);this.interactiveObjects.forEach(t=>{t.intersected&&this.dispatch(t,e)})};onMouseUp=n=>{let e=new ks("mouseup",n);this.interactiveObjects.forEach(t=>{this.dispatch(t,e)})};onPointerUp=n=>{let e=new ks("pointerup",n);this.interactiveObjects.forEach(t=>{this.dispatch(t,e)})};onTouchEnd=n=>{n.touches.length>0&&this.mapPositionToPoint(this.mouse,n.touches[0].clientX,n.touches[0].clientY),this.update();let e=new ks(this.treatTouchEventsAsMouseEvents?"mouseup":"touchend",n);this.interactiveObjects.forEach(t=>{this.dispatch(t,e)})};dispatch=(n,e)=>{n.target&&!e.cancelBubble&&(e.coords=this.mouse,e.distance=n.distance,e.intersected=n.intersected,n.target.dispatchEvent(e))};mapPositionToPoint=(n,e,t)=>{let i=this.renderer.domElement.getBoundingClientRect();n.x=(e-i.left)/i.width*2-1,n.y=-(t-i.top)/i.height*2+1}}(this.renderer,this.camera,this.renderer.domElement),this.renderer.setAnimationLoop(()=>{eae(),this.controllers&&this.controllers.forEach(i=>{this.handleController(i)}),this.orbitControls.update(),this.interactionManager.update(),this.renderer.render(this.scene,this.camera),Mz()}),this.gltfLoader=new _z,this.stlLoader=new doe,this.objLoader=new yoe,this.textureLoader=new XI,this.fontLoader=new voe,this.controllers=this.buildControllers(),this.controllers.forEach(i=>{i.addEventListener("selectstart",this.onSelectStart),i.addEventListener("selectend",this.onSelectEnd)}),this.loadGame()}onSelectStart(t){console.log("onSelectStart",t)}onSelectEnd(t){console.log("onSelectEnd",t)}buildControllers(){const t=new uoe,i=(new Rt).setFromPoints([new L(0,0,0),new L(0,0,-1)]),r=new $r(i);r.scale.z=10;const s=[];for(let o=0;o<2;o++){const a=this.renderer.xr.getController(o);a.add(r.clone()),a.userData.selectPressed=!1,a.userData.selectPressedPrev=!1,this.scene.add(a),s.push(a);const l=this.renderer.xr.getControllerGrip(o);l.add(t.createControllerModel(l)),this.scene.add(l)}return s}handleController(t){if(t.userData.selectPressed)if(t.userData.selectPressedPrev){if(this.selectedObject){const i=t.getWorldDirection(new L).multiplyScalar(this.selectedObjectDistance).negate();this.selectedObject.position.copy(t.position.clone().add(i))}}else{t.children[0].scale.z=10;const i=new wt;i.extractRotation(t.matrixWorld);const r=new iR;r.ray.origin.setFromMatrixPosition(t.matrixWorld),r.ray.direction.set(0,0,-1).applyMatrix4(i);const s=r.intersectObjects(this.interactionObjects);s.length>0&&(t.children[0].scale.z=s[0].distance,this.selectedObject=s[0].object,this.selectedObject.material.color=this.objectSelectedColor,this.selectedObjectDistance=this.selectedObject.position.distanceTo(t.position))}else t.userData.selectPressedPrev&&(t.children[0].scale.z=10,null!=this.selectedObject&&(this.selectedObject.material.color=this.objectUnselectedColor,this.selectedObject=null));t.userData.selectPressedPrev=t.userData.selectPressed}createItem(t,i){if(console.log("createItem",t,i),t.asset){const r="\\assets\\games\\"+this.gameData.assets[t.asset].frontURL,s="\\assets\\games\\"+(this.gameData.assets[t.asset].backURL||this.gameData.assets[t.asset].frontURL),o=this.gameData.assets[t.asset].type;if("OBJECT"==o&&((r.toLowerCase().endsWith("glb")||r.toLowerCase().endsWith("gltf"))&&this.gltfLoader.load(r,a=>{this.processItem(t,a.scene,i)}),r.toLowerCase().endsWith("stl")&&this.stlLoader.load(r,a=>{const l=new Me(a);this.processItem(t,l,i)}),r.toLowerCase().endsWith("obj")&&this.objLoader.load(r,a=>{this.processItem(t,a,i)})),"TOKEN"==o&&this.textureLoader.load(r,a=>{let l=a.image.width/a.image.height,c=1,h=1/l;l<1&&(h=1,c=l);var d=[new bi({color:16777215,opacity:.5,transparent:!0}),new bi({color:16777215,opacity:.5,transparent:!0}),new bi({map:a,transparent:!0}),new bi({map:this.textureLoader.load(s),transparent:!0}),new bi({color:16777215,opacity:.5,transparent:!0}),new bi({color:16777215,opacity:.5,transparent:!0})];let p=new Me(new oi(c,c/100,h),d);this.processItem(t,p,i)}),"TEXT3D"==o&&this.fontLoader.load("https://threejs.org/examples/fonts/helvetiker_regular.typeface.json",a=>{const l=new Soe("Hello three.js!",{font:a,size:.5,height:.2,curveSegments:12,bevelEnabled:!0,bevelThickness:.03,bevelSize:.02,bevelOffset:0,bevelSegments:5});var c=new jI({color:16711680,specular:16777215});let h=new Me(l,c);this.processItem(t,h,i)}),"TEXTBLOCK"==o){const a=new Joe({bestFit:"auto",width:100,height:100,justifyContent:"center",textAlign:"center",fontFamily:"assets/fonts/Roboto-msdf.json",fontTexture:"assets/fonts/Roboto-msdf.png",fontColor:new We(0),backgroundOpacity:0}),l=new Qoe({content:t.text});a.add(l),this.processItem(t,a,i)}}else{const r=new Za;this.processItem(t,r,i)}}processItem(t,i,r){console.log("processItem",t,i,r),i.position.set(t.position.x,t.position.y,t.position.z),i.rotation.set(mu_degToRad(t.rotation.x),mu_degToRad(t.rotation.y),mu_degToRad(t.rotation.z)),i.scale.set(t.scale.x,t.scale.y,t.scale.z),r?r.add(i):this.scene.add(i),i.userData.ItemData=t,t.mesh=i,(0,Fm.forEach)(t.items,s=>{this.createItem(s,i)}),this.handleItemClickActions(t),this.handleItemVisibility(t),this.allItems[t.id]=t}handleItemClickActions(t){console.log("handleItemClickActions",t);let i=null;this.playerData&&(i=t.clickActions[this.playerData.id]||t.clickActions[""]),i?this.addClickAction(t,i):this.removeAction(t)}handleItemVisibility(t){console.log("handleItemVisibility",t);let i=0==(0,Fm.keys)(t.visible).length;this.playerData&&(i=i||1==t.visible[this.playerData.id]),console.log("handleItemVisibility","isVisible",i),t.mesh.visible=i,i||this.removeAction(t)}MeshClickFunc(t){console.log(t),this.playerData&&this.signalRService.executeAction(this.gameData.id,this.playerData.id,t.target.userData.ItemData.id,t.target.userData.ItemData.clickActions[this.playerData.id]||t.target.userData.ItemData.clickActions[""],"",0,0)}MeshMouseOverFunc(t){document.body.style.cursor="pointer",this.orbitControls.enabled=!1}MeshMouseOutFunc(t){document.body.style.cursor="default",this.orbitControls.enabled=!0}addClickAction(t,i){console.log("addClickAction",t,i),this.removeAction(t),t.mesh.addEventListener("click",this.onMeshClickFunc),t.mesh.addEventListener("mouseover",this.onMeshMouseOverFunc),t.mesh.addEventListener("mouseout",this.onMeshMouseOutFunc),this.interactionManager.add(t.mesh)}removeAction(t){console.log("removeAction",t),t.mesh.removeEventListener("click",this.onMeshClickFunc),t.mesh.removeEventListener("click",this.onMeshMouseOverFunc),this.interactionManager.remove(t.mesh)}loadGame(){console.log("loadGame"),this.createItem(this.gameData.table,null)}ngOnChanges(t){}onVrClick(){var t=this;window.navigator.xr.requestSession("immersive-vr",{optionalFeatures:["local-floor","bounded-floor","hand-tracking","layers"]}).then(function(){var r=Pn(function*(s){yield t.renderer.xr.setSession(s),t.currentSession=s});return function(s){return r.apply(this,arguments)}}())}static#e=this.\u0275fac=function(i){return new(i||n)(ce(Ov),ce(Mr),ce(jm),ce(Hl),ce(cC),ce(PC))};static#t=this.\u0275cmp=Ji({type:n,selectors:[["app-game-play"]],viewQuery:function(i,r){if(1&i&&uA(ule,7),2&i){let s;wp(s=bp())&&(r.rendererContainer=s.first)}},features:[Un([cC]),Hi],decls:7,vars:0,consts:[[1,"main-div"],[2,"flex-shrink","0"],[2,"flex-grow","1","border","1px dashed red"],["rendererContainer",""],[2,"position","absolute","bottom","0","right","0"],[2,"width","100px","height","30px",3,"click"]],template:function(i,r){1&i&&(It(0,"div",0),Br(1,"div",1)(2,"div",2,3),Mt(),It(4,"div",4)(5,"button",5),yn("click",function(){return r.onVrClick()}),Tn(6,"VR"),Mt()())},styles:[".main-div[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;height:100%;background:yellow}"]})}return n})(),NC=(()=>{class n{constructor(t,i){this.router=t,this.generalService=i}canActivate(){return!!this.generalService.User||(this.router.navigate([Vs.Home]),!1)}static#e=this.\u0275fac=function(i){return new(i||n)(Oe(Mr),Oe(jm))};static#t=this.\u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Xr=(()=>class n{static STARTS_WITH="startsWith";static CONTAINS="contains";static NOT_CONTAINS="notContains";static ENDS_WITH="endsWith";static EQUALS="equals";static NOT_EQUALS="notEquals";static IN="in";static LESS_THAN="lt";static LESS_THAN_OR_EQUAL_TO="lte";static GREATER_THAN="gt";static GREATER_THAN_OR_EQUAL_TO="gte";static BETWEEN="between";static IS="is";static IS_NOT="isNot";static BEFORE="before";static AFTER="after";static DATE_IS="dateIs";static DATE_IS_NOT="dateIsNot";static DATE_BEFORE="dateBefore";static DATE_AFTER="dateAfter"})(),fle=(()=>{class n{ripple=!1;overlayOptions={};filterMatchModeOptions={text:[Xr.STARTS_WITH,Xr.CONTAINS,Xr.NOT_CONTAINS,Xr.ENDS_WITH,Xr.EQUALS,Xr.NOT_EQUALS],numeric:[Xr.EQUALS,Xr.NOT_EQUALS,Xr.LESS_THAN,Xr.LESS_THAN_OR_EQUAL_TO,Xr.GREATER_THAN,Xr.GREATER_THAN_OR_EQUAL_TO],date:[Xr.DATE_IS,Xr.DATE_IS_NOT,Xr.DATE_BEFORE,Xr.DATE_AFTER]};translation={startsWith:"Starts with",contains:"Contains",notContains:"Not contains",endsWith:"Ends with",equals:"Equals",notEquals:"Not equals",noFilter:"No Filter",lt:"Less than",lte:"Less than or equal to",gt:"Greater than",gte:"Greater than or equal to",is:"Is",isNot:"Is not",before:"Before",after:"After",dateIs:"Date is",dateIsNot:"Date is not",dateBefore:"Date is before",dateAfter:"Date is after",clear:"Clear",apply:"Apply",matchAll:"Match All",matchAny:"Match Any",addRule:"Add Rule",removeRule:"Remove Rule",accept:"Yes",reject:"No",choose:"Choose",upload:"Upload",cancel:"Cancel",pending:"Pending",fileSizeTypes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],chooseYear:"Choose Year",chooseMonth:"Choose Month",chooseDate:"Choose Date",prevDecade:"Previous Decade",nextDecade:"Next Decade",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",prevHour:"Previous Hour",nextHour:"Next Hour",prevMinute:"Previous Minute",nextMinute:"Next Minute",prevSecond:"Previous Second",nextSecond:"Next Second",am:"am",pm:"pm",dateFormat:"mm/dd/yy",firstDayOfWeek:0,today:"Today",weekHeader:"Wk",weak:"Weak",medium:"Medium",strong:"Strong",passwordPrompt:"Enter a password",emptyMessage:"No results found",searchMessage:"{0} results are available",selectionMessage:"{0} items selected",emptySelectionMessage:"No selected item",emptySearchMessage:"No results found",emptyFilterMessage:"No results found",aria:{trueLabel:"True",falseLabel:"False",nullLabel:"Not Selected",star:"1 star",stars:"{star} stars",selectAll:"All items selected",unselectAll:"All items unselected",close:"Close",previous:"Previous",next:"Next",navigation:"Navigation",scrollTop:"Scroll Top",moveTop:"Move Top",moveUp:"Move Up",moveDown:"Move Down",moveBottom:"Move Bottom",moveToTarget:"Move to Target",moveToSource:"Move to Source",moveAllToTarget:"Move All to Target",moveAllToSource:"Move All to Source",pageLabel:"{page}",firstPageLabel:"First Page",lastPageLabel:"Last Page",nextPageLabel:"Next Page",prevPageLabel:"Previous Page",rowsPerPageLabel:"Rows per page",previousPageLabel:"Previous Page",jumpToPageDropdownLabel:"Jump to Page Dropdown",jumpToPageInputLabel:"Jump to Page Input",selectRow:"Row Selected",unselectRow:"Row Unselected",expandRow:"Row Expanded",collapseRow:"Row Collapsed",showFilterMenu:"Show Filter Menu",hideFilterMenu:"Hide Filter Menu",filterOperator:"Filter Operator",filterConstraint:"Filter Constraint",editRow:"Row Edit",saveEdit:"Save Edit",cancelEdit:"Cancel Edit",listView:"List View",gridView:"Grid View",slide:"Slide",slideNumber:"{slideNumber}",zoomImage:"Zoom Image",zoomIn:"Zoom In",zoomOut:"Zoom Out",rotateRight:"Rotate Right",rotateLeft:"Rotate Left"}};zIndex={modal:1100,overlay:1e3,menu:1e3,tooltip:1100};translationSource=new Jr;translationObserver=this.translationSource.asObservable();getTranslation(t){return this.translation[t]}setTranslation(t){this.translation={...this.translation,...t},this.translationSource.next(this.translation)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Je({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),PG=(()=>{class n{template;type;name;constructor(t){this.template=t}getType(){return this.name}static \u0275fac=function(i){return new(i||n)(ce(ja))};static \u0275dir=pt({type:n,selectors:[["","pTemplate",""]],inputs:{type:"type",name:["pTemplate","name"]}})}return n})(),YR=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=ki({type:n});static \u0275inj=Ti({imports:[Mp]})}return n})();class Uv{static equals(e,t,i){return i?this.resolveFieldData(e,i)===this.resolveFieldData(t,i):this.equalsByValue(e,t)}static equalsByValue(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var s,o,a,i=Array.isArray(e),r=Array.isArray(t);if(i&&r){if((o=e.length)!=t.length)return!1;for(s=o;0!=s--;)if(!this.equalsByValue(e[s],t[s]))return!1;return!0}if(i!=r)return!1;var l=this.isDate(e),c=this.isDate(t);if(l!=c)return!1;if(l&&c)return e.getTime()==t.getTime();var h=e instanceof RegExp,d=t instanceof RegExp;if(h!=d)return!1;if(h&&d)return e.toString()==t.toString();var p=Object.keys(e);if((o=p.length)!==Object.keys(t).length)return!1;for(s=o;0!=s--;)if(!Object.prototype.hasOwnProperty.call(t,p[s]))return!1;for(s=o;0!=s--;)if(!this.equalsByValue(e[a=p[s]],t[a]))return!1;return!0}return e!=e&&t!=t}static resolveFieldData(e,t){if(e&&t){if(this.isFunction(t))return t(e);if(-1==t.indexOf("."))return e[t];{let i=t.split("."),r=e;for(let s=0,o=i.length;s<o;++s){if(null==r)return null;r=r[i[s]]}return r}}return null}static isFunction(e){return!!(e&&e.constructor&&e.call&&e.apply)}static reorderArray(e,t,i){e&&t!==i&&(i>=e.length&&(i%=e.length,t%=e.length),e.splice(i,0,e.splice(t,1)[0]))}static insertIntoOrderedArray(e,t,i,r){if(i.length>0){let s=!1;for(let o=0;o<i.length;o++)if(this.findIndexInList(i[o],r)>t){i.splice(o,0,e),s=!0;break}s||i.push(e)}else i.push(e)}static findIndexInList(e,t){let i=-1;if(t)for(let r=0;r<t.length;r++)if(t[r]==e){i=r;break}return i}static contains(e,t){if(null!=e&&t&&t.length)for(let i of t)if(this.equals(e,i))return!0;return!1}static removeAccents(e){return e&&e.search(/[\xC0-\xFF]/g)>-1&&(e=e.replace(/[\xC0-\xC5]/g,"A").replace(/[\xC6]/g,"AE").replace(/[\xC7]/g,"C").replace(/[\xC8-\xCB]/g,"E").replace(/[\xCC-\xCF]/g,"I").replace(/[\xD0]/g,"D").replace(/[\xD1]/g,"N").replace(/[\xD2-\xD6\xD8]/g,"O").replace(/[\xD9-\xDC]/g,"U").replace(/[\xDD]/g,"Y").replace(/[\xDE]/g,"P").replace(/[\xE0-\xE5]/g,"a").replace(/[\xE6]/g,"ae").replace(/[\xE7]/g,"c").replace(/[\xE8-\xEB]/g,"e").replace(/[\xEC-\xEF]/g,"i").replace(/[\xF1]/g,"n").replace(/[\xF2-\xF6\xF8]/g,"o").replace(/[\xF9-\xFC]/g,"u").replace(/[\xFE]/g,"p").replace(/[\xFD\xFF]/g,"y")),e}static isDate(e){return"[object Date]"===Object.prototype.toString.call(e)}static isEmpty(e){return null==e||""===e||Array.isArray(e)&&0===e.length||!this.isDate(e)&&"object"==typeof e&&0===Object.keys(e).length}static isNotEmpty(e){return!this.isEmpty(e)}static compare(e,t,i,r=1){let s=-1;const o=this.isEmpty(e),a=this.isEmpty(t);return s=o&&a?0:o?r:a?-r:"string"==typeof e&&"string"==typeof t?e.localeCompare(t,i,{numeric:!0}):e<t?-1:e>t?1:0,s}static sort(e,t,i=1,r,s=1){return(1===s?i:s)*Uv.compare(e,t,r,i)}static merge(e,t){if(null!=e||null!=t)return null!=e&&"object"!=typeof e||null!=t&&"object"!=typeof t?null!=e&&"string"!=typeof e||null!=t&&"string"!=typeof t?t||e:[e||"",t||""].join(" "):{...e||{},...t||{}}}static isPrintableCharacter(e=""){return this.isNotEmpty(e)&&1===e.length&&e.match(/\S| /)}static getItemValue(e,...t){return this.isFunction(e)?e(...t):e}static findLastIndex(e,t){let i=-1;if(this.isNotEmpty(e))try{i=e.findLastIndex(t)}catch{i=e.lastIndexOf([...e].reverse().find(t))}return i}static findLast(e,t){let i;if(this.isNotEmpty(e))try{i=e.findLast(t)}catch{i=[...e].reverse().find(t)}return i}}var NG=0;!function mle(){let n=[];const r=s=>s&&parseInt(s.style.zIndex,10)||0}();const gle=["*"];let LG=(()=>{class n{label;spin=!1;styleClass;role;ariaLabel;ariaHidden;ngOnInit(){this.getAttributes()}getAttributes(){const t=Uv.isEmpty(this.label);this.role=t?void 0:"img",this.ariaLabel=t?void 0:this.label,this.ariaHidden=t}getClassNames(){return`p-icon ${this.styleClass?this.styleClass+" ":""}${this.spin?"p-icon-spin":""}`}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=Ji({type:n,selectors:[["ng-component"]],hostAttrs:[1,"p-element","p-icon-wrapper"],inputs:{label:"label",spin:"spin",styleClass:"styleClass"},standalone:!0,features:[ly],ngContentSelectors:gle,decls:1,vars:0,template:function(i,r){1&i&&(VT(),HT(0))},encapsulation:2,changeDetection:0})}return n})(),OG=(()=>{class n extends LG{pathId;ngOnInit(){this.pathId="url(#"+function ple(n="pn_id_"){return`${n}${++NG}`}()+")"}static \u0275fac=function(){let t;return function(r){return(t||(t=gi(n)))(r||n)}}();static \u0275cmp=Ji({type:n,selectors:[["SpinnerIcon"]],standalone:!0,features:[gn,ly],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M6.99701 14C5.85441 13.999 4.72939 13.7186 3.72012 13.1832C2.71084 12.6478 1.84795 11.8737 1.20673 10.9284C0.565504 9.98305 0.165424 8.89526 0.041387 7.75989C-0.0826496 6.62453 0.073125 5.47607 0.495122 4.4147C0.917119 3.35333 1.59252 2.4113 2.46241 1.67077C3.33229 0.930247 4.37024 0.413729 5.4857 0.166275C6.60117 -0.0811796 7.76026 -0.0520535 8.86188 0.251112C9.9635 0.554278 10.9742 1.12227 11.8057 1.90555C11.915 2.01493 11.9764 2.16319 11.9764 2.31778C11.9764 2.47236 11.915 2.62062 11.8057 2.73C11.7521 2.78503 11.688 2.82877 11.6171 2.85864C11.5463 2.8885 11.4702 2.90389 11.3933 2.90389C11.3165 2.90389 11.2404 2.8885 11.1695 2.85864C11.0987 2.82877 11.0346 2.78503 10.9809 2.73C9.9998 1.81273 8.73246 1.26138 7.39226 1.16876C6.05206 1.07615 4.72086 1.44794 3.62279 2.22152C2.52471 2.99511 1.72683 4.12325 1.36345 5.41602C1.00008 6.70879 1.09342 8.08723 1.62775 9.31926C2.16209 10.5513 3.10478 11.5617 4.29713 12.1803C5.48947 12.7989 6.85865 12.988 8.17414 12.7157C9.48963 12.4435 10.6711 11.7264 11.5196 10.6854C12.3681 9.64432 12.8319 8.34282 12.8328 7C12.8328 6.84529 12.8943 6.69692 13.0038 6.58752C13.1132 6.47812 13.2616 6.41667 13.4164 6.41667C13.5712 6.41667 13.7196 6.47812 13.8291 6.58752C13.9385 6.69692 14 6.84529 14 7C14 8.85651 13.2622 10.637 11.9489 11.9497C10.6356 13.2625 8.85432 14 6.99701 14Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(i,r){1&i&&(mf(),It(0,"svg",0)(1,"g"),Br(2,"path",1),Mt(),It(3,"defs")(4,"clipPath",2),Br(5,"rect",3),Mt()()()),2&i&&(Rl(r.getClassNames()),si("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role),Lt(1),si("clip-path",r.pathId),Lt(3),vt("id",r.pathId))},encapsulation:2})}return n})(),Us=(()=>{class n{static zindex=1e3;static calculatedScrollbarWidth=null;static calculatedScrollbarHeight=null;static browser;static addClass(t,i){t&&i&&(t.classList?t.classList.add(i):t.className+=" "+i)}static addMultipleClasses(t,i){if(t&&i)if(t.classList){let r=i.trim().split(" ");for(let s=0;s<r.length;s++)t.classList.add(r[s])}else{let r=i.split(" ");for(let s=0;s<r.length;s++)t.className+=" "+r[s]}}static removeClass(t,i){t&&i&&(t.classList?t.classList.remove(i):t.className=t.className.replace(new RegExp("(^|\\b)"+i.split(" ").join("|")+"(\\b|$)","gi")," "))}static hasClass(t,i){return!(!t||!i)&&(t.classList?t.classList.contains(i):new RegExp("(^| )"+i+"( |$)","gi").test(t.className))}static siblings(t){return Array.prototype.filter.call(t.parentNode.children,function(i){return i!==t})}static find(t,i){return Array.from(t.querySelectorAll(i))}static findSingle(t,i){return this.isElement(t)?t.querySelector(i):null}static index(t){let i=t.parentNode.childNodes,r=0;for(var s=0;s<i.length;s++){if(i[s]==t)return r;1==i[s].nodeType&&r++}return-1}static indexWithinGroup(t,i){let r=t.parentNode?t.parentNode.childNodes:[],s=0;for(var o=0;o<r.length;o++){if(r[o]==t)return s;r[o].attributes&&r[o].attributes[i]&&1==r[o].nodeType&&s++}return-1}static appendOverlay(t,i,r="self"){"self"!==r&&t&&i&&this.appendChild(t,i)}static alignOverlay(t,i,r="self",s=!0){t&&i&&(s&&(t.style.minWidth=`${n.getOuterWidth(i)}px`),"self"===r?this.relativePosition(t,i):this.absolutePosition(t,i))}static relativePosition(t,i){const r=y=>{if(y)return"relative"===getComputedStyle(y).getPropertyValue("position")?y:r(y.parentElement)},s=t.offsetParent?{width:t.offsetWidth,height:t.offsetHeight}:this.getHiddenElementDimensions(t),o=i.offsetHeight,a=i.getBoundingClientRect(),l=this.getWindowScrollTop(),c=this.getWindowScrollLeft(),h=this.getViewport(),p=r(t)?.getBoundingClientRect()||{top:-1*l,left:-1*c};let m,g;a.top+o+s.height>h.height?(m=a.top-p.top-s.height,t.style.transformOrigin="bottom",a.top+m<0&&(m=-1*a.top)):(m=o+a.top-p.top,t.style.transformOrigin="top");const v=a.left+s.width-h.width;g=s.width>h.width?-1*(a.left-p.left):v>0?a.left-p.left-v:a.left-p.left,t.style.top=m+"px",t.style.left=g+"px"}static absolutePosition(t,i){const r=t.offsetParent?{width:t.offsetWidth,height:t.offsetHeight}:this.getHiddenElementDimensions(t),s=r.height,o=r.width,a=i.offsetHeight,l=i.offsetWidth,c=i.getBoundingClientRect(),h=this.getWindowScrollTop(),d=this.getWindowScrollLeft(),p=this.getViewport();let m,g;c.top+a+s>p.height?(m=c.top+h-s,t.style.transformOrigin="bottom",m<0&&(m=h)):(m=a+c.top+h,t.style.transformOrigin="top"),g=c.left+o>p.width?Math.max(0,c.left+d+l-o):c.left+d,t.style.top=m+"px",t.style.left=g+"px"}static getParents(t,i=[]){return null===t.parentNode?i:this.getParents(t.parentNode,i.concat([t.parentNode]))}static getScrollableParents(t){let i=[];if(t){let r=this.getParents(t);const s=/(auto|scroll)/,o=a=>{let l=window.getComputedStyle(a,null);return s.test(l.getPropertyValue("overflow"))||s.test(l.getPropertyValue("overflowX"))||s.test(l.getPropertyValue("overflowY"))};for(let a of r){let l=1===a.nodeType&&a.dataset.scrollselectors;if(l){let c=l.split(",");for(let h of c){let d=this.findSingle(a,h);d&&o(d)&&i.push(d)}}9!==a.nodeType&&o(a)&&i.push(a)}}return i}static getHiddenElementOuterHeight(t){t.style.visibility="hidden",t.style.display="block";let i=t.offsetHeight;return t.style.display="none",t.style.visibility="visible",i}static getHiddenElementOuterWidth(t){t.style.visibility="hidden",t.style.display="block";let i=t.offsetWidth;return t.style.display="none",t.style.visibility="visible",i}static getHiddenElementDimensions(t){let i={};return t.style.visibility="hidden",t.style.display="block",i.width=t.offsetWidth,i.height=t.offsetHeight,t.style.display="none",t.style.visibility="visible",i}static scrollInView(t,i){let r=getComputedStyle(t).getPropertyValue("borderTopWidth"),s=r?parseFloat(r):0,o=getComputedStyle(t).getPropertyValue("paddingTop"),a=o?parseFloat(o):0,l=t.getBoundingClientRect(),h=i.getBoundingClientRect().top+document.body.scrollTop-(l.top+document.body.scrollTop)-s-a,d=t.scrollTop,p=t.clientHeight,m=this.getOuterHeight(i);h<0?t.scrollTop=d+h:h+m>p&&(t.scrollTop=d+h-p+m)}static fadeIn(t,i){t.style.opacity=0;let r=+new Date,s=0,o=function(){s=+t.style.opacity.replace(",",".")+((new Date).getTime()-r)/i,t.style.opacity=s,r=+new Date,+s<1&&(window.requestAnimationFrame&&requestAnimationFrame(o)||setTimeout(o,16))};o()}static fadeOut(t,i){var r=1,a=50/i;let l=setInterval(()=>{(r-=a)<=0&&(r=0,clearInterval(l)),t.style.opacity=r},50)}static getWindowScrollTop(){let t=document.documentElement;return(window.pageYOffset||t.scrollTop)-(t.clientTop||0)}static getWindowScrollLeft(){let t=document.documentElement;return(window.pageXOffset||t.scrollLeft)-(t.clientLeft||0)}static matches(t,i){var r=Element.prototype;return(r.matches||r.webkitMatchesSelector||r.mozMatchesSelector||r.msMatchesSelector||function(o){return-1!==[].indexOf.call(document.querySelectorAll(o),this)}).call(t,i)}static getOuterWidth(t,i){let r=t.offsetWidth;if(i){let s=getComputedStyle(t);r+=parseFloat(s.marginLeft)+parseFloat(s.marginRight)}return r}static getHorizontalPadding(t){let i=getComputedStyle(t);return parseFloat(i.paddingLeft)+parseFloat(i.paddingRight)}static getHorizontalMargin(t){let i=getComputedStyle(t);return parseFloat(i.marginLeft)+parseFloat(i.marginRight)}static innerWidth(t){let i=t.offsetWidth,r=getComputedStyle(t);return i+=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight),i}static width(t){let i=t.offsetWidth,r=getComputedStyle(t);return i-=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight),i}static getInnerHeight(t){let i=t.offsetHeight,r=getComputedStyle(t);return i+=parseFloat(r.paddingTop)+parseFloat(r.paddingBottom),i}static getOuterHeight(t,i){let r=t.offsetHeight;if(i){let s=getComputedStyle(t);r+=parseFloat(s.marginTop)+parseFloat(s.marginBottom)}return r}static getHeight(t){let i=t.offsetHeight,r=getComputedStyle(t);return i-=parseFloat(r.paddingTop)+parseFloat(r.paddingBottom)+parseFloat(r.borderTopWidth)+parseFloat(r.borderBottomWidth),i}static getWidth(t){let i=t.offsetWidth,r=getComputedStyle(t);return i-=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight)+parseFloat(r.borderLeftWidth)+parseFloat(r.borderRightWidth),i}static getViewport(){let t=window,i=document,r=i.documentElement,s=i.getElementsByTagName("body")[0];return{width:t.innerWidth||r.clientWidth||s.clientWidth,height:t.innerHeight||r.clientHeight||s.clientHeight}}static getOffset(t){var i=t.getBoundingClientRect();return{top:i.top+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0),left:i.left+(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0)}}static replaceElementWith(t,i){let r=t.parentNode;if(!r)throw"Can't replace element";return r.replaceChild(i,t)}static getUserAgent(){if(navigator&&this.isClient())return navigator.userAgent}static isIE(){var t=window.navigator.userAgent;return t.indexOf("MSIE ")>0||(t.indexOf("Trident/")>0?(t.indexOf("rv:"),!0):t.indexOf("Edge/")>0)}static isIOS(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream}static isAndroid(){return/(android)/i.test(navigator.userAgent)}static isTouchDevice(){return"ontouchstart"in window||navigator.maxTouchPoints>0}static appendChild(t,i){if(this.isElement(i))i.appendChild(t);else{if(!(i&&i.el&&i.el.nativeElement))throw"Cannot append "+i+" to "+t;i.el.nativeElement.appendChild(t)}}static removeChild(t,i){if(this.isElement(i))i.removeChild(t);else{if(!i.el||!i.el.nativeElement)throw"Cannot remove "+t+" from "+i;i.el.nativeElement.removeChild(t)}}static removeElement(t){"remove"in Element.prototype?t.remove():t.parentNode.removeChild(t)}static isElement(t){return"object"==typeof HTMLElement?t instanceof HTMLElement:t&&"object"==typeof t&&null!==t&&1===t.nodeType&&"string"==typeof t.nodeName}static calculateScrollbarWidth(t){if(t){let i=getComputedStyle(t);return t.offsetWidth-t.clientWidth-parseFloat(i.borderLeftWidth)-parseFloat(i.borderRightWidth)}{if(null!==this.calculatedScrollbarWidth)return this.calculatedScrollbarWidth;let i=document.createElement("div");i.className="p-scrollbar-measure",document.body.appendChild(i);let r=i.offsetWidth-i.clientWidth;return document.body.removeChild(i),this.calculatedScrollbarWidth=r,r}}static calculateScrollbarHeight(){if(null!==this.calculatedScrollbarHeight)return this.calculatedScrollbarHeight;let t=document.createElement("div");t.className="p-scrollbar-measure",document.body.appendChild(t);let i=t.offsetHeight-t.clientHeight;return document.body.removeChild(t),this.calculatedScrollbarWidth=i,i}static invokeElementMethod(t,i,r){t[i].apply(t,r)}static clearSelection(){if(window.getSelection)window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().rangeCount>0&&window.getSelection().getRangeAt(0).getClientRects().length>0&&window.getSelection().removeAllRanges();else if(document.selection&&document.selection.empty)try{document.selection.empty()}catch{}}static getBrowser(){if(!this.browser){let t=this.resolveUserAgent();this.browser={},t.browser&&(this.browser[t.browser]=!0,this.browser.version=t.version),this.browser.chrome?this.browser.webkit=!0:this.browser.webkit&&(this.browser.safari=!0)}return this.browser}static resolveUserAgent(){let t=navigator.userAgent.toLowerCase(),i=/(chrome)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[];return{browser:i[1]||"",version:i[2]||"0"}}static isInteger(t){return Number.isInteger?Number.isInteger(t):"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}static isHidden(t){return!t||null===t.offsetParent}static isVisible(t){return t&&null!=t.offsetParent}static isExist(t){return null!==t&&typeof t<"u"&&t.nodeName&&t.parentNode}static focus(t,i){t&&document.activeElement!==t&&t.focus(i)}static getFocusableElements(t){let i=n.find(t,'button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),\n                [href]:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),\n                input:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]), select:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),\n                textarea:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]), [tabIndex]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),\n                [contenteditable]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]):not(.p-disabled)'),r=[];for(let s of i)(s.offsetWidth||s.offsetHeight||s.getClientRects().length)&&r.push(s);return r}static getNextFocusableElement(t,i=!1){const r=n.getFocusableElements(t);let s=0;if(r&&r.length>0){const o=r.indexOf(r[0].ownerDocument.activeElement);i?s=-1==o||0===o?r.length-1:o-1:-1!=o&&o!==r.length-1&&(s=o+1)}return r[s]}static generateZIndex(){return this.zindex=this.zindex||999,++this.zindex}static getSelection(){return window.getSelection?window.getSelection().toString():document.getSelection?document.getSelection().toString():document.selection?document.selection.createRange().text:null}static getTargetElement(t,i){if(!t)return null;switch(t){case"document":return document;case"window":return window;case"@next":return i?.nextElementSibling;case"@prev":return i?.previousElementSibling;case"@parent":return i?.parentElement;case"@grandparent":return i?.parentElement.parentElement;default:const r=typeof t;if("string"===r)return document.querySelector(t);if("object"===r&&t.hasOwnProperty("nativeElement"))return this.isExist(t.nativeElement)?t.nativeElement:void 0;const o=(a=t)&&a.constructor&&a.call&&a.apply?t():t;return o&&9===o.nodeType||this.isExist(o)?o:null}var a}static isClient(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}static getAttribute(t,i){if(t){const r=t.getAttribute(i);return isNaN(r)?"true"===r||"false"===r?"true"===r:r:+r}}static calculateBodyScrollbarWidth(){return window.innerWidth-document.documentElement.offsetWidth}static blockBodyScroll(t="p-overflow-hidden"){document.body.style.setProperty("--scrollbar-width",this.calculateBodyScrollbarWidth()+"px"),this.addClass(document.body,t)}static unblockBodyScroll(t="p-overflow-hidden"){document.body.style.removeProperty("--scrollbar-width"),this.removeClass(document.body,t)}}return n})(),_le=(()=>{class n{document;platformId;renderer;el;zone;config;constructor(t,i,r,s,o,a){this.document=t,this.platformId=i,this.renderer=r,this.el=s,this.zone=o,this.config=a}animationListener;mouseDownListener;timeout;ngAfterViewInit(){(function x9(n){return n===HF})(this.platformId)&&this.config&&this.config.ripple&&this.zone.runOutsideAngular(()=>{this.create(),this.mouseDownListener=this.renderer.listen(this.el.nativeElement,"mousedown",this.onMouseDown.bind(this))})}onMouseDown(t){let i=this.getInk();if(!i||"none"===this.document.defaultView?.getComputedStyle(i,null).display)return;if(Us.removeClass(i,"p-ink-active"),!Us.getHeight(i)&&!Us.getWidth(i)){let a=Math.max(Us.getOuterWidth(this.el.nativeElement),Us.getOuterHeight(this.el.nativeElement));i.style.height=a+"px",i.style.width=a+"px"}let r=Us.getOffset(this.el.nativeElement),s=t.pageX-r.left+this.document.body.scrollTop-Us.getWidth(i)/2,o=t.pageY-r.top+this.document.body.scrollLeft-Us.getHeight(i)/2;this.renderer.setStyle(i,"top",o+"px"),this.renderer.setStyle(i,"left",s+"px"),Us.addClass(i,"p-ink-active"),this.timeout=setTimeout(()=>{let a=this.getInk();a&&Us.removeClass(a,"p-ink-active")},401)}getInk(){const t=this.el.nativeElement.children;for(let i=0;i<t.length;i++)if("string"==typeof t[i].className&&-1!==t[i].className.indexOf("p-ink"))return t[i];return null}resetInk(){let t=this.getInk();t&&Us.removeClass(t,"p-ink-active")}onAnimationEnd(t){this.timeout&&clearTimeout(this.timeout),Us.removeClass(t.currentTarget,"p-ink-active")}create(){let t=this.renderer.createElement("span");this.renderer.addClass(t,"p-ink"),this.renderer.appendChild(this.el.nativeElement,t),this.renderer.setAttribute(t,"aria-hidden","true"),this.renderer.setAttribute(t,"role","presentation"),this.animationListener||(this.animationListener=this.renderer.listen(t,"animationend",this.onAnimationEnd.bind(this)))}remove(){let t=this.getInk();t&&(this.mouseDownListener&&this.mouseDownListener(),this.animationListener&&this.animationListener(),this.mouseDownListener=null,this.animationListener=null,Us.removeElement(t))}ngOnDestroy(){this.config&&this.config.ripple&&this.remove()}static \u0275fac=function(i){return new(i||n)(ce(Vr),ce(Va),ce(yi),ce(En),ce(Mn),ce(fle,8))};static \u0275dir=pt({type:n,selectors:[["","pRipple",""]],hostAttrs:[1,"p-ripple","p-element"]})}return n})(),yle=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=ki({type:n});static \u0275inj=Ti({imports:[Mp]})}return n})();function vle(n,e){1&n&&BT(0)}function wle(n,e){if(1&n&&Br(0,"span",8),2&n){const t=dn(3);Rl("p-button-loading-icon pi-spin "+t.loadingIcon),vt("ngClass",t.iconClass()),si("aria-hidden",!0)("data-pc-section","loadingicon")}}function ble(n,e){1&n&&Br(0,"SpinnerIcon",9),2&n&&(vt("styleClass",dn(3).spinnerIconClass())("spin",!0),si("aria-hidden",!0)("data-pc-section","loadingicon"))}function Ele(n,e){if(1&n&&(Zc(0),_n(1,wle,1,5,"span",6),_n(2,ble,1,4,"SpinnerIcon",7),Jc()),2&n){const t=dn(2);Lt(1),vt("ngIf",t.loadingIcon),Lt(1),vt("ngIf",!t.loadingIcon)}}function Sle(n,e){}function Cle(n,e){1&n&&_n(0,Sle,0,0,"ng-template")}function xle(n,e){if(1&n&&(It(0,"span",10),_n(1,Cle,1,0,null,1),Mt()),2&n){const t=dn(2);vt("ngClass",t.iconClass()),si("aria-hidden",!0)("data-pc-section","loadingicon"),Lt(1),vt("ngTemplateOutlet",t.loadingIconTemplate)}}function Mle(n,e){if(1&n&&(Zc(0),_n(1,Ele,3,2,"ng-container",2),_n(2,xle,2,4,"span",5),Jc()),2&n){const t=dn();Lt(1),vt("ngIf",!t.loadingIconTemplate),Lt(1),vt("ngIf",t.loadingIconTemplate)}}function Tle(n,e){if(1&n&&Br(0,"span",8),2&n){const t=dn(2);Rl(t.icon),vt("ngClass",t.iconClass()),si("data-pc-section","icon")}}function Ale(n,e){}function Dle(n,e){1&n&&_n(0,Ale,0,0,"ng-template",12),2&n&&vt("ngIf",!dn(3).icon)}function Ile(n,e){if(1&n&&(It(0,"span",8),_n(1,Dle,1,1,null,1),Mt()),2&n){const t=dn(2);vt("ngClass",t.iconClass()),si("data-pc-section","icon"),Lt(1),vt("ngTemplateOutlet",t.iconTemplate)}}function Rle(n,e){if(1&n&&(Zc(0),_n(1,Tle,1,4,"span",6),_n(2,Ile,2,3,"span",11),Jc()),2&n){const t=dn();Lt(1),vt("ngIf",t.icon&&!t.iconTemplate),Lt(1),vt("ngIf",!t.icon&&t.iconTemplate)}}function Ple(n,e){if(1&n&&(It(0,"span",13),Tn(1),Mt()),2&n){const t=dn();si("aria-hidden",t.icon&&!t.label)("data-pc-section","label"),Lt(1),Pl(t.label)}}function Nle(n,e){if(1&n&&(It(0,"span",8),Tn(1),Mt()),2&n){const t=dn();Rl(t.badgeClass),vt("ngClass",t.badgeStyleClass()),si("data-pc-section","badge"),Lt(1),Pl(t.badge)}}const Lle=["*"];let KR=(()=>{class n{type="button";iconPos="left";icon;badge;label;disabled;loading=!1;loadingIcon;raised=!1;rounded=!1;text=!1;plain=!1;severity;outlined=!1;link=!1;size;style;styleClass;badgeClass;ariaLabel;onClick=new qn;onFocus=new qn;onBlur=new qn;contentTemplate;loadingIconTemplate;iconTemplate;templates;spinnerIconClass(){return Object.entries(this.iconClass()).filter(([,t])=>!!t).reduce((t,[i])=>t+` ${i}`,"p-button-loading-icon")}iconClass(){return{"p-button-icon":!0,"p-button-icon-left":"left"===this.iconPos&&this.label,"p-button-icon-right":"right"===this.iconPos&&this.label,"p-button-icon-top":"top"===this.iconPos&&this.label,"p-button-icon-bottom":"bottom"===this.iconPos&&this.label}}buttonClass(){return{"p-button p-component":!0,"p-button-icon-only":(this.icon||this.iconTemplate||this.loadingIcon||this.loadingIconTemplate)&&!this.label,"p-button-vertical":("top"===this.iconPos||"bottom"===this.iconPos)&&this.label,"p-disabled":this.disabled||this.loading,"p-button-loading":this.loading,"p-button-loading-label-only":this.loading&&!this.icon&&this.label&&!this.loadingIcon&&"left"===this.iconPos,"p-button-link":this.link,[`p-button-${this.severity}`]:this.severity,"p-button-raised":this.raised,"p-button-rounded":this.rounded,"p-button-text":this.text,"p-button-outlined":this.outlined,"p-button-sm":"small"===this.size,"p-button-lg":"large"===this.size,"p-button-plain":this.plain}}ngAfterContentInit(){this.templates?.forEach(t=>{switch(t.getType()){case"content":default:this.contentTemplate=t.template;break;case"icon":this.iconTemplate=t.template;break;case"loadingicon":this.loadingIconTemplate=t.template}})}badgeStyleClass(){return{"p-badge p-component":!0,"p-badge-no-gutter":this.badge&&1===String(this.badge).length}}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=Ji({type:n,selectors:[["p-button"]],contentQueries:function(i,r,s){if(1&i&&Ob(s,PG,4),2&i){let o;wp(o=bp())&&(r.templates=o)}},hostAttrs:[1,"p-element"],hostVars:2,hostBindings:function(i,r){2&i&&ty("p-disabled",r.disabled)},inputs:{type:"type",iconPos:"iconPos",icon:"icon",badge:"badge",label:"label",disabled:"disabled",loading:"loading",loadingIcon:"loadingIcon",raised:"raised",rounded:"rounded",text:"text",plain:"plain",severity:"severity",outlined:"outlined",link:"link",size:"size",style:"style",styleClass:"styleClass",badgeClass:"badgeClass",ariaLabel:"ariaLabel"},outputs:{onClick:"onClick",onFocus:"onFocus",onBlur:"onBlur"},ngContentSelectors:Lle,decls:7,vars:14,consts:[["pRipple","",3,"ngStyle","disabled","ngClass","click","focus","blur"],[4,"ngTemplateOutlet"],[4,"ngIf"],["class","p-button-label",4,"ngIf"],[3,"ngClass","class",4,"ngIf"],["class","p-button-loading-icon",3,"ngClass",4,"ngIf"],[3,"class","ngClass",4,"ngIf"],[3,"styleClass","spin",4,"ngIf"],[3,"ngClass"],[3,"styleClass","spin"],[1,"p-button-loading-icon",3,"ngClass"],[3,"ngClass",4,"ngIf"],[3,"ngIf"],[1,"p-button-label"]],template:function(i,r){1&i&&(VT(),It(0,"button",0),yn("click",function(o){return r.onClick.emit(o)})("focus",function(o){return r.onFocus.emit(o)})("blur",function(o){return r.onBlur.emit(o)}),HT(1),_n(2,vle,1,0,"ng-container",1),_n(3,Mle,3,2,"ng-container",2),_n(4,Rle,3,2,"ng-container",2),_n(5,Ple,2,3,"span",3),_n(6,Nle,2,5,"span",4),Mt()),2&i&&(Rl(r.styleClass),vt("ngStyle",r.style)("disabled",r.disabled||r.loading)("ngClass",r.buttonClass()),si("type",r.type)("aria-label",r.ariaLabel)("data-pc-name","button")("data-pc-section","root"),Lt(2),vt("ngTemplateOutlet",r.contentTemplate),Lt(1),vt("ngIf",r.loading),Lt(1),vt("ngIf",!r.loading),Lt(1),vt("ngIf",!r.contentTemplate&&r.label),Lt(1),vt("ngIf",!r.contentTemplate&&r.badge))},dependencies:function(){return[tE,_y,XA,qA,_le,OG]},encapsulation:2,changeDetection:0})}return n})(),Ole=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=ki({type:n});static \u0275inj=Ti({imports:[Mp,yle,YR,OG,YR]})}return n})(),Fle=(()=>{class n{constructor(t,i,r,s,o){this.router=t,this.generalService=i,this.signalRService=r,this.activatedRoute=s,this.dalService=o,this.usernameModel="",this.usernameModel=i.User?i.User.name:""}ngAfterViewInit(){}ngOnChanges(t){}ngOnDestroy(){}ngOnInit(){}login(){this.dalService.login(this.usernameModel).subscribe(t=>{this.generalService.User=t,this.signalRService.startConnection(this.generalService.User.id),localStorage.setItem("user",JSON.stringify(t)),this.router.navigate([Vs.GamesList])})}static#e=this.\u0275fac=function(i){return new(i||n)(ce(Mr),ce(jm),ce(Ov),ce(Hl),ce(PC))};static#t=this.\u0275cmp=Ji({type:n,selectors:[["app-home-view"]],features:[Hi],decls:5,vars:1,consts:[[3,"ngModel","ngModelChange"],[3,"onClick"]],template:function(i,r){1&i&&(It(0,"div"),Tn(1,"MG X"),Mt(),It(2,"input",0),yn("ngModelChange",function(o){return r.usernameModel=o}),Mt(),It(3,"p-button",1),yn("onClick",function(){return r.login()}),Tn(4,"Login"),Mt()),2&i&&(Lt(2),vt("ngModel",r.usernameModel))},dependencies:[wE,bU,$1,KR]})}return n})();function kle(n,e){if(1&n){const t=Ch();It(0,"div",4)(1,"div"),Tn(2),Mt(),It(3,"div"),Tn(4),Mt(),It(5,"div"),Tn(6),Mt(),It(7,"p-button",5),yn("onClick",function(){const s=as(t).$implicit;return Sr(dn().setup(s))}),Tn(8,"settings"),Mt(),It(9,"p-button",6),yn("onClick",function(){const s=as(t).$implicit;return Sr(dn().delete(s))}),Tn(10,"DELETE"),Mt()()}if(2&n){const t=e.$implicit;Lt(2),_p("",t.name," "),Lt(2),_p("",t.gameStatus," "),Lt(2),_p("",t.gameType," ")}}let Ule=(()=>{class n{constructor(t,i,r,s){this.signalRService=t,this.router=i,this.generalService=r,this.dalService=s,this.games=[]}ngOnInit(){this.user=this.generalService.User,this.updateGamesList(),this.signalRService.hubConnection.on("GamesUpdated",t=>{console.log("GamesUpdated",t),this.updateGamesList()}),this.signalRService.hubConnection.on("GameDeleted",t=>{console.log("GameDeleted",t),this.updateGamesList()})}ngAfterViewInit(){}ngOnChanges(t){}ngOnDestroy(){}updateGamesList(){this.dalService.getGamesList().subscribe(t=>{this.games=t})}createGame(t){this.dalService.createGame(this.user.id,t).subscribe()}setup(t){this.router.navigate([Vs.GameSetup,t.id])}delete(t){this.dalService.deleteGame(t.id).subscribe()}static#e=this.\u0275fac=function(i){return new(i||n)(ce(Ov),ce(Mr),ce(jm),ce(PC))};static#t=this.\u0275cmp=Ji({type:n,selectors:[["app-games-list"]],features:[Hi],decls:13,vars:2,consts:[[2,"font-size","20px"],["class","mg-row-center","style","margin:10px;column-gap: 10px;border: 1px solid black;",4,"ngFor","ngForOf"],[1,"mg-row-center",2,"column-gap","10px"],["severity","secondary",3,"onClick"],[1,"mg-row-center",2,"margin","10px","column-gap","10px","border","1px solid black"],["severity","warning",3,"onClick"],["severity","danger",3,"onClick"]],template:function(i,r){1&i&&(It(0,"div")(1,"div",0),Tn(2,"Hello "),It(3,"b"),Tn(4),Mt()(),_n(5,kle,11,3,"div",1),It(6,"div",2)(7,"p-button",3),yn("onClick",function(){return r.createGame("TIK_TAK_TOE")}),Tn(8,"create game TIK_TAK_TOE"),Mt(),It(9,"p-button",3),yn("onClick",function(){return r.createGame("CHESS")}),Tn(10,"create game CHESS"),Mt(),It(11,"p-button",3),yn("onClick",function(){return r.createGame("DND")}),Tn(12,"create game DnD"),Mt()()()),2&i&&(Lt(4),Pl(r.user.name),Lt(1),vt("ngForOf",r.games))},dependencies:[nE,KR]})}return n})();function Ble(n,e){1&n&&Br(0,"div",9)}function Vle(n,e){if(1&n&&(It(0,"span",10),Tn(1),Mt()),2&n){const t=dn().$implicit;Lt(1),Pl(t.description)}}function Hle(n,e){if(1&n&&(It(0,"section",11),Br(1,"ngx-json-viewer",12),Mt()),2&n){const t=dn().$implicit,i=dn();Lt(1),vt("json",t.value)("expanded",i.expanded)("depth",i.depth)("_currentDepth",i._currentDepth+1)}}const zle=function(n){return["segment",n]},Gle=function(n,e){return{"segment-main":!0,expandable:n,expanded:e}};function Wle(n,e){if(1&n){const t=Ch();It(0,"section",2)(1,"section",3),yn("click",function(){const s=as(t).$implicit;return Sr(dn().toggle(s))}),_n(2,Ble,1,0,"div",4),It(3,"span",5),Tn(4),Mt(),It(5,"span",6),Tn(6,": "),Mt(),_n(7,Vle,2,1,"span",7),Mt(),_n(8,Hle,2,4,"section",8),Mt()}if(2&n){const t=e.$implicit,i=dn();vt("ngClass",i2(6,zle,"segment-type-"+t.type)),Lt(1),vt("ngClass",r2(8,Gle,i.isExpandable(t),t.expanded)),Lt(1),vt("ngIf",i.isExpandable(t)),Lt(2),Pl(t.key),Lt(3),vt("ngIf",!t.expanded||!i.isExpandable(t)),Lt(1),vt("ngIf",t.expanded&&i.isExpandable(t))}}let jle=(()=>{class n{constructor(){this.expanded=!0,this.depth=-1,this._currentDepth=0,this.segments=[]}ngOnChanges(){this.segments=[],this.json=this.decycle(this.json),"object"==typeof this.json?Object.keys(this.json).forEach(t=>{this.segments.push(this.parseKeyValue(t,this.json[t]))}):this.segments.push(this.parseKeyValue(`(${typeof this.json})`,this.json))}isExpandable(t){return"object"===t.type||"array"===t.type}toggle(t){this.isExpandable(t)&&(t.expanded=!t.expanded)}parseKeyValue(t,i){const r={key:t,value:i,type:void 0,description:""+i,expanded:this.isExpanded()};switch(typeof r.value){case"number":r.type="number";break;case"boolean":r.type="boolean";break;case"function":r.type="function";break;case"string":r.type="string",r.description='"'+r.value+'"';break;case"undefined":r.type="undefined",r.description="undefined";break;case"object":null===r.value?(r.type="null",r.description="null"):Array.isArray(r.value)?(r.type="array",r.description="Array["+r.value.length+"] "+JSON.stringify(r.value)):r.value instanceof Date?r.type="date":(r.type="object",r.description="Object "+JSON.stringify(r.value))}return r}isExpanded(){return this.expanded&&!(this.depth>-1&&this._currentDepth>=this.depth)}decycle(t){const i=new WeakMap;return function r(s,o){let a,l;return"object"!=typeof s||null===s||s instanceof Boolean||s instanceof Date||s instanceof Number||s instanceof RegExp||s instanceof String?s:(a=i.get(s),void 0!==a?{$ref:a}:(i.set(s,o),Array.isArray(s)?(l=[],s.forEach(function(c,h){l[h]=r(c,o+"["+h+"]")})):(l={},Object.keys(s).forEach(function(c){l[c]=r(s[c],o+"["+JSON.stringify(c)+"]")})),l))}(t,"$")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Ji({type:n,selectors:[["ngx-json-viewer"]],inputs:{json:"json",expanded:"expanded",depth:"depth",_currentDepth:"_currentDepth"},features:[Hi],decls:2,vars:1,consts:[[1,"ngx-json-viewer"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],[3,"ngClass","click"],["class","toggler",4,"ngIf"],[1,"segment-key"],[1,"segment-separator"],["class","segment-value",4,"ngIf"],["class","children",4,"ngIf"],[1,"toggler"],[1,"segment-value"],[1,"children"],[3,"json","expanded","depth","_currentDepth"]],template:function(t,i){1&t&&(It(0,"section",0),_n(1,Wle,9,11,"section",1),Mt()),2&t&&(Lt(1),vt("ngForOf",i.segments))},dependencies:[tE,nE,_y,n],styles:['@charset "UTF-8";.ngx-json-viewer[_ngcontent-%COMP%]{font-family:var(--ngx-json-font-family, monospace);font-size:var(--ngx-json-font-size, 1em);width:100%;height:100%;overflow:hidden;position:relative}.ngx-json-viewer[_ngcontent-%COMP%]   .segment[_ngcontent-%COMP%]{padding:2px;margin:1px 1px 1px 12px}.ngx-json-viewer[_ngcontent-%COMP%]   .segment[_ngcontent-%COMP%]   .segment-main[_ngcontent-%COMP%]{word-wrap:break-word}.ngx-json-viewer[_ngcontent-%COMP%]   .segment[_ngcontent-%COMP%]   .segment-main[_ngcontent-%COMP%]   .toggler[_ngcontent-%COMP%]{position:absolute;margin-left:-14px;margin-top:3px;font-size:.8em;line-height:1.2em;vertical-align:middle;color:var(--ngx-json-toggler, #787878)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment[_ngcontent-%COMP%]   .segment-main[_ngcontent-%COMP%]   .toggler[_ngcontent-%COMP%]:after{display:inline-block;content:"\\25ba";transition:transform .1s ease-in}.ngx-json-viewer[_ngcontent-%COMP%]   .segment[_ngcontent-%COMP%]   .segment-main[_ngcontent-%COMP%]   .segment-key[_ngcontent-%COMP%]{color:var(--ngx-json-key, #4E187C)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment[_ngcontent-%COMP%]   .segment-main[_ngcontent-%COMP%]   .segment-separator[_ngcontent-%COMP%]{color:var(--ngx-json-separator, #999)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment[_ngcontent-%COMP%]   .segment-main[_ngcontent-%COMP%]   .segment-value[_ngcontent-%COMP%]{color:var(--ngx-json-value, #000)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment[_ngcontent-%COMP%]   .children[_ngcontent-%COMP%]{margin-left:12px}.ngx-json-viewer[_ngcontent-%COMP%]   .segment-type-string[_ngcontent-%COMP%] > .segment-main[_ngcontent-%COMP%] > .segment-value[_ngcontent-%COMP%]{color:var(--ngx-json-string, #FF6B6B)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment-type-number[_ngcontent-%COMP%] > .segment-main[_ngcontent-%COMP%] > .segment-value[_ngcontent-%COMP%]{color:var(--ngx-json-number, #009688)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment-type-boolean[_ngcontent-%COMP%] > .segment-main[_ngcontent-%COMP%] > .segment-value[_ngcontent-%COMP%]{color:var(--ngx-json-boolean, #B938A4)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment-type-date[_ngcontent-%COMP%] > .segment-main[_ngcontent-%COMP%] > .segment-value[_ngcontent-%COMP%]{color:var(--ngx-json-date, #05668D)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment-type-array[_ngcontent-%COMP%] > .segment-main[_ngcontent-%COMP%] > .segment-value[_ngcontent-%COMP%]{color:var(--ngx-json-array, #999)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment-type-object[_ngcontent-%COMP%] > .segment-main[_ngcontent-%COMP%] > .segment-value[_ngcontent-%COMP%]{color:var(--ngx-json-object, #999)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment-type-function[_ngcontent-%COMP%] > .segment-main[_ngcontent-%COMP%] > .segment-value[_ngcontent-%COMP%]{color:var(--ngx-json-function, #999)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment-type-null[_ngcontent-%COMP%] > .segment-main[_ngcontent-%COMP%] > .segment-value[_ngcontent-%COMP%]{color:var(--ngx-json-null, #fff)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment-type-undefined[_ngcontent-%COMP%] > .segment-main[_ngcontent-%COMP%] > .segment-value[_ngcontent-%COMP%]{color:var(--ngx-json-undefined, #fff)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment-type-null[_ngcontent-%COMP%] > .segment-main[_ngcontent-%COMP%] > .segment-value[_ngcontent-%COMP%]{background-color:var(--ngx-json-null-bg, red)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment-type-undefined[_ngcontent-%COMP%] > .segment-main[_ngcontent-%COMP%] > .segment-key[_ngcontent-%COMP%]{color:var(--ngx-json-undefined-key, #999)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment-type-undefined[_ngcontent-%COMP%] > .segment-main[_ngcontent-%COMP%] > .segment-value[_ngcontent-%COMP%]{background-color:var(--ngx-json-undefined-key, #999)}.ngx-json-viewer[_ngcontent-%COMP%]   .segment-type-object[_ngcontent-%COMP%] > .segment-main[_ngcontent-%COMP%], .ngx-json-viewer[_ngcontent-%COMP%]   .segment-type-array[_ngcontent-%COMP%] > .segment-main[_ngcontent-%COMP%]{white-space:nowrap}.ngx-json-viewer[_ngcontent-%COMP%]   .expanded[_ngcontent-%COMP%] > .toggler[_ngcontent-%COMP%]:after{transform:rotate(90deg)}.ngx-json-viewer[_ngcontent-%COMP%]   .expandable[_ngcontent-%COMP%], .ngx-json-viewer[_ngcontent-%COMP%]   .expandable[_ngcontent-%COMP%] > .toggler[_ngcontent-%COMP%]{cursor:pointer}']}),n})(),$le=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ki({type:n}),n.\u0275inj=Ti({imports:[Mp]}),n})();function qle(n,e){if(1&n){const t=Ch();It(0,"div",11)(1,"div",12),Tn(2),Mt(),It(3,"div")(4,"p-button",10),yn("onClick",function(){const s=as(t).$implicit;return Sr(dn(2).join_game(s))}),Tn(5,"JOIN"),Mt()(),It(6,"div")(7,"p-button",9),yn("onClick",function(){const s=as(t).$implicit;return Sr(dn(2).set_ai(s))}),Tn(8,"AI"),Mt()(),It(9,"div")(10,"p-button",13),yn("onClick",function(){const s=as(t).$implicit;return Sr(dn(2).leave(s))}),Tn(11,"LEAVE"),Mt()()()}if(2&n){const t=e.$implicit;Lt(2),Pl(t.type)}}function Xle(n,e){if(1&n){const t=Ch();It(0,"div",1)(1,"div",2),Tn(2,"Settings"),Mt(),It(3,"div"),Br(4,"ngx-json-viewer",3),Mt(),It(5,"div",4)(6,"div",5),Tn(7,"Players"),Mt(),_n(8,qle,12,1,"div",6),Mt(),It(9,"div",7)(10,"p-button",8),yn("onClick",function(){return as(t),Sr(dn().setup())}),Tn(11,"SETUP"),Mt(),It(12,"p-button",9),yn("onClick",function(){return as(t),Sr(dn().start())}),Tn(13,"START"),Mt(),It(14,"p-button",10),yn("onClick",function(){return as(t),Sr(dn().open())}),Tn(15,"OPEN"),Mt()()()}if(2&n){const t=dn();Lt(4),vt("json",t.gameData)("depth",1),Lt(4),vt("ngForOf",t.gameData.players)}}let Yle=(()=>{class n{constructor(t,i,r,s,o,a){this.signalRService=t,this.router=i,this.unsubscriberService=r,this.activatedRoute=s,this.generalService=o,this.dalService=a,this.gameId=""}ngOnInit(){this.user=this.generalService.User,this.gameId=this.activatedRoute.snapshot.paramMap.get("id"),this.updateGame(),this.signalRService.hubConnection.off("GameUpdated"),this.signalRService.hubConnection.on("GameUpdated",t=>{console.log("GameUpdated",t),this.gameData=t}),this.signalRService.hubConnection.off("GameDeleted"),this.signalRService.hubConnection.on("GameDeleted",t=>{console.log("GameDeleted",t)})}ngOnDestroy(){this.signalRService.hubConnection.off("GameUpdated"),this.signalRService.hubConnection.off("GamesUpdated"),this.signalRService.hubConnection.off("GameDeleted")}updateGame(){this.dalService.getGameById(this.gameId).subscribe(t=>{t?this.gameData?this.iterate(this.gameData,t):this.gameData=t:this.router.navigate([Vs.GamesList])})}iterate(t,i){for(let r in t)i.hasOwnProperty(r)&&("object"==typeof t[r]?this.iterate(t[r],i[r]):t[r]=i[r])}ngAfterViewInit(){}ngOnChanges(t){}start(){this.dalService.startGame(this.gameId).subscribe()}leave(t){this.dalService.joinGame(this.gameId,t.id,null,"EMPTY_SEAT").subscribe()}set_ai(t){this.dalService.joinGame(this.gameId,t.id,null,"AI").subscribe()}join_game(t){this.dalService.joinGame(this.gameId,t.id,this.user,"HUMAN").subscribe()}setup(){this.dalService.setupGame(this.gameId,this.user.id).subscribe()}open(){this.router.navigate([Vs.GamePlay,this.gameId])}static#e=this.\u0275fac=function(i){return new(i||n)(ce(Ov),ce(Mr),ce(cC),ce(Hl),ce(jm),ce(PC))};static#t=this.\u0275cmp=Ji({type:n,selectors:[["app-game-setup"]],features:[Un([cC]),Hi],decls:1,vars:1,consts:[["style","overflow: auto;width: 100%;height: 100%;padding: 20px;",4,"ngIf"],[2,"overflow","auto","width","100%","height","100%","padding","20px"],[2,"font-size","20px"],[3,"json","depth"],[1,"mg-col"],[2,"margin-top","20px","font-size","20px"],["class","mg-row-center",4,"ngFor","ngForOf"],[1,"mg-row-center",2,"margin-top","20px"],["severity","secondary",3,"onClick"],["severity","warning",3,"onClick"],["severity","success",3,"onClick"],[1,"mg-row-center"],[2,"width","100px"],["severity","danger",3,"onClick"]],template:function(i,r){1&i&&_n(0,Xle,16,3,"div",0),2&i&&vt("ngIf",r.gameData)},dependencies:[nE,_y,KR,jle]})}return n})();const md=new iR,Bs=new L,Du=new L,ai=new Vn,FG={X:new L(1,0,0),Y:new L(0,1,0),Z:new L(0,0,1)},ZR={type:"change"},kG={type:"mouseDown"},UG={type:"mouseUp",mode:null},BG={type:"objectChange"};class Kle extends fi{constructor(e,t){super(),void 0===t&&(console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.'),t=document),this.isTransformControls=!0,this.visible=!1,this.domElement=t,this.domElement.style.touchAction="none";const i=new nce;this._gizmo=i,this.add(i);const r=new ice;this._plane=r,this.add(r);const s=this;function o(b,E){let C=E;Object.defineProperty(s,b,{get:function(){return void 0!==C?C:E},set:function(x){C!==x&&(C=x,r[b]=x,i[b]=x,s.dispatchEvent({type:b+"-changed",value:x}),s.dispatchEvent(ZR))}}),s[b]=E,r[b]=E,i[b]=E}o("camera",e),o("object",void 0),o("enabled",!0),o("axis",null),o("mode","translate"),o("translationSnap",null),o("rotationSnap",null),o("scaleSnap",null),o("space","world"),o("size",1),o("dragging",!1),o("showX",!0),o("showY",!0),o("showZ",!0);const a=new L,l=new L,c=new Vn,h=new Vn,d=new L,p=new Vn,m=new L,g=new L,v=new L,y=new L;o("worldPosition",a),o("worldPositionStart",l),o("worldQuaternion",c),o("worldQuaternionStart",h),o("cameraPosition",d),o("cameraQuaternion",p),o("pointStart",m),o("pointEnd",g),o("rotationAxis",v),o("rotationAngle",0),o("eye",y),this._offset=new L,this._startNorm=new L,this._endNorm=new L,this._cameraScale=new L,this._parentPosition=new L,this._parentQuaternion=new Vn,this._parentQuaternionInv=new Vn,this._parentScale=new L,this._worldScaleStart=new L,this._worldQuaternionInv=new Vn,this._worldScale=new L,this._positionStart=new L,this._quaternionStart=new Vn,this._scaleStart=new L,this._getPointer=Zle.bind(this),this._onPointerDown=Qle.bind(this),this._onPointerHover=Jle.bind(this),this._onPointerMove=ece.bind(this),this._onPointerUp=tce.bind(this),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointermove",this._onPointerHover),this.domElement.addEventListener("pointerup",this._onPointerUp)}updateMatrixWorld(){void 0!==this.object&&(this.object.updateMatrixWorld(),null===this.object.parent?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this._parentPosition,this._parentQuaternion,this._parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this._worldScale),this._parentQuaternionInv.copy(this._parentQuaternion).invert(),this._worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this._cameraScale),this.camera.isOrthographicCamera?this.camera.getWorldDirection(this.eye).negate():this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld(this)}pointerHover(e){if(void 0===this.object||!0===this.dragging)return;md.setFromCamera(e,this.camera);const t=JR(this._gizmo.picker[this.mode],md);this.axis=t?t.object.name:null}pointerDown(e){if(void 0!==this.object&&!0!==this.dragging&&0===e.button&&null!==this.axis){md.setFromCamera(e,this.camera);const t=JR(this._plane,md,!0);t&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(t.point).sub(this.worldPositionStart)),this.dragging=!0,kG.mode=this.mode,this.dispatchEvent(kG)}}pointerMove(e){const t=this.axis,i=this.mode,r=this.object;let s=this.space;if("scale"===i?s="local":("E"===t||"XYZE"===t||"XYZ"===t)&&(s="world"),void 0===r||null===t||!1===this.dragging||-1!==e.button)return;md.setFromCamera(e,this.camera);const o=JR(this._plane,md,!0);if(o){if(this.pointEnd.copy(o.point).sub(this.worldPositionStart),"translate"===i)this._offset.copy(this.pointEnd).sub(this.pointStart),"local"===s&&"XYZ"!==t&&this._offset.applyQuaternion(this._worldQuaternionInv),-1===t.indexOf("X")&&(this._offset.x=0),-1===t.indexOf("Y")&&(this._offset.y=0),-1===t.indexOf("Z")&&(this._offset.z=0),"local"===s&&"XYZ"!==t?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),r.position.copy(this._offset).add(this._positionStart),this.translationSnap&&("local"===s&&(r.position.applyQuaternion(ai.copy(this._quaternionStart).invert()),-1!==t.search("X")&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.position.applyQuaternion(this._quaternionStart)),"world"===s&&(r.parent&&r.position.add(Bs.setFromMatrixPosition(r.parent.matrixWorld)),-1!==t.search("X")&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.parent&&r.position.sub(Bs.setFromMatrixPosition(r.parent.matrixWorld))));else if("scale"===i){if(-1!==t.search("XYZ")){let a=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(a*=-1),Du.set(a,a,a)}else Bs.copy(this.pointStart),Du.copy(this.pointEnd),Bs.applyQuaternion(this._worldQuaternionInv),Du.applyQuaternion(this._worldQuaternionInv),Du.divide(Bs),-1===t.search("X")&&(Du.x=1),-1===t.search("Y")&&(Du.y=1),-1===t.search("Z")&&(Du.z=1);r.scale.copy(this._scaleStart).multiply(Du),this.scaleSnap&&(-1!==t.search("X")&&(r.scale.x=Math.round(r.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Y")&&(r.scale.y=Math.round(r.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Z")&&(r.scale.z=Math.round(r.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if("rotate"===i){this._offset.copy(this.pointEnd).sub(this.pointStart);const a=20/this.worldPosition.distanceTo(Bs.setFromMatrixPosition(this.camera.matrixWorld));"E"===t?(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this._endNorm.cross(this._startNorm).dot(this.eye)<0?1:-1):"XYZE"===t?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(Bs.copy(this.rotationAxis).cross(this.eye))*a):("X"===t||"Y"===t||"Z"===t)&&(this.rotationAxis.copy(FG[t]),Bs.copy(FG[t]),"local"===s&&Bs.applyQuaternion(this.worldQuaternion),this.rotationAngle=this._offset.dot(Bs.cross(this.eye).normalize())*a),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),"local"===s&&"E"!==t&&"XYZE"!==t?(r.quaternion.copy(this._quaternionStart),r.quaternion.multiply(ai.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),r.quaternion.copy(ai.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),r.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent(ZR),this.dispatchEvent(BG)}}pointerUp(e){0===e.button&&(this.dragging&&null!==this.axis&&(UG.mode=this.mode,this.dispatchEvent(UG)),this.dragging=!1,this.axis=null)}dispose(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.traverse(function(e){e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()})}attach(e){return this.object=e,this.visible=!0,this}detach(){return this.object=void 0,this.visible=!1,this.axis=null,this}reset(){this.enabled&&this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent(ZR),this.dispatchEvent(BG),this.pointStart.copy(this.pointEnd))}getRaycaster(){return md}getMode(){return this.mode}setMode(e){this.mode=e}setTranslationSnap(e){this.translationSnap=e}setRotationSnap(e){this.rotationSnap=e}setScaleSnap(e){this.scaleSnap=e}setSize(e){this.size=e}setSpace(e){this.space=e}}function Zle(n){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:n.button};{const e=this.domElement.getBoundingClientRect();return{x:(n.clientX-e.left)/e.width*2-1,y:-(n.clientY-e.top)/e.height*2+1,button:n.button}}}function Jle(n){if(this.enabled)switch(n.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(n))}}function Qle(n){this.enabled&&(document.pointerLockElement||this.domElement.setPointerCapture(n.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(n)),this.pointerDown(this._getPointer(n)))}function ece(n){this.enabled&&this.pointerMove(this._getPointer(n))}function tce(n){this.enabled&&(this.domElement.releasePointerCapture(n.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(n)))}function JR(n,e,t){const i=e.intersectObject(n,!0);for(let r=0;r<i.length;r++)if(i[r].object.visible||t)return i[r];return!1}const LC=new cV,Hn=new L(0,1,0),VG=new L(0,0,0),HG=new wt,OC=new Vn,FC=new Vn,nl=new L,zG=new wt,Bv=new L(1,0,0),gd=new L(0,1,0),Vv=new L(0,0,1),kC=new L,Hv=new L,zv=new L;class nce extends fi{constructor(){super(),this.isTransformControlsGizmo=!0,this.type="TransformControlsGizmo";const e=new bi({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),t=new gr({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),i=e.clone();i.opacity=.15;const r=t.clone();r.opacity=.5;const s=e.clone();s.color.setHex(16711680);const o=e.clone();o.color.setHex(65280);const a=e.clone();a.color.setHex(255);const l=e.clone();l.color.setHex(16711680),l.opacity=.5;const c=e.clone();c.color.setHex(65280),c.opacity=.5;const h=e.clone();h.color.setHex(255),h.opacity=.5;const d=e.clone();d.opacity=.25;const p=e.clone();p.color.setHex(16776960),p.opacity=.25,e.clone().color.setHex(16776960);const g=e.clone();g.color.setHex(7895160);const v=new or(0,.04,.1,12);v.translate(0,.05,0);const w=new oi(.08,.08,.08);w.translate(0,.04,0);const y=new Rt;y.setAttribute("position",new Ke([0,0,0,1,0,0],3));const b=new or(.0075,.0075,.5,3);function E(J,G){const X=new Eu(J,.0075,3,64,G*Math.PI*2);return X.rotateY(Math.PI/2),X.rotateX(Math.PI/2),X}b.translate(0,.25,0);const x={X:[[new Me(v,s),[.5,0,0],[0,0,-Math.PI/2]],[new Me(v,s),[-.5,0,0],[0,0,Math.PI/2]],[new Me(b,s),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new Me(v,o),[0,.5,0]],[new Me(v,o),[0,-.5,0],[Math.PI,0,0]],[new Me(b,o)]],Z:[[new Me(v,a),[0,0,.5],[Math.PI/2,0,0]],[new Me(v,a),[0,0,-.5],[-Math.PI/2,0,0]],[new Me(b,a),null,[Math.PI/2,0,0]]],XYZ:[[new Me(new bu(.1,0),d.clone()),[0,0,0]]],XY:[[new Me(new oi(.15,.15,.01),h.clone()),[.15,.15,0]]],YZ:[[new Me(new oi(.15,.15,.01),l.clone()),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new Me(new oi(.15,.15,.01),c.clone()),[.15,0,.15],[-Math.PI/2,0,0]]]},A={X:[[new Me(new or(.2,0,.6,4),i),[.3,0,0],[0,0,-Math.PI/2]],[new Me(new or(.2,0,.6,4),i),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new Me(new or(.2,0,.6,4),i),[0,.3,0]],[new Me(new or(.2,0,.6,4),i),[0,-.3,0],[0,0,Math.PI]]],Z:[[new Me(new or(.2,0,.6,4),i),[0,0,.3],[Math.PI/2,0,0]],[new Me(new or(.2,0,.6,4),i),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new Me(new bu(.2,0),i)]],XY:[[new Me(new oi(.2,.2,.01),i),[.15,.15,0]]],YZ:[[new Me(new oi(.2,.2,.01),i),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new Me(new oi(.2,.2,.01),i),[.15,0,.15],[-Math.PI/2,0,0]]]},D={START:[[new Me(new bu(.01,2),r),null,null,null,"helper"]],END:[[new Me(new bu(.01,2),r),null,null,null,"helper"]],DELTA:[[new $r(function C(){const J=new Rt;return J.setAttribute("position",new Ke([0,0,0,1,1,1],3)),J}(),r),null,null,null,"helper"]],X:[[new $r(y,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new $r(y,r.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new $r(y,r.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},O={XYZE:[[new Me(E(.5,1),g),null,[0,Math.PI/2,0]]],X:[[new Me(E(.5,.5),s)]],Y:[[new Me(E(.5,.5),o),null,[0,0,-Math.PI/2]]],Z:[[new Me(E(.5,.5),a),null,[0,Math.PI/2,0]]],E:[[new Me(E(.75,1),p),null,[0,Math.PI/2,0]]]},T={AXIS:[[new $r(y,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},R={XYZE:[[new Me(new Am(.25,10,8),i)]],X:[[new Me(new Eu(.5,.1,4,24),i),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new Me(new Eu(.5,.1,4,24),i),[0,0,0],[Math.PI/2,0,0]]],Z:[[new Me(new Eu(.5,.1,4,24),i),[0,0,0],[0,0,-Math.PI/2]]],E:[[new Me(new Eu(.75,.1,2,24),i)]]},$={X:[[new Me(w,s),[.5,0,0],[0,0,-Math.PI/2]],[new Me(b,s),[0,0,0],[0,0,-Math.PI/2]],[new Me(w,s),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new Me(w,o),[0,.5,0]],[new Me(b,o)],[new Me(w,o),[0,-.5,0],[0,0,Math.PI]]],Z:[[new Me(w,a),[0,0,.5],[Math.PI/2,0,0]],[new Me(b,a),[0,0,0],[Math.PI/2,0,0]],[new Me(w,a),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new Me(new oi(.15,.15,.01),h),[.15,.15,0]]],YZ:[[new Me(new oi(.15,.15,.01),l),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new Me(new oi(.15,.15,.01),c),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new Me(new oi(.1,.1,.1),d.clone())]]},ee={X:[[new Me(new or(.2,0,.6,4),i),[.3,0,0],[0,0,-Math.PI/2]],[new Me(new or(.2,0,.6,4),i),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new Me(new or(.2,0,.6,4),i),[0,.3,0]],[new Me(new or(.2,0,.6,4),i),[0,-.3,0],[0,0,Math.PI]]],Z:[[new Me(new or(.2,0,.6,4),i),[0,0,.3],[Math.PI/2,0,0]],[new Me(new or(.2,0,.6,4),i),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new Me(new oi(.2,.2,.01),i),[.15,.15,0]]],YZ:[[new Me(new oi(.2,.2,.01),i),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new Me(new oi(.2,.2,.01),i),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new Me(new oi(.2,.2,.2),i),[0,0,0]]]},se={X:[[new $r(y,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new $r(y,r.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new $r(y,r.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function V(J){const G=new fi;for(const X in J)for(let Q=J[X].length;Q--;){const Z=J[X][Q][0].clone(),le=J[X][Q][1],q=J[X][Q][2],oe=J[X][Q][3],Se=J[X][Q][4];Z.name=X,Z.tag=Se,le&&Z.position.set(le[0],le[1],le[2]),q&&Z.rotation.set(q[0],q[1],q[2]),oe&&Z.scale.set(oe[0],oe[1],oe[2]),Z.updateMatrix();const ve=Z.geometry.clone();ve.applyMatrix4(Z.matrix),Z.geometry=ve,Z.renderOrder=1/0,Z.position.set(0,0,0),Z.rotation.set(0,0,0),Z.scale.set(1,1,1),G.add(Z)}return G}this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=V(x)),this.add(this.gizmo.rotate=V(O)),this.add(this.gizmo.scale=V($)),this.add(this.picker.translate=V(A)),this.add(this.picker.rotate=V(R)),this.add(this.picker.scale=V(ee)),this.add(this.helper.translate=V(D)),this.add(this.helper.rotate=V(T)),this.add(this.helper.scale=V(se)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}updateMatrixWorld(e){const i="local"===("scale"===this.mode?"local":this.space)?this.worldQuaternion:FC;this.gizmo.translate.visible="translate"===this.mode,this.gizmo.rotate.visible="rotate"===this.mode,this.gizmo.scale.visible="scale"===this.mode,this.helper.translate.visible="translate"===this.mode,this.helper.rotate.visible="rotate"===this.mode,this.helper.scale.visible="scale"===this.mode;let r=[];r=r.concat(this.picker[this.mode].children),r=r.concat(this.gizmo[this.mode].children),r=r.concat(this.helper[this.mode].children);for(let s=0;s<r.length;s++){const o=r[s];let a;o.visible=!0,o.rotation.set(0,0,0),o.position.copy(this.worldPosition),a=this.camera.isOrthographicCamera?(this.camera.top-this.camera.bottom)/this.camera.zoom:this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),o.scale.set(1,1,1).multiplyScalar(a*this.size/4),"helper"!==o.tag?(o.quaternion.copy(i),"translate"===this.mode||"scale"===this.mode?("X"===o.name&&Math.abs(Hn.copy(Bv).applyQuaternion(i).dot(this.eye))>.99&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"Y"===o.name&&Math.abs(Hn.copy(gd).applyQuaternion(i).dot(this.eye))>.99&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"Z"===o.name&&Math.abs(Hn.copy(Vv).applyQuaternion(i).dot(this.eye))>.99&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"XY"===o.name&&Math.abs(Hn.copy(Vv).applyQuaternion(i).dot(this.eye))<.2&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"YZ"===o.name&&Math.abs(Hn.copy(Bv).applyQuaternion(i).dot(this.eye))<.2&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"XZ"===o.name&&Math.abs(Hn.copy(gd).applyQuaternion(i).dot(this.eye))<.2&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1)):"rotate"===this.mode&&(OC.copy(i),Hn.copy(this.eye).applyQuaternion(ai.copy(i).invert()),-1!==o.name.search("E")&&o.quaternion.setFromRotationMatrix(HG.lookAt(this.eye,VG,gd)),"X"===o.name&&(ai.setFromAxisAngle(Bv,Math.atan2(-Hn.y,Hn.z)),ai.multiplyQuaternions(OC,ai),o.quaternion.copy(ai)),"Y"===o.name&&(ai.setFromAxisAngle(gd,Math.atan2(Hn.x,Hn.z)),ai.multiplyQuaternions(OC,ai),o.quaternion.copy(ai)),"Z"===o.name&&(ai.setFromAxisAngle(Vv,Math.atan2(Hn.y,Hn.x)),ai.multiplyQuaternions(OC,ai),o.quaternion.copy(ai))),o.visible=o.visible&&(-1===o.name.indexOf("X")||this.showX),o.visible=o.visible&&(-1===o.name.indexOf("Y")||this.showY),o.visible=o.visible&&(-1===o.name.indexOf("Z")||this.showZ),o.visible=o.visible&&(-1===o.name.indexOf("E")||this.showX&&this.showY&&this.showZ),o.material._color=o.material._color||o.material.color.clone(),o.material._opacity=o.material._opacity||o.material.opacity,o.material.color.copy(o.material._color),o.material.opacity=o.material._opacity,this.enabled&&this.axis&&(o.name===this.axis||this.axis.split("").some(function(l){return o.name===l}))&&(o.material.color.setHex(16776960),o.material.opacity=1)):(o.visible=!1,"AXIS"===o.name?(o.visible=!!this.axis,"X"===this.axis&&(ai.setFromEuler(LC.set(0,0,0)),o.quaternion.copy(i).multiply(ai),Math.abs(Hn.copy(Bv).applyQuaternion(i).dot(this.eye))>.9&&(o.visible=!1)),"Y"===this.axis&&(ai.setFromEuler(LC.set(0,0,Math.PI/2)),o.quaternion.copy(i).multiply(ai),Math.abs(Hn.copy(gd).applyQuaternion(i).dot(this.eye))>.9&&(o.visible=!1)),"Z"===this.axis&&(ai.setFromEuler(LC.set(0,Math.PI/2,0)),o.quaternion.copy(i).multiply(ai),Math.abs(Hn.copy(Vv).applyQuaternion(i).dot(this.eye))>.9&&(o.visible=!1)),"XYZE"===this.axis&&(ai.setFromEuler(LC.set(0,Math.PI/2,0)),Hn.copy(this.rotationAxis),o.quaternion.setFromRotationMatrix(HG.lookAt(VG,Hn,gd)),o.quaternion.multiply(ai),o.visible=this.dragging),"E"===this.axis&&(o.visible=!1)):"START"===o.name?(o.position.copy(this.worldPositionStart),o.visible=this.dragging):"END"===o.name?(o.position.copy(this.worldPosition),o.visible=this.dragging):"DELTA"===o.name?(o.position.copy(this.worldPositionStart),o.quaternion.copy(this.worldQuaternionStart),Bs.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),Bs.applyQuaternion(this.worldQuaternionStart.clone().invert()),o.scale.copy(Bs),o.visible=this.dragging):(o.quaternion.copy(i),o.position.copy(this.dragging?this.worldPositionStart:this.worldPosition),this.axis&&(o.visible=-1!==this.axis.search(o.name))))}super.updateMatrixWorld(e)}}class ice extends Me{constructor(){super(new mm(1e5,1e5,2,2),new bi({visible:!1,wireframe:!0,side:2,transparent:!0,opacity:.1,toneMapped:!1})),this.isTransformControlsPlane=!0,this.type="TransformControlsPlane"}updateMatrixWorld(e){let t=this.space;switch(this.position.copy(this.worldPosition),"scale"===this.mode&&(t="local"),kC.copy(Bv).applyQuaternion("local"===t?this.worldQuaternion:FC),Hv.copy(gd).applyQuaternion("local"===t?this.worldQuaternion:FC),zv.copy(Vv).applyQuaternion("local"===t?this.worldQuaternion:FC),Hn.copy(Hv),this.mode){case"translate":case"scale":switch(this.axis){case"X":Hn.copy(this.eye).cross(kC),nl.copy(kC).cross(Hn);break;case"Y":Hn.copy(this.eye).cross(Hv),nl.copy(Hv).cross(Hn);break;case"Z":Hn.copy(this.eye).cross(zv),nl.copy(zv).cross(Hn);break;case"XY":nl.copy(zv);break;case"YZ":nl.copy(kC);break;case"XZ":Hn.copy(zv),nl.copy(Hv);break;case"XYZ":case"E":nl.set(0,0,0)}break;default:nl.set(0,0,0)}0===nl.length()?this.quaternion.copy(this.cameraQuaternion):(zG.lookAt(Bs.set(0,0,0),nl,Hn),this.quaternion.setFromRotationMatrix(zG)),super.updateMatrixWorld(e)}}let rce=(()=>{class n{ngAfterViewInit(){const t=new PS;t.add(new use(5));const i=new ir(75,window.innerWidth/window.innerHeight,.1,1e3);i.position.z=2;const r=new _I;r.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(r.domElement);const s=new oi,o=new OH({transparent:!0}),a=new Me(s,o);t.add(a);const l=new mz(i,r.domElement),c=new Kle(i,r.domElement);c.attach(a),c.setMode("rotate"),t.add(c),c.addEventListener("dragging-changed",function(g){l.enabled=!g.value}),window.addEventListener("keydown",function(g){switch(g.key){case"g":c.setMode("translate");break;case"r":c.setMode("rotate");break;case"s":c.setMode("scale")}});const h=(new Lre).load(["img/px_eso0932a.jpg","img/nx_eso0932a.jpg","img/py_eso0932a.jpg","img/ny_eso0932a.jpg","img/pz_eso0932a.jpg","img/nz_eso0932a.jpg"]);function m(){r.render(t,i)}t.background=h,window.addEventListener("resize",function d(){i.aspect=window.innerWidth/window.innerHeight,i.updateProjectionMatrix(),r.setSize(window.innerWidth,window.innerHeight),m()},!1),function p(){requestAnimationFrame(p),m()}()}ngOnChanges(t){}ngOnDestroy(){}ngOnInit(){}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=Ji({type:n,selectors:[["app-editor"]],features:[Hi],decls:0,vars:0,template:function(i,r){}})}return n})();var Vs=function(n){return n.Home="home",n.GamesList="games-list",n.GameSetup="game-setup",n.GamePlay="game-play",n.Editor="editor",n}(Vs||{});const sce=[{path:"",redirectTo:`/${Vs.Home}`,pathMatch:"full"},{path:Vs.Home,component:Fle},{path:Vs.Editor,component:rce,canActivate:[NC]},{path:Vs.GamesList,component:Ule,canActivate:[NC]},{path:`${Vs.GameSetup}/:id`,component:Yle,canActivate:[NC]},{path:`${Vs.GamePlay}/:id`,component:hle,canActivate:[NC]},{path:"**",redirectTo:`/${Vs.Home}`}];let oce=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=ki({type:n});static#n=this.\u0275inj=Ti({imports:[sB.forRoot(sce),sB]})}return n})(),ace=(()=>{class n{constructor(t,i,r){this.generalService=t,this.titleService=i,this.signalRService=r,this.appVersionAttr=Lv.appVersion,this.titleService.setTitle("MGx - v"+Lv.appVersion);let s=localStorage.getItem("user");try{s=JSON.parse(s),this.generalService.User=s,this.signalRService.startConnection(this.generalService.User.id)}catch{this.generalService.User=void 0}}static#e=this.\u0275fac=function(i){return new(i||n)(ce(jm),ce(a1),ce(Ov))};static#t=this.\u0275cmp=Ji({type:n,selectors:[["app-root"]],hostVars:1,hostBindings:function(i,r){2&i&&si("app-version",r.appVersionAttr)},decls:1,vars:0,template:function(i,r){1&i&&Br(0,"router-outlet")},dependencies:[mD]})}return n})(),GG=(()=>{class n extends LG{static \u0275fac=function(){let t;return function(r){return(t||(t=gi(n)))(r||n)}}();static \u0275cmp=Ji({type:n,selectors:[["CheckIcon"]],standalone:!0,features:[gn,ly],decls:2,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M4.86199 11.5948C4.78717 11.5923 4.71366 11.5745 4.64596 11.5426C4.57826 11.5107 4.51779 11.4652 4.46827 11.4091L0.753985 7.69483C0.683167 7.64891 0.623706 7.58751 0.580092 7.51525C0.536478 7.44299 0.509851 7.36177 0.502221 7.27771C0.49459 7.19366 0.506156 7.10897 0.536046 7.03004C0.565935 6.95111 0.613367 6.88 0.674759 6.82208C0.736151 6.76416 0.8099 6.72095 0.890436 6.69571C0.970973 6.67046 1.05619 6.66385 1.13966 6.67635C1.22313 6.68886 1.30266 6.72017 1.37226 6.76792C1.44186 6.81567 1.4997 6.8786 1.54141 6.95197L4.86199 10.2503L12.6397 2.49483C12.7444 2.42694 12.8689 2.39617 12.9932 2.40745C13.1174 2.41873 13.2343 2.47141 13.3251 2.55705C13.4159 2.64268 13.4753 2.75632 13.4938 2.87973C13.5123 3.00315 13.4888 3.1292 13.4271 3.23768L5.2557 11.4091C5.20618 11.4652 5.14571 11.5107 5.07801 11.5426C5.01031 11.5745 4.9368 11.5923 4.86199 11.5948Z","fill","currentColor"]],template:function(i,r){1&i&&(mf(),It(0,"svg",0),Br(1,"path",1),Mt()),2&i&&(Rl(r.getClassNames()),si("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role))},encapsulation:2})}return n})();const lce=["cb"];function cce(n,e){1&n&&Br(0,"span",10),2&n&&vt("ngClass",dn(3).checkboxIcon)}function uce(n,e){1&n&&Br(0,"CheckIcon",11),2&n&&vt("styleClass","p-checkbox-icon")}function hce(n,e){if(1&n&&(Zc(0),_n(1,cce,1,1,"span",8),_n(2,uce,1,1,"CheckIcon",9),Jc()),2&n){const t=dn(2);Lt(1),vt("ngIf",t.checkboxIcon),Lt(1),vt("ngIf",!t.checkboxIcon)}}function dce(n,e){}function fce(n,e){1&n&&_n(0,dce,0,0,"ng-template")}function pce(n,e){if(1&n&&(It(0,"span",12),_n(1,fce,1,0,null,13),Mt()),2&n){const t=dn(2);Lt(1),vt("ngTemplateOutlet",t.checkboxIconTemplate)}}function mce(n,e){if(1&n&&(Zc(0),_n(1,hce,3,2,"ng-container",5),_n(2,pce,2,1,"span",7),Jc()),2&n){const t=dn();Lt(1),vt("ngIf",!t.checkboxIconTemplate),Lt(1),vt("ngIf",t.checkboxIconTemplate)}}const gce=function(n,e,t){return{"p-checkbox-label":!0,"p-checkbox-label-active":n,"p-disabled":e,"p-checkbox-label-focus":t}};function _ce(n,e){if(1&n){const t=Ch();It(0,"label",14),yn("click",function(r){as(t);const s=dn(),o=kT(3);return Sr(s.onClick(r,o,!0))}),Tn(1),Mt()}if(2&n){const t=dn();Rl(t.labelStyleClass),vt("ngClass",Pb(5,gce,t.checked(),t.disabled,t.focused)),si("for",t.inputId),Lt(1),Pl(t.label)}}const yce=function(n,e,t){return{"p-checkbox p-component":!0,"p-checkbox-checked":n,"p-checkbox-disabled":e,"p-checkbox-focused":t}},vce=function(n,e,t){return{"p-highlight":n,"p-disabled":e,"p-focus":t}},wce={provide:ca,useExisting:pn(()=>bce),multi:!0};let bce=(()=>{class n{cd;value;name;disabled;binary;label;ariaLabelledBy;ariaLabel;tabindex;inputId;style;styleClass;labelStyleClass;formControl;checkboxIcon;readonly;required;trueValue=!0;falseValue=!1;onChange=new qn;inputViewChild;templates;checkboxIconTemplate;model;onModelChange=()=>{};onModelTouched=()=>{};focused=!1;constructor(t){this.cd=t}ngAfterContentInit(){this.templates.forEach(t=>{"icon"===t.getType()&&(this.checkboxIconTemplate=t.template)})}onClick(t,i,r){t.preventDefault(),!this.disabled&&!this.readonly&&(this.updateModel(t),r&&i.focus())}updateModel(t){let i;this.binary?(i=this.checked()?this.falseValue:this.trueValue,this.model=i,this.onModelChange(i)):(i=this.checked()?this.model.filter(r=>!Uv.equals(r,this.value)):this.model?[...this.model,this.value]:[this.value],this.onModelChange(i),this.model=i,this.formControl&&this.formControl.setValue(i)),this.onChange.emit({checked:i,originalEvent:t})}handleChange(t){this.readonly||this.updateModel(t)}onFocus(){this.focused=!0}onBlur(){this.focused=!1,this.onModelTouched()}focus(){this.inputViewChild?.nativeElement.focus()}writeValue(t){this.model=t,this.cd.markForCheck()}registerOnChange(t){this.onModelChange=t}registerOnTouched(t){this.onModelTouched=t}setDisabledState(t){this.disabled=t,this.cd.markForCheck()}checked(){return this.binary?this.model===this.trueValue:Uv.contains(this.value,this.model)}static \u0275fac=function(i){return new(i||n)(ce(fy))};static \u0275cmp=Ji({type:n,selectors:[["p-checkbox"]],contentQueries:function(i,r,s){if(1&i&&Ob(s,PG,4),2&i){let o;wp(o=bp())&&(r.templates=o)}},viewQuery:function(i,r){if(1&i&&uA(lce,5),2&i){let s;wp(s=bp())&&(r.inputViewChild=s.first)}},hostAttrs:[1,"p-element"],inputs:{value:"value",name:"name",disabled:"disabled",binary:"binary",label:"label",ariaLabelledBy:"ariaLabelledBy",ariaLabel:"ariaLabel",tabindex:"tabindex",inputId:"inputId",style:"style",styleClass:"styleClass",labelStyleClass:"labelStyleClass",formControl:"formControl",checkboxIcon:"checkboxIcon",readonly:"readonly",required:"required",trueValue:"trueValue",falseValue:"falseValue"},outputs:{onChange:"onChange"},features:[Un([wce])],decls:7,vars:26,consts:[[3,"ngStyle","ngClass"],[1,"p-hidden-accessible"],["type","checkbox",3,"readonly","value","checked","disabled","focus","blur","change"],["cb",""],[1,"p-checkbox-box",3,"ngClass","click"],[4,"ngIf"],[3,"class","ngClass","click",4,"ngIf"],["class","p-checkbox-icon",4,"ngIf"],["class","p-checkbox-icon",3,"ngClass",4,"ngIf"],[3,"styleClass",4,"ngIf"],[1,"p-checkbox-icon",3,"ngClass"],[3,"styleClass"],[1,"p-checkbox-icon"],[4,"ngTemplateOutlet"],[3,"ngClass","click"]],template:function(i,r){if(1&i){const s=Ch();It(0,"div",0)(1,"div",1)(2,"input",2,3),yn("focus",function(){return r.onFocus()})("blur",function(){return r.onBlur()})("change",function(a){return r.handleChange(a)}),Mt()(),It(4,"div",4),yn("click",function(a){as(s);const l=kT(3);return Sr(r.onClick(a,l,!0))}),_n(5,mce,3,2,"ng-container",5),Mt()(),_n(6,_ce,2,9,"label",6)}2&i&&(Rl(r.styleClass),vt("ngStyle",r.style)("ngClass",Pb(18,yce,r.checked(),r.disabled,r.focused)),Lt(2),vt("readonly",r.readonly)("value",r.value)("checked",r.checked())("disabled",r.disabled),si("id",r.inputId)("name",r.name)("tabindex",r.tabindex)("aria-labelledby",r.ariaLabelledBy)("aria-label",r.ariaLabel)("aria-checked",r.checked())("required",r.required),Lt(2),vt("ngClass",Pb(22,vce,r.checked(),r.disabled,r.focused)),Lt(1),vt("ngIf",r.checked()),Lt(1),vt("ngIf",r.label))},dependencies:function(){return[tE,_y,XA,qA,GG]},styles:["@layer primeng{.p-checkbox{display:inline-flex;cursor:pointer;-webkit-user-select:none;user-select:none;vertical-align:bottom;position:relative}.p-checkbox-disabled{cursor:default!important;pointer-events:none}.p-checkbox-box{display:flex;justify-content:center;align-items:center}p-checkbox{display:inline-flex;vertical-align:bottom;align-items:center}.p-checkbox-label{line-height:1}}\n"],encapsulation:2,changeDetection:0})}return n})(),Ece=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=ki({type:n});static \u0275inj=Ti({imports:[Mp,GG,YR]})}return n})(),Sce=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=ki({type:n,bootstrap:[ace]});static#n=this.\u0275inj=Ti({imports:[ok,wX,MY,oce,Ole,Ece,rle,$le]})}return n})();_7().bootstrapModule(Sce).catch(n=>console.error(n))},990:function(Hs,lc,vd){var fn;Hs=vd.nmd(Hs),function(){var B,Kr="Expected a function",wd="__lodash_hash_undefined__",sl="__lodash_placeholder__",Cn=1/0,Vo=9007199254740991,ho=4294967295,qv=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],zn="[object Arguments]",Jn="[object Array]",Jt="[object Boolean]",ol="[object Date]",dc="[object Error]",Cd="[object Function]",Xv="[object GeneratorFunction]",zs="[object Map]",xd="[object Number]",ya="[object Object]",$C="[object Promise]",fc="[object RegExp]",Gs="[object Set]",al="[object String]",Md="[object Symbol]",pc="[object WeakMap]",Pu="[object ArrayBuffer]",mc="[object DataView]",fo="[object Float32Array]",Td="[object Float64Array]",Jm="[object Int8Array]",Ad="[object Int16Array]",Qm="[object Int32Array]",eg="[object Uint8Array]",tg="[object Uint8ClampedArray]",ng="[object Uint16Array]",ig="[object Uint32Array]",YC=/\b__p \+= '';/g,KC=/\b(__p \+=) '' \+/g,ZC=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Yv=/&(?:amp|lt|gt|quot|#39);/g,Kv=/[&<>"']/g,rP=RegExp(Yv.source),Zv=RegExp(Kv.source),Jv=/<%-([\s\S]+?)%>/g,Qv=/<%([\s\S]+?)%>/g,rg=/<%=([\s\S]+?)%>/g,e0=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,JC=/^\w*$/,t0=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Dd=/[\\^$.*+?()[\]{}|]/g,n0=RegExp(Dd.source),Id=/^\s+/,Qr=/\s/,QC=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ex=/\{\n\/\* \[wrapped with (.+)\] \*/,tx=/,? & /,nx=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,r0=/[()=,{}\[\]\/\s]/,ix=/\\(\\)?/g,rx=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,po=/\w*$/,sx=/^[-+]0x[0-9a-f]+$/i,Zi=/^0b[01]+$/i,gc=/^\[object .+?Constructor\]$/,mo=/^0o[0-7]+$/i,sP=/^(?:0|[1-9]\d*)$/,ox=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Rd=/($^)/,sg=/['\n\r\u2028\u2029\\]/g,Nu="\\ud800-\\udfff",og="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",o0="\\u2700-\\u27bf",a0="a-z\\xdf-\\xf6\\xf8-\\xff",c0="A-Z\\xc0-\\xd6\\xd8-\\xde",mi="\\ufe0e\\ufe0f",u0="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",mt="["+Nu+"]",ag="["+u0+"]",_c="["+og+"]",Es="\\d+",hx="["+o0+"]",h0="["+a0+"]",un="[^"+Nu+u0+Es+o0+a0+c0+"]",yc="\\ud83c[\\udffb-\\udfff]",Pd="[^"+Nu+"]",lg="(?:\\ud83c[\\udde6-\\uddff]){2}",pn="[\\ud800-\\udbff][\\udc00-\\udfff]",lt="["+c0+"]",Ld="(?:"+h0+"|"+un+")",oP="(?:"+lt+"|"+un+")",cg="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",ae="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",Ou="(?:"+_c+"|"+yc+")?",Et="["+mi+"]?",d0=Et+Ou+"(?:\\u200d(?:"+[Pd,lg,pn].join("|")+")"+Et+Ou+")*",ug="(?:"+[hx,lg,pn].join("|")+")"+d0,es="(?:"+[Pd+_c+"?",_c,lg,pn,mt].join("|")+")",lP=RegExp("['\u2019]","g"),fx=RegExp(_c,"g"),f0=RegExp(yc+"(?="+yc+")|"+es+d0,"g"),ll=RegExp([lt+"?"+h0+"+"+cg+"(?="+[ag,lt,"$"].join("|")+")",oP+"+"+ae+"(?="+[ag,lt+Ld,"$"].join("|")+")",lt+"?"+Ld+"+"+cg,lt+"+"+ae,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Es,ug].join("|"),"g"),cP=RegExp("[\\u200d"+Nu+og+mi+"]"),uP=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,hP=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],dP=-1,Ln={};Ln[fo]=Ln[Td]=Ln[Jm]=Ln[Ad]=Ln[Qm]=Ln[eg]=Ln[tg]=Ln[ng]=Ln[ig]=!0,Ln[zn]=Ln[Jn]=Ln[Pu]=Ln[Jt]=Ln[mc]=Ln[ol]=Ln[dc]=Ln[Cd]=Ln[zs]=Ln[xd]=Ln[ya]=Ln[fc]=Ln[Gs]=Ln[al]=Ln[pc]=!1;var On={};On[zn]=On[Jn]=On[Pu]=On[mc]=On[Jt]=On[ol]=On[fo]=On[Td]=On[Jm]=On[Ad]=On[Qm]=On[zs]=On[xd]=On[ya]=On[fc]=On[Gs]=On[al]=On[Md]=On[eg]=On[tg]=On[ng]=On[ig]=!0,On[dc]=On[Cd]=On[pc]=!1;var gt={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},pP=parseFloat,mP=parseInt,mx="object"==typeof global&&global&&global.Object===Object&&global,Je="object"==typeof self&&self&&self.Object===Object&&self,ar=mx||Je||Function("return this")(),Ti=lc&&!lc.nodeType&&lc,va=Ti&&Hs&&!Hs.nodeType&&Hs,p0=va&&va.exports===Ti,Od=p0&&mx.process,Cs=function(){try{return va&&va.require&&va.require("util").types||Od&&Od.binding&&Od.binding("util")}catch{}}(),Fu=Cs&&Cs.isArrayBuffer,ku=Cs&&Cs.isDate,Fd=Cs&&Cs.isMap,hg=Cs&&Cs.isRegExp,m0=Cs&&Cs.isSet,$t=Cs&&Cs.isTypedArray;function vr(Y,ue,re){switch(re.length){case 0:return Y.call(ue);case 1:return Y.call(ue,re[0]);case 2:return Y.call(ue,re[0],re[1]);case 3:return Y.call(ue,re[0],re[1],re[2])}return Y.apply(ue,re)}function g0(Y,ue,re,Ue){for(var At=-1,cn=null==Y?0:Y.length;++At<cn;){var Ai=Y[At];ue(Ue,Ai,re(Ai),Y)}return Ue}function Fn(Y,ue){for(var re=-1,Ue=null==Y?0:Y.length;++re<Ue&&!1!==ue(Y[re],re,Y););return Y}function _0(Y,ue){for(var re=null==Y?0:Y.length;re--&&!1!==ue(Y[re],re,Y););return Y}function gx(Y,ue){for(var re=-1,Ue=null==Y?0:Y.length;++re<Ue;)if(!ue(Y[re],re,Y))return!1;return!0}function on(Y,ue){for(var re=-1,Ue=null==Y?0:Y.length,At=0,cn=[];++re<Ue;){var Ai=Y[re];ue(Ai,re,Y)&&(cn[At++]=Ai)}return cn}function dg(Y,ue){return!(null==Y||!Y.length)&&Uu(Y,ue,0)>-1}function y0(Y,ue,re){for(var Ue=-1,At=null==Y?0:Y.length;++Ue<At;)if(re(ue,Y[Ue]))return!0;return!1}function Dn(Y,ue){for(var re=-1,Ue=null==Y?0:Y.length,At=Array(Ue);++re<Ue;)At[re]=ue(Y[re],re,Y);return At}function go(Y,ue){for(var re=-1,Ue=ue.length,At=Y.length;++re<Ue;)Y[At+re]=ue[re];return Y}function kd(Y,ue,re,Ue){var At=-1,cn=null==Y?0:Y.length;for(Ue&&cn&&(re=Y[++At]);++At<cn;)re=ue(re,Y[At],At,Y);return re}function fg(Y,ue,re,Ue){var At=null==Y?0:Y.length;for(Ue&&At&&(re=Y[--At]);At--;)re=ue(re,Y[At],At,Y);return re}function pg(Y,ue){for(var re=-1,Ue=null==Y?0:Y.length;++re<Ue;)if(ue(Y[re],re,Y))return!0;return!1}var mg=_g("length");function _x(Y,ue,re){var Ue;return re(Y,function(At,cn,Ai){if(ue(At,cn,Ai))return Ue=cn,!1}),Ue}function gg(Y,ue,re,Ue){for(var At=Y.length,cn=re+(Ue?1:-1);Ue?cn--:++cn<At;)if(ue(Y[cn],cn,Y))return cn;return-1}function Uu(Y,ue,re){return ue==ue?function Go(Y,ue,re){for(var Ue=re-1,At=Y.length;++Ue<At;)if(Y[Ue]===ue)return Ue;return-1}(Y,ue,re):gg(Y,Ud,re)}function Bu(Y,ue,re,Ue){for(var At=re-1,cn=Y.length;++At<cn;)if(Ue(Y[At],ue))return At;return-1}function Ud(Y){return Y!=Y}function Vu(Y,ue){var re=null==Y?0:Y.length;return re?wa(Y,ue)/re:NaN}function _g(Y){return function(ue){return null==ue?B:ue[Y]}}function yg(Y){return function(ue){return null==Y?B:Y[ue]}}function v0(Y,ue,re,Ue,At){return At(Y,function(cn,Ai,xn){re=Ue?(Ue=!1,cn):ue(re,cn,Ai,xn)}),re}function wa(Y,ue){for(var re,Ue=-1,At=Y.length;++Ue<At;){var cn=ue(Y[Ue]);cn!==B&&(re=re===B?cn:re+cn)}return re}function vg(Y,ue){for(var re=-1,Ue=Array(Y);++re<Y;)Ue[re]=ue(re);return Ue}function b0(Y){return Y&&Y.slice(0,Hd(Y)+1).replace(Id,"")}function Oe(Y){return function(ue){return Y(ue)}}function Bd(Y,ue){return Dn(ue,function(re){return Y[re]})}function ze(Y,ue){return Y.has(ue)}function Hu(Y,ue){for(var re=-1,Ue=Y.length;++re<Ue&&Uu(ue,Y[re],0)>-1;);return re}function Vd(Y,ue){for(var re=Y.length;re--&&Uu(ue,Y[re],0)>-1;);return re}var yx=yg({\u00c0:"A",\u00c1:"A",\u00c2:"A",\u00c3:"A",\u00c4:"A",\u00c5:"A",\u00e0:"a",\u00e1:"a",\u00e2:"a",\u00e3:"a",\u00e4:"a",\u00e5:"a",\u00c7:"C",\u00e7:"c",\u00d0:"D",\u00f0:"d",\u00c8:"E",\u00c9:"E",\u00ca:"E",\u00cb:"E",\u00e8:"e",\u00e9:"e",\u00ea:"e",\u00eb:"e",\u00cc:"I",\u00cd:"I",\u00ce:"I",\u00cf:"I",\u00ec:"i",\u00ed:"i",\u00ee:"i",\u00ef:"i",\u00d1:"N",\u00f1:"n",\u00d2:"O",\u00d3:"O",\u00d4:"O",\u00d5:"O",\u00d6:"O",\u00d8:"O",\u00f2:"o",\u00f3:"o",\u00f4:"o",\u00f5:"o",\u00f6:"o",\u00f8:"o",\u00d9:"U",\u00da:"U",\u00db:"U",\u00dc:"U",\u00f9:"u",\u00fa:"u",\u00fb:"u",\u00fc:"u",\u00dd:"Y",\u00fd:"y",\u00ff:"y",\u00c6:"Ae",\u00e6:"ae",\u00de:"Th",\u00fe:"th",\u00df:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010a:"C",\u010c:"C",\u0107:"c",\u0109:"c",\u010b:"c",\u010d:"c",\u010e:"D",\u0110:"D",\u010f:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011a:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011b:"e",\u011c:"G",\u011e:"G",\u0120:"G",\u0122:"G",\u011d:"g",\u011f:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012a:"I",\u012c:"I",\u012e:"I",\u0130:"I",\u0129:"i",\u012b:"i",\u012d:"i",\u012f:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013b:"L",\u013d:"L",\u013f:"L",\u0141:"L",\u013a:"l",\u013c:"l",\u013e:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014a:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014b:"n",\u014c:"O",\u014e:"O",\u0150:"O",\u014d:"o",\u014f:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015a:"S",\u015c:"S",\u015e:"S",\u0160:"S",\u015b:"s",\u015d:"s",\u015f:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016a:"U",\u016c:"U",\u016e:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016b:"u",\u016d:"u",\u016f:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017b:"Z",\u017d:"Z",\u017a:"z",\u017c:"z",\u017e:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017f:"s"}),vx=yg({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function wx(Y){return"\\"+gt[Y]}function zo(Y){return cP.test(Y)}function nn(Y){var ue=-1,re=Array(Y.size);return Y.forEach(function(Ue,At){re[++ue]=[At,Ue]}),re}function Gu(Y,ue){return function(re){return Y(ue(re))}}function yo(Y,ue){for(var re=-1,Ue=Y.length,At=0,cn=[];++re<Ue;){var Ai=Y[re];(Ai===ue||Ai===sl)&&(Y[re]=sl,cn[At++]=re)}return cn}function vc(Y){var ue=-1,re=Array(Y.size);return Y.forEach(function(Ue){re[++ue]=Ue}),re}function cl(Y){return zo(Y)?function C0(Y){for(var ue=f0.lastIndex=0;f0.test(Y);)++ue;return ue}(Y):mg(Y)}function Ms(Y){return zo(Y)?function ju(Y){return Y.match(f0)||[]}(Y):function gP(Y){return Y.split("")}(Y)}function Hd(Y){for(var ue=Y.length;ue--&&Qr.test(Y.charAt(ue)););return ue}var S0=yg({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),zd=function Y(ue){var u,re=(ue=null==ue?ar:zd.defaults(ar.Object(),ue,zd.pick(ar,hP))).Array,Ue=ue.Date,At=ue.Error,cn=ue.Function,Ai=ue.Math,xn=ue.Object,wg=ue.RegExp,bx=ue.String,ts=ue.TypeError,Gd=re.prototype,wc=xn.prototype,Ji=ue["__core-js_shared__"],Wd=cn.prototype.toString,mn=wc.hasOwnProperty,Sx=0,ki=(u=/[^.]+$/.exec(Ji&&Ji.keys&&Ji.keys.IE_PROTO||""))?"Symbol(src)_1."+u:"",jd=wc.toString,T0=Wd.call(xn),pt=ar._,Nr=wg("^"+Wd.call(mn).replace(Dd,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Yt=p0?ue.Buffer:B,Gn=ue.Symbol,Ui=ue.Uint8Array,ul=Yt?Yt.allocUnsafe:B,lr=Gu(xn.getPrototypeOf,xn),bg=xn.create,Eg=wc.propertyIsEnumerable,hl=Gd.splice,A0=Gn?Gn.isConcatSpreadable:B,$u=Gn?Gn.iterator:B,bn=Gn?Gn.toStringTag:B,Ve=function(){try{var u=Xs(xn,"defineProperty");return u({},"",{}),u}catch{}}(),Nt=ue.clearTimeout!==ar.clearTimeout&&ue.clearTimeout,Wn=Ue&&Ue.now!==ar.Date.now&&Ue.now,Ws=ue.setTimeout!==ar.setTimeout&&ue.setTimeout,Ea=Ai.ceil,Di=Ai.floor,Sa=xn.getOwnPropertySymbols,ci=Yt?Yt.isBuffer:B,Wo=ue.isFinite,bc=Gd.join,xt=Gu(xn.keys,xn),Qn=Ai.max,Qi=Ai.min,Ec=Ue.now,ui=ue.parseInt,Sc=Ai.random,Cc=Gd.reverse,Ts=Xs(ue,"DataView"),jo=Xs(ue,"Map"),$d=Xs(ue,"Promise"),ns=Xs(ue,"Set"),is=Xs(ue,"WeakMap"),$o=Xs(xn,"create"),Ca=is&&new is,kt={},yP=Oa(Ts),Sg=Oa(jo),D0=Oa($d),vo=Oa(ns),qd=Oa(is),qo=Gn?Gn.prototype:B,Xo=qo?qo.valueOf:B,Bi=qo?qo.toString:B;function I(u){if(ti(u)&&!Dt(u)&&!(u instanceof Ut)){if(u instanceof Lr)return u;if(mn.call(u,"__wrapped__"))return El(u)}return new Lr(u)}var Ii=function(){function u(){}return function(f){if(!$n(f))return{};if(bg)return bg(f);u.prototype=f;var _=new u;return u.prototype=B,_}}();function Vi(){}function Lr(u,f){this.__wrapped__=u,this.__actions__=[],this.__chain__=!!f,this.__index__=0,this.__values__=B}function Ut(u){this.__wrapped__=u,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ho,this.__views__=[]}function dl(u){var f=-1,_=null==u?0:u.length;for(this.clear();++f<_;){var S=u[f];this.set(S[0],S[1])}}function xa(u){var f=-1,_=null==u?0:u.length;for(this.clear();++f<_;){var S=u[f];this.set(S[0],S[1])}}function Ma(u){var f=-1,_=null==u?0:u.length;for(this.clear();++f<_;){var S=u[f];this.set(S[0],S[1])}}function Ta(u){var f=-1,_=null==u?0:u.length;for(this.__data__=new Ma;++f<_;)this.add(u[f])}function wo(u){var f=this.__data__=new xa(u);this.size=f.size}function qu(u,f){var _=Dt(u),S=!_&&Sl(u),M=!_&&!S&&ka(u),N=!_&&!S&&!M&&Wc(u),U=_||S||M||N,j=U?vg(u.length,bx):[],K=j.length;for(var pe in u)(f||mn.call(u,pe))&&(!U||!("length"==pe||M&&("offset"==pe||"parent"==pe)||N&&("buffer"==pe||"byteLength"==pe||"byteOffset"==pe)||Co(pe,K)))&&j.push(pe);return j}function rs(u){var f=u.length;return f?u[cf(0,f-1)]:B}function R0(u,f){return Qo(ur(u),Da(f,0,u.length))}function P0(u){return Qo(ur(u))}function Yd(u,f,_){(_!==B&&!Ks(u[f],_)||_===B&&!(f in u))&&bo(u,f,_)}function xc(u,f,_){var S=u[f];(!mn.call(u,f)||!Ks(S,_)||_===B&&!(f in u))&&bo(u,f,_)}function Mc(u,f){for(var _=u.length;_--;)if(Ks(u[_][0],f))return _;return-1}function N0(u,f,_,S){return ml(u,function(M,N,U){f(S,M,_(M),U)}),S}function Kd(u,f){return u&&qs(f,Wi(f),u)}function bo(u,f,_){"__proto__"==f&&Ve?Ve(u,f,{configurable:!0,enumerable:!0,value:_,writable:!0}):u[f]=_}function Zd(u,f){for(var _=-1,S=f.length,M=re(S),N=null==u;++_<S;)M[_]=N?B:$w(u,f[_]);return M}function Da(u,f,_){return u==u&&(_!==B&&(u=u<=_?u:_),f!==B&&(u=u>=f?u:f)),u}function wr(u,f,_,S,M,N){var U,j=1&f,K=2&f,pe=4&f;if(_&&(U=M?_(u,S,M,N):_(u)),U!==B)return U;if(!$n(u))return u;var me=Dt(u);if(me){if(U=function zx(u){var f=u.length,_=new u.constructor(f);return f&&"string"==typeof u[0]&&mn.call(u,"index")&&(_.index=u.index,_.input=u.input),_}(u),!j)return ur(u,U)}else{var be=Pi(u),He=be==Cd||be==Xv;if(ka(u))return cr(u,j);if(be==ya||be==zn||He&&!M){if(U=K||He?{}:Ys(u),!j)return K?function Bx(u,f){return qs(u,bf(u),f)}(u,function xg(u,f){return u&&qs(f,fr(f),u)}(U,u)):function Fg(u,f){return qs(u,yl(u),f)}(u,Kd(U,u))}else{if(!On[be])return M?u:{};U=function Gx(u,f,_){var S=u.constructor;switch(f){case Pu:return $s(u);case Jt:case ol:return new S(+u);case mc:return function Y0(u,f){var _=f?$s(u.buffer):u.buffer;return new u.constructor(_,u.byteOffset,u.byteLength)}(u,_);case fo:case Td:case Jm:case Ad:case Qm:case eg:case tg:case ng:case ig:return K0(u,_);case zs:return new S;case xd:case al:return new S(u);case fc:return function Ic(u){var f=new u.constructor(u.source,po.exec(u));return f.lastIndex=u.lastIndex,f}(u);case Gs:return new S;case Md:return function Ko(u){return Xo?xn(Xo.call(u)):{}}(u)}}(u,be,j)}}N||(N=new wo);var tt=N.get(u);if(tt)return tt;N.set(u,U),w_(u)?u.forEach(function(ht){U.add(wr(ht,f,_,ht,u,N))}):zf(u)&&u.forEach(function(ht,Ht){U.set(Ht,wr(ht,f,_,Ht,u,N))});var Wt=me?B:(pe?K?rh:nw:K?fr:Wi)(u);return Fn(Wt||u,function(ht,Ht){Wt&&(ht=u[Ht=ht]),xc(U,Ht,wr(ht,f,_,Ht,u,N))}),U}function pl(u,f,_){var S=_.length;if(null==u)return!S;for(u=xn(u);S--;){var M=_[S],U=u[M];if(U===B&&!(M in u)||!(0,f[M])(U))return!1}return!0}function Mg(u,f,_){if("function"!=typeof u)throw new ts(Kr);return wl(function(){u.apply(B,_)},f)}function Jd(u,f,_,S){var M=-1,N=dg,U=!0,j=u.length,K=[],pe=f.length;if(!j)return K;_&&(f=Dn(f,Oe(_))),S?(N=y0,U=!1):f.length>=200&&(N=ze,U=!1,f=new Ta(f));e:for(;++M<j;){var me=u[M],be=null==_?me:_(me);if(me=S||0!==me?me:0,U&&be==be){for(var He=pe;He--;)if(f[He]===be)continue e;K.push(me)}else N(f,be,S)||K.push(me)}return K}I.templateSettings={escape:Jv,evaluate:Qv,interpolate:rg,variable:"",imports:{_:I}},(I.prototype=Vi.prototype).constructor=I,(Lr.prototype=Ii(Vi.prototype)).constructor=Lr,(Ut.prototype=Ii(Vi.prototype)).constructor=Ut,dl.prototype.clear=function Cx(){this.__data__=$o?$o(null):{},this.size=0},dl.prototype.delete=function vP(u){var f=this.has(u)&&delete this.__data__[u];return this.size-=f?1:0,f},dl.prototype.get=function xx(u){var f=this.__data__;if($o){var _=f[u];return _===wd?B:_}return mn.call(f,u)?f[u]:B},dl.prototype.has=function Mx(u){var f=this.__data__;return $o?f[u]!==B:mn.call(f,u)},dl.prototype.set=function wP(u,f){var _=this.__data__;return this.size+=this.has(u)?0:1,_[u]=$o&&f===B?wd:f,this},xa.prototype.clear=function bP(){this.__data__=[],this.size=0},xa.prototype.delete=function EP(u){var f=this.__data__,_=Mc(f,u);return!(_<0||(_==f.length-1?f.pop():hl.call(f,_,1),--this.size,0))},xa.prototype.get=function SP(u){var f=this.__data__,_=Mc(f,u);return _<0?B:f[_][1]},xa.prototype.has=function CP(u){return Mc(this.__data__,u)>-1},xa.prototype.set=function xP(u,f){var _=this.__data__,S=Mc(_,u);return S<0?(++this.size,_.push([u,f])):_[S][1]=f,this},Ma.prototype.clear=function MP(){this.size=0,this.__data__={hash:new dl,map:new(jo||xa),string:new dl}},Ma.prototype.delete=function TP(u){var f=Wg(this,u).delete(u);return this.size-=f?1:0,f},Ma.prototype.get=function AP(u){return Wg(this,u).get(u)},Ma.prototype.has=function DP(u){return Wg(this,u).has(u)},Ma.prototype.set=function I0(u,f){var _=Wg(this,u),S=_.size;return _.set(u,f),this.size+=_.size==S?0:1,this},Ta.prototype.add=Ta.prototype.push=function IP(u){return this.__data__.set(u,wd),this},Ta.prototype.has=function RP(u){return this.__data__.has(u)},wo.prototype.clear=function fl(){this.__data__=new xa,this.size=0},wo.prototype.delete=function Aa(u){var f=this.__data__,_=f.delete(u);return this.size=f.size,_},wo.prototype.get=function PP(u){return this.__data__.get(u)},wo.prototype.has=function NP(u){return this.__data__.has(u)},wo.prototype.set=function er(u,f){var _=this.__data__;if(_ instanceof xa){var S=_.__data__;if(!jo||S.length<199)return S.push([u,f]),this.size=++_.size,this;_=this.__data__=new Ma(S)}return _.set(u,f),this.size=_.size,this};var ml=kg(Yo),Tx=kg(L0,!0);function Ax(u,f){var _=!0;return ml(u,function(S,M,N){return _=!!f(S,M,N)}),_}function Qd(u,f,_){for(var S=-1,M=u.length;++S<M;){var N=u[S],U=f(N);if(null!=U&&(j===B?U==U&&!ls(U):_(U,j)))var j=U,K=N}return K}function Tg(u,f){var _=[];return ml(u,function(S,M,N){f(S,M,N)&&_.push(S)}),_}function Ri(u,f,_,S,M){var N=-1,U=u.length;for(_||(_=$g),M||(M=[]);++N<U;){var j=u[N];f>0&&_(j)?f>1?Ri(j,f-1,_,S,M):go(M,j):S||(M[M.length]=j)}return M}var Ag=Ug(),ef=Ug(!0);function Yo(u,f){return u&&Ag(u,f,Wi)}function L0(u,f){return u&&ef(u,f,Wi)}function tf(u,f){return on(f,function(_){return Rs(u[_])})}function Ia(u,f){for(var _=0,S=(f=So(f,u)).length;null!=u&&_<S;)u=u[xr(f[_++])];return _&&_==S?u:B}function Dg(u,f,_){var S=f(u);return Dt(u)?S:go(S,_(u))}function br(u){return null==u?u===B?"[object Undefined]":"[object Null]":bn&&bn in xn(u)?function Hx(u){var f=mn.call(u,bn),_=u[bn];try{u[bn]=B;var S=!0}catch{}var M=jd.call(u);return S&&(f?u[bn]=_:delete u[bn]),M}(u):function cw(u){return jd.call(u)}(u)}function Ig(u,f){return u>f}function Dx(u,f){return null!=u&&mn.call(u,f)}function O0(u,f){return null!=u&&f in xn(u)}function nf(u,f,_){for(var S=_?y0:dg,M=u[0].length,N=u.length,U=N,j=re(N),K=1/0,pe=[];U--;){var me=u[U];U&&f&&(me=Dn(me,Oe(f))),K=Qi(me.length,K),j[U]=!_&&(f||M>=120&&me.length>=120)?new Ta(U&&me):B}me=u[0];var be=-1,He=j[0];e:for(;++be<M&&pe.length<K;){var tt=me[be],ct=f?f(tt):tt;if(tt=_||0!==tt?tt:0,!(He?ze(He,ct):S(pe,ct,_))){for(U=N;--U;){var Wt=j[U];if(!(Wt?ze(Wt,ct):S(u[U],ct,_)))continue e}He&&He.push(ct),pe.push(tt)}}return pe}function rf(u,f,_){var S=null==(u=uw(u,f=So(f,u)))?u:u[xr(jn(f))];return null==S?B:vr(S,u,_)}function F0(u){return ti(u)&&br(u)==zn}function Yu(u,f,_,S,M){return u===f||(null==u||null==f||!ti(u)&&!ti(f)?u!=u&&f!=f:function Px(u,f,_,S,M,N){var U=Dt(u),j=Dt(f),K=U?Jn:Pi(u),pe=j?Jn:Pi(f),me=(K=K==zn?ya:K)==ya,be=(pe=pe==zn?ya:pe)==ya,He=K==pe;if(He&&ka(u)){if(!ka(f))return!1;U=!0,me=!1}if(He&&!me)return N||(N=new wo),U||Wc(u)?tw(u,f,_,S,M,N):function Rc(u,f,_,S,M,N,U){switch(_){case mc:if(u.byteLength!=f.byteLength||u.byteOffset!=f.byteOffset)return!1;u=u.buffer,f=f.buffer;case Pu:return!(u.byteLength!=f.byteLength||!N(new Ui(u),new Ui(f)));case Jt:case ol:case xd:return Ks(+u,+f);case dc:return u.name==f.name&&u.message==f.message;case fc:case al:return u==f+"";case zs:var j=nn;case Gs:if(j||(j=vc),u.size!=f.size&&!(1&S))return!1;var pe=U.get(u);if(pe)return pe==f;S|=2,U.set(u,f);var me=tw(j(u),j(f),S,M,N,U);return U.delete(u),me;case Md:if(Xo)return Xo.call(u)==Xo.call(f)}return!1}(u,f,K,_,S,M,N);if(!(1&_)){var tt=me&&mn.call(u,"__wrapped__"),ct=be&&mn.call(f,"__wrapped__");if(tt||ct){var Wt=tt?u.value():u,ht=ct?f.value():f;return N||(N=new wo),M(Wt,ht,_,S,N)}}return!!He&&(N||(N=new wo),function ih(u,f,_,S,M,N){var U=1&_,j=nw(u),K=j.length;if(K!=nw(f).length&&!U)return!1;for(var be=K;be--;){var He=j[be];if(!(U?He in f:mn.call(f,He)))return!1}var tt=N.get(u),ct=N.get(f);if(tt&&ct)return tt==f&&ct==u;var Wt=!0;N.set(u,f),N.set(f,u);for(var ht=U;++be<K;){var Ht=u[He=j[be]],Qt=f[He];if(S)var ji=U?S(Qt,Ht,He,f,u,N):S(Ht,Qt,He,u,f,N);if(!(ji===B?Ht===Qt||M(Ht,Qt,_,S,N):ji)){Wt=!1;break}ht||(ht="constructor"==He)}if(Wt&&!ht){var En=u.constructor,us=f.constructor;En!=us&&"constructor"in u&&"constructor"in f&&!("function"==typeof En&&En instanceof En&&"function"==typeof us&&us instanceof us)&&(Wt=!1)}return N.delete(u),N.delete(f),Wt}(u,f,_,S,M,N))}(u,f,_,S,Yu,M))}function sf(u,f,_,S){var M=_.length,N=M,U=!S;if(null==u)return!N;for(u=xn(u);M--;){var j=_[M];if(U&&j[2]?j[1]!==u[j[0]]:!(j[0]in u))return!1}for(;++M<N;){var K=(j=_[M])[0],pe=u[K],me=j[1];if(U&&j[2]){if(pe===B&&!(K in u))return!1}else{var be=new wo;if(S)var He=S(pe,me,K,u,f,be);if(!(He===B?Yu(me,pe,3,S,be):He))return!1}}return!0}function B0(u){return!(!$n(u)||function sw(u){return!!ki&&ki in u}(u))&&(Rs(u)?Nr:gc).test(Oa(u))}function Pg(u){return"function"==typeof u?u:null==u?pr:"object"==typeof u?Dt(u)?V0(u[0],u[1]):Er(u):oT(u)}function af(u){if(!Nc(u))return xt(u);var f=[];for(var _ in xn(u))mn.call(u,_)&&"constructor"!=_&&f.push(_);return f}function Ku(u,f){return u<f}function Zu(u,f){var _=-1,S=dr(u)?re(u.length):[];return ml(u,function(M,N,U){S[++_]=f(M,N,U)}),S}function Er(u){var f=sh(u);return 1==f.length&&f[0][2]?ah(f[0][0],f[0][1]):function(_){return _===u||sf(_,u,f)}}function V0(u,f){return oh(u)&&aw(f)?ah(xr(u),f):function(_){var S=$w(_,u);return S===B&&S===f?qf(_,u):Yu(f,S,3)}}function Ju(u,f,_,S,M){u!==f&&Ag(f,function(N,U){if(M||(M=new wo),$n(N))!function Tc(u,f,_,S,M,N,U){var j=qg(u,_),K=qg(f,_),pe=U.get(K);if(pe)Yd(u,_,pe);else{var me=N?N(j,K,_+"",u,f,U):B,be=me===B;if(be){var He=Dt(K),tt=!He&&ka(K),ct=!He&&!tt&&Wc(K);me=K,He||tt||ct?Dt(j)?me=j:ei(j)?me=ur(j):tt?(be=!1,me=cr(K,!0)):ct?(be=!1,me=K0(K,!0)):me=[]:xl(K)||Sl(K)?(me=j,Sl(j)?me=Gw(j):(!$n(j)||Rs(j))&&(me=Ys(K))):be=!1}be&&(U.set(K,me),M(me,K,S,N,U),U.delete(K)),Yd(u,_,me)}}(u,f,U,_,Ju,S,M);else{var j=S?S(qg(u,U),N,U+"",u,f,M):B;j===B&&(j=N),Yd(u,U,j)}},fr)}function Or(u,f){var _=u.length;if(_)return Co(f+=f<0?_:0,_)?u[f]:B}function H0(u,f,_){f=f.length?Dn(f,function(N){return Dt(N)?function(U){return Ia(U,1===N.length?N[0]:N)}:N}):[pr];var S=-1;return f=Dn(f,Oe(ut())),function w0(Y,ue){var re=Y.length;for(Y.sort(ue);re--;)Y[re]=Y[re].value;return Y}(Zu(u,function(N,U,j){return{criteria:Dn(f,function(pe){return pe(N)}),index:++S,value:N}}),function(N,U){return function Ux(u,f,_){for(var S=-1,M=u.criteria,N=f.criteria,U=M.length,j=_.length;++S<U;){var K=Og(M[S],N[S]);if(K)return S>=j?K:K*("desc"==_[S]?-1:1)}return u.index-f.index}(N,U,_)})}function z0(u,f,_){for(var S=-1,M=f.length,N={};++S<M;){var U=f[S],j=Ia(u,U);_(j,U)&&hf(N,So(U,u),j)}return N}function lf(u,f,_,S){var M=S?Bu:Uu,N=-1,U=f.length,j=u;for(u===f&&(f=ur(f)),_&&(j=Dn(u,Oe(_)));++N<U;)for(var K=0,pe=f[N],me=_?_(pe):pe;(K=M(j,me,K,S))>-1;)j!==u&&hl.call(j,K,1),hl.call(u,K,1);return u}function G0(u,f){for(var _=u?f.length:0,S=_-1;_--;){var M=f[_];if(_==S||M!==N){var N=M;Co(M)?hl.call(u,M,1):Zt(u,M)}}return u}function cf(u,f){return u+Di(Sc()*(f-u+1))}function uf(u,f){var _="";if(!u||f<1||f>Vo)return _;do{f%2&&(_+=u),(f=Di(f/2))&&(u+=u)}while(f);return _}function Gt(u,f){return Xg(Lc(u,f,pr),u+"")}function _t(u){return rs(Tl(u))}function j0(u,f){var _=Tl(u);return Qo(_,Da(f,0,_.length))}function hf(u,f,_,S){if(!$n(u))return u;for(var M=-1,N=(f=So(f,u)).length,U=N-1,j=u;null!=j&&++M<N;){var K=xr(f[M]),pe=_;if("__proto__"===K||"constructor"===K||"prototype"===K)return u;if(M!=U){var me=j[K];(pe=S?S(me,K,j):B)===B&&(pe=$n(me)?me:Co(f[M+1])?[]:{})}xc(j,K,pe),j=j[K]}return u}var $0=Ca?function(u,f){return Ca.set(u,f),u}:pr,Ox=Ve?function(u,f){return Ve(u,"toString",{configurable:!0,enumerable:!1,value:vh(f),writable:!0})}:pr;function Fx(u){return Qo(Tl(u))}function ss(u,f,_){var S=-1,M=u.length;f<0&&(f=-f>M?0:M+f),(_=_>M?M:_)<0&&(_+=M),M=f>_?0:_-f>>>0,f>>>=0;for(var N=re(M);++S<M;)N[S]=u[S+f];return N}function Ac(u,f){var _;return ml(u,function(S,M,N){return!(_=f(S,M,N))}),!!_}function df(u,f,_){var S=0,M=null==u?S:u.length;if("number"==typeof f&&f==f&&M<=2147483647){for(;S<M;){var N=S+M>>>1,U=u[N];null!==U&&!ls(U)&&(_?U<=f:U<f)?S=N+1:M=N}return M}return Ng(u,f,pr,_)}function Ng(u,f,_,S){var M=0,N=null==u?0:u.length;if(0===N)return 0;for(var U=(f=_(f))!=f,j=null===f,K=ls(f),pe=f===B;M<N;){var me=Di((M+N)/2),be=_(u[me]),He=be!==B,tt=null===be,ct=be==be,Wt=ls(be);if(U)var ht=S||ct;else ht=pe?ct&&(S||He):j?ct&&He&&(S||!tt):K?ct&&He&&!tt&&(S||!Wt):!tt&&!Wt&&(S?be<=f:be<f);ht?M=me+1:N=me}return Qi(N,4294967294)}function q0(u,f){for(var _=-1,S=u.length,M=0,N=[];++_<S;){var U=u[_],j=f?f(U):U;if(!_||!Ks(j,K)){var K=j;N[M++]=0===U?0:U}}return N}function X0(u){return"number"==typeof u?u:ls(u)?NaN:+u}function os(u){if("string"==typeof u)return u;if(Dt(u))return Dn(u,os)+"";if(ls(u))return Bi?Bi.call(u):"";var f=u+"";return"0"==f&&1/u==-Cn?"-0":f}function ge(u,f,_){var S=-1,M=dg,N=u.length,U=!0,j=[],K=j;if(_)U=!1,M=y0;else if(N>=200){var pe=f?null:yf(u);if(pe)return vc(pe);U=!1,M=ze,K=new Ta}else K=f?[]:j;e:for(;++S<N;){var me=u[S],be=f?f(me):me;if(me=_||0!==me?me:0,U&&be==be){for(var He=K.length;He--;)if(K[He]===be)continue e;f&&K.push(be),j.push(me)}else M(K,be,_)||(K!==j&&K.push(be),j.push(me))}return j}function Zt(u,f){return null==(u=uw(u,f=So(f,u)))||delete u[xr(jn(f))]}function as(u,f,_,S){return hf(u,f,_(Ia(u,f)),S)}function Sr(u,f,_,S){for(var M=u.length,N=S?M:-1;(S?N--:++N<M)&&f(u[N],N,u););return _?ss(u,S?0:N,S?N+1:M):ss(u,S?N+1:0,S?M:N)}function zi(u,f){var _=u;return _ instanceof Ut&&(_=_.value()),kd(f,function(S,M){return M.func.apply(M.thisArg,go([S],M.args))},_)}function ff(u,f,_){var S=u.length;if(S<2)return S?ge(u[0]):[];for(var M=-1,N=re(S);++M<S;)for(var U=u[M],j=-1;++j<S;)j!=M&&(N[M]=Jd(N[M]||U,u[j],f,_));return ge(Ri(N,1),f,_)}function Dc(u,f,_){for(var S=-1,M=u.length,N=f.length,U={};++S<M;)_(U,u[S],S<N?f[S]:B);return U}function As(u){return ei(u)?u:[]}function Qu(u){return"function"==typeof u?u:pr}function So(u,f){return Dt(u)?u:oh(u,f)?[u]:bl(an(u))}var kx=Gt;function gl(u,f,_){var S=u.length;return _=_===B?S:_,!f&&_>=S?u:ss(u,f,_)}var Lg=Nt||function(u){return ar.clearTimeout(u)};function cr(u,f){if(f)return u.slice();var _=u.length,S=ul?ul(_):new u.constructor(_);return u.copy(S),S}function $s(u){var f=new u.constructor(u.byteLength);return new Ui(f).set(new Ui(u)),f}function K0(u,f){var _=f?$s(u.buffer):u.buffer;return new u.constructor(_,u.byteOffset,u.length)}function Og(u,f){if(u!==f){var _=u!==B,S=null===u,M=u==u,N=ls(u),U=f!==B,j=null===f,K=f==f,pe=ls(f);if(!j&&!pe&&!N&&u>f||N&&U&&K&&!j&&!pe||S&&U&&K||!_&&K||!M)return 1;if(!S&&!N&&!pe&&u<f||pe&&_&&M&&!S&&!N||j&&_&&M||!U&&M||!K)return-1}return 0}function Z0(u,f,_,S){for(var M=-1,N=u.length,U=_.length,j=-1,K=f.length,pe=Qn(N-U,0),me=re(K+pe),be=!S;++j<K;)me[j]=f[j];for(;++M<U;)(be||M<N)&&(me[_[M]]=u[M]);for(;pe--;)me[j++]=u[M++];return me}function pf(u,f,_,S){for(var M=-1,N=u.length,U=-1,j=_.length,K=-1,pe=f.length,me=Qn(N-j,0),be=re(me+pe),He=!S;++M<me;)be[M]=u[M];for(var tt=M;++K<pe;)be[tt+K]=f[K];for(;++U<j;)(He||M<N)&&(be[tt+_[U]]=u[M++]);return be}function ur(u,f){var _=-1,S=u.length;for(f||(f=re(S));++_<S;)f[_]=u[_];return f}function qs(u,f,_,S){var M=!_;_||(_={});for(var N=-1,U=f.length;++N<U;){var j=f[N],K=S?S(_[j],u[j],j,_,u):B;K===B&&(K=u[j]),M?bo(_,j,K):xc(_,j,K)}return _}function eh(u,f){return function(_,S){var M=Dt(_)?g0:N0,N=f?f():{};return M(_,u,ut(S,2),N)}}function Pa(u){return Gt(function(f,_){var S=-1,M=_.length,N=M>1?_[M-1]:B,U=M>2?_[2]:B;for(N=u.length>3&&"function"==typeof N?(M--,N):B,U&&Gi(_[0],_[1],U)&&(N=M<3?B:N,M=1),f=xn(f);++S<M;){var j=_[S];j&&u(f,j,S,N)}return f})}function kg(u,f){return function(_,S){if(null==_)return _;if(!dr(_))return u(_,S);for(var M=_.length,N=f?M:-1,U=xn(_);(f?N--:++N<M)&&!1!==S(U[N],N,U););return _}}function Ug(u){return function(f,_,S){for(var M=-1,N=xn(f),U=S(f),j=U.length;j--;){var K=U[u?j:++M];if(!1===_(N[K],K,N))break}return f}}function Bg(u){return function(f){var _=zo(f=an(f))?Ms(f):B,S=_?_[0]:f.charAt(0),M=_?gl(_,1).join(""):f.slice(1);return S[u]()+M}}function Na(u){return function(f){return kd(Ba(Kw(f).replace(lP,"")),u,"")}}function th(u){return function(){var f=arguments;switch(f.length){case 0:return new u;case 1:return new u(f[0]);case 2:return new u(f[0],f[1]);case 3:return new u(f[0],f[1],f[2]);case 4:return new u(f[0],f[1],f[2],f[3]);case 5:return new u(f[0],f[1],f[2],f[3],f[4]);case 6:return new u(f[0],f[1],f[2],f[3],f[4],f[5]);case 7:return new u(f[0],f[1],f[2],f[3],f[4],f[5],f[6])}var _=Ii(u.prototype),S=u.apply(_,f);return $n(S)?S:_}}function hr(u){return function(f,_,S){var M=xn(f);if(!dr(f)){var N=ut(_,3);f=Wi(f),_=function(j){return N(M[j],j,M)}}var U=u(f,_,S);return U>-1?M[N?f[U]:U]:B}}function La(u){return Jo(function(f){var _=f.length,S=_,M=Lr.prototype.thru;for(u&&f.reverse();S--;){var N=f[S];if("function"!=typeof N)throw new ts(Kr);if(M&&!U&&"wrapper"==wf(N))var U=new Lr([],!0)}for(S=U?S:_;++S<_;){var j=wf(N=f[S]),K="wrapper"==j?iw(N):B;U=K&&Sf(K[0])&&424==K[1]&&!K[4].length&&1==K[9]?U[wf(K[0])].apply(U,K[3]):1==N.length&&Sf(N)?U[j]():U.thru(N)}return function(){var pe=arguments,me=pe[0];if(U&&1==pe.length&&Dt(me))return U.plant(me).value();for(var be=0,He=_?f[be].apply(this,pe):me;++be<_;)He=f[be].call(this,He);return He}})}function Rn(u,f,_,S,M,N,U,j,K,pe){var me=128&f,be=1&f,He=2&f,tt=24&f,ct=512&f,Wt=He?B:th(u);return function ht(){for(var Ht=arguments.length,Qt=re(Ht),ji=Ht;ji--;)Qt[ji]=arguments[ji];if(tt)var En=Pc(ht),us=function zu(Y,ue){for(var re=Y.length,Ue=0;re--;)Y[re]===ue&&++Ue;return Ue}(Qt,En);if(S&&(Qt=Z0(Qt,S,M,tt)),N&&(Qt=pf(Qt,N,U,tt)),Ht-=us,tt&&Ht<pe){var kn=yo(Qt,En);return Zo(u,f,Rn,ht.placeholder,_,Qt,kn,j,K,pe-Ht)}var yi=be?_:this,na=He?yi[u]:u;return Ht=Qt.length,j?Qt=function Cr(u,f){for(var _=u.length,S=Qi(f.length,_),M=ur(u);S--;){var N=f[S];u[S]=Co(N,_)?M[N]:B}return u}(Qt,j):ct&&Ht>1&&Qt.reverse(),me&&K<Ht&&(Qt.length=K),this&&this!==ar&&this instanceof ht&&(na=Wt||th(na)),na.apply(yi,Qt)}}function mf(u,f){return function(_,S){return function Rx(u,f,_,S){return Yo(u,function(M,N,U){f(S,_(M),N,U)}),S}(_,u,f(S),{})}}function gf(u,f){return function(_,S){var M;if(_===B&&S===B)return f;if(_!==B&&(M=_),S!==B){if(M===B)return S;"string"==typeof _||"string"==typeof S?(_=os(_),S=os(S)):(_=X0(_),S=X0(S)),M=u(_,S)}return M}}function Vg(u){return Jo(function(f){return f=Dn(f,Oe(ut())),Gt(function(_){var S=this;return u(f,function(M){return vr(M,S,_)})})})}function _f(u,f){var _=(f=f===B?" ":os(f)).length;if(_<2)return _?uf(f,u):f;var S=uf(f,Ea(u/cl(f)));return zo(f)?gl(Ms(S),0,u).join(""):S.slice(0,u)}function Hg(u){return function(f,_,S){return S&&"number"!=typeof S&&Gi(f,_,S)&&(_=S=B),f=ea(f),_===B?(_=f,f=0):_=ea(_),function W0(u,f,_,S){for(var M=-1,N=Qn(Ea((f-u)/(_||1)),0),U=re(N);N--;)U[S?N:++M]=u,u+=_;return U}(f,_,S=S===B?f<_?1:-1:ea(S),u)}}function _l(u){return function(f,_){return"string"==typeof f&&"string"==typeof _||(f=kr(f),_=kr(_)),u(f,_)}}function Zo(u,f,_,S,M,N,U,j,K,pe){var me=8&f;f|=me?32:64,4&(f&=~(me?64:32))||(f&=-4);var Wt=[u,f,M,me?N:B,me?U:B,me?B:N,me?B:U,j,K,pe],ht=_.apply(B,Wt);return Sf(u)&&gi(ht,Wt),ht.placeholder=S,Yg(ht,u,f)}function zg(u){var f=Ai[u];return function(_,S){if(_=kr(_),(S=null==S?0:Qi(Vt(S),292))&&Wo(_)){var M=(an(_)+"e").split("e");return+((M=(an(f(M[0]+"e"+(+M[1]+S)))+"e").split("e"))[0]+"e"+(+M[1]-S))}return f(_)}}var yf=ns&&1/vc(new ns([,-0]))[1]==Cn?function(u){return new ns(u)}:wh;function nh(u){return function(f){var _=Pi(f);return _==zs?nn(f):_==Gs?function E0(Y){var ue=-1,re=Array(Y.size);return Y.forEach(function(Ue){re[++ue]=[Ue,Ue]}),re}(f):function ba(Y,ue){return Dn(ue,function(re){return[re,Y[re]]})}(f,u(f))}}function Ds(u,f,_,S,M,N,U,j){var K=2&f;if(!K&&"function"!=typeof u)throw new ts(Kr);var pe=S?S.length:0;if(pe||(f&=-97,S=M=B),U=U===B?U:Qn(Vt(U),0),j=j===B?j:Vt(j),pe-=M?M.length:0,64&f){var me=S,be=M;S=M=B}var He=K?B:iw(u),tt=[u,f,_,S,M,me,be,N,U,j];if(He&&function jx(u,f){var _=u[1],S=f[1],M=_|S;if(!(M<131)&&!(128==S&&8==_||128==S&&256==_&&u[7].length<=f[8]||384==S&&f[7].length<=f[8]&&8==_))return u;1&S&&(u[2]=f[2],M|=1&_?0:4);var j=f[3];if(j){var K=u[3];u[3]=K?Z0(K,j,f[4]):j,u[4]=K?yo(u[3],sl):f[4]}(j=f[5])&&(u[5]=(K=u[5])?pf(K,j,f[6]):j,u[6]=K?yo(u[5],sl):f[6]),(j=f[7])&&(u[7]=j),128&S&&(u[8]=null==u[8]?f[8]:Qi(u[8],f[8])),null==u[9]&&(u[9]=f[9]),u[0]=f[0],u[1]=M}(tt,He),u=tt[0],f=tt[1],_=tt[2],S=tt[3],M=tt[4],!(j=tt[9]=tt[9]===B?K?0:u.length:Qn(tt[9]-pe,0))&&24&f&&(f&=-25),f&&1!=f)ct=8==f||16==f?function Vx(u,f,_){var S=th(u);return function M(){for(var N=arguments.length,U=re(N),j=N,K=Pc(M);j--;)U[j]=arguments[j];var pe=N<3&&U[0]!==K&&U[N-1]!==K?[]:yo(U,K);return(N-=pe.length)<_?Zo(u,f,Rn,M.placeholder,B,U,pe,B,B,_-N):vr(this&&this!==ar&&this instanceof M?S:u,this,U)}}(u,f,j):32!=f&&33!=f||M.length?Rn.apply(B,tt):function Q0(u,f,_,S){var M=1&f,N=th(u);return function U(){for(var j=-1,K=arguments.length,pe=-1,me=S.length,be=re(me+K),He=this&&this!==ar&&this instanceof U?N:u;++pe<me;)be[pe]=S[pe];for(;K--;)be[pe++]=arguments[++j];return vr(He,M?_:this,be)}}(u,f,_,S);else var ct=function J0(u,f,_){var S=1&f,M=th(u);return function N(){return(this&&this!==ar&&this instanceof N?M:u).apply(S?_:this,arguments)}}(u,f,_);return Yg((He?$0:gi)(ct,tt),u,f)}function vf(u,f,_,S){return u===B||Ks(u,wc[_])&&!mn.call(S,_)?f:u}function Gg(u,f,_,S,M,N){return $n(u)&&$n(f)&&(N.set(f,u),Ju(u,f,B,Gg,N),N.delete(f)),u}function ew(u){return xl(u)?B:u}function tw(u,f,_,S,M,N){var U=1&_,j=u.length,K=f.length;if(j!=K&&!(U&&K>j))return!1;var pe=N.get(u),me=N.get(f);if(pe&&me)return pe==f&&me==u;var be=-1,He=!0,tt=2&_?new Ta:B;for(N.set(u,f),N.set(f,u);++be<j;){var ct=u[be],Wt=f[be];if(S)var ht=U?S(Wt,ct,be,f,u,N):S(ct,Wt,be,u,f,N);if(ht!==B){if(ht)continue;He=!1;break}if(tt){if(!pg(f,function(Ht,Qt){if(!ze(tt,Qt)&&(ct===Ht||M(ct,Ht,_,S,N)))return tt.push(Qt)})){He=!1;break}}else if(ct!==Wt&&!M(ct,Wt,_,S,N)){He=!1;break}}return N.delete(u),N.delete(f),He}function Jo(u){return Xg(Lc(u,B,Fc),u+"")}function nw(u){return Dg(u,Wi,yl)}function rh(u){return Dg(u,fr,bf)}var iw=Ca?function(u){return Ca.get(u)}:wh;function wf(u){for(var f=u.name+"",_=kt[f],S=mn.call(kt,f)?_.length:0;S--;){var M=_[S],N=M.func;if(null==N||N==u)return M.name}return f}function Pc(u){return(mn.call(I,"placeholder")?I:u).placeholder}function ut(){var u=I.iteratee||L_;return u=u===L_?Pg:u,arguments.length?u(arguments[0],arguments[1]):u}function Wg(u,f){var _=u.__data__;return function Wx(u){var f=typeof u;return"string"==f||"number"==f||"symbol"==f||"boolean"==f?"__proto__"!==u:null===u}(f)?_["string"==typeof f?"string":"hash"]:_.map}function sh(u){for(var f=Wi(u),_=f.length;_--;){var S=f[_],M=u[S];f[_]=[S,M,aw(M)]}return f}function Xs(u,f){var _=function Ho(Y,ue){return null==Y?B:Y[ue]}(u,f);return B0(_)?_:B}var yl=Sa?function(u){return null==u?[]:(u=xn(u),on(Sa(u),function(f){return Eg.call(u,f)}))}:ub,bf=Sa?function(u){for(var f=[];u;)go(f,yl(u)),u=lr(u);return f}:ub,Pi=br;function jg(u,f,_){for(var S=-1,M=(f=So(f,u)).length,N=!1;++S<M;){var U=xr(f[S]);if(!(N=null!=u&&_(u,U)))break;u=u[U]}return N||++S!=M?N:!!(M=null==u?0:u.length)&&dh(M)&&Co(U,M)&&(Dt(u)||Sl(u))}function Ys(u){return"function"!=typeof u.constructor||Nc(u)?{}:Ii(lr(u))}function $g(u){return Dt(u)||Sl(u)||!!(A0&&u&&u[A0])}function Co(u,f){var _=typeof u;return!!(f=f??Vo)&&("number"==_||"symbol"!=_&&sP.test(u))&&u>-1&&u%1==0&&u<f}function Gi(u,f,_){if(!$n(_))return!1;var S=typeof f;return!!("number"==S?dr(_)&&Co(f,_.length):"string"==S&&f in _)&&Ks(_[f],u)}function oh(u,f){if(Dt(u))return!1;var _=typeof u;return!("number"!=_&&"symbol"!=_&&"boolean"!=_&&null!=u&&!ls(u))||JC.test(u)||!e0.test(u)||null!=f&&u in xn(f)}function Sf(u){var f=wf(u),_=I[f];if("function"!=typeof _||!(f in Ut.prototype))return!1;if(u===_)return!0;var S=iw(_);return!!S&&u===S[0]}(Ts&&Pi(new Ts(new ArrayBuffer(1)))!=mc||jo&&Pi(new jo)!=zs||$d&&Pi($d.resolve())!=$C||ns&&Pi(new ns)!=Gs||is&&Pi(new is)!=pc)&&(Pi=function(u){var f=br(u),_=f==ya?u.constructor:B,S=_?Oa(_):"";if(S)switch(S){case yP:return mc;case Sg:return zs;case D0:return $C;case vo:return Gs;case qd:return pc}return f});var ow=Ji?Rs:hb;function Nc(u){var f=u&&u.constructor;return u===("function"==typeof f&&f.prototype||wc)}function aw(u){return u==u&&!$n(u)}function ah(u,f){return function(_){return null!=_&&_[u]===f&&(f!==B||u in xn(_))}}function Lc(u,f,_){return f=Qn(f===B?u.length-1:f,0),function(){for(var S=arguments,M=-1,N=Qn(S.length-f,0),U=re(N);++M<N;)U[M]=S[f+M];M=-1;for(var j=re(f+1);++M<f;)j[M]=S[M];return j[f]=_(U),vr(u,this,j)}}function uw(u,f){return f.length<2?u:Ia(u,ss(f,0,-1))}function qg(u,f){if(("constructor"!==f||"function"!=typeof u[f])&&"__proto__"!=f)return u[f]}var gi=lh($0),wl=Ws||function(u,f){return ar.setTimeout(u,f)},Xg=lh(Ox);function Yg(u,f,_){var S=f+"";return Xg(u,function Ef(u,f){var _=f.length;if(!_)return u;var S=_-1;return f[S]=(_>1?"& ":"")+f[S],f=f.join(_>2?", ":" "),u.replace(QC,"{\n/* [wrapped with "+f+"] */\n")}(S,function Kg(u,f){return Fn(qv,function(_){var S="_."+_[0];f&_[1]&&!dg(u,S)&&u.push(S)}),u.sort()}(function rw(u){var f=u.match(ex);return f?f[1].split(tx):[]}(S),_)))}function lh(u){var f=0,_=0;return function(){var S=Ec(),M=16-(S-_);if(_=S,M>0){if(++f>=800)return arguments[0]}else f=0;return u.apply(B,arguments)}}function Qo(u,f){var _=-1,S=u.length,M=S-1;for(f=f===B?S:f;++_<f;){var N=cf(_,M),U=u[N];u[N]=u[_],u[_]=U}return u.length=f,u}var bl=function vl(u){var f=kf(u,function(S){return 500===_.size&&_.clear(),S}),_=f.cache;return f}(function(u){var f=[];return 46===u.charCodeAt(0)&&f.push(""),u.replace(t0,function(_,S,M,N){f.push(M?N.replace(ix,"$1"):S||_)}),f});function xr(u){if("string"==typeof u||ls(u))return u;var f=u+"";return"0"==f&&1/u==-Cn?"-0":f}function Oa(u){if(null!=u){try{return Wd.call(u)}catch{}try{return u+""}catch{}}return""}function El(u){if(u instanceof Ut)return u.clone();var f=new Lr(u.__wrapped__,u.__chain__);return f.__actions__=ur(u.__actions__),f.__index__=u.__index__,f.__values__=u.__values__,f}var UP=Gt(function(u,f){return ei(u)?Jd(u,Ri(f,1,ei,!0)):[]}),BP=Gt(function(u,f){var _=jn(f);return ei(_)&&(_=B),ei(u)?Jd(u,Ri(f,1,ei,!0),ut(_,2)):[]}),VP=Gt(function(u,f){var _=jn(f);return ei(_)&&(_=B),ei(u)?Jd(u,Ri(f,1,ei,!0),B,_):[]});function _i(u,f,_){var S=null==u?0:u.length;if(!S)return-1;var M=null==_?0:Vt(_);return M<0&&(M=Qn(S+M,0)),gg(u,ut(f,3),M)}function hw(u,f,_){var S=null==u?0:u.length;if(!S)return-1;var M=S-1;return _!==B&&(M=Vt(_),M=_<0?Qn(S+M,0):Qi(M,S-1)),gg(u,ut(f,3),M,!0)}function Fc(u){return null!=u&&u.length?Ri(u,1):[]}function Zg(u){return u&&u.length?u[0]:B}var Kx=Gt(function(u){var f=Dn(u,As);return f.length&&f[0]===u[0]?nf(f):[]}),GP=Gt(function(u){var f=jn(u),_=Dn(u,As);return f===jn(_)?f=B:_.pop(),_.length&&_[0]===u[0]?nf(_,ut(f,2)):[]}),Zx=Gt(function(u){var f=jn(u),_=Dn(u,As);return(f="function"==typeof f?f:B)&&_.pop(),_.length&&_[0]===u[0]?nf(_,B,f):[]});function jn(u){var f=null==u?0:u.length;return f?u[f-1]:B}var jP=Gt(Qg);function Qg(u,f){return u&&u.length&&f&&f.length?lf(u,f):u}var eM=Jo(function(u,f){var _=null==u?0:u.length,S=Zd(u,f);return G0(u,Dn(f,function(M){return Co(M,_)?+M:M}).sort(Og)),S});function e_(u){return null==u?u:Cc.call(u)}var Bc=Gt(function(u){return ge(Ri(u,1,ei,!0))}),uh=Gt(function(u){var f=jn(u);return ei(f)&&(f=B),ge(Ri(u,1,ei,!0),ut(f,2))}),lM=Gt(function(u){var f=jn(u);return f="function"==typeof f?f:B,ge(Ri(u,1,ei,!0),B,f)});function mw(u){if(!u||!u.length)return[];var f=0;return u=on(u,function(_){if(ei(_))return f=Qn(_.length,f),!0}),vg(f,function(_){return Dn(u,_g(_))})}function gw(u,f){if(!u||!u.length)return[];var _=mw(u);return null==f?_:Dn(_,function(S){return vr(f,B,S)})}var uM=Gt(function(u,f){return ei(u)?Jd(u,f):[]}),hM=Gt(function(u){return ff(on(u,ei))}),Df=Gt(function(u){var f=jn(u);return ei(f)&&(f=B),ff(on(u,ei),ut(f,2))}),_w=Gt(function(u){var f=jn(u);return f="function"==typeof f?f:B,ff(on(u,ei),B,f)}),dM=Gt(mw),vw=Gt(function(u){var f=u.length,_=f>1?u[f-1]:B;return _="function"==typeof _?(u.pop(),_):B,gw(u,_)});function fM(u){var f=I(u);return f.__chain__=!0,f}function If(u,f){return f(u)}var i_=Jo(function(u){var f=u.length,_=f?u[0]:0,S=this.__wrapped__,M=function(N){return Zd(N,u)};return!(f>1||this.__actions__.length)&&S instanceof Ut&&Co(_)?((S=S.slice(_,+_+(f?1:0))).__actions__.push({func:If,args:[M],thisArg:B}),new Lr(S,this.__chain__).thru(function(N){return f&&!N.length&&N.push(B),N})):this.thru(M)}),eN=eh(function(u,f,_){mn.call(u,_)?++u[_]:bo(u,_,1)}),Pf=hr(_i),ww=hr(hw);function s_(u,f){return(Dt(u)?Fn:ml)(u,ut(f,3))}function o_(u,f){return(Dt(u)?_0:Tx)(u,ut(f,3))}var Nf=eh(function(u,f,_){mn.call(u,_)?u[_].push(f):bo(u,_,[f])}),Fa=Gt(function(u,f,_){var S=-1,M="function"==typeof f,N=dr(u)?re(u.length):[];return ml(u,function(U){N[++S]=M?vr(f,U,_):rf(U,f,_)}),N}),gM=eh(function(u,f,_){bo(u,_,f)});function Of(u,f){return(Dt(u)?Dn:Zu)(u,ut(f,3))}var Sw=eh(function(u,f,_){u[_?0:1].push(f)},function(){return[[],[]]}),l_=Gt(function(u,f){if(null==u)return[];var _=f.length;return _>1&&Gi(u,f[0],f[1])?f=[]:_>2&&Gi(f[0],f[1],f[2])&&(f=[f[0]]),H0(u,Ri(f,1),[])}),hh=Wn||function(){return ar.Date.now()};function tr(u,f,_){return f=_?B:f,Ds(u,128,B,B,B,B,f=u&&null==f?u.length:f)}function Hc(u,f){var _;if("function"!=typeof f)throw new ts(Kr);return u=Vt(u),function(){return--u>0&&(_=f.apply(this,arguments)),u<=1&&(f=B),_}}var Ff=Gt(function(u,f,_){var S=1;if(_.length){var M=yo(_,Pc(Ff));S|=32}return Ds(u,S,f,_,M)}),u_=Gt(function(u,f,_){var S=3;if(_.length){var M=yo(_,Pc(u_));S|=32}return Ds(f,S,u,_,M)});function Mw(u,f,_){var S,M,N,U,j,K,pe=0,me=!1,be=!1,He=!0;if("function"!=typeof u)throw new ts(Kr);function tt(kn){var yi=S,na=M;return S=M=B,pe=kn,U=u.apply(na,yi)}function ht(kn){var yi=kn-K;return K===B||yi>=f||yi<0||be&&kn-pe>=N}function Ht(){var kn=hh();if(ht(kn))return Qt(kn);j=wl(Ht,function Wt(kn){var fb=f-(kn-K);return be?Qi(fb,N-(kn-pe)):fb}(kn))}function Qt(kn){return j=B,He&&S?tt(kn):(S=M=B,U)}function us(){var kn=hh(),yi=ht(kn);if(S=arguments,M=this,K=kn,yi){if(j===B)return function ct(kn){return pe=kn,j=wl(Ht,f),me?tt(kn):U}(K);if(be)return Lg(j),j=wl(Ht,f),tt(K)}return j===B&&(j=wl(Ht,f)),U}return f=kr(f)||0,$n(_)&&(me=!!_.leading,N=(be="maxWait"in _)?Qn(kr(_.maxWait)||0,f):N,He="trailing"in _?!!_.trailing:He),us.cancel=function ji(){j!==B&&Lg(j),pe=0,S=K=M=j=B},us.flush=function En(){return j===B?U:Qt(hh())},us}var Tw=Gt(function(u,f){return Mg(u,1,f)}),SM=Gt(function(u,f,_){return Mg(u,kr(f)||0,_)});function kf(u,f){if("function"!=typeof u||null!=f&&"function"!=typeof f)throw new ts(Kr);var _=function(){var S=arguments,M=f?f.apply(this,S):S[0],N=_.cache;if(N.has(M))return N.get(M);var U=u.apply(this,S);return _.cache=N.set(M,U)||N,U};return _.cache=new(kf.Cache||Ma),_}function Uf(u){if("function"!=typeof u)throw new ts(Kr);return function(){var f=arguments;switch(f.length){case 0:return!u.call(this);case 1:return!u.call(this,f[0]);case 2:return!u.call(this,f[0],f[1]);case 3:return!u.call(this,f[0],f[1],f[2])}return!u.apply(this,f)}}kf.Cache=Ma;var f_=kx(function(u,f){var _=(f=1==f.length&&Dt(f[0])?Dn(f[0],Oe(ut())):Dn(Ri(f,1),Oe(ut()))).length;return Gt(function(S){for(var M=-1,N=Qi(S.length,_);++M<N;)S[M]=f[M].call(this,S[M]);return vr(u,this,S)})}),p_=Gt(function(u,f){var _=yo(f,Pc(p_));return Ds(u,32,B,f,_)}),zc=Gt(function(u,f){var _=yo(f,Pc(zc));return Ds(u,64,B,f,_)}),CM=Jo(function(u,f){return Ds(u,256,B,B,B,f)});function Ks(u,f){return u===f||u!=u&&f!=f}var AM=_l(Ig),DM=_l(function(u,f){return u>=f}),Sl=F0(function(){return arguments}())?F0:function(u){return ti(u)&&mn.call(u,"callee")&&!Eg.call(u,"callee")},Dt=re.isArray,Hf=Fu?Oe(Fu):function Hi(u){return ti(u)&&br(u)==Pu};function dr(u){return null!=u&&dh(u.length)&&!Rs(u)}function ei(u){return ti(u)&&dr(u)}var ka=ci||hb,g_=ku?Oe(ku):function k0(u){return ti(u)&&br(u)==ol};function __(u){if(!ti(u))return!1;var f=br(u);return f==dc||"[object DOMException]"==f||"string"==typeof u.message&&"string"==typeof u.name&&!xl(u)}function Rs(u){if(!$n(u))return!1;var f=br(u);return f==Cd||f==Xv||"[object AsyncFunction]"==f||"[object Proxy]"==f}function Fw(u){return"number"==typeof u&&u==Vt(u)}function dh(u){return"number"==typeof u&&u>-1&&u%1==0&&u<=Vo}function $n(u){var f=typeof u;return null!=u&&("object"==f||"function"==f)}function ti(u){return null!=u&&"object"==typeof u}var zf=Fd?Oe(Fd):function U0(u){return ti(u)&&Pi(u)==zs};function v_(u){return"number"==typeof u||ti(u)&&br(u)==xd}function xl(u){if(!ti(u)||br(u)!=ya)return!1;var f=lr(u);if(null===f)return!0;var _=mn.call(f,"constructor")&&f.constructor;return"function"==typeof _&&_ instanceof _&&Wd.call(_)==T0}var Ml=hg?Oe(hg):function Rg(u){return ti(u)&&br(u)==fc},w_=m0?Oe(m0):function Nx(u){return ti(u)&&Pi(u)==Gs};function jf(u){return"string"==typeof u||!Dt(u)&&ti(u)&&br(u)==al}function ls(u){return"symbol"==typeof u||ti(u)&&br(u)==Md}var Wc=$t?Oe($t):function Eo(u){return ti(u)&&dh(u.length)&&!!Ln[br(u)]},b_=_l(Ku),jc=_l(function(u,f){return u<=f});function Hw(u){if(!u)return[];if(dr(u))return jf(u)?Ms(u):ur(u);if($u&&u[$u])return function _o(Y){for(var ue,re=[];!(ue=Y.next()).done;)re.push(ue.value);return re}(u[$u]());var f=Pi(u);return(f==zs?nn:f==Gs?vc:Tl)(u)}function ea(u){return u?(u=kr(u))===Cn||u===-Cn?17976931348623157e292*(u<0?-1:1):u==u?u:0:0===u?u:0}function Vt(u){var f=ea(u),_=f%1;return f==f?_?f-_:f:0}function zw(u){return u?Da(Vt(u),0,ho):0}function kr(u){if("number"==typeof u)return u;if(ls(u))return NaN;if($n(u)){var f="function"==typeof u.valueOf?u.valueOf():u;u=$n(f)?f+"":f}if("string"!=typeof u)return 0===u?u:+u;u=b0(u);var _=Zi.test(u);return _||mo.test(u)?mP(u.slice(2),_?2:8):sx.test(u)?NaN:+u}function Gw(u){return qs(u,fr(u))}function an(u){return null==u?"":os(u)}var E_=Pa(function(u,f){if(Nc(f)||dr(f))qs(f,Wi(f),u);else for(var _ in f)mn.call(f,_)&&xc(u,_,f[_])}),S_=Pa(function(u,f){qs(f,fr(f),u)}),ph=Pa(function(u,f,_,S){qs(f,fr(f),u,S)}),Ww=Pa(function(u,f,_,S){qs(f,Wi(f),u,S)}),jw=Jo(Zd),NM=Gt(function(u,f){u=xn(u);var _=-1,S=f.length,M=S>2?f[2]:B;for(M&&Gi(f[0],f[1],M)&&(S=1);++_<S;)for(var N=f[_],U=fr(N),j=-1,K=U.length;++j<K;){var pe=U[j],me=u[pe];(me===B||Ks(me,wc[pe])&&!mn.call(u,pe))&&(u[pe]=N[pe])}return u}),LM=Gt(function(u){return u.push(B,Gg),vr(C_,B,u)});function $w(u,f,_){var S=null==u?B:Ia(u,f);return S===B?_:S}function qf(u,f){return null!=u&&jg(u,f,O0)}var UM=mf(function(u,f,_){null!=f&&"function"!=typeof f.toString&&(f=jd.call(f)),u[f]=_},vh(pr)),BM=mf(function(u,f,_){null!=f&&"function"!=typeof f.toString&&(f=jd.call(f)),mn.call(u,f)?u[f].push(_):u[f]=[_]},ut),VM=Gt(rf);function Wi(u){return dr(u)?qu(u):af(u)}function fr(u){return dr(u)?qu(u,!0):function In(u){if(!$n(u))return function lw(u){var f=[];if(null!=u)for(var _ in xn(u))f.push(_);return f}(u);var f=Nc(u),_=[];for(var S in u)"constructor"==S&&(f||!mn.call(u,S))||_.push(S);return _}(u)}var qw=Pa(function(u,f,_){Ju(u,f,_)}),C_=Pa(function(u,f,_,S){Ju(u,f,_,S)}),Xw=Jo(function(u,f){var _={};if(null==u)return _;var S=!1;f=Dn(f,function(N){return N=So(N,u),S||(S=N.length>1),N}),qs(u,rh(u),_),S&&(_=wr(_,7,ew));for(var M=f.length;M--;)Zt(_,f[M]);return _}),aN=Jo(function(u,f){return null==u?{}:function Lx(u,f){return z0(u,f,function(_,S){return qf(u,S)})}(u,f)});function HM(u,f){if(null==u)return{};var _=Dn(rh(u),function(S){return[S]});return f=ut(f),z0(u,_,function(S,M){return f(S,M[0])})}var zM=nh(Wi),T_=nh(fr);function Tl(u){return null==u?[]:Bd(u,Wi(u))}var qc=Na(function(u,f,_){return f=f.toLowerCase(),u+(_?Yw(f):f)});function Yw(u){return Kf(an(u).toLowerCase())}function Kw(u){return(u=an(u))&&u.replace(ox,yx).replace(fx,"")}var KM=Na(function(u,f,_){return u+(_?"-":"")+f.toLowerCase()}),ZM=Na(function(u,f,_){return u+(_?" ":"")+f.toLowerCase()}),JM=Bg("toLowerCase"),eb=Na(function(u,f,_){return u+(_?"_":"")+f.toLowerCase()}),D_=Na(function(u,f,_){return u+(_?" ":"")+Kf(f)}),rb=Na(function(u,f,_){return u+(_?" ":"")+f.toUpperCase()}),Kf=Bg("toUpperCase");function Ba(u,f,_){return u=an(u),(f=_?B:f)===B?function xs(Y){return uP.test(Y)}(u)?function x0(Y){return Y.match(ll)||[]}(u):function _P(Y){return Y.match(nx)||[]}(u):u.match(f)||[]}var sb=Gt(function(u,f){try{return vr(u,B,f)}catch(_){return __(_)?_:new At(_)}}),N_=Jo(function(u,f){return Fn(f,function(_){_=xr(_),bo(u,_,Ff(u[_],u))}),u});function vh(u){return function(){return u}}var cs=La(),Qf=La(!0);function pr(u){return u}function L_(u){return Pg("function"==typeof u?u:wr(u,1))}var Xc=Gt(function(u,f){return function(_){return rf(_,u,f)}}),iT=Gt(function(u,f){return function(_){return rf(u,_,f)}});function O_(u,f,_){var S=Wi(f),M=tf(f,S);null==_&&(!$n(f)||!M.length&&S.length)&&(_=f,f=u,u=this,M=tf(f,Wi(f)));var N=!($n(_)&&"chain"in _&&!_.chain),U=Rs(u);return Fn(M,function(j){var K=f[j];u[j]=K,U&&(u.prototype[j]=function(){var pe=this.__chain__;if(N||pe){var me=u(this.__wrapped__);return(me.__actions__=ur(this.__actions__)).push({func:K,args:arguments,thisArg:u}),me.__chain__=pe,me}return K.apply(u,go([this.value()],arguments))})}),u}function wh(){}var sT=Vg(Dn),ab=Vg(gx),Va=Vg(pg);function oT(u){return oh(u)?_g(xr(u)):function Ra(u){return function(f){return Ia(f,u)}}(u)}var cb=Hg(),aT=Hg(!0);function ub(){return[]}function hb(){return!1}var B_=gf(function(u,f){return u+f},0),bh=zg("ceil"),np=gf(function(u,f){return u/f},1),Kc=zg("floor"),cT=gf(function(u,f){return u*f},1),db=zg("round"),uT=gf(function(u,f){return u-f},0);return I.after=function c_(u,f){if("function"!=typeof f)throw new ts(Kr);return u=Vt(u),function(){if(--u<1)return f.apply(this,arguments)}},I.ary=tr,I.assign=E_,I.assignIn=S_,I.assignInWith=ph,I.assignWith=Ww,I.at=jw,I.before=Hc,I.bind=Ff,I.bindAll=N_,I.bindKey=u_,I.castArray=function Bf(){if(!arguments.length)return[];var u=arguments[0];return Dt(u)?u:[u]},I.chain=fM,I.chunk=function FP(u,f,_){f=(_?Gi(u,f,_):f===B)?1:Qn(Vt(f),0);var S=null==u?0:u.length;if(!S||f<1)return[];for(var M=0,N=0,U=re(Ea(S/f));M<S;)U[N++]=ss(u,M,M+=f);return U},I.compact=function $x(u){for(var f=-1,_=null==u?0:u.length,S=0,M=[];++f<_;){var N=u[f];N&&(M[S++]=N)}return M},I.concat=function kP(){var u=arguments.length;if(!u)return[];for(var f=re(u-1),_=arguments[0],S=u;S--;)f[S-1]=arguments[S];return go(Dt(_)?ur(_):[_],Ri(f,1))},I.cond=function Zf(u){var f=null==u?0:u.length,_=ut();return u=f?Dn(u,function(S){if("function"!=typeof S[1])throw new ts(Kr);return[_(S[0]),S[1]]}):[],Gt(function(S){for(var M=-1;++M<f;){var N=u[M];if(vr(N[0],this,S))return vr(N[1],this,S)}})},I.conforms=function tT(u){return function Xu(u){var f=Wi(u);return function(_){return pl(_,u,f)}}(wr(u,1))},I.constant=vh,I.countBy=eN,I.create=function PM(u,f){var _=Ii(u);return null==f?_:Kd(_,f)},I.curry=function xw(u,f,_){var S=Ds(u,8,B,B,B,B,B,f=_?B:f);return S.placeholder=xw.placeholder,S},I.curryRight=function h_(u,f,_){var S=Ds(u,16,B,B,B,B,B,f=_?B:f);return S.placeholder=h_.placeholder,S},I.debounce=Mw,I.defaults=NM,I.defaultsDeep=LM,I.defer=Tw,I.delay=SM,I.difference=UP,I.differenceBy=BP,I.differenceWith=VP,I.drop=function HP(u,f,_){var S=null==u?0:u.length;return S?ss(u,(f=_||f===B?1:Vt(f))<0?0:f,S):[]},I.dropRight=function zP(u,f,_){var S=null==u?0:u.length;return S?ss(u,0,(f=S-(f=_||f===B?1:Vt(f)))<0?0:f):[]},I.dropRightWhile=function Oc(u,f){return u&&u.length?Sr(u,ut(f,3),!0,!0):[]},I.dropWhile=function qx(u,f){return u&&u.length?Sr(u,ut(f,3),!0):[]},I.fill=function Xx(u,f,_,S){var M=null==u?0:u.length;return M?(_&&"number"!=typeof _&&Gi(u,f,_)&&(_=0,S=M),function LP(u,f,_,S){var M=u.length;for((_=Vt(_))<0&&(_=-_>M?0:M+_),(S=S===B||S>M?M:Vt(S))<0&&(S+=M),S=_>S?0:zw(S);_<S;)u[_++]=f;return u}(u,f,_,S)):[]},I.filter=function Rf(u,f){return(Dt(u)?on:Tg)(u,ut(f,3))},I.flatMap=function bw(u,f){return Ri(Of(u,f),1)},I.flatMapDeep=function Ew(u,f){return Ri(Of(u,f),Cn)},I.flatMapDepth=function Vc(u,f,_){return _=_===B?1:Vt(_),Ri(Of(u,f),_)},I.flatten=Fc,I.flattenDeep=function Yx(u){return null!=u&&u.length?Ri(u,Cn):[]},I.flattenDepth=function Is(u,f){return null!=u&&u.length?Ri(u,f=f===B?1:Vt(f)):[]},I.flip=function Aw(u){return Ds(u,512)},I.flow=cs,I.flowRight=Qf,I.fromPairs=function kc(u){for(var f=-1,_=null==u?0:u.length,S={};++f<_;){var M=u[f];S[M[0]]=M[1]}return S},I.functions=function iN(u){return null==u?[]:tf(u,Wi(u))},I.functionsIn=function rN(u){return null==u?[]:tf(u,fr(u))},I.groupBy=Nf,I.initial=function ch(u){return null!=u&&u.length?ss(u,0,-1):[]},I.intersection=Kx,I.intersectionBy=GP,I.intersectionWith=Zx,I.invert=UM,I.invertBy=BM,I.invokeMap=Fa,I.iteratee=L_,I.keyBy=gM,I.keys=Wi,I.keysIn=fr,I.map=Of,I.mapKeys=function ta(u,f){var _={};return f=ut(f,3),Yo(u,function(S,M,N){bo(_,f(S,M,N),S)}),_},I.mapValues=function gh(u,f){var _={};return f=ut(f,3),Yo(u,function(S,M,N){bo(_,M,f(S,M,N))}),_},I.matches=function nT(u){return Er(wr(u,1))},I.matchesProperty=function ob(u,f){return V0(u,wr(f,1))},I.memoize=kf,I.merge=qw,I.mergeWith=C_,I.method=Xc,I.methodOf=iT,I.mixin=O_,I.negate=Uf,I.nthArg=function ep(u){return u=Vt(u),Gt(function(f){return Or(f,u)})},I.omit=Xw,I.omitBy=function oN(u,f){return HM(u,Uf(ut(f)))},I.once=function d_(u){return Hc(2,u)},I.orderBy=function _M(u,f,_,S){return null==u?[]:(Dt(f)||(f=null==f?[]:[f]),Dt(_=S?B:_)||(_=null==_?[]:[_]),H0(u,f,_))},I.over=sT,I.overArgs=f_,I.overEvery=ab,I.overSome=Va,I.partial=p_,I.partialRight=zc,I.partition=Sw,I.pick=aN,I.pickBy=HM,I.property=oT,I.propertyOf=function lb(u){return function(f){return null==u?B:Ia(u,f)}},I.pull=jP,I.pullAll=Qg,I.pullAllBy=function Jx(u,f,_){return u&&u.length&&f&&f.length?lf(u,f,ut(_,2)):u},I.pullAllWith=function Qx(u,f,_){return u&&u.length&&f&&f.length?lf(u,f,B,_):u},I.pullAt=eM,I.range=cb,I.rangeRight=aT,I.rearg=CM,I.reject=function vM(u,f){return(Dt(u)?on:Tg)(u,Uf(ut(f,3)))},I.remove=function tM(u,f){var _=[];if(!u||!u.length)return _;var S=-1,M=[],N=u.length;for(f=ut(f,3);++S<N;){var U=u[S];f(U,S,u)&&(_.push(U),M.push(S))}return G0(u,M),_},I.rest=function xM(u,f){if("function"!=typeof u)throw new ts(Kr);return Gt(u,f=f===B?f:Vt(f))},I.reverse=e_,I.sampleSize=function Cw(u,f,_){return f=(_?Gi(u,f,_):f===B)?1:Vt(f),(Dt(u)?R0:j0)(u,f)},I.set=function M_(u,f,_){return null==u?u:hf(u,f,_)},I.setWith=function lN(u,f,_,S){return S="function"==typeof S?S:B,null==u?u:hf(u,f,_,S)},I.shuffle=function bM(u){return(Dt(u)?P0:Fx)(u)},I.slice=function nM(u,f,_){var S=null==u?0:u.length;return S?(_&&"number"!=typeof _&&Gi(u,f,_)?(f=0,_=S):(f=null==f?0:Vt(f),_=_===B?S:Vt(_)),ss(u,f,_)):[]},I.sortBy=l_,I.sortedUniq=function sM(u){return u&&u.length?q0(u):[]},I.sortedUniqBy=function dw(u,f){return u&&u.length?q0(u,ut(f,2)):[]},I.split=function tb(u,f,_){return _&&"number"!=typeof _&&Gi(u,f,_)&&(f=_=B),(_=_===B?ho:_>>>0)?(u=an(u))&&("string"==typeof f||null!=f&&!Ml(f))&&!(f=os(f))&&zo(u)?gl(Ms(u),0,_):u.split(f,_):[]},I.spread=function Dw(u,f){if("function"!=typeof u)throw new ts(Kr);return f=null==f?0:Qn(Vt(f),0),Gt(function(_){var S=_[f],M=gl(_,0,f);return S&&go(M,S),vr(u,this,M)})},I.tail=function n_(u){var f=null==u?0:u.length;return f?ss(u,1,f):[]},I.take=function Af(u,f,_){return u&&u.length?ss(u,0,(f=_||f===B?1:Vt(f))<0?0:f):[]},I.takeRight=function fw(u,f,_){var S=null==u?0:u.length;return S?ss(u,(f=S-(f=_||f===B?1:Vt(f)))<0?0:f,S):[]},I.takeRightWhile=function oM(u,f){return u&&u.length?Sr(u,ut(f,3),!1,!0):[]},I.takeWhile=function aM(u,f){return u&&u.length?Sr(u,ut(f,3)):[]},I.tap=function pM(u,f){return f(u),u},I.throttle=function Iw(u,f,_){var S=!0,M=!0;if("function"!=typeof u)throw new ts(Kr);return $n(_)&&(S="leading"in _?!!_.leading:S,M="trailing"in _?!!_.trailing:M),Mw(u,f,{leading:S,maxWait:f,trailing:M})},I.thru=If,I.toArray=Hw,I.toPairs=zM,I.toPairsIn=T_,I.toPath=function Yc(u){return Dt(u)?Dn(u,xr):ls(u)?[u]:ur(bl(an(u)))},I.toPlainObject=Gw,I.transform=function GM(u,f,_){var S=Dt(u),M=S||ka(u)||Wc(u);if(f=ut(f,4),null==_){var N=u&&u.constructor;_=M?S?new N:[]:$n(u)&&Rs(N)?Ii(lr(u)):{}}return(M?Fn:Yo)(u,function(U,j,K){return f(_,U,j,K)}),_},I.unary=function Rw(u){return tr(u,1)},I.union=Bc,I.unionBy=uh,I.unionWith=lM,I.uniq=function $P(u){return u&&u.length?ge(u):[]},I.uniqBy=function pw(u,f){return u&&u.length?ge(u,ut(f,2)):[]},I.uniqWith=function cM(u,f){return f="function"==typeof f?f:B,u&&u.length?ge(u,B,f):[]},I.unset=function WM(u,f){return null==u||Zt(u,f)},I.unzip=mw,I.unzipWith=gw,I.update=function jM(u,f,_){return null==u?u:as(u,f,Qu(_))},I.updateWith=function $M(u,f,_,S){return S="function"==typeof S?S:B,null==u?u:as(u,f,Qu(_),S)},I.values=Tl,I.valuesIn=function Xf(u){return null==u?[]:Bd(u,fr(u))},I.without=uM,I.words=Ba,I.wrap=function Gc(u,f){return p_(Qu(f),u)},I.xor=hM,I.xorBy=Df,I.xorWith=_w,I.zip=dM,I.zipObject=function yw(u,f){return Dc(u||[],f||[],xc)},I.zipObjectDeep=function qP(u,f){return Dc(u||[],f||[],hf)},I.zipWith=vw,I.entries=zM,I.entriesIn=T_,I.extend=S_,I.extendWith=ph,O_(I,I),I.add=B_,I.attempt=sb,I.camelCase=qc,I.capitalize=Yw,I.ceil=bh,I.clamp=function qM(u,f,_){return _===B&&(_=f,f=B),_!==B&&(_=(_=kr(_))==_?_:0),f!==B&&(f=(f=kr(f))==f?f:0),Da(kr(u),f,_)},I.clone=function Pw(u){return wr(u,4)},I.cloneDeep=function Vf(u){return wr(u,5)},I.cloneDeepWith=function MM(u,f){return wr(u,5,f="function"==typeof f?f:B)},I.cloneWith=function m_(u,f){return wr(u,4,f="function"==typeof f?f:B)},I.conformsTo=function TM(u,f){return null==f||pl(u,f,Wi(f))},I.deburr=Kw,I.defaultTo=function Jf(u,f){return null==u||u!=u?f:u},I.divide=np,I.endsWith=function Zw(u,f,_){u=an(u),f=os(f);var S=u.length,M=_=_===B?S:Da(Vt(_),0,S);return(_-=f.length)>=0&&u.slice(_,M)==f},I.eq=Ks,I.escape=function Jw(u){return(u=an(u))&&Zv.test(u)?u.replace(Kv,vx):u},I.escapeRegExp=function YM(u){return(u=an(u))&&n0.test(u)?u.replace(Dd,"\\$&"):u},I.every=function mM(u,f,_){var S=Dt(u)?gx:Ax;return _&&Gi(u,f,_)&&(f=B),S(u,ut(f,3))},I.find=Pf,I.findIndex=_i,I.findKey=function OM(u,f){return _x(u,ut(f,3),Yo)},I.findLast=ww,I.findLastIndex=hw,I.findLastKey=function FM(u,f){return _x(u,ut(f,3),L0)},I.floor=Kc,I.forEach=s_,I.forEachRight=o_,I.forIn=function Ua(u,f){return null==u?u:Ag(u,ut(f,3),fr)},I.forInRight=function mh(u,f){return null==u?u:ef(u,ut(f,3),fr)},I.forOwn=function kM(u,f){return u&&Yo(u,ut(f,3))},I.forOwnRight=function nN(u,f){return u&&L0(u,ut(f,3))},I.get=$w,I.gt=AM,I.gte=DM,I.has=function sN(u,f){return null!=u&&jg(u,f,Dx)},I.hasIn=qf,I.head=Zg,I.identity=pr,I.includes=function Lf(u,f,_,S){u=dr(u)?u:Tl(u),_=_&&!S?Vt(_):0;var M=u.length;return _<0&&(_=Qn(M+_,0)),jf(u)?_<=M&&u.indexOf(f,_)>-1:!!M&&Uu(u,f,_)>-1},I.indexOf=function Cf(u,f,_){var S=null==u?0:u.length;if(!S)return-1;var M=null==_?0:Vt(_);return M<0&&(M=Qn(S+M,0)),Uu(u,f,M)},I.inRange=function A_(u,f,_){return f=ea(f),_===B?(_=f,f=0):_=ea(_),function Ix(u,f,_){return u>=Qi(f,_)&&u<Qn(f,_)}(u=kr(u),f,_)},I.invoke=VM,I.isArguments=Sl,I.isArray=Dt,I.isArrayBuffer=Hf,I.isArrayLike=dr,I.isArrayLikeObject=ei,I.isBoolean=function IM(u){return!0===u||!1===u||ti(u)&&br(u)==Jt},I.isBuffer=ka,I.isDate=g_,I.isElement=function Nw(u){return ti(u)&&1===u.nodeType&&!xl(u)},I.isEmpty=function Cl(u){if(null==u)return!0;if(dr(u)&&(Dt(u)||"string"==typeof u||"function"==typeof u.splice||ka(u)||Wc(u)||Sl(u)))return!u.length;var f=Pi(u);if(f==zs||f==Gs)return!u.size;if(Nc(u))return!af(u).length;for(var _ in u)if(mn.call(u,_))return!1;return!0},I.isEqual=function Lw(u,f){return Yu(u,f)},I.isEqualWith=function Ow(u,f,_){var S=(_="function"==typeof _?_:B)?_(u,f):B;return S===B?Yu(u,f,B,_):!!S},I.isError=__,I.isFinite=function tN(u){return"number"==typeof u&&Wo(u)},I.isFunction=Rs,I.isInteger=Fw,I.isLength=dh,I.isMap=zf,I.isMatch=function kw(u,f){return u===f||sf(u,f,sh(f))},I.isMatchWith=function Gf(u,f,_){return _="function"==typeof _?_:B,sf(u,f,sh(f),_)},I.isNaN=function fh(u){return v_(u)&&u!=+u},I.isNative=function Uw(u){if(ow(u))throw new At("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return B0(u)},I.isNil=function Wf(u){return null==u},I.isNull=function y_(u){return null===u},I.isNumber=v_,I.isObject=$n,I.isObjectLike=ti,I.isPlainObject=xl,I.isRegExp=Ml,I.isSafeInteger=function RM(u){return Fw(u)&&u>=-Vo&&u<=Vo},I.isSet=w_,I.isString=jf,I.isSymbol=ls,I.isTypedArray=Wc,I.isUndefined=function Bw(u){return u===B},I.isWeakMap=function Vw(u){return ti(u)&&Pi(u)==pc},I.isWeakSet=function $f(u){return ti(u)&&"[object WeakSet]"==br(u)},I.join=function WP(u,f){return null==u?"":bc.call(u,f)},I.kebabCase=KM,I.last=jn,I.lastIndexOf=function Jg(u,f,_){var S=null==u?0:u.length;if(!S)return-1;var M=S;return _!==B&&(M=(M=Vt(_))<0?Qn(S+M,0):Qi(M,S-1)),f==f?function Wu(Y,ue,re){for(var Ue=re+1;Ue--;)if(Y[Ue]===ue)return Ue;return Ue}(u,f,M):gg(u,Ud,M,!0)},I.lowerCase=ZM,I.lowerFirst=JM,I.lt=b_,I.lte=jc,I.max=function V_(u){return u&&u.length?Qd(u,pr,Ig):B},I.maxBy=function H_(u,f){return u&&u.length?Qd(u,ut(f,2),Ig):B},I.mean=function ip(u){return Vu(u,pr)},I.meanBy=function dN(u,f){return Vu(u,ut(f,2))},I.min=function z_(u){return u&&u.length?Qd(u,pr,Ku):B},I.minBy=function Eh(u,f){return u&&u.length?Qd(u,ut(f,2),Ku):B},I.stubArray=ub,I.stubFalse=hb,I.stubObject=function tp(){return{}},I.stubString=function lT(){return""},I.stubTrue=function F_(){return!0},I.multiply=cT,I.nth=function Uc(u,f){return u&&u.length?Or(u,Vt(f)):B},I.noConflict=function rT(){return ar._===this&&(ar._=pt),this},I.noop=wh,I.now=hh,I.pad=function Qw(u,f,_){u=an(u);var S=(f=Vt(f))?cl(u):0;if(!f||S>=f)return u;var M=(f-S)/2;return _f(Di(M),_)+u+_f(Ea(M),_)},I.padEnd=function cN(u,f,_){u=an(u);var S=(f=Vt(f))?cl(u):0;return f&&S<f?u+_f(f-S,_):u},I.padStart=function uN(u,f,_){u=an(u);var S=(f=Vt(f))?cl(u):0;return f&&S<f?_f(f-S,_)+u:u},I.parseInt=function _h(u,f,_){return _||null==f?f=0:f&&(f=+f),ui(an(u).replace(Id,""),f||0)},I.random=function XM(u,f,_){if(_&&"boolean"!=typeof _&&Gi(u,f,_)&&(f=_=B),_===B&&("boolean"==typeof f?(_=f,f=B):"boolean"==typeof u&&(_=u,u=B)),u===B&&f===B?(u=0,f=1):(u=ea(u),f===B?(f=u,u=0):f=ea(f)),u>f){var S=u;u=f,f=S}if(_||u%1||f%1){var M=Sc();return Qi(u+M*(f-u+pP("1e-"+((M+"").length-1))),f)}return cf(u,f)},I.reduce=function a_(u,f,_){var S=Dt(u)?kd:v0,M=arguments.length<3;return S(u,ut(f,4),_,M,ml)},I.reduceRight=function yM(u,f,_){var S=Dt(u)?fg:v0,M=arguments.length<3;return S(u,ut(f,4),_,M,Tx)},I.repeat=function Ye(u,f,_){return f=(_?Gi(u,f,_):f===B)?1:Vt(f),uf(an(u),f)},I.replace=function yh(){var u=arguments,f=an(u[0]);return u.length<3?f:f.replace(u[1],u[2])},I.result=function x_(u,f,_){var S=-1,M=(f=So(f,u)).length;for(M||(M=1,u=B);++S<M;){var N=null==u?B:u[xr(f[S])];N===B&&(S=M,N=_),u=Rs(N)?N.call(u):N}return u},I.round=db,I.runInContext=Y,I.sample=function wM(u){return(Dt(u)?rs:_t)(u)},I.size=function EM(u){if(null==u)return 0;if(dr(u))return jf(u)?cl(u):u.length;var f=Pi(u);return f==zs||f==Gs?u.size:af(u).length},I.snakeCase=eb,I.some=function Fr(u,f,_){var S=Dt(u)?pg:Ac;return _&&Gi(u,f,_)&&(f=B),S(u,ut(f,3))},I.sortedIndex=function t_(u,f){return df(u,f)},I.sortedIndexBy=function xf(u,f,_){return Ng(u,f,ut(_,2))},I.sortedIndexOf=function iM(u,f){var _=null==u?0:u.length;if(_){var S=df(u,f);if(S<_&&Ks(u[S],f))return S}return-1},I.sortedLastIndex=function Mf(u,f){return df(u,f,!0)},I.sortedLastIndexBy=function rM(u,f,_){return Ng(u,f,ut(_,2),!0)},I.sortedLastIndexOf=function Tf(u,f){if(null!=u&&u.length){var S=df(u,f,!0)-1;if(Ks(u[S],f))return S}return-1},I.startCase=D_,I.startsWith=function I_(u,f,_){return u=an(u),_=null==_?0:Da(Vt(_),0,u.length),f=os(f),u.slice(_,_+f.length)==f},I.subtract=uT,I.sum=function hT(u){return u&&u.length?wa(u,pr):0},I.sumBy=function G_(u,f){return u&&u.length?wa(u,ut(f,2)):0},I.template=function QM(u,f,_){var S=I.templateSettings;_&&Gi(u,f,_)&&(f=B),u=an(u),f=ph({},f,S,vf);var j,K,M=ph({},f.imports,S.imports,vf),N=Wi(M),U=Bd(M,N),pe=0,me=f.interpolate||Rd,be="__p += '",He=wg((f.escape||Rd).source+"|"+me.source+"|"+(me===rg?rx:Rd).source+"|"+(f.evaluate||Rd).source+"|$","g"),tt="//# sourceURL="+(mn.call(f,"sourceURL")?(f.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++dP+"]")+"\n";u.replace(He,function(ht,Ht,Qt,ji,En,us){return Qt||(Qt=ji),be+=u.slice(pe,us).replace(sg,wx),Ht&&(j=!0,be+="' +\n__e("+Ht+") +\n'"),En&&(K=!0,be+="';\n"+En+";\n__p += '"),Qt&&(be+="' +\n((__t = ("+Qt+")) == null ? '' : __t) +\n'"),pe=us+ht.length,ht}),be+="';\n";var ct=mn.call(f,"variable")&&f.variable;if(ct){if(r0.test(ct))throw new At("Invalid `variable` option passed into `_.template`")}else be="with (obj) {\n"+be+"\n}\n";be=(K?be.replace(YC,""):be).replace(KC,"$1").replace(ZC,"$1;"),be="function("+(ct||"obj")+") {\n"+(ct?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(j?", __e = _.escape":"")+(K?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+be+"return __p\n}";var Wt=sb(function(){return cn(N,tt+"return "+be).apply(B,U)});if(Wt.source=be,__(Wt))throw Wt;return Wt},I.times=function k_(u,f){if((u=Vt(u))<1||u>Vo)return[];var _=ho,S=Qi(u,ho);f=ut(f),u-=ho;for(var M=vg(S,f);++_<u;)f(_);return M},I.toFinite=ea,I.toInteger=Vt,I.toLength=zw,I.toLower=function nb(u){return an(u).toLowerCase()},I.toNumber=kr,I.toSafeInteger=function $c(u){return u?Da(Vt(u),-Vo,Vo):0===u?u:0},I.toString=an,I.toUpper=function ib(u){return an(u).toUpperCase()},I.trim=function Yf(u,f,_){if((u=an(u))&&(_||f===B))return b0(u);if(!u||!(f=os(f)))return u;var S=Ms(u),M=Ms(f);return gl(S,Hu(S,M),Vd(S,M)+1).join("")},I.trimEnd=function hN(u,f,_){if((u=an(u))&&(_||f===B))return u.slice(0,Hd(u)+1);if(!u||!(f=os(f)))return u;var S=Ms(u);return gl(S,0,Vd(S,Ms(f))+1).join("")},I.trimStart=function R_(u,f,_){if((u=an(u))&&(_||f===B))return u.replace(Id,"");if(!u||!(f=os(f)))return u;var S=Ms(u);return gl(S,Hu(S,Ms(f))).join("")},I.truncate=function eT(u,f){var _=30,S="...";if($n(f)){var M="separator"in f?f.separator:M;_="length"in f?Vt(f.length):_,S="omission"in f?os(f.omission):S}var N=(u=an(u)).length;if(zo(u)){var U=Ms(u);N=U.length}if(_>=N)return u;var j=_-cl(S);if(j<1)return S;var K=U?gl(U,0,j).join(""):u.slice(0,j);if(M===B)return K+S;if(U&&(j+=K.length-j),Ml(M)){if(u.slice(j).search(M)){var pe,me=K;for(M.global||(M=wg(M.source,an(po.exec(M))+"g")),M.lastIndex=0;pe=M.exec(me);)var be=pe.index;K=K.slice(0,be===B?j:be)}}else if(u.indexOf(os(M),j)!=j){var He=K.lastIndexOf(M);He>-1&&(K=K.slice(0,He))}return K+S},I.unescape=function P_(u){return(u=an(u))&&rP.test(u)?u.replace(Yv,S0):u},I.uniqueId=function U_(u){var f=++Sx;return an(u)+f},I.upperCase=rb,I.upperFirst=Kf,I.each=s_,I.eachRight=o_,I.first=Zg,O_(I,function(){var u={};return Yo(I,function(f,_){mn.call(I.prototype,_)||(u[_]=f)}),u}(),{chain:!1}),I.VERSION="4.17.21",Fn(["bind","bindKey","curry","curryRight","partial","partialRight"],function(u){I[u].placeholder=I}),Fn(["drop","take"],function(u,f){Ut.prototype[u]=function(_){_=_===B?1:Qn(Vt(_),0);var S=this.__filtered__&&!f?new Ut(this):this.clone();return S.__filtered__?S.__takeCount__=Qi(_,S.__takeCount__):S.__views__.push({size:Qi(_,ho),type:u+(S.__dir__<0?"Right":"")}),S},Ut.prototype[u+"Right"]=function(_){return this.reverse()[u](_).reverse()}}),Fn(["filter","map","takeWhile"],function(u,f){var _=f+1,S=1==_||3==_;Ut.prototype[u]=function(M){var N=this.clone();return N.__iteratees__.push({iteratee:ut(M,3),type:_}),N.__filtered__=N.__filtered__||S,N}}),Fn(["head","last"],function(u,f){var _="take"+(f?"Right":"");Ut.prototype[u]=function(){return this[_](1).value()[0]}}),Fn(["initial","tail"],function(u,f){var _="drop"+(f?"":"Right");Ut.prototype[u]=function(){return this.__filtered__?new Ut(this):this[_](1)}}),Ut.prototype.compact=function(){return this.filter(pr)},Ut.prototype.find=function(u){return this.filter(u).head()},Ut.prototype.findLast=function(u){return this.reverse().find(u)},Ut.prototype.invokeMap=Gt(function(u,f){return"function"==typeof u?new Ut(this):this.map(function(_){return rf(_,u,f)})}),Ut.prototype.reject=function(u){return this.filter(Uf(ut(u)))},Ut.prototype.slice=function(u,f){u=Vt(u);var _=this;return _.__filtered__&&(u>0||f<0)?new Ut(_):(u<0?_=_.takeRight(-u):u&&(_=_.drop(u)),f!==B&&(_=(f=Vt(f))<0?_.dropRight(-f):_.take(f-u)),_)},Ut.prototype.takeRightWhile=function(u){return this.reverse().takeWhile(u).reverse()},Ut.prototype.toArray=function(){return this.take(ho)},Yo(Ut.prototype,function(u,f){var _=/^(?:filter|find|map|reject)|While$/.test(f),S=/^(?:head|last)$/.test(f),M=I[S?"take"+("last"==f?"Right":""):f],N=S||/^find/.test(f);M&&(I.prototype[f]=function(){var U=this.__wrapped__,j=S?[1]:arguments,K=U instanceof Ut,pe=j[0],me=K||Dt(U),be=function(Ht){var Qt=M.apply(I,go([Ht],j));return S&&He?Qt[0]:Qt};me&&_&&"function"==typeof pe&&1!=pe.length&&(K=me=!1);var He=this.__chain__,ct=N&&!He,Wt=K&&!this.__actions__.length;if(!N&&me){U=Wt?U:new Ut(this);var ht=u.apply(U,j);return ht.__actions__.push({func:If,args:[be],thisArg:B}),new Lr(ht,He)}return ct&&Wt?u.apply(this,j):(ht=this.thru(be),ct?S?ht.value()[0]:ht.value():ht)})}),Fn(["pop","push","shift","sort","splice","unshift"],function(u){var f=Gd[u],_=/^(?:push|sort|unshift)$/.test(u)?"tap":"thru",S=/^(?:pop|shift)$/.test(u);I.prototype[u]=function(){var M=arguments;if(S&&!this.__chain__){var N=this.value();return f.apply(Dt(N)?N:[],M)}return this[_](function(U){return f.apply(Dt(U)?U:[],M)})}}),Yo(Ut.prototype,function(u,f){var _=I[f];if(_){var S=_.name+"";mn.call(kt,S)||(kt[S]=[]),kt[S].push({name:f,func:_})}}),kt[Rn(B,2).name]=[{name:"wrapper",func:B}],Ut.prototype.clone=function Xd(){var u=new Ut(this.__wrapped__);return u.__actions__=ur(this.__actions__),u.__dir__=this.__dir__,u.__filtered__=this.__filtered__,u.__iteratees__=ur(this.__iteratees__),u.__takeCount__=this.__takeCount__,u.__views__=ur(this.__views__),u},Ut.prototype.reverse=function js(){if(this.__filtered__){var u=new Ut(this);u.__dir__=-1,u.__filtered__=!0}else(u=this.clone()).__dir__*=-1;return u},Ut.prototype.value=function Cg(){var u=this.__wrapped__.value(),f=this.__dir__,_=Dt(u),S=f<0,M=_?u.length:0,N=function OP(u,f,_){for(var S=-1,M=_.length;++S<M;){var N=_[S],U=N.size;switch(N.type){case"drop":u+=U;break;case"dropRight":f-=U;break;case"take":f=Qi(f,u+U);break;case"takeRight":u=Qn(u,f-U)}}return{start:u,end:f}}(0,M,this.__views__),U=N.start,j=N.end,K=j-U,pe=S?j:U-1,me=this.__iteratees__,be=me.length,He=0,tt=Qi(K,this.__takeCount__);if(!_||!S&&M==K&&tt==K)return zi(u,this.__actions__);var ct=[];e:for(;K--&&He<tt;){for(var Wt=-1,ht=u[pe+=f];++Wt<be;){var Ht=me[Wt],ji=Ht.type,En=(0,Ht.iteratee)(ht);if(2==ji)ht=En;else if(!En){if(1==ji)continue e;break e}}ct[He++]=ht}return ct},I.prototype.at=i_,I.prototype.chain=function XP(){return fM(this)},I.prototype.commit=function YP(){return new Lr(this.value(),this.__chain__)},I.prototype.next=function r_(){this.__values__===B&&(this.__values__=Hw(this.value()));var u=this.__index__>=this.__values__.length;return{done:u,value:u?B:this.__values__[this.__index__++]}},I.prototype.plant=function ZP(u){for(var f,_=this;_ instanceof Vi;){var S=El(_);S.__index__=0,S.__values__=B,f?M.__wrapped__=S:f=S;var M=S;_=_.__wrapped__}return M.__wrapped__=u,f},I.prototype.reverse=function JP(){var u=this.__wrapped__;if(u instanceof Ut){var f=u;return this.__actions__.length&&(f=new Ut(this)),(f=f.reverse()).__actions__.push({func:If,args:[e_],thisArg:B}),new Lr(f,this.__chain__)}return this.thru(e_)},I.prototype.toJSON=I.prototype.valueOf=I.prototype.value=function QP(){return zi(this.__wrapped__,this.__actions__)},I.prototype.first=I.prototype.head,$u&&(I.prototype[$u]=function KP(){return this}),I}();ar._=zd,(fn=function(){return zd}.call(lc,vd,lc,Hs))!==B&&(Hs.exports=fn)}.call(this)},147:Hs=>{"use strict";Hs.exports={i8:"0.0.19"}}},Hs=>{Hs(Hs.s=497)}]);